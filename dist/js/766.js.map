{"version":3,"file":"js/766.js","mappings":"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","sources":["webpack://x-sheet/webpack/universalModuleDefinition","webpack://x-sheet/webpack/runtime/chunk loaded","webpack://x-sheet/webpack/runtime/startup chunk dependencies","webpack://x-sheet/./src/lib/SelectFile.js","webpack://x-sheet/./src/lib/finddpi/FindDpi.js","webpack://x-sheet/./src/core/table/tableunit/HeightUnit.js","webpack://x-sheet/./src/core/table/tableunit/WideUnit.js","webpack://x-sheet/./src/core/table/tablebase/Scale.js","webpack://x-sheet/./src/core/table/tablerow/Row.js","webpack://x-sheet/./src/core/table/tablerow/CacheHeight.js","webpack://x-sheet/./src/core/table/iterator/synchronous/SyncBaseIterator.js","webpack://x-sheet/./src/core/table/iterator/synchronous/SyncRowsIterator.js","webpack://x-sheet/./src/core/table/iterator/synchronous/SyncColsIterator.js","webpack://x-sheet/./src/core/table/iterator/asynchronous/AsyncBaseIterator.js","webpack://x-sheet/./src/core/table/iterator/asynchronous/AsyncRowIterator.js","webpack://x-sheet/./src/core/table/iterator/asynchronous/AsyncColIterator.js","webpack://x-sheet/./src/core/table/iterator/XIteratorBuilder.js","webpack://x-sheet/./src/core/table/tablerow/Rows.js","webpack://x-sheet/./src/core/table/tablecol/Col.js","webpack://x-sheet/./src/core/table/tablecol/CacheWidth.js","webpack://x-sheet/./src/core/table/tablecol/Cols.js","webpack://x-sheet/./src/io/xlsx/XlsxExport.js","webpack://x-sheet/./src/worker/task/xlsxexport.worker.js","webpack://x-sheet/webpack/bootstrap","webpack://x-sheet/webpack/runtime/define property getters","webpack://x-sheet/webpack/runtime/ensure chunk","webpack://x-sheet/webpack/runtime/get javascript chunk filename","webpack://x-sheet/webpack/runtime/get mini-css chunk filename","webpack://x-sheet/webpack/runtime/global","webpack://x-sheet/webpack/runtime/hasOwnProperty shorthand","webpack://x-sheet/webpack/runtime/publicPath","webpack://x-sheet/webpack/runtime/importScripts chunk loading","webpack://x-sheet/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"x-sheet\"] = factory();\n\telse\n\t\troot[\"x-sheet\"] = factory();\n})(self, function() {\nreturn ","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","var next = __webpack_require__.x;\n__webpack_require__.x = () => {\n\treturn Promise.all([295,924,457].map(__webpack_require__.e, __webpack_require__)).then(next);\n};","import { Element } from './Element';\r\nimport { cssPrefix } from '../const/Constant';\r\nimport { XEvent } from './XEvent';\r\n\r\nclass SelectFile extends Element {\r\n\r\n  constructor({\r\n    multiple = false,\r\n    accept = '*',\r\n  }) {\r\n    super('input', `${cssPrefix}-select-file`);\r\n    this.attr('type', 'file');\r\n    this.attr('accept', accept);\r\n    if (multiple) {\r\n      this.attr('multiple', 'multiple');\r\n    }\r\n    this.accept = accept;\r\n    this.multiple = multiple;\r\n  }\r\n\r\n  async choose() {\r\n    XEvent.unbind(this, 'change');\r\n    this.val('');\r\n    return new Promise((resolve) => {\r\n      XEvent.bind(this, 'change', () => {\r\n        const files = this.el.files;\r\n        if (files.length) {\r\n          if (this.multiple) {\r\n            resolve(files);\r\n          } else {\r\n            resolve(files[0]);\r\n          }\r\n        } else {\r\n          resolve(null);\r\n        }\r\n      }).trigger('click');\r\n    });\r\n  }\r\n\r\n}\r\n\r\nSelectFile.ACCEPT = {\r\n  XLSX: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\r\n  CVS: '.csv',\r\n  TXT: 'text/plain',\r\n  IMAGE: 'image/*',\r\n};\r\n\r\nexport {\r\n  SelectFile,\r\n};\r\n","function binSearch(fn, min, max) {\r\n  // not found\r\n  if (max < min) return -1;\r\n  // eslint-disable-next-line no-bitwise\r\n  let mid = (min + max) >>> 1;\r\n  if (fn(mid) > 0) {\r\n    if (mid === min || fn(mid - 1) <= 0) {\r\n      return mid;\r\n    }\r\n    return binSearch(fn, min, mid - 1);\r\n  }\r\n  return binSearch(fn, mid + 1, max);\r\n}\r\n\r\nfunction findFirstPositive(fn) {\r\n  let start = 1;\r\n  // eslint-disable-next-line no-bitwise\r\n  while (fn(start) <= 0) start <<= 1;\r\n  // eslint-disable-next-line no-bitwise\r\n  return binSearch(fn, start >>> 1, start) | 0;\r\n}\r\n\r\nfunction FindDPI() {\r\n  // eslint-disable-next-line no-undef\r\n  return findFirstPositive((x) => matchMedia(`(max-resolution: ${x}dpi)`).matches);\r\n}\r\n\r\nexport { FindDPI };\r\n","import { FindDPI } from '../../../lib/finddpi/FindDpi';\r\nimport { SheetUtils } from '../../../utils/SheetUtils';\r\n\r\n/**\r\n * 高度单位\r\n */\r\nclass HeightUnit {\r\n\r\n  /**\r\n   * HeightUnit\r\n   * @param dpi\r\n   */\r\n  constructor({\r\n    dpi,\r\n  } = {}) {\r\n    if (SheetUtils.isDef(dpi)) {\r\n      this.dpi = dpi;\r\n    } else {\r\n      this.dpi = FindDPI();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 获取DPI\r\n   * @returns {*}\r\n   */\r\n  getDpi() {\r\n    return this.dpi;\r\n  }\r\n\r\n  /**\r\n   * 磅转像素\r\n   */\r\n  getPixel(pt) {\r\n    return pt * this.dpi / 72;\r\n  }\r\n\r\n  /**\r\n   * 像素转磅\r\n   */\r\n  getPoint(px) {\r\n    return 72 * px / this.dpi;\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  HeightUnit,\r\n};\r\n","import { XDraw } from '../../../draw/XDraw';\r\nimport { SheetUtils } from '../../../utils/SheetUtils';\r\n\r\n/**\r\n * WideUnit\r\n */\r\nclass WideUnit {\r\n\r\n  /**\r\n   * WideUnit\r\n   * @param table\r\n   * @param unit\r\n   * @param fontName\r\n   * @param fontSize\r\n   * @param fontBold\r\n   * @param fontItalic\r\n   */\r\n  constructor({\r\n    table = null,\r\n    unit = null,\r\n    fontName = 'Arial',\r\n    fontSize = 10,\r\n    fontBold = false,\r\n    fontItalic = false,\r\n  } = {}) {\r\n    if (SheetUtils.isDef(unit)) {\r\n      this.unit = unit;\r\n    } else {\r\n      const { draw, heightUnit } = table;\r\n      // 字体像素\r\n      const fontPixel = heightUnit.getPixel(fontSize);\r\n      const srcPixel = XDraw.srcPx(fontPixel);\r\n      const sizePixel = XDraw.trunc(srcPixel);\r\n      // 字体样式\r\n      const bold = `${fontBold ? 'bold' : ''}`;\r\n      const italic = `${fontItalic ? 'italic' : ''}`;\r\n      const style = `${italic} ${bold} ${sizePixel}px ${fontName}`;\r\n      // 度量字体\r\n      draw.save();\r\n      draw.attr({\r\n        font: style.trim(),\r\n      });\r\n      let unit = 0;\r\n      for (let i = 0; i < 10; i++) {\r\n        const { width } = draw.measureText(i.toString());\r\n        if (width > unit) {\r\n          unit = width;\r\n        }\r\n      }\r\n      draw.restore();\r\n      this.unit = unit;\r\n      // Firefox 好像不准确😓\r\n      const { type } = SheetUtils.getExplorerInfo();\r\n      switch (type) {\r\n        case 'Firefox':\r\n          this.unit = XDraw.trunc(unit) + 0.22;\r\n          break;\r\n        case 'Chrome':\r\n          this.unit = unit;\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 获取当前测量单位\r\n   * @returns {*}\r\n   */\r\n  getUnit() {\r\n    return this.unit;\r\n  }\r\n\r\n  /**\r\n   * 获取字符运行时像素\r\n   * @param nb 字符数\r\n   */\r\n  getNumberPixel(nb) {\r\n    return this.getWidePixel(this.getNumberWide(nb));\r\n  }\r\n\r\n  /**\r\n   * 获取宽度运行时像素\r\n   * @param wide 列宽\r\n   * @returns {number}\r\n   * @see https://docs.microsoft.com/en-us/dotnet/api/documentformat.openxml.spreadsheet.column?redirectedfrom=MSDN&view=openxml-2.8.1\r\n   */\r\n  getWidePixel(wide) {\r\n    return XDraw.trunc(((256 * wide + XDraw.trunc(128 / this.unit)) / 256) * this.unit);\r\n  }\r\n\r\n  /**\r\n   * 获取字符宽度\r\n   * @param nb 字符数\r\n   * @see https://docs.microsoft.com/en-us/dotnet/api/documentformat.openxml.spreadsheet.column?redirectedfrom=MSDN&view=openxml-2.8.1\r\n   */\r\n  getNumberWide(nb) {\r\n    return XDraw.trunc([nb * this.unit + 5] / this.unit * 256) / 256;\r\n  }\r\n\r\n  /**\r\n   * 获取像素对应的字符数\r\n   * @param pixel\r\n   * @returns {number}\r\n   * @see https://docs.microsoft.com/en-us/dotnet/api/documentformat.openxml.spreadsheet.column?redirectedfrom=MSDN&view=openxml-2.8.1\r\n   */\r\n  getPixelNumber(pixel) {\r\n    return XDraw.trunc((pixel - 5) / this.unit * 100 + 0.5) / 100;\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  WideUnit,\r\n};\r\n","class Scale {\r\n\r\n  constructor() {\r\n    this.value = 1;\r\n  }\r\n\r\n  back(origin) {\r\n    return origin / this.value;\r\n  }\r\n\r\n  goto(origin) {\r\n    return this.value * origin;\r\n  }\r\n\r\n  setValue(value) {\r\n    this.value = value;\r\n  }\r\n\r\n}\r\n\r\nclass ScaleAdapter {\r\n\r\n  constructor({\r\n    goto = (v) => v,\r\n    back = (v) => v,\r\n  } = {}) {\r\n    this.goto = goto;\r\n    this.back = back;\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  Scale, ScaleAdapter,\r\n};\r\n","class Row {\r\n\r\n  constructor(row, {\r\n    height = 30,\r\n  } = {}) {\r\n    this.height = height;\r\n    this.row = row;\r\n    this.reCkHasAngle = true;\r\n    this.hasAngelCell = false;\r\n  }\r\n\r\n  setHasAngelCell(value) {\r\n    this.hasAngelCell = value;\r\n  }\r\n\r\n  setReCkHasAngle(value) {\r\n    this.reCkHasAngle = value;\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  Row,\r\n};\r\n","class CacheItems {\r\n\r\n  constructor() {\r\n    this.items = [];\r\n    this.min = Infinity;\r\n    this.max = -Infinity;\r\n  }\r\n\r\n  get(eri) {\r\n    return this.items[eri];\r\n  }\r\n\r\n  set(eri, val) {\r\n    this.items[eri] = val;\r\n    if (eri < this.min) {\r\n      this.min = eri;\r\n    }\r\n    if (eri > this.max) {\r\n      this.max = eri;\r\n    }\r\n  }\r\n\r\n}\r\n\r\nclass CacheHeight {\r\n\r\n  constructor() {\r\n    this.cache = [];\r\n  }\r\n\r\n  clear() {\r\n    this.cache = [];\r\n  }\r\n\r\n  get(sri, eri) {\r\n    const items = this.cache[sri];\r\n    return items ? items.get(eri) : null;\r\n  }\r\n\r\n  getItems(sri) {\r\n    return this.cache[sri];\r\n  }\r\n\r\n  add(sri, eri, height) {\r\n    const items = this.cache[sri] || new CacheItems();\r\n    items.set(eri, height);\r\n    this.cache[sri] = items;\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  CacheHeight,\r\n};\r\n","class SyncBaseIterator {\r\n\r\n  constructor() {\r\n    this.finishCallback = () => {};\r\n    this.loopCallback = () => {};\r\n    this.nextCallback = () => {};\r\n    this.end = 0;\r\n    this.begin = 0;\r\n  }\r\n\r\n  setBegin(begin) {\r\n    this.begin = begin;\r\n    return this;\r\n  }\r\n\r\n  setEnd(end) {\r\n    this.end = end;\r\n    return this;\r\n  }\r\n\r\n  execute() {\r\n    const {\r\n      loopCallback, nextCallback,\r\n    } = this;\r\n    const {\r\n      begin, end,\r\n    } = this;\r\n    let i;\r\n    if (begin > end) {\r\n      i = begin;\r\n      for (; i >= end; i -= 1, nextCallback(i)) {\r\n        const res = loopCallback(i);\r\n        if (res === false) {\r\n          break;\r\n        }\r\n      }\r\n    } else {\r\n      i = begin;\r\n      for (; i <= end; i += 1, nextCallback(i)) {\r\n        const res = loopCallback(i);\r\n        if (res === false) {\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    this.finishCallback(i);\r\n    return this;\r\n  }\r\n\r\n  setLoop(callback) {\r\n    this.loopCallback = callback;\r\n    return this;\r\n  }\r\n\r\n  setNext(callback) {\r\n    this.nextCallback = callback;\r\n    return this;\r\n  }\r\n\r\n  setFinish(callback) {\r\n    this.finishCallback = callback;\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  SyncBaseIterator,\r\n};\r\n","import { SyncBaseIterator } from './SyncBaseIterator';\r\n\r\nlet fold = [];\r\n\r\nclass SyncRowsIterator extends SyncBaseIterator {\r\n\r\n  static getInstance() {\r\n    return new SyncRowsIterator();\r\n  }\r\n\r\n  static setFold(value) {\r\n    fold = value;\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.skipCallback = () => {};\r\n    this.useFold = true;\r\n  }\r\n\r\n  execute() {\r\n    const {\r\n      loopCallback, nextCallback, skipCallback,\r\n    } = this;\r\n    const {\r\n      begin, end, useFold,\r\n    } = this;\r\n    let i;\r\n    if (begin > end) {\r\n      i = begin;\r\n      for (; i >= end; i -= 1, nextCallback(i)) {\r\n        if (useFold && fold[i]) {\r\n          skipCallback(i);\r\n          continue;\r\n        }\r\n        const res = loopCallback(i);\r\n        if (res === false) {\r\n          break;\r\n        }\r\n      }\r\n    } else {\r\n      i = begin;\r\n      for (; i <= end; i += 1, nextCallback(i)) {\r\n        if (useFold && fold[i]) {\r\n          skipCallback(i);\r\n          continue;\r\n        }\r\n        const res = loopCallback(i);\r\n        if (res === false) {\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    this.finishCallback(i);\r\n    return this;\r\n  }\r\n\r\n  setSkip(callback) {\r\n    this.skipCallback = callback;\r\n    return this;\r\n  }\r\n\r\n  nextRow() {\r\n    const { begin } = this;\r\n    let ri = -1;\r\n    this.setLoop((i) => {\r\n      if (i !== begin) {\r\n        ri = i;\r\n        return false;\r\n      }\r\n      return true;\r\n    }).execute();\r\n    return ri;\r\n  }\r\n\r\n  hasFold() {\r\n    let find = false;\r\n    this.setLoop((i) => {\r\n      if (fold[i]) {\r\n        find = true;\r\n        return false;\r\n      }\r\n      return true;\r\n    }).foldOnOff(false).execute();\r\n    return find;\r\n  }\r\n\r\n  foldOnOff(onOff) {\r\n    this.useFold = onOff;\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  SyncRowsIterator,\r\n};\r\n","import { SyncBaseIterator } from './SyncBaseIterator';\r\n\r\nclass SyncColsIterator extends SyncBaseIterator {\r\n\r\n  nextRow() {\r\n    const { begin } = this;\r\n    let ci = -1;\r\n    this.setLoop((i) => {\r\n      if (i !== begin) {\r\n        ci = i;\r\n        return false;\r\n      }\r\n      return true;\r\n    }).execute();\r\n    return ci;\r\n  }\r\n\r\n  static getInstance() {\r\n    return new SyncColsIterator();\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  SyncColsIterator,\r\n};\r\n","class AsyncBaseIterator {\r\n\r\n  constructor() {\r\n    this.finishCallback = () => {};\r\n    this.loopCallback = () => {};\r\n    this.nextCallback = () => {};\r\n    this.begin = 0;\r\n    this.end = 0;\r\n    this.handle = null;\r\n    this.status = AsyncBaseIterator.STATUS.DEFAULT;\r\n  }\r\n\r\n  doWhile(condition, callback, finish) {\r\n    this.handle = setTimeout(() => {\r\n      const result = callback();\r\n      if (result !== false) {\r\n        if (condition()) {\r\n          if (this.handle) {\r\n            this.doWhile(condition, callback, finish);\r\n          }\r\n        } else {\r\n          this.status = AsyncBaseIterator.STATUS.FINISH;\r\n          finish();\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  stop() {\r\n    clearTimeout(this.handle);\r\n    this.handle = null;\r\n  }\r\n\r\n  setEnd(end) {\r\n    this.end = end;\r\n    return this;\r\n  }\r\n\r\n  setBegin(begin) {\r\n    this.begin = begin;\r\n    return this;\r\n  }\r\n\r\n  execute() {\r\n    this.status = AsyncBaseIterator.STATUS.DEFAULT;\r\n    const {\r\n      loopCallback, nextCallback,\r\n    } = this;\r\n    const {\r\n      begin, end,\r\n    } = this;\r\n    let i;\r\n    if (begin > end) {\r\n      i = begin;\r\n      this.doWhile(() => i >= end, () => {\r\n        const result = loopCallback(i);\r\n        nextCallback(i);\r\n        i -= 1;\r\n        return result;\r\n      }, () => {\r\n        this.finishCallback(i);\r\n      });\r\n    } else {\r\n      i = begin;\r\n      this.doWhile(() => i <= end, () => {\r\n        const result = loopCallback(i);\r\n        nextCallback(i);\r\n        i += 1;\r\n        return result;\r\n      }, () => {\r\n        this.finishCallback(i);\r\n      });\r\n    }\r\n    return this;\r\n  }\r\n\r\n  setLoop(callback) {\r\n    this.loopCallback = callback;\r\n    return this;\r\n  }\r\n\r\n  setNext(callback) {\r\n    this.nextCallback = callback;\r\n    return this;\r\n  }\r\n\r\n  setFinish(callback) {\r\n    this.finishCallback = callback;\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nAsyncBaseIterator.STATUS = {\r\n  FINISH: 1,\r\n  DEFAULT: 2,\r\n};\r\n\r\nexport {\r\n  AsyncBaseIterator,\r\n};\r\n","import { AsyncBaseIterator } from './AsyncBaseIterator';\r\n\r\nlet fold = [];\r\n\r\nclass AsyncRowIterator extends AsyncBaseIterator {\r\n\r\n  static getInstance() {\r\n    return new AsyncRowIterator();\r\n  }\r\n\r\n  static setFold(value) {\r\n    fold = value;\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.skipCallback = () => {};\r\n    this.useFold = true;\r\n  }\r\n\r\n  setSkip(callback) {\r\n    this.skipCallback = callback;\r\n    return this;\r\n  }\r\n\r\n  hasFold() {\r\n    let find = false;\r\n    this.setLoop((i) => {\r\n      if (fold[i]) {\r\n        find = true;\r\n        return false;\r\n      }\r\n      return true;\r\n    }).foldOnOff(false).execute();\r\n    return find;\r\n  }\r\n\r\n  execute() {\r\n    this.status = AsyncBaseIterator.STATUS.DEFAULT;\r\n    const {\r\n      loopCallback, nextCallback, skipCallback,\r\n    } = this;\r\n    const {\r\n      begin, end, useFold,\r\n    } = this;\r\n    let i;\r\n    if (begin > end) {\r\n      i = begin;\r\n      this.doWhile(() => i >= end, () => {\r\n        if (useFold && fold[i]) {\r\n          skipCallback(i);\r\n          return true;\r\n        }\r\n        const result = loopCallback(i);\r\n        nextCallback(i);\r\n        i -= 1;\r\n        return result;\r\n      }, () => {\r\n        this.finishCallback(i);\r\n      });\r\n    } else {\r\n      i = begin;\r\n      this.doWhile(() => i <= end, () => {\r\n        if (useFold && fold[i]) {\r\n          skipCallback(i);\r\n          return false;\r\n        }\r\n        const result = loopCallback(i);\r\n        nextCallback(i);\r\n        i += 1;\r\n        return result;\r\n      }, () => {\r\n        this.finishCallback(i);\r\n      });\r\n    }\r\n    return this;\r\n  }\r\n\r\n  nextRow() {\r\n    const { begin } = this;\r\n    let ri = -1;\r\n    this.setLoop((i) => {\r\n      if (i !== begin) {\r\n        ri = i;\r\n        return false;\r\n      }\r\n      return true;\r\n    }).execute();\r\n    return ri;\r\n  }\r\n\r\n  foldOnOff(onOff) {\r\n    this.useFold = onOff;\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  AsyncRowIterator,\r\n};\r\n","import { AsyncBaseIterator } from './AsyncBaseIterator';\r\n\r\nclass AsyncColIterator extends AsyncBaseIterator {\r\n\r\n  nextRow() {\r\n    const { begin } = this;\r\n    let ci = -1;\r\n    this.setLoop((i) => {\r\n      if (i !== begin) {\r\n        ci = i;\r\n        return false;\r\n      }\r\n      return true;\r\n    }).execute();\r\n    return ci;\r\n  }\r\n\r\n  static getInstance() {\r\n    return new AsyncColIterator();\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  AsyncColIterator,\r\n};\r\n","import { SyncRowsIterator } from './synchronous/SyncRowsIterator';\r\nimport { SyncColsIterator } from './synchronous/SyncColsIterator';\r\nimport { AsyncRowIterator } from './asynchronous/AsyncRowIterator';\r\nimport { AsyncColIterator } from './asynchronous/AsyncColIterator';\r\n\r\nclass XIteratorBuilder {\r\n\r\n  getRowIterator() {\r\n    return SyncRowsIterator.getInstance();\r\n  }\r\n\r\n  getColIterator() {\r\n    return SyncColsIterator.getInstance();\r\n  }\r\n\r\n  getAsyncRowIterator() {\r\n    return AsyncRowIterator.getInstance();\r\n  }\r\n\r\n  getAsyncColIterator() {\r\n    return AsyncColIterator.getInstance();\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  XIteratorBuilder,\r\n};\r\n","import { SheetUtils } from '../../../utils/SheetUtils';\r\nimport { ScaleAdapter } from '../tablebase/Scale';\r\nimport { RectRange } from '../tablebase/RectRange';\r\nimport { Row } from './Row';\r\nimport { CacheHeight } from './CacheHeight';\r\nimport { XIteratorBuilder } from '../iterator/XIteratorBuilder';\r\nimport { Snapshot } from '../snapshot/Snapshot';\r\nimport { Listen } from '../../../lib/Listen';\r\n\r\nclass Rows {\r\n\r\n  constructor({\r\n    xIteratorBuilder = new XIteratorBuilder(),\r\n    snapshot = new Snapshot(),\r\n    scaleAdapter = new ScaleAdapter(),\r\n    len = 10,\r\n    data = [],\r\n    height = 30,\r\n  } = {}) {\r\n    this.xIteratorBuilder = xIteratorBuilder;\r\n    this.snapshot = snapshot;\r\n    this.scaleAdapter = scaleAdapter;\r\n    this.cacheHeight = new CacheHeight();\r\n    this.listen = new Listen();\r\n    this.min = 5;\r\n    this.len = len;\r\n    this.data = data;\r\n    this.height = SheetUtils.minIf(height, this.min);\r\n    if (this.data.length > this.len) {\r\n      this.len = this.data.length;\r\n    }\r\n  }\r\n\r\n  getOriginDefaultHeight() {\r\n    return this.height;\r\n  }\r\n\r\n  clearCache() {\r\n    this.cacheHeight.clear();\r\n  }\r\n\r\n  setHeight(ri, height) {\r\n    let { listen, scaleAdapter, snapshot } = this;\r\n    let row = this.getOrNew(ri);\r\n    let oldValue = row.height;\r\n    let action = {\r\n      undo: () => {\r\n        row.height = oldValue;\r\n        listen.execute('changeHeight', row);\r\n      },\r\n      redo: () => {\r\n        row.height = scaleAdapter.back(SheetUtils.minIf(height, this.min));\r\n        listen.execute('changeHeight', row);\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  insertRowAfter(ri) {\r\n    let { listen, data, snapshot } = this;\r\n    let action = {\r\n      undo: () => {\r\n        if (SheetUtils.isDef(ri)) {\r\n          if (ri <= data.length) {\r\n            data.splice(ri + 1, 1);\r\n          }\r\n        }\r\n        this.len--;\r\n        listen.execute('insertRowAfter', ri);\r\n      },\r\n      redo: () => {\r\n        if (SheetUtils.isDef(ri)) {\r\n          if (ri <= data.length) {\r\n            data.splice(ri + 1, 0, {});\r\n          }\r\n        }\r\n        this.len++;\r\n        listen.execute('insertRowAfter', ri);\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  insertRowBefore(ri) {\r\n    let { listen, data, snapshot } = this;\r\n    let action = {\r\n      undo: () => {\r\n        if (SheetUtils.isDef(ri)) {\r\n          if (ri <= data.length) {\r\n            data.splice(ri, 1);\r\n          }\r\n        }\r\n        this.len--;\r\n        listen.execute('insertRowBefore', ri);\r\n      },\r\n      redo: () => {\r\n        if (SheetUtils.isDef(ri)) {\r\n          if (ri <= data.length) {\r\n            data.splice(ri, 0, {});\r\n          }\r\n        }\r\n        this.len++;\r\n        listen.execute('insertRowBefore', ri);\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  removeRow(ri) {\r\n    let { listen, data, snapshot } = this;\r\n    let oldValue;\r\n    let action = {\r\n      undo: () => {\r\n        if (SheetUtils.isDef(ri)) {\r\n          if (oldValue) {\r\n            data.splice(ri, 0, oldValue);\r\n          }\r\n        }\r\n        this.len++;\r\n        listen.execute('removeRow', ri);\r\n      },\r\n      redo: () => {\r\n        oldValue = SheetUtils.Undef;\r\n        if (SheetUtils.isDef(ri)) {\r\n          if (ri <= data.length) {\r\n            oldValue = data.splice(ri, 1)[0];\r\n          }\r\n        }\r\n        this.len--;\r\n        listen.execute('removeRow', ri);\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  rectRangeSumHeight(rectRange) {\r\n    if (!rectRange.equals(RectRange.EMPTY)) {\r\n      return this.sectionSumHeight(rectRange.sri, rectRange.eri);\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  sectionSumHeight(sri, eri) {\r\n    let total = 0;\r\n    if (sri > eri) {\r\n      return total;\r\n    }\r\n    const val = this.cacheHeight.get(sri, eri);\r\n    if (val) {\r\n      return val;\r\n    }\r\n    const items = this.cacheHeight.getItems(sri);\r\n    if (items) {\r\n      if (items.min < eri) {\r\n        this.xIteratorBuilder.getRowIterator()\r\n          .setBegin(eri)\r\n          .setEnd(sri)\r\n          .setLoop((i) => {\r\n            const val = items.get(i);\r\n            if (val) {\r\n              total += val;\r\n              return false;\r\n            }\r\n            total += this.getHeight(i);\r\n            return true;\r\n          })\r\n          .execute();\r\n        this.cacheHeight.add(sri, eri, total);\r\n        return total;\r\n      }\r\n    }\r\n    this.xIteratorBuilder.getRowIterator()\r\n      .setBegin(sri)\r\n      .setEnd(eri)\r\n      .setLoop((i) => {\r\n        total += this.getHeight(i);\r\n      })\r\n      .execute();\r\n    this.cacheHeight.add(sri, eri, total);\r\n    return total;\r\n  }\r\n\r\n  get(ri) {\r\n    let row = this.data[ri];\r\n    if (row) {\r\n      if (row instanceof Row) {\r\n        return row;\r\n      }\r\n      row = new Row(ri, row);\r\n      this.data[ri] = row;\r\n    }\r\n    return row;\r\n  }\r\n\r\n  getOrNew(ri) {\r\n    const row = this.get(ri);\r\n    if (row) {\r\n      return row;\r\n    }\r\n    if (ri < 0) {\r\n      throw new TypeError(`错误的行号${ri}`);\r\n    }\r\n    this.data[ri] = new Row(ri, {\r\n      height: this.height,\r\n    });\r\n    return this.data[ri];\r\n  }\r\n\r\n  getMinHeight() {\r\n    const { scaleAdapter } = this;\r\n    return scaleAdapter.goto(this.min);\r\n  }\r\n\r\n  getHeight(ri) {\r\n    if (ri < 0) {\r\n      return 0;\r\n    }\r\n    const { scaleAdapter } = this;\r\n    const row = this.get(ri);\r\n    if (row && row.height) {\r\n      return scaleAdapter.goto(row.height);\r\n    }\r\n    return scaleAdapter.goto(this.height);\r\n  }\r\n\r\n  getDefaultHeight() {\r\n    const { scaleAdapter } = this;\r\n    return scaleAdapter.goto(this.height);\r\n  }\r\n\r\n  getOriginHeight(ri) {\r\n    if (ri < 0) {\r\n      return 0;\r\n    }\r\n    const row = this.get(ri);\r\n    if (row && row.height) {\r\n      return row.height;\r\n    }\r\n    return this.height;\r\n  }\r\n\r\n  eachHeight(ri, ei, cb, sy = 0) {\r\n    let y = sy;\r\n    this.xIteratorBuilder.getRowIterator()\r\n      .setBegin(ri)\r\n      .setEnd(ei)\r\n      .setLoop((i) => {\r\n        const rowHeight = this.getHeight(i);\r\n        cb(i, rowHeight, y);\r\n        y += rowHeight;\r\n      })\r\n      .execute();\r\n  }\r\n\r\n  getData() {\r\n    return {\r\n      min: this.min,\r\n      len: this.len,\r\n      data: this.data,\r\n      height: this.height,\r\n    };\r\n  }\r\n\r\n  syncRowsLen(rows) {\r\n    if (rows) {\r\n      this.len = rows.len;\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport { Rows };\r\n","class Col {\r\n\r\n  constructor(col, {\r\n    width = 130,\r\n  } = {}) {\r\n    this.col = col;\r\n    this.width = width;\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  Col,\r\n};\r\n","class CacheItems {\r\n\r\n  constructor() {\r\n    this.items = [];\r\n    this.min = Infinity;\r\n    this.max = -Infinity;\r\n  }\r\n\r\n  get(eci) {\r\n    return this.items[eci];\r\n  }\r\n\r\n  set(eci, val) {\r\n    this.items[eci] = val;\r\n    if (eci < this.min) {\r\n      this.min = eci;\r\n    }\r\n    if (eci > this.max) {\r\n      this.max = eci;\r\n    }\r\n  }\r\n\r\n}\r\n\r\nclass CacheWidth {\r\n\r\n  constructor() {\r\n    this.cache = [];\r\n  }\r\n\r\n  clear() {\r\n    this.cache = [];\r\n  }\r\n\r\n  get(sci, eci) {\r\n    const items = this.cache[sci];\r\n    return items ? items.get(eci) : null;\r\n  }\r\n\r\n  getItems(sci) {\r\n    return this.cache[sci];\r\n  }\r\n\r\n  add(sci, eci, width) {\r\n    const items = this.cache[sci] || new CacheItems();\r\n    items.set(eci, width);\r\n    this.cache[sci] = items;\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  CacheWidth,\r\n};\r\n","import { SheetUtils } from '../../../utils/SheetUtils';\r\nimport { ScaleAdapter } from '../tablebase/Scale';\r\nimport { RectRange } from '../tablebase/RectRange';\r\nimport { Col } from './Col';\r\nimport { CacheWidth } from './CacheWidth';\r\nimport { XIteratorBuilder } from '../iterator/XIteratorBuilder';\r\nimport { Snapshot } from '../snapshot/Snapshot';\r\nimport { Listen } from '../../../lib/Listen';\r\n\r\nclass Cols {\r\n\r\n  constructor({\r\n    xIteratorBuilder = new XIteratorBuilder(),\r\n    snapshot = new Snapshot(),\r\n    scaleAdapter = new ScaleAdapter(),\r\n    len = 10,\r\n    data = [],\r\n    width = 110,\r\n  } = {}) {\r\n    this.xIteratorBuilder = xIteratorBuilder;\r\n    this.snapshot = snapshot;\r\n    this.scaleAdapter = scaleAdapter;\r\n    this.cacheWidth = new CacheWidth();\r\n    this.listen = new Listen();\r\n    this.min = 5;\r\n    this.len = len;\r\n    this.data = data;\r\n    this.width = SheetUtils.minIf(width, this.min);\r\n    if (this.data.length > this.len) {\r\n      this.len = this.data.length;\r\n    }\r\n  }\r\n\r\n  getOriginDefaultWidth() {\r\n    return this.width;\r\n  }\r\n\r\n  clearCache() {\r\n    this.cacheWidth.clear();\r\n  }\r\n\r\n  setWidth(ci, width) {\r\n    let { listen, scaleAdapter, snapshot } = this;\r\n    let col = this.getOrNew(ci);\r\n    let oldValue = col.width;\r\n    let action = {\r\n      undo: () => {\r\n        col.width = oldValue;\r\n        listen.execute('changeWidth', col);\r\n      },\r\n      redo: () => {\r\n        col.width = scaleAdapter.back(SheetUtils.minIf(width, this.min));\r\n        listen.execute('changeWidth', col);\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  insertColAfter(ci) {\r\n    let { listen, data, snapshot } = this;\r\n    let action = {\r\n      undo: () => {\r\n        if (SheetUtils.isDef(ci)) {\r\n          if (ci <= data.length) {\r\n            data.splice(ci + 1, 1);\r\n          }\r\n        }\r\n        this.len--;\r\n        listen.execute('insertColAfter', ci);\r\n      },\r\n      redo: () => {\r\n        if (SheetUtils.isDef(ci)) {\r\n          if (ci <= data.length) {\r\n            data.splice(ci + 1, 0, {});\r\n          }\r\n        }\r\n        this.len++;\r\n        listen.execute('insertColAfter', ci);\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  insertColBefore(ci) {\r\n    let { listen, data, snapshot } = this;\r\n    let action = {\r\n      undo: () => {\r\n        if (SheetUtils.isDef(ci)) {\r\n          if (ci <= data.length) {\r\n            data.splice(ci, 1);\r\n          }\r\n        }\r\n        this.len--;\r\n        listen.execute('insertColBefore', ci);\r\n      },\r\n      redo: () => {\r\n        if (SheetUtils.isDef(ci)) {\r\n          if (ci <= data.length) {\r\n            data.splice(ci, 0, {});\r\n          }\r\n        }\r\n        this.len++;\r\n        listen.execute('insertColBefore', ci);\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  removeCol(ci) {\r\n    let { listen, data, snapshot } = this;\r\n    let oldValue;\r\n    let action = {\r\n      undo: () => {\r\n        if (SheetUtils.isDef(ci)) {\r\n          if (oldValue) {\r\n            data.splice(ci, 0, oldValue);\r\n          }\r\n        }\r\n        this.len++;\r\n        listen.execute('removeCol', ci);\r\n      },\r\n      redo: () => {\r\n        oldValue = SheetUtils.Undef;\r\n        if (SheetUtils.isDef(ci)) {\r\n          if (ci <= data.length) {\r\n            oldValue = data.splice(ci, 1)[0];\r\n          }\r\n        }\r\n        this.len--;\r\n        listen.execute('removeCol', ci);\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  sectionSumWidth(sci, eci) {\r\n    let total = 0;\r\n    if (sci > eci) {\r\n      return total;\r\n    }\r\n    const val = this.cacheWidth.get(sci, eci);\r\n    if (val) {\r\n      return val;\r\n    }\r\n    const items = this.cacheWidth.getItems(sci);\r\n    if (items) {\r\n      if (items.min < eci) {\r\n        this.xIteratorBuilder.getColIterator()\r\n          .setBegin(eci)\r\n          .setEnd(sci)\r\n          .setLoop((i) => {\r\n            const val = items.get(i);\r\n            if (val) {\r\n              total += val;\r\n              return false;\r\n            }\r\n            total += this.getWidth(i);\r\n            return true;\r\n          })\r\n          .execute();\r\n        this.cacheWidth.add(sci, eci, total);\r\n        return total;\r\n      }\r\n    }\r\n    this.xIteratorBuilder.getColIterator()\r\n      .setBegin(sci)\r\n      .setEnd(eci)\r\n      .setLoop((i) => {\r\n        total += this.getWidth(i);\r\n      })\r\n      .execute();\r\n    this.cacheWidth.add(sci, eci, total);\r\n    return total;\r\n  }\r\n\r\n  rectRangeSumWidth(rectRange) {\r\n    if (!rectRange.equals(RectRange.EMPTY)) {\r\n      return this.sectionSumWidth(rectRange.sci, rectRange.eci);\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  get(ci) {\r\n    let col = this.data[ci];\r\n    if (col) {\r\n      if (col instanceof Col) {\r\n        return col;\r\n      }\r\n      col = new Col(ci, col);\r\n      this.data[ci] = col;\r\n    }\r\n    return col;\r\n  }\r\n\r\n  getOrNew(ci) {\r\n    const col = this.get(ci);\r\n    if (col) {\r\n      return col;\r\n    }\r\n    if (ci < 0) {\r\n      throw new TypeError(`错误的列号${ci}`);\r\n    }\r\n    this.data[ci] = new Col(ci, {\r\n      width: this.width,\r\n    });\r\n    return this.data[ci];\r\n  }\r\n\r\n  getMinWidth() {\r\n    const { scaleAdapter } = this;\r\n    return scaleAdapter.goto(this.min);\r\n  }\r\n\r\n  getWidth(ci) {\r\n    if (ci < 0) {\r\n      return 0;\r\n    }\r\n    const { scaleAdapter } = this;\r\n    const col = this.data[ci];\r\n    if (col && col.width) {\r\n      return scaleAdapter.goto(col.width);\r\n    }\r\n    return scaleAdapter.goto(this.width);\r\n  }\r\n\r\n  getDefaultWidth() {\r\n    const { scaleAdapter } = this;\r\n    return scaleAdapter.goto(this.width);\r\n  }\r\n\r\n  getOriginWidth(ci) {\r\n    if (ci < 0) {\r\n      return 0;\r\n    }\r\n    const col = this.data[ci];\r\n    if (col && col.width) {\r\n      return col.width;\r\n    }\r\n    return this.width;\r\n  }\r\n\r\n  eachWidth(ci, ei, cb, sx = 0) {\r\n    let x = sx;\r\n    this.xIteratorBuilder.getColIterator()\r\n      .setBegin(ci)\r\n      .setEnd(ei)\r\n      .setLoop((i) => {\r\n        const colWidth = this.getWidth(i);\r\n        cb(i, colWidth, x);\r\n        x += colWidth;\r\n      })\r\n      .execute();\r\n  }\r\n\r\n  getData() {\r\n    return {\r\n      min: this.min,\r\n      len: this.len,\r\n      data: this.data,\r\n      width: this.width,\r\n    };\r\n  }\r\n\r\n  syncColsLen(cols) {\r\n    if (cols) {\r\n      this.len = cols.len;\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport { Cols };\r\n","/* global Blob */\r\nimport { Workbook } from 'exceljs';\r\nimport { XDraw } from '../../draw/XDraw';\r\nimport { ColorPicker } from '../../module/colorpicker/ColorPicker';\r\nimport { BaseFont } from '../../draw/font/BaseFont';\r\nimport { SheetUtils } from '../../utils/SheetUtils';\r\nimport { Cell } from '../../core/table/tablecell/Cell';\r\nimport { LINE_TYPE } from '../../draw/Line';\r\nimport { SelectFile } from '../../lib/SelectFile';\r\nimport { HeightUnit } from '../../core/table/tableunit/HeightUnit';\r\nimport { WideUnit } from '../../core/table/tableunit/WideUnit';\r\nimport { Rows } from '../../core/table/tablerow/Rows';\r\nimport { Cols } from '../../core/table/tablecol/Cols';\r\nimport { Merges } from '../../core/table/merges/Merges';\r\nimport { Cells } from '../../core/table/tablecell/Cells';\r\n\r\nfunction next(i, step = 1) {\r\n  return i + step;\r\n}\r\n\r\nfunction last(i, step = 1) {\r\n  return i - step;\r\n}\r\n\r\n/**\r\n * XLSX 文件导出\r\n */\r\nclass XlsxExport {\r\n\r\n  /**\r\n   * XlsxExport\r\n   * @param workOptions\r\n   * @param sheetList\r\n   * @param dpr\r\n   * @param unit\r\n   * @param dpi\r\n   */\r\n  constructor({\r\n    workOptions, sheetList, dpr, unit, dpi,\r\n  }) {\r\n    XDraw.refresh(dpr);\r\n    this.workOptions = workOptions;\r\n    this.sheetList = sheetList;\r\n    this.heightUnit = new HeightUnit({\r\n      dpi,\r\n    });\r\n    this.wideUnit = new WideUnit({\r\n      unit,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 导出XLSX文件\r\n   * @returns {Promise<Blob>}\r\n   */\r\n  async export() {\r\n    const { workOptions, sheetList } = this;\r\n    // exceljs 在内存中构建xlsx文件\r\n    // 使得导出时数据量过大就会\r\n    // 占用大量内存,导致浏览器崩溃\r\n    // 暂无处理方法, 再想想办法\r\n    // TODO .....\r\n    // .....\r\n    // 创建工作薄\r\n    const workbook = new Workbook();\r\n    workbook.created = workOptions.created;\r\n    workbook.creator = workOptions.creator;\r\n    workbook.modified = workOptions.modified;\r\n    workbook.lastModifiedBy = workOptions.lastModifiedBy;\r\n    // 添加工作表\r\n    sheetList.forEach((sheet) => {\r\n      const { name, tableConfig } = sheet;\r\n      const { table, merge } = tableConfig;\r\n      const { rows, cols, data } = tableConfig;\r\n      // 初始化配置数据\r\n      const xMerges = new Merges({\r\n        ...merge,\r\n      });\r\n      const xCells = new Cells({\r\n        data,\r\n      });\r\n      const xCols = new Cols(cols);\r\n      const xRows = new Rows(rows);\r\n      // 创建工作表\r\n      const worksheet = workbook.addWorksheet(name);\r\n      // 默认宽高\r\n      worksheet.defaultRowHeight = this.rowHeight(xRows.getOriginDefaultHeight());\r\n      worksheet.defaultColWidth = this.colWidth(xCols.getOriginDefaultWidth());\r\n      // 是否显示网格\r\n      worksheet.views = [{\r\n        showGridLines: table.showGrid,\r\n      }];\r\n      // 处理列宽\r\n      const sheetColumns = [];\r\n      xCols.eachWidth(0, last(xCols.len), (col) => {\r\n        const srcWidth = xCols.getOriginWidth(col);\r\n        const colWidth = this.colWidth(srcWidth);\r\n        sheetColumns.push({\r\n          width: colWidth,\r\n        });\r\n      });\r\n      worksheet.columns = sheetColumns;\r\n      // 处理数据\r\n      let row = 0;\r\n      while (xCells.getLength() > 0 && row < xRows.len) {\r\n        let items = xCells.shift();\r\n        let col = 0;\r\n        if (items) {\r\n          const origin = xRows.getOriginHeight(row);\r\n          const height = this.rowHeight(origin);\r\n          const workRow = worksheet.getRow(next(row));\r\n          workRow.height = height;\r\n          while (items.length > 0 && col < xCols.len) {\r\n            const config = items.shift();\r\n            if (config) {\r\n              const cell = Cells.wrapCell(config);\r\n              const { contentType, background } = cell;\r\n              const { text, fontAttr, borderAttr } = cell;\r\n              const { top, right, left, bottom } = borderAttr;\r\n              const workCell = workRow.getCell(next(col));\r\n              // 单元格文本\r\n              if (text) {\r\n                switch (contentType) {\r\n                  case Cell.TYPE.NUMBER:\r\n                    workCell.value = SheetUtils.parseFloat(text);\r\n                    break;\r\n                  case Cell.TYPE.STRING:\r\n                    workCell.value = text;\r\n                    break;\r\n                }\r\n              }\r\n              // 字体样式\r\n              workCell.font = {\r\n                name: fontAttr.name,\r\n                color: {\r\n                  argb: ColorPicker.parseRgbToHex(fontAttr.color),\r\n                },\r\n                size: this.fontSize(fontAttr.size),\r\n                italic: fontAttr.italic,\r\n                bold: fontAttr.bold,\r\n                underline: fontAttr.underline,\r\n                strike: fontAttr.strikethrough,\r\n              };\r\n              // 对齐方式\r\n              workCell.alignment = {\r\n                vertical: fontAttr.verticalAlign,\r\n                horizontal: fontAttr.align,\r\n                wrapText: fontAttr.textWrap === BaseFont.TEXT_WRAP.WORD_WRAP,\r\n              };\r\n              switch (fontAttr.direction) {\r\n                case BaseFont.TEXT_DIRECTION.VERTICAL:\r\n                  workCell.alignment.textRotation = 'vertical';\r\n                  break;\r\n                case BaseFont.TEXT_DIRECTION.ANGLE:\r\n                case BaseFont.TEXT_DIRECTION.ANGLE_BAR:\r\n                  workCell.alignment.textRotation = fontAttr.angle;\r\n                  break;\r\n              }\r\n              // 单元格背景\r\n              if (background) {\r\n                workCell.fill = {\r\n                  type: 'pattern',\r\n                  pattern: 'solid',\r\n                  fgColor: { argb: ColorPicker.parseRgbToHex(background) },\r\n                };\r\n              }\r\n              // 单元格边框\r\n              workCell.border = {\r\n                top: {}, left: {}, right: {}, bottom: {},\r\n              };\r\n              if (top.display) {\r\n                const { widthType, type, color } = borderAttr.top;\r\n                workCell.border.top.style = this.borderType(widthType, type);\r\n                workCell.border.top.color = {\r\n                  argb: ColorPicker.parseRgbToHex(color),\r\n                };\r\n              }\r\n              if (right.display) {\r\n                const { widthType, type, color } = borderAttr.right;\r\n                workCell.border.right.style = this.borderType(widthType, type);\r\n                workCell.border.right.color = {\r\n                  argb: ColorPicker.parseRgbToHex(color),\r\n                };\r\n              }\r\n              if (left.display) {\r\n                const { widthType, type, color } = borderAttr.left;\r\n                workCell.border.left.style = this.borderType(widthType, type);\r\n                workCell.border.left.color = {\r\n                  argb: ColorPicker.parseRgbToHex(color),\r\n                };\r\n              }\r\n              if (bottom.display) {\r\n                const { widthType, type, color } = borderAttr.bottom;\r\n                workCell.border.bottom.style = this.borderType(widthType, type);\r\n                workCell.border.bottom.color = {\r\n                  argb: ColorPicker.parseRgbToHex(color),\r\n                };\r\n              }\r\n            }\r\n            col++;\r\n          }\r\n        }\r\n        row++;\r\n      }\r\n      // 处理合并\r\n      xMerges.getAll().forEach((xMergeRange) => {\r\n        const { sri, sci, eri, eci } = xMergeRange;\r\n        worksheet.mergeCells(next(sri), next(sci), next(eri), next(eci));\r\n      });\r\n    });\r\n    // 返回文件信息\r\n    const data = await workbook.xlsx.writeBuffer();\r\n    return new Blob([data], {\r\n      type: SelectFile.ACCEPT.XLSX,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 字体大小转换\r\n   * @param value\r\n   */\r\n  fontSize(value) {\r\n    const pixel = XDraw.stylePx(value);\r\n    return this.heightUnit.getPoint(pixel);\r\n  }\r\n\r\n  /**\r\n   * 行高转换\r\n   * @param value\r\n   */\r\n  rowHeight(value) {\r\n    const pixel = XDraw.stylePx(value);\r\n    return this.heightUnit.getPoint(pixel);\r\n  }\r\n\r\n  /**\r\n   * 列宽转换\r\n   * @param value\r\n   */\r\n  colWidth(value) {\r\n    return XDraw.dpr() > 1\r\n      ? this.wideUnit.getPixelNumber(value + 5)\r\n      : this.wideUnit.getPixelNumber(value - 5);\r\n  }\r\n\r\n  /**\r\n   * 边框类型转换\r\n   * @param value\r\n   * @param type\r\n   * @returns {string}\r\n   */\r\n  borderType(value, type) {\r\n    switch (type) {\r\n      case LINE_TYPE.SOLID_LINE: {\r\n        switch (value) {\r\n          case XDraw.LINE_WIDTH_TYPE.low:\r\n            return 'thin';\r\n          case XDraw.LINE_WIDTH_TYPE.medium:\r\n            return 'medium';\r\n          case XDraw.LINE_WIDTH_TYPE.high:\r\n            return 'thick';\r\n        }\r\n        break;\r\n      }\r\n      case LINE_TYPE.POINT_LINE:\r\n        return 'dashDot';\r\n      case LINE_TYPE.DOTTED_LINE: {\r\n        return 'dotted';\r\n      }\r\n      case LINE_TYPE.DOUBLE_LINE:\r\n        return 'double';\r\n    }\r\n    return 'thick';\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  XlsxExport,\r\n};\r\n","import { XlsxExport } from '../../io/xlsx/XlsxExport';\r\n\r\nself.addEventListener('message', async (event) => {\r\n  const { workOptions, sheetList, dpr, unit, dpi } = event.data;\r\n  const xlsx = new XlsxExport({\r\n    workOptions, sheetList, dpr, unit, dpi,\r\n  });\r\n  self.postMessage(await xlsx.export());\r\n});\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = () => {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [295,924,457], () => (__webpack_require__(1766)))\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"js/\" + chunkId + \".js\";\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl + \"../\";","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t766: 1\n};\n\n// importScripts chunk loading\nvar installChunk = (data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = (chunkId, promises) => {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkx_sheet\"] = self[\"webpackChunkx_sheet\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["root","factory","exports","module","define","amd","self","deferred","next","SelectFile","Element","constructor","multiple","accept","super","this","attr","async","XEvent","val","Promise","resolve","files","el","length","trigger","binSearch","fn","min","max","mid","findFirstPositive","start","ACCEPT","XLSX","CVS","TXT","IMAGE","HeightUnit","dpi","SheetUtils","x","matchMedia","matches","getDpi","getPixel","pt","getPoint","px","WideUnit","table","unit","fontName","fontSize","fontBold","fontItalic","draw","heightUnit","fontPixel","srcPixel","XDraw","style","save","font","trim","i","width","measureText","toString","restore","type","getUnit","getNumberPixel","nb","getWidePixel","getNumberWide","wide","getPixelNumber","pixel","ScaleAdapter","goto","v","back","Row","row","height","reCkHasAngle","hasAngelCell","setHasAngelCell","value","setReCkHasAngle","CacheItems","items","Infinity","get","eri","set","CacheHeight","cache","clear","sri","getItems","add","SyncBaseIterator","finishCallback","loopCallback","nextCallback","end","begin","setBegin","setEnd","execute","setLoop","callback","setNext","setFinish","fold","SyncRowsIterator","static","skipCallback","useFold","setSkip","nextRow","ri","hasFold","find","foldOnOff","onOff","SyncColsIterator","ci","AsyncBaseIterator","handle","status","STATUS","DEFAULT","doWhile","condition","finish","setTimeout","FINISH","stop","clearTimeout","result","AsyncRowIterator","AsyncColIterator","XIteratorBuilder","getRowIterator","getInstance","getColIterator","getAsyncRowIterator","getAsyncColIterator","Rows","xIteratorBuilder","snapshot","Snapshot","scaleAdapter","len","data","cacheHeight","listen","Listen","getOriginDefaultHeight","clearCache","setHeight","getOrNew","oldValue","action","undo","redo","addAction","insertRowAfter","splice","insertRowBefore","removeRow","rectRangeSumHeight","rectRange","equals","RectRange","sectionSumHeight","total","getHeight","TypeError","getMinHeight","getDefaultHeight","getOriginHeight","eachHeight","ei","cb","sy","y","rowHeight","getData","syncRowsLen","rows","Col","col","eci","CacheWidth","sci","Cols","cacheWidth","getOriginDefaultWidth","setWidth","insertColAfter","insertColBefore","removeCol","sectionSumWidth","getWidth","rectRangeSumWidth","getMinWidth","getDefaultWidth","getOriginWidth","eachWidth","sx","colWidth","syncColsLen","cols","step","XlsxExport","workOptions","sheetList","dpr","wideUnit","workbook","Workbook","created","creator","modified","lastModifiedBy","forEach","sheet","name","tableConfig","merge","xMerges","Merges","xCells","Cells","xCols","xRows","worksheet","addWorksheet","defaultRowHeight","defaultColWidth","views","showGridLines","showGrid","sheetColumns","last","srcWidth","push","columns","getLength","shift","origin","workRow","getRow","config","cell","contentType","background","text","fontAttr","borderAttr","top","right","left","bottom","workCell","getCell","Cell","color","argb","ColorPicker","size","italic","bold","underline","strike","strikethrough","alignment","vertical","verticalAlign","horizontal","align","wrapText","textWrap","BaseFont","direction","textRotation","angle","fill","pattern","fgColor","border","display","widthType","borderType","getAll","xMergeRange","mergeCells","xlsx","writeBuffer","Blob","addEventListener","event","postMessage","export","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","m","__webpack_exports__","O","chunkIds","priority","notFulfilled","fulfilled","j","Object","keys","every","key","r","d","definition","o","defineProperty","enumerable","f","e","chunkId","all","reduce","promises","u","miniCssF","g","globalThis","Function","window","obj","prop","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","src","scripts","getElementsByTagName","Error","replace","p","installedChunks","chunkLoadingGlobal","parentChunkLoadingFunction","bind","moreModules","runtime","pop","map","then"],"sourceRoot":""}