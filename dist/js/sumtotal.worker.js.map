{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/utils/SheetUtils.js","webpack:///./src/draw/font/BaseFont.js","webpack:///./src/lib/Element.js","webpack:///./src/const/Constant.js","webpack:///./src/lib/XEvent.js","webpack:///./src/lib/Widget.js","webpack:///./src/core/work/head/tool/Icon.js","webpack:///./src/module/dragpanel/DragPanel.js","webpack:///./src/module/colorpicker/ColorPicker.js","webpack:///./src/module/colorpicker/colorarray/ColorItem.js","webpack:///./src/module/colorpicker/colorarray/ColorArray.js","webpack:///./src/core/table/tablecell/CellFont.js","webpack:///./src/draw/XDraw.js","webpack:///./src/draw/Line.js","webpack:///./src/core/table/tablecell/Border.js","webpack:///./src/core/table/tablecell/CellBorder.js","webpack:///./src/draw/Rect.js","webpack:///./src/core/table/tableicon/XIconOffset.js","webpack:///./src/draw/Crop.js","webpack:///./src/core/table/tableicon/XIcon.js","webpack:///./src/utils/DateUtils.js","webpack:///./src/core/table/XTableTextFormat.js","webpack:///./src/core/table/tablecell/RichFont.js","webpack:///./src/core/table/tablecell/RichFonts.js","webpack:///./src/formula/Compiler.js","webpack:///./src/formula/Formula.js","webpack:///./src/core/table/tablecell/Cell.js","webpack:///./src/lib/Listen.js","webpack:///./src/core/table/tablebase/RectRange.js","webpack:///./src/core/table/snapshot/Snapshot.js","webpack:///./src/lib/recttree/QkSelect.js","webpack:///./src/lib/recttree/RectTree.js","webpack:///./src/utils/RtreeUtils.js","webpack:///./src/core/table/tablebase/RangeTree.js","webpack:///./src/core/table/merges/Merges.js","webpack:///./src/core/table/tablecell/Cells.js","webpack:///./src/task/worker/sumtotal.worker.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","S4","Math","random","toString","substring","alphabets","DATA_TYPE","String","Boolean","Number","Array","Function","Null","Undefined","Promise","GeneratorFunction","AsyncFunction","BigInt","DedicatedWorkerGlobalScope","Date","RegExp","Un","SheetUtils","test","navigator","userAgent","isEmptyObject","e","this","isUnDef","type","EX","length","trim","obj","getPrototypeOf","parent","str","toLowerCase","arg","sources","forEach","source","keys","v","isArray","isPlainObject","copy","json","JSON","stringify","parse","target","len","item","isDef","objOrAry","cb","total","size","val","isNumber","parseFloat","parseInt","index","idx","ret","charCodeAt","expoNet","src","x","y","charAt","indexAt","stringAt","xn","yn","expr2xy","xy2expr","min","range","window","getSelection","selectAllChildren","collapseToEnd","isBlank","now","width","innerWidth","height","innerHeight","document","exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","element","el","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","webkitIsFullScreen","mozFullScreen","msFullscreenElement","fullscreenElement","one","tow","diffValue","oneValue","towValue","diffArrays","isObject","oneKeys","towKeys","includes","diffObject","isDate","getTime","isRegExp","num","fixed","indexOf","toFixed","explorer","version","match","array","isString","replace","EMPTY","defaultValue","self","condition","establish","otherwise","likeArray","slice","Nul","Undef","undefined","noop","BaseFont","draw","ruler","attr","align","ALIGN","center","padding","verticalAlign","VERTICAL_ALIGN","top","bottom","left","right","TEXT_WRAP","OVER_FLOW","WORD_WRAP","TRUNCATE","TEXT_DIRECTION","HORIZONTAL","VERTICAL","ANGLE","ANGLE_BAR","DEFAULT_FONT_ATTR","color","bold","italic","strikethrough","underline","angle","textWrap","direction","DEFAULT_RICH_ATTR","DEFAULT_RICH_ITEM_ATTR","Element","tag","className","createElement","map","HTMLCollection","NodeList","elements","push","text","createTextNode","args","arguments","wrapElement","children","ele","append","childNodes","isTextNode","childrenNodes","prepend","k","css","offsetTop","offsetLeft","offsetHeight","offsetWidth","parentNode","classList","add","contains","remove","getBoundingClientRect","firstChild","lastChild","find","handle","elem","hasChild","reverse","removeChild","previousSibling","nextSibling","flag","cls","addClass","removeClass","nodeValue","innerText","html","innerHTML","focus","blur","removeAttribute","style","setAttribute","getAttribute","removeProperty","hyphenateRE","newValue","getPropertyValue","setProperty","getComputedStyle","computedStyle","display","message","evt","MouseEvent","detail","bubbles","cancelable","initEvent","dispatchEvent","CustomEvent","select","result","querySelectorAll","sibling","previousElementSibling","nextElementSibling","nodeName","toLocaleLowerCase","nodeType","after","before","cloneNode","other","equals","tagName","DocumentFragment","h","Constant","WORK_BODY_EVENT_TYPE","CHANGE_ACTIVE","REMOVE_SHEET","SYSTEM_EVENT_TYPE","MOUSE_MOVE","MOUSE_DOWN","CONTEXT_MENU","SCROLL","RESIZE","MOUSE_UP","INPUT","KEY_DOWN","KEY_UP","MOUSE_OVER","MOUSE_LEAVE","MOUSE_WHEEL","MOUSE_ENTER","CLICK","FOCUS","DRAG_START","CHANGE","VISIBILITY_CHANGE","TABLE_EVENT_TYPE","RENDER","SNAPSHOT_CHANGE","CHANGE_ROW_HEIGHT","CHANGE_COL_WIDTH","SCALE_CHANGE","EDIT_START","EDIT_INPUT","EDIT_FINISH","REMOVE_ROW","REMOVE_COL","ADD_NEW_ROW","ADD_NEW_COL","FIXED_CHANGE","FIXED_COL_CHANGE","FIXED_ROW_CHANGE","SELECT_OVER","SELECT_DOWN","SELECT_CHANGE","DATA_CHANGE","RESIZE_CHANGE","FORM_EVENT_TYPE","SEARCH_INPUT_CHANGE","PLAIN_INPUT_CHANGE","FORM_SELECT_CHANGE","pool","callback","option","removeEventListener","addEventListener","rem","eqElem","eqOpt","eqType","eqCall","eles","unbind","XEvent","fn","multipleUnbind","multipleBind","holdFunc","endFunc","time","setInterval","xEvtUp","clearInterval","moveFunc","upFunc","xEvtMove","stopPropagation","preventDefault","WrapFuncion","doubleClick","lastPageX","lastPageY","lastTime","event","button","pageX","pageY","current","mouseClick","Widget","$$rootFlag","clazz","node","body","is","hasClass","data","widget","parentWidget","onAttach","box","clientY","clientX","Icon","iconNameEl","instances","DragPanel","options","position","DRAG_PANEL_POSITION","CENTER","status","mask","content","instance","filter","close","root","getRootWidget","dragPanelLocation","evt1","downEventXy","eventXy","mouseMoveUp","evt2","offset","rootBox","elemBox","LEFT","RIGHT","TOP","removeInstance","ColorPicker","selectCb","dragPanel","preViewColorPoint","colorValueTips","colorInput","selectColorPoint","selectColorArea1","selectColorArea2","selectColorArea3","colorHuxTips","colorBar","colorBarPoint","cancelButton","selectButton","buttons","hex","join","hsx","max","rgb","startsWith","isHex","hexToRgb","g","b","parseRgb","rgbToHsb","hsb","delta","t1","t2","t3","round","nr","rgbToHex","hsbToRgb","e1","hexColor","xy","colorBarBox","downHue","e2","moveHue","centerBox","downSelect","moveSelect","fixHsx","open","isRgb","change","colorBarPointBox","colorBarPointLeft","selectColorPointBox","selectColorPointLeft","selectColorPointTop","colorValue","hsbToHex","areaColorValue","sliderPosition","hueChange","selectChange","hexToHsb","fixHex","destroy","ColorItem","icon","blankClear","isDark","checkedIcon","hide","active","show","ColorArray","colors","activeColor","setActiveByColor","findIndex","setActive","empty","BLACK","WHITE","CellFont","keys1","keys2","clearBlank","getInstance","config","DPR","inWorker","devicePixelRatio","LINE_WIDTH_LOW","LINE_WIDTH_MEDIUM","LINE_WIDTH_HIGH","LINE_PIXEL_OFFSET","Base","canvas","ctx","getContext","px","dpr","srcPx","stylePx","ceil","trunc","PI","CorsLine","lineWidthType","LINE_WIDTH_TYPE","low","lineColor","medium","high","sx","sy","ex","ey","lineWidth","strokeStyle","polyStroke","xys","getOffsetX","getOffsetY","TypeError","corsLine","linePx","pixel","offsetX","offsetY","interpolation","beginPath","moveTo","lineTo","stroke","fill","fillRect","radian","dash","measureText","save","restore","clip","setLineDash","scale","translate","deg","rotate","XDraw","fillText","path","polyInFill","points","w","rect","sw","sh","tx","ty","tw","th","drawImage","LINE_TYPE","DoubleLine","widthType","spacing","leftShow","topShow","rightShow","bottomShow","iFMerge","iFMergeFirstRow","iFMergeLastRow","iFMergeFirstCol","iFMergeLastCol","row","col","pos","external","ifMerge","firstRow","lastRow","firstCol","lastCol","sTopLeftCorner","sTop","sBottom","eBottomLeftCorner","eBottom","eTop","sLeft","sRight","eTopRightCorner","eRight","eLeft","sTopRightCorner","eBottomRightCorner","sBottomLeftCorner","internal","setLineColor","setLineWidthType","handleExternal","handleInternal","horizonLine","verticalLine","zIndexID","Border","zIndex","border","origin","getZIndex","CellBorder","setBDisplay","setLDisplay","setTDisplay","setRDisplay","setDisplay","setBColor","setLColor","setTColor","setRColor","setColor","setBWidthType","setLWidthType","setTWidthType","setRWidthType","setWidthType","setBType","setLType","setTType","setRType","setType","setZIndex","clone","Rect","XIconOffset","Crop","XIcon","vertical","ICON_VERTICAL","horizontal","ICON_HORIZONTAL","ICON_TYPE","image","iconFocus","onDraw","onLeave","onMove","onDown","onEnter","icons","iconHorizontal","iconVertical","iconOffsetX","iconOffsetY","iconWidth","iconHeight","rectX","rectY","rectWidth","rectHeight","py","BOTTOM","load","sync","Image","loadImg","complete","onload","onerror","console","error","drawCustom","positionRect","include","includeRect","crop","fillStyle","native","location","inRectPosition","activate","ICON_EVENT_TYPE","includePoint","setActivate","custom","newInstances","DateUtils","fmt","date","getMonth","getDate","getHours","getMinutes","getSeconds","floor","S","getMilliseconds","resultYear","exec","yearFormatPart","yearVal","getFullYear","substr","res","Val","formatPart","replaceVal","parserToDate","dateText","format","defaultVal","reg","year","month","day","hours","minutes","seconds","milliseconds","j","oneChar","onePart","onePartReg","dataInfo","isFraction","split","toExponential","dateFormat","RichFont","scaleAdapter","ignore","RichFonts","rich","font","each","reset","plain","item1","item2","like","Functions","functions","toLocaleString","func","Assembly","assembly","endsWith","op","Tokenizer","syntaxCheck","input","OPERATOR","NUMBERS","SPACE","LETTERS","bracketsStack","tokens","char","next","last","brackets","pop","syntax","sQuotesStack","dQuotesStack","callStack","arrayStack","ignoreArray","token","ignoreFunc","skipIgnoreToken","dir","checkArray","local","checkValue","checkOperator","checkFunction","Compiler","writer","groupStack","opIf","opAdd","opMul","opCommon","opRel","opNew","opCell","function","number","eofToken","nextToken","backToken","compileIfge","isSkipNextToken","getInstruct","compileAdd","operator","reduceGroup","writeOperator","compileMul","compileCommon","compileRel","compileArray","compileFunction","addGroup","popGroup","compilePushValue","increaseGroup","writeString","writeNumber","writeOperand","Evaluation","instruct","memory","newArray","invoke","pushSRegexp","pushNRegexp","pushORegexp","ificmpge","ificmpgt","ifge","ifgt","ifeq","ifne","sub","mul","div","mod","power","rel","link","uni","common","group","pushS","pushN","pushO","a","pow","getFunction","apply","Compile","tokenizer","lexical","compile","Instruct","inst","eval","Formula","expr","Cell","borderAttr","fontAttr","richText","formula","background","contentWidth","contentHeight","contentType","TYPE","STRING","formatText","setContentType","setExpr","setRich","setContentWidth","getExpr","NUMBER","DATE_TIME","RICH_TEXT","getComputeText","hasExpr","getValue","XTableFormat","getFormatText","Listen","RectRange","sri","sci","eri","eci","ref","refs","iteratorBuilder","rowFilter","getRowIterator","setBegin","setEnd","setLoop","getColIterator","execute","ri","ci","disjoint","coincide","difference","addRet","dsr","dsc","der","dec","lt","rt","lb","rb","multiple","Snapshot","undoStack","redoStack","layer","listen","undo","redo","action","Compare","Swap","arr","tmp","QkSelect","compare","QStep","z","log","exp","sd","sqrt","findItem","items","equalsFn","extend","minX","minY","maxX","maxY","compareNodeMinX","compareNodeMinY","bboxArea","bboxMargin","intersects","createNode","leaf","Infinity","distBBox","toBBox","destNode","child","calcBBox","multiSelect","stack","mid","RectTree","maxEntries","_maxEntries","_minEntries","clear","_all","bbox","nodesToSearch","childBBox","search","insert","_build","_splitRoot","tmpNode","_insert","goingUp","indexes","splice","_condense","N","M","N2","N1","compareMinX","right2","compareMinY","right3","level","minArea","minEnlargement","targetNode","area","enlargement","isNode","insertPath","_chooseSubtree","_split","_adjustParentBBoxes","_chooseSplitAxis","splitIndex","_chooseSplitIndex","newNode","minOverlap","bbox1","bbox2","overlap","_allDistMargin","sort","leftBBox","rightBBox","margin","siblings","RtreeUtils","RangeTree","snapshot","rTree","first","bboxToRange","getFirstInclude","rectRange","rangeToBbox","shift","addAction","rectRanges","all","union","MAX_COL","MAX_ROW","Merges","merges","merge","valueOf","view","footRange","fullRange","getFullRowRange","fullBbox","footBbox","divers","mergeAction","diffMax","oldMax","diffMin","oldMin","getFullColRange","colAfterShrink","colAfterExpand","colBeforeShrink","colBeforeExpand","rowAfterShrink","rowAfterExpand","rowBeforeShrink","rowBeforeExpand","getAll","Cells","cell","getCell","getItemsOrNew","oldValue","getItems","hasCell","hasItems","getData","orderValue","ignoreCorner","oldItems","effRiLength","effCiLength","oldRowItem","rowItem","cells","hasFormula","postMessage"],"mappings":"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","file":"js/sumtotal.worker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/* global navigator document window self */\nfunction S4() {\n  // eslint-disable-next-line no-bitwise\n  return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\n}\n\nconst alphabets = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];\n\nconst DATA_TYPE = {\n  String: 1,\n  Boolean: 2,\n  Number: 3,\n  Object: 4,\n  Array: 5,\n  Function: 6,\n  Null: 7,\n  Undefined: 8,\n  Promise: 9,\n  GeneratorFunction: 10,\n  AsyncFunction: 11,\n  BigInt: 12,\n  Symbol: 13,\n  DedicatedWorkerGlobalScope: 14,\n  Date: 15,\n  RegExp: 16,\n  Un: 0,\n};\n\nclass SheetUtils {\n\n  static isWindows() {\n    return /windows|win32/i.test(navigator.userAgent);\n  }\n\n  static isMac() {\n    return /macintosh|mac os x/i.test(navigator.userAgent);\n  }\n\n  static isNotEmptyObject(object) {\n    return !SheetUtils.isEmptyObject(object);\n  }\n\n  static isEmptyObject(object) {\n    // eslint-disable-next-line no-restricted-syntax\n    for (const key in object) {\n      // eslint-disable-next-line no-prototype-builtins\n      if (object.hasOwnProperty(key)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  static isUnDef(e) {\n    return e === undefined || e === null;\n  }\n\n  static isDef(e) {\n    return !this.isUnDef(e);\n  }\n\n  static isNumber(e) {\n    return /^(-?\\d+.\\d+)$|^(-?\\d+)$/.test(e);\n  }\n\n  static isFraction(e) {\n    return /^\\d+\\/\\d+$/.test(e);\n  }\n\n  static isDate(e) {\n    return SheetUtils.type(e) === DATA_TYPE.Date;\n  }\n\n  static isFunction(e) {\n    const type = SheetUtils.type(e);\n    return type === DATA_TYPE.Function;\n  }\n\n  static isArray(e) {\n    return SheetUtils.type(e) === DATA_TYPE.Array;\n  }\n\n  static isObject(e) {\n    return SheetUtils.type(e) === DATA_TYPE.Object;\n  }\n\n  static isRegExp(e) {\n    return SheetUtils.type(e) === DATA_TYPE.EX;\n  }\n\n  static isLikeArray(e) {\n    if (SheetUtils.isUnDef(e)) {\n      return false;\n    }\n    return typeof e.length === 'number';\n  }\n\n  static isBlank(s) {\n    if (SheetUtils.isUnDef(s)) {\n      return true;\n    }\n    return s.toString().trim() === '';\n  }\n\n  static isPlainObject(obj) {\n    if (SheetUtils.isUnDef(obj)) {\n      return false;\n    }\n    return Object.getPrototypeOf(obj) === Object.getPrototypeOf({});\n  }\n\n  static isString(obj) {\n    return SheetUtils.type(obj) === DATA_TYPE.String;\n  }\n\n  static isChildType(obj, parent) {\n    return obj instanceof parent;\n  }\n\n  static toLowCase(str) {\n    return str.toLowerCase();\n  }\n\n  static type(arg) {\n    const type = Object.prototype.toString.call(arg);\n    switch (type) {\n      case '[object Null]':\n        return DATA_TYPE.Null;\n      case '[object Object]':\n        return DATA_TYPE.Object;\n      case '[object Undefined]':\n        return DATA_TYPE.Undefined;\n      case '[object String]':\n        return DATA_TYPE.String;\n      case '[object Boolean]':\n        return DATA_TYPE.Boolean;\n      case '[object Number]':\n        return DATA_TYPE.Number;\n      case '[object Function]':\n        return DATA_TYPE.Function;\n      case '[object Array]':\n        return DATA_TYPE.Array;\n      case '[object Promise]':\n        return DATA_TYPE.Promise;\n      case '[object GeneratorFunction]':\n        return DATA_TYPE.GeneratorFunction;\n      case '[object AsyncFunction]':\n        return DATA_TYPE.AsyncFunction;\n      case '[object BigInt]':\n        return DATA_TYPE.BigInt;\n      case '[object Symbol]':\n        return DATA_TYPE.Symbol;\n      case '[object Date]':\n        return DATA_TYPE.Date;\n      case '[object DedicatedWorkerGlobalScope]':\n        return DATA_TYPE.DedicatedWorkerGlobalScope;\n      default:\n        return DATA_TYPE.Un;\n    }\n  }\n\n  static copy(object = {}, ...sources) {\n    if (SheetUtils.isUnDef(object)) {\n      return {};\n    }\n    if (SheetUtils.isUnDef(sources) || sources.length === 0) {\n      return object;\n    }\n    sources.forEach((source) => {\n      if (SheetUtils.isUnDef(source)) return;\n      Object.keys(source).forEach((key) => {\n        const v = source[key];\n        if (typeof v === 'string' || typeof v === 'number' || typeof v === 'boolean') {\n          object[key] = v;\n        } else if (typeof v !== 'function' && !Array.isArray(v) && SheetUtils.isPlainObject(v)) {\n          object[key] = object[key] || {};\n          SheetUtils.copy(object[key], v);\n        } else {\n          object[key] = v;\n        }\n      });\n    });\n    return object;\n  }\n\n  static cloneDeep(object) {\n    const json = JSON.stringify(object);\n    return JSON.parse(json);\n  }\n\n  static extends(target, ...src) {\n    for (let i = 0, len = src.length; i < len; i++) {\n      const item = src[i];\n      for (let key in item) {\n        if (item.hasOwnProperty(key)) {\n          const value = item[key];\n          if (SheetUtils.isDef(value)) {\n            target[key] = value;\n          }\n        }\n      }\n    }\n    return target;\n  }\n\n  static sum(objOrAry, cb = value => value) {\n    let total = 0;\n    let size = 0;\n    Object.keys(objOrAry).forEach((key) => {\n      total += cb(objOrAry[key], key);\n      size += 1;\n    });\n    return [total, size];\n  }\n\n  static parseFloat(val) {\n    if (SheetUtils.isNumber(val)) return parseFloat(val);\n    return 0;\n  }\n\n  static parseInt(val) {\n    if (SheetUtils.isNumber(val)) return parseInt(val, 10);\n    return 0;\n  }\n\n  static stringAt(index) {\n    let str = '';\n    let idx = index;\n    while (idx >= alphabets.length) {\n      idx /= alphabets.length;\n      idx -= 1;\n      str += alphabets[parseInt(idx, 10) % alphabets.length];\n    }\n    const last = index % alphabets.length;\n    str += alphabets[last];\n    return str;\n  }\n\n  static indexAt(str) {\n    let ret = 0;\n    for (let i = 0; i < str.length - 1; i += 1) {\n      const idx = str.charCodeAt(i) - 65;\n      const expoNet = str.length - 1 - i;\n      ret += (alphabets.length ** expoNet) + (alphabets.length * idx);\n    }\n    ret += str.charCodeAt(str.length - 1) - 65;\n    return ret;\n  }\n\n  static expr2xy(src) {\n    let x = '';\n    let y = '';\n    for (let i = 0; i < src.length; i += 1) {\n      if (src.charAt(i) >= '0' && src.charAt(i) <= '9') {\n        y += src.charAt(i);\n      } else {\n        x += src.charAt(i);\n      }\n    }\n    return [SheetUtils.indexAt(x), parseInt(y, 10) - 1];\n  }\n\n  static xy2expr(x, y) {\n    return `${SheetUtils.stringAt(x)}${y + 1}`;\n  }\n\n  static expr2expr(src, xn, yn) {\n    const [x, y] = SheetUtils.expr2xy(src);\n    return SheetUtils.xy2expr(x + xn, y + yn);\n  }\n\n  static minIf(v, min) {\n    if (v < min) return min;\n    return v;\n  }\n\n  static keepLastIndex(obj) {\n    const range = window.getSelection();\n    range.selectAllChildren(obj);\n    range.collapseToEnd();\n  }\n\n  static trim(s) {\n    if (this.isBlank(s)) return '';\n    return s.trim();\n  }\n\n  static now() {\n    return Date.now().toString();\n  }\n\n  static viewPort() {\n    return {\n      width: window.innerWidth,\n      height: window.innerHeight,\n    };\n  }\n\n  static exitFullscreen() {\n    if (document.exitFullscreen) {\n      document.exitFullscreen();\n    } else if (document.msExitFullscreen) {\n      document.msExitFullscreen();\n    } else if (document.mozCancelFullScreen) {\n      document.mozCancelFullScreen();\n    } else if (document.webkitExitFullscreen) {\n      document.webkitExitFullscreen();\n    }\n  }\n\n  static fullScreen(element) {\n    if (element.el) {\n      element = element.el;\n    }\n    if (element.requestFullscreen) {\n      element.requestFullscreen();\n    } else if (element.msRequestFullscreen) {\n      element.msRequestFullscreen();\n    } else if (element.mozRequestFullScreen) {\n      element.mozRequestFullScreen();\n    } else if (element.webkitRequestFullscreen) {\n      element.webkitRequestFullscreen();\n    }\n  }\n\n  static isFull() {\n    return !!(document.webkitIsFullScreen || document.mozFullScreen\n      || document.msFullscreenElement || document.fullscreenElement);\n  }\n\n  static uuid() {\n    return (`${S4() + S4()}${S4()}${S4()}${S4()}${S4()}${S4()}${S4()}`);\n  }\n\n  static equals(one, tow) {\n    function diffValue(oneValue, towValue) {\n      const oneType = SheetUtils.type(oneValue);\n      const towType = SheetUtils.type(towValue);\n      if (oneType !== towType) {\n        return false;\n      }\n      if (SheetUtils.isArray(oneValue)) {\n        return diffArrays(oneValue, towValue);\n      }\n      if (SheetUtils.isObject(oneValue)) {\n        return diffObject(oneValue, towValue);\n      }\n      if (SheetUtils.isDate(oneValue)) {\n        return oneValue.getTime() === towValue.getTime();\n      }\n      if (SheetUtils.isRegExp(oneValue)) {\n        return oneValue.toString() === towValue.toString();\n      }\n      return oneValue === towValue;\n    }\n    function diffArrays(one, tow) {\n      if (one.length !== tow.length) {\n        return false;\n      }\n      for (let i = 0, len = one.length; i < len; i++) {\n        const oneValue = one[i];\n        const towValue = tow[i];\n        if (!diffValue(oneValue, towValue)) {\n          return false;\n        }\n      }\n      return true;\n    }\n    function diffObject(one, tow) {\n      const oneKeys = Object.keys(one);\n      const towKeys = Object.keys(tow);\n      if (oneKeys.length !== towKeys.length) {\n        return false;\n      }\n      for (const key of oneKeys) {\n        if (!towKeys.includes(key)) {\n          return false;\n        }\n        const oneValue = one[key];\n        const towValue = tow[key];\n        if (!diffValue(oneValue, towValue)) {\n          return false;\n        }\n      }\n      return true;\n    }\n    return diffValue(one, tow);\n  }\n\n  static toFixed(num, fixed) {\n    if (num.toString().indexOf('.') > -1) {\n      return num.toFixed(fixed);\n    }\n    return num;\n  }\n\n  static getExplorerInfo() {\n    const explorer = window.navigator.userAgent.toLowerCase();\n    // firefox\n    if (explorer.indexOf('firefox') >= 0) {\n      const ver = explorer.match(/firefox\\/([\\d.]+)/)[1];\n      return { type: 'Firefox', version: ver };\n    }\n    // Chrome\n    if (explorer.indexOf('chrome') >= 0) {\n      const ver = explorer.match(/chrome\\/([\\d.]+)/)[1];\n      return { type: 'Chrome', version: ver };\n    }\n    // Opera\n    if (explorer.indexOf('opera') >= 0) {\n      const ver = explorer.match(/opera.([\\d.]+)/)[1];\n      return { type: 'Opera', version: ver };\n    }\n    // Safari\n    if (explorer.indexOf('safari') >= 0) {\n      const ver = explorer.match(/version\\/([\\d.]+)/)[1];\n      return { type: 'Safari', version: ver };\n    }\n    // ie\n    if (explorer.indexOf('msie') >= 0) {\n      const ver = explorer.match(/msie ([\\d.]+)/)[1];\n      return { type: 'IE', version: ver };\n    }\n    // undefined\n    return undefined;\n  }\n\n  static arrayLast(array) {\n    return array[array.length - 1];\n  }\n\n  static arrayHead(array) {\n    return array[0];\n  }\n\n  static blankClear(value) {\n    if (SheetUtils.isString(value)) {\n      return value.replace(/\\s*/g, SheetUtils.EMPTY);\n    }\n    return value;\n  }\n\n  static safeValue(value, defaultValue = '') {\n    return SheetUtils.isUnDef(value) ? defaultValue : value;\n  }\n\n  static inWorker() {\n    // eslint-disable-next-line no-restricted-globals\n    const type = SheetUtils.type(self);\n    return type === DATA_TYPE.DedicatedWorkerGlobalScope;\n  }\n\n  static if(condition, establish, otherwise) {\n    return condition ? establish() : otherwise();\n  }\n\n  static slice(likeArray) {\n    return Array.prototype.slice.call(likeArray);\n  }\n\n  static clearBlank(str) {\n    return str.replace(/\\s/g, '');\n  }\n\n}\n\nSheetUtils.EMPTY = '';\nSheetUtils.Nul = null;\nSheetUtils.Undef = undefined;\nSheetUtils.noop = () => {};\nSheetUtils.DATA_TYPE = DATA_TYPE;\n\nexport {\n  SheetUtils,\n};\n","class BaseFont {\n\n  constructor({\n    draw, ruler, attr,\n  }) {\n    this.draw = draw;\n    this.attr = attr;\n    this.ruler = ruler;\n  }\n\n  setRuler(ruler) {\n    this.ruler = ruler;\n  }\n\n  getAlignPadding() {\n    if (this.attr.align === BaseFont.ALIGN.center) {\n      return 0;\n    }\n    return this.attr.padding;\n  }\n\n  getVerticalAlignPadding() {\n    if (this.attr.verticalAlign === BaseFont.VERTICAL_ALIGN.center) {\n      return 0;\n    }\n    return this.attr.padding;\n  }\n\n}\n\nBaseFont.VERTICAL_ALIGN = {\n  top: 'top',\n  center: 'middle',\n  bottom: 'bottom',\n};\nBaseFont.ALIGN = {\n  left: 'left',\n  center: 'center',\n  right: 'right',\n};\nBaseFont.TEXT_WRAP = {\n  OVER_FLOW: 1,\n  WORD_WRAP: 2,\n  TRUNCATE: 3,\n};\nBaseFont.TEXT_DIRECTION = {\n  HORIZONTAL: 'horizontal',\n  VERTICAL: 'vertical',\n  ANGLE: 'angle',\n  ANGLE_BAR: 'bar',\n};\nBaseFont.DEFAULT_FONT_ATTR = {\n  name: 'Arial',\n  size: 14,\n  color: 'rgb(0,0,0)',\n  bold: false,\n  italic: false,\n  strikethrough: false,\n  underline: false,\n  angle: 0,\n  padding: 8,\n  align: BaseFont.ALIGN.left,\n  textWrap: BaseFont.TEXT_WRAP.TRUNCATE,\n  verticalAlign: BaseFont.VERTICAL_ALIGN.center,\n  direction: BaseFont.TEXT_DIRECTION.HORIZONTAL,\n};\nBaseFont.DEFAULT_RICH_ATTR = {\n  angle: 0,\n  padding: 8,\n  align: BaseFont.ALIGN.left,\n  textWrap: BaseFont.TEXT_WRAP.TRUNCATE,\n  verticalAlign: BaseFont.VERTICAL_ALIGN.center,\n  direction: BaseFont.TEXT_DIRECTION.HORIZONTAL,\n};\nBaseFont.DEFAULT_RICH_ITEM_ATTR = {\n  name: 'Arial',\n  size: 14,\n  color: 'rgb(0,0,0)',\n  bold: false,\n  italic: false,\n  strikethrough: false,\n  underline: false,\n};\n\nexport {\n  BaseFont,\n};\n","/* global document MouseEvent CustomEvent window NodeList HTMLCollection DocumentFragment */\nimport { SheetUtils } from '../utils/SheetUtils';\n\n/**\n * Element\n */\nclass Element {\n\n  /**\n   * 包装元素\n   */\n  static wrapElement(object) {\n    if ([\n      SheetUtils.isArray(object),\n      object instanceof HTMLCollection,\n      object instanceof NodeList,\n    ].includes(true)) {\n      let elements = [];\n      for (let i = 0; i < object.length; i++) {\n        const item = object[i];\n        if (item instanceof Element) {\n          elements.push(item);\n        } else {\n          elements.push(new Element(item));\n        }\n      }\n      return elements;\n    }\n    return new Element(object);\n  }\n\n  static createText(text) {\n    return new Element(document.createTextNode(text));\n  }\n\n  /**\n   * 驼峰转连字符\n   * @param value\n   * @returns {string|null}\n   */\n  static hyphenateRE(value) {\n    if (value) {\n      return value.replace(/([A-Z])/g, '-$1').toLowerCase();\n    }\n    return null;\n  }\n\n  /**\n   * Element\n   * @param tag\n   * @param className\n   */\n  constructor(tag, className = '') {\n    if (typeof tag === 'string') {\n      this.el = document.createElement(tag);\n      if (className) {\n        this.el.className = className;\n      }\n    } else {\n      this.el = tag;\n    }\n    this.map = {};\n  }\n\n  /**\n   * 数据绑定\n   * @param key\n   * @param value\n   * @returns {Element|*}\n   */\n  data(key, value) {\n    if (value !== undefined) {\n      this.map[key] = value;\n      return this;\n    }\n    return this.map[key];\n  }\n\n  /**\n   * 空参数时返回子元素,\n   * 有参数时插入子节点\n   * @param args\n   * @returns {*[]|Element}\n   */\n  children(...args) {\n    if (arguments.length === 0) {\n      return Element.wrapElement(this.el.children);\n    }\n    args.forEach(ele => this.append(ele));\n    return this;\n  }\n\n  /**\n   * 空参数时返回子节点,\n   * 有参数时插入子节点\n   * @param args\n   * @returns {*[]|Element}\n   */\n  childrenNodes(...args) {\n    if (arguments.length === 0) {\n      return Element.wrapElement(this.el.childNodes);\n    }\n    args.forEach(ele => this.append(ele));\n    return this;\n  }\n\n  /**\n   * 将目标节点添加到当前元素中\n   * @param ele\n   */\n  childrenNodesAppend(ele) {\n    if (!this.isTextNode()) {\n      ele.childrenNodes().forEach(i => this.append(i));\n    }\n    return this;\n  }\n\n  /**\n   * 将目标节点添加到当前元素中\n   * @param ele\n   */\n  childrenNodesPrepend(ele) {\n    if (!this.isTextNode()) {\n      ele.childrenNodes().forEach(i => this.prepend(i));\n    }\n    return this;\n  }\n\n  /**\n   * 在当前元素中插入指定节点\n   * @param ele\n   */\n  append(ele) {\n    if (!this.isTextNode()) {\n      if (ele && ele.el) {\n        this.el.append(ele.el);\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 在当前元素中插入指定节点\n   * @param ele\n   */\n  prepend(ele) {\n    if (!this.isTextNode()) {\n      if (ele && ele.el) {\n        this.el.prepend(ele.el);\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 元素定位\n   * @param value\n   * @returns {{top: *, left: *, width: *, height: *}|Element}\n   */\n  offset(value) {\n    if (value !== undefined) {\n      Object.keys(value).forEach((k) => {\n        this.css(k, `${value[k]}px`);\n      });\n      return this;\n    }\n    const { offsetTop, offsetLeft } = this.el;\n    const { offsetHeight, offsetWidth } = this.el;\n    return {\n      top: offsetTop,\n      left: offsetLeft,\n      height: offsetHeight,\n      width: offsetWidth,\n    };\n  }\n\n  /**\n   * 获取当前元素的父节点\n   * @returns {Element}\n   */\n  parent() {\n    return this.el.parentNode\n      ? new Element(this.el.parentNode) : null;\n  }\n\n  /**\n   * 添加Class名称\n   * @param name\n   * @returns {Element}\n   */\n  addClass(name) {\n    if (!this.isTextNode()) {\n      this.el.classList.add(name);\n    }\n    return this;\n  }\n\n  /**\n   * 是否具有指定Class名称\n   * @param name\n   * @returns {boolean}\n   */\n  hasClass(name) {\n    if (!this.isTextNode()) {\n      return this.el.classList.contains(name);\n    }\n    return false;\n  }\n\n  /**\n   * 是否有子元素\n   * @returns {boolean}\n   */\n  hasChildElement() {\n    return this.children().length > 0;\n  }\n\n  /**\n   * 是否有子节点\n   * @returns {boolean}\n   */\n  hasChild() {\n    return this.childrenNodes().length > 0;\n  }\n\n  /**\n   * 删除Class名称\n   * @param name\n   * @returns {Element}\n   */\n  removeClass(name) {\n    if (!this.isTextNode()) {\n      this.el.classList.remove(name);\n    }\n    return this;\n  }\n\n  /**\n   * 获取元素坐标信息\n   * getBoundingClientRect\n   * @returns {DOMRect}\n   */\n  box() {\n    if (!this.isTextNode()) {\n      return this.el.getBoundingClientRect();\n    }\n    return null;\n  }\n\n  /**\n   * 获取当前第一个子元素\n   * @returns {*}\n   */\n  first() {\n    if (!this.isTextNode()) {\n      return Element.wrapElement(this.el.firstChild);\n    }\n    return null;\n  }\n\n  /**\n   * 获取最后一个子元素\n   * @returns {*}\n   */\n  last() {\n    if (!this.isTextNode()) {\n      return Element.wrapElement(this.el.lastChild);\n    }\n    return null;\n  }\n\n  /**\n   * 获取第一个文本节点\n   */\n  firstTextNode() {\n    if (this.isTextNode()) {\n      return this;\n    }\n    let find = null;\n    let handle = (elem) => {\n      if (elem.hasChild()) {\n        elem.childrenNodes().forEach((elem) => {\n          if (find === null) {\n            handle(elem);\n          }\n        });\n      }\n      if (find === null) {\n        if (elem.isTextNode()) {\n          find = elem;\n        }\n      }\n    };\n    handle(this);\n    return find;\n  }\n\n  /**\n   * 获取最后一个文本节点\n   */\n  lastTextNode() {\n    if (this.isTextNode()) {\n      return this;\n    }\n    let find = null;\n    let handle = (elem) => {\n      if (elem.hasChild()) {\n        elem.childrenNodes().reverse().forEach((elem) => {\n          if (find === null) {\n            handle(elem);\n          }\n        });\n      }\n      if (find === null) {\n        if (elem.isTextNode()) {\n          find = elem;\n        }\n      }\n    };\n    handle(this);\n    return find;\n  }\n\n  /**\n   * 删除当前元素下的子元素\n   * @param target\n   * @returns {boolean|ActiveX.IXMLDOMNode|*}\n   */\n  remove(target = null) {\n    if (target) {\n      if (!this.isTextNode()) {\n        this.el.removeChild(target.el || target);\n      }\n    } else {\n      const parent = this.parent();\n      if (parent) {\n        this.parent().remove(this);\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 当前元素是否包含指定节点\n   * @param ele\n   * @returns {boolean|*}\n   */\n  contains(ele) {\n    if (this.isTextNode()) {\n      return false;\n    }\n    return this.el.contains(ele.el);\n  }\n\n  /**\n   * 获取当前元素的上一个元素\n   * @returns {*}\n   */\n  prev() {\n    return this.el.previousSibling\n      ? Element.wrapElement(this.el.previousSibling) : null;\n  }\n\n  /**\n   * 获取当前元素的下一个元素\n   * @returns {*}\n   */\n  next() {\n    return this.el.nextSibling\n      ? Element.wrapElement(this.el.nextSibling) : null;\n  }\n\n  /**\n   * 设置元素的激活状态\n   * @param flag\n   * @param cls\n   * @returns {Element}\n   */\n  active(flag = true, cls = 'active') {\n    if (!this.isTextNode()) {\n      if (flag) this.addClass(cls);\n      else this.removeClass(cls);\n    }\n    return this;\n  }\n\n  /**\n   * 设置元素文本\n   * @param text\n   * @returns {string|Element}\n   */\n  text(text) {\n    if (this.isTextNode()) {\n      return this.nodeValue();\n    }\n    if (text !== undefined) {\n      this.el.innerText = text;\n      return this;\n    }\n    return this.el.innerText;\n  }\n\n  /**\n   * 设置元素html内容\n   * @param html\n   * @returns {Element|*}\n   */\n  html(html) {\n    if (this.isTextNode()) {\n      return this.nodeValue();\n    }\n    if (html !== undefined) {\n      this.el.innerHTML = html;\n      return this;\n    }\n    return this.el.innerHTML;\n  }\n\n  /**\n   * 当前元素设置焦点\n   */\n  focus() {\n    if (!this.isTextNode()) {\n      this.el.focus();\n    }\n    return this;\n  }\n\n  /**\n   * 移除焦点\n   */\n  blur() {\n    if (!this.isTextNode()) {\n      this.el.blur();\n    }\n    return this;\n  }\n\n  /**\n   * 删除元素属性\n   * @param key\n   * @returns {Element}\n   */\n  removeAttr(key) {\n    if (!this.isTextNode()) {\n      this.el.removeAttribute(key);\n    }\n    return this;\n  }\n\n  /**\n   * 添加style\n   * @param style\n   */\n  style(style) {\n    if (!this.isTextNode()) {\n      this.attr('style', style);\n    }\n    return this;\n  }\n\n  /**\n   * 添加元素属性\n   * @param key\n   * @param value\n   * @returns {string|Element}\n   */\n  attr(key, value) {\n    if (!this.isTextNode()) {\n      if (value !== undefined) {\n        if (this.el.setAttribute) {\n          this.el.setAttribute(key, value);\n        }\n      } else {\n        if (typeof key === 'string') {\n          if (this.el.setAttribute) {\n            return this.el.getAttribute(key);\n          }\n          return null;\n        }\n        if (this.el.setAttribute) {\n          Object.keys(key).forEach((k) => {\n            this.el.setAttribute(k, key[k]);\n          });\n        }\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 设置元素Value\n   * @param v\n   * @returns {Element|*}\n   */\n  val(v) {\n    if (!this.isTextNode()) {\n      if (v !== undefined) {\n        this.el.value = v;\n        return this;\n      }\n      return this.el.value;\n    }\n    if (v === undefined) {\n      return this.nodeValue();\n    }\n    return this;\n  }\n\n  /**\n   * 获取原始节点\n   * @returns {*}\n   */\n  get() {\n    return this.el;\n  }\n\n  /**\n   * 删除元素style属性\n   * @param keys\n   * @returns {Element}\n   */\n  cssRemoveKeys(...keys) {\n    if (!this.isTextNode()) {\n      if (this.el.style) {\n        keys.forEach((k) => {\n          if (this.el.style) {\n            this.el.style.removeProperty(Element.hyphenateRE(k));\n          }\n        });\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 删除元素style属性\n   * @param key\n   * @param value\n   * @returns {Element}\n   */\n  cssRemoveVal(key, value) {\n    if (!this.isTextNode()) {\n      if (this.el.style) {\n        const property = Element.hyphenateRE(key);\n        const propertyValue = this.el.style.getPropertyValue(property);\n        const newValue = propertyValue.replace(value, '');\n        this.css(key, newValue);\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 设置元素属性\n   * @param name\n   * @param value\n   * @returns {Element|*}\n   */\n  css(name, value) {\n    if (!this.isTextNode()) {\n      if (this.el.style) {\n        if (value === undefined && typeof name !== 'string') {\n          Object.keys(name).forEach((key) => {\n            const property = Element.hyphenateRE(key);\n            this.el.style.setProperty(property, name[key]);\n          });\n          return this;\n        }\n        if (value !== undefined) {\n          const property = Element.hyphenateRE(name);\n          this.el.style.setProperty(property, value);\n          return this;\n        }\n        const property = Element.hyphenateRE(name);\n        return this.el.style.getPropertyValue(property);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * 获取元素计算完成的样式\n   * @returns {CSSStyleDeclaration}\n   */\n  computedStyle() {\n    if (!this.isTextNode()) {\n      return window.getComputedStyle(this.el, null);\n    }\n    return null;\n  }\n\n  /**\n   * 显示\n   * @returns {Element}\n   */\n  show() {\n    if (!this.isTextNode()) {\n      const style = this.computedStyle();\n      if (style && style.display !== 'block') {\n        this.css('display', 'block');\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 隐藏\n   * @returns {Element}\n   */\n  hide() {\n    if (!this.isTextNode()) {\n      const style = this.computedStyle();\n      if (style && style.display !== 'none') {\n        this.css('display', 'none');\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 事件触发\n   * @param type\n   * @param message\n   */\n  trigger(type, message) {\n    if (!this.isTextNode()) {\n      switch (type) {\n        case 'click': {\n          const evt = new MouseEvent(type, {\n            detail: message,\n            bubbles: true,\n            cancelable: false,\n          });\n          evt.initEvent('click', true, true);\n          this.el.dispatchEvent(evt);\n          break;\n        }\n        default: {\n          const evt = new CustomEvent(type, {\n            detail: message,\n            bubbles: true,\n            cancelable: false,\n          });\n          this.el.dispatchEvent(evt);\n          break;\n        }\n      }\n    }\n  }\n\n  /**\n   * 查找子元素\n   * @param select\n   * @returns {[]|Element}\n   */\n  find(select) {\n    if (!this.isTextNode()) {\n      const result = this.el.querySelectorAll(select);\n      if (result && result.length === 1) {\n        return new Element(result[0]);\n      }\n      const array = [];\n      if (result) {\n        for (const item of result) {\n          array.push(new Element(item));\n        }\n      }\n      return array;\n    }\n    return [];\n  }\n\n  /**\n   * 查找子元素\n   * @param select\n   * @returns {[]|Element}\n   */\n  finds(select) {\n    if (!this.isTextNode()) {\n      const result = this.el.querySelectorAll(select);\n      const array = [];\n      if (result) {\n        for (const item of result) {\n          array.push(new Element(item));\n        }\n      }\n      return array;\n    }\n    return [];\n  }\n\n  /**\n   * 获取当前元素的兄弟节点\n   * @returns {[]}\n   */\n  sibling() {\n    let sibling = this.el;\n    const result = [];\n    // eslint-disable-next-line no-cond-assign\n    while ((sibling = sibling.previousElementSibling) !== null) result.push(new Element(sibling));\n    sibling = this.el;\n    // eslint-disable-next-line no-cond-assign\n    while ((sibling = sibling.nextElementSibling) !== null) result.push(new Element(sibling));\n    return result;\n  }\n\n  /**\n   * 节点名称\n   * @returns {string}\n   */\n  tagName() {\n    return this.el.nodeName.toLocaleLowerCase();\n  }\n\n  /**\n   * 节点内容\n   * @returns {string}\n   */\n  nodeValue() {\n    return this.el.nodeValue;\n  }\n\n  /**\n   * 节点类型\n   * @returns {number}\n   */\n  nodeType() {\n    return this.el.nodeType;\n  }\n\n  /**\n   * 在当前元素之后插入新元素\n   * @param ele\n   */\n  after(ele) {\n    if (this.el && ele && ele.el) {\n      this.el.after(ele.el);\n    }\n    return this;\n  }\n\n  /**\n   * 在当前元素之前插入新元素\n   * @param ele\n   */\n  before(ele) {\n    if (this.el && ele && ele.el) {\n      this.el.before(ele.el);\n    }\n    return this;\n  }\n\n  /**\n   * 复制\n   */\n  clone() {\n    return new Element(this.el.cloneNode(true));\n  }\n\n  /**\n   * 清空元素中的所有内容\n   */\n  empty() {\n    if (!this.isTextNode()) {\n      this.html('');\n    }\n    return this;\n  }\n\n  /**\n   * 相等比较\n   * @param other\n   * @returns {boolean}\n   */\n  equals(other) {\n    return this.el === other.el;\n  }\n\n  /**\n   * 获取当前元素在父元素中的索引\n   * @returns {number}\n   */\n  index() {\n    let parent = this.parent();\n    let index = -1;\n    parent.childrenNodes()\n      .forEach((v, i) => {\n        if (v.equals(this)) {\n          index = i;\n        }\n      });\n    return index;\n  }\n\n  /**\n   * 比较dom是否相同\n   * @param ele\n   * @returns {boolean}\n   */\n  is(ele) {\n    return this.el === ele.el;\n  }\n\n  /**\n   * 是否文本节点\n   * @returns {boolean}\n   */\n  isTextNode() {\n    return this.tagName() === '#text';\n  }\n\n  /**\n   * 是否换行节点\n   * @returns {boolean}\n   */\n  isBreakNode() {\n    return this.tagName() === 'br';\n  }\n\n  /**\n   * 是否文档碎片\n   * @returns {boolean}\n   */\n  isDocumentFragment() {\n    return this.el instanceof DocumentFragment;\n  }\n\n}\n\nconst h = (tag, className = '') => new Element(tag, className);\n\nconst TextNode = text => Element.createText(text);\n\nexport {\n  Element,\n  TextNode,\n  h,\n};\n","const cssPrefix = 'x-sheet';\nconst XSheetVersion = `${cssPrefix} 1.0.0-develop`;\nconst Constant = {};\nConstant.WORK_BODY_EVENT_TYPE = {\n  CHANGE_ACTIVE: 'changeactive',\n  REMOVE_SHEET: 'removesheet',\n};\nConstant.SYSTEM_EVENT_TYPE = {\n  MOUSE_MOVE: 'mousemove',\n  MOUSE_DOWN: 'mousedown',\n  CONTEXT_MENU: 'contextmenu',\n  SCROLL: 'scroll',\n  RESIZE: 'resize',\n  MOUSE_UP: 'mouseup',\n  INPUT: 'input',\n  KEY_DOWN: 'keydown',\n  KEY_UP: 'keyup',\n  MOUSE_OVER: 'mouseover',\n  MOUSE_LEAVE: 'mouseleave',\n  MOUSE_WHEEL: 'wheel',\n  MOUSE_ENTER: 'mouseenter',\n  CLICK: 'click',\n  FOCUS: 'focus',\n  DRAG_START: 'dragstart',\n  CHANGE: 'change',\n  VISIBILITY_CHANGE: 'visibilitychange',\n};\nConstant.TABLE_EVENT_TYPE = {\n  RENDER: 'render',\n  SNAPSHOT_CHANGE: 'snapshotchange',\n  CHANGE_ROW_HEIGHT: 'changerowheight',\n  CHANGE_COL_WIDTH: 'changecolwidth',\n  SCALE_CHANGE: 'scalechange',\n  EDIT_START: 'editstart',\n  EDIT_INPUT: 'editinput',\n  EDIT_FINISH: 'editfinish',\n  REMOVE_ROW: 'removerow',\n  REMOVE_COL: 'removecol',\n  ADD_NEW_ROW: 'addnewrow',\n  ADD_NEW_COL: 'addnewcol',\n  FIXED_CHANGE: 'fixedchange',\n  FIXED_COL_CHANGE: 'fixedcolchange',\n  FIXED_ROW_CHANGE: 'fixedrowchange',\n  SELECT_OVER: 'selectover',\n  SELECT_DOWN: 'selectdown',\n  SELECT_CHANGE: 'selectchange',\n  DATA_CHANGE: 'datachange',\n  RESIZE_CHANGE: 'resizechange',\n};\nConstant.FORM_EVENT_TYPE = {\n  SEARCH_INPUT_CHANGE: 'searchinputchange',\n  PLAIN_INPUT_CHANGE: 'plaininputchange',\n  FORM_SELECT_CHANGE: 'formselectchange',\n};\nexport {\n  XSheetVersion,\n  Constant,\n  cssPrefix,\n};\n","import { Constant } from '../const/Constant';\nimport { Element } from './Element';\n\nclass BindPool {\n\n  constructor() {\n    this.pool = [];\n  }\n\n  unbind(ele, type, callback, option) {\n    if (ele instanceof Element) {\n      ele = ele.el;\n    }\n    const result = this.remove(ele, type, callback, option);\n    if (result.length) {\n      result.forEach((item) => {\n        ele.removeEventListener(item.type, item.callback, item.option);\n      });\n    } else {\n      ele.removeEventListener(type, callback, option);\n    }\n  }\n\n  bind(ele, type, callback, option) {\n    if (ele instanceof Element) {\n      ele = ele.el;\n    }\n    this.pool.push({\n      ele, type, callback, option,\n    });\n    ele.addEventListener(type, callback, option);\n  }\n\n  remove(ele, type = '*', callback = null, option = null) {\n    const pool = [];\n    const rem = [];\n    this.pool.forEach((item) => {\n      const eqElem = ele === item.ele;\n      const eqOpt = option === null || option === item.option;\n      const eqType = type === '*' || type === item.type;\n      const eqCall = callback === null || callback === item.callback;\n      if (eqElem && eqType && eqCall && eqOpt) {\n        rem.push(item);\n      } else {\n        pool.push(item);\n      }\n    });\n    this.pool = pool;\n    return rem;\n  }\n\n  multipleUnbind(eles, type, callback, option) {\n    eles.forEach((item) => {\n      this.unbind(item, type, callback, option);\n    });\n  }\n\n  multipleBind(eles, type, callback, option) {\n    eles.forEach((item) => {\n      this.bind(item, type, callback, option);\n    });\n  }\n\n}\n\nconst pool = new BindPool();\n\nclass XEvent {\n\n  static unbind(target, name, fn, option = false) {\n    if (Array.isArray(target)) {\n      pool.multipleUnbind(target, name, fn, option);\n    } else {\n      pool.unbind(target, name, fn, option);\n    }\n    return target;\n  }\n\n  static bind(target, name, fn, option = false) {\n    if (Array.isArray(target)) {\n      pool.multipleBind(target, name, fn, option);\n    } else {\n      pool.bind(target, name, fn, option);\n    }\n    return target;\n  }\n\n  static mouseHold(target, holdFunc = () => {}, endFunc = () => {}, time = 150) {\n    let handle = setInterval(() => {\n      holdFunc();\n    }, time);\n    let xEvtUp = (evt) => {\n      clearInterval(handle);\n      XEvent.unbind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_UP, xEvtUp, true);\n      endFunc(evt);\n    };\n    holdFunc();\n    XEvent.bind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_UP, xEvtUp, true);\n  }\n\n  static mouseMoveUp(target, moveFunc = () => {}, upFunc = () => {}) {\n    const xEvtMove = (evt) => {\n      moveFunc(evt);\n      evt.stopPropagation();\n      evt.preventDefault();\n    };\n    const xEvtUp = (evt) => {\n      XEvent.unbind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_MOVE, xEvtMove, true);\n      XEvent.unbind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_UP, xEvtUp, true);\n      upFunc(evt);\n      evt.preventDefault();\n    };\n    XEvent.bind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_MOVE, xEvtMove, true);\n    XEvent.bind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_UP, xEvtUp, true);\n    return target;\n  }\n\n}\n\nXEvent.WrapFuncion = {\n  doubleClick: (callback) => {\n    let lastPageX = 0;\n    let lastPageY = 0;\n    let lastTime = 0;\n    return (event) => {\n      if (event.button === 2) {\n        lastPageX = 0;\n        lastTime = 0;\n        lastPageY = 0;\n        return;\n      }\n      const { pageX, pageY } = event;\n      const current = Date.now();\n      const diffTime = current - lastTime <= 300;\n      const diffPageX = pageX === lastPageX;\n      const diffPageY = pageY === lastPageY;\n      if (diffTime && diffPageX && diffPageY) {\n        callback(event);\n        lastTime = 0;\n        lastPageX = 0;\n        lastPageY = 0;\n      } else {\n        lastPageX = pageX;\n        lastPageY = pageY;\n        lastTime = current;\n      }\n    };\n  },\n  mouseClick: callback => (event) => {\n    callback(event);\n  },\n};\n\nexport {\n  XEvent,\n};\n","/* global document */\n\nimport { Element, h } from './Element';\nimport { cssPrefix } from '../const/Constant';\nimport { XEvent } from './XEvent';\n\n/**\n * Life\n */\nclass Life extends Element {\n\n  onAttach() { }\n\n}\n\n/**\n * Widget\n */\nclass Widget extends Life {\n\n  /**\n   * Widget\n   * @param className\n   * @param nodeType\n   * @param $$rootFlag\n   */\n  constructor(className = '', nodeType = 'div', $$rootFlag = false) {\n    if (typeof className === 'string') {\n      super(nodeType, `${cssPrefix}-widget ${className}`);\n    } else {\n      super(className);\n    }\n    this.$$rootFlag = $$rootFlag;\n  }\n\n  /**\n   * 查找最邻近\n   * 的class元素\n   * @param clazz\n   */\n  closestClass(clazz) {\n    let node = this;\n    while (!h(document.body).is(node)) {\n      if (node.hasClass(clazz)) {\n        return node;\n      }\n      node = node.parent();\n    }\n    return null;\n  }\n\n  /**\n   * 获取 root widget\n   */\n  getRootWidget() {\n    let parent = this.data('parent');\n    while (parent && !parent.$$rootFlag) {\n      parent = parent.data('parent');\n    }\n    return parent;\n  }\n\n  /**\n   * 绑定处理事件\n   */\n  bind() {\n\n  }\n\n  /**\n   * 解绑事件处理\n   */\n  unbind() {\n    XEvent.unbind(this);\n  }\n\n  /**\n   * 追加节点\n   * 触发onAttach事件\n   * @param widget\n   */\n  attach(widget) {\n    this.childrenNodes(widget);\n    widget.parentWidget(this);\n    widget.onAttach(this);\n  }\n\n  /**\n   * 设置 parent widget\n   * @param widget\n   */\n  parentWidget(widget) {\n    if (widget) {\n      this.data('parent', widget);\n      return this;\n    }\n    return this.data('parent');\n  }\n\n  /**\n   * 计算鼠标在当前\n   * 元素中的位置\n   * @param event\n   * @param elem\n   * @returns {{x: number, y: number}}\n   */\n  eventXy(event, elem = this) {\n    const { top, left } = elem.box();\n    return {\n      y: event.clientY - top,\n      x: event.clientX - left,\n    };\n  }\n\n  /**\n   * 销毁组件\n   */\n  destroy() {\n    this.unbind();\n    this.remove();\n  }\n\n}\n\nconst w = (className = '', nodeType = 'div') => new Widget(className, nodeType);\n\nexport {\n  Widget,\n  w,\n};\n","import { Widget } from '../../../../lib/Widget';\nimport { cssPrefix } from '../../../../const/Constant';\nimport { h } from '../../../../lib/Element';\n\nclass Icon extends Widget {\n\n  constructor(className = '') {\n    super(`${cssPrefix}-icon`);\n    this.iconNameEl = h('div', `${cssPrefix}-icon-img ${className}`);\n    this.childrenNodes(this.iconNameEl);\n  }\n\n  setWidth(width) {\n    this.iconNameEl.css('width', `${width}px`);\n  }\n\n  setHeight(height) {\n    this.iconNameEl.css('height', `${height}px`);\n  }\n\n}\n\nexport { Icon };\n","/* global document */\nimport { Widget } from '../../lib/Widget';\nimport { cssPrefix, Constant } from '../../const/Constant';\nimport { XEvent } from '../../lib/XEvent';\n\nimport { h } from '../../lib/Element';\nimport { SheetUtils } from '../../utils/SheetUtils';\n\nlet instances = [];\n\n/**\n * DragPanel\n * @author jerry\n * @date 2020/10/19\n */\nclass DragPanel extends Widget {\n\n  /**\n   * DragPanel\n   * @param options\n   */\n  constructor(options) {\n    super(`${cssPrefix}-drag-panel`);\n    instances.push(this);\n    this.options = SheetUtils.copy({\n      position: DragPanel.DRAG_PANEL_POSITION.CENTER,\n    }, options);\n    this.status = false;\n    this.mask = h('div', `${cssPrefix}-drag-panel-mask`);\n    this.content = h('div', `${cssPrefix}-drag-panel-content`);\n    super.childrenNodes(this.content);\n    this.bind();\n  }\n\n  /**\n   * 显示弹框\n   */\n  open() {\n    const root = this.getRootWidget();\n    const { mask } = this;\n    if (this.status === false && root) {\n      this.status = true;\n      root.childrenNodes(mask);\n      root.childrenNodes(this);\n      this.dragPanelLocation();\n    }\n    return this;\n  }\n\n  /**\n   * 关闭弹框\n   */\n  close() {\n    const root = this.getRootWidget();\n    if (this.status === true && root) {\n      const { mask } = this;\n      this.status = false;\n      root.remove(this);\n      root.remove(mask);\n    }\n    return this;\n  }\n\n  /**\n   * 卸载事件\n   */\n  unbind() {\n    const { mask } = this;\n    XEvent.unbind(mask);\n  }\n\n  /**\n   * 绑定事件\n   */\n  bind() {\n    const { mask } = this;\n    XEvent.bind(mask, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (e) => {\n      this.close();\n      e.stopPropagation();\n    });\n    XEvent.bind(this, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (evt1) => {\n      if (evt1.button !== 0) return;\n      const downEventXy = this.eventXy(evt1, this);\n      XEvent.mouseMoveUp(h(document), (evt2) => {\n        // 计算移动的距离\n        const top = evt2.pageY - downEventXy.y;\n        const left = evt2.pageX - downEventXy.x;\n        this.offset({ top, left });\n        evt2.stopPropagation();\n      });\n      evt1.stopPropagation();\n    });\n  }\n\n  /**\n   * 设置显示位置\n   */\n  dragPanelLocation() {\n    const root = this.getRootWidget();\n    const { options } = this;\n    const { position } = options;\n    const rootBox = root.box();\n    const elemBox = this.box();\n    switch (position) {\n      case DragPanel.DRAG_PANEL_POSITION.LEFT:\n        break;\n      case DragPanel.DRAG_PANEL_POSITION.RIGHT:\n        break;\n      case DragPanel.DRAG_PANEL_POSITION.TOP:\n        break;\n      case DragPanel.DRAG_PANEL_POSITION.CENTER:\n        this.offset({\n          left: rootBox.width / 2 - elemBox.width / 2,\n          top: rootBox.height / 2 - elemBox.height / 2,\n        });\n        break;\n      default: break;\n    }\n    return this;\n  }\n\n  /**\n   * 添加子元素\n   * @param args\n   * @returns {DragPanel}\n   */\n  childrenNodes(...args) {\n    this.content.childrenNodes(...args);\n    return this;\n  }\n\n  /**\n   * 销毁组件\n   */\n  destroy() {\n    super.destroy();\n    this.unbind();\n    DragPanel.removeInstance(this);\n  }\n\n  /**\n   * 删除实例\n   * @param instance\n   */\n  static removeInstance(instance) {\n    const filter = [];\n    instances.forEach((item) => {\n      if (item !== instance) {\n        filter.push(item);\n      }\n    });\n    instances = filter;\n  }\n\n  /**\n   * 关闭所有实例\n   * @param filter\n   */\n  static closeAll(filter = []) {\n    instances.forEach((item) => {\n      if (filter.indexOf(item) === -1) {\n        item.close();\n      }\n    });\n  }\n\n}\n\nDragPanel.DRAG_PANEL_POSITION = {\n  LEFT: 1,\n  TOP: 2,\n  RIGHT: 3,\n  CENTER: 4,\n};\n\nexport { DragPanel };\n","/* global document */\nimport { h } from '../../lib/Element';\nimport { cssPrefix, Constant } from '../../const/Constant';\nimport { Widget } from '../../lib/Widget';\nimport { DragPanel } from '../dragpanel/DragPanel';\nimport { XEvent } from '../../lib/XEvent';\nimport { SheetUtils } from '../../utils/SheetUtils';\n\nclass ColorPicker extends Widget {\n\n  constructor(options) {\n    super(`${cssPrefix}-color-picker`);\n    this.options = SheetUtils.copy({\n      selectCb: () => {},\n    }, options);\n    // 拖拽组件\n    this.dragPanel = new DragPanel().parentWidget(this);\n    this.color = [360, 0, 100];\n    // 头部\n    this.preViewColorPoint = h('div', `${cssPrefix}-color-picker-pre-view-color-point`);\n    this.colorValueTips = h('div', `${cssPrefix}-color-picker-color-value-tips`);\n    this.colorValueTips.text('十六进制颜色值');\n    this.colorInput = h('input', `${cssPrefix}-color-picker-color-input`);\n    this.top = h('div', `${cssPrefix}-color-picker-top`);\n    this.top.childrenNodes(this.preViewColorPoint);\n    this.top.childrenNodes(this.colorValueTips);\n    this.top.childrenNodes(this.colorInput);\n    // 中间部分\n    this.selectColorPoint = h('div', `${cssPrefix}-color-picker-select-color-point`);\n    this.selectColorArea1 = h('div', `${cssPrefix}-color-picker-select-color-area area1`);\n    this.selectColorArea2 = h('div', `${cssPrefix}-color-picker-select-color-area area2`);\n    this.selectColorArea3 = h('div', `${cssPrefix}-color-picker-select-color-area area3`);\n    this.center = h('div', `${cssPrefix}-color-picker-center`);\n    this.center.childrenNodes(this.selectColorArea1);\n    this.center.childrenNodes(this.selectColorArea2);\n    this.center.childrenNodes(this.selectColorArea3);\n    this.center.childrenNodes(this.selectColorPoint);\n    // 底部\n    this.colorHuxTips = h('div', `${cssPrefix}-color-picker-color-hux-tips`);\n    this.colorBar = h('div', `${cssPrefix}-color-picker-color-bar`);\n    this.colorBarPoint = h('div', `${cssPrefix}-color-picker-bar-point`);\n    this.bottom = h('div', `${cssPrefix}-color-picker-bottom`);\n    this.colorHuxTips.text('HUE');\n    this.colorBar.childrenNodes(this.colorBarPoint);\n    this.bottom.childrenNodes(this.colorHuxTips);\n    this.bottom.childrenNodes(this.colorBar);\n    // 按钮\n    this.cancelButton = h('div', `${cssPrefix}-color-picker-button cancel`);\n    this.selectButton = h('div', `${cssPrefix}-color-picker-button select`);\n    this.buttons = h('div', `${cssPrefix}-color-picker-buttons`);\n    this.cancelButton.text('取消');\n    this.selectButton.text('确定');\n    this.buttons.childrenNodes(this.selectButton);\n    this.buttons.childrenNodes(this.cancelButton);\n    this.childrenNodes(this.top);\n    this.childrenNodes(this.center);\n    this.childrenNodes(this.bottom);\n    this.childrenNodes(this.buttons);\n    this.dragPanel.childrenNodes(this);\n    this.dragPanel.css('background', '#ffffff');\n    this.bind();\n  }\n\n  unbind() {\n    const { selectColorPoint } = this;\n    const { colorBarPoint } = this;\n    const {\n      colorInput, cancelButton, selectButton,\n    } = this;\n    XEvent.unbind(colorInput);\n    XEvent.unbind(colorInput);\n    XEvent.unbind(colorBarPoint);\n    XEvent.unbind(selectColorPoint);\n    XEvent.unbind(cancelButton);\n    XEvent.unbind(selectButton);\n  }\n\n  bind() {\n    const { selectColorPoint, center } = this;\n    const { colorBarPoint, colorBar } = this;\n    const {\n      colorInput, cancelButton, selectButton,\n    } = this;\n    XEvent.bind(colorInput, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (e1) => {\n      e1.stopPropagation();\n    });\n    XEvent.bind(colorInput, Constant.SYSTEM_EVENT_TYPE.CHANGE, () => {\n      const value = colorInput.val();\n      if (value) {\n        this.hexColor(value);\n      }\n    });\n    XEvent.bind(colorBarPoint, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (e1) => {\n      const xy = this.eventXy(e1, colorBar);\n      const colorBarBox = colorBar.box();\n      if (xy.x < 0) xy.x = 0;\n      if (xy.x > colorBarBox.width) xy.x = colorBarBox.width;\n      this.downHue(xy.x, colorBarBox.width);\n      XEvent.mouseMoveUp(h(document), (e2) => {\n        const xy = this.eventXy(e2, colorBar);\n        const colorBarBox = colorBar.box();\n        if (xy.x < 0) xy.x = 0;\n        if (xy.x > colorBarBox.width) xy.x = colorBarBox.width;\n        this.moveHue(xy.x, colorBarBox.width);\n      });\n      e1.stopPropagation();\n    });\n    XEvent.bind(selectColorPoint, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (e1) => {\n      const xy = this.eventXy(e1, center);\n      const centerBox = center.box();\n      if (xy.x < 0) xy.x = 0;\n      if (xy.x > centerBox.width) xy.x = centerBox.width;\n      if (xy.y < 0) xy.y = 0;\n      if (xy.y > centerBox.height) xy.y = centerBox.height;\n      this.downSelect(xy.x, xy.y, centerBox.width, centerBox.height);\n      XEvent.mouseMoveUp(h(document), (e2) => {\n        const xy = this.eventXy(e2, center);\n        if (xy.x < 0) xy.x = 0;\n        if (xy.x > centerBox.width) xy.x = centerBox.width;\n        if (xy.y < 0) xy.y = 0;\n        if (xy.y > centerBox.height) xy.y = centerBox.height;\n        this.moveSelect(xy.x, xy.y, centerBox.width, centerBox.height);\n      });\n      e1.stopPropagation();\n    });\n    XEvent.bind(cancelButton, Constant.SYSTEM_EVENT_TYPE.CLICK, () => {\n      this.close();\n    });\n    XEvent.bind(selectButton, Constant.SYSTEM_EVENT_TYPE.CLICK, () => {\n      const { color } = this;\n      const hsb = ColorPicker.fixHsx({\n        h: parseInt(color[0], 10),\n        s: parseInt(color[1], 10),\n        x: parseInt(color[2], 10),\n      });\n      const rgb = ColorPicker.hsbToRgb(hsb);\n      this.options.selectCb(`rgb(${rgb.r},${rgb.g},${rgb.b})`);\n      this.close();\n    });\n  }\n\n  open(hex) {\n    const { dragPanel } = this;\n    dragPanel.open();\n    if (hex) {\n      if (ColorPicker.isRgb(hex)) {\n        const rgb = ColorPicker.parseRgb(hex);\n        // eslint-disable-next-line no-param-reassign\n        hex = ColorPicker.rgbToHex(rgb);\n      }\n      this.hexColor(hex);\n    } else {\n      this.change();\n    }\n    return this;\n  }\n\n  close() {\n    const { dragPanel } = this;\n    dragPanel.close();\n    return this;\n  }\n\n  sliderPosition(hsb) {\n    // hue 滑块位置\n    const { colorBar, colorBarPoint } = this;\n    const colorBarPointBox = colorBarPoint.box();\n    const colorBarBox = colorBar.box();\n    let colorBarPointLeft = parseInt(colorBarBox.width - colorBarBox.width * hsb.h / 360, 10);\n    colorBarPointLeft -= colorBarPointBox.width / 2;\n    colorBarPoint.offset({\n      left: colorBarPointLeft,\n    });\n    // select color 滑块位置\n    const { center, selectColorPoint } = this;\n    const selectColorPointBox = selectColorPoint.box();\n    const centerBox = center.box();\n    let selectColorPointLeft = parseInt(centerBox.width * hsb.s / 100, 10);\n    let selectColorPointTop = parseInt(centerBox.height * (100 - hsb.x) / 100, 10);\n    selectColorPointLeft -= selectColorPointBox.width / 2;\n    selectColorPointTop -= selectColorPointBox.height / 2;\n    selectColorPoint.offset({\n      left: selectColorPointLeft,\n      top: selectColorPointTop,\n    });\n  }\n\n  hueChange() {\n    const { color } = this;\n    const hsb = ColorPicker.fixHsx({\n      h: parseInt(color[0], 10),\n      s: parseInt(color[1], 10),\n      x: parseInt(color[2], 10),\n    });\n    const {\n      colorBarPoint, selectColorPoint, preViewColorPoint, selectColorArea1, colorInput,\n    } = this;\n    const colorValue = ColorPicker.hsbToHex(hsb);\n    const areaColorValue = ColorPicker.hsbToHex({ h: hsb.h, s: 100, x: 100 });\n    selectColorPoint.css('backgroundColor', `#${colorValue}`);\n    preViewColorPoint.css('backgroundColor', `#${colorValue}`);\n    colorBarPoint.css('backgroundColor', `#${areaColorValue}`);\n    selectColorArea1.css('backgroundColor', `#${areaColorValue}`);\n    colorInput.val(`#${colorValue}`);\n    this.sliderPosition(hsb);\n  }\n\n  selectChange() {\n    const { color } = this;\n    const hsb = ColorPicker.fixHsx({\n      h: parseInt(color[0], 10),\n      s: parseInt(color[1], 10),\n      x: parseInt(color[2], 10),\n    });\n    const { preViewColorPoint, selectColorPoint, colorInput } = this;\n    const colorValue = ColorPicker.hsbToHex(hsb);\n    selectColorPoint.css('backgroundColor', `#${colorValue}`);\n    preViewColorPoint.css('backgroundColor', `#${colorValue}`);\n    colorInput.val(`#${colorValue}`);\n    this.sliderPosition(hsb);\n  }\n\n  change() {\n    this.hueChange();\n    this.selectChange();\n  }\n\n  downSelect(x, y, width, height) {\n    const { color } = this;\n    color[1] = parseInt(100 * x / width, 10);\n    color[2] = parseInt(100 * (height - y) / height, 10);\n    this.selectChange();\n  }\n\n  moveSelect(x, y, width, height) {\n    const { color } = this;\n    color[1] = parseInt(100 * (Math.max(0, Math.min(width, x))) / width, 10);\n    color[2] = parseInt(100 * (height - Math.max(0, Math.min(height, y))) / height, 10);\n    this.selectChange();\n  }\n\n  downHue(x, width) {\n    const { color } = this;\n    color[0] = parseInt(360 * (width - x) / width, 10);\n    this.hueChange();\n  }\n\n  moveHue(x, width) {\n    const { color } = this;\n    color[0] = parseInt(360 * (width - Math.max(0, Math.min(width, x))) / width, 10);\n    this.hueChange();\n  }\n\n  hexColor(hex) {\n    const { color } = this;\n    const result = ColorPicker.hexToHsb(ColorPicker.fixHex(hex));\n    color[0] = result.h;\n    color[1] = result.s;\n    color[2] = result.x;\n    this.change();\n  }\n\n  destroy() {\n    super.destroy();\n    this.unbind();\n    this.dragPanel.destroy();\n  }\n\n  static fixHex(hex) {\n    const len = 6 - hex.length;\n    if (len > 0) {\n      const o = [];\n      for (let i = 0; i < len; i += 1) {\n        o.push('0');\n      }\n      o.push(hex);\n      // eslint-disable-next-line no-param-reassign\n      hex = o.join('');\n    }\n    return hex;\n  }\n\n  static fixHsx(hsx) {\n    return {\n      h: Math.min(360, Math.max(0, hsx.h)),\n      s: Math.min(100, Math.max(0, hsx.s)),\n      x: Math.min(100, Math.max(0, hsx.x)),\n    };\n  }\n\n  static isRgb(rgb) {\n    return rgb.startsWith('rgb');\n  }\n\n  static isHex(hex) {\n    return hex.startsWith('#');\n  }\n\n  static isDark(rgb) {\n    if (SheetUtils.isString(rgb)) {\n      if (this.isHex(rgb)) {\n        const v = ColorPicker.hexToRgb(rgb);\n        rgb = `rgb(${v.r}, ${v.g}, ${v.b})`;\n      }\n      const result = ColorPicker.parseRgb(rgb);\n      const { r, g, b } = result;\n      return (r * 0.299) + (g * 0.578) + (b * 0.114) >= 192;\n    }\n    return false;\n  }\n\n  static hexToRgb(hex) {\n    // eslint-disable-next-line no-redeclare,no-param-reassign\n    hex = parseInt(((hex.indexOf('#') > -1) ? hex.substring(1) : hex), 16);\n    // eslint-disable-next-line no-bitwise\n    return { r: hex >> 16, g: (hex & 0x00FF00) >> 8, b: (hex & 0x0000FF) };\n  }\n\n  static hexToHsb(hex) {\n    return this.rgbToHsb(this.hexToRgb(hex));\n  }\n\n  static rgbToHsb(rgb) {\n    const hsb = { h: 0, s: 0, x: 0 };\n    const min = Math.min(rgb.r, rgb.g, rgb.b);\n    const max = Math.max(rgb.r, rgb.g, rgb.b);\n    const delta = max - min;\n    hsb.x = max;\n    hsb.s = max !== 0 ? 255 * delta / max : 0;\n    if (hsb.s !== 0) {\n      if (rgb.r === max) hsb.h = (rgb.g - rgb.b) / delta;\n      else if (rgb.g === max) hsb.h = 2 + (rgb.b - rgb.r) / delta;\n      else hsb.h = 4 + (rgb.r - rgb.g) / delta;\n    } else hsb.h = -1;\n    hsb.h *= 60;\n    if (hsb.h < 0) hsb.h += 360;\n    hsb.s *= 100 / 255;\n    hsb.x *= 100 / 255;\n    return hsb;\n  }\n\n  static hsbToRgb(hsb) {\n    const rgb = {};\n    let { h } = hsb;\n    const s = hsb.s * 255 / 100;\n    const v = hsb.x * 255 / 100;\n    if (s === 0) {\n      rgb.r = v;\n      rgb.g = v;\n      rgb.b = v;\n    } else {\n      const t1 = v;\n      const t2 = (255 - s) * v / 255;\n      const t3 = (t1 - t2) * (h % 60) / 60;\n      if (h === 360) h = 0;\n      if (h < 60) {\n        rgb.r = t1;\n        rgb.b = t2;\n        rgb.g = t2 + t3;\n      } else if (h < 120) {\n        rgb.g = t1;\n        rgb.b = t2;\n        rgb.r = t1 - t3;\n      } else if (h < 180) {\n        rgb.g = t1;\n        rgb.r = t2;\n        rgb.b = t2 + t3;\n      } else if (h < 240) {\n        rgb.b = t1;\n        rgb.r = t2;\n        rgb.g = t1 - t3;\n      } else if (h < 300) {\n        rgb.b = t1;\n        rgb.g = t2;\n        rgb.r = t2 + t3;\n      } else if (h < 360) {\n        rgb.r = t1;\n        rgb.g = t2;\n        rgb.b = t1 - t3;\n      } else {\n        rgb.r = 0;\n        rgb.g = 0;\n        rgb.b = 0;\n      }\n    }\n    return { r: Math.round(rgb.r), g: Math.round(rgb.g), b: Math.round(rgb.b) };\n  }\n\n  static rgbToHex(rgb) {\n    const hex = [\n      rgb.r.toString(16),\n      rgb.g.toString(16),\n      rgb.b.toString(16),\n    ];\n    hex.forEach((val, nr) => {\n      if (val.length === 1) {\n        hex[nr] = `0${val}`;\n      }\n    });\n    return hex.join('');\n  }\n\n  static hsbToHex(hsb) {\n    return this.rgbToHex(this.hsbToRgb(hsb));\n  }\n\n  static parseRgb(rgb) {\n    const rxp = /^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)$/;\n    const result = rgb.match(rxp);\n    return {\n      r: parseInt(result[1], 10),\n      g: parseInt(result[2], 10),\n      b: parseInt(result[3], 10),\n    };\n  }\n\n  static parseRgbToHex(rgb, defaultValue = null) {\n    if (rgb) {\n      if (this.isHex(rgb)) {\n        return rgb.substring(1);\n      }\n      const value = this.parseRgb(rgb);\n      return this.rgbToHex(value);\n    }\n    return defaultValue;\n  }\n\n  static parseHexToRgb(hex, defaultValue = null) {\n    if (hex) {\n      const rgb = ColorPicker.hexToRgb(hex);\n      return `rgb(${rgb.r},${rgb.g},${rgb.b})`;\n    }\n    return defaultValue;\n  }\n\n}\n\nexport { ColorPicker };\n","import { Widget } from '../../../lib/Widget';\nimport { cssPrefix } from '../../../const/Constant';\nimport { SheetUtils } from '../../../utils/SheetUtils';\nimport { Icon } from '../../../core/work/head/tool/Icon';\nimport { ColorPicker } from '../ColorPicker';\n\nclass ColorItem extends Widget {\n\n  constructor(options) {\n    super(`${cssPrefix}-color-array-item`);\n    this.options = SheetUtils.copy({\n      color: null,\n      icon: null,\n    }, options);\n    this.icon = this.options.icon;\n    this.color = SheetUtils.blankClear(this.options.color);\n    if (this.icon) {\n      this.childrenNodes(this.options.icon);\n    }\n    if (this.color) {\n      this.css('backgroundColor', this.color);\n      if (ColorPicker.isDark(this.options.color)) {\n        this.checkedIcon = new Icon('checked-dark');\n        this.childrenNodes(this.checkedIcon);\n      } else {\n        this.checkedIcon = new Icon('checked-light');\n        this.childrenNodes(this.checkedIcon);\n      }\n      this.checkedIcon.hide();\n    }\n  }\n\n  setActive(active) {\n    if (this.checkedIcon) {\n      if (active) {\n        this.checkedIcon.show();\n      } else {\n        this.checkedIcon.hide();\n      }\n    }\n  }\n\n}\n\nexport { ColorItem };\n","import { Widget } from '../../../lib/Widget';\nimport { cssPrefix, Constant } from '../../../const/Constant';\nimport { ColorItem } from './ColorItem';\nimport { SheetUtils } from '../../../utils/SheetUtils';\nimport { XEvent } from '../../../lib/XEvent';\n\nclass ColorArray extends Widget {\n\n  constructor(options) {\n    super(`${cssPrefix}-color-array`);\n    this.options = SheetUtils.copy({\n      colors: [\n        new ColorItem({ color: 'rgb(0, 0, 0)' }),\n        new ColorItem({ color: 'rgb(67, 67, 67)' }),\n        new ColorItem({ color: 'rgb(102, 102, 102)' }),\n        new ColorItem({ color: 'rgb(153, 153, 153)' }),\n        new ColorItem({ color: 'rgb(183, 183, 183)' }),\n        new ColorItem({ color: 'rgb(204, 204, 204)' }),\n        new ColorItem({ color: 'rgb(217, 217, 217)' }),\n        new ColorItem({ color: 'rgb(239, 239, 239)' }),\n        new ColorItem({ color: 'rgb(255, 255, 255)' }),\n\n        new ColorItem({ color: 'rgb(152, 0, 0)' }),\n        new ColorItem({ color: 'rgb(255, 0, 0)' }),\n        new ColorItem({ color: 'rgb(255, 153, 0)' }),\n        new ColorItem({ color: 'rgb(255, 255, 0)' }),\n        new ColorItem({ color: 'rgb(0, 255, 0)' }),\n        new ColorItem({ color: 'rgb(0, 255, 255)' }),\n        new ColorItem({ color: 'rgb(74, 134, 232)' }),\n        new ColorItem({ color: 'rgb(0, 0, 255)' }),\n        new ColorItem({ color: 'rgb(153, 0, 255)' }),\n        new ColorItem({ color: 'rgb(255, 0, 255)' }),\n\n        new ColorItem({ color: 'rgb(230, 184, 175)' }),\n        new ColorItem({ color: 'rgb(244, 204, 204)' }),\n        new ColorItem({ color: 'rgb(252, 229, 205)' }),\n        new ColorItem({ color: 'rgb(255, 242, 204)' }),\n        new ColorItem({ color: 'rgb(217, 234, 211)' }),\n        new ColorItem({ color: 'rgb(208, 224, 227)' }),\n        new ColorItem({ color: 'rgb(201, 218, 248)' }),\n        new ColorItem({ color: 'rgb(207, 226, 243)' }),\n        new ColorItem({ color: 'rgb(217, 210, 233)' }),\n        new ColorItem({ color: 'rgb(234, 209, 220)' }),\n\n        new ColorItem({ color: 'rgb(221, 126, 107)' }),\n        new ColorItem({ color: 'rgb(234, 153, 153)' }),\n        new ColorItem({ color: 'rgb(249, 203, 156)' }),\n        new ColorItem({ color: 'rgb(255, 229, 153)' }),\n        new ColorItem({ color: 'rgb(182, 215, 168)' }),\n        new ColorItem({ color: 'rgb(162, 196, 201)' }),\n        new ColorItem({ color: 'rgb(164, 194, 244)' }),\n        new ColorItem({ color: 'rgb(159, 197, 232)' }),\n        new ColorItem({ color: 'rgb(180, 167, 214)' }),\n        new ColorItem({ color: 'rgb(213, 166, 189)' }),\n\n        new ColorItem({ color: 'rgb(204, 65, 37)' }),\n        new ColorItem({ color: 'rgb(224, 102, 102)' }),\n        new ColorItem({ color: 'rgb(246, 178, 107)' }),\n        new ColorItem({ color: 'rgb(255, 217, 102)' }),\n        new ColorItem({ color: 'rgb(147, 196, 125)' }),\n        new ColorItem({ color: 'rgb(118, 165, 175)' }),\n        new ColorItem({ color: 'rgb(109, 158, 235)' }),\n        new ColorItem({ color: 'rgb(111, 168, 220)' }),\n        new ColorItem({ color: 'rgb(142, 124, 195)' }),\n        new ColorItem({ color: 'rgb(194, 123, 160)' }),\n\n        new ColorItem({ color: 'rgb(166, 28, 0)' }),\n        new ColorItem({ color: 'rgb(204, 0, 0)' }),\n        new ColorItem({ color: 'rgb(230, 145, 56)' }),\n        new ColorItem({ color: 'rgb(241, 194, 50)' }),\n        new ColorItem({ color: 'rgb(106, 168, 79)' }),\n        new ColorItem({ color: 'rgb(69, 129, 142)' }),\n        new ColorItem({ color: 'rgb(60, 120, 216)' }),\n        new ColorItem({ color: 'rgb(61, 133, 198)' }),\n        new ColorItem({ color: 'rgb(103, 78, 167)' }),\n        new ColorItem({ color: 'rgb(166, 77, 121)' }),\n\n        new ColorItem({ color: 'rgb(133, 32, 12)' }),\n        new ColorItem({ color: 'rgb(153, 0, 0)' }),\n        new ColorItem({ color: 'rgb(180, 95, 6)' }),\n        new ColorItem({ color: 'rgb(191, 144, 0)' }),\n        new ColorItem({ color: 'rgb(56, 118, 29)' }),\n        new ColorItem({ color: 'rgb(19, 79, 92)' }),\n        new ColorItem({ color: 'rgb(17, 85, 204)' }),\n        new ColorItem({ color: 'rgb(11, 83, 148)' }),\n        new ColorItem({ color: 'rgb(53, 28, 117)' }),\n        new ColorItem({ color: 'rgb(116, 27, 71)' }),\n\n        new ColorItem({ color: 'rgb(91, 15, 0)' }),\n        new ColorItem({ color: 'rgb(102, 0, 0)' }),\n        new ColorItem({ color: 'rgb(120, 63, 4)' }),\n        new ColorItem({ color: 'rgb(127, 96, 0)' }),\n        new ColorItem({ color: 'rgb(39, 78, 19)' }),\n        new ColorItem({ color: 'rgb(12, 52, 61)' }),\n        new ColorItem({ color: 'rgb(28, 69, 135)' }),\n        new ColorItem({ color: 'rgb(7, 55, 99)' }),\n        new ColorItem({ color: 'rgb(32, 18, 77)' }),\n        new ColorItem({ color: 'rgb(76, 17, 48)' }),\n      ],\n      selectCb: () => {},\n    }, options);\n    this.colors = [];\n    this.activeColor = null;\n    this.options.colors.forEach((item) => {\n      this.add(item);\n    });\n    if (this.colors.length > 0) {\n      this.setActiveByColor(this.colors[0].options.color);\n    }\n  }\n\n  add(item) {\n    const find = this.colors.findIndex(color => color.color === item.color);\n    if (find === -1) {\n      const { colors } = this;\n      colors.push(item);\n      this.childrenNodes(item);\n      this.bind(item);\n    }\n  }\n\n  unbind() {\n    this.colors.forEach((item) => {\n      XEvent.unbind(item);\n    });\n  }\n\n  bind(item) {\n    XEvent.bind(item, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, () => {\n      this.options.selectCb(item);\n      if (item.options.color) {\n        this.setActiveByColor(item.options.color);\n      }\n    });\n  }\n\n  findItemByColor(color) {\n    color = SheetUtils.blankClear(color);\n    return this.colors.find(item => item.color === color);\n  }\n\n  setActiveByColor(color) {\n    color = SheetUtils.blankClear(color);\n    this.colors.forEach((item) => {\n      if (item.color === color) {\n        item.setActive(true);\n        this.activeColor = item.color;\n      } else {\n        item.setActive(false);\n      }\n    });\n  }\n\n  clear() {\n    this.unbind();\n    this.colors = [];\n    this.empty();\n  }\n\n  destroy() {\n    super.destroy();\n    this.unbind();\n  }\n\n}\n\nColorArray.BLACK = 'rgb(0, 0, 0)';\nColorArray.WHITE = 'rgb(255, 255, 255)';\n\nexport {\n  ColorArray,\n};\n","import { BaseFont } from '../../../draw/font/BaseFont';\nimport { ColorArray } from '../../../module/colorpicker/colorarray/ColorArray';\nimport { SheetUtils } from '../../../utils/SheetUtils';\n\n/**\n *  CellFont\n *  @author jerry\n */\nclass CellFont {\n\n  /**\n   * CellFont\n   * @param align\n   * @param verticalAlign\n   * @param textWrap\n   * @param strikethrough\n   * @param underline\n   * @param color\n   * @param name\n   * @param size\n   * @param bold\n   * @param italic\n   * @param angle\n   * @param direction\n   * @param padding\n   */\n  constructor({\n    align = BaseFont.ALIGN.left,\n    verticalAlign = BaseFont.VERTICAL_ALIGN.center,\n    textWrap = BaseFont.TEXT_WRAP.TRUNCATE,\n    strikethrough = false,\n    underline = false,\n    color = ColorArray.BLACK,\n    name = 'Arial',\n    size = 14,\n    bold = false,\n    italic = false,\n    angle = 0,\n    direction = BaseFont.TEXT_DIRECTION.HORIZONTAL,\n    padding = 5,\n  } = {}) {\n    this.align = align;\n    this.verticalAlign = verticalAlign;\n    this.textWrap = textWrap;\n    this.strikethrough = strikethrough;\n    this.underline = underline;\n    this.color = color;\n    this.name = name;\n    this.size = size;\n    this.bold = bold;\n    this.italic = italic;\n    this.direction = direction;\n    this.angle = angle;\n    this.padding = padding;\n  }\n\n  like(other) {\n    let keys1 = Object.keys(this);\n    let keys2 = Object.keys(other);\n    for (let key of keys2) {\n      if (!keys1.includes(key)) {\n        return false;\n      }\n    }\n    for (let key of keys2) {\n      let src = this[key];\n      let val = other[key];\n      switch (key) {\n        case 'color': {\n          src = SheetUtils.clearBlank(src);\n          val = SheetUtils.clearBlank(val);\n          break;\n        }\n      }\n      if (src !== val) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  clone() {\n    const {\n      align,\n      verticalAlign,\n      textWrap,\n      strikethrough,\n      underline,\n      color,\n      name,\n      size,\n      bold,\n      italic,\n      angle,\n      direction,\n      padding,\n    } = this;\n    return new CellFont({\n      align,\n      verticalAlign,\n      textWrap,\n      strikethrough,\n      underline,\n      color,\n      name,\n      size,\n      bold,\n      italic,\n      angle,\n      direction,\n      padding,\n    });\n  }\n\n  reset() {\n    this.align = BaseFont.ALIGN.left;\n    this.verticalAlign = BaseFont.VERTICAL_ALIGN.center;\n    this.textWrap = BaseFont.TEXT_WRAP.TRUNCATE;\n    this.strikethrough = false;\n    this.underline = false;\n    this.color = ColorArray.BLACK;\n    this.name = 'Arial';\n    this.size = 14;\n    this.bold = false;\n    this.italic = false;\n    this.angle = 0;\n    this.direction = BaseFont.TEXT_DIRECTION.HORIZONTAL;\n    this.padding = 5;\n  }\n\n  equals(other) {\n    let keys1 = Object.keys(this);\n    let keys2 = Object.keys(other);\n    for (let key of keys1) {\n      if (!keys2.includes(key)) {\n        return false;\n      }\n    }\n    for (let key of keys1) {\n      let src = this[key];\n      let val = other[key];\n      switch (key) {\n        case 'color': {\n          src = SheetUtils.clearBlank(src);\n          val = SheetUtils.clearBlank(val);\n          break;\n        }\n      }\n      if (src !== val) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n}\n\nCellFont.EMPTY = new CellFont();\n\nCellFont.getInstance = (config) => {\n  if (config) {\n    return new CellFont(config);\n  }\n  return CellFont.EMPTY;\n};\n\nexport { CellFont };\n","/* global devicePixelRatio */\nimport { SheetUtils } from '../utils/SheetUtils';\n\nlet DPR = SheetUtils.inWorker() ? 1 : devicePixelRatio;\nlet LINE_WIDTH_LOW = Math.round(DPR);\nlet LINE_WIDTH_MEDIUM = LINE_WIDTH_LOW + 2;\nlet LINE_WIDTH_HIGH = LINE_WIDTH_MEDIUM + 2;\nlet LINE_PIXEL_OFFSET = LINE_WIDTH_LOW / 2;\n\nclass Base {\n\n  static srcPx(px) {\n    return px / this.dpr();\n  }\n\n  static cssPx(px) {\n    return this.srcPx(this.stylePx(px));\n  }\n\n  static stylePx(px) {\n    return this.round(px * this.dpr());\n  }\n\n  static round(val) {\n    return Math.round(val);\n  }\n\n  static ceil(val) {\n    return Math.ceil(val);\n  }\n\n  static trunc(val) {\n    return Math.trunc(val);\n  }\n\n  static radian(angle) {\n    return -angle * (Math.PI / 180);\n  }\n\n  static dpr() {\n    return DPR;\n  }\n\n  static refresh(val = 1) {\n    DPR = SheetUtils.inWorker() ? val : devicePixelRatio;\n    LINE_WIDTH_LOW = Math.round(DPR);\n    LINE_WIDTH_MEDIUM = LINE_WIDTH_LOW + 2;\n    LINE_WIDTH_HIGH = LINE_WIDTH_MEDIUM + 2;\n    LINE_PIXEL_OFFSET = LINE_WIDTH_LOW / 2;\n  }\n\n  constructor(canvas) {\n    this.canvas = canvas;\n    this.ctx = canvas.getContext('2d');\n  }\n\n  attr(options) {\n    for (const key in options) {\n      if (options.hasOwnProperty(key)) {\n        let value = options[key];\n        if (typeof value === 'string' || value instanceof String) {\n          value = value.trim();\n        }\n        if (this.ctx[key] !== value) {\n          this.ctx[key] = value;\n        }\n      }\n    }\n    return this;\n  }\n\n  resize(width, height) {\n    const { canvas } = this;\n    canvas.width = Base.stylePx(width);\n    canvas.height = Base.stylePx(height);\n    canvas.style.width = `${canvas.width / Base.dpr()}px`;\n    canvas.style.height = `${canvas.height / Base.dpr()}px`;\n    return this;\n  }\n\n}\n\nclass Wrapping extends Base {\n\n  constructor(canvas) {\n    super(canvas);\n    this.dash = [];\n  }\n\n  beginPath() {\n    const { ctx } = this;\n    ctx.beginPath();\n    return this;\n  }\n\n  measureText(text) {\n    const { ctx } = this;\n    return ctx.measureText(text);\n  }\n\n  save() {\n    const { ctx } = this;\n    ctx.save();\n    return this;\n  }\n\n  restore() {\n    const { ctx } = this;\n    ctx.restore();\n    return this;\n  }\n\n  fill() {\n    const { ctx } = this;\n    ctx.fill();\n    return this;\n  }\n\n  clip() {\n    const { ctx } = this;\n    ctx.clip();\n    return this;\n  }\n\n  setLineDash(dash = []) {\n    const { ctx } = this;\n    this.dash = dash;\n    ctx.setLineDash(dash);\n    return this;\n  }\n\n  scale(x, y) {\n    const { ctx } = this;\n    ctx.scale(x, y);\n    return this;\n  }\n\n  translate(x, y) {\n    const { ctx } = this;\n    ctx.translate(x, y);\n    return this;\n  }\n\n  rotate(deg) {\n    const { ctx } = this;\n    ctx.rotate(deg);\n    return this;\n  }\n\n}\n\nclass Extends extends Wrapping {\n\n  polyStroke(interpolation = xys => xys, ...xys) {\n    const { ctx } = this;\n    if (xys.length > 1) {\n      this.beginPath();\n      const [x, y] = interpolation(xys[0]);\n      ctx.moveTo(x, y);\n      for (let i = 1, len = xys.length; i < len; i += 1) {\n        const [x, y] = interpolation(xys[i]);\n        ctx.lineTo(x, y);\n      }\n      ctx.stroke();\n    }\n  }\n\n  polyInFill(interpolation = xys => xys, ...xys) {\n    const { ctx } = this;\n    if (xys.length > 1) {\n      this.beginPath();\n      const [x, y] = interpolation(xys[0]);\n      ctx.moveTo(x, y);\n      for (let i = 1, len = xys.length; i < len; i += 1) {\n        const [x, y] = interpolation(xys[i]);\n        ctx.lineTo(x, y);\n      }\n      ctx.fill();\n    }\n  }\n\n  fullRect() {\n    const { canvas } = this;\n    const { width, height } = canvas;\n    this.ctx.fillRect(0, 0, width, height);\n    return this;\n  }\n\n  rotate(angle) {\n    super.rotate(Base.radian(angle));\n    return this;\n  }\n\n}\n\nclass Position extends Extends {\n\n  constructor(canvas) {\n    super(canvas);\n    this.offsetX = 0;\n    this.offsetY = 0;\n  }\n\n  offset(x, y) {\n    this.offsetX = x;\n    this.offsetY = y;\n  }\n\n  getOffsetX() {\n    return this.offsetX;\n  }\n\n  getOffsetY() {\n    return this.offsetY;\n  }\n\n  fillText() {\n    throw TypeError('child impl');\n  }\n\n  fillRect() {\n    throw TypeError('child impl');\n  }\n\n  rect() {\n    throw TypeError('child impl');\n  }\n\n  drawImage() {\n    throw TypeError('child impl');\n  }\n\n}\n\nclass BaseLine extends Position {\n\n  line(...xys) {\n    this.polyStroke((xys) => {\n      const [x, y] = xys;\n      return [this.linePx(Base.round(x + this.getOffsetX())),\n        this.linePx(Base.round(y + this.getOffsetY()))];\n    }, ...xys);\n    return this;\n  }\n\n  linePx(pixel) {\n    const { ctx } = this;\n    const {\n      lineWidth,\n    } = ctx;\n    return lineWidth % 2 === 0\n      ? pixel : pixel - 0.5;\n  }\n\n}\n\nclass CorsLine extends BaseLine {\n\n  static offsetToLineInside(val) {\n    return LINE_WIDTH_LOW > 1\n      ? val - LINE_PIXEL_OFFSET\n      : val - LINE_WIDTH_LOW;\n  }\n\n  static getLineWidthTypePx(type) {\n    switch (type) {\n      case CorsLine.LINE_WIDTH_TYPE.medium:\n        return LINE_WIDTH_MEDIUM;\n      case CorsLine.LINE_WIDTH_TYPE.low:\n        return LINE_WIDTH_LOW;\n      case CorsLine.LINE_WIDTH_TYPE.high:\n        return LINE_WIDTH_HIGH;\n    }\n    return 0;\n  }\n\n  constructor(canvas) {\n    super(canvas);\n    this.lineWidthType = CorsLine.LINE_WIDTH_TYPE.low;\n    this.lineColor = 'rgb(0,0,0)';\n  }\n\n  corsLine([sx, sy], [ex, ey]) {\n    const {\n      lineWidthType, lineColor,\n    } = this;\n    let lineWidth = LINE_WIDTH_LOW;\n    switch (lineWidthType) {\n      case CorsLine.LINE_WIDTH_TYPE.medium:\n        lineWidth = LINE_WIDTH_MEDIUM;\n        break;\n      case CorsLine.LINE_WIDTH_TYPE.low:\n        lineWidth = LINE_WIDTH_LOW;\n        break;\n      case CorsLine.LINE_WIDTH_TYPE.high:\n        lineWidth = LINE_WIDTH_HIGH;\n        break;\n    }\n    this.attr({\n      strokeStyle: lineColor,\n      lineWidth,\n    });\n    this.polyStroke((xys) => {\n      const [x, y] = xys;\n      return [\n        Base.round(x + this.getOffsetX()) - LINE_PIXEL_OFFSET,\n        Base.round(y + this.getOffsetY()) - LINE_PIXEL_OFFSET,\n      ];\n    }, [sx, sy], [ex, ey]);\n  }\n\n  setLineColor(color) {\n    this.lineColor = color;\n  }\n\n  setLineWidthType(type) {\n    this.lineWidthType = type;\n  }\n\n  horizonLine([sx, sy], [ex, ey]) {\n    if (sy !== ey) {\n      throw new TypeError('Error Horizon Line');\n    }\n    this.corsLine([sx, sy], [ex, ey]);\n  }\n\n  verticalLine([sx, sy], [ex, ey]) {\n    if (sx !== ex) {\n      throw new TypeError('Error Vertical Line');\n    }\n    this.corsLine([sx, sy], [ex, ey]);\n  }\n\n}\nCorsLine.LINE_WIDTH_TYPE = {\n  low: 'low',\n  medium: 'medium',\n  high: 'high',\n};\n\nclass XDraw extends CorsLine {\n\n  fillText(text, x, y) {\n    x += this.getOffsetX();\n    y += this.getOffsetY();\n    this.ctx.fillText(text, XDraw.round(x), XDraw.round(y));\n    return this;\n  }\n\n  fillPath(path) {\n    this.polyInFill((xys) => {\n      const { x, y } = xys;\n      return [Base.round(x + this.getOffsetX()), Base.round(y + this.getOffsetY())];\n    }, ...path.points);\n    return this;\n  }\n\n  fillRect(x, y, w, h) {\n    x += this.getOffsetX();\n    y += this.getOffsetY();\n    this.ctx.fillRect(XDraw.round(x), XDraw.round(y),\n      XDraw.round(w), XDraw.round(h));\n    return this;\n  }\n\n  rect(x, y, w, h) {\n    x += this.getOffsetX();\n    y += this.getOffsetY();\n    this.ctx.rect(XDraw.round(x), XDraw.round(y),\n      XDraw.round(w), XDraw.round(h));\n    return this;\n  }\n\n  copyImage(sx, sy, sw, sh, tx, ty, tw, th) {\n    const { ctx } = this;\n    tx += this.getOffsetX();\n    sx += this.getOffsetX();\n    ty += this.getOffsetY();\n    sy += this.getOffsetY();\n    ctx.drawImage(this.canvas,\n      XDraw.round(sx), XDraw.round(sy),\n      XDraw.round(sw), XDraw.round(sh),\n      XDraw.round(tx), XDraw.round(ty),\n      XDraw.round(tw), XDraw.round(th));\n    return this;\n  }\n\n  drawImage(el, sx, sy, sw, sh, tx, ty, tw, th) {\n    const { ctx } = this;\n    tx += this.getOffsetX();\n    ty += this.getOffsetY();\n    ctx.drawImage(el,\n      XDraw.round(sx), XDraw.round(sy),\n      XDraw.round(sw), XDraw.round(sh),\n      XDraw.round(tx), XDraw.round(ty),\n      XDraw.round(tw), XDraw.round(th));\n    return this;\n  }\n\n}\n\nexport {\n  XDraw,\n};\n","import { SheetUtils } from '../utils/SheetUtils';\nimport { XDraw } from './XDraw';\n\nconst LINE_TYPE = {\n  SOLID_LINE: 0,\n  DOTTED_LINE: 1,\n  POINT_LINE: 2,\n  DOUBLE_LINE: 3,\n};\n\nclass SolidLine {\n\n  constructor(draw, attr) {\n    this.draw = draw;\n    SheetUtils.copy(this, {\n      color: 'rgb(0,0,0)',\n      widthType: XDraw.LINE_WIDTH_TYPE.low,\n    }, attr);\n  }\n\n  setWidthType(widthType) {\n    this.widthType = widthType;\n  }\n\n  setColor(color) {\n    this.color = color;\n  }\n\n  horizonLine(sx, sy, ex, ey) {\n    const { draw } = this;\n    const {\n      widthType, color,\n    } = this;\n    draw.setLineColor(color);\n    draw.setLineWidthType(widthType);\n    draw.setLineDash([]);\n    draw.horizonLine([sx, sy], [ex, ey]);\n  }\n\n  verticalLine(sx, sy, ex, ey) {\n    const { draw } = this;\n    const {\n      widthType, color,\n    } = this;\n    draw.setLineColor(color);\n    draw.setLineWidthType(widthType);\n    draw.setLineDash([]);\n    draw.verticalLine([sx, sy], [ex, ey]);\n  }\n\n  tiltingLine(sx, sy, ex, ey) {\n    const { draw } = this;\n    const {\n      widthType, color,\n    } = this;\n    draw.setLineColor(color);\n    draw.setLineWidthType(widthType);\n    draw.setLineDash([]);\n    draw.corsLine([sx, sy], [ex, ey]);\n  }\n\n}\n\nclass DottedLine {\n\n  constructor(draw, attr) {\n    this.draw = draw;\n    SheetUtils.copy(this, {\n      color: 'rgb(0,0,0)',\n      widthType: XDraw.LINE_WIDTH_TYPE.low,\n      dash: [5],\n    }, attr);\n  }\n\n  setWidthType(widthType) {\n    this.widthType = widthType;\n  }\n\n  setColor(color) {\n    this.color = color;\n  }\n\n  horizonLine(sx, sy, ex, ey) {\n    const { draw, dash } = this;\n    const {\n      widthType, color,\n    } = this;\n    draw.setLineColor(color);\n    draw.setLineWidthType(widthType);\n    draw.setLineDash(dash);\n    draw.horizonLine([sx, sy], [ex, ey]);\n  }\n\n  verticalLine(sx, sy, ex, ey) {\n    const { draw, dash } = this;\n    const {\n      widthType, color,\n    } = this;\n    draw.setLineColor(color);\n    draw.setLineWidthType(widthType);\n    draw.setLineDash(dash);\n    draw.verticalLine([sx, sy], [ex, ey]);\n  }\n\n  tiltingLine(sx, sy, ex, ey) {\n    const { draw, dash } = this;\n    const {\n      widthType, color,\n    } = this;\n    draw.setLineColor(color);\n    draw.setLineWidthType(widthType);\n    draw.setLineDash(dash);\n    draw.corsLine([sx, sy], [ex, ey]);\n  }\n\n}\n\nclass DoubleLine {\n\n  constructor(draw, attr) {\n    this.draw = draw;\n    SheetUtils.copy(this, {\n      color: 'rgb(0,0,0)',\n      widthType: XDraw.LINE_WIDTH_TYPE.low,\n      padding: 1,\n      spacing: DoubleLine.spacing,\n      leftShow: () => false,\n      topShow: () => false,\n      rightShow: () => false,\n      bottomShow: () => false,\n      iFMerge: () => false,\n      iFMergeFirstRow: () => false,\n      iFMergeLastRow: () => false,\n      iFMergeFirstCol: () => false,\n      iFMergeLastCol: () => false,\n    }, attr);\n  }\n\n  setWidthType(widthType) {\n    this.widthType = widthType;\n  }\n\n  setColor(color) {\n    this.color = color;\n  }\n\n  handleExternal(sx, sy, ex, ey, row, col, pos) {\n    const external = {};\n    const { leftShow, topShow, rightShow, bottomShow } = this;\n    const { iFMerge, iFMergeFirstRow, iFMergeLastRow, iFMergeFirstCol, iFMergeLastCol } = this;\n    const { spacing } = this;\n    let ifMerge = null;\n    let firstRow = null;\n    let lastRow = null;\n    let firstCol = null;\n    let lastCol = null;\n    switch (pos) {\n      case 'left':\n        ifMerge = iFMerge(row, col - 1);\n        if (ifMerge) {\n          firstRow = iFMergeFirstRow(row, col - 1);\n          lastRow = iFMergeLastRow(row, col - 1);\n          firstCol = iFMergeFirstCol(row, col - 1);\n          lastCol = iFMergeLastCol(row, col - 1);\n        }\n        break;\n      case 'top':\n        ifMerge = iFMerge(row - 1, col);\n        if (ifMerge) {\n          firstRow = iFMergeFirstRow(row - 1, col);\n          lastRow = iFMergeLastRow(row - 1, col);\n          firstCol = iFMergeFirstCol(row - 1, col);\n          lastCol = iFMergeLastCol(row - 1, col);\n        }\n        break;\n      case 'right':\n        ifMerge = iFMerge(row, col + 1);\n        if (ifMerge) {\n          firstRow = iFMergeFirstRow(row, col + 1);\n          lastRow = iFMergeLastRow(row, col + 1);\n          firstCol = iFMergeFirstCol(row, col + 1);\n          lastCol = iFMergeLastCol(row, col + 1);\n        }\n        break;\n      case 'bottom':\n        ifMerge = iFMerge(row + 1, col);\n        if (ifMerge) {\n          firstRow = iFMergeFirstRow(row + 1, col);\n          lastRow = iFMergeLastRow(row + 1, col);\n          firstCol = iFMergeFirstCol(row + 1, col);\n          lastCol = iFMergeLastCol(row + 1, col);\n        }\n        break;\n      default: break;\n    }\n    if (ifMerge) {\n      switch (pos) {\n        case 'left': {\n          external.sx = sx - spacing;\n          external.ex = ex - spacing;\n          // 检查顶边和上底边及左上角底边及左顶边\n          const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\n          const sTop = topShow(row, col);\n          const sBottom = bottomShow(row - 1, col);\n          external.sy = sy;\n          if (sTop || sBottom) external.sy = sy - spacing;\n          if (sTopLeftCorner && firstRow) external.sy = sy + spacing;\n          // 检查底边和下顶边及左下角顶边和左底边\n          const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\n          const eBottom = bottomShow(row, col);\n          const eTop = topShow(row + 1, col);\n          external.ey = ey;\n          if (eBottom || eTop) external.ey = ey + spacing;\n          if (eBottomLeftCorner && lastRow) external.ey = ey - spacing;\n          break;\n        }\n        case 'top': {\n          external.sy = sy - spacing;\n          external.ey = ey - spacing;\n          // 检查左边和左右边及左上角右边及上左边\n          const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\n          const sLeft = leftShow(row, col);\n          const sRight = rightShow(row, col - 1);\n          external.sx = sx;\n          if (sLeft || sRight) external.sx = sx - spacing;\n          if (sTopLeftCorner && firstCol) external.sx = sx + spacing;\n          // 检查右边和右左边及右上角左边及上右边\n          const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\n          const eRight = rightShow(row, col);\n          const eLeft = leftShow(row, col + 1);\n          external.ex = ex;\n          if (eRight || eLeft) external.ex = ex + spacing;\n          if (eTopRightCorner && lastCol) external.ex = ex - spacing;\n          break;\n        }\n        case 'right': {\n          external.sx = sx + spacing;\n          external.ex = ex + spacing;\n          // 检查顶边和上底边及右上角底边及右顶边\n          const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\n          const sTop = topShow(row, col);\n          const sBottom = bottomShow(row - 1, col);\n          external.sy = sy;\n          if (sTop || sBottom) external.sy = sy - spacing;\n          if (sTopRightCorner && firstRow) external.sy = sy + spacing;\n          // 检查底边和下顶边及右下角顶边及右底边\n          const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\n          const eBottom = bottomShow(row, col);\n          const eTop = topShow(row + 1, col);\n          external.ey = ey;\n          if (eBottom || eTop) external.ey = ey + spacing;\n          if (eBottomRightCorner && lastRow) external.ey = ey - spacing;\n          break;\n        }\n        case 'bottom': {\n          external.sy = sy + spacing;\n          external.ey = ey + spacing;\n          // 检查左边和左右边及左下角右边及下左边\n          const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\n          const sLeft = leftShow(row, col);\n          const sRight = rightShow(row, col - 1);\n          external.sx = sx;\n          if (sLeft || sRight) external.sx = sx - spacing;\n          if (sBottomLeftCorner && firstCol) external.sx = sx + spacing;\n          // 检查右边和右左边及右下角左边及下右边\n          const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\n          const eRight = rightShow(row, col);\n          const eLeft = leftShow(row, col + 1);\n          external.ex = ex;\n          if (eRight || eLeft) external.ex = ex + spacing;\n          if (eBottomRightCorner && lastCol) external.ex = ex - spacing;\n          break;\n        }\n        default: break;\n      }\n      return external;\n    }\n    switch (pos) {\n      case 'left': {\n        external.sx = sx - spacing;\n        external.ex = ex - spacing;\n        // 检查顶边和上底边及左上角底边及左顶边\n        const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\n        const sTop = topShow(row, col);\n        const sBottom = bottomShow(row - 1, col);\n        external.sy = sy;\n        if (sTop || sBottom) external.sy = sy - spacing;\n        if (sTopLeftCorner) external.sy = sy + spacing;\n        // 检查底边和下顶边及左下角顶边和左底边\n        const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\n        const eBottom = bottomShow(row, col);\n        const eTop = topShow(row + 1, col);\n        external.ey = ey;\n        if (eBottom || eTop) external.ey = ey + spacing;\n        if (eBottomLeftCorner) external.ey = ey - spacing;\n        break;\n      }\n      case 'top': {\n        external.sy = sy - spacing;\n        external.ey = ey - spacing;\n        // 检查左边和左右边及左上角右边及上左边\n        const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\n        const sLeft = leftShow(row, col);\n        const sRight = rightShow(row, col - 1);\n        external.sx = sx;\n        if (sLeft || sRight) external.sx = sx - spacing;\n        if (sTopLeftCorner) external.sx = sx + spacing;\n        // 检查右边和右左边及右上角左边及上右边\n        const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\n        const eRight = rightShow(row, col);\n        const eLeft = leftShow(row, col + 1);\n        external.ex = ex;\n        if (eRight || eLeft) external.ex = ex + spacing;\n        if (eTopRightCorner) external.ex = ex - spacing;\n        break;\n      }\n      case 'right': {\n        external.sx = sx + spacing;\n        external.ex = ex + spacing;\n        // 检查顶边和上底边及右上角底边及右顶边\n        const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\n        const sTop = topShow(row, col);\n        const sBottom = bottomShow(row - 1, col);\n        external.sy = sy;\n        if (sTop || sBottom) external.sy = sy - spacing;\n        if (sTopRightCorner) external.sy = sy + spacing;\n        // 检查底边和下顶边及右下角顶边及右底边\n        const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\n        const eBottom = bottomShow(row, col);\n        const eTop = topShow(row + 1, col);\n        external.ey = ey;\n        if (eBottom || eTop) external.ey = ey + spacing;\n        if (eBottomRightCorner) external.ey = ey - spacing;\n        break;\n      }\n      case 'bottom': {\n        external.sy = sy + spacing;\n        external.ey = ey + spacing;\n        // 检查左边和左右边及左下角右边及下左边\n        const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\n        const sLeft = leftShow(row, col);\n        const sRight = rightShow(row, col - 1);\n        external.sx = sx;\n        if (sLeft || sRight) external.sx = sx - spacing;\n        if (sBottomLeftCorner) external.sx = sx + spacing;\n        // 检查右边和右左边及右下角左边及下右边\n        const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\n        const eRight = rightShow(row, col);\n        const eLeft = leftShow(row, col + 1);\n        external.ex = ex;\n        if (eRight || eLeft) external.ex = ex + spacing;\n        if (eBottomRightCorner) external.ex = ex - spacing;\n        break;\n      }\n      default: break;\n    }\n    return external;\n  }\n\n  handleInternal(sx, sy, ex, ey, row, col, pos) {\n    const internal = {};\n    const { leftShow, topShow, rightShow, bottomShow } = this;\n    const { iFMerge, iFMergeFirstRow, iFMergeLastRow, iFMergeFirstCol, iFMergeLastCol } = this;\n    const { spacing } = this;\n    const ifMerge = iFMerge(row, col);\n    // merge\n    if (ifMerge) {\n      const firstRow = iFMergeFirstRow(row, col);\n      const lastRow = iFMergeLastRow(row, col);\n      const firstCol = iFMergeFirstCol(row, col);\n      const lastCol = iFMergeLastCol(row, col);\n      switch (pos) {\n        case 'left': {\n          internal.sx = sx + spacing;\n          internal.ex = ex + spacing;\n          // 检查顶边和上底边及左上角底边及左顶边\n          const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\n          const sTop = topShow(row, col);\n          const sBottom = bottomShow(row - 1, col);\n          internal.sy = sy;\n          if (sTopLeftCorner) internal.sy = sy - spacing;\n          if ((sTop || sBottom) && firstRow) internal.sy = sy + spacing;\n          // 检查底边和下顶边及左下角顶边和左底边\n          const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\n          const eBottom = bottomShow(row, col);\n          const eTop = topShow(row + 1, col);\n          internal.ey = ey;\n          if (eBottomLeftCorner) internal.ey = ey + spacing;\n          if ((eBottom || eTop) && lastRow) internal.ey = ey - spacing;\n          break;\n        }\n        case 'top': {\n          internal.sy = sy + spacing;\n          internal.ey = ey + spacing;\n          // 检查左边和左右边及左上角右边及上左边\n          const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\n          const sLeft = leftShow(row, col);\n          const sRight = rightShow(row, col - 1);\n          internal.sx = sx;\n          if (sTopLeftCorner) internal.sx = sx - spacing;\n          if ((sLeft || sRight) && firstCol) internal.sx = sx + spacing;\n          // 检查右边和右左边及右上角左边及上右边\n          const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\n          const eRight = rightShow(row, col);\n          const eLeft = leftShow(row, col + 1);\n          internal.ex = ex;\n          if (eTopRightCorner) internal.ex = ex + spacing;\n          if ((eRight || eLeft) && lastCol) internal.ex = ex - spacing;\n          break;\n        }\n        case 'right': {\n          internal.sx = sx - spacing;\n          internal.ex = ex - spacing;\n          // 检查顶边和上底边及右上角底边及右上边\n          const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\n          const sTop = topShow(row, col);\n          const sBottom = bottomShow(row - 1, col);\n          internal.sy = sy;\n          if (sTopRightCorner) internal.sy = sy - spacing;\n          if ((sTop || sBottom) && firstRow) internal.sy = sy + spacing;\n          // 检查底边和下顶边右下角顶边及右下边\n          const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\n          const eBottom = bottomShow(row, col);\n          const eTop = topShow(row + 1, col);\n          internal.ey = ey;\n          if (eBottomRightCorner) internal.ey = ey + spacing;\n          if ((eBottom || eTop) && lastRow) internal.ey = ey - spacing;\n          break;\n        }\n        case 'bottom': {\n          internal.sy = sy - spacing;\n          internal.ey = ey - spacing;\n          // 检查左边和左右边及左下角右边及下左边\n          const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\n          const sLeft = leftShow(row, col);\n          const sRight = rightShow(row, col - 1);\n          internal.sx = sx;\n          if (sBottomLeftCorner) internal.sx = sx - spacing;\n          if ((sLeft || sRight) && firstCol) internal.sx = sx + spacing;\n          // 检查右边和右左边及右下角左边及下右边\n          const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\n          const eRight = rightShow(row, col);\n          const eLeft = leftShow(row, col + 1);\n          internal.ex = ex;\n          if (eBottomRightCorner) internal.ex = ex + spacing;\n          if ((eRight || eLeft) && lastCol) internal.ex = ex - spacing;\n          break;\n        }\n        default: break;\n      }\n      return internal;\n    }\n    switch (pos) {\n      case 'left': {\n        internal.sx = sx + spacing;\n        internal.ex = ex + spacing;\n        // 检查顶边和上底边及左上角底边及左顶边\n        const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\n        const sTop = topShow(row, col);\n        const sBottom = bottomShow(row - 1, col);\n        internal.sy = sy;\n        if (sTopLeftCorner) internal.sy = sy - spacing;\n        if (sTop || sBottom) internal.sy = sy + spacing;\n        // 检查底边和下顶边及左下角顶边和左底边\n        const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\n        const eBottom = bottomShow(row, col);\n        const eTop = topShow(row + 1, col);\n        internal.ey = ey;\n        if (eBottomLeftCorner) internal.ey = ey + spacing;\n        if (eBottom || eTop) internal.ey = ey - spacing;\n        break;\n      }\n      case 'top': {\n        internal.sy = sy + spacing;\n        internal.ey = ey + spacing;\n        // 检查左边和左右边及左上角右边及上左边\n        const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\n        const sLeft = leftShow(row, col);\n        const sRight = rightShow(row, col - 1);\n        internal.sx = sx;\n        if (sTopLeftCorner) internal.sx = sx - spacing;\n        if (sLeft || sRight) internal.sx = sx + spacing;\n        // 检查右边和右左边及右上角左边及上右边\n        const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\n        const eRight = rightShow(row, col);\n        const eLeft = leftShow(row, col + 1);\n        internal.ex = ex;\n        if (eTopRightCorner) internal.ex = ex + spacing;\n        if (eRight || eLeft) internal.ex = ex - spacing;\n        break;\n      }\n      case 'right': {\n        internal.sx = sx - spacing;\n        internal.ex = ex - spacing;\n        // 检查顶边和上底边及右上角底边及右上边\n        const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\n        const sTop = topShow(row, col);\n        const sBottom = bottomShow(row - 1, col);\n        internal.sy = sy;\n        if (sTopRightCorner) internal.sy = sy - spacing;\n        if (sTop || sBottom) internal.sy = sy + spacing;\n        // 检查底边和下顶边右下角顶边及右下边\n        const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\n        const eBottom = bottomShow(row, col);\n        const eTop = topShow(row + 1, col);\n        internal.ey = ey;\n        if (eBottomRightCorner) internal.ey = ey + spacing;\n        if (eBottom || eTop) internal.ey = ey - spacing;\n        break;\n      }\n      case 'bottom': {\n        internal.sy = sy - spacing;\n        internal.ey = ey - spacing;\n        // 检查左边和左右边及左下角右边及下左边\n        const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\n        const sLeft = leftShow(row, col);\n        const sRight = rightShow(row, col - 1);\n        internal.sx = sx;\n        if (sBottomLeftCorner) internal.sx = sx - spacing;\n        if (sLeft || sRight) internal.sx = sx + spacing;\n        // 检查右边和右左边及右下角左边及下右边\n        const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\n        const eRight = rightShow(row, col);\n        const eLeft = leftShow(row, col + 1);\n        internal.ex = ex;\n        if (eBottomRightCorner) internal.ex = ex + spacing;\n        if (eRight || eLeft) internal.ex = ex - spacing;\n        break;\n      }\n      default: break;\n    }\n    return internal;\n  }\n\n  horizonLine(sx, sy, ex, ey, row, col, pos) {\n    const { draw } = this;\n    const {\n      widthType, color,\n    } = this;\n    draw.setLineColor(color);\n    draw.setLineWidthType(widthType);\n    draw.setLineDash([]);\n    const external = this.handleExternal(sx, sy, ex, ey, row, col, pos);\n    const internal = this.handleInternal(sx, sy, ex, ey, row, col, pos);\n    if (!SheetUtils.isEmptyObject(internal)) {\n      draw.horizonLine([internal.sx, internal.sy], [internal.ex, internal.ey]);\n    }\n    if (!SheetUtils.isEmptyObject(external)) {\n      draw.horizonLine([external.sx, external.sy], [external.ex, external.ey]);\n    }\n  }\n\n  verticalLine(sx, sy, ex, ey, row, col, pos) {\n    const { draw } = this;\n    const {\n      widthType, color,\n    } = this;\n    draw.setLineColor(color);\n    draw.setLineWidthType(widthType);\n    draw.setLineDash([]);\n    const external = this.handleExternal(sx, sy, ex, ey, row, col, pos);\n    const internal = this.handleInternal(sx, sy, ex, ey, row, col, pos);\n    if (!SheetUtils.isEmptyObject(internal)) {\n      draw.verticalLine([internal.sx, internal.sy], [internal.ex, internal.ey]);\n    }\n    if (!SheetUtils.isEmptyObject(external)) {\n      draw.verticalLine([external.sx, external.sy], [external.ex, external.ey]);\n    }\n  }\n\n  // eslint-disable-next-line no-unused-vars\n  tiltingLine(sx, sy, ex, ey, row, col, pos) {\n    // TODO ..\n    // ...\n  }\n\n}\nDoubleLine.spacing = XDraw.dpr() >= 2 ? 3 : 2;\n\nclass Line {\n\n  constructor(draw, attr = {}) {\n    this.widthType = XDraw.LINE_WIDTH_TYPE.low;\n    this.type = LINE_TYPE.SOLID_LINE;\n    this.solidLine = new SolidLine(draw, SheetUtils.copy({}, attr));\n    this.dottedLine = new DottedLine(draw, SheetUtils.copy({\n      dash: [5],\n    }, attr));\n    this.pointLine = new DottedLine(draw, SheetUtils.copy({\n      dash: [2, 2],\n    }, attr));\n    this.doubleLine = new DoubleLine(draw, SheetUtils.copy({}, attr));\n  }\n\n  setWidthType(widthType) {\n    if (widthType) {\n      if (this.type === LINE_TYPE.SOLID_LINE) {\n        this.solidLine.setWidthType(widthType);\n      }\n    }\n  }\n\n  setColor(color) {\n    if (color) {\n      this.solidLine.setColor(color);\n      this.dottedLine.setColor(color);\n      this.pointLine.setColor(color);\n      this.doubleLine.setColor(color);\n    }\n  }\n\n  setType(type) {\n    this.type = type;\n  }\n\n  horizonLine(sx, sy, ex, ey, row, col, pos) {\n    const {\n      type,\n      solidLine,\n      dottedLine,\n      pointLine,\n      doubleLine,\n    } = this;\n    switch (type) {\n      case LINE_TYPE.SOLID_LINE:\n        solidLine.horizonLine(sx, sy, ex, ey);\n        break;\n      case LINE_TYPE.DOTTED_LINE:\n        dottedLine.horizonLine(sx, sy, ex, ey);\n        break;\n      case LINE_TYPE.POINT_LINE:\n        pointLine.horizonLine(sx, sy, ex, ey);\n        break;\n      case LINE_TYPE.DOUBLE_LINE:\n        doubleLine.horizonLine(sx, sy, ex, ey, row, col, pos);\n        break;\n    }\n  }\n\n  verticalLine(sx, sy, ex, ey, row, col, pos) {\n    const {\n      type,\n      solidLine,\n      dottedLine,\n      pointLine,\n      doubleLine,\n    } = this;\n    switch (type) {\n      case LINE_TYPE.SOLID_LINE:\n        solidLine.verticalLine(sx, sy, ex, ey);\n        break;\n      case LINE_TYPE.DOTTED_LINE:\n        dottedLine.verticalLine(sx, sy, ex, ey);\n        break;\n      case LINE_TYPE.POINT_LINE:\n        pointLine.verticalLine(sx, sy, ex, ey);\n        break;\n      case LINE_TYPE.DOUBLE_LINE:\n        doubleLine.verticalLine(sx, sy, ex, ey, row, col, pos);\n        break;\n    }\n  }\n\n  tiltingLine(sx, sy, ex, ey, row, col, pos) {\n    const {\n      type,\n      solidLine,\n      dottedLine,\n      pointLine,\n      doubleLine,\n    } = this;\n    switch (type) {\n      case LINE_TYPE.SOLID_LINE:\n        solidLine.tiltingLine(sx, sy, ex, ey);\n        break;\n      case LINE_TYPE.DOTTED_LINE:\n        dottedLine.tiltingLine(sx, sy, ex, ey);\n        break;\n      case LINE_TYPE.POINT_LINE:\n        pointLine.tiltingLine(sx, sy, ex, ey);\n        break;\n      case LINE_TYPE.DOUBLE_LINE:\n        doubleLine.tiltingLine(sx, sy, ex, ey, row, col, pos);\n        break;\n    }\n  }\n\n}\n\nexport {\n  Line, LINE_TYPE, SolidLine,\n};\n","import { LINE_TYPE } from '../../../draw/Line';\nimport { SheetUtils } from '../../../utils/SheetUtils';\nimport { XDraw } from '../../../draw/XDraw';\n\nlet zIndexID = 0;\n\n/**\n * Border\n * @author jerry\n */\nclass Border {\n\n  static getZIndex() {\n    zIndexID += 1;\n    return zIndexID;\n  }\n\n  constructor({\n    widthType = XDraw.LINE_WIDTH_TYPE.low,\n    type = LINE_TYPE.SOLID_LINE,\n    width = -1,\n    color = 'rgb(0,0,0)',\n    zIndex = 0,\n    display = false,\n  } = {}) {\n    this.zIndex = zIndex;\n    this.display = display;\n    this.color = color;\n    this.type = type;\n    if (width === 1) {\n      this.widthType = XDraw.LINE_WIDTH_TYPE.low;\n    } else if (width === 2) {\n      this.widthType = XDraw.LINE_WIDTH_TYPE.medium;\n    } else if (width === 3) {\n      this.widthType = XDraw.LINE_WIDTH_TYPE.high;\n    } else {\n      this.widthType = widthType;\n    }\n    if (zIndex > zIndexID) {\n      zIndexID = zIndex;\n    }\n  }\n\n  priority(border) {\n    if (SheetUtils.isUnDef(border)) {\n      return -2;\n    }\n    const origin = this.zIndex;\n    const target = border.zIndex;\n    if (origin > target) {\n      return 1;\n    }\n    if (target > origin) {\n      return -1;\n    }\n    return 0;\n  }\n\n  setColor(value) {\n    this.zIndex = Border.getZIndex();\n    this.color = value;\n  }\n\n  setDisplay(value) {\n    this.zIndex = Border.getZIndex();\n    this.display = value;\n  }\n\n  setType(value) {\n    this.zIndex = Border.getZIndex();\n    this.type = value;\n  }\n\n  setZIndex(value) {\n    this.zIndex = value;\n  }\n\n  setWidthType(value) {\n    this.zIndex = Border.getZIndex();\n    this.widthType = value;\n  }\n\n  clone() {\n    return new Border({\n      widthType: this.widthType,\n      color: this.color,\n      zIndex: this.zIndex,\n      type: this.type,\n      display: this.display,\n    });\n  }\n\n  equal(target) {\n    const widthType = this.widthType === target.widthType;\n    const color = this.color === target.color;\n    const type = this.type === target.type;\n    return color && widthType && type;\n  }\n\n}\n\nexport { Border };\n","import { Border } from './Border';\nimport { LINE_TYPE } from '../../../draw/Line';\n\n/**\n * CellBorder\n * @author jerry\n */\nclass CellBorder {\n\n  /**\n   * CellBorder\n   * @param time\n   * @param left\n   * @param top\n   * @param right\n   * @param bottom\n   */\n  constructor({\n    left = {},\n    bottom = {},\n    top = {},\n    right = {},\n  } = {}) {\n    this.left = new Border(left);\n    this.bottom = new Border(bottom);\n    this.top = new Border(top);\n    this.right = new Border(right);\n  }\n\n  hasDouble() {\n    const { top, left, right, bottom } = this;\n    if (top.type === LINE_TYPE.DOUBLE_LINE) {\n      return true;\n    }\n    if (left.type === LINE_TYPE.DOUBLE_LINE) {\n      return true;\n    }\n    if (right.type === LINE_TYPE.DOUBLE_LINE) {\n      return true;\n    }\n    return bottom.type === LINE_TYPE.DOUBLE_LINE;\n  }\n\n  isDisplay() {\n    return this.left.display || this.top.display\n      || this.bottom.display || this.right.display;\n  }\n\n  setAllDisplay(display) {\n    this.setBDisplay(display);\n    this.setLDisplay(display);\n    this.setTDisplay(display);\n    this.setRDisplay(display);\n  }\n\n  setLDisplay(display) {\n    this.left.setDisplay(display);\n  }\n\n  setTDisplay(display) {\n    this.top.setDisplay(display);\n  }\n\n  setRDisplay(display) {\n    this.right.setDisplay(display);\n  }\n\n  setBDisplay(display) {\n    this.bottom.setDisplay(display);\n  }\n\n  setAllColor(color) {\n    this.setBColor(color);\n    this.setLColor(color);\n    this.setTColor(color);\n    this.setRColor(color);\n  }\n\n  setLColor(color) {\n    this.left.setColor(color);\n  }\n\n  setTColor(color) {\n    this.top.setColor(color);\n  }\n\n  setRColor(color) {\n    this.right.setColor(color);\n  }\n\n  setBColor(color) {\n    this.bottom.setColor(color);\n  }\n\n  setAllWidthType(widthType) {\n    this.setBWidthType(widthType);\n    this.setLWidthType(widthType);\n    this.setTWidthType(widthType);\n    this.setRWidthType(widthType);\n  }\n\n  setLWidthType(widthType) {\n    this.left.setWidthType(widthType);\n  }\n\n  setTWidthType(widthType) {\n    this.top.setWidthType(widthType);\n  }\n\n  setRWidthType(widthType) {\n    this.right.setWidthType(widthType);\n  }\n\n  setBWidthType(widthType) {\n    this.bottom.setWidthType(widthType);\n  }\n\n  setAllType(type) {\n    this.setBType(type);\n    this.setLType(type);\n    this.setTType(type);\n    this.setRType(type);\n  }\n\n  setLType(type) {\n    this.left.setType(type);\n  }\n\n  setTType(type) {\n    this.top.setType(type);\n  }\n\n  setRType(type) {\n    this.right.setType(type);\n  }\n\n  setBType(type) {\n    this.bottom.setType(type);\n  }\n\n  updateMaxIndex() {\n    const zIndex = Border.getZIndex();\n    this.left.setZIndex(zIndex);\n    this.bottom.setZIndex(zIndex);\n    this.top.setZIndex(zIndex);\n    this.right.setZIndex(zIndex);\n  }\n\n  clone() {\n    const { left, top, right, bottom } = this;\n    return new CellBorder({\n      left: left.clone(),\n      top: top.clone(),\n      right: right.clone(),\n      bottom: bottom.clone(),\n    });\n  }\n\n}\n\nCellBorder.EMPTY = new CellBorder();\n\nCellBorder.getInstance = (config) => {\n  if (config) {\n    return new CellBorder(config);\n  }\n  return CellBorder.EMPTY;\n};\n\nexport { CellBorder };\n","class Rect {\n\n  /**\n   * Rect\n   * @param x\n   * @param y\n   * @param width\n   * @param height\n   */\n  constructor({\n    x, y, width, height,\n  }) {\n    this.x = x;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n  }\n\n  /**\n   * 判断两个矩形是否不发生重合\n   * @param {Rect} other 区域\n   * @returns {boolean}\n   */\n  disjoint(other) {\n    return this.x > other.x + other.width\n      || this.y > this.y + other.height\n      || other.x > this.x + this.width\n      || other.y > this.y + this.height;\n  }\n\n  /**\n   * 扩展尺寸\n   * @param size\n   * @returns {Rect}\n   */\n  expandSize(size) {\n    this.width += size;\n    this.height += size;\n    return this;\n  }\n\n  /**\n   * 是否包含点\n   * @param x\n   * @param y\n   * @returns {boolean}\n   */\n  includePoint(x, y) {\n    return x >= this.x && x <= this.x + this.width\n      && y >= this.y && y <= this.y + this.height;\n  }\n\n  /**\n   * 是否包含矩形\n   * @param rect\n   * @returns {boolean|boolean}\n   */\n  includeRect(rect) {\n    const { x, y, width, height } = rect;\n    return this.x <= x && this.x + this.width >= x + width\n      && this.y <= y && this.y + this.height >= y + height;\n  }\n\n  /**\n   * 计算当前矩形在指定矩形内部的位置\n   * @param rect\n   * @returns {Rect}\n   */\n  inRectPosition(rect) {\n    return new Rect({\n      x: this.x - rect.x,\n      y: this.y - rect.y,\n      width: this.width,\n      height: this.height,\n    });\n  }\n\n  /**\n   * 复制\n   * @returns {Rect}\n   */\n  clone() {\n    const { x, y, width, height } = this;\n    return new Rect({ x, y, width, height });\n  }\n\n}\n\nexport { Rect };\n","\n/**\n * XIconOffset\n */\nclass XIconOffset {\n\n  /**\n   * XIconOffset\n   * @param x\n   * @param y\n   */\n  constructor({ x = 0, y = 0 } = {}) {\n    this.x = x;\n    this.y = y;\n  }\n\n}\n\nexport {\n  XIconOffset,\n};\n","class Crop {\n\n  constructor({\n    rect, draw, offset = 0,\n  }) {\n    this.rect = rect;\n    this.draw = draw;\n    this.offset = offset;\n  }\n\n  open() {\n    const {\n      rect, draw, offset,\n    } = this;\n    const {\n      x, y, width, height,\n    } = rect;\n    draw.save()\n      .rect(x, y, width + offset, height + offset)\n      .clip()\n      .beginPath();\n    return this;\n  }\n\n  close() {\n    const { draw } = this;\n    draw.restore();\n    return this;\n  }\n\n}\n\nexport { Crop };\n","/* global Image console */\nimport { SheetUtils } from '../../../utils/SheetUtils';\nimport { XDraw } from '../../../draw/XDraw';\nimport { Rect } from '../../../draw/Rect';\nimport { XIconOffset } from './XIconOffset';\nimport { Crop } from '../../../draw/Crop';\n\n/**\n * XIcon\n * @author jerry\n * @date 2020/10/20\n */\nclass XIcon {\n\n  /**\n   * 多图标初始化\n   * @param icons\n   * @returns {[]}\n   */\n  static newInstances(icons = []) {\n    const instances = [];\n    for (let i = 0; i < icons.length; i += 1) {\n      const icon = icons[i];\n      instances.push(new XIcon(icon));\n    }\n    return instances;\n  }\n\n  /**\n   * XIcon\n   * @param vertical\n   * @param horizontal\n   * @param type\n   * @param image\n   * @param focus\n   * @param height\n   * @param width\n   * @param color\n   * @param offset\n   * @param onDraw\n   * @param onLeave\n   * @param onMove\n   * @param onDown\n   * @param onEnter\n   */\n  constructor({\n    vertical = XIcon.ICON_VERTICAL.CENTER,\n    horizontal = XIcon.ICON_HORIZONTAL.RIGHT,\n    type = XIcon.ICON_TYPE.image,\n    image = SheetUtils.Nul,\n    iconFocus = null,\n    height = 16,\n    width = 16,\n    color = 'rgb(255,255,255)',\n    offset = { x: 0, y: 0 },\n    onDraw = () => {},\n    onLeave = () => {},\n    onMove = () => {},\n    onDown = () => {},\n    onEnter = () => {},\n  }) {\n    this.vertical = vertical;\n    this.horizontal = horizontal;\n    this.width = width;\n    this.height = height;\n    this.type = type;\n    this.image = image;\n    this.color = color;\n    this.iconFocus = iconFocus;\n    this.offset = new XIconOffset(offset);\n    this.onLeave = onLeave;\n    this.onMove = onMove;\n    this.onDraw = onDraw;\n    this.onDown = onDown;\n    this.onEnter = onEnter;\n    this.rect = null;\n  }\n\n  /**\n   * 计算绘制坐标\n   * @param rect\n   * @returns {{x: number, y: number}}\n   */\n  position(rect) {\n    // 图标信息\n    const iconHorizontal = this.horizontal;\n    const iconVertical = this.vertical;\n    const iconOffsetX = XDraw.stylePx(this.offset.x);\n    const iconOffsetY = XDraw.stylePx(this.offset.y);\n    const iconWidth = XDraw.stylePx(this.width);\n    const iconHeight = XDraw.stylePx(this.height);\n    // 矩形位置\n    const rectX = rect.x;\n    const rectY = rect.y;\n    const rectWidth = rect.width;\n    const rectHeight = rect.height;\n    // 计算位置\n    let px = 0;\n    let py = 0;\n    switch (iconHorizontal) {\n      case XIcon.ICON_HORIZONTAL.CENTER:\n        px = (rectX + rectWidth / 2) - (iconWidth / 2);\n        break;\n      case XIcon.ICON_HORIZONTAL.LEFT:\n        px = rectX;\n        break;\n      case XIcon.ICON_HORIZONTAL.RIGHT:\n        px = rectX + rectWidth - iconWidth;\n        break;\n    }\n    switch (iconVertical) {\n      case XIcon.ICON_VERTICAL.CENTER:\n        py = (rectY + rectHeight / 2) - (iconHeight / 2);\n        break;\n      case XIcon.ICON_VERTICAL.TOP:\n        py = rectY;\n        break;\n      case XIcon.ICON_VERTICAL.BOTTOM:\n        py = rectY + rectHeight - iconHeight;\n        break;\n    }\n    px += iconOffsetX;\n    py += iconOffsetY;\n    return new Rect({\n      x: px, y: py, width: iconWidth, height: iconHeight,\n    });\n  }\n\n  /**\n   * 加载图片信息\n   * @param async\n   * @param sync\n   */\n  loadImage({\n    load, sync,\n  }) {\n    const { image, type } = this;\n    switch (type) {\n      case XIcon.ICON_TYPE.image:\n        if (image instanceof Image) {\n          sync(image);\n        } else {\n          const loadImg = new Image();\n          loadImg.src = image;\n          if (loadImg.complete) {\n            this.image = loadImg;\n            sync(this.image);\n          } else {\n            loadImg.onload = () => {\n              this.image = loadImg;\n              load(loadImg);\n            };\n            loadImg.onerror = () => {\n              // eslint-disable-next-line no-console\n              console.error(`图片加载失败${image}`);\n            };\n          }\n        }\n        break;\n      case XIcon.ICON_TYPE.draw:\n        sync();\n        break;\n    }\n  }\n\n  /**\n   * 绘制小图标\n   * @param rect\n   * @param draw\n   */\n  drawIcon({\n    rect, draw,\n  }) {\n    const { type } = this;\n    this.rect = rect;\n    switch (type) {\n      case XIcon.ICON_TYPE.image:\n        this.drawImage({\n          rect, draw,\n        });\n        break;\n      case XIcon.ICON_TYPE.draw:\n        this.drawCustom({\n          rect, draw,\n        });\n        break;\n    }\n  }\n\n  /**\n   * 自定义绘制\n   * @param rect\n   * @param icon\n   * @param draw\n   */\n  drawCustom({\n    rect, draw,\n  }) {\n    this.onDraw({\n      rect, draw,\n    });\n  }\n\n  /**\n   * 绘制图片\n   * @param rect\n   * @param icon\n   * @param draw\n   */\n  drawImage({\n    rect, draw,\n  }) {\n    const image = this.image;\n    const color = this.color;\n    const positionRect = this.position(rect);\n    const {\n      x, y, width, height,\n    } = positionRect;\n    const include = rect.includeRect(positionRect);\n    const crop = new Crop({\n      rect, draw,\n    });\n    if (include === false) {\n      crop.open();\n    }\n    if (color) {\n      draw.attr({ fillStyle: color });\n      draw.fillRect(x, y, width, height);\n    }\n    draw.drawImage(image, 0, 0, image.width, image.height, x, y, width, height);\n    if (include === false) {\n      crop.close();\n    }\n  }\n\n  /**\n   * 事件处理\n   * @param type\n   * @param x\n   * @param y\n   * @param native\n   */\n  eventHandle({\n    type, x, y, native,\n  }) {\n    const { rect, iconFocus } = this;\n    if (rect) {\n      const position = this.position(rect);\n      const location = position.inRectPosition(rect);\n      const { activate } = iconFocus;\n      switch (type) {\n        case XIcon.ICON_EVENT_TYPE.MOUSE_DOWN:\n          if (location.includePoint(x, y)) {\n            iconFocus.setActivate(this);\n            this.onDown({\n              native, position,\n            });\n          }\n          break;\n        case XIcon.ICON_EVENT_TYPE.MOUSE_MOVE:\n          if (location.includePoint(x, y)) {\n            if (activate !== this) {\n              this.onEnter({\n                native, position,\n              });\n            }\n            iconFocus.setActivate(this);\n            this.onMove({\n              native, position,\n            });\n          } else if (activate) {\n            iconFocus.setActivate(null);\n            this.onLeave({\n              native, position,\n            });\n          }\n          break;\n      }\n    }\n  }\n\n  /**\n   * 绘制回调\n   * @param callback\n   */\n  setOnDraw(callback) {\n    this.onDraw = callback;\n  }\n\n  /**\n   * 按下回调\n   * @param callback\n   */\n  setOnDown(callback) {\n    this.onDown = callback;\n  }\n\n  /**\n   * 移动回调\n   * @param callback\n   */\n  setOnMove(callback) {\n    this.onMove = callback;\n  }\n\n  /**\n   * 进入回调\n   * @param callback\n   */\n  setOnEnter(callback) {\n    this.onEnter = callback;\n  }\n\n  /**\n   * 离开回调\n   * @param callback\n   */\n  setOnLeave(callback) {\n    this.onLeave = callback;\n  }\n\n  /**\n   * 设置焦点元素\n   * @param iconFocus\n   */\n  setFocus(iconFocus) {\n    this.iconFocus = iconFocus;\n  }\n\n}\n\nXIcon.ICON_HORIZONTAL = {\n  LEFT: 0,\n  RIGHT: 1,\n  CENTER: 2,\n};\nXIcon.ICON_VERTICAL = {\n  TOP: 3,\n  BOTTOM: 4,\n  CENTER: 5,\n};\nXIcon.ICON_TYPE = {\n  image: 1,\n  custom: 2,\n};\nXIcon.ICON_EVENT_TYPE = {\n  MOUSE_DOWN: 1,\n  MOUSE_MOVE: 2,\n};\n\nXIcon.EMPTY = [];\nXIcon.getInstance = (config) => {\n  if (config) {\n    return XIcon.newInstances(config);\n  }\n  return XIcon.EMPTY;\n};\n\nexport { XIcon };\n","class DateUtils {\n\n  static dateFormat(fmt, date) {\n    if (!(date instanceof Date)) {\n      return date;\n    }\n    const o = {\n      'M+': date.getMonth() + 1,\n      'd+': date.getDate(),\n      'h+': date.getHours(),\n      'm+': date.getMinutes(),\n      's+': date.getSeconds(),\n      'q+': Math.floor((date.getMonth() + 3) / 3),\n      S: date.getMilliseconds(),\n    };\n    const reYear = /(y+)/;\n    const resultYear = reYear.exec(fmt);\n    if (resultYear) {\n      const yearFormatPart = resultYear[0];\n      const yearVal = (date.getFullYear().toString()).substr(4 - yearFormatPart.length);\n      fmt = fmt.replace(yearFormatPart, yearVal);\n    }\n    // eslint-disable-next-line guard-for-in,no-restricted-syntax\n    for (const k in o) {\n      const re = new RegExp(`(${k})`);\n      const res = re.exec(fmt);\n      if (res) {\n        const Val = o[k].toString();\n        const formatPart = res[0];\n        const replaceVal = (formatPart.length === 1) ? (Val) : ((`00${Val}`).substr(Val.length));\n        fmt = fmt.replace(formatPart, replaceVal);\n      }\n    }\n    return fmt;\n  }\n\n  static parse(text) {\n    let result = text;\n    if (result instanceof Date) {\n      return result;\n    }\n\n    result = DateUtils.parserToDate(text, 'yyyy/MM/dd');\n    if (result) {\n      return result;\n    }\n    result = DateUtils.parserToDate(text, 'MM/dd');\n    if (result) {\n      return result;\n    }\n    result = DateUtils.parserToDate(text, 'yyyy/MM/dd hh:mm:ss');\n    if (result) {\n      return result;\n    }\n\n    result = DateUtils.parserToDate(text, 'yyyy-MM-dd');\n    if (result) {\n      return result;\n    }\n    result = DateUtils.parserToDate(text, 'MM-dd');\n    if (result) {\n      return result;\n    }\n    result = DateUtils.parserToDate(text, 'yyyy-MM-dd hh:mm:ss');\n    if (result) {\n      return result;\n    }\n\n    result = DateUtils.parserToDate(text, 'hh:mm:ss');\n    if (result) {\n      return result;\n    }\n\n    result = DateUtils.parserToDate(text, 'yyyy年MM月');\n    if (result) {\n      return result;\n    }\n    result = DateUtils.parserToDate(text, 'MM月dd日');\n    if (result) {\n      return result;\n    }\n    result = DateUtils.parserToDate(text, 'yyyy年MM月dd日 hh:mm:ss');\n    if (result) {\n      return result;\n    }\n\n    return text;\n  }\n\n  static parserToDate(dateText, format) {\n    if (!dateText) {\n      return null;\n    }\n    const defaultVal = new Date('1970/01/01 00:00:00');\n    const o = [{\n      reg: 'y+',\n    }, {\n      reg: 'M+',\n    }, {\n      reg: 'd+',\n    }, {\n      reg: 'h+',\n    }, {\n      reg: 'm+',\n    }, {\n      reg: 's+',\n    }, {\n      reg: 'S',\n    }];\n    let year = defaultVal.getFullYear();\n    let month = defaultVal.getMonth() + 1;\n    let day = defaultVal.getDate();\n    let hours = defaultVal.getHours();\n    let minutes = defaultVal.getMinutes();\n    let seconds = defaultVal.getSeconds();\n    let milliseconds = defaultVal.getMilliseconds();\n    let index = 1;\n    for (let j = 0; j < format.length; j += 1) {\n      const oneChar = format[j];\n      for (let i = 0; i < o.length; i += 1) {\n        const onePart = o[i];\n        const onePartReg = onePart.reg;\n        if (onePartReg[0] === oneChar) {\n          if (!onePart.index) {\n            onePart.index = index;\n            index += 1;\n          }\n          break;\n        }\n      }\n    }\n    for (let i = 0; i < o.length; i += 1) {\n      const onePart = o[i];\n      const onePartReg = onePart.reg;\n      const re = new RegExp(`(${onePartReg})`);\n      const res = re.exec(format);\n      if (res) {\n        const formatPart = res[0];\n        const replaceVal = `([0-9]{1,${formatPart.length}})`;\n        // eslint-disable-next-line no-param-reassign\n        format = format.replace(formatPart, replaceVal);\n      }\n    }\n    const dataInfo = {};\n    const re = new RegExp(format);\n    const res = re.exec(dateText);\n    if (res) {\n      for (let i = 1; i < res.length; i += 1) {\n        dataInfo[i] = res[i];\n      }\n    } else {\n      return null;\n    }\n    if (o[0].index) {\n      const { index } = o[0];\n      year = dataInfo[index];\n    }\n    if (o[1].index) {\n      const { index } = o[1];\n      month = dataInfo[index];\n    }\n    if (o[2].index) {\n      const { index } = o[2];\n      day = dataInfo[index];\n    }\n    if (o[3].index) {\n      const { index } = o[3];\n      hours = dataInfo[index];\n    }\n    if (o[4].index) {\n      const { index } = o[4];\n      minutes = dataInfo[index];\n    }\n    if (o[5].index) {\n      const { index } = o[5];\n      seconds = dataInfo[index];\n    }\n    if (o[6].index) {\n      const { index } = o[6];\n      milliseconds = dataInfo[index];\n    }\n    return new Date(year, month - 1, day, hours, minutes, seconds, milliseconds);\n  }\n\n}\n\nexport { DateUtils };\n","import { SheetUtils } from '../../utils/SheetUtils';\nimport { DateUtils } from '../../utils/DateUtils';\n\nclass Format {\n\n  default(value) {\n    return this.text(value);\n  }\n\n  text(value) {\n    return value ? `${value}` : '';\n  }\n\n  // =============================数字==============================\n\n  number(value) {\n    return this.text(value);\n  }\n\n  fraction(value) {\n    if (SheetUtils.isFraction(value)) {\n      const left = value.split('/')[0];\n      const right = value.split('/')[1];\n      return this.text(SheetUtils.parseInt(left) / SheetUtils.parseInt(right));\n    }\n    return this.text(value);\n  }\n\n  eNotation(value) {\n    if (SheetUtils.isNumber(value)) {\n      const number = SheetUtils.parseFloat(value);\n      return number.toExponential(2);\n    }\n    return this.text(value);\n  }\n\n  decimal(value) {\n    if (SheetUtils.isNumber(value)) {\n      const indexOf = value.toString().indexOf('.');\n      if (indexOf !== -1) {\n        return value.toString().substring(0, indexOf + 3);\n      }\n      return `${value}.00`;\n    }\n    return this.text(value);\n  }\n\n  percentage(value) {\n    if (SheetUtils.isNumber(value)) {\n      return `${value}%`;\n    }\n    return this.text(value);\n  }\n\n  // =============================货币==============================\n\n  rmb(value) {\n    if (SheetUtils.isNumber(value)) {\n      return `￥${value}`;\n    }\n    return this.text(value);\n  }\n\n  hk(value) {\n    if (SheetUtils.isNumber(value)) {\n      return `HK${value}`;\n    }\n    return this.text(value);\n  }\n\n  dollar(value) {\n    if (SheetUtils.isNumber(value)) {\n      return `$${value}`;\n    }\n    return this.text(value);\n  }\n\n  // =============================日期==============================\n\n  time(value) {\n    const result = DateUtils.parse(value);\n    if (result) {\n      return DateUtils.dateFormat('hh:mm:ss', result);\n    }\n    return this.text(value);\n  }\n\n  date1(value) {\n    const result = DateUtils.parse(value);\n    if (result) {\n      return DateUtils.dateFormat('yyyy/MM/dd', result);\n    }\n    return this.text(value);\n  }\n\n  date2(value) {\n    const result = DateUtils.parse(value);\n    if (result) {\n      return DateUtils.dateFormat('MM月dd日', result);\n    }\n    return this.text(value);\n  }\n\n  date3(value) {\n    const result = DateUtils.parse(value);\n    if (result) {\n      return DateUtils.dateFormat('yyyy年MM月', result);\n    }\n    return this.text(value);\n  }\n\n  date4(value) {\n    const result = DateUtils.parse(value);\n    if (result) {\n      return DateUtils.dateFormat('yyyy年MM月dd日', result);\n    }\n    return this.text(value);\n  }\n\n  date5(value) {\n    const result = DateUtils.parse(value);\n    if (result) {\n      return DateUtils.dateFormat('yyyy/MM/dd hh:mm:ss', result);\n    }\n    return this.text(value);\n  }\n\n}\n\nconst format = new Format();\n\nexport default (type, value) => format[type](value);\n","import { SheetUtils } from '../../../utils/SheetUtils';\nimport { ColorArray } from '../../../module/colorpicker/colorarray/ColorArray';\n\nclass RichFont {\n\n  constructor({\n    text = '',\n    color = ColorArray.BLACK,\n    name = 'Arial',\n    size = 14,\n    bold = false,\n    italic = false,\n    strikethrough = false,\n    underline = false,\n    scaleAdapter,\n  } = {}) {\n    this.color = color;\n    this.text = `${text}`;\n    this.name = name;\n    this.size = size;\n    this.italic = italic;\n    this.bold = bold;\n    this.strikethrough = strikethrough;\n    this.underline = underline;\n    this.scaleAdapter = scaleAdapter;\n  }\n\n  clone() {\n    const { text, color, name, size } = this;\n    const { italic, bold, underline } = this;\n    const { strikethrough, scaleAdapter } = this;\n    return new RichFont({\n      text, color, name, size, italic, bold, underline, strikethrough, scaleAdapter,\n    });\n  }\n\n  reset() {\n    this.color = ColorArray.BLACK;\n    this.name = 'Arial';\n    this.size = 14;\n    this.bold = false;\n    this.italic = false;\n    this.strikethrough = false;\n    this.underline = false;\n  }\n\n  plain(option = v => v) {\n    return option(this.clone());\n  }\n\n  like(other) {\n    let ignore = ['scaleAdapter'];\n    let keys1 = Object.keys(this);\n    let keys2 = Object.keys(other);\n    for (let key of keys2) {\n      if (ignore.includes(key)) {\n        continue;\n      }\n      if (!keys1.includes(key)) {\n        return false;\n      }\n    }\n    for (let key of keys2) {\n      if (ignore.includes(key)) {\n        continue;\n      }\n      let src = this[key];\n      let val = other[key];\n      switch (key) {\n        case 'color': {\n          src = SheetUtils.clearBlank(src);\n          val = SheetUtils.clearBlank(val);\n          break;\n        }\n      }\n      if (src !== val) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  equals(other) {\n    let ignore = ['scaleAdapter'];\n    let keys1 = Object.keys(this);\n    let keys2 = Object.keys(other);\n    for (let key of keys1) {\n      if (ignore.includes(key)) {\n        continue;\n      }\n      if (!keys2.includes(key)) {\n        return false;\n      }\n    }\n    for (let key of keys1) {\n      if (ignore.includes(key)) {\n        continue;\n      }\n      let src = this[key];\n      let val = other[key];\n      switch (key) {\n        case 'color': {\n          src = SheetUtils.clearBlank(src);\n          val = SheetUtils.clearBlank(val);\n          break;\n        }\n      }\n      if (src !== val) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n}\n\nexport {\n  RichFont,\n};\n","import { RichFont } from './RichFont';\nimport { SheetUtils } from '../../../utils/SheetUtils';\n\nclass RichFonts {\n\n  constructor({\n    rich = [],\n  } = {}) {\n    this.rich = rich.map(font => new RichFont(font));\n  }\n\n  setRich(rich = []) {\n    this.rich = rich;\n  }\n\n  each(cb = () => {}) {\n    this.rich.forEach((font) => {\n      cb(font);\n    });\n  }\n\n  reset() {\n    this.each((i) => {\n      i.reset();\n    });\n  }\n\n  getRich() {\n    return this.rich;\n  }\n\n  clone() {\n    const rich = [];\n    this.rich.forEach((font) => {\n      rich.push(font.clone());\n    });\n    return new RichFonts({\n      rich,\n    });\n  }\n\n  hasLength() {\n    return this.rich.length > 0;\n  }\n\n  plain(option) {\n    const result = [];\n    this.rich.forEach((font) => {\n      result.push(font.plain(option));\n    });\n    return result;\n  }\n\n  like(other) {\n    if (SheetUtils.isUnDef(other)) {\n      return false;\n    }\n    if (other.rich.length !== this.rich.length) {\n      return false;\n    }\n    for (let i = 0; i < this.rich.length; i++) {\n      let item1 = this.rich[i];\n      let item2 = other.rich[i];\n      if (!item1.like(item2)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  toString() {\n    let text = [];\n    this.each(i => text.push(i.text));\n    return text.join('');\n  }\n\n  equals(other) {\n    if (SheetUtils.isUnDef(other)) {\n      return false;\n    }\n    if (other.rich.length !== this.rich.length) {\n      return false;\n    }\n    for (let i = 0; i < this.rich.length; i++) {\n      let item1 = this.rich[i];\n      let item2 = other.rich[i];\n      if (!item1.equals(item2)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n}\n\nRichFonts.EMPTY = new RichFonts();\n\nRichFonts.getInstance = (config) => {\n  if (config) {\n    return new RichFonts(config);\n  }\n  return RichFonts.EMPTY;\n};\n\nexport {\n  RichFonts,\n};\n","/**\n * 运行函数注册\n * @type {{}}\n */\nclass EvalFunctions {\n\n  /**\n   * EvalFunctions\n   */\n  constructor() {\n    this.functions = {};\n  }\n\n  /**\n   * 删除函数\n   * @param name\n   */\n  remove(name) {\n    delete this.functions[name];\n  }\n\n  /**\n   * 获取函数\n   * @param name\n   * @returns {*}\n   */\n  getFunction(name) {\n    return this.functions[name.toLocaleString()];\n  }\n\n  /**\n   * 注册函数\n   * @param name\n   * @param func\n   */\n  register(name, func) {\n    this.functions[name.toLocaleString()] = func;\n  }\n}\n\n/**\n * 函数注册\n * @type {EvalFunctions}\n */\nconst Functions = new EvalFunctions();\n\n/**\n * 指令序列\n */\nclass Assembly {\n\n  /**\n   * Assembly\n   */\n  constructor() {\n    this.assembly = '';\n  }\n\n  /**\n   * 获取指令详情\n   * @returns {string}\n   */\n  getInstruct() {\n    let { assembly } = this;\n    let flag = '\\r\\n';\n    while (assembly.endsWith(flag)) {\n      let { length } = assembly;\n      assembly = assembly.substring(0, length - flag.length);\n    }\n    return assembly;\n  }\n\n  /**\n   * 写入操作数\n   * @param value\n   */\n  writeOperand(value) {\n    this.assembly += `OPush ${value}\\r\\n`;\n  }\n\n  /**\n   * 写入运算符\n   * @param op\n   */\n  writeOperator(op) {\n    this.assembly += `${op}\\r\\n`;\n  }\n\n  /**\n   * 写入操作数\n   * @param value\n   */\n  writeString(value) {\n    this.assembly += `SPush ${value}\\r\\n`;\n  }\n\n  /**\n   * 写入操作数\n   * @param value\n   */\n  writeNumber(value) {\n    this.assembly += `NPush ${value}\\r\\n`;\n  }\n}\n\n/**\n * 词法分析\n */\nclass Tokenizer {\n\n  /**\n   * Tokenizer\n   * @param syntaxCheck\n   */\n  constructor({\n    syntaxCheck = true,\n  } = {}) {\n    this.syntaxCheck = syntaxCheck;\n  }\n\n  /**\n   * 词法分析\n   * @param input\n   * @returns {*[]}\n   */\n  lexical(input) {\n    let OPERATOR = /^(\\+|-|\\*|\\/|%|>|<|,|\\^|=|&|!|:|>=|<=|<>)$/;\n    let NUMBERS = /[0-9.]/;\n    let SPACE = /\\s/;\n    let LETTERS = /[a-z0-9_$]/i;\n    // 文本字符长度\n    let { length } = input;\n    // 函数调用记录\n    let bracketsStack = [];\n    // 当前的字符索引\n    let current = 0;\n    // 处理的字符数组\n    let tokens = [];\n    // 循环处理所有字符\n    while (current < length) {\n      // 当前处理的字符\n      let char = input[current];\n      // 跳过连续空格\n      if (SPACE.test(char)) {\n        const next = input[current + 1];\n        if (SPACE.test(next)) {\n          current++;\n          continue;\n        }\n      }\n      // 记录交叉区域运算符\n      if (SPACE.test(char)) {\n        const last = input[current - 1];\n        const next = input[current + 1];\n        if (LETTERS.test(last) && LETTERS.test(next)) {\n          tokens.push({\n            type: 'operator',\n            value: char,\n          });\n        }\n        current++;\n        continue;\n      }\n      // 记录括号\n      if (char === '(') {\n        tokens.push({\n          type: 'brackets',\n          value: '(',\n        });\n        bracketsStack.push({\n          type: 'brackets',\n          value: '(',\n        });\n        current++;\n        continue;\n      }\n      if (char === ')') {\n        const brackets = bracketsStack.pop();\n        if (brackets && brackets.type === 'function') {\n          tokens.push({\n            type: 'function',\n            value: ')',\n          });\n        } else {\n          tokens.push({\n            type: 'brackets',\n            value: ')',\n          });\n        }\n        current++;\n        continue;\n      }\n      // 记录数组\n      if (char === '{') {\n        tokens.push({\n          type: 'array',\n          value: 'array',\n        });\n        tokens.push({\n          type: 'array',\n          value: '{',\n        });\n        current++;\n        continue;\n      }\n      if (char === '}') {\n        tokens.push({\n          type: 'array',\n          value: '}',\n        });\n        current++;\n        continue;\n      }\n      // 记录字符串\n      if (char === '\"') {\n        let result = '';\n        current++;\n        char = input[current];\n        while (char !== '\"') {\n          if (current < length) {\n            result += char;\n            current++;\n            char = input[current];\n          } else {\n            break;\n          }\n        }\n        current++;\n        char = input[current];\n        tokens.push({\n          type: 'string',\n          value: result,\n        });\n        continue;\n      }\n      if (char === '\\'') {\n        let result = '';\n        current++;\n        char = input[current];\n        while (char !== '\\'') {\n          if (current < length) {\n            result += char;\n            current++;\n            char = input[current];\n          } else {\n            break;\n          }\n        }\n        current++;\n        char = input[current];\n        tokens.push({\n          type: 'string',\n          value: result,\n        });\n        continue;\n      }\n      // 记录运算符\n      if (OPERATOR.test(char)) {\n        let next = input[current + 1];\n        let result = `${char}${next}`;\n        if (OPERATOR.test(result)) {\n          tokens.push({\n            type: 'operator',\n            value: result,\n          });\n          current++;\n        } else {\n          tokens.push({\n            type: 'operator',\n            value: char,\n          });\n        }\n        current++;\n        continue;\n      }\n      // 记录数字值\n      if (NUMBERS.test(char)) {\n        let result = '';\n        while (NUMBERS.test(char)) {\n          if (current < length) {\n            result += char;\n            current++;\n            char = input[current];\n          } else {\n            break;\n          }\n        }\n        tokens.push({\n          type: 'number',\n          value: result,\n        });\n        continue;\n      }\n      // 记录函数名称, 参数名称, 操作数名称\n      if (LETTERS.test(char)) {\n        let result = '';\n        while (LETTERS.test(char)) {\n          if (current < length) {\n            result += char;\n            current++;\n            char = input[current];\n          } else {\n            break;\n          }\n        }\n        // 是否为函数名称\n        if (char === '(') {\n          tokens.push({\n            type: 'function',\n            value: result,\n          });\n          tokens.push({\n            type: 'function',\n            value: '(',\n          });\n          bracketsStack.push({\n            type: 'function',\n            value: '(',\n          });\n          current++;\n        } else {\n          tokens.push({\n            type: 'operand',\n            value: result,\n          });\n        }\n        continue;\n      }\n      // 无法识别的token\n      throw new TypeError(`无法识别的token ${char} `);\n    }\n    // 返回处理结果\n    if (this.syntaxCheck) {\n      return this.syntax(tokens);\n    }\n    return tokens;\n  }\n\n  /**\n   * 语法分析\n   * @param tokens\n   */\n  syntax(tokens) {\n    // 单引号对校验\n    let sQuotesStack = [];\n    // 双引号对校验\n    let dQuotesStack = [];\n    // 函数闭合标签校验\n    let callStack = [];\n    // 数组闭合标签校验\n    let arrayStack = [];\n    // 括号闭合标签校验\n    let bracketsStack = [];\n    // 当前的字符索引\n    let current = 0;\n    // tokens长度\n    let { length } = tokens;\n    // 忽略的数组token\n    let ignoreArray = (token) => {\n      if (token.type === 'array') {\n        return token.value === 'array';\n      }\n      return false;\n    };\n    // 忽略的函数token\n    let ignoreFunc = (token) => {\n      if (token.type === 'function') {\n        return token.value !== '(' && token.value !== ')';\n      }\n      return false;\n    };\n    // 跳过忽略的元素\n    let skipIgnoreToken = (dir, index) => {\n      if (dir === 'last') {\n        while (index >= 0) {\n          let token = tokens[index];\n          if (ignoreFunc(token)) {\n            index--;\n            continue;\n          }\n          if (ignoreArray(token)) {\n            index--;\n            continue;\n          }\n          return token;\n        }\n      }\n      if (dir === 'next') {\n        while (index < length) {\n          let token = tokens[index];\n          if (ignoreFunc(token)) {\n            index++;\n            continue;\n          }\n          if (ignoreArray(token)) {\n            index++;\n            continue;\n          }\n          return token;\n        }\n      }\n      return null;\n    };\n    // 检查数组\n    let checkArray = (dir, target) => {\n      let token = tokens[current];\n      let local = dir === 'last' ? '前面' : '后面';\n      if (token.value === '{') {\n        if (dir === 'last') {\n          switch (target.type) {\n            case 'array': {\n              if (target.value === '{') {\n                return;\n              }\n              break;\n            }\n            case 'function': {\n              if (target.value === '(') {\n                return;\n              }\n              break;\n            }\n            case 'brackets': {\n              if (target.value === '(') {\n                return;\n              }\n              break;\n            }\n            case 'operator': {\n              if (target.value === ',') {\n                return;\n              }\n              return;\n            }\n          }\n        }\n        if (dir === 'next') {\n          switch (target.type) {\n            case 'string':\n            case 'array':\n            case 'number':\n            case 'operand': {\n              return;\n            }\n            case 'function': {\n              if (target.value === '(') {\n                return;\n              }\n              break;\n            }\n            case 'brackets': {\n              if (target.value === '(') {\n                return;\n              }\n              break;\n            }\n          }\n        }\n      }\n      if (token.value === '}') {\n        if (dir === 'last') {\n          switch (target.type) {\n            case 'number':\n            case 'string':\n            case 'array':\n            case 'operand': {\n              return;\n            }\n            case 'function': {\n              if (target.value === ')') {\n                return;\n              }\n              break;\n            }\n            case 'brackets': {\n              if (target.value === ')') {\n                return;\n              }\n              break;\n            }\n          }\n        }\n        if (dir === 'next') {\n          switch (target.type) {\n            case 'array': {\n              if (target.value === '}') {\n                return;\n              }\n              break;\n            }\n            case 'function': {\n              if (target.value === ')') {\n                return;\n              }\n              break;\n            }\n            case 'brackets': {\n              if (target.value === ')') {\n                return;\n              }\n              break;\n            }\n            case 'operator': {\n              if (target.value === ',') {\n                return;\n              }\n              return;\n            }\n          }\n        }\n      }\n      throw TypeError(`错误表达式 ${token.value} ${local} ${target.value}`);\n    };\n    // 检查数字和字符\n    let checkValue = (dir, target) => {\n      let token = tokens[current];\n      let local = dir === 'last' ? '前面' : '后面';\n      switch (target.type) {\n        case 'array': {\n          if (dir === 'last') {\n            if (target.value === '{') {\n              return;\n            }\n          }\n          if (dir === 'next') {\n            if (target.value === '}') {\n              return;\n            }\n          }\n          break;\n        }\n        case 'brackets': {\n          if (dir === 'last') {\n            if (target.value === '(') {\n              return;\n            }\n          }\n          if (dir === 'next') {\n            if (target.value === ')') {\n              return;\n            }\n          }\n          break;\n        }\n        case 'function': {\n          if (dir === 'last') {\n            if (target.value === '(') {\n              return;\n            }\n          }\n          if (dir === 'next') {\n            if (target.value === ')') {\n              return;\n            }\n          }\n          break;\n        }\n        case 'operator': {\n          return;\n        }\n      }\n      throw TypeError(`错误表达式 ${token.value} ${local} ${target.value}`);\n    };\n    // 检查运算符\n    let checkOperator = (dir, target) => {\n      let token = tokens[current];\n      let local = dir === 'last' ? '前面' : '后面';\n      switch (target.type) {\n        case 'brackets':\n        case 'function':\n        case 'string':\n        case 'number':\n        case 'operand': {\n          return;\n        }\n        case 'array': {\n          if (token.value === ',') {\n            return;\n          }\n          break;\n        }\n      }\n      throw TypeError(`错误表达式 ${token.value} ${local} ${target.value}`);\n    };\n    // 检查函数\n    let checkFunction = (dir, target) => {\n      let token = tokens[current];\n      let local = dir === 'last' ? '前面' : '后面';\n      if (token.value === '(') {\n        if (dir === 'last') {\n          switch (target.type) {\n            case 'array': {\n              if (target.value === '{') {\n                return;\n              }\n              break;\n            }\n            case 'function': {\n              if (target.value === '(') {\n                return;\n              }\n              break;\n            }\n            case 'brackets': {\n              if (target.value === '(') {\n                return;\n              }\n              break;\n            }\n            case 'operator': {\n              return;\n            }\n          }\n        }\n        if (dir === 'next') {\n          switch (target.type) {\n            case 'function':\n            case 'string':\n            case 'number':\n            case 'operand': {\n              return;\n            }\n            case 'array': {\n              if (target.value === '{') {\n                return;\n              }\n              break;\n            }\n            case 'brackets': {\n              if (target.value === '(') {\n                return;\n              }\n              break;\n            }\n          }\n        }\n      }\n      if (token.value === ')') {\n        if (dir === 'last') {\n          switch (target.type) {\n            case 'function':\n            case 'number':\n            case 'string':\n            case 'operand': {\n              return;\n            }\n            case 'array': {\n              if (target.value === '}') {\n                return;\n              }\n              break;\n            }\n            case 'brackets': {\n              if (target.value === ')') {\n                return;\n              }\n              break;\n            }\n          }\n        }\n        if (dir === 'next') {\n          switch (target.type) {\n            case 'array': {\n              if (target.value === '}') {\n                return;\n              }\n              break;\n            }\n            case 'function': {\n              if (target.value === ')') {\n                return;\n              }\n              break;\n            }\n            case 'brackets': {\n              if (target.value === ')') {\n                return;\n              }\n              break;\n            }\n            case 'operator': {\n              if (target.value === ',') {\n                return;\n              }\n              return;\n            }\n          }\n        }\n      }\n      throw TypeError(`错误表达式 ${token.value} ${local} ${target.value}`);\n    };\n    // 循环处理所有token\n    while (current < length) {\n      // 当前处理的token\n      let token = tokens[current];\n      // 跳过忽略token\n      if (ignoreArray(token)) {\n        current++;\n        continue;\n      }\n      if (ignoreFunc(token)) {\n        current++;\n        continue;\n      }\n      let { type, value } = token;\n      // 处理单引号\n      if (type === \"'\") {\n        if (sQuotesStack.length) {\n          sQuotesStack.pop();\n        } else {\n          // 双引号中嵌套单引号\n          if (!dQuotesStack.length) {\n            sQuotesStack.push(\"'\");\n          }\n        }\n      }\n      // 处理双引号\n      if (type === '\"') {\n        if (dQuotesStack.length) {\n          dQuotesStack.pop();\n        } else {\n          // 单引号中嵌套双引号\n          if (!sQuotesStack.length) {\n            dQuotesStack.push('\"');\n          }\n        }\n      }\n      // 处理字符\n      if (type === 'string') {\n        let last = skipIgnoreToken('last', current - 1);\n        let next = skipIgnoreToken('next', current + 1);\n        if (last) {\n          checkValue('last', last);\n        }\n        if (next) {\n          checkValue('next', next);\n        }\n      }\n      // 处理数字\n      if (type === 'number') {\n        let last = skipIgnoreToken('last', current - 1);\n        let next = skipIgnoreToken('next', current + 1);\n        if (last) {\n          checkValue('last', last);\n        }\n        if (next) {\n          checkValue('next', next);\n        }\n      }\n      // 处理数组\n      if (type === 'array') {\n        if (value === '{') {\n          arrayStack.push(token);\n        }\n        if (value === '}') {\n          if (arrayStack.length === 0) {\n            throw new TypeError('数组缺少闭合标签');\n          }\n          arrayStack.pop();\n        }\n        let last = skipIgnoreToken('last', current - 1);\n        let next = skipIgnoreToken('next', current + 1);\n        if (last) {\n          checkArray('last', last);\n        }\n        if (next) {\n          checkArray('next', next);\n        }\n      }\n      // 处理函数调用\n      if (type === 'function') {\n        if (value === '(') {\n          callStack.push(token);\n        }\n        if (value === ')') {\n          callStack.pop();\n        }\n        let last = skipIgnoreToken('last', current - 1);\n        let next = skipIgnoreToken('next', current + 1);\n        if (last) {\n          checkFunction('last', last);\n        }\n        if (next) {\n          checkFunction('next', next);\n        }\n      }\n      // 处理运算符号\n      if (type === 'operator') {\n        let last = skipIgnoreToken('last', current - 1);\n        let next = skipIgnoreToken('next', current + 1);\n        // 运算符需要两边都有操作数\n        if (last) {\n          checkOperator('last', last);\n        } else {\n          throw TypeError(`错误表达式: ${token.value} 错误`);\n        }\n        if (next) {\n          checkOperator('next', next);\n        } else {\n          throw TypeError(`错误表达式: ${token.value} 错误`);\n        }\n      }\n      // 处理括号\n      if (type === 'brackets') {\n        if (value === '(') {\n          bracketsStack.push(token);\n        }\n        if (value === ')') {\n          if (bracketsStack.length === 0) {\n            throw new TypeError('括号缺少闭合标签');\n          }\n          bracketsStack.pop();\n        }\n      }\n      // 处理下一个字符\n      current++;\n    }\n    // 闭合标签检查\n    if (arrayStack.length) {\n      throw new TypeError('数组缺少闭合标签');\n    }\n    if (callStack.length) {\n      throw new TypeError('函数缺少闭合标签');\n    }\n    if (sQuotesStack.length) {\n      throw new TypeError('单引号缺少闭合标签');\n    }\n    if (dQuotesStack.length) {\n      throw new TypeError('双引号缺少闭合标签');\n    }\n    if (bracketsStack.length) {\n      throw new TypeError('括号缺少闭合标签');\n    }\n    return tokens;\n  }\n}\n\n/**\n * 编译表达式\n */\nclass Compiler {\n\n  /**\n   * Compiler\n   * @param tokens\n   * @param writer\n   */\n  constructor({\n    tokens, writer,\n  } = {}) {\n    this.writer = writer;\n    this.tokens = tokens;\n    this.groupStack = [];\n    this.index = -1;\n    this.ignore = [','];\n    // 运算符\n    this.opIf = {\n      '>': 'ifge',\n      '<': 'ifgt',\n      '=': 'ifeq',\n      '>=': 'if_icmpge',\n      '<=': 'if_icmpgt',\n      '<>': 'ifne',\n    };\n    this.opAdd = {\n      '+': 'add',\n      '-': 'sub',\n      '&': 'link',\n    };\n    this.opMul = {\n      '*': 'mul',\n      '/': 'div',\n      '%': 'mod',\n      '^': 'power',\n    };\n    this.opCommon = {\n      ' ': 'common',\n    };\n    this.opRel = {\n      '!': 'rel',\n      ':': 'uni',\n    };\n    this.opNew = {\n      array: 'newarray',\n    };\n    this.opCell = {\n      function: 'invoke',\n    };\n  }\n\n  /**\n   * 结束\n   */\n  eofToken() {\n    const { index, tokens } = this;\n    const { length } = tokens;\n    return index >= length - 1;\n  }\n\n  /**\n   * 切换下一个Token\n   */\n  nextToken() {\n    this.index++;\n    this.token = this.tokens[this.index];\n    return this.token;\n  }\n\n  /**\n   * 返回上一个Token\n   */\n  backToken() {\n    this.index--;\n    this.token = this.tokens[this.index];\n    return this.token;\n  }\n\n  /**\n   * 记录参数\n   */\n  reduceGroup() {\n    const { groupStack } = this;\n    const { length } = groupStack;\n    if (length > 0) {\n      const last = groupStack[length - 1];\n      const number = last.number;\n      last.number = number - 1;\n    }\n  }\n\n  /**\n   * 记录参数\n   */\n  increaseGroup() {\n    const { groupStack } = this;\n    const { length } = groupStack;\n    if (length > 0) {\n      const last = groupStack[length - 1];\n      const number = last.number;\n      last.number = number + 1;\n    }\n  }\n\n  /**\n   * 弹出组\n   */\n  popGroup() {\n    return this.groupStack.pop();\n  }\n\n  /**\n   * 添加组\n   */\n  addGroup(token) {\n    token.number = 0;\n    this.groupStack.push(token);\n    return token;\n  }\n\n  /**\n   * 忽略的Token\n   * @returns {*}\n   */\n  isSkipNextToken() {\n    if (!this.eofToken()) {\n      const { ignore } = this;\n      this.nextToken();\n      const { token } = this;\n      this.backToken();\n      const { value } = token;\n      return ignore.includes(value);\n    }\n    return false;\n  }\n\n  /**\n   * 编译表达式\n   */\n  compile() {\n    const { writer } = this;\n    this.compileIfge();\n    while (this.isSkipNextToken()) {\n      this.nextToken();\n      this.compileIfge();\n    }\n    return writer.getInstruct();\n  }\n\n  /**\n   * 编译条件运算\n   */\n  compileIfge() {\n    this.compileAdd();\n    while (!this.eofToken()) {\n      const token = this.nextToken();\n      const { type, value } = token;\n      if (type !== 'operator') {\n        this.backToken();\n        break;\n      }\n      if (!this.opIf[value]) {\n        this.backToken();\n        break;\n      }\n      let operator = this.opIf[value];\n      this.compileAdd();\n      this.reduceGroup();\n      this.writer.writeOperator(operator);\n    }\n  }\n\n  /**\n   * 编译加减运算\n   */\n  compileAdd() {\n    this.compileMul();\n    while (!this.eofToken()) {\n      const token = this.nextToken();\n      const { type, value } = token;\n      if (type !== 'operator') {\n        this.backToken();\n        break;\n      }\n      if (!this.opAdd[value]) {\n        this.backToken();\n        break;\n      }\n      let operator = this.opAdd[value];\n      this.compileMul();\n      this.reduceGroup();\n      this.writer.writeOperator(operator);\n    }\n  }\n\n  /**\n   * 编译乘除运算\n   */\n  compileMul() {\n    this.compileCommon();\n    while (!this.eofToken()) {\n      const token = this.nextToken();\n      const { type, value } = token;\n      if (type !== 'operator') {\n        this.backToken();\n        break;\n      }\n      if (!this.opMul[value]) {\n        this.backToken();\n        break;\n      }\n      let operator = this.opMul[value];\n      this.compileCommon();\n      this.reduceGroup();\n      this.writer.writeOperator(operator);\n    }\n  }\n\n  /**\n   * 编译公共区域运算\n   */\n  compileCommon() {\n    this.compileRel();\n    while (!this.eofToken()) {\n      const token = this.nextToken();\n      const { type, value } = token;\n      if (type !== 'operator') {\n        this.backToken();\n        break;\n      }\n      if (!this.opCommon[value]) {\n        this.backToken();\n        break;\n      }\n      let operator = this.opCommon[value];\n      this.compileRel();\n      this.reduceGroup();\n      this.writer.writeOperator(operator);\n    }\n  }\n\n  /**\n   * 编译跨Sheet引用运算\n   */\n  compileRel() {\n    this.compileArray();\n    while (!this.eofToken()) {\n      const token = this.nextToken();\n      const { type, value } = token;\n      if (type !== 'operator') {\n        this.backToken();\n        break;\n      }\n      if (!this.opRel[value]) {\n        this.backToken();\n        break;\n      }\n      let operator = this.opRel[value];\n      this.compileArray();\n      this.reduceGroup();\n      this.writer.writeOperator(operator);\n    }\n  }\n\n  /**\n   * 编译数组创建\n   */\n  compileArray() {\n    this.compileFunction();\n    while (!this.eofToken()) {\n      const token = this.nextToken();\n      const { type, value } = token;\n      if (type !== 'array') {\n        this.backToken();\n        break;\n      }\n      // 返回跳过 } 标记\n      if (value === '}') {\n        this.backToken();\n        break;\n      }\n      this.addGroup(token);\n      // 跳过当前 {  标记\n      this.nextToken();\n      // 处理数组中的子元素\n      this.compileIfge();\n      // 下一个是忽略的标记\n      // 则继续处理\n      while (this.isSkipNextToken()) {\n        this.nextToken();\n        this.compileIfge();\n      }\n      // 记录数组需要\n      // 操作的元素数量\n      this.popGroup();\n      const { number } = token;\n      const operator = this.opNew[type];\n      this.writer.writeOperator(`${operator} ${number}`);\n      // 跳过闭合标签 }\n      this.nextToken();\n    }\n  }\n\n  /**\n   * 编译函数调用\n   */\n  compileFunction() {\n    this.compilePushValue();\n    while (!this.eofToken()) {\n      const token = this.nextToken();\n      const { type, value } = token;\n      if (type !== 'function') {\n        this.backToken();\n        break;\n      }\n      // 返回跳过 ) 标记\n      if (value === ')') {\n        this.backToken();\n        break;\n      }\n      this.addGroup(token);\n      // 跳过当前 (  标记\n      this.nextToken();\n      // 处理函数的参数列表\n      this.compileIfge();\n      // 下一个是忽略的标记\n      // 则继续处理\n      while (this.isSkipNextToken()) {\n        this.nextToken();\n        this.compileIfge();\n      }\n      // 记录函数需要\n      // 操作的元素数量\n      this.popGroup();\n      const { number } = token;\n      const operator = this.opCell[type];\n      this.writer.writeOperator(`${operator} ${value} ${number}`);\n      // 跳过闭合标签 )\n      this.nextToken();\n    }\n  }\n\n  /**\n   * compilePushValue\n   */\n  compilePushValue() {\n    if (!this.eofToken()) {\n      const token = this.nextToken();\n      const { writer } = this;\n      const { type, value } = token;\n      // 推送操作数\n      // 递增函数/数组的参数数量(有的话)\n      switch (type) {\n        case 'string': {\n          this.increaseGroup();\n          writer.writeString(`${value}`);\n          return;\n        }\n        case 'number': {\n          this.increaseGroup();\n          writer.writeNumber(`${value}`);\n          return;\n        }\n        case 'operand': {\n          this.increaseGroup();\n          writer.writeOperand(value);\n          return;\n        }\n      }\n      // 处理括号计算\n      switch (type) {\n        case 'brackets': {\n          if (value === '(') {\n            this.compileIfge();\n            // 下一个是忽略的标记\n            // 则继续处理\n            while (this.isSkipNextToken()) {\n              this.nextToken();\n              this.compileIfge();\n            }\n            // 跳过闭合标签 )\n            this.nextToken();\n          }\n          return;\n        }\n      }\n      // 递增函数/数组的参数数量(有的话)\n      switch (type) {\n        case 'array': {\n          // {} 这种清空不需要增加参数数量\n          if (value !== '}') {\n            this.increaseGroup();\n          }\n          this.backToken();\n          return;\n        }\n        case 'function': {\n          // func() 这种清空不需要增加参数数量\n          if (value !== ')') {\n            this.increaseGroup();\n          }\n          this.backToken();\n          return;\n        }\n      }\n      // 过滤掉运算符\n      switch (type) {\n        case 'operator': {\n          this.backToken();\n          return;\n        }\n      }\n      // 无法识别的token\n      throw new TypeError(`无法识别的token ${type} ${value} `);\n    }\n  }\n}\n\n/**\n * 运行表达式\n */\nclass Evaluation {\n\n  /**\n   * Evaluate\n   * @param instruct\n   */\n  constructor(instruct) {\n    this.instruct = instruct.split('\\r\\n');\n    this.memory = [];\n  }\n\n  /**\n   * 运行表达式\n   */\n  eval() {\n    const newArray = /^newarray/;\n    const invoke = /^invoke/;\n    const pushSRegexp = /^SPush/;\n    const pushNRegexp = /^NPush/;\n    const pushORegexp = /^OPush/;\n    const { instruct } = this;\n    instruct.forEach((name) => {\n      switch (name) {\n        case 'if_icmpge': {\n          this.ificmpge();\n          break;\n        }\n        case 'if_icmpgt': {\n          this.ificmpgt();\n          break;\n        }\n        case 'ifge': {\n          this.ifge();\n          break;\n        }\n        case 'ifgt': {\n          this.ifgt();\n          break;\n        }\n        case 'ifeq': {\n          this.ifeq();\n          break;\n        }\n        case 'ifne': {\n          this.ifne();\n          break;\n        }\n        case 'add': {\n          this.add();\n          break;\n        }\n        case 'sub': {\n          this.sub();\n          break;\n        }\n        case 'mul': {\n          this.mul();\n          break;\n        }\n        case 'div': {\n          this.div();\n          break;\n        }\n        case 'mod': {\n          this.mod();\n          break;\n        }\n        case 'power': {\n          this.power();\n          break;\n        }\n        case 'rel': {\n          this.rel();\n          break;\n        }\n        case 'link': {\n          this.link();\n          break;\n        }\n        case 'uni': {\n          this.uni();\n          break;\n        }\n        case 'common': {\n          this.common();\n          break;\n        }\n        default: {\n          if (newArray.test(name)) {\n            const group = name.split(' ');\n            const index = group[1];\n            this.array(index);\n            break;\n          }\n          if (invoke.test(name)) {\n            const group = name.split(' ');\n            const func = group[1];\n            const index = group[2];\n            this.invoke(func, index);\n            break;\n          }\n          if (pushSRegexp.test(name)) {\n            const value = name.split(' ')[1];\n            this.pushS(value);\n            break;\n          }\n          if (pushNRegexp.test(name)) {\n            const value = name.split(' ')[1];\n            this.pushN(value);\n            break;\n          }\n          if (pushORegexp.test(name)) {\n            const value = name.split(' ')[1];\n            this.pushO(value);\n            break;\n          }\n        }\n      }\n    });\n    return this.memory.pop();\n  }\n\n  /**\n   * 推送操作数\n   * @param value\n   */\n  pushS(value) {\n    this.memory.push(value);\n  }\n\n  /**\n   * 推送操作数\n   * @param value\n   */\n  pushN(value) {\n    value = parseFloat(value);\n    this.memory.push(value);\n  }\n\n  /**\n   * 推送操作数\n   * @param value\n   */\n  pushO(value) {\n    this.memory.push(value);\n  }\n\n  /**\n   * 两个值的大于比较\n   */\n  ifge() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a > b);\n  }\n\n  /**\n   * 两个值的小于比较\n   */\n  ifgt() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a < b);\n  }\n\n  /**\n   * 两个值的相等比较\n   */\n  ifeq() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a === b);\n  }\n\n  /**\n   * 两个值的不等比较\n   */\n  ifne() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a !== b);\n  }\n\n  /**\n   * 两个值的大于等于比较\n   */\n  ificmpge() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a >= b);\n  }\n\n  /**\n   * 两个值的小于等于比较\n   */\n  ificmpgt() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a <= b);\n  }\n\n  /**\n   * 两个值的加法运算\n   */\n  add() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a + b);\n  }\n\n  /**\n   * 两个值的减法运算\n   */\n  sub() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a - b);\n  }\n\n  /**\n   * 两个值的乘法运算\n   */\n  mul() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a * b);\n  }\n\n  /**\n   * 两个值的除法运算\n   */\n  div() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a / b);\n  }\n\n  /**\n   * 两个值的mod运算\n   */\n  mod() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a % b);\n  }\n\n  /**\n   * 计算两个区域的并集\n   */\n  common() {\n    // TODO ...\n    // ....\n  }\n\n  /**\n   * 跨sheet引用运算\n   */\n  rel() {\n    // TODO ...\n    // ....\n  }\n\n  /**\n   * 计算两个区域连接的新区域\n   */\n  uni() {\n    // TODO ...\n    // ....\n  }\n\n  /**\n   * 字符串连接运算\n   */\n  link() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(`${a}${b}`);\n  }\n\n  /**\n   * 乘方计算\n   */\n  power() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(Math.pow(a, b));\n  }\n\n  /**\n   * 创建数组\n   * @param index\n   */\n  array(index) {\n    const array = [];\n    for (let i = 1; i <= index; i++) {\n      const item = this.memory.pop();\n      array.push(item);\n    }\n    array.reverse();\n    this.memory.push(array);\n  }\n\n  /**\n   * 执行函数\n   * @param func\n   * @param index\n   */\n  invoke(func, index) {\n    const array = [];\n    for (let i = 1; i <= index; i++) {\n      const item = this.memory.pop();\n      array.push(item);\n    }\n    array.reverse();\n    const execute = Functions.getFunction(func);\n    const result = execute.apply(this, array);\n    this.memory.push(result);\n  }\n}\n\n/**\n * 编译输出指令\n * @param input\n * @returns {string|*}\n * @constructor\n */\nconst Compile = (input) => {\n  if (input.startsWith('=')) {\n    input = input.substring(1);\n  }\n  const tokenizer = new Tokenizer();\n  const writer = new Assembly();\n  const tokens = tokenizer.lexical(input);\n  const compiler = new Compiler({\n    writer, tokens,\n  });\n  return compiler.compile();\n};\n\n/**\n * 运行指令\n * @param inst\n * @returns {*}\n * @constructor\n */\nconst Instruct = (inst) => {\n  const evaluation = new Evaluation(inst);\n  return evaluation.eval();\n};\n\n/**\n * 编译运行\n * @constructor\n */\nconst Evaluate = input => Instruct(Compile(input));\n\nexport {\n  Tokenizer,\n  Compiler,\n  Assembly,\n  Compile,\n  Evaluate,\n  Instruct,\n  Functions,\n};\n","import { Compile, Instruct } from './Compiler';\nimport { SheetUtils } from '../utils/SheetUtils';\n\n/**\n * Formula\n */\nclass Formula {\n\n  /**\n   * Formula\n   * @param expr\n   */\n  constructor({\n    expr = SheetUtils.EMPTY,\n  } = {}) {\n    this.expr = expr;\n    this.content = SheetUtils.Nul;\n    this.instruct = SheetUtils.Nul;\n  }\n\n  /**\n   * 计算公式\n   * @return {string}\n   */\n  getValue() {\n    let { expr } = this;\n    let { content } = this;\n    let { instruct } = this;\n    if (!content) {\n      if (!instruct) {\n        instruct = Compile(expr);\n      }\n      content = Instruct(instruct);\n    }\n    this.content = content;\n    this.instruct = instruct;\n    return content;\n  }\n\n  /**\n   * 有效的表达式\n   * @return {boolean}\n   */\n  hasExpr() {\n    let { expr } = this;\n    return !SheetUtils.isBlank(expr);\n  }\n\n  /**\n   * 获取表达式\n   * @return {string}\n   */\n  getExpr() {\n    return this.expr;\n  }\n\n  /**\n   * 设置表达式\n   * @param expr\n   */\n  setExpr(expr) {\n    this.expr = expr;\n    this.content = SheetUtils.Nul;\n    this.instruct = SheetUtils.Nul;\n  }\n\n  /**\n   * 复制\n   * @returns {Formula}\n   */\n  clone() {\n    return new Formula({\n      expr: this.expr,\n    });\n  }\n\n}\n\nFormula.EMPTY = new Formula();\n\nFormula.getInstance = (config) => {\n  if (config) {\n    return new Formula(config);\n  }\n  return Formula.EMPTY;\n};\n\nexport {\n  Formula,\n};\n","import { SheetUtils } from '../../../utils/SheetUtils';\nimport { CellFont } from './CellFont';\nimport { CellBorder } from './CellBorder';\nimport { XIcon } from '../tableicon/XIcon';\nimport XTableFormat from '../XTableTextFormat';\nimport { RichFonts } from './RichFonts';\nimport { Formula } from '../../../formula/Formula';\nimport { DateUtils } from '../../../utils/DateUtils';\n\n/**\n * 单元格\n */\nclass Cell {\n\n  /**\n   * Cell\n   * @param background\n   * @param format\n   * @param text\n   * @param richText\n   * @param ruler\n   * @param custom\n   * @param icons\n   * @param borderAttr\n   * @param fontAttr\n   * @param formula\n   * @param contentWidth\n   * @param contentHeight\n   * @param contentType\n   */\n  constructor({\n    format = 'default',\n    custom = {},\n    icons = [],\n    borderAttr = SheetUtils.Undef,\n    ruler = SheetUtils.Undef,\n    fontAttr = SheetUtils.Undef,\n    richText = SheetUtils.Undef,\n    formula = SheetUtils.Undef,\n    background = SheetUtils.Undef,\n    text = SheetUtils.EMPTY,\n    contentWidth = 0,\n    contentHeight = 0,\n    contentType = Cell.TYPE.STRING,\n  } = {}) {\n    // 背景颜色\n    this.background = background;\n    // 单元格图标\n    this.icons = XIcon.getInstance(icons);\n    // 自定义属性\n    this.custom = custom;\n    // 字体测量尺子\n    this.ruler = ruler;\n    // 格式化类型\n    this.format = format;\n    // 单元格公式\n    this.formula = Formula.getInstance(formula);\n    // 文本内容\n    this.text = text;\n    // 富文本内容\n    this.richText = RichFonts.getInstance(richText);\n    // 格式化后的内容\n    this.formatText = SheetUtils.EMPTY;\n    // 内容的高度\n    this.contentHeight = contentHeight;\n    // 内容的宽度\n    this.contentWidth = contentWidth;\n    // 字体属性\n    this.fontAttr = CellFont.getInstance(fontAttr);\n    // 边框属性\n    this.borderAttr = CellBorder.getInstance(borderAttr);\n    // 内容类型\n    this.setContentType(contentType);\n  }\n\n  /**\n   * 设置单元格小图标\n   * @param icons\n   */\n  setIcons(icons) {\n    this.icons = icons;\n    return this;\n  }\n\n  /**\n   * 设置内容文本\n   * @param text\n   */\n  setText(text) {\n    this.formatText = null;\n    this.text = text;\n    this.formula.setExpr(null);\n    this.richText.setRich([]);\n    this.setContentWidth(0);\n    return this;\n  }\n\n  /**\n   * 设置富文本\n   */\n  setRichText(rich) {\n    this.formatText = null;\n    this.text = null;\n    this.formula.setExpr(null);\n    this.richText.setRich(rich);\n    this.setContentWidth(0);\n    return this;\n  }\n\n  /**\n   * 设置公式\n   */\n  setExpr(expr) {\n    this.formatText = null;\n    this.text = null;\n    this.formula.setExpr(expr);\n    this.richText.setRich([]);\n    this.setContentWidth(0);\n    return this;\n  }\n\n  /**\n   * 获取公式\n   */\n  getExpr() {\n    return this.formula.getExpr();\n  }\n\n  /**\n   * 设置格式化类型\n   * @param format\n   */\n  setFormat(format = 'default') {\n    this.format = format;\n    this.formatText = null;\n    this.setContentWidth(0);\n    return this;\n  }\n\n  /**\n   * 保存测量尺子\n   * @param ruler\n   */\n  setRuler(ruler) {\n    this.ruler = ruler;\n    return this;\n  }\n\n  /**\n   * 设置内容类型\n   * @param type\n   */\n  setContentType(type = Cell.TYPE.STRING) {\n    const { text } = this;\n    switch (type) {\n      case Cell.TYPE.STRING: {\n        this.contentType = Cell.TYPE.STRING;\n        break;\n      }\n      case Cell.TYPE.NUMBER: {\n        this.contentType = type;\n        if (SheetUtils.isNumber(text)) {\n          this.contentType = Cell.TYPE.NUMBER;\n          this.text = SheetUtils.parseFloat(text);\n        } else {\n          this.contentType = Cell.TYPE.STRING;\n          this.text = `${text}`;\n        }\n        break;\n      }\n      case Cell.TYPE.DATE_TIME: {\n        const parse = DateUtils.parse(text);\n        if (SheetUtils.isDate(parse)) {\n          this.contentType = Cell.TYPE.DATE_TIME;\n          this.text = text;\n        } else {\n          this.contentType = Cell.TYPE.STRING;\n          this.text = `${text}`;\n        }\n        break;\n      }\n      case Cell.TYPE.RICH_TEXT: {\n        this.contentType = Cell.TYPE.RICH_TEXT;\n        break;\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 单元格是否为空\n   * @returns {boolean}\n   */\n  isEmpty() {\n    return SheetUtils.isBlank(this.getComputeText());\n  }\n\n  /**\n   * 公式是否存在\n   */\n  hasFormula() {\n    return this.formula.hasExpr();\n  }\n\n  /**\n   * 获取格式后的文本\n   * @returns {string|*}\n   */\n  getFormatText() {\n    let {\n      text,\n      formula,\n      format,\n    } = this;\n    let { formatText } = this;\n    let { contentType } = this;\n    // 优先获取公式值\n    if (formula.hasExpr()) {\n      let value = formula.getValue();\n      if (value) {\n        if (SheetUtils.isBlank(formatText)) {\n          formatText = XTableFormat(format, value);\n        }\n      }\n      this.formatText = formatText;\n      return formatText;\n    }\n    // 格式化文本\n    switch (contentType) {\n      case Cell.TYPE.STRING:\n      case Cell.TYPE.NUMBER:\n      case Cell.TYPE.DATE_TIME: {\n        if (format) {\n          if (SheetUtils.isBlank(formatText)) {\n            this.formatText = XTableFormat(format, text);\n            return this.formatText;\n          }\n        }\n        return formatText;\n      }\n    }\n    // 默认返回\n    return SheetUtils.EMPTY;\n  }\n\n  /**\n   * 获取计算后的文本\n   * @returns {string|*}\n   */\n  getComputeText() {\n    let {\n      text,\n      formula,\n    } = this;\n    let { richText } = this;\n    let { contentType } = this;\n    // 优先获取公式值\n    if (formula.hasExpr()) {\n      return formula.getValue();\n    }\n    // 读取不同类型\n    switch (contentType) {\n      case Cell.TYPE.STRING:\n      case Cell.TYPE.NUMBER:\n      case Cell.TYPE.DATE_TIME: {\n        return text;\n      }\n      case Cell.TYPE.RICH_TEXT: {\n        return richText;\n      }\n    }\n    // 默认返回\n    return SheetUtils.EMPTY;\n  }\n\n  /**\n   * 字体属性\n   * @param attr\n   */\n  setFontAttr(attr) {\n    this.fontAttr = attr;\n    return this;\n  }\n\n  /**\n   * 设置边框类型\n   * @param attr\n   */\n  setBorderAttr(attr) {\n    this.borderAttr = attr;\n    return this;\n  }\n\n  /**\n   * 复制单元格\n   * @returns {Cell}\n   */\n  clone() {\n    return new Cell(this);\n  }\n\n  /**\n   * toJSON\n   */\n  toJSON() {\n    const { background, text, format, custom } = this;\n    const { icons, contentType, formula } = this;\n    const { richText, fontAttr, borderAttr } = this;\n    return {\n      custom,\n      richText,\n      formula,\n      contentType,\n      text,\n      icons,\n      background,\n      format,\n      fontAttr,\n      borderAttr,\n    };\n  }\n\n  /**\n   * toString\n   * @returns {string|*}\n   */\n  toString() {\n    return this.getFormatText();\n  }\n\n  /**\n   * 内容宽度\n   * @param width\n   */\n  setContentWidth(width) {\n    this.contentWidth = width;\n    return this;\n  }\n\n  /**\n   * 内容宽度\n   * @param height\n   */\n  setContentHeight(height) {\n    this.contentHeight = height;\n    return this;\n  }\n\n}\n\n/**\n * 单元格类型\n */\nCell.TYPE = {\n  // 数字\n  NUMBER: 0,\n  // 字符\n  STRING: 1,\n  // 富文本\n  RICH_TEXT: 2,\n  // 日期\n  DATE_TIME: 3,\n};\n\nexport {\n  Cell,\n};\n","class Listen {\n\n  constructor() {\n    this.pool = {};\n  }\n\n  clear() {\n    Object.keys((key) => {\n      delete this.pool[key];\n    });\n  }\n\n  removeListen(key) {\n    delete this.pool[key];\n  }\n\n  registerListen(key, call) {\n    this.pool[key] = call;\n  }\n\n  execute(key, ...message) {\n    if (this.pool[key]) {\n      this.pool[key](...message);\n    }\n  }\n\n}\n\nexport {\n  Listen,\n};\n","import { SheetUtils } from '../../../utils/SheetUtils';\n\nclass RectRange {\n\n  /**\n   * RectRange\n   * @param {int} sri 起始行\n   * @param {int} sci 起始列\n   * @param {int} eri 结束行\n   * @param {int} eci 结束列\n   * @param {int} w 宽度\n   * @param {int} h 高度\n   */\n  constructor(sri, sci, eri, eci, w = 0, h = 0) {\n    this.sri = sri;\n    this.sci = sci;\n    this.eri = eri;\n    this.eci = eci;\n    this.w = w;\n    this.h = h;\n  }\n\n  /**\n   * 循环过滤指定的行列\n   * @param {XIteratorBuilder} iteratorBuilder 迭代器\n   * @param {Function} cb 回调函数\n   * @param {Function} rowFilter 过滤使用的回调函数\n   */\n  each(iteratorBuilder, cb, rowFilter = () => true) {\n    const {\n      sri, sci, eri, eci,\n    } = this;\n    let ret = false;\n    iteratorBuilder.getRowIterator()\n      .setBegin(sri)\n      .setEnd(eri)\n      .setLoop((i) => {\n        if (rowFilter(i)) {\n          iteratorBuilder.getColIterator()\n            .setBegin(sci)\n            .setEnd(eci)\n            .setLoop((j) => {\n              ret = cb(i, j);\n              return ret;\n            })\n            .execute();\n        }\n        return ret;\n      })\n      .execute();\n  }\n\n  /**\n   * 设置区域\n   * @param {int} sri 起始行\n   * @param {int} sci 起始列\n   * @param {int} eri 结束行\n   * @param {int} eci 结束列\n   */\n  set(sri, sci, eri, eci) {\n    this.sri = sri;\n    this.sci = sci;\n    this.eri = eri;\n    this.eci = eci;\n  }\n\n  /**\n   * 判断是否跨多个单元格\n   * @returns {boolean}\n   */\n  multiple() {\n    return this.eri - this.sri > 0 || this.eci - this.sci > 0;\n  }\n\n  /**\n   * 判断当前的区域是否包含指定的行和列\n   * 参数支持 ri, ci 和 A10 两种形式\n   * @param {[int, int] | String} args 行索引,列索引 或者 字符串\n   * @returns {boolean}\n   */\n  includes(...args) {\n    let [ri, ci] = [0, 0];\n    if (args.length === 1) {\n      [ci, ri] = SheetUtils.expr2xy(args[0]);\n    } else if (args.length === 2) {\n      [ri, ci] = args;\n    }\n    const {\n      sri, sci, eri, eci,\n    } = this;\n    return sri <= ri && ri <= eri && sci <= ci && ci <= eci;\n  }\n\n  /**\n   * 判断当前的区域是否包含指定的区域\n   * @param {RectRange} other 区域\n   * @returns {boolean}\n   */\n  contains(other) {\n    return this.sri <= other.sri\n      && this.sci <= other.sci\n      && this.eri >= other.eri\n      && this.eci >= other.eci;\n  }\n\n  /**\n   * 判断当前的区域是否被指定的区域包含\n   * @param {RectRange} other 区域\n   * @returns {boolean}\n   */\n  within(other) {\n    return this.sri >= other.sri\n      && this.sci >= other.sci\n      && this.eri <= other.eri\n      && this.eci <= other.eci;\n  }\n\n  /**\n   * 判断当前的区域和指定的区域不发生重合\n   * @param {RectRange} other 区域\n   * @returns {boolean}\n   */\n  disjoint(other) {\n    return this.sri > other.eri\n      || this.sci > other.eci\n      || other.sri > this.eri\n      || other.sci > this.eci;\n  }\n\n  /**\n   * 判断当前的区域和指定的区域发生重合\n   * @param {RectRange} other 区域\n   * @returns {boolean}\n   */\n  intersects(other) {\n    return this.sri <= other.eri\n      && this.sci <= other.eci\n      && other.sri <= this.eri\n      && other.sci <= this.eci;\n  }\n\n  /**\n   * 返回当前区域和指定区域合并后的新区域\n   * @param {RectRange} other 区域\n   * @returns {RectRange}\n   */\n  union(other) {\n    const {\n      sri, sci, eri, eci,\n    } = this;\n    return new RectRange(\n      other.sri < sri ? other.sri : sri,\n      other.sci < sci ? other.sci : sci,\n      other.eri > eri ? other.eri : eri,\n      other.eci > eci ? other.eci : eci,\n    );\n  }\n\n  /**\n   * 返回当前区域和指定区域合重合的新区域\n   * @param {RectRange} other\n   * @returns {RectRange}\n   */\n  coincide(other) {\n    const {\n      sri, sci, eri, eci,\n    } = this;\n    if (this.disjoint(other)) {\n      return RectRange.EMPTY;\n    }\n    return new RectRange(\n      other.sri > sri ? other.sri : sri,\n      other.sci > sci ? other.sci : sci,\n      other.eri < eri ? other.eri : eri,\n      other.eci < eci ? other.eci : eci,\n    );\n  }\n\n  /**\n   * 当前区域和指定区域重合\n   * 返回当前区域和指定区域不重合的部分\n   * @param {RectRange} other 区域\n   * @returns {Array}\n   */\n  coincideDifference(other) {\n    if (this.coincide(other).equals(RectRange.EMPTY)) {\n      return [];\n    }\n    return this.difference(other);\n  }\n\n  /**\n   * 返回当前区域和指定区域不重合的部分\n   * @param {RectRange} other 区域\n   * @returns {Array}\n   */\n  difference(other) {\n    const ret = [];\n    const addRet = (sri, sci, eri, eci) => {\n      ret.push(new RectRange(sri, sci, eri, eci));\n    };\n    const { sri, sci, eri, eci } = this;\n    const dsr = other.sri - sri;\n    const dsc = other.sci - sci;\n    const der = eri - other.eri;\n    const dec = eci - other.eci;\n    if (dsr > 0) {\n      addRet(sri, sci, other.sri - 1, eci);\n      if (der > 0) {\n        addRet(other.eri + 1, sci, eri, eci);\n        if (dsc > 0) {\n          addRet(other.sri, sci, other.eri, other.sci - 1);\n        }\n        if (dec > 0) {\n          addRet(other.sri, other.eci + 1, other.eri, eci);\n        }\n      } else {\n        if (dsc > 0) {\n          addRet(other.sri, sci, eri, other.sci - 1);\n        }\n        if (dec > 0) {\n          addRet(other.sri, other.eci + 1, eri, eci);\n        }\n      }\n    } else if (der > 0) {\n      addRet(other.eri + 1, sci, eri, eci);\n      if (dsc > 0) {\n        addRet(sri, sci, other.eri, other.sci - 1);\n      }\n      if (dec > 0) {\n        addRet(sri, other.eci + 1, other.eri, eci);\n      }\n    }\n    if (dsc > 0) {\n      addRet(sri, sci, eri, other.sci - 1);\n      if (dec > 0) {\n        addRet(sri, other.eri + 1, eri, eci);\n        if (dsr > 0) {\n          addRet(sri, other.sci, other.sri - 1, other.eci);\n        }\n        if (der > 0) {\n          addRet(other.sri + 1, other.sci, eri, other.eci);\n        }\n      } else {\n        if (dsr > 0) {\n          addRet(sri, other.sci, other.sri - 1, eci);\n        }\n        if (der > 0) {\n          addRet(other.sri + 1, other.sci, eri, eci);\n        }\n      }\n    } else if (dec > 0) {\n      addRet(sri, other.eci + 1, eri, eci);\n      if (dsr > 0) {\n        addRet(sri, sci, other.sri - 1, other.eci);\n      }\n      if (der > 0) {\n        addRet(other.eri + 1, sci, eri, other.eci);\n      }\n    }\n    return ret;\n  }\n\n  /**\n   * 当前区域跨的行列数\n   * @returns {number[]}\n   */\n  size() {\n    return [\n      this.eri - this.sri + 1,\n      this.eci - this.sci + 1,\n    ];\n  }\n\n  /**\n   * 返回边缘区域\n   * @returns {{top: RectRange, left: RectRange, bottom: RectRange, right: RectRange}}\n   */\n  brink() {\n    const { sri, eri, sci, eci } = this;\n    const top = new RectRange(sri, sci, sri, eci);\n    const bottom = new RectRange(eri, sci, eri, eci);\n    const right = new RectRange(sri, eci, eri, eci);\n    const left = new RectRange(sri, sci, eri, sci);\n    return { top, right, bottom, left };\n  }\n\n  /**\n   * 方位点\n   * @returns {{rb: RectRange, rt: RectRange, lb: RectRange, lt: RectRange}}\n   */\n  point() {\n    const { sri, eri, sci, eci } = this;\n    const lt = new RectRange(sri, sci, sri, sci);\n    const rt = new RectRange(sri, eci, sri, eci);\n    const lb = new RectRange(eri, sci, eri, sci);\n    const rb = new RectRange(eri, eci, eri, eci);\n    return { lt, rt, lb, rb };\n  }\n\n  /**\n   * equals\n   * @param {RectRange} other 区域\n   * @returns {boolean}\n   */\n  equals(other) {\n    return this.eri === other.eri\n      && this.eci === other.eci\n      && this.sri === other.sri\n      && this.sci === other.sci;\n  }\n\n  /**\n   * 克隆\n   * @returns {RectRange}\n   */\n  clone() {\n    const {\n      sri, sci, eri, eci, w, h,\n    } = this;\n    return new RectRange(sri, sci, eri, eci, w, h);\n  }\n\n  toString() {\n    const {\n      sri, sci, eri, eci,\n    } = this;\n    let ref = SheetUtils.xy2expr(sci, sri);\n    if (this.multiple()) {\n      ref = `${ref}:${SheetUtils.xy2expr(eci, eri)}`;\n    }\n    return ref;\n  }\n\n  /**\n   * 将 B1:B8 或者 B1 参数转换成新的区域\n   * @param {String} ref 行列字符串\n   * @returns {RectRange}\n   */\n  static valueOf(ref) {\n    const refs = ref.split(':');\n    const [sci, sri] = SheetUtils.expr2xy(refs[0]);\n    let [eri, eci] = [sri, sci];\n    if (refs.length > 1) {\n      [eci, eri] = SheetUtils.expr2xy(refs[1]);\n    }\n    return new RectRange(sri, sci, eri, eci);\n  }\n}\n\nRectRange.EMPTY = new RectRange(-1, -1, -1, -1);\n\nexport { RectRange };\n","/**\n * 数据快照\n */\nimport { Listen } from '../../../lib/Listen';\n\nclass Snapshot {\n\n  /**\n   * Snapshot\n   */\n  constructor() {\n    // 撤销\n    this.undoStack = [];\n    // 反撤销\n    this.redoStack = [];\n    // 当前记录层\n    this.layer = {\n      event: '',\n      data: [],\n    };\n    // 启用记录\n    this.apply = false;\n    // 数据监听\n    this.listen = new Listen();\n  }\n\n  /**\n   * 撤销\n   */\n  undo() {\n    const layer = this.undoStack.pop();\n    for (let i = layer.data.length - 1; i >= 0; i--) {\n      const action = layer.data[i];\n      action.undo();\n    }\n    this.redoStack.push(layer);\n    this.listen.execute('change', layer.event, 'undo');\n  }\n\n  /**\n   * 反撤销\n   */\n  redo() {\n    const layer = this.redoStack.pop();\n    for (let i = 0, len = layer.data.length; i < len; i++) {\n      const action = layer.data[i];\n      action.redo();\n    }\n    this.undoStack.push(layer);\n    this.listen.execute('change', layer.event, 'redo');\n  }\n\n  /**\n   * 打开快照\n   */\n  open() {\n    this.layer = {\n      event: '',\n      data: [],\n    };\n    this.apply = true;\n  }\n\n  /**\n   * 能否反撤销\n   * @returns {boolean}\n   */\n  canRedo() {\n    return this.redoStack.length > 0;\n  }\n\n  /**\n   * 能否撤销\n   * @returns {boolean}\n   */\n  canUndo() {\n    return this.undoStack.length > 0;\n  }\n\n  /**\n   * 关闭快照\n   */\n  close(event) {\n    if (this.layer.data.length) {\n      this.layer.event = event;\n      this.redoStack = [];\n      this.undoStack.push(this.layer);\n    }\n    this.layer = {\n      event: '',\n      data: [],\n    };\n    this.apply = false;\n    this.listen.execute('change', event, 'close');\n  }\n\n  /**\n   * 添加动作\n   * @param action\n   */\n  addAction(action = {\n    undo: () => {},\n    redo: () => {},\n  }) {\n    if (this.apply) {\n      this.layer.data.push(action);\n    }\n  }\n}\n\nexport {\n  Snapshot,\n};\n","function Compare(a, b) {\n  return a < b ? -1 : a > b ? 1 : 0;\n}\n\nfunction Swap(arr, i, j) {\n  let tmp = arr[i];\n  arr[i] = arr[j];\n  arr[j] = tmp;\n}\n\nfunction QStep(arr, k, left, right, compare) {\n  while (right > left) {\n    if (right - left > 600) {\n      let n = right - left + 1;\n      let m = k - left + 1;\n      let z = Math.log(n);\n      let s = 0.5 * Math.exp(2 * z / 3);\n      let sd = 0.5 * Math.sqrt(z * s * (n - s) / n) * (m - n / 2 < 0 ? -1 : 1);\n      let newLeft = Math.max(left, Math.floor(k - m * s / n + sd));\n      let newRight = Math.min(right, Math.floor(k + (n - m) * s / n + sd));\n      QStep(arr, k, newLeft, newRight, compare);\n    }\n\n    let t = arr[k];\n    let i = left;\n    let j = right;\n\n    Swap(arr, left, k);\n    if (compare(arr[right], t) > 0) Swap(arr, left, right);\n\n    while (i < j) {\n      Swap(arr, i, j);\n      i++;\n      j--;\n      while (compare(arr[i], t) < 0) i++;\n      while (compare(arr[j], t) > 0) j--;\n    }\n\n    if (compare(arr[left], t) === 0) Swap(arr, left, j);\n    else {\n      j++;\n      Swap(arr, j, right);\n    }\n\n    if (j <= k) left = j + 1;\n    if (k <= j) right = j - 1;\n  }\n}\n\nfunction QkSelect(arr, k, left, right, compare) {\n  QStep(arr, k, left || 0, right || (arr.length - 1), compare || Compare);\n}\n\nexport {\n  QkSelect,\n};\n","import { QkSelect } from './QkSelect';\n\nfunction findItem(item, items, equalsFn) {\n  if (!equalsFn) {\n    return items.indexOf(item);\n  }\n  for (let i = 0; i < items.length; i++) {\n    if (equalsFn(item, items[i])) return i;\n  }\n  return -1;\n}\nfunction extend(a, b) {\n  a.minX = Math.min(a.minX, b.minX);\n  a.minY = Math.min(a.minY, b.minY);\n  a.maxX = Math.max(a.maxX, b.maxX);\n  a.maxY = Math.max(a.maxY, b.maxY);\n  return a;\n}\nfunction compareNodeMinX(a, b) {\n  return a.minX - b.minX;\n}\nfunction compareNodeMinY(a, b) {\n  return a.minY - b.minY;\n}\nfunction bboxArea(a) {\n  return (a.maxX - a.minX) * (a.maxY - a.minY);\n}\nfunction bboxMargin(a) {\n  return (a.maxX - a.minX) + (a.maxY - a.minY);\n}\nfunction enlargedArea(a, b) {\n  return (Math.max(b.maxX, a.maxX) - Math.min(b.minX, a.minX)) * (Math.max(b.maxY, a.maxY) - Math.min(b.minY, a.minY));\n}\nfunction intersectionArea(a, b) {\n  const minX = Math.max(a.minX, b.minX);\n  const minY = Math.max(a.minY, b.minY);\n  const maxX = Math.min(a.maxX, b.maxX);\n  const maxY = Math.min(a.maxY, b.maxY);\n  return Math.max(0, maxX - minX) * Math.max(0, maxY - minY);\n}\nfunction contains(a, b) {\n  return a.minX <= b.minX && a.minY <= b.minY && b.maxX <= a.maxX && b.maxY <= a.maxY;\n}\nfunction intersects(a, b) {\n  return b.minX <= a.maxX && b.minY <= a.maxY && b.maxX >= a.minX && b.maxY >= a.minY;\n}\nfunction createNode(childrenNodes) {\n  return {\n    childrenNodes,\n    height: 1,\n    leaf: true,\n    minX: Infinity,\n    minY: Infinity,\n    maxX: -Infinity,\n    maxY: -Infinity,\n  };\n}\nfunction distBBox(node, k, p, toBBox, destNode) {\n  // 从 k 到 p-1 的节点子节点的最小边界矩形\n  if (!destNode) destNode = createNode(null);\n  destNode.minX = Infinity;\n  destNode.minY = Infinity;\n  destNode.maxX = -Infinity;\n  destNode.maxY = -Infinity;\n  for (let i = k; i < p; i++) {\n    const child = node.childrenNodes[i];\n    extend(destNode, node.leaf ? toBBox(child) : child);\n  }\n  return destNode;\n}\nfunction calcBBox(node, toBBox) {\n  // 从其子节点的框计算节点框\n  distBBox(node, 0, node.childrenNodes.length, toBBox, node);\n}\nfunction multiSelect(arr, left, right, n, compare) {\n  // 对数组进行排序，以便项目以 n 个未排序项目为一组，各组在彼此之间排序；\n  // 将选择算法与二元分治法相结合\n  const stack = [left, right];\n  while (stack.length) {\n    right = stack.pop();\n    left = stack.pop();\n    if (right - left <= n) continue;\n    const mid = left + Math.ceil((right - left) / n / 2) * n;\n    QkSelect(arr, mid, left, right, compare);\n    stack.push(left, mid, mid, right);\n  }\n}\n\nclass RectTree {\n  constructor(maxEntries = 9) {\n    // 默认情况下，节点中的最大条目数为 9； 最小节点填充为 40% 以获得最佳性能\n    this._maxEntries = Math.max(4, maxEntries);\n    this._minEntries = Math.max(2, Math.ceil(this._maxEntries * 0.4));\n    this.clear();\n  }\n\n  all() {\n    return this._all(this.data, []);\n  }\n\n  search(bbox) {\n    let node = this.data;\n    const result = [];\n\n    if (!intersects(bbox, node)) {\n      return result;\n    }\n\n    const toBBox = this.toBBox;\n    const nodesToSearch = [];\n\n    while (node) {\n      for (let i = 0; i < node.childrenNodes.length; i++) {\n        const child = node.childrenNodes[i];\n        const childBBox = node.leaf ? toBBox(child) : child;\n        if (intersects(bbox, childBBox)) {\n          if (node.leaf) result.push(child);\n          else if (contains(bbox, childBBox)) this._all(child, result);\n          else nodesToSearch.push(child);\n        }\n      }\n      node = nodesToSearch.pop();\n    }\n\n    return result;\n  }\n\n  first(bbox) {\n    return this.search(bbox)[0];\n  }\n\n  collides(bbox) {\n    let node = this.data;\n\n    if (!intersects(bbox, node)) {\n      return false;\n    }\n\n    const nodesToSearch = [];\n    while (node) {\n      for (let i = 0; i < node.childrenNodes.length; i++) {\n        const child = node.childrenNodes[i];\n        const childBBox = node.leaf ? this.toBBox(child) : child;\n        if (intersects(bbox, childBBox)) {\n          if (node.leaf || contains(bbox, childBBox)) return true;\n          nodesToSearch.push(child);\n        }\n      }\n      node = nodesToSearch.pop();\n    }\n\n    return false;\n  }\n\n  load(data) {\n    if (!(data && data.length)) {\n      return this;\n    }\n\n    if (data.length < this._minEntries) {\n      for (let i = 0; i < data.length; i++) {\n        this.insert(data[i]);\n      }\n      return this;\n    }\n\n    // 使用 OMT 算法从头开始使用给定数据递归构建树\n    let node = this._build(data.slice(), 0, data.length - 1, 0);\n\n    if (!this.data.childrenNodes.length) {\n      // 如果树为空，则按原样保存\n      this.data = node;\n    } else if (this.data.height === node.height) {\n      // 如果树具有相同的高度，则拆分根\n      this._splitRoot(this.data, node);\n    } else {\n      if (this.data.height < node.height) {\n        // 如果插入的树更大，则交换树\n        const tmpNode = this.data;\n        this.data = node;\n        node = tmpNode;\n      }\n      // 将小树插入大树中适当的层次\n      this._insert(node, this.data.height - node.height - 1, true);\n    }\n\n    return this;\n  }\n\n  insert(item) {\n    if (item) {\n      this._insert(item, this.data.height - 1);\n    }\n    return this;\n  }\n\n  clear() {\n    this.data = createNode([]);\n    return this;\n  }\n\n  remove(item, equalsFn) {\n    if (!item) {\n      return this;\n    }\n\n    let node = this.data;\n    const bbox = this.toBBox(item);\n    const path = [];\n    const indexes = [];\n    let i;\n    let parent;\n    let goingUp;\n\n    // 深度优先迭代树遍历\n    while (node || path.length) {\n      if (!node) {\n        // 往上\n        node = path.pop();\n        parent = path[path.length - 1];\n        i = indexes.pop();\n        goingUp = true;\n      }\n\n      if (node.leaf) {\n        // 检查当前节点\n        const index = findItem(item, node.childrenNodes, equalsFn);\n        if (index !== -1) {\n          // 找到项目，移除项目并向上压缩树\n          node.childrenNodes.splice(index, 1);\n          path.push(node);\n          this._condense(path);\n          return this;\n        }\n      }\n\n      if (!goingUp && !node.leaf && contains(node, bbox)) {\n        // 往下\n        path.push(node);\n        indexes.push(i);\n        i = 0;\n        parent = node;\n        node = node.childrenNodes[0];\n      } else if (parent) {\n        // 向右走\n        i++;\n        node = parent.childrenNodes[i];\n        goingUp = false;\n      } else {\n        // 没有发现\n        node = null;\n      }\n    }\n\n    return this;\n  }\n\n  toBBox(item) {\n    return item;\n  }\n\n  compareMinX(a, b) {\n    return a.minX - b.minX;\n  }\n\n  compareMinY(a, b) {\n    return a.minY - b.minY;\n  }\n\n  _all(node, result) {\n    const nodesToSearch = [];\n    while (node) {\n      if (node.leaf) {\n        result.push(...node.childrenNodes);\n      } else {\n        nodesToSearch.push(...node.childrenNodes);\n      }\n      node = nodesToSearch.pop();\n    }\n    return result;\n  }\n\n  _build(items, left, right, height) {\n    const N = right - left + 1;\n    let M = this._maxEntries;\n    let node;\n\n    if (N <= M) {\n      // 达到叶级； 回叶\n      node = createNode(items.slice(left, right + 1));\n      calcBBox(node, this.toBBox);\n      return node;\n    }\n\n    if (!height) {\n      // 散装树的目标高度\n      height = Math.ceil(Math.log(N) / Math.log(M));\n      // 目标根条目数以最大限度地提高存储利用率\n      M = Math.ceil(N / Math.pow(M, height - 1));\n    }\n\n    node = createNode([]);\n    node.leaf = false;\n    node.height = height;\n\n    // 将项目分成 M 个主要为方形的元素\n    const N2 = Math.ceil(N / M);\n    const N1 = N2 * Math.ceil(Math.sqrt(M));\n\n    multiSelect(items, left, right, N1, this.compareMinX);\n\n    for (let i = left; i <= right; i += N1) {\n      const right2 = Math.min(i + N1 - 1, right);\n      multiSelect(items, i, right2, N2, this.compareMinY);\n      for (let j = i; j <= right2; j += N2) {\n        const right3 = Math.min(j + N2 - 1, right2);\n        // 递归地打包每个条目\n        node.childrenNodes.push(this._build(items, j, right3, height - 1));\n      }\n    }\n\n    calcBBox(node, this.toBBox);\n\n    return node;\n  }\n\n  _chooseSubtree(bbox, node, level, path) {\n    while (true) {\n      path.push(node);\n\n      if (node.leaf || path.length - 1 === level) {\n        break;\n      }\n\n      let minArea = Infinity;\n      let minEnlargement = Infinity;\n      let targetNode;\n\n      for (let i = 0; i < node.childrenNodes.length; i++) {\n        const child = node.childrenNodes[i];\n        const area = bboxArea(child);\n        const enlargement = enlargedArea(bbox, child) - area;\n\n        // 选择最小面积扩大的入口\n        if (enlargement < minEnlargement) {\n          minEnlargement = enlargement;\n          minArea = area < minArea ? area : minArea;\n          targetNode = child;\n        } else if (enlargement === minEnlargement) {\n          // 否则选择面积最小的一个\n          if (area < minArea) {\n            minArea = area;\n            targetNode = child;\n          }\n        }\n      }\n\n      node = targetNode || node.childrenNodes[0];\n    }\n\n    return node;\n  }\n\n  _insert(item, level, isNode) {\n    const bbox = isNode ? item : this.toBBox(item);\n    const insertPath = [];\n\n    // 找到容纳物品的最佳节点，同时保存路径上的所有节点\n    const node = this._chooseSubtree(bbox, this.data, level, insertPath);\n\n    // 将项目放入节点\n    node.childrenNodes.push(item);\n    extend(node, bbox);\n\n    // 节点溢出时分裂； 必要时向上传播\n    while (level >= 0) {\n      if (insertPath[level].childrenNodes.length > this._maxEntries) {\n        this._split(insertPath, level);\n        level--;\n      } else {\n        break;\n      }\n    }\n\n    // 沿插入路径调整 bboxes\n    this._adjustParentBBoxes(bbox, insertPath, level);\n  }\n\n  // 将溢出的节点一分为二\n  _split(insertPath, level) {\n    const node = insertPath[level];\n    const M = node.childrenNodes.length;\n    const m = this._minEntries;\n\n    this._chooseSplitAxis(node, m, M);\n\n    const splitIndex = this._chooseSplitIndex(node, m, M);\n\n    const newNode = createNode(node.childrenNodes.splice(splitIndex, node.childrenNodes.length - splitIndex));\n    newNode.height = node.height;\n    newNode.leaf = node.leaf;\n\n    calcBBox(node, this.toBBox);\n    calcBBox(newNode, this.toBBox);\n\n    if (level) {\n      insertPath[level - 1].childrenNodes.push(newNode);\n    } else {\n      this._splitRoot(node, newNode);\n    }\n  }\n\n  _splitRoot(node, newNode) {\n    // 分裂根节点\n    this.data = createNode([node, newNode]);\n    this.data.height = node.height + 1;\n    this.data.leaf = false;\n    calcBBox(this.data, this.toBBox);\n  }\n\n  _chooseSplitIndex(node, m, M) {\n    let index;\n    let minOverlap = Infinity;\n    let minArea = Infinity;\n\n    for (let i = m; i <= M - m; i++) {\n      const bbox1 = distBBox(node, 0, i, this.toBBox);\n      const bbox2 = distBBox(node, i, M, this.toBBox);\n\n      const overlap = intersectionArea(bbox1, bbox2);\n      const area = bboxArea(bbox1) + bboxArea(bbox2);\n\n      // 选择重叠最小的分布\n      if (overlap < minOverlap) {\n        minOverlap = overlap;\n        index = i;\n        minArea = area < minArea ? area : minArea;\n      } else if (overlap === minOverlap) {\n        // 否则选择面积最小的分布\n        if (area < minArea) {\n          minArea = area;\n          index = i;\n        }\n      }\n    }\n\n    return index || M - m;\n  }\n\n  // 按最佳轴对节点子节点进行排序以进行拆分\n  _chooseSplitAxis(node, m, M) {\n    const compareMinX = node.leaf ? this.compareMinX : compareNodeMinX;\n    const compareMinY = node.leaf ? this.compareMinY : compareNodeMinY;\n    const xMargin = this._allDistMargin(node, m, M, compareMinX);\n    const yMargin = this._allDistMargin(node, m, M, compareMinY);\n    // 如果 x 的总分配边际值最小，则按 minX 排序,\n    // 否则它已经按 minY 排序\n    if (xMargin < yMargin) {\n      node.childrenNodes.sort(compareMinX);\n    }\n  }\n\n  // 所有可能的分割分布的总边际，其中每个节点至少是 m 满\n  _allDistMargin(node, m, M, compare) {\n    node.childrenNodes.sort(compare);\n\n    const toBBox = this.toBBox;\n    const leftBBox = distBBox(node, 0, m, toBBox);\n    const rightBBox = distBBox(node, M - m, M, toBBox);\n    let margin = bboxMargin(leftBBox) + bboxMargin(rightBBox);\n\n    for (let i = m; i < M - m; i++) {\n      const child = node.childrenNodes[i];\n      extend(leftBBox, node.leaf ? toBBox(child) : child);\n      margin += bboxMargin(leftBBox);\n    }\n\n    for (let i = M - m - 1; i >= m; i--) {\n      const child = node.childrenNodes[i];\n      extend(rightBBox, node.leaf ? toBBox(child) : child);\n      margin += bboxMargin(rightBBox);\n    }\n\n    return margin;\n  }\n\n  _adjustParentBBoxes(bbox, path, level) {\n    // 沿给定的树路径调整 bbox\n    for (let i = level; i >= 0; i--) {\n      extend(path[i], bbox);\n    }\n  }\n\n  _condense(path) {\n    // 遍历路径，删除空节点并更新 bboxes\n    for (let i = path.length - 1, siblings; i >= 0; i--) {\n      if (path[i].childrenNodes.length === 0) {\n        if (i > 0) {\n          siblings = path[i - 1].childrenNodes;\n          siblings.splice(siblings.indexOf(path[i]), 1);\n        } else {\n          this.clear();\n        }\n      } else {\n        calcBBox(path[i], this.toBBox);\n      }\n    }\n  }\n}\n\nexport {\n  RectTree,\n};\n","import { RectRange } from '../core/table/tablebase/RectRange';\n\nclass RtreeUtils {\n\n  static bboxToRange(bbox) {\n    return new RectRange(bbox.minY, bbox.minX, bbox.maxY, bbox.maxX);\n  }\n\n  static rangeToBbox(range) {\n    return {\n      minX: range.sci,\n      minY: range.sri,\n      maxX: range.eci,\n      maxY: range.eri,\n    };\n  }\n\n}\n\nexport {\n  RtreeUtils,\n};\n","import { Snapshot } from '../snapshot/Snapshot';\nimport { RectTree } from '../../../lib/recttree/RectTree';\nimport { Listen } from '../../../lib/Listen';\nimport { RtreeUtils } from '../../../utils/RtreeUtils';\nimport { SheetUtils } from '../../../utils/SheetUtils';\nimport { RectRange } from './RectRange';\n\n/**\n * RangeTree\n */\nclass RangeTree {\n\n  /**\n     * RangeTree 区域管理\n     */\n  constructor({\n    snapshot = new Snapshot(),\n  }) {\n    this.snapshot = snapshot;\n    this.rTree = new RectTree();\n    this.listen = new Listen();\n  }\n\n  /**\n     * 获取包含点的矩形区域\n     * @param ri\n     * @param ci\n     */\n  getFirstInclude(ri, ci) {\n    let { rTree } = this;\n    let bbox = {\n      minX: ci,\n      minY: ri,\n      maxX: ci,\n      maxY: ri,\n    };\n    let find = rTree.first(bbox);\n    if (find) {\n      return RtreeUtils.bboxToRange(find);\n    }\n    return SheetUtils.Undef;\n  }\n\n  /**\n   * 获取包含点的矩形区域\n   * @param ri\n   * @param ci\n   */\n  getMasterInclude(ri, ci) {\n    const find = this.getFirstInclude(ri, ci);\n    if (find.sri === ri) {\n      if (find.sci === ci) {\n        return find;\n      }\n    }\n    return SheetUtils.Undef;\n  }\n\n  /**\n     * 获取重合的区域\n     * @param rectRange\n     */\n  getIntersects(rectRange) {\n    let { rTree } = this;\n    let bbox = RtreeUtils.rangeToBbox(rectRange);\n    const array = rTree.search(bbox);\n    return array.map(bbox => RtreeUtils.bboxToRange(bbox));\n  }\n\n  /**\n     * 添加矩形区域\n     * @param rectRange\n     */\n  push(rectRange) {\n    let { rTree } = this;\n    let bbox = RtreeUtils.rangeToBbox(rectRange);\n    rTree.insert(bbox);\n    return this;\n  }\n\n  /**\n     * 删除矩形区域\n     * @param rectRange\n     */\n  shift(rectRange) {\n    let { rTree } = this;\n    let bbox = RtreeUtils.rangeToBbox(rectRange);\n    let array = rTree.search(bbox);\n    for (let i = 0, len = array.length; i < len; i++) {\n      let item = array[i];\n      rTree.remove(item);\n    }\n    return this;\n  }\n\n  /**\n     * 添加矩形区域\n     * @param rectRange\n     */\n  add(rectRange) {\n    let { listen, snapshot } = this;\n    let action = {\n      undo: () => {\n        this.shift(rectRange);\n      },\n      redo: () => {\n        this.push(rectRange);\n        listen.execute('add', rectRange);\n      },\n    };\n    snapshot.addAction(action);\n    action.redo();\n  }\n\n  /**\n     * 删除矩形区域\n     * @param rectRange\n     */\n  delete(rectRange) {\n    let { listen, snapshot } = this;\n    let action = {\n      undo: () => {\n        this.push(rectRange);\n      },\n      redo: () => {\n        this.shift(rectRange);\n        listen.execute('delete', rectRange);\n      },\n    };\n    snapshot.addAction(action);\n    action.redo();\n  }\n\n  /**\n   * 删除矩形区域\n   * @param rectRanges\n   */\n  batchDelete(rectRanges) {\n    let { listen, snapshot } = this;\n    let action = {\n      undo: () => {\n        rectRanges.forEach((rectRange) => {\n          this.push(rectRange);\n        });\n      },\n      redo: () => {\n        rectRanges.forEach((rectRange) => {\n          this.shift(rectRange);\n        });\n        listen.execute('batchDelete', rectRanges);\n      },\n    };\n    snapshot.addAction(action);\n    action.redo();\n  }\n\n  /**\n     * 获取所有的矩形区域\n     */\n  getAll() {\n    let { rTree } = this;\n    return rTree.all().map(bbox => RtreeUtils.bboxToRange(bbox));\n  }\n\n  /**\n     * 获取交叉矩形新区域\n     * @param rectRange\n     */\n  union(rectRange) {\n    let { rTree } = this;\n    let bbox = RtreeUtils.rangeToBbox(rectRange);\n    let array = rTree.search(bbox);\n    if (array.length === 0) {\n      return rectRange;\n    }\n    let clone = rectRange.clone();\n    for (let i = 0, len = array.length; i < len; i++) {\n      let range = RtreeUtils.bboxToRange(array[i]);\n      clone = clone.union(range);\n    }\n    if (!clone.equals(rectRange)) {\n      return this.union(clone);\n    }\n    return rectRange;\n  }\n\n  /**\n   * 获取整行区域\n   * @param ri\n   * @param number\n   * @returns {RectRange}\n   */\n  getFullRowRange(ri, number) {\n    return new RectRange(ri, 0, Math.max(ri, ri + number - 1), RangeTree.MAX_COL);\n  }\n\n  /**\n   * 获取整列区域\n   * @param ci\n   * @param number\n   * @returns {RectRange}\n   */\n  getFullColRange(ci, number) {\n    return new RectRange(0, ci, RangeTree.MAX_ROW, Math.max(ci, ci + number - 1));\n  }\n\n  /**\n     * 行扩展\n     * @param ri\n     * @param number\n     */\n  rowAfterExpand(ri, number) {\n    let bbox = {\n      minX: 0,\n      minY: ri,\n      maxX: RangeTree.MAX_COL,\n      maxY: RangeTree.MAX_ROW,\n    };\n    let { rTree } = this;\n    let array = rTree.search(bbox);\n    for (let i = 0, len = array.length; i < len; i++) {\n      let item = array[i];\n      rTree.remove(item);\n      if (item.minY > ri) {\n        item.minY += number;\n      }\n      if (item.maxY > ri) {\n        item.maxY += number;\n      }\n    }\n    rTree.load(array);\n  }\n\n  /**\n     * 列扩展\n     * @param ci\n     * @param number\n     */\n  colAfterExpand(ci, number) {\n    const bbox = {\n      minX: ci,\n      minY: 0,\n      maxX: RangeTree.MAX_COL,\n      maxY: RangeTree.MAX_ROW,\n    };\n    let { rTree } = this;\n    let array = rTree.search(bbox);\n    for (let i = 0, len = array.length; i < len; i++) {\n      let item = array[i];\n      rTree.remove(item);\n      if (item.minX > ci) {\n        item.minX += number;\n      }\n      if (item.maxX > ci) {\n        item.maxX += number;\n      }\n    }\n    rTree.load(array);\n  }\n\n  /**\n     * 行收缩\n     * @param ri\n     * @param number\n     */\n  rowAfterShrink(ri, number) {\n    let bbox = {\n      minX: 0,\n      minY: ri,\n      maxX: RangeTree.MAX_COL,\n      maxY: RangeTree.MAX_ROW,\n    };\n    let { rTree } = this;\n    let array = rTree.search(bbox);\n    for (let i = 0, len = array.length; i < len; i++) {\n      let item = array[i];\n      rTree.remove(item);\n      if (item.minY > ri) {\n        item.minY -= number;\n      }\n      if (item.maxY > ri) {\n        item.maxY -= number;\n      }\n    }\n    rTree.load(array);\n  }\n\n  /**\n     * 列收索\n     * @param ci\n     * @param number\n     */\n  colAfterShrink(ci, number) {\n    const bbox = {\n      minX: ci,\n      minY: 0,\n      maxX: RangeTree.MAX_COL,\n      maxY: RangeTree.MAX_ROW,\n    };\n    let { rTree } = this;\n    let array = rTree.search(bbox);\n    for (let i = 0, len = array.length; i < len; i++) {\n      let item = array[i];\n      rTree.remove(item);\n      if (item.minX > ci) {\n        item.minX -= number;\n      }\n      if (item.maxX > ci) {\n        item.maxX -= number;\n      }\n    }\n    rTree.load(array);\n  }\n\n  /**\n   * 行扩展\n   * @param ri\n   * @param number\n   */\n  rowBeforeExpand(ri, number) {\n    let bbox = {\n      minX: 0,\n      minY: ri,\n      maxX: RangeTree.MAX_COL,\n      maxY: RangeTree.MAX_ROW,\n    };\n    let { rTree } = this;\n    let array = rTree.search(bbox);\n    for (let i = 0, len = array.length; i < len; i++) {\n      let item = array[i];\n      rTree.remove(item);\n      if (item.minY >= ri) {\n        item.minY += number;\n      }\n      if (item.maxY >= ri) {\n        item.maxY += number;\n      }\n    }\n    rTree.load(array);\n  }\n\n  /**\n   * 列扩展\n   * @param ci\n   * @param number\n   */\n  colBeforeExpand(ci, number) {\n    const bbox = {\n      minX: ci,\n      minY: 0,\n      maxX: RangeTree.MAX_COL,\n      maxY: RangeTree.MAX_ROW,\n    };\n    let { rTree } = this;\n    let array = rTree.search(bbox);\n    for (let i = 0, len = array.length; i < len; i++) {\n      let item = array[i];\n      rTree.remove(item);\n      if (item.minX >= ci) {\n        item.minX += number;\n      }\n      if (item.maxX >= ci) {\n        item.maxX += number;\n      }\n    }\n    rTree.load(array);\n  }\n\n  /**\n   * 行收缩\n   * @param ri\n   * @param number\n   */\n  rowBeforeShrink(ri, number) {\n    let bbox = {\n      minX: 0,\n      minY: ri,\n      maxX: RangeTree.MAX_COL,\n      maxY: RangeTree.MAX_ROW,\n    };\n    let { rTree } = this;\n    let array = rTree.search(bbox);\n    for (let i = 0, len = array.length; i < len; i++) {\n      let item = array[i];\n      rTree.remove(item);\n      if (item.minY >= ri) {\n        item.minY -= number;\n      }\n      if (item.maxY >= ri) {\n        item.maxY -= number;\n      }\n    }\n    rTree.load(array);\n  }\n\n  /**\n   * 列收索\n   * @param ci\n   * @param number\n   */\n  colBeforeShrink(ci, number) {\n    const bbox = {\n      minX: ci,\n      minY: 0,\n      maxX: RangeTree.MAX_COL,\n      maxY: RangeTree.MAX_ROW,\n    };\n    let { rTree } = this;\n    let array = rTree.search(bbox);\n    for (let i = 0, len = array.length; i < len; i++) {\n      let item = array[i];\n      rTree.remove(item);\n      if (item.minX >= ci) {\n        item.minX -= number;\n      }\n      if (item.maxX >= ci) {\n        item.maxX -= number;\n      }\n    }\n    rTree.load(array);\n  }\n}\n\nRangeTree.MAX_COL = 1433;\nRangeTree.MAX_ROW = 1048576;\n\nexport {\n  RangeTree,\n};\n","import { RectRange } from '../tablebase/RectRange';\nimport { Snapshot } from '../snapshot/Snapshot';\nimport { RangeTree } from '../tablebase/RangeTree';\nimport { RtreeUtils } from '../../../utils/RtreeUtils';\n\n/**\n * Merges\n */\nclass Merges extends RangeTree {\n\n  /**\n     * Merges 合并区域管理\n     */\n  constructor({\n    snapshot = new Snapshot(),\n    merges = [],\n  } = {}) {\n    super({ snapshot });\n    merges.map(merge => RectRange.valueOf(merge)).forEach(view => this.add(view));\n  }\n\n  /**\n   * 删除行号\n   * @param ri\n   * @param number\n   */\n  removeRow(ri, number) {\n    let { rTree, snapshot } = this;\n    let footRange = new RectRange(ri, 0, RangeTree.MAX_ROW, RangeTree.MAX_COL);\n    let fullRange = this.getFullRowRange(ri, number);\n    let fullBbox = RtreeUtils.rangeToBbox(fullRange);\n    let footBbox = RtreeUtils.rangeToBbox(footRange);\n    let divers = [];\n    let search = [];\n    let mergeAction = {\n      undo: () => {\n        let { length } = divers;\n        for (let i = 0; i < length; i++) {\n          const item = divers[i];\n          rTree.remove(item);\n        }\n        rTree.load(search);\n      },\n      redo: () => {\n        divers = [];\n        search = rTree.search(footBbox);\n        let { length } = search;\n        for (let i = 0; i < length; i++) {\n          const item = search[i];\n          const clone = { ...item };\n          rTree.remove(item);\n          if (clone.minY < fullBbox.minY) {\n            if (clone.maxY < fullBbox.maxY) {\n              let diffMax = clone.maxY - fullBbox.minY;\n              diffMax += 1;\n              clone.oldMax = clone.maxY;\n              clone.maxY -= diffMax;\n              clone.style = 'oddValue';\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\n                divers.push(clone);\n              }\n              continue;\n            }\n            if (clone.maxY > fullBbox.maxY) {\n              let diffMax = fullBbox.maxY - footBbox.minY;\n              diffMax += 1;\n              clone.oldMax = clone.maxY;\n              clone.maxY -= diffMax;\n              clone.style = 'oddValue';\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\n                divers.push(clone);\n              }\n              continue;\n            }\n            if (clone.maxY === fullBbox.maxY) {\n              let diffMax = fullBbox.maxY - footBbox.minY;\n              diffMax += 1;\n              clone.oldMax = clone.maxY;\n              clone.maxY -= diffMax;\n              clone.style = 'oddValue';\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\n                divers.push(clone);\n              }\n              continue;\n            }\n          }\n          if (clone.minY > fullBbox.minY) {\n            if (clone.minY < fullBbox.maxY) {\n              if (clone.maxY > fullBbox.maxY) {\n                let diffMin = clone.minY - fullBbox.minY;\n                let diffMax = fullBbox.maxY - clone.minY;\n                diffMax += diffMin + 1;\n                clone.oldMax = clone.maxY;\n                clone.oldMin = clone.minY;\n                clone.maxY -= diffMax;\n                clone.minY -= diffMin;\n                clone.style = 'evenValue';\n                if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\n                  divers.push(clone);\n                }\n                continue;\n              }\n            }\n            if (clone.minY > fullBbox.maxY) {\n              let diffValue = fullBbox.maxY - fullBbox.minY;\n              diffValue += 1;\n              clone.oldMax = clone.maxY;\n              clone.oldMin = clone.minY;\n              clone.maxY -= diffValue;\n              clone.minY -= diffValue;\n              clone.style = 'evenValue';\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\n                divers.push(clone);\n              }\n              continue;\n            }\n          }\n          if (clone.minY === fullBbox.minY) {\n            if (clone.maxY > fullBbox.maxY) {\n              let diffMax = fullBbox.maxY - clone.minY;\n              diffMax += 1;\n              clone.oldMax = clone.maxY;\n              clone.maxY -= diffMax;\n              clone.style = 'oddValue';\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\n                divers.push(clone);\n              }\n            }\n          }\n        }\n        rTree.load(divers);\n      },\n    };\n    snapshot.addAction(mergeAction);\n    mergeAction.redo();\n  }\n\n  /**\n   * 删除列号\n   * @param ci\n   * @param number\n   */\n  removeCol(ci, number) {\n    let { rTree, snapshot } = this;\n    let footRange = new RectRange(0, ci, RangeTree.MAX_ROW, RangeTree.MAX_COL);\n    let fullRange = this.getFullColRange(ci, number);\n    let fullBbox = RtreeUtils.rangeToBbox(fullRange);\n    let footBbox = RtreeUtils.rangeToBbox(footRange);\n    let divers = [];\n    let search = [];\n    let mergeAction = {\n      undo: () => {\n        let { length } = divers;\n        for (let i = 0; i < length; i++) {\n          const item = divers[i];\n          rTree.remove(item);\n        }\n        rTree.load(search);\n      },\n      redo: () => {\n        divers = [];\n        search = rTree.search(footBbox);\n        let { length } = search;\n        for (let i = 0; i < length; i++) {\n          const item = search[i];\n          const clone = { ...item };\n          rTree.remove(item);\n          if (clone.minX < fullBbox.minX) {\n            if (clone.maxX < fullBbox.maxX) {\n              let diffMax = clone.maxX - fullBbox.minX;\n              diffMax += 1;\n              clone.oldMax = clone.maxX;\n              clone.maxX -= diffMax;\n              clone.style = 'oddValue';\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\n                divers.push(clone);\n              }\n              continue;\n            }\n            if (clone.maxX > fullBbox.maxX) {\n              let diffMax = fullBbox.maxX - footBbox.minX;\n              diffMax += 1;\n              clone.oldMax = clone.maxX;\n              clone.maxX -= diffMax;\n              clone.style = 'oddValue';\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\n                divers.push(clone);\n              }\n              continue;\n            }\n            if (clone.maxX === fullBbox.maxX) {\n              let diffMax = fullBbox.maxX - footBbox.minX;\n              diffMax += 1;\n              clone.oldMax = clone.maxX;\n              clone.maxX -= diffMax;\n              clone.style = 'oddValue';\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\n                divers.push(clone);\n              }\n              continue;\n            }\n          }\n          if (clone.minX > fullBbox.minX) {\n            if (clone.minX < fullBbox.maxX) {\n              if (clone.maxX > fullBbox.maxX) {\n                let diffMin = clone.minX - fullBbox.minX;\n                let diffMax = fullBbox.maxX - clone.minX;\n                diffMax += diffMin + 1;\n                clone.oldMax = clone.maxX;\n                clone.oldMin = clone.minX;\n                clone.maxX -= diffMax;\n                clone.minX -= diffMin;\n                clone.style = 'evenValue';\n                if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\n                  divers.push(clone);\n                }\n                continue;\n              }\n            }\n            if (clone.minX > fullBbox.maxX) {\n              let diffValue = fullBbox.maxX - fullBbox.minX;\n              diffValue += 1;\n              clone.oldMax = clone.maxX;\n              clone.oldMin = clone.minX;\n              clone.maxX -= diffValue;\n              clone.minX -= diffValue;\n              clone.style = 'evenValue';\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\n                divers.push(clone);\n              }\n              continue;\n            }\n          }\n          if (clone.minX === fullBbox.minX) {\n            if (clone.maxX > fullBbox.maxX) {\n              let diffMax = fullBbox.maxX - clone.minX;\n              diffMax += 1;\n              clone.oldMax = clone.maxX;\n              clone.maxX -= diffMax;\n              clone.style = 'oddValue';\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\n                divers.push(clone);\n              }\n            }\n          }\n        }\n        rTree.load(divers);\n      },\n    };\n    snapshot.addAction(mergeAction);\n    mergeAction.redo();\n  }\n\n  /**\n   * 插入新列时调整区域大小和位置\n   * @param ci\n   * @param number\n   */\n  insertColAfter(ci, number) {\n    const { snapshot } = this;\n    const mergeAction = {\n      undo: () => {\n        this.colAfterShrink(ci, number);\n      },\n      redo: () => {\n        this.colAfterExpand(ci, number);\n      },\n    };\n    snapshot.addAction(mergeAction);\n    mergeAction.redo();\n  }\n\n  /**\n   * 插入新列时调整区域大小和位置\n   * @param ci\n   * @param number\n   */\n  insertColBefore(ci, number) {\n    const { snapshot } = this;\n    const mergeAction = {\n      undo: () => {\n        this.colBeforeShrink(ci, number);\n      },\n      redo: () => {\n        this.colBeforeExpand(ci, number);\n      },\n    };\n    snapshot.addAction(mergeAction);\n    mergeAction.redo();\n  }\n\n  /**\n   * 插入新行时调整区域大小和位置\n   * @param ri\n   * @param number\n   */\n  insertRowAfter(ri, number) {\n    const { snapshot } = this;\n    const mergeAction = {\n      undo: () => {\n        this.rowAfterShrink(ri, number);\n      },\n      redo: () => {\n        this.rowAfterExpand(ri, number);\n      },\n    };\n    snapshot.addAction(mergeAction);\n    mergeAction.redo();\n  }\n\n  /**\n   * 插入新行时调整区域大小和位置\n   * @param ri\n   * @param number\n   */\n  insertRowBefore(ri, number) {\n    const { snapshot } = this;\n    const mergeAction = {\n      undo: () => {\n        this.rowBeforeShrink(ri, number);\n      },\n      redo: () => {\n        this.rowBeforeExpand(ri, number);\n      },\n    };\n    snapshot.addAction(mergeAction);\n    mergeAction.redo();\n  }\n\n  /**\n   * 获取矩形的json数据\n   */\n  getData() {\n    return {\n      merges: this.getAll().map(range => range.toString()),\n    };\n  }\n\n}\n\nexport {\n  Merges,\n};\n","import { Cell } from './Cell';\nimport { SheetUtils } from '../../../utils/SheetUtils';\nimport { Listen } from '../../../lib/Listen';\nimport { Merges } from '../merges/Merges';\nimport { Snapshot } from '../snapshot/Snapshot';\n\nclass Items {\n\n  constructor({ data = [] }) {\n    this.data = data;\n  }\n\n  getItems(ri) {\n    let { data } = this;\n    return data[ri];\n  }\n\n  clear(rectRange, { ignoreCorner = false } = {}) {\n    let { sri, eri } = rectRange;\n    let { sci, eci } = rectRange;\n    let { data } = this;\n    let { snapshot } = this;\n    let { length } = data;\n    let oldItems = [];\n    let effRiLength = eri - sri + 1;\n    let effCiLength = eci - sci + 1;\n    let action = {\n      undo: () => {\n        for (let ri = sri; ri <= eri; ri++) {\n          if (ri >= length) {\n            break;\n          }\n          let oldRowItem = oldItems[ri];\n          let rowItem = data[ri];\n          if (rowItem) {\n            for (let ci = sci; ci <= eci; ci++) {\n              if (ci >= length) {\n                break;\n              }\n              if (ignoreCorner) {\n                let firstRi = ri === sri;\n                let firstCi = ci === sci;\n                if (firstRi && firstCi) {\n                  continue;\n                }\n                rowItem[ci] = oldRowItem[ci];\n              } else {\n                rowItem[ci] = oldRowItem[ci];\n              }\n            }\n          }\n        }\n      },\n      redo: () => {\n        oldItems = new Array(effRiLength);\n        for (let ri = sri; ri <= eri; ri++) {\n          if (ri >= length) {\n            break;\n          }\n          let rowItem = data[ri];\n          if (rowItem) {\n            let oldRowItem = new Array(effCiLength);\n            let { length } = rowItem;\n            for (let ci = sci; ci <= eci; ci++) {\n              if (ci >= length) {\n                break;\n              }\n              if (ignoreCorner) {\n                let firstRi = ri === sri;\n                let firstCi = ci === sci;\n                if (firstRi && firstCi) {\n                  continue;\n                }\n                oldRowItem[ci] = rowItem[ci];\n                rowItem[ci] = undefined;\n              } else {\n                oldRowItem[ci] = rowItem[ci];\n                rowItem[ci] = undefined;\n              }\n            }\n            oldItems[ri] = oldRowItem;\n          }\n        }\n      },\n    };\n    snapshot.addAction(action);\n    action.redo();\n  }\n\n  shift() {\n    return this.data.shift();\n  }\n\n  slice(sri, sci, eri, eci) {\n    const rows = this.data.slice(sri, eri + 1);\n    return rows.map((row) => {\n      if (row) {\n        return row.slice(sci, eci + 1);\n      }\n      return row;\n    });\n  }\n\n  getLength() {\n    return this.data.length;\n  }\n\n  getData() {\n    return this.data;\n  }\n\n  hasItems(ri) {\n    return SheetUtils.isDef(this.getItems(ri));\n  }\n\n  getItemsOrNew(ri) {\n    let { data } = this;\n    let items = data[ri];\n    if (SheetUtils.isUnDef(items)) {\n      items = [];\n      data[ri] = items;\n    }\n    return items;\n  }\n\n}\n\nclass Cells extends Items {\n\n  constructor({\n    snapshot = new Snapshot(),\n    data = [],\n    merges = new Merges(),\n  } = {}) {\n    super({ data });\n    this.snapshot = snapshot;\n    this.merges = merges;\n    this.listen = new Listen();\n  }\n\n  getCellOrNew(ri, ci) {\n    if (ri < 0) {\n      throw new TypeError(`错误的行号${ri}`);\n    }\n    if (ci < 0) {\n      throw new TypeError(`错误的列号${ci}`);\n    }\n    let cell = this.getCell(ri, ci);\n    if (SheetUtils.isUnDef(cell)) {\n      let items = this.getItemsOrNew(ri);\n      cell = new Cell();\n      items[ci] = cell;\n    }\n    return cell;\n  }\n\n  getCell(ri, ci) {\n    let { data } = this;\n    let items = data[ri];\n    if (items) {\n      let item = items[ci];\n      if (item) {\n        if (item instanceof Cell) {\n          return item;\n        }\n        if (SheetUtils.isString(item)) {\n          let config = { text: item };\n          items[ci] = new Cell(config);\n        } else {\n          let config = item.cell ? item.cell : item;\n          items[ci] = new Cell(config);\n        }\n        return items[ci];\n      }\n    }\n    return SheetUtils.Undef;\n  }\n\n  each(callback) {\n    const { data } = this;\n    for (let i = 0, len = data.length; i < len; i++) {\n      let items = data[i];\n      if (items) {\n        for (let j = 0, len = items.length; j < len; j++) {\n          let cell = this.getCell(i, j);\n          callback(cell);\n        }\n      }\n    }\n  }\n\n  getCellOrMergeCell(ri, ci) {\n    const { merges } = this;\n    const merge = merges.getFirstInclude(ri, ci);\n    if (merge) {\n      return this.getCell(merge.sri, merge.sci);\n    }\n    return this.getCell(ri, ci);\n  }\n\n  hasCell(ri, ci) {\n    return SheetUtils.isDef(this.getCell(ri, ci));\n  }\n\n  setCell(ri, ci, cell) {\n    if (ri < 0) {\n      throw new TypeError(`错误的行号${ri}`);\n    }\n    if (ci < 0) {\n      throw new TypeError(`错误的列号${ci}`);\n    }\n    let { listen, snapshot } = this;\n    let oldValue = this.getCell(ri, ci);\n    if (oldValue) {\n      let action = {\n        undo: () => {\n          const items = this.getItems(ri);\n          items[ci] = oldValue;\n          listen.execute('change', {\n            ri, ci, oldValue,\n          });\n        },\n        redo: () => {\n          const items = this.getItemsOrNew(ri);\n          items[ci] = cell;\n          listen.execute('change', {\n            ri, ci, oldValue,\n          });\n        },\n      };\n      snapshot.addAction(action);\n      action.redo();\n    }\n  }\n\n  setCellOrNew(ri, ci, cell) {\n    if (ri < 0) {\n      throw new TypeError(`错误的行号${ri}`);\n    }\n    if (ci < 0) {\n      throw new TypeError(`错误的列号${ci}`);\n    }\n    let { listen, snapshot } = this;\n    let hasCell = this.hasCell(ri, ci);\n    let hasItems = this.hasItems(ri);\n    let oldValue = this.getCell(ri, ci);\n    let action = {\n      undo: () => {\n        if (hasItems) {\n          const items = this.getItems(ri);\n          if (hasCell) {\n            items[ci] = oldValue;\n          } else {\n            items.splice(ci, 1);\n          }\n          listen.execute('change', {\n            ri, ci, oldValue,\n          });\n        } else {\n          const data = this.getData();\n          data.splice(ri, 1);\n          listen.execute('change', {\n            ri, ci, oldValue,\n          });\n        }\n      },\n      redo: () => {\n        if (hasItems) {\n          const items = this.getItems(ri);\n          items[ci] = cell;\n          listen.execute('change', {\n            ri, ci, oldValue,\n          });\n        } else {\n          const items = this.getItemsOrNew(ri);\n          items[ci] = cell;\n          listen.execute('change', {\n            ri, ci, oldValue,\n          });\n        }\n      },\n    };\n    snapshot.addAction(action);\n    action.redo();\n  }\n\n  removeRow(ri) {\n    let { snapshot } = this;\n    let orderValue;\n    let action = {\n      undo: () => {\n        if (orderValue) {\n          this.data.splice(ri, 0, orderValue);\n        }\n      },\n      redo: () => {\n        orderValue = this.data.splice(ri, 1)[0];\n      },\n    };\n    snapshot.addAction(action);\n    action.redo();\n  }\n\n  removeCol(ci) {\n    let { snapshot } = this;\n    let orderValue = [];\n    let action = {\n      undo: () => {\n        let { length } = orderValue;\n        for (let i = 0; i < length; i++) {\n          const value = orderValue[i];\n          const { ri, item } = value;\n          const items = this.data[ri];\n          items.splice(ci, 0, item);\n        }\n      },\n      redo: () => {\n        let { length } = this.data;\n        orderValue = [];\n        for (let ri = 0; ri < length; ri++) {\n          const items = this.data[ri];\n          if (items) {\n            const item = items.splice(ci, 1)[0];\n            orderValue.push({ ri, item });\n          }\n        }\n      },\n    };\n    snapshot.addAction(action);\n    action.redo();\n  }\n\n  insertRowAfter(ri) {\n    let { snapshot } = this;\n    let action = {\n      undo: () => {\n        this.data.splice(ri + 1, 1);\n      },\n      redo: () => {\n        this.data.splice(ri + 1, 0, []);\n      },\n    };\n    snapshot.addAction(action);\n    action.redo();\n  }\n\n  insertColAfter(ci) {\n    let { snapshot } = this;\n    let action = {\n      undo: () => {\n        for (let i = 0, len = this.data.length; i < len; i++) {\n          const items = this.data[i];\n          if (items) {\n            items.splice(ci + 1, 1);\n          }\n        }\n      },\n      redo: () => {\n        for (let i = 0, len = this.data.length; i < len; i++) {\n          const items = this.data[i];\n          if (items) {\n            items.splice(ci + 1, 0, {});\n          }\n        }\n      },\n    };\n    snapshot.addAction(action);\n    action.redo();\n  }\n\n  insertRowBefore(ri) {\n    let { snapshot } = this;\n    let action = {\n      undo: () => {\n        this.items.splice(ri, 1);\n      },\n      redo: () => {\n        this.items.splice(ri, 0, []);\n      },\n    };\n    snapshot.addAction(action);\n    action.redo();\n  }\n\n  insertColBefore(ci) {\n    let { snapshot } = this;\n    let action = {\n      undo: () => {\n        for (let i = 0, len = this.data.length; i < len; i++) {\n          const items = this.data[i];\n          if (items) {\n            items.splice(ci, 1);\n          }\n        }\n      },\n      redo: () => {\n        for (let i = 0, len = this.data.length; i < len; i++) {\n          const items = this.data[i];\n          if (items) {\n            items.splice(ci, 0, {});\n          }\n        }\n      },\n    };\n    snapshot.addAction(action);\n    action.redo();\n  }\n\n}\n\nexport {\n  Cells,\n};\n","import { Cell } from '../../core/table/tablecell/Cell';\r\nimport { SheetUtils } from '../../utils/SheetUtils';\r\nimport { Cells } from '../../core/table/tablecell/Cells';\r\n\r\naddEventListener('message', (event) => {\r\n  const { data } = event;\r\n  const cells = new Cells({\r\n    data\r\n  });\r\n  let total = 0;\r\n  let number = 0;\r\n  cells.each(cell => {\r\n    if (cell) {\r\n      if (cell.hasFormula()) {\r\n        const value = cell.getComputeText();\r\n        if (SheetUtils.isNumber(value)) {\r\n          total += SheetUtils.parseFloat(value);\r\n          number++;\r\n        }\r\n      } else {\r\n        switch (cell.contentType) {\r\n          case Cell.TYPE.NUMBER:\r\n            total += cell.getComputeText();\r\n            number++;\r\n            break;\r\n        }\r\n      }\r\n    }\r\n  });\r\n  postMessage({\r\n    total, number\r\n  });\r\n});\r\n"],"sourceRoot":""}