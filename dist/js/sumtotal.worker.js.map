{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/utils/SheetUtils.js","webpack:///./src/draw/font/BaseFont.js","webpack:///./src/core/xtable/tablecell/CellFont.js","webpack:///./src/draw/XDraw.js","webpack:///./src/draw/Line.js","webpack:///./src/core/xtable/tablecell/Border.js","webpack:///./src/core/xtable/tablecell/CellBorder.js","webpack:///./src/draw/Rect.js","webpack:///./src/core/xtable/tableicon/XIconOffset.js","webpack:///./src/draw/Crop.js","webpack:///./src/core/xtable/tableicon/XIcon.js","webpack:///./src/utils/DateUtils.js","webpack:///./src/core/xtable/XTableTextFormat.js","webpack:///./src/core/xtable/tablecell/RichFont.js","webpack:///./src/core/xtable/tablecell/RichFonts.js","webpack:///./src/formula/Compiler.js","webpack:///./src/formula/Formula.js","webpack:///./src/core/xtable/tablecell/Cell.js","webpack:///./src/task/worker/sumtotal.worker.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","S4","Math","random","toString","substring","alphabets","DATA_TYPE","String","Boolean","Number","Array","Function","Null","Undefined","Promise","GeneratorFunction","AsyncFunction","BigInt","DedicatedWorkerGlobalScope","Date","Un","SheetUtils","test","navigator","userAgent","isEmptyObject","e","this","isUnDef","type","length","trim","obj","getPrototypeOf","parent","str","toLowerCase","arg","sources","forEach","source","keys","v","isArray","isPlainObject","copy","json","JSON","stringify","parse","target","len","item","objOrAry","cb","total","size","val","isNumber","parseFloat","parseInt","index","idx","ret","charCodeAt","expoNet","src","x","y","charAt","indexAt","stringAt","xn","yn","expr2xy","xy2expr","min","range","window","getSelection","selectAllChildren","collapseToEnd","isBlank","now","width","innerWidth","height","innerHeight","document","exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","element","el","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","webkitIsFullScreen","mozFullScreen","msFullscreenElement","fullscreenElement","explorer","indexOf","version","match","array","isString","replace","EMPTY","num","fixed","toFixed","defaultValue","self","condition","establish","otherwise","likeArray","slice","Nul","Undef","undefined","noop","BaseFont","draw","ruler","attr","align","ALIGN","center","padding","verticalAlign","VERTICAL_ALIGN","top","bottom","left","right","TEXT_WRAP","OVER_FLOW","WORD_WRAP","TRUNCATE","TEXT_DIRECTION","HORIZONTAL","VERTICAL","ANGLE","ANGLE_BAR","DEFAULT_FONT_ATTR","color","bold","italic","strikethrough","underline","angle","textWrap","direction","DEFAULT_RICH_ATTR","DEFAULT_RICH_ITEM_ATTR","CellFont","scaleAdapter","DPR","inWorker","devicePixelRatio","LINE_WIDTH_LOW","round","LINE_WIDTH_MEDIUM","LINE_WIDTH_HIGH","LINE_PIXEL_OFFSET","Base","canvas","ctx","getContext","px","dpr","srcPx","stylePx","ceil","trunc","PI","options","style","CorsLine","lineWidthType","LINE_WIDTH_TYPE","low","lineColor","medium","high","sx","sy","ex","ey","lineWidth","strokeStyle","polyStroke","xys","getOffsetX","getOffsetY","TypeError","corsLine","linePx","pixel","offsetX","offsetY","interpolation","beginPath","moveTo","lineTo","stroke","fill","fillRect","radian","dash","text","measureText","save","restore","clip","setLineDash","scale","translate","deg","rotate","XDraw","fillText","path","polyInFill","points","w","h","rect","sw","sh","tx","ty","tw","th","drawImage","LINE_TYPE","DoubleLine","widthType","spacing","leftShow","topShow","rightShow","bottomShow","iFMerge","iFMergeFirstRow","iFMergeLastRow","iFMergeFirstCol","iFMergeLastCol","row","col","pos","external","ifMerge","firstRow","lastRow","firstCol","lastCol","sTopLeftCorner","sTop","sBottom","eBottomLeftCorner","eBottom","eTop","sLeft","sRight","eTopRightCorner","eRight","eLeft","sTopRightCorner","eBottomRightCorner","sBottomLeftCorner","internal","setLineColor","setLineWidthType","handleExternal","handleInternal","horizonLine","verticalLine","zIndexID","Border","zIndex","display","getZIndex","border","origin","CellBorder","setBDisplay","setLDisplay","setTDisplay","setRDisplay","setDisplay","setBColor","setLColor","setTColor","setRColor","setColor","setBWidthType","setLWidthType","setTWidthType","setRWidthType","setWidthType","setBType","setLType","setTType","setRType","setType","setZIndex","Rect","other","XIconOffset","Crop","offset","XIcon","vertical","ICON_VERTICAL","CENTER","horizontal","ICON_HORIZONTAL","RIGHT","ICON_TYPE","image","iconFocus","onDraw","onLeave","onMove","onDown","onEnter","icons","instances","icon","push","iconHorizontal","iconVertical","iconOffsetX","iconOffsetY","iconWidth","iconHeight","rectX","rectY","rectWidth","rectHeight","py","LEFT","TOP","BOTTOM","load","sync","Image","loadImg","complete","onload","onerror","console","error","drawCustom","positionRect","position","include","includeRect","crop","open","fillStyle","close","native","location","inRectPosition","activate","ICON_EVENT_TYPE","MOUSE_DOWN","includePoint","setActivate","MOUSE_MOVE","callback","custom","DateUtils","fmt","date","getMonth","getDate","getHours","getMinutes","getSeconds","floor","S","getMilliseconds","resultYear","exec","yearFormatPart","yearVal","getFullYear","substr","k","res","RegExp","Val","formatPart","replaceVal","result","parserToDate","dateText","format","defaultVal","reg","year","month","day","hours","minutes","seconds","milliseconds","j","oneChar","onePart","onePartReg","dataInfo","toExponential","isFraction","split","dateFormat","RichFont","option","clone","RichFonts","rich","map","font","plain","item1","item2","equals","Functions","functions","toLocaleString","func","Assembly","assembly","endsWith","op","Tokenizer","syntaxCheck","input","OPERATOR","NUMBERS","LETTERS","bracketsStack","current","tokens","char","SPACE","next","last","brackets","pop","syntax","sQuotesStack","dQuotesStack","callStack","arrayStack","ignoreArray","token","ignoreFunc","skipIgnoreToken","dir","checkArray","local","checkValue","checkOperator","checkFunction","Compiler","writer","groupStack","ignore","opIf","opAdd","opMul","opCommon","opRel","opNew","opCell","function","number","eofToken","nextToken","backToken","includes","compileIfge","isSkipNextToken","getInstruct","compileAdd","operator","reduceGroup","writeOperator","compileMul","compileCommon","compileRel","compileArray","compileFunction","addGroup","popGroup","compilePushValue","increaseGroup","writeString","writeNumber","writeOperand","Evaluation","instruct","memory","newArray","invoke","pushSRegexp","pushNRegexp","pushORegexp","ificmpge","ificmpgt","ifge","ifgt","ifeq","ifne","add","sub","mul","div","mod","power","rel","link","uni","common","group","pushS","pushN","pushO","b","a","pow","reverse","getFunction","apply","Compile","startsWith","tokenizer","lexical","compile","Instruct","inst","eval","Formula","expr","content","Cell","background","borderAttr","fontAttr","contentWidth","contentHeight","contentType","TYPE","STRING","newInstances","formula","richText","formatText","setContentType","setExpr","setRich","setContentWidth","getExpr","NUMBER","DATE_TIME","isDate","RICH_TEXT","getComputeText","hasExpr","getValue","XTableFormat","getRich","getFormatText","addEventListener","event","data","cell","postMessage"],"mappings":"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","file":"js/sumtotal.worker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/* global navigator document window self */\r\nfunction S4() {\r\n  // eslint-disable-next-line no-bitwise\r\n  return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\r\n}\r\n\r\nconst alphabets = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];\r\n\r\nconst DATA_TYPE = {\r\n  String: 1,\r\n  Boolean: 2,\r\n  Number: 3,\r\n  Object: 4,\r\n  Array: 5,\r\n  Function: 6,\r\n  Null: 7,\r\n  Undefined: 8,\r\n  Promise: 9,\r\n  GeneratorFunction: 10,\r\n  AsyncFunction: 11,\r\n  BigInt: 12,\r\n  Symbol: 13,\r\n  DedicatedWorkerGlobalScope: 14,\r\n  Date: 15,\r\n  Un: 0,\r\n};\r\n\r\nclass SheetUtils {\r\n\r\n  static isWindows() {\r\n    return /windows|win32/i.test(navigator.userAgent);\r\n  }\r\n\r\n  static isMac() {\r\n    return /macintosh|mac os x/i.test(navigator.userAgent);\r\n  }\r\n\r\n  static isNotEmptyObject(object) {\r\n    return !SheetUtils.isEmptyObject(object);\r\n  }\r\n\r\n  static isEmptyObject(object) {\r\n    // eslint-disable-next-line no-restricted-syntax\r\n    for (const key in object) {\r\n      // eslint-disable-next-line no-prototype-builtins\r\n      if (object.hasOwnProperty(key)) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  static isUnDef(e) {\r\n    return e === undefined || e === null;\r\n  }\r\n\r\n  static isNotUnDef(e) {\r\n    return !this.isUnDef(e);\r\n  }\r\n\r\n  static isNumber(e) {\r\n    return /^(-?\\d+.\\d+)$|^(-?\\d+)$/.test(e);\r\n  }\r\n\r\n  static isFraction(e) {\r\n    return /^\\d+\\/\\d+$/.test(e);\r\n  }\r\n\r\n  static isDate(e) {\r\n    return SheetUtils.type(e) === DATA_TYPE.Date;\r\n  }\r\n\r\n  static isFunction(e) {\r\n    const type = SheetUtils.type(e);\r\n    return type === DATA_TYPE.Function;\r\n  }\r\n\r\n  static isArray(e) {\r\n    return SheetUtils.type(e) === DATA_TYPE.Array;\r\n  }\r\n\r\n  static isLikeArray(e) {\r\n    if (SheetUtils.isUnDef(e)) {\r\n      return false;\r\n    }\r\n    return typeof e.length === 'number';\r\n  }\r\n\r\n  static isBlank(s) {\r\n    if (SheetUtils.isUnDef(s)) {\r\n      return true;\r\n    }\r\n    return s.toString().trim() === '';\r\n  }\r\n\r\n  static isPlainObject(obj) {\r\n    if (SheetUtils.isUnDef(obj)) {\r\n      return false;\r\n    }\r\n    return Object.getPrototypeOf(obj) === Object.getPrototypeOf({});\r\n  }\r\n\r\n  static isString(obj) {\r\n    return SheetUtils.type(obj) === DATA_TYPE.String;\r\n  }\r\n\r\n  static isChildType(obj, parent) {\r\n    return obj instanceof parent;\r\n  }\r\n\r\n  static toLowCase(str) {\r\n    return str.toLowerCase();\r\n  }\r\n\r\n  static type(arg) {\r\n    const type = Object.prototype.toString.call(arg);\r\n    switch (type) {\r\n      case '[object Null]':\r\n        return DATA_TYPE.Null;\r\n      case '[object Object]':\r\n        return DATA_TYPE.Object;\r\n      case '[object Undefined]':\r\n        return DATA_TYPE.Undefined;\r\n      case '[object String]':\r\n        return DATA_TYPE.String;\r\n      case '[object Boolean]':\r\n        return DATA_TYPE.Boolean;\r\n      case '[object Number]':\r\n        return DATA_TYPE.Number;\r\n      case '[object Function]':\r\n        return DATA_TYPE.Function;\r\n      case '[object Array]':\r\n        return DATA_TYPE.Array;\r\n      case '[object Promise]':\r\n        return DATA_TYPE.Promise;\r\n      case '[object GeneratorFunction]':\r\n        return DATA_TYPE.GeneratorFunction;\r\n      case '[object AsyncFunction]':\r\n        return DATA_TYPE.AsyncFunction;\r\n      case '[object BigInt]':\r\n        return DATA_TYPE.BigInt;\r\n      case '[object Symbol]':\r\n        return DATA_TYPE.Symbol;\r\n      case '[object Date]':\r\n        return DATA_TYPE.Date;\r\n      case '[object DedicatedWorkerGlobalScope]':\r\n        return DATA_TYPE.DedicatedWorkerGlobalScope;\r\n      default:\r\n        return DATA_TYPE.Un;\r\n    }\r\n  }\r\n\r\n  static copy(object = {}, ...sources) {\r\n    if (SheetUtils.isUnDef(object)) {\r\n      return {};\r\n    }\r\n    if (SheetUtils.isUnDef(sources) || sources.length === 0) {\r\n      return object;\r\n    }\r\n    sources.forEach((source) => {\r\n      if (SheetUtils.isUnDef(source)) return;\r\n      Object.keys(source).forEach((key) => {\r\n        const v = source[key];\r\n        if (typeof v === 'string' || typeof v === 'number' || typeof v === 'boolean') {\r\n          object[key] = v;\r\n        } else if (typeof v !== 'function' && !Array.isArray(v) && SheetUtils.isPlainObject(v)) {\r\n          object[key] = object[key] || {};\r\n          SheetUtils.copy(object[key], v);\r\n        } else {\r\n          object[key] = v;\r\n        }\r\n      });\r\n    });\r\n    return object;\r\n  }\r\n\r\n  static cloneDeep(object) {\r\n    const json = JSON.stringify(object);\r\n    return JSON.parse(json);\r\n  }\r\n\r\n  static extends(target, ...src) {\r\n    for (let i = 0, len = src.length; i < len; i++) {\r\n      const item = src[i];\r\n      for (let key in item) {\r\n        if (item.hasOwnProperty(key)) {\r\n          const value = item[key];\r\n          if (value) {\r\n            target[key] = value;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return target;\r\n  }\r\n\r\n  static sum(objOrAry, cb = value => value) {\r\n    let total = 0;\r\n    let size = 0;\r\n    Object.keys(objOrAry).forEach((key) => {\r\n      total += cb(objOrAry[key], key);\r\n      size += 1;\r\n    });\r\n    return [total, size];\r\n  }\r\n\r\n  static parseFloat(val) {\r\n    if (SheetUtils.isNumber(val)) return parseFloat(val);\r\n    return 0;\r\n  }\r\n\r\n  static parseInt(val) {\r\n    if (SheetUtils.isNumber(val)) return parseInt(val, 10);\r\n    return 0;\r\n  }\r\n\r\n  static stringAt(index) {\r\n    let str = '';\r\n    let idx = index;\r\n    while (idx >= alphabets.length) {\r\n      idx /= alphabets.length;\r\n      idx -= 1;\r\n      str += alphabets[parseInt(idx, 10) % alphabets.length];\r\n    }\r\n    const last = index % alphabets.length;\r\n    str += alphabets[last];\r\n    return str;\r\n  }\r\n\r\n  static indexAt(str) {\r\n    let ret = 0;\r\n    for (let i = 0; i < str.length - 1; i += 1) {\r\n      const idx = str.charCodeAt(i) - 65;\r\n      const expoNet = str.length - 1 - i;\r\n      ret += (alphabets.length ** expoNet) + (alphabets.length * idx);\r\n    }\r\n    ret += str.charCodeAt(str.length - 1) - 65;\r\n    return ret;\r\n  }\r\n\r\n  static expr2xy(src) {\r\n    let x = '';\r\n    let y = '';\r\n    for (let i = 0; i < src.length; i += 1) {\r\n      if (src.charAt(i) >= '0' && src.charAt(i) <= '9') {\r\n        y += src.charAt(i);\r\n      } else {\r\n        x += src.charAt(i);\r\n      }\r\n    }\r\n    return [SheetUtils.indexAt(x), parseInt(y, 10) - 1];\r\n  }\r\n\r\n  static xy2expr(x, y) {\r\n    return `${SheetUtils.stringAt(x)}${y + 1}`;\r\n  }\r\n\r\n  static expr2expr(src, xn, yn) {\r\n    const [x, y] = SheetUtils.expr2xy(src);\r\n    return SheetUtils.xy2expr(x + xn, y + yn);\r\n  }\r\n\r\n  static minIf(v, min) {\r\n    if (v < min) return min;\r\n    return v;\r\n  }\r\n\r\n  static keepLastIndex(obj) {\r\n    const range = window.getSelection();\r\n    range.selectAllChildren(obj);\r\n    range.collapseToEnd();\r\n  }\r\n\r\n  static trim(s) {\r\n    if (this.isBlank(s)) return '';\r\n    return s.trim();\r\n  }\r\n\r\n  static now() {\r\n    return Date.now().toString();\r\n  }\r\n\r\n  static viewPort() {\r\n    return {\r\n      width: window.innerWidth,\r\n      height: window.innerHeight,\r\n    };\r\n  }\r\n\r\n  static exitFullscreen() {\r\n    if (document.exitFullscreen) {\r\n      document.exitFullscreen();\r\n    } else if (document.msExitFullscreen) {\r\n      document.msExitFullscreen();\r\n    } else if (document.mozCancelFullScreen) {\r\n      document.mozCancelFullScreen();\r\n    } else if (document.webkitExitFullscreen) {\r\n      document.webkitExitFullscreen();\r\n    }\r\n  }\r\n\r\n  static fullScreen(element) {\r\n    if (element.el) {\r\n      element = element.el;\r\n    }\r\n    if (element.requestFullscreen) {\r\n      element.requestFullscreen();\r\n    } else if (element.msRequestFullscreen) {\r\n      element.msRequestFullscreen();\r\n    } else if (element.mozRequestFullScreen) {\r\n      element.mozRequestFullScreen();\r\n    } else if (element.webkitRequestFullscreen) {\r\n      element.webkitRequestFullscreen();\r\n    }\r\n  }\r\n\r\n  static isFull() {\r\n    return !!(document.webkitIsFullScreen || document.mozFullScreen\r\n      || document.msFullscreenElement || document.fullscreenElement);\r\n  }\r\n\r\n  static uuid() {\r\n    return (`${S4() + S4()}${S4()}${S4()}${S4()}${S4()}${S4()}${S4()}`);\r\n  }\r\n\r\n  static getExplorerInfo() {\r\n    const explorer = window.navigator.userAgent.toLowerCase();\r\n    // firefox\r\n    if (explorer.indexOf('firefox') >= 0) {\r\n      const ver = explorer.match(/firefox\\/([\\d.]+)/)[1];\r\n      return { type: 'Firefox', version: ver };\r\n    }\r\n    // Chrome\r\n    if (explorer.indexOf('chrome') >= 0) {\r\n      const ver = explorer.match(/chrome\\/([\\d.]+)/)[1];\r\n      return { type: 'Chrome', version: ver };\r\n    }\r\n    // Opera\r\n    if (explorer.indexOf('opera') >= 0) {\r\n      const ver = explorer.match(/opera.([\\d.]+)/)[1];\r\n      return { type: 'Opera', version: ver };\r\n    }\r\n    // Safari\r\n    if (explorer.indexOf('safari') >= 0) {\r\n      const ver = explorer.match(/version\\/([\\d.]+)/)[1];\r\n      return { type: 'Safari', version: ver };\r\n    }\r\n    // ie\r\n    if (explorer.indexOf('msie') >= 0) {\r\n      const ver = explorer.match(/msie ([\\d.]+)/)[1];\r\n      return { type: 'IE', version: ver };\r\n    }\r\n    // undefined\r\n    return undefined;\r\n  }\r\n\r\n  static arrayLast(array) {\r\n    return array[array.length - 1];\r\n  }\r\n\r\n  static arrayHead(array) {\r\n    return array[0];\r\n  }\r\n\r\n  static blankClear(value) {\r\n    if (SheetUtils.isString(value)) {\r\n      return value.replace(/\\s*/g, SheetUtils.EMPTY);\r\n    }\r\n    return value;\r\n  }\r\n\r\n  static equals(src, target) {\r\n    if (SheetUtils.isUnDef(src)) {\r\n      return false;\r\n    }\r\n    if (SheetUtils.isUnDef(target)) {\r\n      return false;\r\n    }\r\n    return JSON.stringify(src) === JSON.stringify(target);\r\n  }\r\n\r\n  static toFixed(num, fixed) {\r\n    if (num.toString().indexOf('.') > -1) {\r\n      return num.toFixed(fixed);\r\n    }\r\n    return num;\r\n  }\r\n\r\n  static safeValue(value, defaultValue = '') {\r\n    return SheetUtils.isUnDef(value) ? defaultValue : value;\r\n  }\r\n\r\n  static inWorker() {\r\n    // eslint-disable-next-line no-restricted-globals\r\n    const type = SheetUtils.type(self);\r\n    return type === DATA_TYPE.DedicatedWorkerGlobalScope;\r\n  }\r\n\r\n  static if(condition, establish, otherwise) {\r\n    return condition ? establish() : otherwise();\r\n  }\r\n\r\n  static slice(likeArray) {\r\n    return Array.prototype.slice.call(likeArray);\r\n  }\r\n\r\n  static clearBlank(str) {\r\n    return str.replace(/\\s/g, '');\r\n  }\r\n\r\n}\r\n\r\nSheetUtils.EMPTY = '';\r\nSheetUtils.Nul = null;\r\nSheetUtils.Undef = undefined;\r\nSheetUtils.noop = () => {};\r\nSheetUtils.DATA_TYPE = DATA_TYPE;\r\n\r\nexport {\r\n  SheetUtils,\r\n};\r\n","class BaseFont {\r\n\r\n  constructor({\r\n    draw, ruler, attr,\r\n  }) {\r\n    this.draw = draw;\r\n    this.attr = attr;\r\n    this.ruler = ruler;\r\n  }\r\n\r\n  setRuler(ruler) {\r\n    this.ruler = ruler;\r\n  }\r\n\r\n  getAlignPadding() {\r\n    if (this.attr.align === BaseFont.ALIGN.center) {\r\n      return 0;\r\n    }\r\n    return this.attr.padding;\r\n  }\r\n\r\n  getVerticalAlignPadding() {\r\n    if (this.attr.verticalAlign === BaseFont.VERTICAL_ALIGN.center) {\r\n      return 0;\r\n    }\r\n    return this.attr.padding;\r\n  }\r\n\r\n}\r\n\r\nBaseFont.VERTICAL_ALIGN = {\r\n  top: 'top',\r\n  center: 'middle',\r\n  bottom: 'bottom',\r\n};\r\nBaseFont.ALIGN = {\r\n  left: 'left',\r\n  center: 'center',\r\n  right: 'right',\r\n};\r\nBaseFont.TEXT_WRAP = {\r\n  OVER_FLOW: 1,\r\n  WORD_WRAP: 2,\r\n  TRUNCATE: 3,\r\n};\r\nBaseFont.TEXT_DIRECTION = {\r\n  HORIZONTAL: 'horizontal',\r\n  VERTICAL: 'vertical',\r\n  ANGLE: 'angle',\r\n  ANGLE_BAR: 'bar',\r\n};\r\nBaseFont.DEFAULT_FONT_ATTR = {\r\n  name: 'Arial',\r\n  size: 14,\r\n  color: 'rgb(0,0,0)',\r\n  bold: false,\r\n  italic: false,\r\n  strikethrough: false,\r\n  underline: false,\r\n  angle: 0,\r\n  padding: 8,\r\n  align: BaseFont.ALIGN.left,\r\n  textWrap: BaseFont.TEXT_WRAP.TRUNCATE,\r\n  verticalAlign: BaseFont.VERTICAL_ALIGN.center,\r\n  direction: BaseFont.TEXT_DIRECTION.HORIZONTAL,\r\n};\r\nBaseFont.DEFAULT_RICH_ATTR = {\r\n  angle: 0,\r\n  padding: 8,\r\n  align: BaseFont.ALIGN.left,\r\n  textWrap: BaseFont.TEXT_WRAP.TRUNCATE,\r\n  verticalAlign: BaseFont.VERTICAL_ALIGN.center,\r\n  direction: BaseFont.TEXT_DIRECTION.HORIZONTAL,\r\n};\r\nBaseFont.DEFAULT_RICH_ITEM_ATTR = {\r\n  name: 'Arial',\r\n  size: 14,\r\n  color: 'rgb(0,0,0)',\r\n  bold: false,\r\n  italic: false,\r\n  strikethrough: false,\r\n  underline: false,\r\n};\r\n\r\nexport {\r\n  BaseFont,\r\n};\r\n","import { BaseFont } from '../../../draw/font/BaseFont';\n\n/**\n *  CellFont\n *  @author jerry\n */\nclass CellFont {\n\n  /**\n   * CellFont\n   * @param align\n   * @param verticalAlign\n   * @param textWrap\n   * @param strikethrough\n   * @param underline\n   * @param color\n   * @param name\n   * @param size\n   * @param bold\n   * @param italic\n   * @param angle\n   * @param direction\n   * @param padding\n   */\n  constructor({\n    align = BaseFont.ALIGN.left,\n    verticalAlign = BaseFont.VERTICAL_ALIGN.center,\n    textWrap = BaseFont.TEXT_WRAP.TRUNCATE,\n    strikethrough = false,\n    underline = false,\n    color = 'rgb(0,0,0)',\n    name = 'Arial',\n    size = 14,\n    bold = false,\n    italic = false,\n    angle = 0,\n    direction = BaseFont.TEXT_DIRECTION.HORIZONTAL,\n    padding = 5,\n  }) {\n    this.align = align;\n    this.verticalAlign = verticalAlign;\n    this.textWrap = textWrap;\n    this.strikethrough = strikethrough;\n    this.underline = underline;\n    this.color = color;\n    this.name = name;\n    this.size = size;\n    this.bold = bold;\n    this.italic = italic;\n    this.direction = direction;\n    this.angle = angle;\n    this.padding = padding;\n  }\n\n  clone() {\n    const {\n      align,\n      verticalAlign,\n      textWrap,\n      strikethrough,\n      underline,\n      color,\n      name,\n      size,\n      bold,\n      italic,\n      angle,\n      direction,\n      padding,\n    } = this;\n    return new CellFont({\n      align,\n      verticalAlign,\n      textWrap,\n      strikethrough,\n      underline,\n      color,\n      name,\n      size,\n      bold,\n      italic,\n      angle,\n      direction,\n      padding,\n    });\n  }\n\n}\nCellFont.scaleAdapter = null;\n\nexport { CellFont };\n","/* global devicePixelRatio */\r\nimport { SheetUtils } from '../utils/SheetUtils';\r\n\r\nlet DPR = SheetUtils.inWorker() ? 1 : devicePixelRatio;\r\nlet LINE_WIDTH_LOW = Math.round(DPR);\r\nlet LINE_WIDTH_MEDIUM = LINE_WIDTH_LOW + 2;\r\nlet LINE_WIDTH_HIGH = LINE_WIDTH_MEDIUM + 2;\r\nlet LINE_PIXEL_OFFSET = LINE_WIDTH_LOW / 2;\r\n\r\nclass Base {\r\n\r\n  static srcPx(px) {\r\n    return px / this.dpr();\r\n  }\r\n\r\n  static cssPx(px) {\r\n    return this.srcPx(this.stylePx(px));\r\n  }\r\n\r\n  static stylePx(px) {\r\n    return this.round(px * this.dpr());\r\n  }\r\n\r\n  static round(val) {\r\n    return Math.round(val);\r\n  }\r\n\r\n  static ceil(val) {\r\n    return Math.ceil(val);\r\n  }\r\n\r\n  static trunc(val) {\r\n    return Math.trunc(val);\r\n  }\r\n\r\n  static radian(angle) {\r\n    return -angle * (Math.PI / 180);\r\n  }\r\n\r\n  static dpr() {\r\n    return DPR;\r\n  }\r\n\r\n  static refresh(val = 1) {\r\n    DPR = SheetUtils.inWorker() ? val : devicePixelRatio;\r\n    LINE_WIDTH_LOW = Math.round(DPR);\r\n    LINE_WIDTH_MEDIUM = LINE_WIDTH_LOW + 2;\r\n    LINE_WIDTH_HIGH = LINE_WIDTH_MEDIUM + 2;\r\n    LINE_PIXEL_OFFSET = LINE_WIDTH_LOW / 2;\r\n  }\r\n\r\n  constructor(canvas) {\r\n    this.canvas = canvas;\r\n    this.ctx = canvas.getContext('2d');\r\n  }\r\n\r\n  attr(options) {\r\n    for (const key in options) {\r\n      if (options.hasOwnProperty(key)) {\r\n        let value = options[key];\r\n        if (typeof value === 'string' || value instanceof String) {\r\n          value = value.trim();\r\n        }\r\n        if (this.ctx[key] !== value) {\r\n          this.ctx[key] = value;\r\n        }\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  resize(width, height) {\r\n    const { canvas } = this;\r\n    canvas.width = Base.stylePx(width);\r\n    canvas.height = Base.stylePx(height);\r\n    canvas.style.width = `${canvas.width / Base.dpr()}px`;\r\n    canvas.style.height = `${canvas.height / Base.dpr()}px`;\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nclass Wrapping extends Base {\r\n\r\n  constructor(canvas) {\r\n    super(canvas);\r\n    this.dash = [];\r\n  }\r\n\r\n  beginPath() {\r\n    const { ctx } = this;\r\n    ctx.beginPath();\r\n    return this;\r\n  }\r\n\r\n  measureText(text) {\r\n    const { ctx } = this;\r\n    return ctx.measureText(text);\r\n  }\r\n\r\n  save() {\r\n    const { ctx } = this;\r\n    ctx.save();\r\n    return this;\r\n  }\r\n\r\n  restore() {\r\n    const { ctx } = this;\r\n    ctx.restore();\r\n    return this;\r\n  }\r\n\r\n  fill() {\r\n    const { ctx } = this;\r\n    ctx.fill();\r\n    return this;\r\n  }\r\n\r\n  clip() {\r\n    const { ctx } = this;\r\n    ctx.clip();\r\n    return this;\r\n  }\r\n\r\n  setLineDash(dash = []) {\r\n    const { ctx } = this;\r\n    this.dash = dash;\r\n    ctx.setLineDash(dash);\r\n    return this;\r\n  }\r\n\r\n  scale(x, y) {\r\n    const { ctx } = this;\r\n    ctx.scale(x, y);\r\n    return this;\r\n  }\r\n\r\n  translate(x, y) {\r\n    const { ctx } = this;\r\n    ctx.translate(x, y);\r\n    return this;\r\n  }\r\n\r\n  rotate(deg) {\r\n    const { ctx } = this;\r\n    ctx.rotate(deg);\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nclass Extends extends Wrapping {\r\n\r\n  polyStroke(interpolation = xys => xys, ...xys) {\r\n    const { ctx } = this;\r\n    if (xys.length > 1) {\r\n      this.beginPath();\r\n      const [x, y] = interpolation(xys[0]);\r\n      ctx.moveTo(x, y);\r\n      for (let i = 1, len = xys.length; i < len; i += 1) {\r\n        const [x, y] = interpolation(xys[i]);\r\n        ctx.lineTo(x, y);\r\n      }\r\n      ctx.stroke();\r\n    }\r\n  }\r\n\r\n  polyInFill(interpolation = xys => xys, ...xys) {\r\n    const { ctx } = this;\r\n    if (xys.length > 1) {\r\n      this.beginPath();\r\n      const [x, y] = interpolation(xys[0]);\r\n      ctx.moveTo(x, y);\r\n      for (let i = 1, len = xys.length; i < len; i += 1) {\r\n        const [x, y] = interpolation(xys[i]);\r\n        ctx.lineTo(x, y);\r\n      }\r\n      ctx.fill();\r\n    }\r\n  }\r\n\r\n  fullRect() {\r\n    const { canvas } = this;\r\n    const { width, height } = canvas;\r\n    this.ctx.fillRect(0, 0, width, height);\r\n    return this;\r\n  }\r\n\r\n  rotate(angle) {\r\n    super.rotate(Base.radian(angle));\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nclass Position extends Extends {\r\n\r\n  constructor(canvas) {\r\n    super(canvas);\r\n    this.offsetX = 0;\r\n    this.offsetY = 0;\r\n  }\r\n\r\n  offset(x, y) {\r\n    this.offsetX = x;\r\n    this.offsetY = y;\r\n  }\r\n\r\n  getOffsetX() {\r\n    return this.offsetX;\r\n  }\r\n\r\n  getOffsetY() {\r\n    return this.offsetY;\r\n  }\r\n\r\n  fillText() {\r\n    throw TypeError('child impl');\r\n  }\r\n\r\n  fillRect() {\r\n    throw TypeError('child impl');\r\n  }\r\n\r\n  rect() {\r\n    throw TypeError('child impl');\r\n  }\r\n\r\n  drawImage() {\r\n    throw TypeError('child impl');\r\n  }\r\n\r\n}\r\n\r\nclass BaseLine extends Position {\r\n\r\n  line(...xys) {\r\n    this.polyStroke((xys) => {\r\n      const [x, y] = xys;\r\n      return [this.linePx(Base.round(x + this.getOffsetX())),\r\n        this.linePx(Base.round(y + this.getOffsetY()))];\r\n    }, ...xys);\r\n    return this;\r\n  }\r\n\r\n  linePx(pixel) {\r\n    const { ctx } = this;\r\n    const {\r\n      lineWidth,\r\n    } = ctx;\r\n    return lineWidth % 2 === 0\r\n      ? pixel : pixel - 0.5;\r\n  }\r\n\r\n}\r\n\r\nclass CorsLine extends BaseLine {\r\n\r\n  static offsetToLineInside(val) {\r\n    return LINE_WIDTH_LOW > 1\r\n      ? val - LINE_PIXEL_OFFSET\r\n      : val - LINE_WIDTH_LOW;\r\n  }\r\n\r\n  static getLineWidthTypePx(type) {\r\n    switch (type) {\r\n      case CorsLine.LINE_WIDTH_TYPE.medium:\r\n        return LINE_WIDTH_MEDIUM;\r\n      case CorsLine.LINE_WIDTH_TYPE.low:\r\n        return LINE_WIDTH_LOW;\r\n      case CorsLine.LINE_WIDTH_TYPE.high:\r\n        return LINE_WIDTH_HIGH;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  constructor(canvas) {\r\n    super(canvas);\r\n    this.lineWidthType = CorsLine.LINE_WIDTH_TYPE.low;\r\n    this.lineColor = 'rgb(0,0,0)';\r\n  }\r\n\r\n  corsLine([sx, sy], [ex, ey]) {\r\n    const {\r\n      lineWidthType, lineColor,\r\n    } = this;\r\n    let lineWidth = LINE_WIDTH_LOW;\r\n    switch (lineWidthType) {\r\n      case CorsLine.LINE_WIDTH_TYPE.medium:\r\n        lineWidth = LINE_WIDTH_MEDIUM;\r\n        break;\r\n      case CorsLine.LINE_WIDTH_TYPE.low:\r\n        lineWidth = LINE_WIDTH_LOW;\r\n        break;\r\n      case CorsLine.LINE_WIDTH_TYPE.high:\r\n        lineWidth = LINE_WIDTH_HIGH;\r\n        break;\r\n    }\r\n    this.attr({\r\n      strokeStyle: lineColor,\r\n      lineWidth,\r\n    });\r\n    this.polyStroke((xys) => {\r\n      const [x, y] = xys;\r\n      return [\r\n        Base.round(x + this.getOffsetX()) - LINE_PIXEL_OFFSET,\r\n        Base.round(y + this.getOffsetY()) - LINE_PIXEL_OFFSET,\r\n      ];\r\n    }, [sx, sy], [ex, ey]);\r\n  }\r\n\r\n  setLineColor(color) {\r\n    this.lineColor = color;\r\n  }\r\n\r\n  setLineWidthType(type) {\r\n    this.lineWidthType = type;\r\n  }\r\n\r\n  horizonLine([sx, sy], [ex, ey]) {\r\n    if (sy !== ey) {\r\n      throw new TypeError('Error Horizon Line');\r\n    }\r\n    this.corsLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n  verticalLine([sx, sy], [ex, ey]) {\r\n    if (sx !== ex) {\r\n      throw new TypeError('Error Vertical Line');\r\n    }\r\n    this.corsLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n}\r\nCorsLine.LINE_WIDTH_TYPE = {\r\n  low: 'low',\r\n  medium: 'medium',\r\n  high: 'high',\r\n};\r\n\r\nclass XDraw extends CorsLine {\r\n\r\n  fillText(text, x, y) {\r\n    x += this.getOffsetX();\r\n    y += this.getOffsetY();\r\n    this.ctx.fillText(text, XDraw.round(x), XDraw.round(y));\r\n    return this;\r\n  }\r\n\r\n  fillPath(path) {\r\n    this.polyInFill((xys) => {\r\n      const { x, y } = xys;\r\n      return [Base.round(x + this.getOffsetX()), Base.round(y + this.getOffsetY())];\r\n    }, ...path.points);\r\n    return this;\r\n  }\r\n\r\n  fillRect(x, y, w, h) {\r\n    x += this.getOffsetX();\r\n    y += this.getOffsetY();\r\n    this.ctx.fillRect(XDraw.round(x), XDraw.round(y),\r\n      XDraw.round(w), XDraw.round(h));\r\n    return this;\r\n  }\r\n\r\n  rect(x, y, w, h) {\r\n    x += this.getOffsetX();\r\n    y += this.getOffsetY();\r\n    this.ctx.rect(XDraw.round(x), XDraw.round(y),\r\n      XDraw.round(w), XDraw.round(h));\r\n    return this;\r\n  }\r\n\r\n  copyImage(sx, sy, sw, sh, tx, ty, tw, th) {\r\n    const { ctx } = this;\r\n    tx += this.getOffsetX();\r\n    sx += this.getOffsetX();\r\n    ty += this.getOffsetY();\r\n    sy += this.getOffsetY();\r\n    ctx.drawImage(this.canvas,\r\n      XDraw.round(sx), XDraw.round(sy),\r\n      XDraw.round(sw), XDraw.round(sh),\r\n      XDraw.round(tx), XDraw.round(ty),\r\n      XDraw.round(tw), XDraw.round(th));\r\n    return this;\r\n  }\r\n\r\n  drawImage(el, sx, sy, sw, sh, tx, ty, tw, th) {\r\n    const { ctx } = this;\r\n    tx += this.getOffsetX();\r\n    ty += this.getOffsetY();\r\n    ctx.drawImage(el,\r\n      XDraw.round(sx), XDraw.round(sy),\r\n      XDraw.round(sw), XDraw.round(sh),\r\n      XDraw.round(tx), XDraw.round(ty),\r\n      XDraw.round(tw), XDraw.round(th));\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  XDraw,\r\n};\r\n","import { SheetUtils } from '../utils/SheetUtils';\r\nimport { XDraw } from './XDraw';\r\n\r\nconst LINE_TYPE = {\r\n  SOLID_LINE: 0,\r\n  DOTTED_LINE: 1,\r\n  POINT_LINE: 2,\r\n  DOUBLE_LINE: 3,\r\n};\r\n\r\nclass SolidLine {\r\n\r\n  constructor(draw, attr) {\r\n    this.draw = draw;\r\n    SheetUtils.copy(this, {\r\n      color: 'rgb(0,0,0)',\r\n      widthType: XDraw.LINE_WIDTH_TYPE.low,\r\n    }, attr);\r\n  }\r\n\r\n  setWidthType(widthType) {\r\n    this.widthType = widthType;\r\n  }\r\n\r\n  setColor(color) {\r\n    this.color = color;\r\n  }\r\n\r\n  horizonLine(sx, sy, ex, ey) {\r\n    const { draw } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash([]);\r\n    draw.horizonLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n  verticalLine(sx, sy, ex, ey) {\r\n    const { draw } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash([]);\r\n    draw.verticalLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n  tiltingLine(sx, sy, ex, ey) {\r\n    const { draw } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash([]);\r\n    draw.corsLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n}\r\n\r\nclass DottedLine {\r\n\r\n  constructor(draw, attr) {\r\n    this.draw = draw;\r\n    SheetUtils.copy(this, {\r\n      color: 'rgb(0,0,0)',\r\n      widthType: XDraw.LINE_WIDTH_TYPE.low,\r\n      dash: [5],\r\n    }, attr);\r\n  }\r\n\r\n  setWidthType(widthType) {\r\n    this.widthType = widthType;\r\n  }\r\n\r\n  setColor(color) {\r\n    this.color = color;\r\n  }\r\n\r\n  horizonLine(sx, sy, ex, ey) {\r\n    const { draw, dash } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash(dash);\r\n    draw.horizonLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n  verticalLine(sx, sy, ex, ey) {\r\n    const { draw, dash } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash(dash);\r\n    draw.verticalLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n  tiltingLine(sx, sy, ex, ey) {\r\n    const { draw, dash } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash(dash);\r\n    draw.corsLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n}\r\n\r\nclass DoubleLine {\r\n\r\n  constructor(draw, attr) {\r\n    this.draw = draw;\r\n    SheetUtils.copy(this, {\r\n      color: 'rgb(0,0,0)',\r\n      widthType: XDraw.LINE_WIDTH_TYPE.low,\r\n      padding: 1,\r\n      spacing: DoubleLine.spacing,\r\n      leftShow: () => false,\r\n      topShow: () => false,\r\n      rightShow: () => false,\r\n      bottomShow: () => false,\r\n      iFMerge: () => false,\r\n      iFMergeFirstRow: () => false,\r\n      iFMergeLastRow: () => false,\r\n      iFMergeFirstCol: () => false,\r\n      iFMergeLastCol: () => false,\r\n    }, attr);\r\n  }\r\n\r\n  setWidthType(widthType) {\r\n    this.widthType = widthType;\r\n  }\r\n\r\n  setColor(color) {\r\n    this.color = color;\r\n  }\r\n\r\n  handleExternal(sx, sy, ex, ey, row, col, pos) {\r\n    const external = {};\r\n    const { leftShow, topShow, rightShow, bottomShow } = this;\r\n    const { iFMerge, iFMergeFirstRow, iFMergeLastRow, iFMergeFirstCol, iFMergeLastCol } = this;\r\n    const { spacing } = this;\r\n    let ifMerge = null;\r\n    let firstRow = null;\r\n    let lastRow = null;\r\n    let firstCol = null;\r\n    let lastCol = null;\r\n    switch (pos) {\r\n      case 'left':\r\n        ifMerge = iFMerge(row, col - 1);\r\n        if (ifMerge) {\r\n          firstRow = iFMergeFirstRow(row, col - 1);\r\n          lastRow = iFMergeLastRow(row, col - 1);\r\n          firstCol = iFMergeFirstCol(row, col - 1);\r\n          lastCol = iFMergeLastCol(row, col - 1);\r\n        }\r\n        break;\r\n      case 'top':\r\n        ifMerge = iFMerge(row - 1, col);\r\n        if (ifMerge) {\r\n          firstRow = iFMergeFirstRow(row - 1, col);\r\n          lastRow = iFMergeLastRow(row - 1, col);\r\n          firstCol = iFMergeFirstCol(row - 1, col);\r\n          lastCol = iFMergeLastCol(row - 1, col);\r\n        }\r\n        break;\r\n      case 'right':\r\n        ifMerge = iFMerge(row, col + 1);\r\n        if (ifMerge) {\r\n          firstRow = iFMergeFirstRow(row, col + 1);\r\n          lastRow = iFMergeLastRow(row, col + 1);\r\n          firstCol = iFMergeFirstCol(row, col + 1);\r\n          lastCol = iFMergeLastCol(row, col + 1);\r\n        }\r\n        break;\r\n      case 'bottom':\r\n        ifMerge = iFMerge(row + 1, col);\r\n        if (ifMerge) {\r\n          firstRow = iFMergeFirstRow(row + 1, col);\r\n          lastRow = iFMergeLastRow(row + 1, col);\r\n          firstCol = iFMergeFirstCol(row + 1, col);\r\n          lastCol = iFMergeLastCol(row + 1, col);\r\n        }\r\n        break;\r\n      default: break;\r\n    }\r\n    if (ifMerge) {\r\n      switch (pos) {\r\n        case 'left': {\r\n          external.sx = sx - spacing;\r\n          external.ex = ex - spacing;\r\n          // 检查顶边和上底边及左上角底边及左顶边\r\n          const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\r\n          const sTop = topShow(row, col);\r\n          const sBottom = bottomShow(row - 1, col);\r\n          external.sy = sy;\r\n          if (sTop || sBottom) external.sy = sy - spacing;\r\n          if (sTopLeftCorner && firstRow) external.sy = sy + spacing;\r\n          // 检查底边和下顶边及左下角顶边和左底边\r\n          const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\r\n          const eBottom = bottomShow(row, col);\r\n          const eTop = topShow(row + 1, col);\r\n          external.ey = ey;\r\n          if (eBottom || eTop) external.ey = ey + spacing;\r\n          if (eBottomLeftCorner && lastRow) external.ey = ey - spacing;\r\n          break;\r\n        }\r\n        case 'top': {\r\n          external.sy = sy - spacing;\r\n          external.ey = ey - spacing;\r\n          // 检查左边和左右边及左上角右边及上左边\r\n          const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\r\n          const sLeft = leftShow(row, col);\r\n          const sRight = rightShow(row, col - 1);\r\n          external.sx = sx;\r\n          if (sLeft || sRight) external.sx = sx - spacing;\r\n          if (sTopLeftCorner && firstCol) external.sx = sx + spacing;\r\n          // 检查右边和右左边及右上角左边及上右边\r\n          const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\r\n          const eRight = rightShow(row, col);\r\n          const eLeft = leftShow(row, col + 1);\r\n          external.ex = ex;\r\n          if (eRight || eLeft) external.ex = ex + spacing;\r\n          if (eTopRightCorner && lastCol) external.ex = ex - spacing;\r\n          break;\r\n        }\r\n        case 'right': {\r\n          external.sx = sx + spacing;\r\n          external.ex = ex + spacing;\r\n          // 检查顶边和上底边及右上角底边及右顶边\r\n          const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\r\n          const sTop = topShow(row, col);\r\n          const sBottom = bottomShow(row - 1, col);\r\n          external.sy = sy;\r\n          if (sTop || sBottom) external.sy = sy - spacing;\r\n          if (sTopRightCorner && firstRow) external.sy = sy + spacing;\r\n          // 检查底边和下顶边及右下角顶边及右底边\r\n          const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\r\n          const eBottom = bottomShow(row, col);\r\n          const eTop = topShow(row + 1, col);\r\n          external.ey = ey;\r\n          if (eBottom || eTop) external.ey = ey + spacing;\r\n          if (eBottomRightCorner && lastRow) external.ey = ey - spacing;\r\n          break;\r\n        }\r\n        case 'bottom': {\r\n          external.sy = sy + spacing;\r\n          external.ey = ey + spacing;\r\n          // 检查左边和左右边及左下角右边及下左边\r\n          const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\r\n          const sLeft = leftShow(row, col);\r\n          const sRight = rightShow(row, col - 1);\r\n          external.sx = sx;\r\n          if (sLeft || sRight) external.sx = sx - spacing;\r\n          if (sBottomLeftCorner && firstCol) external.sx = sx + spacing;\r\n          // 检查右边和右左边及右下角左边及下右边\r\n          const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\r\n          const eRight = rightShow(row, col);\r\n          const eLeft = leftShow(row, col + 1);\r\n          external.ex = ex;\r\n          if (eRight || eLeft) external.ex = ex + spacing;\r\n          if (eBottomRightCorner && lastCol) external.ex = ex - spacing;\r\n          break;\r\n        }\r\n        default: break;\r\n      }\r\n      return external;\r\n    }\r\n    switch (pos) {\r\n      case 'left': {\r\n        external.sx = sx - spacing;\r\n        external.ex = ex - spacing;\r\n        // 检查顶边和上底边及左上角底边及左顶边\r\n        const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\r\n        const sTop = topShow(row, col);\r\n        const sBottom = bottomShow(row - 1, col);\r\n        external.sy = sy;\r\n        if (sTop || sBottom) external.sy = sy - spacing;\r\n        if (sTopLeftCorner) external.sy = sy + spacing;\r\n        // 检查底边和下顶边及左下角顶边和左底边\r\n        const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\r\n        const eBottom = bottomShow(row, col);\r\n        const eTop = topShow(row + 1, col);\r\n        external.ey = ey;\r\n        if (eBottom || eTop) external.ey = ey + spacing;\r\n        if (eBottomLeftCorner) external.ey = ey - spacing;\r\n        break;\r\n      }\r\n      case 'top': {\r\n        external.sy = sy - spacing;\r\n        external.ey = ey - spacing;\r\n        // 检查左边和左右边及左上角右边及上左边\r\n        const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\r\n        const sLeft = leftShow(row, col);\r\n        const sRight = rightShow(row, col - 1);\r\n        external.sx = sx;\r\n        if (sLeft || sRight) external.sx = sx - spacing;\r\n        if (sTopLeftCorner) external.sx = sx + spacing;\r\n        // 检查右边和右左边及右上角左边及上右边\r\n        const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\r\n        const eRight = rightShow(row, col);\r\n        const eLeft = leftShow(row, col + 1);\r\n        external.ex = ex;\r\n        if (eRight || eLeft) external.ex = ex + spacing;\r\n        if (eTopRightCorner) external.ex = ex - spacing;\r\n        break;\r\n      }\r\n      case 'right': {\r\n        external.sx = sx + spacing;\r\n        external.ex = ex + spacing;\r\n        // 检查顶边和上底边及右上角底边及右顶边\r\n        const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\r\n        const sTop = topShow(row, col);\r\n        const sBottom = bottomShow(row - 1, col);\r\n        external.sy = sy;\r\n        if (sTop || sBottom) external.sy = sy - spacing;\r\n        if (sTopRightCorner) external.sy = sy + spacing;\r\n        // 检查底边和下顶边及右下角顶边及右底边\r\n        const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\r\n        const eBottom = bottomShow(row, col);\r\n        const eTop = topShow(row + 1, col);\r\n        external.ey = ey;\r\n        if (eBottom || eTop) external.ey = ey + spacing;\r\n        if (eBottomRightCorner) external.ey = ey - spacing;\r\n        break;\r\n      }\r\n      case 'bottom': {\r\n        external.sy = sy + spacing;\r\n        external.ey = ey + spacing;\r\n        // 检查左边和左右边及左下角右边及下左边\r\n        const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\r\n        const sLeft = leftShow(row, col);\r\n        const sRight = rightShow(row, col - 1);\r\n        external.sx = sx;\r\n        if (sLeft || sRight) external.sx = sx - spacing;\r\n        if (sBottomLeftCorner) external.sx = sx + spacing;\r\n        // 检查右边和右左边及右下角左边及下右边\r\n        const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\r\n        const eRight = rightShow(row, col);\r\n        const eLeft = leftShow(row, col + 1);\r\n        external.ex = ex;\r\n        if (eRight || eLeft) external.ex = ex + spacing;\r\n        if (eBottomRightCorner) external.ex = ex - spacing;\r\n        break;\r\n      }\r\n      default: break;\r\n    }\r\n    return external;\r\n  }\r\n\r\n  handleInternal(sx, sy, ex, ey, row, col, pos) {\r\n    const internal = {};\r\n    const { leftShow, topShow, rightShow, bottomShow } = this;\r\n    const { iFMerge, iFMergeFirstRow, iFMergeLastRow, iFMergeFirstCol, iFMergeLastCol } = this;\r\n    const { spacing } = this;\r\n    const ifMerge = iFMerge(row, col);\r\n    // merge\r\n    if (ifMerge) {\r\n      const firstRow = iFMergeFirstRow(row, col);\r\n      const lastRow = iFMergeLastRow(row, col);\r\n      const firstCol = iFMergeFirstCol(row, col);\r\n      const lastCol = iFMergeLastCol(row, col);\r\n      switch (pos) {\r\n        case 'left': {\r\n          internal.sx = sx + spacing;\r\n          internal.ex = ex + spacing;\r\n          // 检查顶边和上底边及左上角底边及左顶边\r\n          const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\r\n          const sTop = topShow(row, col);\r\n          const sBottom = bottomShow(row - 1, col);\r\n          internal.sy = sy;\r\n          if (sTopLeftCorner) internal.sy = sy - spacing;\r\n          if ((sTop || sBottom) && firstRow) internal.sy = sy + spacing;\r\n          // 检查底边和下顶边及左下角顶边和左底边\r\n          const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\r\n          const eBottom = bottomShow(row, col);\r\n          const eTop = topShow(row + 1, col);\r\n          internal.ey = ey;\r\n          if (eBottomLeftCorner) internal.ey = ey + spacing;\r\n          if ((eBottom || eTop) && lastRow) internal.ey = ey - spacing;\r\n          break;\r\n        }\r\n        case 'top': {\r\n          internal.sy = sy + spacing;\r\n          internal.ey = ey + spacing;\r\n          // 检查左边和左右边及左上角右边及上左边\r\n          const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\r\n          const sLeft = leftShow(row, col);\r\n          const sRight = rightShow(row, col - 1);\r\n          internal.sx = sx;\r\n          if (sTopLeftCorner) internal.sx = sx - spacing;\r\n          if ((sLeft || sRight) && firstCol) internal.sx = sx + spacing;\r\n          // 检查右边和右左边及右上角左边及上右边\r\n          const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\r\n          const eRight = rightShow(row, col);\r\n          const eLeft = leftShow(row, col + 1);\r\n          internal.ex = ex;\r\n          if (eTopRightCorner) internal.ex = ex + spacing;\r\n          if ((eRight || eLeft) && lastCol) internal.ex = ex - spacing;\r\n          break;\r\n        }\r\n        case 'right': {\r\n          internal.sx = sx - spacing;\r\n          internal.ex = ex - spacing;\r\n          // 检查顶边和上底边及右上角底边及右上边\r\n          const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\r\n          const sTop = topShow(row, col);\r\n          const sBottom = bottomShow(row - 1, col);\r\n          internal.sy = sy;\r\n          if (sTopRightCorner) internal.sy = sy - spacing;\r\n          if ((sTop || sBottom) && firstRow) internal.sy = sy + spacing;\r\n          // 检查底边和下顶边右下角顶边及右下边\r\n          const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\r\n          const eBottom = bottomShow(row, col);\r\n          const eTop = topShow(row + 1, col);\r\n          internal.ey = ey;\r\n          if (eBottomRightCorner) internal.ey = ey + spacing;\r\n          if ((eBottom || eTop) && lastRow) internal.ey = ey - spacing;\r\n          break;\r\n        }\r\n        case 'bottom': {\r\n          internal.sy = sy - spacing;\r\n          internal.ey = ey - spacing;\r\n          // 检查左边和左右边及左下角右边及下左边\r\n          const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\r\n          const sLeft = leftShow(row, col);\r\n          const sRight = rightShow(row, col - 1);\r\n          internal.sx = sx;\r\n          if (sBottomLeftCorner) internal.sx = sx - spacing;\r\n          if ((sLeft || sRight) && firstCol) internal.sx = sx + spacing;\r\n          // 检查右边和右左边及右下角左边及下右边\r\n          const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\r\n          const eRight = rightShow(row, col);\r\n          const eLeft = leftShow(row, col + 1);\r\n          internal.ex = ex;\r\n          if (eBottomRightCorner) internal.ex = ex + spacing;\r\n          if ((eRight || eLeft) && lastCol) internal.ex = ex - spacing;\r\n          break;\r\n        }\r\n        default: break;\r\n      }\r\n      return internal;\r\n    }\r\n    switch (pos) {\r\n      case 'left': {\r\n        internal.sx = sx + spacing;\r\n        internal.ex = ex + spacing;\r\n        // 检查顶边和上底边及左上角底边及左顶边\r\n        const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\r\n        const sTop = topShow(row, col);\r\n        const sBottom = bottomShow(row - 1, col);\r\n        internal.sy = sy;\r\n        if (sTopLeftCorner) internal.sy = sy - spacing;\r\n        if (sTop || sBottom) internal.sy = sy + spacing;\r\n        // 检查底边和下顶边及左下角顶边和左底边\r\n        const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\r\n        const eBottom = bottomShow(row, col);\r\n        const eTop = topShow(row + 1, col);\r\n        internal.ey = ey;\r\n        if (eBottomLeftCorner) internal.ey = ey + spacing;\r\n        if (eBottom || eTop) internal.ey = ey - spacing;\r\n        break;\r\n      }\r\n      case 'top': {\r\n        internal.sy = sy + spacing;\r\n        internal.ey = ey + spacing;\r\n        // 检查左边和左右边及左上角右边及上左边\r\n        const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\r\n        const sLeft = leftShow(row, col);\r\n        const sRight = rightShow(row, col - 1);\r\n        internal.sx = sx;\r\n        if (sTopLeftCorner) internal.sx = sx - spacing;\r\n        if (sLeft || sRight) internal.sx = sx + spacing;\r\n        // 检查右边和右左边及右上角左边及上右边\r\n        const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\r\n        const eRight = rightShow(row, col);\r\n        const eLeft = leftShow(row, col + 1);\r\n        internal.ex = ex;\r\n        if (eTopRightCorner) internal.ex = ex + spacing;\r\n        if (eRight || eLeft) internal.ex = ex - spacing;\r\n        break;\r\n      }\r\n      case 'right': {\r\n        internal.sx = sx - spacing;\r\n        internal.ex = ex - spacing;\r\n        // 检查顶边和上底边及右上角底边及右上边\r\n        const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\r\n        const sTop = topShow(row, col);\r\n        const sBottom = bottomShow(row - 1, col);\r\n        internal.sy = sy;\r\n        if (sTopRightCorner) internal.sy = sy - spacing;\r\n        if (sTop || sBottom) internal.sy = sy + spacing;\r\n        // 检查底边和下顶边右下角顶边及右下边\r\n        const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\r\n        const eBottom = bottomShow(row, col);\r\n        const eTop = topShow(row + 1, col);\r\n        internal.ey = ey;\r\n        if (eBottomRightCorner) internal.ey = ey + spacing;\r\n        if (eBottom || eTop) internal.ey = ey - spacing;\r\n        break;\r\n      }\r\n      case 'bottom': {\r\n        internal.sy = sy - spacing;\r\n        internal.ey = ey - spacing;\r\n        // 检查左边和左右边及左下角右边及下左边\r\n        const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\r\n        const sLeft = leftShow(row, col);\r\n        const sRight = rightShow(row, col - 1);\r\n        internal.sx = sx;\r\n        if (sBottomLeftCorner) internal.sx = sx - spacing;\r\n        if (sLeft || sRight) internal.sx = sx + spacing;\r\n        // 检查右边和右左边及右下角左边及下右边\r\n        const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\r\n        const eRight = rightShow(row, col);\r\n        const eLeft = leftShow(row, col + 1);\r\n        internal.ex = ex;\r\n        if (eBottomRightCorner) internal.ex = ex + spacing;\r\n        if (eRight || eLeft) internal.ex = ex - spacing;\r\n        break;\r\n      }\r\n      default: break;\r\n    }\r\n    return internal;\r\n  }\r\n\r\n  horizonLine(sx, sy, ex, ey, row, col, pos) {\r\n    const { draw } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash([]);\r\n    const external = this.handleExternal(sx, sy, ex, ey, row, col, pos);\r\n    const internal = this.handleInternal(sx, sy, ex, ey, row, col, pos);\r\n    if (!SheetUtils.isEmptyObject(internal)) {\r\n      draw.horizonLine([internal.sx, internal.sy], [internal.ex, internal.ey]);\r\n    }\r\n    if (!SheetUtils.isEmptyObject(external)) {\r\n      draw.horizonLine([external.sx, external.sy], [external.ex, external.ey]);\r\n    }\r\n  }\r\n\r\n  verticalLine(sx, sy, ex, ey, row, col, pos) {\r\n    const { draw } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash([]);\r\n    const external = this.handleExternal(sx, sy, ex, ey, row, col, pos);\r\n    const internal = this.handleInternal(sx, sy, ex, ey, row, col, pos);\r\n    if (!SheetUtils.isEmptyObject(internal)) {\r\n      draw.verticalLine([internal.sx, internal.sy], [internal.ex, internal.ey]);\r\n    }\r\n    if (!SheetUtils.isEmptyObject(external)) {\r\n      draw.verticalLine([external.sx, external.sy], [external.ex, external.ey]);\r\n    }\r\n  }\r\n\r\n  // eslint-disable-next-line no-unused-vars\r\n  tiltingLine(sx, sy, ex, ey, row, col, pos) {\r\n    // TODO ..\r\n    // ...\r\n  }\r\n\r\n}\r\nDoubleLine.spacing = XDraw.dpr() >= 2 ? 3 : 2;\r\n\r\nclass Line {\r\n\r\n  constructor(draw, attr = {}) {\r\n    this.widthType = XDraw.LINE_WIDTH_TYPE.low;\r\n    this.type = LINE_TYPE.SOLID_LINE;\r\n    this.solidLine = new SolidLine(draw, SheetUtils.copy({}, attr));\r\n    this.dottedLine = new DottedLine(draw, SheetUtils.copy({\r\n      dash: [5],\r\n    }, attr));\r\n    this.pointLine = new DottedLine(draw, SheetUtils.copy({\r\n      dash: [2, 2],\r\n    }, attr));\r\n    this.doubleLine = new DoubleLine(draw, SheetUtils.copy({}, attr));\r\n  }\r\n\r\n  setWidthType(widthType) {\r\n    if (widthType) {\r\n      if (this.type === LINE_TYPE.SOLID_LINE) {\r\n        this.solidLine.setWidthType(widthType);\r\n      }\r\n    }\r\n  }\r\n\r\n  setColor(color) {\r\n    if (color) {\r\n      this.solidLine.setColor(color);\r\n      this.dottedLine.setColor(color);\r\n      this.pointLine.setColor(color);\r\n      this.doubleLine.setColor(color);\r\n    }\r\n  }\r\n\r\n  setType(type) {\r\n    this.type = type;\r\n  }\r\n\r\n  horizonLine(sx, sy, ex, ey, row, col, pos) {\r\n    const {\r\n      type,\r\n      solidLine,\r\n      dottedLine,\r\n      pointLine,\r\n      doubleLine,\r\n    } = this;\r\n    switch (type) {\r\n      case LINE_TYPE.SOLID_LINE:\r\n        solidLine.horizonLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.DOTTED_LINE:\r\n        dottedLine.horizonLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.POINT_LINE:\r\n        pointLine.horizonLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.DOUBLE_LINE:\r\n        doubleLine.horizonLine(sx, sy, ex, ey, row, col, pos);\r\n        break;\r\n    }\r\n  }\r\n\r\n  verticalLine(sx, sy, ex, ey, row, col, pos) {\r\n    const {\r\n      type,\r\n      solidLine,\r\n      dottedLine,\r\n      pointLine,\r\n      doubleLine,\r\n    } = this;\r\n    switch (type) {\r\n      case LINE_TYPE.SOLID_LINE:\r\n        solidLine.verticalLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.DOTTED_LINE:\r\n        dottedLine.verticalLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.POINT_LINE:\r\n        pointLine.verticalLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.DOUBLE_LINE:\r\n        doubleLine.verticalLine(sx, sy, ex, ey, row, col, pos);\r\n        break;\r\n    }\r\n  }\r\n\r\n  tiltingLine(sx, sy, ex, ey, row, col, pos) {\r\n    const {\r\n      type,\r\n      solidLine,\r\n      dottedLine,\r\n      pointLine,\r\n      doubleLine,\r\n    } = this;\r\n    switch (type) {\r\n      case LINE_TYPE.SOLID_LINE:\r\n        solidLine.tiltingLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.DOTTED_LINE:\r\n        dottedLine.tiltingLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.POINT_LINE:\r\n        pointLine.tiltingLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.DOUBLE_LINE:\r\n        doubleLine.tiltingLine(sx, sy, ex, ey, row, col, pos);\r\n        break;\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  Line, LINE_TYPE, SolidLine,\r\n};\r\n","import { LINE_TYPE } from '../../../draw/Line';\nimport { SheetUtils } from '../../../utils/SheetUtils';\nimport { XDraw } from '../../../draw/XDraw';\n\nlet zIndexID = 0;\n\n/**\n * Border\n * @author jerry\n */\nclass Border {\n\n  static getZIndex() {\n    zIndexID += 1;\n    return zIndexID;\n  }\n\n  /**\n   * Border\n   * @param widthType\n   * @param width\n   * @param color\n   * @param zIndex\n   * @param display\n   * @param type\n   */\n  constructor({\n    widthType = XDraw.LINE_WIDTH_TYPE.low,\n    width = -1,\n    color = 'rgb(0,0,0)',\n    zIndex = 0,\n    display = false,\n    type = LINE_TYPE.SOLID_LINE,\n  }) {\n    this.zIndex = zIndex;\n    this.display = display;\n    this.color = color;\n    this.type = type;\n    if (width === 1) {\n      this.widthType = XDraw.LINE_WIDTH_TYPE.low;\n    } else if (width === 2) {\n      this.widthType = XDraw.LINE_WIDTH_TYPE.medium;\n    } else if (width === 3) {\n      this.widthType = XDraw.LINE_WIDTH_TYPE.high;\n    } else {\n      this.widthType = widthType;\n    }\n    if (zIndex > zIndexID) {\n      zIndexID = zIndex;\n    }\n  }\n\n  setWidthType(value) {\n    this.zIndex = Border.getZIndex();\n    this.widthType = value;\n  }\n\n  setColor(value) {\n    this.zIndex = Border.getZIndex();\n    this.color = value;\n  }\n\n  setDisplay(value) {\n    this.zIndex = Border.getZIndex();\n    this.display = value;\n  }\n\n  setType(value) {\n    this.zIndex = Border.getZIndex();\n    this.type = value;\n  }\n\n  setZIndex(value) {\n    this.zIndex = value;\n  }\n\n  equal(target) {\n    const widthType = this.widthType === target.widthType;\n    const color = this.color === target.color;\n    const type = this.type === target.type;\n    return color && widthType && type;\n  }\n\n  priority(border) {\n    if (SheetUtils.isUnDef(border)) {\n      return -2;\n    }\n    const origin = this.zIndex;\n    const target = border.zIndex;\n    if (origin > target) {\n      return 1;\n    }\n    if (target > origin) {\n      return -1;\n    }\n    return 0;\n  }\n\n}\n\nexport { Border };\n","import { Border } from './Border';\nimport { LINE_TYPE } from '../../../draw/Line';\n\n/**\n * CellBorder\n * @author jerry\n */\nclass CellBorder {\n\n  /**\n   * CellBorder\n   * @param time\n   * @param left\n   * @param top\n   * @param right\n   * @param bottom\n   */\n  constructor({\n    left = {},\n    bottom = {},\n    top = {},\n    right = {},\n  }) {\n    this.left = new Border(left);\n    this.bottom = new Border(bottom);\n    this.top = new Border(top);\n    this.right = new Border(right);\n  }\n\n  hasDouble() {\n    const { top, left, right, bottom } = this;\n    if (top.type === LINE_TYPE.DOUBLE_LINE) {\n      return true;\n    }\n    if (left.type === LINE_TYPE.DOUBLE_LINE) {\n      return true;\n    }\n    if (right.type === LINE_TYPE.DOUBLE_LINE) {\n      return true;\n    }\n    return bottom.type === LINE_TYPE.DOUBLE_LINE;\n  }\n\n  isDisplay() {\n    return this.left.display || this.top.display\n      || this.bottom.display || this.right.display;\n  }\n\n  setAllDisplay(display) {\n    this.setBDisplay(display);\n    this.setLDisplay(display);\n    this.setTDisplay(display);\n    this.setRDisplay(display);\n  }\n\n  setLDisplay(display) {\n    this.left.setDisplay(display);\n  }\n\n  setTDisplay(display) {\n    this.top.setDisplay(display);\n  }\n\n  setRDisplay(display) {\n    this.right.setDisplay(display);\n  }\n\n  setBDisplay(display) {\n    this.bottom.setDisplay(display);\n  }\n\n  setAllColor(color) {\n    this.setBColor(color);\n    this.setLColor(color);\n    this.setTColor(color);\n    this.setRColor(color);\n  }\n\n  setLColor(color) {\n    this.left.setColor(color);\n  }\n\n  setTColor(color) {\n    this.top.setColor(color);\n  }\n\n  setRColor(color) {\n    this.right.setColor(color);\n  }\n\n  setBColor(color) {\n    this.bottom.setColor(color);\n  }\n\n  setAllWidthType(widthType) {\n    this.setBWidthType(widthType);\n    this.setLWidthType(widthType);\n    this.setTWidthType(widthType);\n    this.setRWidthType(widthType);\n  }\n\n  setLWidthType(widthType) {\n    this.left.setWidthType(widthType);\n  }\n\n  setTWidthType(widthType) {\n    this.top.setWidthType(widthType);\n  }\n\n  setRWidthType(widthType) {\n    this.right.setWidthType(widthType);\n  }\n\n  setBWidthType(widthType) {\n    this.bottom.setWidthType(widthType);\n  }\n\n  setAllType(type) {\n    this.setBType(type);\n    this.setLType(type);\n    this.setTType(type);\n    this.setRType(type);\n  }\n\n  setLType(type) {\n    this.left.setType(type);\n  }\n\n  setTType(type) {\n    this.top.setType(type);\n  }\n\n  setRType(type) {\n    this.right.setType(type);\n  }\n\n  setBType(type) {\n    this.bottom.setType(type);\n  }\n\n  updateMaxIndex() {\n    const zIndex = Border.getZIndex();\n    this.left.setZIndex(zIndex);\n    this.bottom.setZIndex(zIndex);\n    this.top.setZIndex(zIndex);\n    this.right.setZIndex(zIndex);\n  }\n\n  clone() {\n    const {\n      left, top, right, bottom,\n    } = this;\n    return new CellBorder({\n      left, top, right, bottom,\n    });\n  }\n\n}\n\nexport { CellBorder };\n","class Rect {\r\n\r\n  /**\r\n   * Rect\r\n   * @param x\r\n   * @param y\r\n   * @param width\r\n   * @param height\r\n   */\r\n  constructor({\r\n    x, y, width, height,\r\n  }) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.width = width;\r\n    this.height = height;\r\n  }\r\n\r\n  /**\r\n   * 判断两个矩形是否不发生重合\r\n   * @param {Rect} other 区域\r\n   * @returns {boolean}\r\n   */\r\n  disjoint(other) {\r\n    return this.x > other.x + other.width\r\n      || this.y > this.y + other.height\r\n      || other.x > this.x + this.width\r\n      || other.y > this.y + this.height;\r\n  }\r\n\r\n  /**\r\n   * 扩展尺寸\r\n   * @param size\r\n   * @returns {Rect}\r\n   */\r\n  expandSize(size) {\r\n    this.width += size;\r\n    this.height += size;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 是否包含点\r\n   * @param x\r\n   * @param y\r\n   * @returns {boolean}\r\n   */\r\n  includePoint(x, y) {\r\n    return x >= this.x && x <= this.x + this.width\r\n      && y >= this.y && y <= this.y + this.height;\r\n  }\r\n\r\n  /**\r\n   * 是否包含矩形\r\n   * @param rect\r\n   * @returns {boolean|boolean}\r\n   */\r\n  includeRect(rect) {\r\n    const { x, y, width, height } = rect;\r\n    return this.x <= x && this.x + this.width >= x + width\r\n      && this.y <= y && this.y + this.height >= y + height;\r\n  }\r\n\r\n  /**\r\n   * 计算当前矩形在指定矩形内部的位置\r\n   * @param rect\r\n   * @returns {Rect}\r\n   */\r\n  inRectPosition(rect) {\r\n    return new Rect({\r\n      x: this.x - rect.x,\r\n      y: this.y - rect.y,\r\n      width: this.width,\r\n      height: this.height,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 复制\r\n   * @returns {Rect}\r\n   */\r\n  clone() {\r\n    const { x, y, width, height } = this;\r\n    return new Rect({ x, y, width, height });\r\n  }\r\n\r\n}\r\n\r\nexport { Rect };\r\n","\n/**\n * XIconOffset\n */\nclass XIconOffset {\n\n  /**\n   * XIconOffset\n   * @param x\n   * @param y\n   */\n  constructor({ x = 0, y = 0 } = {}) {\n    this.x = x;\n    this.y = y;\n  }\n\n}\n\nexport {\n  XIconOffset,\n};\n","class Crop {\r\n\r\n  constructor({\r\n    rect, draw, offset = 0,\r\n  }) {\r\n    this.rect = rect;\r\n    this.draw = draw;\r\n    this.offset = offset;\r\n  }\r\n\r\n  open() {\r\n    const {\r\n      rect, draw, offset,\r\n    } = this;\r\n    const {\r\n      x, y, width, height,\r\n    } = rect;\r\n    draw.save()\r\n      .rect(x, y, width + offset, height + offset)\r\n      .clip()\r\n      .beginPath();\r\n    return this;\r\n  }\r\n\r\n  close() {\r\n    const { draw } = this;\r\n    draw.restore();\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nexport { Crop };\r\n","/* global Image console */\nimport { SheetUtils } from '../../../utils/SheetUtils';\nimport { XDraw } from '../../../draw/XDraw';\nimport { Rect } from '../../../draw/Rect';\nimport { XIconOffset } from './XIconOffset';\nimport { Crop } from '../../../draw/Crop';\n\n/**\n * XIcon\n * @author jerry\n * @date 2020/10/20\n */\nclass XIcon {\n\n  /**\n   * 多图标初始化\n   * @param icons\n   * @returns {[]}\n   */\n  static newInstances(icons = []) {\n    const instances = [];\n    for (let i = 0; i < icons.length; i += 1) {\n      const icon = icons[i];\n      instances.push(new XIcon(icon));\n    }\n    return instances;\n  }\n\n  /**\n   * XIcon\n   * @param vertical\n   * @param horizontal\n   * @param type\n   * @param image\n   * @param focus\n   * @param height\n   * @param width\n   * @param color\n   * @param offset\n   * @param onDraw\n   * @param onLeave\n   * @param onMove\n   * @param onDown\n   * @param onEnter\n   */\n  constructor({\n    vertical = XIcon.ICON_VERTICAL.CENTER,\n    horizontal = XIcon.ICON_HORIZONTAL.RIGHT,\n    type = XIcon.ICON_TYPE.image,\n    image = SheetUtils.Nul,\n    iconFocus = null,\n    height = 16,\n    width = 16,\n    color = 'rgb(255,255,255)',\n    offset = { x: 0, y: 0 },\n    onDraw = () => {},\n    onLeave = () => {},\n    onMove = () => {},\n    onDown = () => {},\n    onEnter = () => {},\n  }) {\n    this.vertical = vertical;\n    this.horizontal = horizontal;\n    this.width = width;\n    this.height = height;\n    this.type = type;\n    this.image = image;\n    this.color = color;\n    this.iconFocus = iconFocus;\n    this.offset = new XIconOffset(offset);\n    this.onLeave = onLeave;\n    this.onMove = onMove;\n    this.onDraw = onDraw;\n    this.onDown = onDown;\n    this.onEnter = onEnter;\n    this.rect = null;\n  }\n\n  /**\n   * 计算绘制坐标\n   * @param rect\n   * @returns {{x: number, y: number}}\n   */\n  position(rect) {\n    // 图标信息\n    const iconHorizontal = this.horizontal;\n    const iconVertical = this.vertical;\n    const iconOffsetX = XDraw.stylePx(this.offset.x);\n    const iconOffsetY = XDraw.stylePx(this.offset.y);\n    const iconWidth = XDraw.stylePx(this.width);\n    const iconHeight = XDraw.stylePx(this.height);\n    // 矩形位置\n    const rectX = rect.x;\n    const rectY = rect.y;\n    const rectWidth = rect.width;\n    const rectHeight = rect.height;\n    // 计算位置\n    let px = 0;\n    let py = 0;\n    switch (iconHorizontal) {\n      case XIcon.ICON_HORIZONTAL.CENTER:\n        px = (rectX + rectWidth / 2) - (iconWidth / 2);\n        break;\n      case XIcon.ICON_HORIZONTAL.LEFT:\n        px = rectX;\n        break;\n      case XIcon.ICON_HORIZONTAL.RIGHT:\n        px = rectX + rectWidth - iconWidth;\n        break;\n    }\n    switch (iconVertical) {\n      case XIcon.ICON_VERTICAL.CENTER:\n        py = (rectY + rectHeight / 2) - (iconHeight / 2);\n        break;\n      case XIcon.ICON_VERTICAL.TOP:\n        py = rectY;\n        break;\n      case XIcon.ICON_VERTICAL.BOTTOM:\n        py = rectY + rectHeight - iconHeight;\n        break;\n    }\n    px += iconOffsetX;\n    py += iconOffsetY;\n    return new Rect({\n      x: px, y: py, width: iconWidth, height: iconHeight,\n    });\n  }\n\n  /**\n   * 加载图片信息\n   * @param async\n   * @param sync\n   */\n  loadImage({\n    load, sync,\n  }) {\n    const { image, type } = this;\n    switch (type) {\n      case XIcon.ICON_TYPE.image:\n        if (image instanceof Image) {\n          sync(image);\n        } else {\n          const loadImg = new Image();\n          loadImg.src = image;\n          if (loadImg.complete) {\n            this.image = loadImg;\n            sync(this.image);\n          } else {\n            loadImg.onload = () => {\n              this.image = loadImg;\n              load(loadImg);\n            };\n            loadImg.onerror = () => {\n              // eslint-disable-next-line no-console\n              console.error(`图片加载失败${image}`);\n            };\n          }\n        }\n        break;\n      case XIcon.ICON_TYPE.draw:\n        sync();\n        break;\n    }\n  }\n\n  /**\n   * 绘制小图标\n   * @param rect\n   * @param draw\n   */\n  drawIcon({\n    rect, draw,\n  }) {\n    const { type } = this;\n    this.rect = rect;\n    switch (type) {\n      case XIcon.ICON_TYPE.image:\n        this.drawImage({\n          rect, draw,\n        });\n        break;\n      case XIcon.ICON_TYPE.draw:\n        this.drawCustom({\n          rect, draw,\n        });\n        break;\n    }\n  }\n\n  /**\n   * 自定义绘制\n   * @param rect\n   * @param icon\n   * @param draw\n   */\n  drawCustom({\n    rect, draw,\n  }) {\n    this.onDraw({\n      rect, draw,\n    });\n  }\n\n  /**\n   * 绘制图片\n   * @param rect\n   * @param icon\n   * @param draw\n   */\n  drawImage({\n    rect, draw,\n  }) {\n    const image = this.image;\n    const color = this.color;\n    const positionRect = this.position(rect);\n    const {\n      x, y, width, height,\n    } = positionRect;\n    const include = rect.includeRect(positionRect);\n    const crop = new Crop({\n      rect, draw,\n    });\n    if (include === false) {\n      crop.open();\n    }\n    if (color) {\n      draw.attr({ fillStyle: color });\n      draw.fillRect(x, y, width, height);\n    }\n    draw.drawImage(image, 0, 0, image.width, image.height, x, y, width, height);\n    if (include === false) {\n      crop.close();\n    }\n  }\n\n  /**\n   * 事件处理\n   * @param type\n   * @param x\n   * @param y\n   * @param native\n   */\n  eventHandle({\n    type, x, y, native,\n  }) {\n    const { rect, iconFocus } = this;\n    if (rect) {\n      const position = this.position(rect);\n      const location = position.inRectPosition(rect);\n      const { activate } = iconFocus;\n      switch (type) {\n        case XIcon.ICON_EVENT_TYPE.MOUSE_DOWN:\n          if (location.includePoint(x, y)) {\n            iconFocus.setActivate(this);\n            this.onDown({\n              native, position,\n            });\n          }\n          break;\n        case XIcon.ICON_EVENT_TYPE.MOUSE_MOVE:\n          if (location.includePoint(x, y)) {\n            if (activate !== this) {\n              this.onEnter({\n                native, position,\n              });\n            }\n            iconFocus.setActivate(this);\n            this.onMove({\n              native, position,\n            });\n          } else if (activate) {\n            iconFocus.setActivate(null);\n            this.onLeave({\n              native, position,\n            });\n          }\n          break;\n      }\n    }\n  }\n\n  /**\n   * 绘制回调\n   * @param callback\n   */\n  setOnDraw(callback) {\n    this.onDraw = callback;\n  }\n\n  /**\n   * 按下回调\n   * @param callback\n   */\n  setOnDown(callback) {\n    this.onDown = callback;\n  }\n\n  /**\n   * 移动回调\n   * @param callback\n   */\n  setOnMove(callback) {\n    this.onMove = callback;\n  }\n\n  /**\n   * 进入回调\n   * @param callback\n   */\n  setOnEnter(callback) {\n    this.onEnter = callback;\n  }\n\n  /**\n   * 离开回调\n   * @param callback\n   */\n  setOnLeave(callback) {\n    this.onLeave = callback;\n  }\n\n  /**\n   * 设置焦点元素\n   * @param iconFocus\n   */\n  setFocus(iconFocus) {\n    this.iconFocus = iconFocus;\n  }\n\n}\nXIcon.ICON_HORIZONTAL = {\n  LEFT: 0,\n  RIGHT: 1,\n  CENTER: 2,\n};\nXIcon.ICON_VERTICAL = {\n  TOP: 3,\n  BOTTOM: 4,\n  CENTER: 5,\n};\nXIcon.ICON_TYPE = {\n  image: 1,\n  custom: 2,\n};\nXIcon.ICON_EVENT_TYPE = {\n  MOUSE_DOWN: 1,\n  MOUSE_MOVE: 2,\n};\n\nexport { XIcon };\n","class DateUtils {\r\n\r\n  static dateFormat(fmt, date) {\r\n    if (!(date instanceof Date)) {\r\n      return date;\r\n    }\r\n    const o = {\r\n      'M+': date.getMonth() + 1,\r\n      'd+': date.getDate(),\r\n      'h+': date.getHours(),\r\n      'm+': date.getMinutes(),\r\n      's+': date.getSeconds(),\r\n      'q+': Math.floor((date.getMonth() + 3) / 3),\r\n      S: date.getMilliseconds(),\r\n    };\r\n    const reYear = /(y+)/;\r\n    const resultYear = reYear.exec(fmt);\r\n    if (resultYear) {\r\n      const yearFormatPart = resultYear[0];\r\n      const yearVal = (date.getFullYear().toString()).substr(4 - yearFormatPart.length);\r\n      fmt = fmt.replace(yearFormatPart, yearVal);\r\n    }\r\n    // eslint-disable-next-line guard-for-in,no-restricted-syntax\r\n    for (const k in o) {\r\n      const re = new RegExp(`(${k})`);\r\n      const res = re.exec(fmt);\r\n      if (res) {\r\n        const Val = o[k].toString();\r\n        const formatPart = res[0];\r\n        const replaceVal = (formatPart.length === 1) ? (Val) : ((`00${Val}`).substr(Val.length));\r\n        fmt = fmt.replace(formatPart, replaceVal);\r\n      }\r\n    }\r\n    return fmt;\r\n  }\r\n\r\n  static parse(text) {\r\n    let result = text;\r\n    if (result instanceof Date) {\r\n      return result;\r\n    }\r\n\r\n    result = DateUtils.parserToDate(text, 'yyyy/MM/dd');\r\n    if (result) {\r\n      return result;\r\n    }\r\n    result = DateUtils.parserToDate(text, 'MM/dd');\r\n    if (result) {\r\n      return result;\r\n    }\r\n    result = DateUtils.parserToDate(text, 'yyyy/MM/dd hh:mm:ss');\r\n    if (result) {\r\n      return result;\r\n    }\r\n\r\n    result = DateUtils.parserToDate(text, 'yyyy-MM-dd');\r\n    if (result) {\r\n      return result;\r\n    }\r\n    result = DateUtils.parserToDate(text, 'MM-dd');\r\n    if (result) {\r\n      return result;\r\n    }\r\n    result = DateUtils.parserToDate(text, 'yyyy-MM-dd hh:mm:ss');\r\n    if (result) {\r\n      return result;\r\n    }\r\n\r\n    result = DateUtils.parserToDate(text, 'hh:mm:ss');\r\n    if (result) {\r\n      return result;\r\n    }\r\n\r\n    result = DateUtils.parserToDate(text, 'yyyy年MM月');\r\n    if (result) {\r\n      return result;\r\n    }\r\n    result = DateUtils.parserToDate(text, 'MM月dd日');\r\n    if (result) {\r\n      return result;\r\n    }\r\n    result = DateUtils.parserToDate(text, 'yyyy年MM月dd日 hh:mm:ss');\r\n    if (result) {\r\n      return result;\r\n    }\r\n\r\n    return text;\r\n  }\r\n\r\n  static parserToDate(dateText, format) {\r\n    if (!dateText) {\r\n      return null;\r\n    }\r\n    const defaultVal = new Date('1970/01/01 00:00:00');\r\n    const o = [{\r\n      reg: 'y+',\r\n    }, {\r\n      reg: 'M+',\r\n    }, {\r\n      reg: 'd+',\r\n    }, {\r\n      reg: 'h+',\r\n    }, {\r\n      reg: 'm+',\r\n    }, {\r\n      reg: 's+',\r\n    }, {\r\n      reg: 'S',\r\n    }];\r\n    let year = defaultVal.getFullYear();\r\n    let month = defaultVal.getMonth() + 1;\r\n    let day = defaultVal.getDate();\r\n    let hours = defaultVal.getHours();\r\n    let minutes = defaultVal.getMinutes();\r\n    let seconds = defaultVal.getSeconds();\r\n    let milliseconds = defaultVal.getMilliseconds();\r\n    let index = 1;\r\n    for (let j = 0; j < format.length; j += 1) {\r\n      const oneChar = format[j];\r\n      for (let i = 0; i < o.length; i += 1) {\r\n        const onePart = o[i];\r\n        const onePartReg = onePart.reg;\r\n        if (onePartReg[0] === oneChar) {\r\n          if (!onePart.index) {\r\n            onePart.index = index;\r\n            index += 1;\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    for (let i = 0; i < o.length; i += 1) {\r\n      const onePart = o[i];\r\n      const onePartReg = onePart.reg;\r\n      const re = new RegExp(`(${onePartReg})`);\r\n      const res = re.exec(format);\r\n      if (res) {\r\n        const formatPart = res[0];\r\n        const replaceVal = `([0-9]{1,${formatPart.length}})`;\r\n        // eslint-disable-next-line no-param-reassign\r\n        format = format.replace(formatPart, replaceVal);\r\n      }\r\n    }\r\n    const dataInfo = {};\r\n    const re = new RegExp(format);\r\n    const res = re.exec(dateText);\r\n    if (res) {\r\n      for (let i = 1; i < res.length; i += 1) {\r\n        dataInfo[i] = res[i];\r\n      }\r\n    } else {\r\n      return null;\r\n    }\r\n    if (o[0].index) {\r\n      const { index } = o[0];\r\n      year = dataInfo[index];\r\n    }\r\n    if (o[1].index) {\r\n      const { index } = o[1];\r\n      month = dataInfo[index];\r\n    }\r\n    if (o[2].index) {\r\n      const { index } = o[2];\r\n      day = dataInfo[index];\r\n    }\r\n    if (o[3].index) {\r\n      const { index } = o[3];\r\n      hours = dataInfo[index];\r\n    }\r\n    if (o[4].index) {\r\n      const { index } = o[4];\r\n      minutes = dataInfo[index];\r\n    }\r\n    if (o[5].index) {\r\n      const { index } = o[5];\r\n      seconds = dataInfo[index];\r\n    }\r\n    if (o[6].index) {\r\n      const { index } = o[6];\r\n      milliseconds = dataInfo[index];\r\n    }\r\n    return new Date(year, month - 1, day, hours, minutes, seconds, milliseconds);\r\n  }\r\n\r\n}\r\n\r\nexport { DateUtils };\r\n","import { SheetUtils } from '../../utils/SheetUtils';\nimport { DateUtils } from '../../utils/DateUtils';\n\nclass Format {\n\n  eNotation(value) {\n    if (SheetUtils.isNumber(value)) {\n      const number = SheetUtils.parseFloat(value);\n      return number.toExponential(2);\n    }\n    return value;\n  }\n\n  default(value) {\n    return value ? value.toString() : '';\n  }\n\n  text(value) {\n    return value;\n  }\n\n  decimal(value) {\n    if (SheetUtils.isNumber(value)) {\n      const indexOf = value.toString().indexOf('.');\n      if (indexOf !== -1) {\n        return value.toString().substring(0, indexOf + 3);\n      }\n      return `${value}.00`;\n    }\n    return value;\n  }\n\n  number(value) {\n    if (SheetUtils.isNumber(value)) {\n      return SheetUtils.parseFloat(value);\n    }\n    return value;\n  }\n\n  percentage(value) {\n    if (SheetUtils.isNumber(value)) {\n      return `${value}%`;\n    }\n    return value;\n  }\n\n  fraction(value) {\n    if (SheetUtils.isFraction(value)) {\n      const left = value.split('/')[0];\n      const right = value.split('/')[1];\n      return SheetUtils.parseInt(left) / SheetUtils.parseInt(right);\n    }\n    return value;\n  }\n\n  rmb(value) {\n    if (SheetUtils.isNumber(value)) {\n      return `￥${value}`;\n    }\n    return value;\n  }\n\n  hk(value) {\n    if (SheetUtils.isNumber(value)) {\n      return `HK${value}`;\n    }\n    return value;\n  }\n\n  time(value) {\n    const result = DateUtils.parse(value);\n    if (result) {\n      return DateUtils.dateFormat('hh:mm:ss', result);\n    }\n    return value;\n  }\n\n  date1(value) {\n    const result = DateUtils.parse(value);\n    if (result) {\n      return DateUtils.dateFormat('yyyy/MM/dd', result);\n    }\n    return value;\n  }\n\n  date2(value) {\n    const result = DateUtils.parse(value);\n    if (result) {\n      return DateUtils.dateFormat('MM月dd日', result);\n    }\n    return value;\n  }\n\n  date3(value) {\n    const result = DateUtils.parse(value);\n    if (result) {\n      return DateUtils.dateFormat('yyyy年MM月', result);\n    }\n    return value;\n  }\n\n  date4(value) {\n    const result = DateUtils.parse(value);\n    if (result) {\n      return DateUtils.dateFormat('yyyy年MM月dd日', result);\n    }\n    return value;\n  }\n\n  date5(value) {\n    const result = DateUtils.parse(value);\n    if (result) {\n      return DateUtils.dateFormat('yyyy/MM/dd hh:mm:ss', result);\n    }\n    return value;\n  }\n\n  dollar(value) {\n    if (SheetUtils.isNumber(value)) {\n      return `$${value}`;\n    }\n    return value;\n  }\n\n}\n\nconst format = new Format();\n\nexport default (type, value) => format[type](value);\n","import { SheetUtils } from '../../../utils/SheetUtils';\n\nclass RichFont {\n\n  constructor({\n    text, color, name, size,\n    italic, bold, underline,\n    strikethrough, scaleAdapter,\n  } = {}) {\n    this.text = text;\n    this.color = color;\n    this.name = name;\n    this.size = size;\n    this.italic = italic;\n    this.bold = bold;\n    this.strikethrough = strikethrough;\n    this.underline = underline;\n    this.scaleAdapter = scaleAdapter;\n  }\n\n  clone() {\n    const { text, color, name, size } = this;\n    const { italic, bold, underline } = this;\n    const { strikethrough, scaleAdapter } = this;\n    return new RichFont({\n      text, color, name, size, italic, bold, underline, strikethrough, scaleAdapter,\n    });\n  }\n\n  plain(option = v => v) {\n    return option(this.clone());\n  }\n\n  equals(other) {\n    if (SheetUtils.isUnDef(other)) {\n      return false;\n    }\n    if (other.text !== this.text) {\n      return false;\n    }\n    if (other.color !== this.color) {\n      return false;\n    }\n    if (other.name !== this.name) {\n      return false;\n    }\n    if (other.size !== this.size) {\n      return false;\n    }\n    if (other.italic !== this.italic) {\n      return false;\n    }\n    if (other.bold !== this.bold) {\n      return false;\n    }\n    if (other.strikethrough !== this.strikethrough) {\n      return false;\n    }\n    return other.underline === this.underline;\n  }\n\n}\n\nexport {\n  RichFont,\n};\n","import { RichFont } from './RichFont';\nimport { SheetUtils } from '../../../utils/SheetUtils';\n\nclass RichFonts {\n\n  constructor({\n    rich = [],\n  } = {}) {\n    this.rich = rich.map(font => new RichFont(font));\n  }\n\n  setRich(rich = []) {\n    this.rich = rich;\n  }\n\n  getRich() {\n    return this.rich;\n  }\n\n  clone() {\n    const rich = [];\n    this.rich.forEach((font) => {\n      rich.push(font.clone());\n    });\n    return new RichFonts({ rich });\n  }\n\n  plain(option) {\n    const result = [];\n    this.rich.forEach((font) => {\n      result.push(font.plain(option));\n    });\n    return result;\n  }\n\n  equals(other) {\n    if (SheetUtils.isUnDef(other)) {\n      return false;\n    }\n    if (other.rich.length !== this.rich.length) {\n      return false;\n    }\n    for (let i = 0; i < this.rich.length; i++) {\n      let item1 = this.rich[i];\n      let item2 = other.rich[i];\n      if (!item1.equals(item2)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n}\n\nexport {\n  RichFonts,\n};\n","/**\r\n * 运行函数注册\r\n * @type {{}}\r\n */\r\nclass EvalFunctions {\r\n\r\n  /**\r\n   * EvalFunctions\r\n   */\r\n  constructor() {\r\n    this.functions = {};\r\n  }\r\n\r\n  /**\r\n   * 删除函数\r\n   * @param name\r\n   */\r\n  remove(name) {\r\n    delete this.functions[name];\r\n  }\r\n\r\n  /**\r\n   * 获取函数\r\n   * @param name\r\n   * @returns {*}\r\n   */\r\n  getFunction(name) {\r\n    return this.functions[name.toLocaleString()];\r\n  }\r\n\r\n  /**\r\n   * 注册函数\r\n   * @param name\r\n   * @param func\r\n   */\r\n  register(name, func) {\r\n    this.functions[name.toLocaleString()] = func;\r\n  }\r\n}\r\n\r\n/**\r\n * 函数注册\r\n * @type {EvalFunctions}\r\n */\r\nconst Functions = new EvalFunctions();\r\n\r\n/**\r\n * 指令序列\r\n */\r\nclass Assembly {\r\n\r\n  /**\r\n   * Assembly\r\n   */\r\n  constructor() {\r\n    this.assembly = '';\r\n  }\r\n\r\n  /**\r\n   * 获取指令详情\r\n   * @returns {string}\r\n   */\r\n  getInstruct() {\r\n    let { assembly } = this;\r\n    let flag = '\\r\\n';\r\n    while (assembly.endsWith(flag)) {\r\n      let { length } = assembly;\r\n      assembly = assembly.substring(0, length - flag.length);\r\n    }\r\n    return assembly;\r\n  }\r\n\r\n  /**\r\n   * 写入操作数\r\n   * @param value\r\n   */\r\n  writeOperand(value) {\r\n    this.assembly += `OPush ${value}\\r\\n`;\r\n  }\r\n\r\n  /**\r\n   * 写入运算符\r\n   * @param op\r\n   */\r\n  writeOperator(op) {\r\n    this.assembly += `${op}\\r\\n`;\r\n  }\r\n\r\n  /**\r\n   * 写入操作数\r\n   * @param value\r\n   */\r\n  writeString(value) {\r\n    this.assembly += `SPush ${value}\\r\\n`;\r\n  }\r\n\r\n  /**\r\n   * 写入操作数\r\n   * @param value\r\n   */\r\n  writeNumber(value) {\r\n    this.assembly += `NPush ${value}\\r\\n`;\r\n  }\r\n}\r\n\r\n/**\r\n * 词法分析\r\n */\r\nclass Tokenizer {\r\n\r\n  /**\r\n   * Tokenizer\r\n   * @param syntaxCheck\r\n   */\r\n  constructor({\r\n    syntaxCheck = true,\r\n  } = {}) {\r\n    this.syntaxCheck = syntaxCheck;\r\n  }\r\n\r\n  /**\r\n   * 词法分析\r\n   * @param input\r\n   * @returns {*[]}\r\n   */\r\n  lexical(input) {\r\n    let OPERATOR = /^(\\+|-|\\*|\\/|%|>|<|,|\\^|=|&|!|:|>=|<=|<>)$/;\r\n    let NUMBERS = /[0-9.]/;\r\n    let LETTERS = /[a-z0-9_$]/i;\r\n    // 文本字符长度\r\n    let { length } = input;\r\n    // 函数调用记录\r\n    let bracketsStack = [];\r\n    // 当前的字符索引\r\n    let current = 0;\r\n    // 处理的字符数组\r\n    let tokens = [];\r\n    // 循环处理所有字符\r\n    while (current < length) {\r\n      // 当前处理的字符\r\n      let char = input[current];\r\n      // 跳过连续空格\r\n      let SPACE = /\\s/;\r\n      if (SPACE.test(char)) {\r\n        const next = input[current + 1];\r\n        if (SPACE.test(next)) {\r\n          current++;\r\n          continue;\r\n        }\r\n      }\r\n      // 记录交叉区域运算符\r\n      if (SPACE.test(char)) {\r\n        const last = input[current - 1];\r\n        const next = input[current + 1];\r\n        if (LETTERS.test(last) && LETTERS.test(next)) {\r\n          tokens.push({\r\n            type: 'operator',\r\n            value: char,\r\n          });\r\n        }\r\n        current++;\r\n        continue;\r\n      }\r\n      // 记录括号\r\n      if (char === '(') {\r\n        tokens.push({\r\n          type: 'brackets',\r\n          value: '(',\r\n        });\r\n        bracketsStack.push({\r\n          type: 'brackets',\r\n          value: '(',\r\n        });\r\n        current++;\r\n        continue;\r\n      }\r\n      if (char === ')') {\r\n        const brackets = bracketsStack.pop();\r\n        if (brackets && brackets.type === 'function') {\r\n          tokens.push({\r\n            type: 'function',\r\n            value: ')',\r\n          });\r\n        } else {\r\n          tokens.push({\r\n            type: 'brackets',\r\n            value: ')',\r\n          });\r\n        }\r\n        current++;\r\n        continue;\r\n      }\r\n      // 记录数组\r\n      if (char === '{') {\r\n        tokens.push({\r\n          type: 'array',\r\n          value: 'array',\r\n        });\r\n        tokens.push({\r\n          type: 'array',\r\n          value: '{',\r\n        });\r\n        current++;\r\n        continue;\r\n      }\r\n      if (char === '}') {\r\n        tokens.push({\r\n          type: 'array',\r\n          value: '}',\r\n        });\r\n        current++;\r\n        continue;\r\n      }\r\n      // 记录字符串\r\n      if (char === '\"') {\r\n        let result = '';\r\n        current++;\r\n        char = input[current];\r\n        while (char !== '\"') {\r\n          if (current < length) {\r\n            result += char;\r\n            current++;\r\n            char = input[current];\r\n          } else {\r\n            break;\r\n          }\r\n        }\r\n        current++;\r\n        char = input[current];\r\n        tokens.push({\r\n          type: 'string',\r\n          value: result,\r\n        });\r\n        continue;\r\n      }\r\n      if (char === '\\'') {\r\n        let result = '';\r\n        current++;\r\n        char = input[current];\r\n        while (char !== '\\'') {\r\n          if (current < length) {\r\n            result += char;\r\n            current++;\r\n            char = input[current];\r\n          } else {\r\n            break;\r\n          }\r\n        }\r\n        current++;\r\n        char = input[current];\r\n        tokens.push({\r\n          type: 'string',\r\n          value: result,\r\n        });\r\n        continue;\r\n      }\r\n      // 记录运算符\r\n      if (OPERATOR.test(char)) {\r\n        let next = input[current + 1];\r\n        let result = `${char}${next}`;\r\n        if (OPERATOR.test(result)) {\r\n          tokens.push({\r\n            type: 'operator',\r\n            value: result,\r\n          });\r\n          current++;\r\n        } else {\r\n          tokens.push({\r\n            type: 'operator',\r\n            value: char,\r\n          });\r\n        }\r\n        current++;\r\n        continue;\r\n      }\r\n      // 记录数字值\r\n      if (NUMBERS.test(char)) {\r\n        let result = '';\r\n        while (NUMBERS.test(char)) {\r\n          if (current < length) {\r\n            result += char;\r\n            current++;\r\n            char = input[current];\r\n          } else {\r\n            break;\r\n          }\r\n        }\r\n        tokens.push({\r\n          type: 'number',\r\n          value: result,\r\n        });\r\n        continue;\r\n      }\r\n      // 记录函数名称, 参数名称, 操作数名称\r\n      if (LETTERS.test(char)) {\r\n        let result = '';\r\n        while (LETTERS.test(char)) {\r\n          if (current < length) {\r\n            result += char;\r\n            current++;\r\n            char = input[current];\r\n          } else {\r\n            break;\r\n          }\r\n        }\r\n        // 是否为函数名称\r\n        if (char === '(') {\r\n          tokens.push({\r\n            type: 'function',\r\n            value: result,\r\n          });\r\n          tokens.push({\r\n            type: 'function',\r\n            value: '(',\r\n          });\r\n          bracketsStack.push({\r\n            type: 'function',\r\n            value: '(',\r\n          });\r\n          current++;\r\n        } else {\r\n          tokens.push({\r\n            type: 'operand',\r\n            value: result,\r\n          });\r\n        }\r\n        continue;\r\n      }\r\n      // 无法识别的token\r\n      throw new TypeError(`无法识别的token ${char} `);\r\n    }\r\n    // 返回处理结果\r\n    if (this.syntaxCheck) {\r\n      return this.syntax(tokens);\r\n    }\r\n    return tokens;\r\n  }\r\n\r\n  /**\r\n   * 语法分析\r\n   * @param tokens\r\n   */\r\n  syntax(tokens) {\r\n    // 单引号对校验\r\n    let sQuotesStack = [];\r\n    // 双引号对校验\r\n    let dQuotesStack = [];\r\n    // 函数闭合标签校验\r\n    let callStack = [];\r\n    // 数组闭合标签校验\r\n    let arrayStack = [];\r\n    // 括号闭合标签校验\r\n    let bracketsStack = [];\r\n    // 当前的字符索引\r\n    let current = 0;\r\n    // tokens长度\r\n    let { length } = tokens;\r\n    // 忽略的数组token\r\n    let ignoreArray = (token) => {\r\n      if (token.type === 'array') {\r\n        return token.value === 'array';\r\n      }\r\n      return false;\r\n    };\r\n    // 忽略的函数token\r\n    let ignoreFunc = (token) => {\r\n      if (token.type === 'function') {\r\n        return token.value !== '(' && token.value !== ')';\r\n      }\r\n      return false;\r\n    };\r\n    // 跳过忽略的元素\r\n    let skipIgnoreToken = (dir, index) => {\r\n      if (dir === 'last') {\r\n        while (index >= 0) {\r\n          let token = tokens[index];\r\n          if (ignoreFunc(token)) {\r\n            index--;\r\n            continue;\r\n          }\r\n          if (ignoreArray(token)) {\r\n            index--;\r\n            continue;\r\n          }\r\n          return token;\r\n        }\r\n      }\r\n      if (dir === 'next') {\r\n        while (index < length) {\r\n          let token = tokens[index];\r\n          if (ignoreFunc(token)) {\r\n            index++;\r\n            continue;\r\n          }\r\n          if (ignoreArray(token)) {\r\n            index++;\r\n            continue;\r\n          }\r\n          return token;\r\n        }\r\n      }\r\n      return null;\r\n    };\r\n    // 检查数组\r\n    let checkArray = (dir, target) => {\r\n      let token = tokens[current];\r\n      let local = dir === 'last' ? '前面' : '后面';\r\n      if (token.value === '{') {\r\n        if (dir === 'last') {\r\n          switch (target.type) {\r\n            case 'array': {\r\n              if (target.value === '{') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'function': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'operator': {\r\n              if (target.value === ',') {\r\n                return;\r\n              }\r\n              return;\r\n            }\r\n          }\r\n        }\r\n        if (dir === 'next') {\r\n          switch (target.type) {\r\n            case 'string':\r\n            case 'array':\r\n            case 'number':\r\n            case 'operand': {\r\n              return;\r\n            }\r\n            case 'function': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      if (token.value === '}') {\r\n        if (dir === 'last') {\r\n          switch (target.type) {\r\n            case 'number':\r\n            case 'string':\r\n            case 'array':\r\n            case 'operand': {\r\n              return;\r\n            }\r\n            case 'function': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        if (dir === 'next') {\r\n          switch (target.type) {\r\n            case 'array': {\r\n              if (target.value === '}') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'function': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'operator': {\r\n              if (target.value === ',') {\r\n                return;\r\n              }\r\n              return;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      throw TypeError(`错误表达式 ${token.value} ${local} ${target.value}`);\r\n    };\r\n    // 检查数字和字符\r\n    let checkValue = (dir, target) => {\r\n      let token = tokens[current];\r\n      let local = dir === 'last' ? '前面' : '后面';\r\n      switch (target.type) {\r\n        case 'array': {\r\n          if (dir === 'last') {\r\n            if (target.value === '{') {\r\n              return;\r\n            }\r\n          }\r\n          if (dir === 'next') {\r\n            if (target.value === '}') {\r\n              return;\r\n            }\r\n          }\r\n          break;\r\n        }\r\n        case 'brackets': {\r\n          if (dir === 'last') {\r\n            if (target.value === '(') {\r\n              return;\r\n            }\r\n          }\r\n          if (dir === 'next') {\r\n            if (target.value === ')') {\r\n              return;\r\n            }\r\n          }\r\n          break;\r\n        }\r\n        case 'function': {\r\n          if (dir === 'last') {\r\n            if (target.value === '(') {\r\n              return;\r\n            }\r\n          }\r\n          if (dir === 'next') {\r\n            if (target.value === ')') {\r\n              return;\r\n            }\r\n          }\r\n          break;\r\n        }\r\n        case 'operator': {\r\n          return;\r\n        }\r\n      }\r\n      throw TypeError(`错误表达式 ${token.value} ${local} ${target.value}`);\r\n    };\r\n    // 检查运算符\r\n    let checkOperator = (dir, target) => {\r\n      let token = tokens[current];\r\n      let local = dir === 'last' ? '前面' : '后面';\r\n      switch (target.type) {\r\n        case 'brackets':\r\n        case 'function':\r\n        case 'string':\r\n        case 'number':\r\n        case 'operand': {\r\n          return;\r\n        }\r\n        case 'array': {\r\n          if (token.value === ',') {\r\n            return;\r\n          }\r\n          break;\r\n        }\r\n      }\r\n      throw TypeError(`错误表达式 ${token.value} ${local} ${target.value}`);\r\n    };\r\n    // 检查函数\r\n    let checkFunction = (dir, target) => {\r\n      let token = tokens[current];\r\n      let local = dir === 'last' ? '前面' : '后面';\r\n      if (token.value === '(') {\r\n        if (dir === 'last') {\r\n          switch (target.type) {\r\n            case 'array': {\r\n              if (target.value === '{') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'function': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'operator': {\r\n              return;\r\n            }\r\n          }\r\n        }\r\n        if (dir === 'next') {\r\n          switch (target.type) {\r\n            case 'function':\r\n            case 'string':\r\n            case 'number':\r\n            case 'operand': {\r\n              return;\r\n            }\r\n            case 'array': {\r\n              if (target.value === '{') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      if (token.value === ')') {\r\n        if (dir === 'last') {\r\n          switch (target.type) {\r\n            case 'function':\r\n            case 'number':\r\n            case 'string':\r\n            case 'operand': {\r\n              return;\r\n            }\r\n            case 'array': {\r\n              if (target.value === '}') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        if (dir === 'next') {\r\n          switch (target.type) {\r\n            case 'array': {\r\n              if (target.value === '}') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'function': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'operator': {\r\n              if (target.value === ',') {\r\n                return;\r\n              }\r\n              return;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      throw TypeError(`错误表达式 ${token.value} ${local} ${target.value}`);\r\n    };\r\n    // 循环处理所有token\r\n    while (current < length) {\r\n      // 当前处理的token\r\n      let token = tokens[current];\r\n      // 跳过忽略token\r\n      if (ignoreArray(token)) {\r\n        current++;\r\n        continue;\r\n      }\r\n      if (ignoreFunc(token)) {\r\n        current++;\r\n        continue;\r\n      }\r\n      let { type, value } = token;\r\n      // 处理单引号\r\n      if (type === \"'\") {\r\n        if (sQuotesStack.length) {\r\n          sQuotesStack.pop();\r\n        } else {\r\n          // 双引号中嵌套单引号\r\n          if (!dQuotesStack.length) {\r\n            sQuotesStack.push(\"'\");\r\n          }\r\n        }\r\n      }\r\n      // 处理双引号\r\n      if (type === '\"') {\r\n        if (dQuotesStack.length) {\r\n          dQuotesStack.pop();\r\n        } else {\r\n          // 单引号中嵌套双引号\r\n          if (!sQuotesStack.length) {\r\n            dQuotesStack.push('\"');\r\n          }\r\n        }\r\n      }\r\n      // 处理字符\r\n      if (type === 'string') {\r\n        let last = skipIgnoreToken('last', current - 1);\r\n        let next = skipIgnoreToken('next', current + 1);\r\n        if (last) {\r\n          checkValue('last', last);\r\n        }\r\n        if (next) {\r\n          checkValue('next', next);\r\n        }\r\n      }\r\n      // 处理数字\r\n      if (type === 'number') {\r\n        let last = skipIgnoreToken('last', current - 1);\r\n        let next = skipIgnoreToken('next', current + 1);\r\n        if (last) {\r\n          checkValue('last', last);\r\n        }\r\n        if (next) {\r\n          checkValue('next', next);\r\n        }\r\n      }\r\n      // 处理数组\r\n      if (type === 'array') {\r\n        if (value === '{') {\r\n          arrayStack.push(token);\r\n        }\r\n        if (value === '}') {\r\n          if (arrayStack.length === 0) {\r\n            throw new TypeError('数组缺少闭合标签');\r\n          }\r\n          arrayStack.pop();\r\n        }\r\n        let last = skipIgnoreToken('last', current - 1);\r\n        let next = skipIgnoreToken('next', current + 1);\r\n        if (last) {\r\n          checkArray('last', last);\r\n        }\r\n        if (next) {\r\n          checkArray('next', next);\r\n        }\r\n      }\r\n      // 处理函数调用\r\n      if (type === 'function') {\r\n        if (value === '(') {\r\n          callStack.push(token);\r\n        }\r\n        if (value === ')') {\r\n          callStack.pop();\r\n        }\r\n        let last = skipIgnoreToken('last', current - 1);\r\n        let next = skipIgnoreToken('next', current + 1);\r\n        if (last) {\r\n          checkFunction('last', last);\r\n        }\r\n        if (next) {\r\n          checkFunction('next', next);\r\n        }\r\n      }\r\n      // 处理运算符号\r\n      if (type === 'operator') {\r\n        let last = skipIgnoreToken('last', current - 1);\r\n        let next = skipIgnoreToken('next', current + 1);\r\n        // 运算符需要两边都有操作数\r\n        if (last) {\r\n          checkOperator('last', last);\r\n        } else {\r\n          throw TypeError(`错误表达式: ${token.value} 错误`);\r\n        }\r\n        if (next) {\r\n          checkOperator('next', next);\r\n        } else {\r\n          throw TypeError(`错误表达式: ${token.value} 错误`);\r\n        }\r\n      }\r\n      // 处理括号\r\n      if (type === 'brackets') {\r\n        if (value === '(') {\r\n          bracketsStack.push(token);\r\n        }\r\n        if (value === ')') {\r\n          if (bracketsStack.length === 0) {\r\n            throw new TypeError('括号缺少闭合标签');\r\n          }\r\n          bracketsStack.pop();\r\n        }\r\n      }\r\n      // 处理下一个字符\r\n      current++;\r\n    }\r\n    // 闭合标签检查\r\n    if (arrayStack.length) {\r\n      throw new TypeError('数组缺少闭合标签');\r\n    }\r\n    if (callStack.length) {\r\n      throw new TypeError('函数缺少闭合标签');\r\n    }\r\n    if (sQuotesStack.length) {\r\n      throw new TypeError('单引号缺少闭合标签');\r\n    }\r\n    if (dQuotesStack.length) {\r\n      throw new TypeError('双引号缺少闭合标签');\r\n    }\r\n    if (bracketsStack.length) {\r\n      throw new TypeError('括号缺少闭合标签');\r\n    }\r\n    return tokens;\r\n  }\r\n}\r\n\r\n/**\r\n * 编译表达式\r\n */\r\nclass Compiler {\r\n\r\n  /**\r\n   * Compiler\r\n   * @param tokens\r\n   * @param writer\r\n   */\r\n  constructor({\r\n    tokens, writer,\r\n  } = {}) {\r\n    this.writer = writer;\r\n    this.tokens = tokens;\r\n    this.groupStack = [];\r\n    this.index = -1;\r\n    this.ignore = [','];\r\n    // 运算符\r\n    this.opIf = {\r\n      '>': 'ifge',\r\n      '<': 'ifgt',\r\n      '=': 'ifeq',\r\n      '>=': 'if_icmpge',\r\n      '<=': 'if_icmpgt',\r\n      '<>': 'ifne',\r\n    };\r\n    this.opAdd = {\r\n      '+': 'add',\r\n      '-': 'sub',\r\n      '&': 'link',\r\n    };\r\n    this.opMul = {\r\n      '*': 'mul',\r\n      '/': 'div',\r\n      '%': 'mod',\r\n      '^': 'power',\r\n    };\r\n    this.opCommon = {\r\n      ' ': 'common',\r\n    };\r\n    this.opRel = {\r\n      '!': 'rel',\r\n      ':': 'uni',\r\n    };\r\n    this.opNew = {\r\n      array: 'newarray',\r\n    };\r\n    this.opCell = {\r\n      function: 'invoke',\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 结束\r\n   */\r\n  eofToken() {\r\n    const { index, tokens } = this;\r\n    const { length } = tokens;\r\n    return index >= length - 1;\r\n  }\r\n\r\n  /**\r\n   * 切换下一个Token\r\n   */\r\n  nextToken() {\r\n    this.index++;\r\n    this.token = this.tokens[this.index];\r\n    return this.token;\r\n  }\r\n\r\n  /**\r\n   * 返回上一个Token\r\n   */\r\n  backToken() {\r\n    this.index--;\r\n    this.token = this.tokens[this.index];\r\n    return this.token;\r\n  }\r\n\r\n  /**\r\n   * 记录参数\r\n   */\r\n  reduceGroup() {\r\n    const { groupStack } = this;\r\n    const { length } = groupStack;\r\n    if (length > 0) {\r\n      const last = groupStack[length - 1];\r\n      const number = last.number;\r\n      last.number = number - 1;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 记录参数\r\n   */\r\n  increaseGroup() {\r\n    const { groupStack } = this;\r\n    const { length } = groupStack;\r\n    if (length > 0) {\r\n      const last = groupStack[length - 1];\r\n      const number = last.number;\r\n      last.number = number + 1;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 弹出组\r\n   */\r\n  popGroup() {\r\n    return this.groupStack.pop();\r\n  }\r\n\r\n  /**\r\n   * 添加组\r\n   */\r\n  addGroup(token) {\r\n    token.number = 0;\r\n    this.groupStack.push(token);\r\n    return token;\r\n  }\r\n\r\n  /**\r\n   * 忽略的Token\r\n   * @returns {*}\r\n   */\r\n  isSkipNextToken() {\r\n    if (!this.eofToken()) {\r\n      const { ignore } = this;\r\n      this.nextToken();\r\n      const { token } = this;\r\n      this.backToken();\r\n      const { value } = token;\r\n      return ignore.includes(value);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * 编译表达式\r\n   */\r\n  compile() {\r\n    const { writer } = this;\r\n    this.compileIfge();\r\n    while (this.isSkipNextToken()) {\r\n      this.nextToken();\r\n      this.compileIfge();\r\n    }\r\n    return writer.getInstruct();\r\n  }\r\n\r\n  /**\r\n   * 编译条件运算\r\n   */\r\n  compileIfge() {\r\n    this.compileAdd();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'operator') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      if (!this.opIf[value]) {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      let operator = this.opIf[value];\r\n      this.compileAdd();\r\n      this.reduceGroup();\r\n      this.writer.writeOperator(operator);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 编译加减运算\r\n   */\r\n  compileAdd() {\r\n    this.compileMul();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'operator') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      if (!this.opAdd[value]) {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      let operator = this.opAdd[value];\r\n      this.compileMul();\r\n      this.reduceGroup();\r\n      this.writer.writeOperator(operator);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 编译乘除运算\r\n   */\r\n  compileMul() {\r\n    this.compileCommon();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'operator') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      if (!this.opMul[value]) {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      let operator = this.opMul[value];\r\n      this.compileCommon();\r\n      this.reduceGroup();\r\n      this.writer.writeOperator(operator);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 编译公共区域运算\r\n   */\r\n  compileCommon() {\r\n    this.compileRel();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'operator') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      if (!this.opCommon[value]) {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      let operator = this.opCommon[value];\r\n      this.compileRel();\r\n      this.reduceGroup();\r\n      this.writer.writeOperator(operator);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 编译跨Sheet引用运算\r\n   */\r\n  compileRel() {\r\n    this.compileArray();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'operator') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      if (!this.opRel[value]) {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      let operator = this.opRel[value];\r\n      this.compileArray();\r\n      this.reduceGroup();\r\n      this.writer.writeOperator(operator);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 编译数组创建\r\n   */\r\n  compileArray() {\r\n    this.compileFunction();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'array') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      // 返回跳过 } 标记\r\n      if (value === '}') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      this.addGroup(token);\r\n      // 跳过当前 {  标记\r\n      this.nextToken();\r\n      // 处理数组中的子元素\r\n      this.compileIfge();\r\n      // 下一个是忽略的标记\r\n      // 则继续处理\r\n      while (this.isSkipNextToken()) {\r\n        this.nextToken();\r\n        this.compileIfge();\r\n      }\r\n      // 记录数组需要\r\n      // 操作的元素数量\r\n      this.popGroup();\r\n      const { number } = token;\r\n      const operator = this.opNew[type];\r\n      this.writer.writeOperator(`${operator} ${number}`);\r\n      // 跳过闭合标签 }\r\n      this.nextToken();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 编译函数调用\r\n   */\r\n  compileFunction() {\r\n    this.compilePushValue();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'function') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      // 返回跳过 ) 标记\r\n      if (value === ')') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      this.addGroup(token);\r\n      // 跳过当前 (  标记\r\n      this.nextToken();\r\n      // 处理函数的参数列表\r\n      this.compileIfge();\r\n      // 下一个是忽略的标记\r\n      // 则继续处理\r\n      while (this.isSkipNextToken()) {\r\n        this.nextToken();\r\n        this.compileIfge();\r\n      }\r\n      // 记录函数需要\r\n      // 操作的元素数量\r\n      this.popGroup();\r\n      const { number } = token;\r\n      const operator = this.opCell[type];\r\n      this.writer.writeOperator(`${operator} ${value} ${number}`);\r\n      // 跳过闭合标签 )\r\n      this.nextToken();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * compilePushValue\r\n   */\r\n  compilePushValue() {\r\n    if (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { writer } = this;\r\n      const { type, value } = token;\r\n      // 推送操作数\r\n      // 递增函数/数组的参数数量(有的话)\r\n      switch (type) {\r\n        case 'string': {\r\n          this.increaseGroup();\r\n          writer.writeString(`${value}`);\r\n          return;\r\n        }\r\n        case 'number': {\r\n          this.increaseGroup();\r\n          writer.writeNumber(`${value}`);\r\n          return;\r\n        }\r\n        case 'operand': {\r\n          this.increaseGroup();\r\n          writer.writeOperand(value);\r\n          return;\r\n        }\r\n      }\r\n      // 处理括号计算\r\n      switch (type) {\r\n        case 'brackets': {\r\n          if (value === '(') {\r\n            this.compileIfge();\r\n            // 下一个是忽略的标记\r\n            // 则继续处理\r\n            while (this.isSkipNextToken()) {\r\n              this.nextToken();\r\n              this.compileIfge();\r\n            }\r\n            // 跳过闭合标签 )\r\n            this.nextToken();\r\n          }\r\n          return;\r\n        }\r\n      }\r\n      // 递增函数/数组的参数数量(有的话)\r\n      switch (type) {\r\n        case 'array': {\r\n          // {} 这种清空不需要增加参数数量\r\n          if (value !== '}') {\r\n            this.increaseGroup();\r\n          }\r\n          this.backToken();\r\n          return;\r\n        }\r\n        case 'function': {\r\n          // func() 这种清空不需要增加参数数量\r\n          if (value !== ')') {\r\n            this.increaseGroup();\r\n          }\r\n          this.backToken();\r\n          return;\r\n        }\r\n      }\r\n      // 过滤掉运算符\r\n      switch (type) {\r\n        case 'operator': {\r\n          this.backToken();\r\n          return;\r\n        }\r\n      }\r\n      // 无法识别的token\r\n      throw new TypeError(`无法识别的token ${type} ${value} `);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * 运行表达式\r\n */\r\nclass Evaluation {\r\n\r\n  /**\r\n   * Evaluate\r\n   * @param instruct\r\n   */\r\n  constructor(instruct) {\r\n    this.instruct = instruct.split('\\r\\n');\r\n    this.memory = [];\r\n  }\r\n\r\n  /**\r\n   * 运行表达式\r\n   */\r\n  eval() {\r\n    const newArray = /^newarray/;\r\n    const invoke = /^invoke/;\r\n    const pushSRegexp = /^SPush/;\r\n    const pushNRegexp = /^NPush/;\r\n    const pushORegexp = /^OPush/;\r\n    const { instruct } = this;\r\n    instruct.forEach((name) => {\r\n      switch (name) {\r\n        case 'if_icmpge': {\r\n          this.ificmpge();\r\n          break;\r\n        }\r\n        case 'if_icmpgt': {\r\n          this.ificmpgt();\r\n          break;\r\n        }\r\n        case 'ifge': {\r\n          this.ifge();\r\n          break;\r\n        }\r\n        case 'ifgt': {\r\n          this.ifgt();\r\n          break;\r\n        }\r\n        case 'ifeq': {\r\n          this.ifeq();\r\n          break;\r\n        }\r\n        case 'ifne': {\r\n          this.ifne();\r\n          break;\r\n        }\r\n        case 'add': {\r\n          this.add();\r\n          break;\r\n        }\r\n        case 'sub': {\r\n          this.sub();\r\n          break;\r\n        }\r\n        case 'mul': {\r\n          this.mul();\r\n          break;\r\n        }\r\n        case 'div': {\r\n          this.div();\r\n          break;\r\n        }\r\n        case 'mod': {\r\n          this.mod();\r\n          break;\r\n        }\r\n        case 'power': {\r\n          this.power();\r\n          break;\r\n        }\r\n        case 'rel': {\r\n          this.rel();\r\n          break;\r\n        }\r\n        case 'link': {\r\n          this.link();\r\n          break;\r\n        }\r\n        case 'uni': {\r\n          this.uni();\r\n          break;\r\n        }\r\n        case 'common': {\r\n          this.common();\r\n          break;\r\n        }\r\n        default: {\r\n          if (newArray.test(name)) {\r\n            const group = name.split(' ');\r\n            const index = group[1];\r\n            this.array(index);\r\n            break;\r\n          }\r\n          if (invoke.test(name)) {\r\n            const group = name.split(' ');\r\n            const func = group[1];\r\n            const index = group[2];\r\n            this.invoke(func, index);\r\n            break;\r\n          }\r\n          if (pushSRegexp.test(name)) {\r\n            const value = name.split(' ')[1];\r\n            this.pushS(value);\r\n            break;\r\n          }\r\n          if (pushNRegexp.test(name)) {\r\n            const value = name.split(' ')[1];\r\n            this.pushN(value);\r\n            break;\r\n          }\r\n          if (pushORegexp.test(name)) {\r\n            const value = name.split(' ')[1];\r\n            this.pushO(value);\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    });\r\n    return this.memory.pop();\r\n  }\r\n\r\n  /**\r\n   * 推送操作数\r\n   * @param value\r\n   */\r\n  pushS(value) {\r\n    this.memory.push(value);\r\n  }\r\n\r\n  /**\r\n   * 推送操作数\r\n   * @param value\r\n   */\r\n  pushN(value) {\r\n    value = parseFloat(value);\r\n    this.memory.push(value);\r\n  }\r\n\r\n  /**\r\n   * 推送操作数\r\n   * @param value\r\n   */\r\n  pushO(value) {\r\n    this.memory.push(value);\r\n  }\r\n\r\n  /**\r\n   * 两个值的大于比较\r\n   */\r\n  ifge() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a > b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的小于比较\r\n   */\r\n  ifgt() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a < b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的相等比较\r\n   */\r\n  ifeq() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a === b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的不等比较\r\n   */\r\n  ifne() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a !== b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的大于等于比较\r\n   */\r\n  ificmpge() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a >= b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的小于等于比较\r\n   */\r\n  ificmpgt() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a <= b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的加法运算\r\n   */\r\n  add() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a + b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的减法运算\r\n   */\r\n  sub() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a - b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的乘法运算\r\n   */\r\n  mul() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a * b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的除法运算\r\n   */\r\n  div() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a / b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的mod运算\r\n   */\r\n  mod() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a % b);\r\n  }\r\n\r\n  /**\r\n   * 计算两个区域的并集\r\n   */\r\n  common() {\r\n    // TODO ...\r\n    // ....\r\n  }\r\n\r\n  /**\r\n   * 跨sheet引用运算\r\n   */\r\n  rel() {\r\n    // TODO ...\r\n    // ....\r\n  }\r\n\r\n  /**\r\n   * 计算两个区域连接的新区域\r\n   */\r\n  uni() {\r\n    // TODO ...\r\n    // ....\r\n  }\r\n\r\n  /**\r\n   * 字符串连接运算\r\n   */\r\n  link() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(`${a}${b}`);\r\n  }\r\n\r\n  /**\r\n   * 乘方计算\r\n   */\r\n  power() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(Math.pow(a, b));\r\n  }\r\n\r\n  /**\r\n   * 创建数组\r\n   * @param index\r\n   */\r\n  array(index) {\r\n    const array = [];\r\n    for (let i = 1; i <= index; i++) {\r\n      const item = this.memory.pop();\r\n      array.push(item);\r\n    }\r\n    array.reverse();\r\n    this.memory.push(array);\r\n  }\r\n\r\n  /**\r\n   * 执行函数\r\n   * @param func\r\n   * @param index\r\n   */\r\n  invoke(func, index) {\r\n    const array = [];\r\n    for (let i = 1; i <= index; i++) {\r\n      const item = this.memory.pop();\r\n      array.push(item);\r\n    }\r\n    array.reverse();\r\n    const execute = Functions.getFunction(func);\r\n    const result = execute.apply(this, array);\r\n    this.memory.push(result);\r\n  }\r\n}\r\n\r\n/**\r\n * 编译输出指令\r\n * @param input\r\n * @returns {string|*}\r\n * @constructor\r\n */\r\nconst Compile = (input) => {\r\n  if (input.startsWith('=')) {\r\n    input = input.substring(1);\r\n  }\r\n  const tokenizer = new Tokenizer();\r\n  const writer = new Assembly();\r\n  const tokens = tokenizer.lexical(input);\r\n  const compiler = new Compiler({\r\n    writer, tokens,\r\n  });\r\n  return compiler.compile();\r\n};\r\n\r\n/**\r\n * 运行指令\r\n * @param inst\r\n * @returns {*}\r\n * @constructor\r\n */\r\nconst Instruct = (inst) => {\r\n  const evaluation = new Evaluation(inst);\r\n  return evaluation.eval();\r\n};\r\n\r\n/**\r\n * 编译运行\r\n * @constructor\r\n */\r\nconst Evaluate = input => Instruct(Compile(input));\r\n\r\nexport {\r\n  Tokenizer,\r\n  Compiler,\r\n  Assembly,\r\n  Compile,\r\n  Evaluate,\r\n  Instruct,\r\n  Functions,\r\n};\r\n","import { Compile, Instruct } from './Compiler';\r\nimport { SheetUtils } from '../utils/SheetUtils';\r\n\r\n/**\r\n * Formula\r\n */\r\nclass Formula {\r\n\r\n  /**\r\n   * Formula\r\n   * @param expr\r\n   */\r\n  constructor({\r\n    expr = SheetUtils.EMPTY,\r\n  } = {}) {\r\n    this.expr = expr;\r\n    this.content = SheetUtils.Nul;\r\n    this.instruct = SheetUtils.Nul;\r\n  }\r\n\r\n  /**\r\n   * 计算公式\r\n   * @return {string}\r\n   */\r\n  getValue() {\r\n    let { expr } = this;\r\n    let { content } = this;\r\n    let { instruct } = this;\r\n    if (!content) {\r\n      if (!instruct) {\r\n        instruct = Compile(expr);\r\n      }\r\n      content = Instruct(instruct);\r\n    }\r\n    this.content = content;\r\n    this.instruct = instruct;\r\n    return content;\r\n  }\r\n\r\n  /**\r\n   * 有效的表达式\r\n   * @return {boolean}\r\n   */\r\n  hasExpr() {\r\n    let { expr } = this;\r\n    return !SheetUtils.isBlank(expr);\r\n  }\r\n\r\n  /**\r\n   * 获取表达式\r\n   * @return {string}\r\n   */\r\n  getExpr() {\r\n    return this.expr;\r\n  }\r\n\r\n  /**\r\n   * 设置表达式\r\n   * @param expr\r\n   */\r\n  setExpr(expr) {\r\n    this.expr = expr;\r\n    this.content = SheetUtils.Nul;\r\n    this.instruct = SheetUtils.Nul;\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  Formula,\r\n};\r\n","import { SheetUtils } from '../../../utils/SheetUtils';\nimport { CellFont } from './CellFont';\nimport { CellBorder } from './CellBorder';\nimport { XIcon } from '../tableicon/XIcon';\nimport XTableFormat from '../XTableTextFormat';\nimport { RichFonts } from './RichFonts';\nimport { Formula } from '../../../formula/Formula';\nimport { DateUtils } from '../../../utils/DateUtils';\n\n/**\n * 单元格\n */\nclass Cell {\n\n  /**\n   * Cell\n   * @param background\n   * @param format\n   * @param text\n   * @param richText\n   * @param ruler\n   * @param custom\n   * @param icons\n   * @param borderAttr\n   * @param fontAttr\n   * @param expr\n   * @param contentWidth\n   * @param contentHeight\n   * @param contentType\n   */\n  constructor({\n    background = SheetUtils.Undef,\n    expr = SheetUtils.Undef,\n    ruler = SheetUtils.Undef,\n    rich = SheetUtils.Undef,\n    text = SheetUtils.EMPTY,\n    format = 'default',\n    icons = [],\n    custom = {},\n    borderAttr = {},\n    fontAttr = {},\n    contentWidth = 0,\n    contentHeight = 0,\n    contentType = Cell.TYPE.STRING,\n  } = {}) {\n    // 背景颜色\n    this.background = background;\n    // 单元格图标\n    this.icons = XIcon.newInstances(icons);\n    // 自定义属性\n    this.custom = custom;\n    // 字体测量尺子\n    this.ruler = ruler;\n    // 格式化类型\n    this.format = format;\n    // 单元格公式\n    this.formula = new Formula({ expr });\n    // 文本内容\n    this.text = text;\n    // 富文本内容\n    this.richText = new RichFonts({ rich });\n    // 格式化后的内容\n    this.formatText = SheetUtils.EMPTY;\n    // 内容的高度\n    this.contentHeight = contentHeight;\n    // 内容的宽度\n    this.contentWidth = contentWidth;\n    // 字体属性\n    this.fontAttr = new CellFont(fontAttr);\n    // 边框属性\n    this.borderAttr = new CellBorder(borderAttr);\n    // 内容类型\n    this.setContentType(contentType);\n  }\n\n  /**\n   * 设置单元格小图标\n   * @param icons\n   */\n  setIcons(icons) {\n    this.icons = icons;\n    return this;\n  }\n\n  /**\n   * 设置内容文本\n   * @param text\n   */\n  setText(text) {\n    this.formatText = null;\n    this.text = text;\n    this.formula.setExpr(null);\n    this.richText.setRich([]);\n    this.setContentWidth(0);\n    return this;\n  }\n\n  /**\n   * 设置富文本\n   */\n  setRichText(rich) {\n    this.formatText = null;\n    this.text = null;\n    this.formula.setExpr(null);\n    this.richText.setRich(rich);\n    this.setContentWidth(0);\n    return this;\n  }\n\n  /**\n   * 设置公式\n   */\n  setExpr(expr) {\n    this.formatText = null;\n    this.text = null;\n    this.formula.setExpr(expr);\n    this.richText.setRich([]);\n    this.setContentWidth(0);\n    return this;\n  }\n\n  /**\n   * 获取公式\n   */\n  getExpr() {\n    return this.formula.getExpr();\n  }\n\n  /**\n   * 设置格式化类型\n   * @param format\n   */\n  setFormat(format = 'default') {\n    this.format = format;\n    this.formatText = null;\n    this.setContentWidth(0);\n    return this;\n  }\n\n  /**\n   * 保存测量尺子\n   * @param ruler\n   */\n  setRuler(ruler) {\n    this.ruler = ruler;\n    return this;\n  }\n\n  /**\n   * 设置内容类型\n   * @param type\n   */\n  setContentType(type = Cell.TYPE.STRING) {\n    const { text } = this;\n    switch (type) {\n      case Cell.TYPE.STRING: {\n        this.contentType = Cell.TYPE.STRING;\n        break;\n      }\n      case Cell.TYPE.NUMBER: {\n        this.contentType = type;\n        if (SheetUtils.isNumber(text)) {\n          this.contentType = Cell.TYPE.NUMBER;\n          this.text = SheetUtils.parseFloat(text);\n        } else {\n          this.contentType = Cell.TYPE.STRING;\n          this.text = `${text}`;\n        }\n        break;\n      }\n      case Cell.TYPE.DATE_TIME: {\n        const parse = DateUtils.parse(text);\n        if (SheetUtils.isDate(parse)) {\n          this.contentType = Cell.TYPE.DATE_TIME;\n          this.text = SheetUtils.parseFloat(text);\n        } else {\n          this.contentType = Cell.TYPE.STRING;\n          this.text = `${text}`;\n        }\n        break;\n      }\n      case Cell.TYPE.RICH_TEXT: {\n        this.contentType = Cell.TYPE.RICH_TEXT;\n        break;\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 单元格是否为空\n   * @returns {boolean}\n   */\n  isEmpty() {\n    return SheetUtils.isBlank(this.getComputeText());\n  }\n\n  /**\n   * 公式是否存在\n   */\n  hasFormula() {\n    return this.formula.hasExpr();\n  }\n\n  /**\n   * 获取格式后的文本\n   * @returns {string|*}\n   */\n  getFormatText() {\n    let { text, formula, format } = this;\n    let { formatText } = this;\n    let { contentType } = this;\n    // 优先获取公式值\n    if (formula.hasExpr()) {\n      let value = formula.getValue();\n      if (value) {\n        if (SheetUtils.isBlank(formatText)) {\n          formatText = XTableFormat(format, value);\n        }\n      }\n      this.formatText = formatText;\n      return formatText;\n    }\n    // 格式化文本\n    switch (contentType) {\n      case Cell.TYPE.STRING:\n      case Cell.TYPE.NUMBER:\n      case Cell.TYPE.DATE_TIME: {\n        if (format) {\n          if (!formatText) {\n            this.formatText = XTableFormat(format, text);\n            return this.formatText;\n          }\n        }\n        return formatText;\n      }\n    }\n    // 默认返回\n    return SheetUtils.EMPTY;\n  }\n\n  /**\n   * 获取计算后的文本\n   * @returns {string|*}\n   */\n  getComputeText() {\n    let { text, formula } = this;\n    let { richText } = this;\n    let { contentType } = this;\n    // 优先获取公式值\n    if (formula.hasExpr()) {\n      return formula.getValue();\n    }\n    // 读取不同类型\n    switch (contentType) {\n      case Cell.TYPE.STRING:\n      case Cell.TYPE.NUMBER:\n      case Cell.TYPE.DATE_TIME: {\n        return text;\n      }\n      case Cell.TYPE.RICH_TEXT: {\n        return richText;\n      }\n    }\n    // 默认返回\n    return SheetUtils.EMPTY;\n  }\n\n  /**\n   * 字体属性\n   * @param attr\n   */\n  setFontAttr(attr) {\n    this.fontAttr = attr;\n    return this;\n  }\n\n  /**\n   * 设置边框类型\n   * @param attr\n   */\n  setBorderAttr(attr) {\n    this.borderAttr = attr;\n    return this;\n  }\n\n  /**\n   * 复制单元格\n   * @returns {Cell}\n   */\n  clone() {\n    const { background, text, format, custom } = this;\n    const { icons, contentType, formula } = this;\n    const { richText, fontAttr, borderAttr } = this;\n    return new Cell({\n      background,\n      format,\n      text,\n      custom,\n      expr: formula.getExpr(),\n      rich: richText.getRich(),\n      fontAttr,\n      borderAttr,\n      icons,\n      contentType,\n    });\n  }\n\n  /**\n   * toJSON\n   */\n  toJSON() {\n    const { background, text, format, custom } = this;\n    const { icons, contentType, formula } = this;\n    const { richText, fontAttr, borderAttr } = this;\n    return {\n      custom,\n      expr: formula.getExpr(),\n      rich: richText.getRich(),\n      contentType,\n      text,\n      icons,\n      background,\n      format,\n      fontAttr,\n      borderAttr,\n    };\n  }\n\n  /**\n   * toString\n   * @returns {string|*}\n   */\n  toString() {\n    return this.getFormatText();\n  }\n\n  /**\n   * 内容宽度\n   * @param width\n   */\n  setContentWidth(width) {\n    this.contentWidth = width;\n    return this;\n  }\n\n  /**\n   * 内容宽度\n   * @param height\n   */\n  setContentHeight(height) {\n    this.contentHeight = height;\n    return this;\n  }\n\n}\n\n/**\n * 单元格类型\n */\nCell.TYPE = {\n  // 数字\n  NUMBER: 0,\n  // 字符\n  STRING: 1,\n  // 富文本\n  RICH_TEXT: 2,\n  // 日期\n  DATE_TIME: 3,\n};\n\nexport {\n  Cell,\n};\n","import { Cell } from '../../core/xtable/tablecell/Cell';\r\n\r\naddEventListener('message', (event) => {\r\n  const { data } = event;\r\n  let total = 0;\r\n  let number = 0;\r\n  for (let i = 0, len = data.length; i < len; i++) {\r\n    let row = data[i];\r\n    if (row) {\r\n      for (let j = 0, len = row.length; j < len; j++) {\r\n        let item = row[j];\r\n        if (item) {\r\n          let { cell } = item;\r\n          if (cell) {\r\n            switch (cell.contentType) {\r\n              // 数字类型\r\n              case Cell.TYPE.NUMBER:\r\n                total += cell.text;\r\n                number++;\r\n                break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  postMessage({ total, number });\r\n});\r\n"],"sourceRoot":""}