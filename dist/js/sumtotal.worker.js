!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(){return(65536*(1+Math.random())|0).toString(16).substring(1)}n.r(t);var a=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],s={String:1,Boolean:2,Number:3,Object:4,Array:5,Function:6,Null:7,Undefined:8,Promise:9,GeneratorFunction:10,AsyncFunction:11,BigInt:12,Symbol:13,DedicatedWorkerGlobalScope:14,Date:15,Un:0},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,u;return t=e,n=null,u=[{key:"isWindows",value:function(){return/windows|win32/i.test(navigator.userAgent)}},{key:"isMac",value:function(){return/macintosh|mac os x/i.test(navigator.userAgent)}},{key:"isNotEmptyObject",value:function(t){return!e.isEmptyObject(t)}},{key:"isEmptyObject",value:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}},{key:"isUnDef",value:function(e){return null==e}},{key:"isNotUnDef",value:function(e){return!this.isUnDef(e)}},{key:"isNumber",value:function(e){return/^(-?\d+.\d+)$|^(-?\d+)$/.test(e)}},{key:"isFraction",value:function(e){return/^\d+\/\d+$/.test(e)}},{key:"isDate",value:function(t){return e.type(t)===s.Date}},{key:"isFunction",value:function(t){return e.type(t)===s.Function}},{key:"isArray",value:function(t){return e.type(t)===s.Array}},{key:"isLikeArray",value:function(t){return!e.isUnDef(t)&&"number"==typeof t.length}},{key:"isBlank",value:function(t){return!!e.isUnDef(t)||""===t.toString().trim()}},{key:"isPlainObject",value:function(t){return!e.isUnDef(t)&&Object.getPrototypeOf(t)===Object.getPrototypeOf({})}},{key:"isString",value:function(t){return e.type(t)===s.String}},{key:"isChildType",value:function(e,t){return e instanceof t}},{key:"toLowCase",value:function(e){return e.toLowerCase()}},{key:"type",value:function(e){var t=Object.prototype.toString.call(e);switch(t){case"[object Null]":return s.Null;case"[object Object]":return s.Object;case"[object Undefined]":return s.Undefined;case"[object String]":return s.String;case"[object Boolean]":return s.Boolean;case"[object Number]":return s.Number;case"[object Function]":return s.Function;case"[object Array]":return s.Array;case"[object Promise]":return s.Promise;case"[object GeneratorFunction]":return s.GeneratorFunction;case"[object AsyncFunction]":return s.AsyncFunction;case"[object BigInt]":return s.BigInt;case"[object Symbol]":return s.Symbol;case"[object Date]":return s.Date;case"[object DedicatedWorkerGlobalScope]":return s.DedicatedWorkerGlobalScope;default:return s.Un}}},{key:"copy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.isUnDef(t))return{};for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return e.isUnDef(r)||0===r.length||r.forEach((function(n){e.isUnDef(n)||Object.keys(n).forEach((function(r){var i=n[r];"string"==typeof i||"number"==typeof i||"boolean"==typeof i?t[r]=i:"function"!=typeof i&&!Array.isArray(i)&&e.isPlainObject(i)?(t[r]=t[r]||{},e.copy(t[r],i)):t[r]=i}))})),t}},{key:"cloneDeep",value:function(e){var t=JSON.stringify(e);return JSON.parse(t)}},{key:"extends",value:function(e){for(var t=0,n=arguments.length<=1?0:arguments.length-1;t<n;t++){var r=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];for(var i in r)if(r.hasOwnProperty(i)){var o=r[i];o&&(e[i]=o)}}return e}},{key:"sum",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e},n=0,r=0;return Object.keys(e).forEach((function(i){n+=t(e[i],i),r+=1})),[n,r]}},{key:"parseFloat",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(t){return e.isNumber(t)?parseFloat(t):0}))},{key:"parseInt",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(t){return e.isNumber(t)?parseInt(t,10):0}))},{key:"stringAt",value:function(e){for(var t="",n=e;n>=a.length;)n/=a.length,n-=1,t+=a[parseInt(n,10)%a.length];return t+=a[e%a.length]}},{key:"indexAt",value:function(e){for(var t=0,n=0;n<e.length-1;n+=1){var r=e.charCodeAt(n)-65,i=e.length-1-n;t+=Math.pow(a.length,i)+a.length*r}return t+=e.charCodeAt(e.length-1)-65}},{key:"expr2xy",value:function(t){for(var n="",r="",i=0;i<t.length;i+=1)t.charAt(i)>="0"&&t.charAt(i)<="9"?r+=t.charAt(i):n+=t.charAt(i);return[e.indexAt(n),parseInt(r,10)-1]}},{key:"xy2expr",value:function(t,n){return"".concat(e.stringAt(t)).concat(n+1)}},{key:"expr2expr",value:function(t,n,i){var o=r(e.expr2xy(t),2),a=o[0],s=o[1];return e.xy2expr(a+n,s+i)}},{key:"minIf",value:function(e,t){return e<t?t:e}},{key:"keepLastIndex",value:function(e){var t=window.getSelection();t.selectAllChildren(e),t.collapseToEnd()}},{key:"trim",value:function(e){return this.isBlank(e)?"":e.trim()}},{key:"now",value:function(){return Date.now().toString()}},{key:"viewPort",value:function(){return{width:window.innerWidth,height:window.innerHeight}}},{key:"exitFullscreen",value:function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}},{key:"fullScreen",value:function(e){e.el&&(e=e.el),e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}},{key:"isFull",value:function(){return!!(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)}},{key:"uuid",value:function(){return"".concat(o()+o()).concat(o()).concat(o()).concat(o()).concat(o()).concat(o()).concat(o())}},{key:"getExplorerInfo",value:function(){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("firefox")>=0?{type:"Firefox",version:e.match(/firefox\/([\d.]+)/)[1]}:e.indexOf("chrome")>=0?{type:"Chrome",version:e.match(/chrome\/([\d.]+)/)[1]}:e.indexOf("opera")>=0?{type:"Opera",version:e.match(/opera.([\d.]+)/)[1]}:e.indexOf("safari")>=0?{type:"Safari",version:e.match(/version\/([\d.]+)/)[1]}:e.indexOf("msie")>=0?{type:"IE",version:e.match(/msie ([\d.]+)/)[1]}:void 0}},{key:"arrayLast",value:function(e){return e[e.length-1]}},{key:"arrayHead",value:function(e){return e[0]}},{key:"blankClear",value:function(t){return e.isString(t)?t.replace(/\s*/g,e.EMPTY):t}},{key:"equals",value:function(t,n){return!e.isUnDef(t)&&!e.isUnDef(n)&&JSON.stringify(t)===JSON.stringify(n)}},{key:"toFixed",value:function(e,t){return e.toString().indexOf(".")>-1?e.toFixed(t):e}},{key:"safeValue",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.isUnDef(t)?n:t}},{key:"inWorker",value:function(){return e.type(self)===s.DedicatedWorkerGlobalScope}},{key:"if",value:function(e,t,n){return e?t():n()}},{key:"slice",value:function(e){return Array.prototype.slice.call(e)}},{key:"clearBlank",value:function(e){return e.replace(/\s/g,"")}}],n&&i(t.prototype,n),u&&i(t,u),e}();function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}u.EMPTY="",u.Nul=null,u.Undef=void 0,u.noop=function(){},u.DATA_TYPE=s;var l=function(){function e(t){var n=t.draw,r=t.ruler,i=t.attr;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.draw=n,this.attr=i,this.ruler=r}var t,n,r;return t=e,(n=[{key:"setRuler",value:function(e){this.ruler=e}},{key:"getAlignPadding",value:function(){return this.attr.align===e.ALIGN.center?0:this.attr.padding}},{key:"getVerticalAlignPadding",value:function(){return this.attr.verticalAlign===e.VERTICAL_ALIGN.center?0:this.attr.padding}}])&&c(t.prototype,n),r&&c(t,r),e}();function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}l.VERTICAL_ALIGN={top:"top",center:"middle",bottom:"bottom"},l.ALIGN={left:"left",center:"center",right:"right"},l.TEXT_WRAP={OVER_FLOW:1,WORD_WRAP:2,TRUNCATE:3},l.TEXT_DIRECTION={HORIZONTAL:"horizontal",VERTICAL:"vertical",ANGLE:"angle",ANGLE_BAR:"bar"},l.DEFAULT_FONT_ATTR={name:"Arial",size:14,color:"rgb(0,0,0)",bold:!1,italic:!1,strikethrough:!1,underline:!1,angle:0,padding:8,align:l.ALIGN.left,textWrap:l.TEXT_WRAP.TRUNCATE,verticalAlign:l.VERTICAL_ALIGN.center,direction:l.TEXT_DIRECTION.HORIZONTAL},l.DEFAULT_RICH_ATTR={angle:0,padding:8,align:l.ALIGN.left,textWrap:l.TEXT_WRAP.TRUNCATE,verticalAlign:l.VERTICAL_ALIGN.center,direction:l.TEXT_DIRECTION.HORIZONTAL},l.DEFAULT_RICH_ITEM_ATTR={name:"Arial",size:14,color:"rgb(0,0,0)",bold:!1,italic:!1,strikethrough:!1,underline:!1};var f=function(){function e(t){var n=t.align,r=void 0===n?l.ALIGN.left:n,i=t.verticalAlign,o=void 0===i?l.VERTICAL_ALIGN.center:i,a=t.textWrap,s=void 0===a?l.TEXT_WRAP.TRUNCATE:a,u=t.strikethrough,c=void 0!==u&&u,h=t.underline,f=void 0!==h&&h,v=t.color,y=void 0===v?"rgb(0,0,0)":v,p=t.name,d=void 0===p?"Arial":p,k=t.size,m=void 0===k?14:k,g=t.bold,b=void 0!==g&&g,T=t.italic,x=void 0!==T&&T,w=t.angle,E=void 0===w?0:w,I=t.direction,O=void 0===I?l.TEXT_DIRECTION.HORIZONTAL:I,A=t.padding,C=void 0===A?5:A;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.align=r,this.verticalAlign=o,this.textWrap=s,this.strikethrough=c,this.underline=f,this.color=y,this.name=d,this.size=m,this.bold=b,this.italic=x,this.direction=O,this.angle=E,this.padding=C}var t,n,r;return t=e,(n=[{key:"clone",value:function(){return new e({align:this.align,verticalAlign:this.verticalAlign,textWrap:this.textWrap,strikethrough:this.strikethrough,underline:this.underline,color:this.color,name:this.name,size:this.size,bold:this.bold,italic:this.italic,angle:this.angle,direction:this.direction,padding:this.padding})}}])&&h(t.prototype,n),r&&h(t,r),e}();function v(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function p(e,t,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t,n){return t&&x(e.prototype,t),n&&x(e,n),e}f.scaleAdapter=null;var E=u.inWorker()?1:devicePixelRatio,I=Math.round(E),O=I+2,A=O+2,C=I/2,P=function(){function e(t){T(this,e),this.canvas=t,this.ctx=t.getContext("2d")}return w(e,null,[{key:"srcPx",value:function(e){return e/this.dpr()}},{key:"cssPx",value:function(e){return this.srcPx(this.stylePx(e))}},{key:"stylePx",value:function(e){return this.round(e*this.dpr())}},{key:"round",value:function(e){return Math.round(e)}},{key:"ceil",value:function(e){return Math.ceil(e)}},{key:"trunc",value:function(e){return Math.trunc(e)}},{key:"radian",value:function(e){return-e*(Math.PI/180)}},{key:"dpr",value:function(){return E}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;E=u.inWorker()?e:devicePixelRatio,I=Math.round(E),A=(O=I+2)+2,C=I/2}}]),w(e,[{key:"attr",value:function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];("string"==typeof n||n instanceof String)&&(n=n.trim()),this.ctx[t]!==n&&(this.ctx[t]=n)}return this}},{key:"resize",value:function(t,n){var r=this.canvas;return r.width=e.stylePx(t),r.height=e.stylePx(n),r.style.width="".concat(r.width/e.dpr(),"px"),r.style.height="".concat(r.height/e.dpr(),"px"),this}}]),e}(),N=function(e){function t(e){var n;return T(this,t),(n=k(this,m(t).call(this,e))).lineWidthType=t.LINE_WIDTH_TYPE.low,n.lineColor="rgb(0,0,0)",n}return g(t,e),w(t,null,[{key:"offsetToLineInside",value:function(e){return I>1?e-C:e-I}},{key:"getLineWidthTypePx",value:function(e){switch(e){case t.LINE_WIDTH_TYPE.medium:return O;case t.LINE_WIDTH_TYPE.low:return I;case t.LINE_WIDTH_TYPE.high:return A}return 0}}]),w(t,[{key:"corsLine",value:function(e,n){var r=this,i=y(e,2),o=i[0],a=i[1],s=y(n,2),u=s[0],c=s[1],l=this.lineWidthType,h=this.lineColor,f=I;switch(l){case t.LINE_WIDTH_TYPE.medium:f=O;break;case t.LINE_WIDTH_TYPE.low:f=I;break;case t.LINE_WIDTH_TYPE.high:f=A}this.attr({strokeStyle:h,lineWidth:f}),this.polyStroke((function(e){var t=y(e,2),n=t[0],i=t[1];return[P.round(n+r.getOffsetX())-C,P.round(i+r.getOffsetY())-C]}),[o,a],[u,c])}},{key:"setLineColor",value:function(e){this.lineColor=e}},{key:"setLineWidthType",value:function(e){this.lineWidthType=e}},{key:"horizonLine",value:function(e,t){var n=y(e,2),r=n[0],i=n[1],o=y(t,2),a=o[0],s=o[1];if(i!==s)throw new TypeError("Error Horizon Line");this.corsLine([r,i],[a,s])}},{key:"verticalLine",value:function(e,t){var n=y(e,2),r=n[0],i=n[1],o=y(t,2),a=o[0],s=o[1];if(r!==a)throw new TypeError("Error Vertical Line");this.corsLine([r,i],[a,s])}}]),t}(function(e){function t(){return T(this,t),k(this,m(t).apply(this,arguments))}return g(t,e),w(t,[{key:"line",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this.polyStroke.apply(this,[function(t){var n=y(t,2),r=n[0],i=n[1];return[e.linePx(P.round(r+e.getOffsetX())),e.linePx(P.round(i+e.getOffsetY()))]}].concat(n)),this}},{key:"linePx",value:function(e){return this.ctx.lineWidth%2==0?e:e-.5}}]),t}(function(e){function t(e){var n;return T(this,t),(n=k(this,m(t).call(this,e))).offsetX=0,n.offsetY=0,n}return g(t,e),w(t,[{key:"offset",value:function(e,t){this.offsetX=e,this.offsetY=t}},{key:"getOffsetX",value:function(){return this.offsetX}},{key:"getOffsetY",value:function(){return this.offsetY}},{key:"fillText",value:function(){throw TypeError("child impl")}},{key:"fillRect",value:function(){throw TypeError("child impl")}},{key:"rect",value:function(){throw TypeError("child impl")}},{key:"drawImage",value:function(){throw TypeError("child impl")}}]),t}(function(e){function t(){return T(this,t),k(this,m(t).apply(this,arguments))}return g(t,e),w(t,[{key:"polyStroke",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=this.ctx;if((arguments.length<=1?0:arguments.length-1)>1){this.beginPath();var n=e(arguments.length<=1?void 0:arguments[1]),r=y(n,2),i=r[0],o=r[1];t.moveTo(i,o);for(var a=1,s=arguments.length<=1?0:arguments.length-1;a<s;a+=1){var u=e(a+1<1||arguments.length<=a+1?void 0:arguments[a+1]),c=y(u,2),l=c[0],h=c[1];t.lineTo(l,h)}t.stroke()}}},{key:"polyInFill",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=this.ctx;if((arguments.length<=1?0:arguments.length-1)>1){this.beginPath();var n=e(arguments.length<=1?void 0:arguments[1]),r=y(n,2),i=r[0],o=r[1];t.moveTo(i,o);for(var a=1,s=arguments.length<=1?0:arguments.length-1;a<s;a+=1){var u=e(a+1<1||arguments.length<=a+1?void 0:arguments[a+1]),c=y(u,2),l=c[0],h=c[1];t.lineTo(l,h)}t.fill()}}},{key:"fullRect",value:function(){var e=this.canvas,t=e.width,n=e.height;return this.ctx.fillRect(0,0,t,n),this}},{key:"rotate",value:function(e){return p(m(t.prototype),"rotate",this).call(this,P.radian(e)),this}}]),t}(function(e){function t(e){var n;return T(this,t),(n=k(this,m(t).call(this,e))).dash=[],n}return g(t,e),w(t,[{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"measureText",value:function(e){return this.ctx.measureText(e)}},{key:"save",value:function(){return this.ctx.save(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"fill",value:function(){return this.ctx.fill(),this}},{key:"clip",value:function(){return this.ctx.clip(),this}},{key:"setLineDash",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.ctx;return this.dash=e,t.setLineDash(e),this}},{key:"scale",value:function(e,t){return this.ctx.scale(e,t),this}},{key:"translate",value:function(e,t){return this.ctx.translate(e,t),this}},{key:"rotate",value:function(e){return this.ctx.rotate(e),this}}]),t}(P)))));N.LINE_WIDTH_TYPE={low:"low",medium:"medium",high:"high"};var R=function(e){function t(){return T(this,t),k(this,m(t).apply(this,arguments))}return g(t,e),w(t,[{key:"fillText",value:function(e,n,r){return n+=this.getOffsetX(),r+=this.getOffsetY(),this.ctx.fillText(e,t.round(n),t.round(r)),this}},{key:"fillPath",value:function(e){var t=this;return this.polyInFill.apply(this,[function(e){var n=e.x,r=e.y;return[P.round(n+t.getOffsetX()),P.round(r+t.getOffsetY())]}].concat(v(e.points))),this}},{key:"fillRect",value:function(e,n,r,i){return e+=this.getOffsetX(),n+=this.getOffsetY(),this.ctx.fillRect(t.round(e),t.round(n),t.round(r),t.round(i)),this}},{key:"rect",value:function(e,n,r,i){return e+=this.getOffsetX(),n+=this.getOffsetY(),this.ctx.rect(t.round(e),t.round(n),t.round(r),t.round(i)),this}},{key:"copyImage",value:function(e,n,r,i,o,a,s,u){var c=this.ctx;return o+=this.getOffsetX(),e+=this.getOffsetX(),a+=this.getOffsetY(),n+=this.getOffsetY(),c.drawImage(this.canvas,t.round(e),t.round(n),t.round(r),t.round(i),t.round(o),t.round(a),t.round(s),t.round(u)),this}},{key:"drawImage",value:function(e,n,r,i,o,a,s,u,c){var l=this.ctx;return a+=this.getOffsetX(),s+=this.getOffsetY(),l.drawImage(e,t.round(n),t.round(r),t.round(i),t.round(o),t.round(a),t.round(s),t.round(u),t.round(c)),this}}]),t}(N);function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function M(e,t,n){return t&&L(e.prototype,t),n&&L(e,n),e}var D=0,_=3,F=function(){function e(t,n){S(this,e),this.draw=t,u.copy(this,{color:"rgb(0,0,0)",widthType:R.LINE_WIDTH_TYPE.low,padding:1,spacing:e.spacing,leftShow:function(){return!1},topShow:function(){return!1},rightShow:function(){return!1},bottomShow:function(){return!1},iFMerge:function(){return!1},iFMergeFirstRow:function(){return!1},iFMergeLastRow:function(){return!1},iFMergeFirstCol:function(){return!1},iFMergeLastCol:function(){return!1}},n)}return M(e,[{key:"setWidthType",value:function(e){this.widthType=e}},{key:"setColor",value:function(e){this.color=e}},{key:"handleExternal",value:function(e,t,n,r,i,o,a){var s={},u=this.leftShow,c=this.topShow,l=this.rightShow,h=this.bottomShow,f=this.iFMerge,v=this.iFMergeFirstRow,y=this.iFMergeLastRow,p=this.iFMergeFirstCol,d=this.iFMergeLastCol,k=this.spacing,m=null,g=null,b=null,T=null,x=null;switch(a){case"left":(m=f(i,o-1))&&(g=v(i,o-1),b=y(i,o-1),T=p(i,o-1),x=d(i,o-1));break;case"top":(m=f(i-1,o))&&(g=v(i-1,o),b=y(i-1,o),T=p(i-1,o),x=d(i-1,o));break;case"right":(m=f(i,o+1))&&(g=v(i,o+1),b=y(i,o+1),T=p(i,o+1),x=d(i,o+1));break;case"bottom":(m=f(i+1,o))&&(g=v(i+1,o),b=y(i+1,o),T=p(i+1,o),x=d(i+1,o))}if(m){switch(a){case"left":s.sx=e-k,s.ex=n-k;var w=h(i-1,o-1)||c(i,o-1),E=c(i,o),I=h(i-1,o);s.sy=t,(E||I)&&(s.sy=t-k),w&&g&&(s.sy=t+k);var O=c(i+1,o-1)||h(i,o-1),A=h(i,o),C=c(i+1,o);s.ey=r,(A||C)&&(s.ey=r+k),O&&b&&(s.ey=r-k);break;case"top":s.sy=t-k,s.ey=r-k;var P=l(i-1,o-1)||u(i-1,o),N=u(i,o),R=l(i,o-1);s.sx=e,(N||R)&&(s.sx=e-k),P&&T&&(s.sx=e+k);var S=u(i-1,o+1)||l(i-1,o),L=l(i,o),M=u(i,o+1);s.ex=n,(L||M)&&(s.ex=n+k),S&&x&&(s.ex=n-k);break;case"right":s.sx=e+k,s.ex=n+k;var D=h(i-1,o+1)||c(i,o+1),_=c(i,o),F=h(i-1,o);s.sy=t,(_||F)&&(s.sy=t-k),D&&g&&(s.sy=t+k);var j=c(i+1,o+1)||h(i,o+1),W=h(i,o),Y=c(i+1,o);s.ey=r,(W||Y)&&(s.ey=r+k),j&&b&&(s.ey=r-k);break;case"bottom":s.sy=t+k,s.ey=r+k;var G=l(i+1,o-1)||u(i+1,o),H=u(i,o),U=l(i,o-1);s.sx=e,(H||U)&&(s.sx=e-k),G&&T&&(s.sx=e+k);var z=u(i+1,o+1)||l(i+1,o),B=l(i,o),V=u(i,o+1);s.ex=n,(B||V)&&(s.ex=n+k),z&&x&&(s.ex=n-k)}return s}switch(a){case"left":s.sx=e-k,s.ex=n-k;var X=h(i-1,o-1)||c(i,o-1),Z=c(i,o),q=h(i-1,o);s.sy=t,(Z||q)&&(s.sy=t-k),X&&(s.sy=t+k);var J=c(i+1,o-1)||h(i,o-1),$=h(i,o),K=c(i+1,o);s.ey=r,($||K)&&(s.ey=r+k),J&&(s.ey=r-k);break;case"top":s.sy=t-k,s.ey=r-k;var Q=l(i-1,o-1)||u(i-1,o),ee=u(i,o),te=l(i,o-1);s.sx=e,(ee||te)&&(s.sx=e-k),Q&&(s.sx=e+k);var ne=u(i-1,o+1)||l(i-1,o),re=l(i,o),ie=u(i,o+1);s.ex=n,(re||ie)&&(s.ex=n+k),ne&&(s.ex=n-k);break;case"right":s.sx=e+k,s.ex=n+k;var oe=h(i-1,o+1)||c(i,o+1),ae=c(i,o),se=h(i-1,o);s.sy=t,(ae||se)&&(s.sy=t-k),oe&&(s.sy=t+k);var ue=c(i+1,o+1)||h(i,o+1),ce=h(i,o),le=c(i+1,o);s.ey=r,(ce||le)&&(s.ey=r+k),ue&&(s.ey=r-k);break;case"bottom":s.sy=t+k,s.ey=r+k;var he=l(i+1,o-1)||u(i+1,o),fe=u(i,o),ve=l(i,o-1);s.sx=e,(fe||ve)&&(s.sx=e-k),he&&(s.sx=e+k);var ye=u(i+1,o+1)||l(i+1,o),pe=l(i,o),de=u(i,o+1);s.ex=n,(pe||de)&&(s.ex=n+k),ye&&(s.ex=n-k)}return s}},{key:"handleInternal",value:function(e,t,n,r,i,o,a){var s={},u=this.leftShow,c=this.topShow,l=this.rightShow,h=this.bottomShow,f=this.iFMerge,v=this.iFMergeFirstRow,y=this.iFMergeLastRow,p=this.iFMergeFirstCol,d=this.iFMergeLastCol,k=this.spacing;if(f(i,o)){var m=v(i,o),g=y(i,o),b=p(i,o),T=d(i,o);switch(a){case"left":s.sx=e+k,s.ex=n+k;var x=h(i-1,o-1)||c(i,o-1),w=c(i,o),E=h(i-1,o);s.sy=t,x&&(s.sy=t-k),(w||E)&&m&&(s.sy=t+k);var I=c(i+1,o-1)||h(i,o-1),O=h(i,o),A=c(i+1,o);s.ey=r,I&&(s.ey=r+k),(O||A)&&g&&(s.ey=r-k);break;case"top":s.sy=t+k,s.ey=r+k;var C=l(i-1,o-1)||u(i-1,o),P=u(i,o),N=l(i,o-1);s.sx=e,C&&(s.sx=e-k),(P||N)&&b&&(s.sx=e+k);var R=u(i-1,o+1)||l(i-1,o),S=l(i,o),L=u(i,o+1);s.ex=n,R&&(s.ex=n+k),(S||L)&&T&&(s.ex=n-k);break;case"right":s.sx=e-k,s.ex=n-k;var M=h(i-1,o+1)||c(i,o+1),D=c(i,o),_=h(i-1,o);s.sy=t,M&&(s.sy=t-k),(D||_)&&m&&(s.sy=t+k);var F=c(i+1,o+1)||h(i,o+1),j=h(i,o),W=c(i+1,o);s.ey=r,F&&(s.ey=r+k),(j||W)&&g&&(s.ey=r-k);break;case"bottom":s.sy=t-k,s.ey=r-k;var Y=l(i+1,o-1)||u(i+1,o),G=u(i,o),H=l(i,o-1);s.sx=e,Y&&(s.sx=e-k),(G||H)&&b&&(s.sx=e+k);var U=u(i+1,o+1)||l(i+1,o),z=l(i,o),B=u(i,o+1);s.ex=n,U&&(s.ex=n+k),(z||B)&&T&&(s.ex=n-k)}return s}switch(a){case"left":s.sx=e+k,s.ex=n+k;var V=h(i-1,o-1)||c(i,o-1),X=c(i,o),Z=h(i-1,o);s.sy=t,V&&(s.sy=t-k),(X||Z)&&(s.sy=t+k);var q=c(i+1,o-1)||h(i,o-1),J=h(i,o),$=c(i+1,o);s.ey=r,q&&(s.ey=r+k),(J||$)&&(s.ey=r-k);break;case"top":s.sy=t+k,s.ey=r+k;var K=l(i-1,o-1)||u(i-1,o),Q=u(i,o),ee=l(i,o-1);s.sx=e,K&&(s.sx=e-k),(Q||ee)&&(s.sx=e+k);var te=u(i-1,o+1)||l(i-1,o),ne=l(i,o),re=u(i,o+1);s.ex=n,te&&(s.ex=n+k),(ne||re)&&(s.ex=n-k);break;case"right":s.sx=e-k,s.ex=n-k;var ie=h(i-1,o+1)||c(i,o+1),oe=c(i,o),ae=h(i-1,o);s.sy=t,ie&&(s.sy=t-k),(oe||ae)&&(s.sy=t+k);var se=c(i+1,o+1)||h(i,o+1),ue=h(i,o),ce=c(i+1,o);s.ey=r,se&&(s.ey=r+k),(ue||ce)&&(s.ey=r-k);break;case"bottom":s.sy=t-k,s.ey=r-k;var le=l(i+1,o-1)||u(i+1,o),he=u(i,o),fe=l(i,o-1);s.sx=e,le&&(s.sx=e-k),(he||fe)&&(s.sx=e+k);var ve=u(i+1,o+1)||l(i+1,o),ye=l(i,o),pe=u(i,o+1);s.ex=n,ve&&(s.ex=n+k),(ye||pe)&&(s.ex=n-k)}return s}},{key:"horizonLine",value:function(e,t,n,r,i,o,a){var s=this.draw,c=this.widthType,l=this.color;s.setLineColor(l),s.setLineWidthType(c),s.setLineDash([]);var h=this.handleExternal(e,t,n,r,i,o,a),f=this.handleInternal(e,t,n,r,i,o,a);u.isEmptyObject(f)||s.horizonLine([f.sx,f.sy],[f.ex,f.ey]),u.isEmptyObject(h)||s.horizonLine([h.sx,h.sy],[h.ex,h.ey])}},{key:"verticalLine",value:function(e,t,n,r,i,o,a){var s=this.draw,c=this.widthType,l=this.color;s.setLineColor(l),s.setLineWidthType(c),s.setLineDash([]);var h=this.handleExternal(e,t,n,r,i,o,a),f=this.handleInternal(e,t,n,r,i,o,a);u.isEmptyObject(f)||s.verticalLine([f.sx,f.sy],[f.ex,f.ey]),u.isEmptyObject(h)||s.verticalLine([h.sx,h.sy],[h.ex,h.ey])}},{key:"tiltingLine",value:function(e,t,n,r,i,o,a){}}]),e}();F.spacing=R.dpr()>=2?3:2;function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W(e,t,n){return t&&j(e.prototype,t),n&&j(e,n),e}var Y=0,G=function(){function e(t){var n=t.widthType,r=void 0===n?R.LINE_WIDTH_TYPE.low:n,i=t.width,o=void 0===i?-1:i,a=t.color,s=void 0===a?"rgb(0,0,0)":a,u=t.zIndex,c=void 0===u?0:u,l=t.display,h=void 0!==l&&l,f=t.type,v=void 0===f?D:f;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.zIndex=c,this.display=h,this.color=s,this.type=v,this.widthType=1===o?R.LINE_WIDTH_TYPE.low:2===o?R.LINE_WIDTH_TYPE.medium:3===o?R.LINE_WIDTH_TYPE.high:r,c>Y&&(Y=c)}return W(e,null,[{key:"getZIndex",value:function(){return Y+=1}}]),W(e,[{key:"setWidthType",value:function(t){this.zIndex=e.getZIndex(),this.widthType=t}},{key:"setColor",value:function(t){this.zIndex=e.getZIndex(),this.color=t}},{key:"setDisplay",value:function(t){this.zIndex=e.getZIndex(),this.display=t}},{key:"setType",value:function(t){this.zIndex=e.getZIndex(),this.type=t}},{key:"setZIndex",value:function(e){this.zIndex=e}},{key:"priority",value:function(e){if(u.isUnDef(e))return-2;var t=this.zIndex,n=e.zIndex;return t>n?1:n>t?-1:0}},{key:"clone",value:function(){return new e({widthType:this.widthType,color:this.color,zIndex:this.zIndex,type:this.type,display:this.display})}},{key:"equal",value:function(e){var t=this.widthType===e.widthType,n=this.color===e.color,r=this.type===e.type;return n&&t&&r}}]),e}();function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var U=function(){function e(t){var n=t.left,r=void 0===n?{}:n,i=t.bottom,o=void 0===i?{}:i,a=t.top,s=void 0===a?{}:a,u=t.right,c=void 0===u?{}:u;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.left=new G(r),this.bottom=new G(o),this.top=new G(s),this.right=new G(c)}var t,n,r;return t=e,(n=[{key:"hasDouble",value:function(){var e=this.top,t=this.left,n=this.right,r=this.bottom;return e.type===_||t.type===_||n.type===_||r.type===_}},{key:"isDisplay",value:function(){return this.left.display||this.top.display||this.bottom.display||this.right.display}},{key:"setAllDisplay",value:function(e){this.setBDisplay(e),this.setLDisplay(e),this.setTDisplay(e),this.setRDisplay(e)}},{key:"setLDisplay",value:function(e){this.left.setDisplay(e)}},{key:"setTDisplay",value:function(e){this.top.setDisplay(e)}},{key:"setRDisplay",value:function(e){this.right.setDisplay(e)}},{key:"setBDisplay",value:function(e){this.bottom.setDisplay(e)}},{key:"setAllColor",value:function(e){this.setBColor(e),this.setLColor(e),this.setTColor(e),this.setRColor(e)}},{key:"setLColor",value:function(e){this.left.setColor(e)}},{key:"setTColor",value:function(e){this.top.setColor(e)}},{key:"setRColor",value:function(e){this.right.setColor(e)}},{key:"setBColor",value:function(e){this.bottom.setColor(e)}},{key:"setAllWidthType",value:function(e){this.setBWidthType(e),this.setLWidthType(e),this.setTWidthType(e),this.setRWidthType(e)}},{key:"setLWidthType",value:function(e){this.left.setWidthType(e)}},{key:"setTWidthType",value:function(e){this.top.setWidthType(e)}},{key:"setRWidthType",value:function(e){this.right.setWidthType(e)}},{key:"setBWidthType",value:function(e){this.bottom.setWidthType(e)}},{key:"setAllType",value:function(e){this.setBType(e),this.setLType(e),this.setTType(e),this.setRType(e)}},{key:"setLType",value:function(e){this.left.setType(e)}},{key:"setTType",value:function(e){this.top.setType(e)}},{key:"setRType",value:function(e){this.right.setType(e)}},{key:"setBType",value:function(e){this.bottom.setType(e)}},{key:"updateMaxIndex",value:function(){var e=G.getZIndex();this.left.setZIndex(e),this.bottom.setZIndex(e),this.top.setZIndex(e),this.right.setZIndex(e)}},{key:"clone",value:function(){var t=this.left,n=this.top,r=this.right,i=this.bottom;return new e({left:t.clone(),top:n.clone(),right:r.clone(),bottom:i.clone()})}}])&&H(t.prototype,n),r&&H(t,r),e}();function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var B=function(){function e(t){var n=t.x,r=t.y,i=t.width,o=t.height;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=n,this.y=r,this.width=i,this.height=o}var t,n,r;return t=e,(n=[{key:"disjoint",value:function(e){return this.x>e.x+e.width||this.y>this.y+e.height||e.x>this.x+this.width||e.y>this.y+this.height}},{key:"expandSize",value:function(e){return this.width+=e,this.height+=e,this}},{key:"includePoint",value:function(e,t){return e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height}},{key:"includeRect",value:function(e){var t=e.x,n=e.y,r=e.width,i=e.height;return this.x<=t&&this.x+this.width>=t+r&&this.y<=n&&this.y+this.height>=n+i}},{key:"inRectPosition",value:function(t){return new e({x:this.x-t.x,y:this.y-t.y,width:this.width,height:this.height})}},{key:"clone",value:function(){return new e({x:this.x,y:this.y,width:this.width,height:this.height})}}])&&z(t.prototype,n),r&&z(t,r),e}();function V(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var X=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.x,r=void 0===n?0:n,i=t.y,o=void 0===i?0:i;V(this,e),this.x=r,this.y=o};function Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var q=function(){function e(t){var n=t.rect,r=t.draw,i=t.offset,o=void 0===i?0:i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rect=n,this.draw=r,this.offset=o}var t,n,r;return t=e,(n=[{key:"open",value:function(){var e=this.rect,t=this.draw,n=this.offset,r=e.x,i=e.y,o=e.width,a=e.height;return t.save().rect(r,i,o+n,a+n).clip().beginPath(),this}},{key:"close",value:function(){return this.draw.restore(),this}}])&&Z(t.prototype,n),r&&Z(t,r),e}();function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $(e,t,n){return t&&J(e.prototype,t),n&&J(e,n),e}var K=function(){function e(t){var n=t.vertical,r=void 0===n?e.ICON_VERTICAL.CENTER:n,i=t.horizontal,o=void 0===i?e.ICON_HORIZONTAL.RIGHT:i,a=t.type,s=void 0===a?e.ICON_TYPE.image:a,c=t.image,l=void 0===c?u.Nul:c,h=t.iconFocus,f=void 0===h?null:h,v=t.height,y=void 0===v?16:v,p=t.width,d=void 0===p?16:p,k=t.color,m=void 0===k?"rgb(255,255,255)":k,g=t.offset,b=void 0===g?{x:0,y:0}:g,T=t.onDraw,x=void 0===T?function(){}:T,w=t.onLeave,E=void 0===w?function(){}:w,I=t.onMove,O=void 0===I?function(){}:I,A=t.onDown,C=void 0===A?function(){}:A,P=t.onEnter,N=void 0===P?function(){}:P;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.vertical=r,this.horizontal=o,this.width=d,this.height=y,this.type=s,this.image=l,this.color=m,this.iconFocus=f,this.offset=new X(b),this.onLeave=E,this.onMove=O,this.onDraw=x,this.onDown=C,this.onEnter=N,this.rect=null}return $(e,null,[{key:"newInstances",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[],r=0;r<t.length;r+=1){var i=t[r];n.push(new e(i))}return n}}]),$(e,[{key:"position",value:function(t){var n=this.horizontal,r=this.vertical,i=R.stylePx(this.offset.x),o=R.stylePx(this.offset.y),a=R.stylePx(this.width),s=R.stylePx(this.height),u=t.x,c=t.y,l=t.width,h=t.height,f=0,v=0;switch(n){case e.ICON_HORIZONTAL.CENTER:f=u+l/2-a/2;break;case e.ICON_HORIZONTAL.LEFT:f=u;break;case e.ICON_HORIZONTAL.RIGHT:f=u+l-a}switch(r){case e.ICON_VERTICAL.CENTER:v=c+h/2-s/2;break;case e.ICON_VERTICAL.TOP:v=c;break;case e.ICON_VERTICAL.BOTTOM:v=c+h-s}return new B({x:f+=i,y:v+=o,width:a,height:s})}},{key:"loadImage",value:function(t){var n=this,r=t.load,i=t.sync,o=this.image;switch(this.type){case e.ICON_TYPE.image:if(o instanceof Image)i(o);else{var a=new Image;a.src=o,a.complete?(this.image=a,i(this.image)):(a.onload=function(){n.image=a,r(a)},a.onerror=function(){console.error("图片加载失败".concat(o))})}break;case e.ICON_TYPE.draw:i()}}},{key:"drawIcon",value:function(t){var n=t.rect,r=t.draw,i=this.type;switch(this.rect=n,i){case e.ICON_TYPE.image:this.drawImage({rect:n,draw:r});break;case e.ICON_TYPE.draw:this.drawCustom({rect:n,draw:r})}}},{key:"drawCustom",value:function(e){var t=e.rect,n=e.draw;this.onDraw({rect:t,draw:n})}},{key:"drawImage",value:function(e){var t=e.rect,n=e.draw,r=this.image,i=this.color,o=this.position(t),a=o.x,s=o.y,u=o.width,c=o.height,l=t.includeRect(o),h=new q({rect:t,draw:n});!1===l&&h.open(),i&&(n.attr({fillStyle:i}),n.fillRect(a,s,u,c)),n.drawImage(r,0,0,r.width,r.height,a,s,u,c),!1===l&&h.close()}},{key:"eventHandle",value:function(t){var n=t.type,r=t.x,i=t.y,o=t.native,a=this.rect,s=this.iconFocus;if(a){var u=this.position(a),c=u.inRectPosition(a),l=s.activate;switch(n){case e.ICON_EVENT_TYPE.MOUSE_DOWN:c.includePoint(r,i)&&(s.setActivate(this),this.onDown({native:o,position:u}));break;case e.ICON_EVENT_TYPE.MOUSE_MOVE:c.includePoint(r,i)?(l!==this&&this.onEnter({native:o,position:u}),s.setActivate(this),this.onMove({native:o,position:u})):l&&(s.setActivate(null),this.onLeave({native:o,position:u}))}}}},{key:"setOnDraw",value:function(e){this.onDraw=e}},{key:"setOnDown",value:function(e){this.onDown=e}},{key:"setOnMove",value:function(e){this.onMove=e}},{key:"setOnEnter",value:function(e){this.onEnter=e}},{key:"setOnLeave",value:function(e){this.onLeave=e}},{key:"setFocus",value:function(e){this.iconFocus=e}}]),e}();function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}K.ICON_HORIZONTAL={LEFT:0,RIGHT:1,CENTER:2},K.ICON_VERTICAL={TOP:3,BOTTOM:4,CENTER:5},K.ICON_TYPE={image:1,custom:2},K.ICON_EVENT_TYPE={MOUSE_DOWN:1,MOUSE_MOVE:2};var ee=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"dateFormat",value:function(e,t){if(!(t instanceof Date))return t;var n={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()},r=/(y+)/.exec(e);if(r){var i=r[0],o=t.getFullYear().toString().substr(4-i.length);e=e.replace(i,o)}for(var a in n){var s=new RegExp("(".concat(a,")")).exec(e);if(s){var u=n[a].toString(),c=s[0],l=1===c.length?u:"00".concat(u).substr(u.length);e=e.replace(c,l)}}return e}},{key:"parse",value:function(t){var n=t;return n instanceof Date||(n=e.parserToDate(t,"yyyy/MM/dd"))||(n=e.parserToDate(t,"MM/dd"))||(n=e.parserToDate(t,"yyyy/MM/dd hh:mm:ss"))||(n=e.parserToDate(t,"yyyy-MM-dd"))||(n=e.parserToDate(t,"MM-dd"))||(n=e.parserToDate(t,"yyyy-MM-dd hh:mm:ss"))||(n=e.parserToDate(t,"hh:mm:ss"))||(n=e.parserToDate(t,"yyyy年MM月"))||(n=e.parserToDate(t,"MM月dd日"))?n:(n=e.parserToDate(t,"yyyy年MM月dd日 hh:mm:ss"))||t}},{key:"parserToDate",value:function(e,t){if(!e)return null;for(var n=new Date("1970/01/01 00:00:00"),r=[{reg:"y+"},{reg:"M+"},{reg:"d+"},{reg:"h+"},{reg:"m+"},{reg:"s+"},{reg:"S"}],i=n.getFullYear(),o=n.getMonth()+1,a=n.getDate(),s=n.getHours(),u=n.getMinutes(),c=n.getSeconds(),l=n.getMilliseconds(),h=1,f=0;f<t.length;f+=1)for(var v=t[f],y=0;y<r.length;y+=1){var p=r[y];if(p.reg[0]===v){p.index||(p.index=h,h+=1);break}}for(var d=0;d<r.length;d+=1){var k=r[d].reg,m=new RegExp("(".concat(k,")")).exec(t);if(m){var g=m[0],b="([0-9]{1,".concat(g.length,"})");t=t.replace(g,b)}}var T={},x=new RegExp(t).exec(e);if(!x)return null;for(var w=1;w<x.length;w+=1)T[w]=x[w];return r[0].index&&(i=T[r[0].index]),r[1].index&&(o=T[r[1].index]),r[2].index&&(a=T[r[2].index]),r[3].index&&(s=T[r[3].index]),r[4].index&&(u=T[r[4].index]),r[5].index&&(c=T[r[5].index]),r[6].index&&(l=T[r[6].index]),new Date(i,o-1,a,s,u,c,l)}}],(n=null)&&Q(t.prototype,n),r&&Q(t,r),e}();function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ne=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"eNotation",value:function(e){return u.isNumber(e)?u.parseFloat(e).toExponential(2):e}},{key:"default",value:function(e){return e?e.toString():""}},{key:"text",value:function(e){return e}},{key:"decimal",value:function(e){if(u.isNumber(e)){var t=e.toString().indexOf(".");return-1!==t?e.toString().substring(0,t+3):"".concat(e,".00")}return e}},{key:"number",value:function(e){return u.isNumber(e)?u.parseFloat(e):e}},{key:"percentage",value:function(e){return u.isNumber(e)?"".concat(e,"%"):e}},{key:"fraction",value:function(e){if(u.isFraction(e)){var t=e.split("/")[0],n=e.split("/")[1];return u.parseInt(t)/u.parseInt(n)}return e}},{key:"rmb",value:function(e){return u.isNumber(e)?"￥".concat(e):e}},{key:"hk",value:function(e){return u.isNumber(e)?"HK".concat(e):e}},{key:"time",value:function(e){var t=ee.parse(e);return t?ee.dateFormat("hh:mm:ss",t):e}},{key:"date1",value:function(e){var t=ee.parse(e);return t?ee.dateFormat("yyyy/MM/dd",t):e}},{key:"date2",value:function(e){var t=ee.parse(e);return t?ee.dateFormat("MM月dd日",t):e}},{key:"date3",value:function(e){var t=ee.parse(e);return t?ee.dateFormat("yyyy年MM月",t):e}},{key:"date4",value:function(e){var t=ee.parse(e);return t?ee.dateFormat("yyyy年MM月dd日",t):e}},{key:"date5",value:function(e){var t=ee.parse(e);return t?ee.dateFormat("yyyy/MM/dd hh:mm:ss",t):e}},{key:"dollar",value:function(e){return u.isNumber(e)?"$".concat(e):e}}])&&te(t.prototype,n),r&&te(t,r),e}()),re=function(e,t){return ne[e](t)};function ie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ae=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.text,r=t.color,i=t.name,o=t.size,a=t.italic,s=t.bold,u=t.underline,c=t.strikethrough,l=t.scaleAdapter;ie(this,e),this.text=n,this.color=r,this.name=i,this.size=o,this.italic=a,this.bold=s,this.strikethrough=c,this.underline=u,this.scaleAdapter=l}var t,n,r;return t=e,(n=[{key:"clone",value:function(){return new e({text:this.text,color:this.color,name:this.name,size:this.size,italic:this.italic,bold:this.bold,underline:this.underline,strikethrough:this.strikethrough,scaleAdapter:this.scaleAdapter})}},{key:"plain",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e};return e(this.clone())}},{key:"equals",value:function(e){return!u.isUnDef(e)&&e.text===this.text&&e.color===this.color&&e.name===this.name&&e.size===this.size&&e.italic===this.italic&&e.bold===this.bold&&e.strikethrough===this.strikethrough&&e.underline===this.underline}}])&&oe(t.prototype,n),r&&oe(t,r),e}();function se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ce=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.rich,r=void 0===n?[]:n;se(this,e),this.rich=r.map((function(e){return new ae(e)}))}var t,n,r;return t=e,(n=[{key:"setRich",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.rich=e}},{key:"getRich",value:function(){return this.rich}},{key:"clone",value:function(){var t=[];return this.rich.forEach((function(e){t.push(e.clone())})),new e({rich:t})}},{key:"plain",value:function(e){var t=[];return this.rich.forEach((function(n){t.push(n.plain(e))})),t}},{key:"equals",value:function(e){if(u.isUnDef(e))return!1;if(e.rich.length!==this.rich.length)return!1;for(var t=0;t<this.rich.length;t++){var n=this.rich[t],r=e.rich[t];if(!n.equals(r))return!1}return!0}}])&&ue(t.prototype,n),r&&ue(t,r),e}();function le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function he(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fe(e,t,n){return t&&he(e.prototype,t),n&&he(e,n),e}var ve=new(function(){function e(){le(this,e),this.functions={}}return fe(e,[{key:"remove",value:function(e){delete this.functions[e]}},{key:"getFunction",value:function(e){return this.functions[e.toLocaleString()]}},{key:"register",value:function(e,t){this.functions[e.toLocaleString()]=t}}]),e}()),ye=function(){function e(){le(this,e),this.assembly=""}return fe(e,[{key:"getInstruct",value:function(){for(var e=this.assembly;e.endsWith("\r\n");){var t=e.length;e=e.substring(0,t-"\r\n".length)}return e}},{key:"writeOperand",value:function(e){this.assembly+="OPush ".concat(e,"\r\n")}},{key:"writeOperator",value:function(e){this.assembly+="".concat(e,"\r\n")}},{key:"writeString",value:function(e){this.assembly+="SPush ".concat(e,"\r\n")}},{key:"writeNumber",value:function(e){this.assembly+="NPush ".concat(e,"\r\n")}}]),e}(),pe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.syntaxCheck,r=void 0===n||n;le(this,e),this.syntaxCheck=r}return fe(e,[{key:"lexical",value:function(e){for(var t=/^(\+|-|\*|\/|%|>|<|,|\^|=|&|!|:|>=|<=|<>)$/,n=/[0-9.]/,r=/[a-z0-9_$]/i,i=e.length,o=[],a=0,s=[];a<i;){var u=e[a],c=/\s/;if(c.test(u)){var l=e[a+1];if(c.test(l)){a++;continue}}if(c.test(u)){var h=e[a-1],f=e[a+1];r.test(h)&&r.test(f)&&s.push({type:"operator",value:u}),a++}else if("("!==u)if(")"!==u)if("{"!==u)if("}"!==u)if('"'!==u)if("'"!==u)if(t.test(u)){var v=e[a+1],y="".concat(u).concat(v);t.test(y)?(s.push({type:"operator",value:y}),a++):s.push({type:"operator",value:u}),a++}else if(n.test(u)){for(var p="";n.test(u)&&a<i;)p+=u,u=e[++a];s.push({type:"number",value:p})}else{if(!r.test(u))throw new TypeError("无法识别的token ".concat(u," "));for(var d="";r.test(u)&&a<i;)d+=u,u=e[++a];"("===u?(s.push({type:"function",value:d}),s.push({type:"function",value:"("}),o.push({type:"function",value:"("}),a++):s.push({type:"operand",value:d})}else{var k="";for(u=e[++a];"'"!==u&&a<i;)k+=u,u=e[++a];u=e[++a],s.push({type:"string",value:k})}else{var m="";for(u=e[++a];'"'!==u&&a<i;)m+=u,u=e[++a];u=e[++a],s.push({type:"string",value:m})}else s.push({type:"array",value:"}"}),a++;else s.push({type:"array",value:"array"}),s.push({type:"array",value:"{"}),a++;else{var g=o.pop();g&&"function"===g.type?s.push({type:"function",value:")"}):s.push({type:"brackets",value:")"}),a++}else s.push({type:"brackets",value:"("}),o.push({type:"brackets",value:"("}),a++}return this.syntaxCheck?this.syntax(s):s}},{key:"syntax",value:function(e){for(var t=[],n=[],r=[],i=[],o=[],a=0,s=e.length,u=function(e){return"array"===e.type&&"array"===e.value},c=function(e){return"function"===e.type&&("("!==e.value&&")"!==e.value)},l=function(t,n){if("last"===t)for(;n>=0;){var r=e[n];if(c(r))n--;else{if(!u(r))return r;n--}}if("next"===t)for(;n<s;){var i=e[n];if(c(i))n++;else{if(!u(i))return i;n++}}return null},h=function(t,n){var r=e[a],i="last"===t?"前面":"后面";if("{"===r.value){if("last"===t)switch(n.type){case"array":if("{"===n.value)return;break;case"function":case"brackets":if("("===n.value)return;break;case"operator":return void n.value}if("next"===t)switch(n.type){case"string":case"array":case"number":case"operand":return;case"function":case"brackets":if("("===n.value)return}}if("}"===r.value){if("last"===t)switch(n.type){case"number":case"string":case"array":case"operand":return;case"function":case"brackets":if(")"===n.value)return}if("next"===t)switch(n.type){case"array":if("}"===n.value)return;break;case"function":case"brackets":if(")"===n.value)return;break;case"operator":return void n.value}}throw TypeError("错误表达式 ".concat(r.value," ").concat(i," ").concat(n.value))},f=function(t,n){var r=e[a],i="last"===t?"前面":"后面";switch(n.type){case"array":if("last"===t&&"{"===n.value)return;if("next"===t&&"}"===n.value)return;break;case"brackets":case"function":if("last"===t&&"("===n.value)return;if("next"===t&&")"===n.value)return;break;case"operator":return}throw TypeError("错误表达式 ".concat(r.value," ").concat(i," ").concat(n.value))},v=function(t,n){var r=e[a],i="last"===t?"前面":"后面";switch(n.type){case"brackets":case"function":case"string":case"number":case"operand":return;case"array":if(","===r.value)return}throw TypeError("错误表达式 ".concat(r.value," ").concat(i," ").concat(n.value))},y=function(t,n){var r=e[a],i="last"===t?"前面":"后面";if("("===r.value){if("last"===t)switch(n.type){case"array":if("{"===n.value)return;break;case"function":case"brackets":if("("===n.value)return;break;case"operator":return}if("next"===t)switch(n.type){case"function":case"string":case"number":case"operand":return;case"array":if("{"===n.value)return;break;case"brackets":if("("===n.value)return}}if(")"===r.value){if("last"===t)switch(n.type){case"function":case"number":case"string":case"operand":return;case"array":if("}"===n.value)return;break;case"brackets":if(")"===n.value)return}if("next"===t)switch(n.type){case"array":if("}"===n.value)return;break;case"function":case"brackets":if(")"===n.value)return;break;case"operator":return void n.value}}throw TypeError("错误表达式 ".concat(r.value," ").concat(i," ").concat(n.value))};a<s;){var p=e[a];if(u(p))a++;else if(c(p))a++;else{var d=p.type,k=p.value;if("'"===d&&(t.length?t.pop():n.length||t.push("'")),'"'===d&&(n.length?n.pop():t.length||n.push('"')),"string"===d){var m=l("last",a-1),g=l("next",a+1);m&&f("last",m),g&&f("next",g)}if("number"===d){var b=l("last",a-1),T=l("next",a+1);b&&f("last",b),T&&f("next",T)}if("array"===d){if("{"===k&&i.push(p),"}"===k){if(0===i.length)throw new TypeError("数组缺少闭合标签");i.pop()}var x=l("last",a-1),w=l("next",a+1);x&&h("last",x),w&&h("next",w)}if("function"===d){"("===k&&r.push(p),")"===k&&r.pop();var E=l("last",a-1),I=l("next",a+1);E&&y("last",E),I&&y("next",I)}if("operator"===d){var O=l("last",a-1),A=l("next",a+1);if(!O)throw TypeError("错误表达式: ".concat(p.value," 错误"));if(v("last",O),!A)throw TypeError("错误表达式: ".concat(p.value," 错误"));v("next",A)}if("brackets"===d&&("("===k&&o.push(p),")"===k)){if(0===o.length)throw new TypeError("括号缺少闭合标签");o.pop()}a++}}if(i.length)throw new TypeError("数组缺少闭合标签");if(r.length)throw new TypeError("函数缺少闭合标签");if(t.length)throw new TypeError("单引号缺少闭合标签");if(n.length)throw new TypeError("双引号缺少闭合标签");if(o.length)throw new TypeError("括号缺少闭合标签");return e}}]),e}(),de=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.tokens,r=t.writer;le(this,e),this.writer=r,this.tokens=n,this.groupStack=[],this.index=-1,this.ignore=[","],this.opIf={">":"ifge","<":"ifgt","=":"ifeq",">=":"if_icmpge","<=":"if_icmpgt","<>":"ifne"},this.opAdd={"+":"add","-":"sub","&":"link"},this.opMul={"*":"mul","/":"div","%":"mod","^":"power"},this.opCommon={" ":"common"},this.opRel={"!":"rel",":":"uni"},this.opNew={array:"newarray"},this.opCell={function:"invoke"}}return fe(e,[{key:"eofToken",value:function(){return this.index>=this.tokens.length-1}},{key:"nextToken",value:function(){return this.index++,this.token=this.tokens[this.index],this.token}},{key:"backToken",value:function(){return this.index--,this.token=this.tokens[this.index],this.token}},{key:"reduceGroup",value:function(){var e=this.groupStack,t=e.length;if(t>0){var n=e[t-1],r=n.number;n.number=r-1}}},{key:"increaseGroup",value:function(){var e=this.groupStack,t=e.length;if(t>0){var n=e[t-1],r=n.number;n.number=r+1}}},{key:"popGroup",value:function(){return this.groupStack.pop()}},{key:"addGroup",value:function(e){return e.number=0,this.groupStack.push(e),e}},{key:"isSkipNextToken",value:function(){if(!this.eofToken()){var e=this.ignore;this.nextToken();var t=this.token;this.backToken();var n=t.value;return e.includes(n)}return!1}},{key:"compile",value:function(){var e=this.writer;for(this.compileIfge();this.isSkipNextToken();)this.nextToken(),this.compileIfge();return e.getInstruct()}},{key:"compileIfge",value:function(){for(this.compileAdd();!this.eofToken();){var e=this.nextToken(),t=e.type,n=e.value;if("operator"!==t){this.backToken();break}if(!this.opIf[n]){this.backToken();break}var r=this.opIf[n];this.compileAdd(),this.reduceGroup(),this.writer.writeOperator(r)}}},{key:"compileAdd",value:function(){for(this.compileMul();!this.eofToken();){var e=this.nextToken(),t=e.type,n=e.value;if("operator"!==t){this.backToken();break}if(!this.opAdd[n]){this.backToken();break}var r=this.opAdd[n];this.compileMul(),this.reduceGroup(),this.writer.writeOperator(r)}}},{key:"compileMul",value:function(){for(this.compileCommon();!this.eofToken();){var e=this.nextToken(),t=e.type,n=e.value;if("operator"!==t){this.backToken();break}if(!this.opMul[n]){this.backToken();break}var r=this.opMul[n];this.compileCommon(),this.reduceGroup(),this.writer.writeOperator(r)}}},{key:"compileCommon",value:function(){for(this.compileRel();!this.eofToken();){var e=this.nextToken(),t=e.type,n=e.value;if("operator"!==t){this.backToken();break}if(!this.opCommon[n]){this.backToken();break}var r=this.opCommon[n];this.compileRel(),this.reduceGroup(),this.writer.writeOperator(r)}}},{key:"compileRel",value:function(){for(this.compileArray();!this.eofToken();){var e=this.nextToken(),t=e.type,n=e.value;if("operator"!==t){this.backToken();break}if(!this.opRel[n]){this.backToken();break}var r=this.opRel[n];this.compileArray(),this.reduceGroup(),this.writer.writeOperator(r)}}},{key:"compileArray",value:function(){for(this.compileFunction();!this.eofToken();){var e=this.nextToken(),t=e.type,n=e.value;if("array"!==t){this.backToken();break}if("}"===n){this.backToken();break}for(this.addGroup(e),this.nextToken(),this.compileIfge();this.isSkipNextToken();)this.nextToken(),this.compileIfge();this.popGroup();var r=e.number,i=this.opNew[t];this.writer.writeOperator("".concat(i," ").concat(r)),this.nextToken()}}},{key:"compileFunction",value:function(){for(this.compilePushValue();!this.eofToken();){var e=this.nextToken(),t=e.type,n=e.value;if("function"!==t){this.backToken();break}if(")"===n){this.backToken();break}for(this.addGroup(e),this.nextToken(),this.compileIfge();this.isSkipNextToken();)this.nextToken(),this.compileIfge();this.popGroup();var r=e.number,i=this.opCell[t];this.writer.writeOperator("".concat(i," ").concat(n," ").concat(r)),this.nextToken()}}},{key:"compilePushValue",value:function(){if(!this.eofToken()){var e=this.nextToken(),t=this.writer,n=e.type,r=e.value;switch(n){case"string":return this.increaseGroup(),void t.writeString("".concat(r));case"number":return this.increaseGroup(),void t.writeNumber("".concat(r));case"operand":return this.increaseGroup(),void t.writeOperand(r)}switch(n){case"brackets":if("("===r){for(this.compileIfge();this.isSkipNextToken();)this.nextToken(),this.compileIfge();this.nextToken()}return}switch(n){case"array":return"}"!==r&&this.increaseGroup(),void this.backToken();case"function":return")"!==r&&this.increaseGroup(),void this.backToken()}switch(n){case"operator":return void this.backToken()}throw new TypeError("无法识别的token ".concat(n," ").concat(r," "))}}}]),e}(),ke=function(){function e(t){le(this,e),this.instruct=t.split("\r\n"),this.memory=[]}return fe(e,[{key:"eval",value:function(){var e=this,t=/^newarray/,n=/^invoke/,r=/^SPush/,i=/^NPush/,o=/^OPush/;return this.instruct.forEach((function(a){switch(a){case"if_icmpge":e.ificmpge();break;case"if_icmpgt":e.ificmpgt();break;case"ifge":e.ifge();break;case"ifgt":e.ifgt();break;case"ifeq":e.ifeq();break;case"ifne":e.ifne();break;case"add":e.add();break;case"sub":e.sub();break;case"mul":e.mul();break;case"div":e.div();break;case"mod":e.mod();break;case"power":e.power();break;case"rel":e.rel();break;case"link":e.link();break;case"uni":e.uni();break;case"common":e.common();break;default:if(t.test(a)){var s=a.split(" ")[1];e.array(s);break}if(n.test(a)){var u=a.split(" "),c=u[1],l=u[2];e.invoke(c,l);break}if(r.test(a)){var h=a.split(" ")[1];e.pushS(h);break}if(i.test(a)){var f=a.split(" ")[1];e.pushN(f);break}if(o.test(a)){var v=a.split(" ")[1];e.pushO(v);break}}})),this.memory.pop()}},{key:"pushS",value:function(e){this.memory.push(e)}},{key:"pushN",value:function(e){e=parseFloat(e),this.memory.push(e)}},{key:"pushO",value:function(e){this.memory.push(e)}},{key:"ifge",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t>e)}},{key:"ifgt",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t<e)}},{key:"ifeq",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t===e)}},{key:"ifne",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t!==e)}},{key:"ificmpge",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t>=e)}},{key:"ificmpgt",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t<=e)}},{key:"add",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t+e)}},{key:"sub",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t-e)}},{key:"mul",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t*e)}},{key:"div",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t/e)}},{key:"mod",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t%e)}},{key:"common",value:function(){}},{key:"rel",value:function(){}},{key:"uni",value:function(){}},{key:"link",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push("".concat(t).concat(e))}},{key:"power",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(Math.pow(t,e))}},{key:"array",value:function(e){for(var t=[],n=1;n<=e;n++){var r=this.memory.pop();t.push(r)}t.reverse(),this.memory.push(t)}},{key:"invoke",value:function(e,t){for(var n=[],r=1;r<=t;r++){var i=this.memory.pop();n.push(i)}n.reverse();var o=ve.getFunction(e).apply(this,n);this.memory.push(o)}}]),e}(),me=function(e){e.startsWith("=")&&(e=e.substring(1));var t=new pe,n=new ye,r=t.lexical(e);return new de({writer:n,tokens:r}).compile()},ge=function(e){return new ke(e).eval()};function be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var xe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.expr,r=void 0===n?u.EMPTY:n;be(this,e),this.expr=r,this.content=u.Nul,this.instruct=u.Nul}var t,n,r;return t=e,(n=[{key:"getValue",value:function(){var e=this.expr,t=this.content,n=this.instruct;return t||(n||(n=me(e)),t=ge(n)),this.content=t,this.instruct=n,t}},{key:"hasExpr",value:function(){var e=this.expr;return!u.isBlank(e)}},{key:"getExpr",value:function(){return this.expr}},{key:"setExpr",value:function(e){this.expr=e,this.content=u.Nul,this.instruct=u.Nul}},{key:"clone",value:function(){return new e({expr:this.expr})}}])&&Te(t.prototype,n),r&&Te(t,r),e}();function we(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ie=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.ruler,r=void 0===n?u.Undef:n,i=t.format,o=void 0===i?"default":i,a=t.icons,s=void 0===a?[]:a,c=t.fontAttr,l=void 0===c?{}:c,h=t.custom,v=void 0===h?{}:h,y=t.borderAttr,p=void 0===y?{}:y,d=t.formula,k=void 0===d?{}:d,m=t.richText,g=void 0===m?{}:m,b=t.background,T=void 0===b?u.Undef:b,x=t.text,w=void 0===x?u.EMPTY:x,E=t.contentWidth,I=void 0===E?0:E,O=t.contentHeight,A=void 0===O?0:O,C=t.contentType,P=void 0===C?e.TYPE.STRING:C;we(this,e),this.background=T,this.icons=K.newInstances(s),this.custom=v,this.ruler=r,this.format=o,this.formula=new xe(k),this.text=w,this.richText=new ce(g),this.formatText=u.EMPTY,this.contentHeight=A,this.contentWidth=I,this.fontAttr=new f(l),this.borderAttr=new U(p),this.setContentType(P)}var t,n,r;return t=e,(n=[{key:"setIcons",value:function(e){return this.icons=e,this}},{key:"setText",value:function(e){return this.formatText=null,this.text=e,this.formula.setExpr(null),this.richText.setRich([]),this.setContentWidth(0),this}},{key:"setRichText",value:function(e){return this.formatText=null,this.text=null,this.formula.setExpr(null),this.richText.setRich(e),this.setContentWidth(0),this}},{key:"setExpr",value:function(e){return this.formatText=null,this.text=null,this.formula.setExpr(e),this.richText.setRich([]),this.setContentWidth(0),this}},{key:"getExpr",value:function(){return this.formula.getExpr()}},{key:"setFormat",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return this.format=e,this.formatText=null,this.setContentWidth(0),this}},{key:"setRuler",value:function(e){return this.ruler=e,this}},{key:"setContentType",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.TYPE.STRING,n=this.text;switch(t){case e.TYPE.STRING:this.contentType=e.TYPE.STRING;break;case e.TYPE.NUMBER:this.contentType=t,u.isNumber(n)?(this.contentType=e.TYPE.NUMBER,this.text=u.parseFloat(n)):(this.contentType=e.TYPE.STRING,this.text="".concat(n));break;case e.TYPE.DATE_TIME:var r=ee.parse(n);u.isDate(r)?(this.contentType=e.TYPE.DATE_TIME,this.text=u.parseFloat(n)):(this.contentType=e.TYPE.STRING,this.text="".concat(n));break;case e.TYPE.RICH_TEXT:this.contentType=e.TYPE.RICH_TEXT}return this}},{key:"isEmpty",value:function(){return u.isBlank(this.getComputeText())}},{key:"hasFormula",value:function(){return this.formula.hasExpr()}},{key:"getFormatText",value:function(){var t=this.text,n=this.formula,r=this.format,i=this.formatText,o=this.contentType;if(n.hasExpr()){var a=n.getValue();return a&&u.isBlank(i)&&(i=re(r,a)),this.formatText=i,i}switch(o){case e.TYPE.STRING:case e.TYPE.NUMBER:case e.TYPE.DATE_TIME:return r&&!i?(this.formatText=re(r,t),this.formatText):i}return u.EMPTY}},{key:"getComputeText",value:function(){var t=this.text,n=this.formula,r=this.richText,i=this.contentType;if(n.hasExpr())return n.getValue();switch(i){case e.TYPE.STRING:case e.TYPE.NUMBER:case e.TYPE.DATE_TIME:return t;case e.TYPE.RICH_TEXT:return r}return u.EMPTY}},{key:"setFontAttr",value:function(e){return this.fontAttr=e,this}},{key:"setBorderAttr",value:function(e){return this.borderAttr=e,this}},{key:"clone",value:function(){var t=this.background,n=this.text,r=this.format,i=this.custom,o=this.icons,a=this.contentType,s=this.formula,u=this.richText;return new e({background:t,text:n,custom:i,contentType:a,format:r,fontAttr:this.fontAttr,borderAttr:this.borderAttr,icons:o,formula:s,richText:u})}},{key:"toJSON",value:function(){var e=this.background,t=this.text,n=this.format,r=this.custom,i=this.icons,o=this.contentType,a=this.formula,s=this.richText,u=this.fontAttr,c=this.borderAttr;return{custom:r,expr:a.getExpr(),rich:s.getRich(),contentType:o,text:t,icons:i,background:e,format:n,fontAttr:u,borderAttr:c}}},{key:"toString",value:function(){return this.getFormatText()}},{key:"setContentWidth",value:function(e){return this.contentWidth=e,this}},{key:"setContentHeight",value:function(e){return this.contentHeight=e,this}}])&&Ee(t.prototype,n),r&&Ee(t,r),e}();function Oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Ie.TYPE={NUMBER:0,STRING:1,RICH_TEXT:2,DATE_TIME:3};var Ae=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t){var n=t.cell;this.cell=u.safeValue(n,t)}else this.cell=void 0}var t,n,r;return t=e,(n=[{key:"getCell",value:function(){var e=this.cell;return e instanceof Ie?e:(u.isString(e)?this.cell=new Ie({text:e}):this.cell=new Ie(e),this.cell)}},{key:"setCell",value:function(e){return this.cell=e,this}},{key:"clone",value:function(){return new e({mergeId:this.mergeId,cell:this.cell})}}])&&Oe(t.prototype,n),r&&Oe(t,r),e}();function Ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Pe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pool={}}var t,n,r;return t=e,(n=[{key:"clear",value:function(){var e=this;Object.keys((function(t){delete e.pool[t]}))}},{key:"removeListen",value:function(e){delete this.pool[e]}},{key:"registerListen",value:function(e,t){this.pool[e]=t}},{key:"execute",value:function(e){if(this.pool[e]){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this.pool)[e].apply(t,r)}}}])&&Ce(t.prototype,n),r&&Ce(t,r),e}();function Ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Re=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.undoStack=[],this.redoStack=[],this.layer={event:"",data:[]},this.apply=!1,this.listen=new Pe}var t,n,r;return t=e,(n=[{key:"canRedo",value:function(){return this.redoStack.length>0}},{key:"canUndo",value:function(){return this.undoStack.length>0}},{key:"undo",value:function(){for(var e=this.undoStack.pop(),t=e.data.length-1;t>=0;t--)e.data[t].undo();this.redoStack.push(e),this.listen.execute("change",e.event,"undo")}},{key:"redo",value:function(){for(var e=this.redoStack.pop(),t=0,n=e.data.length;t<n;t++)e.data[t].redo();this.undoStack.push(e),this.listen.execute("change",e.event,"redo")}},{key:"open",value:function(){this.layer={event:"",data:[]},this.apply=!0}},{key:"close",value:function(e){this.layer.data.length&&(this.layer.event=e,this.undoStack.push(this.layer)),this.layer={event:"",data:[]},this.apply=!1,this.listen.execute("change",e,"close")}},{key:"addAction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{undo:function(){},redo:function(){}};this.apply&&this.layer.data.push(e)}}])&&Ne(t.prototype,n),r&&Ne(t,r),e}();function Se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Me=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.snapshot,r=void 0===n?new Re:n,i=t.items,o=void 0===i?[]:i;Se(this,e),this.items=o,this.snapshot=r}var t,n,r;return t=e,(n=[{key:"slice",value:function(e,t,n,r){return this.items.slice(e,n+1).map((function(e){return e?e.slice(t,r+1):e}))}},{key:"get",value:function(e,t){var n=this.items[e];return n&&n[t]?this.wrap(n,t):void 0}},{key:"set",value:function(e,t,n){var r=this.items[e]||[];r[t]=n,this.items[e]=r}},{key:"wrap",value:function(e,t){var n=e[t];return n?(n=n instanceof Ae?n:new Ae(n),e[t]=n,n):n}},{key:"each",value:function(e){for(var t=this.items,n=t.length,r=0;r<n;r++){var i=t[r];if(i)for(var o=i.length,a=0;a<o;a++)e(this.get(r,a))}}},{key:"setOrNew",value:function(e,t,n){var r=this.items[e];r&&(r[t]=n)}},{key:"getOrNew",value:function(e,t){var n=this.get(e,t);if(n)return n;var r=new Ae;return this.set(e,t,r),r}},{key:"getItems",value:function(){return this.items}},{key:"removeRow",value:function(e){var t,n=this,r={undo:function(){t&&n.items.splice(e,0,t)},redo:function(){t=n.items.splice(e,1)}};this.snapshot.addAction(r),r.redo()}},{key:"removeCol",value:function(e){var t=this,n=this.snapshot,r=[],i={undo:function(){for(var n=0,i=t.items.length;n<i;n++){var o=t.items[n];o&&o.splice(e,0,r[n])}},redo:function(){for(var n=0,i=t.items.length;n<i;n++){var o=t.items[n];if(o){var a=o.splice(e,1);r.push(a)}}}};n.addAction(i),i.redo()}},{key:"insertRowAfter",value:function(e){var t=this,n={undo:function(){t.items.splice(e+1,1)},redo:function(){var n=t.items[e];if(n){for(var r=[],i=0,o=n.length;i<o;i++){var a=n[i];if(a){var s=a.mergeId;r[i]={mergeId:s}}}t.items.splice(e+1,0,r)}else t.items.splice(e+1,0,[])}};this.snapshot.addAction(n),n.redo()}},{key:"insertColAfter",value:function(e){var t=this,n={undo:function(){for(var n=0,r=t.items.length;n<r;n++){var i=t.items[n];i&&i.splice(e+1,1)}},redo:function(){for(var n=0,r=t.items.length;n<r;n++){var i=t.items[n];if(i){var o=i[e];if(o){var a=o.mergeId;i.splice(e+1,0,{mergeId:a})}else i.splice(e+1,0,{})}}}};this.snapshot.addAction(n),n.redo()}},{key:"insertRowBefore",value:function(e){var t=this,n={undo:function(){t.items.splice(e,1)},redo:function(){var n=t.items[e];if(n){for(var r=[],i=0,o=n.length;i<o;i++){var a=n[i];if(a){var s=a.mergeId;r[i]={mergeId:s}}}t.items.splice(e,0,r)}else t.items.splice(e,0,[])}};this.snapshot.addAction(n),n.redo()}},{key:"insertColBefore",value:function(e){var t=this,n={undo:function(){for(var n=0,r=t.items.length;n<r;n++){var i=t.items[n];i&&i.splice(e,1)}},redo:function(){for(var n=0,r=t.items.length;n<r;n++){var i=t.items[n];if(i){var o=i[e];if(o){var a=o.mergeId;i.splice(e,0,{mergeId:a})}else i.splice(e,0,{})}}}};this.snapshot.addAction(n),n.redo()}}])&&Le(t.prototype,n),r&&Le(t,r),e}();addEventListener("message",(function(e){var t=e.data,n=new Me({items:t}),r=0,i=0;n.each((function(e){if(e){var t=e.getCell();if(t.hasFormula()){var n=t.getComputeText();u.isNumber(n)&&(r+=u.parseFloat(n),i++)}else switch(t.contentType){case Ie.TYPE.NUMBER:r+=t.getComputeText(),i++}}})),postMessage({total:r,number:i})}))}]);
//# sourceMappingURL=sumtotal.worker.js.map