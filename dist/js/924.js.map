{"version":3,"file":"js/924.js","mappings":"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","sources":["webpack://x-sheet/./src/const/Constant.js","webpack://x-sheet/./src/core/table/XTableTextFormat.js","webpack://x-sheet/./src/core/table/tablecell/Border.js","webpack://x-sheet/./src/core/table/tablecell/Cell.js","webpack://x-sheet/./src/core/table/tablecell/CellBorder.js","webpack://x-sheet/./src/core/table/tablecell/CellFont.js","webpack://x-sheet/./src/core/table/tablecell/RichFont.js","webpack://x-sheet/./src/core/table/tablecell/RichFonts.js","webpack://x-sheet/./src/core/table/tableicon/XIcon.js","webpack://x-sheet/./src/core/table/tableicon/XIconOffset.js","webpack://x-sheet/./src/core/work/head/tool/Icon.js","webpack://x-sheet/./src/draw/Crop.js","webpack://x-sheet/./src/draw/Line.js","webpack://x-sheet/./src/draw/Rect.js","webpack://x-sheet/./src/draw/XDraw.js","webpack://x-sheet/./src/draw/font/BaseFont.js","webpack://x-sheet/./src/formula/Compiler.js","webpack://x-sheet/./src/formula/Formula.js","webpack://x-sheet/./src/lib/Element.js","webpack://x-sheet/./src/lib/Widget.js","webpack://x-sheet/./src/lib/XEvent.js","webpack://x-sheet/./src/module/colorpicker/ColorPicker.js","webpack://x-sheet/./src/module/colorpicker/colorarray/ColorArray.js","webpack://x-sheet/./src/module/colorpicker/colorarray/ColorItem.js","webpack://x-sheet/./src/module/dragpanel/DragPanel.js","webpack://x-sheet/./src/utils/DateUtils.js","webpack://x-sheet/./src/utils/SheetUtils.js"],"sourcesContent":["const cssPrefix = 'x-sheet';\nconst XSheetVersion = `${cssPrefix} 1.0.0-develop`;\nconst Constant = {};\nConstant.WORK_BODY_EVENT_TYPE = {\n  CHANGE_ACTIVE: 'changeactive',\n  REMOVE_SHEET: 'removesheet',\n};\nConstant.SYSTEM_EVENT_TYPE = {\n  MOUSE_MOVE: 'mousemove',\n  MOUSE_DOWN: 'mousedown',\n  CONTEXT_MENU: 'contextmenu',\n  SCROLL: 'scroll',\n  RESIZE: 'resize',\n  MOUSE_UP: 'mouseup',\n  INPUT: 'input',\n  KEY_DOWN: 'keydown',\n  KEY_UP: 'keyup',\n  MOUSE_OVER: 'mouseover',\n  MOUSE_LEAVE: 'mouseleave',\n  MOUSE_WHEEL: 'wheel',\n  MOUSE_ENTER: 'mouseenter',\n  CLICK: 'click',\n  FOCUS: 'focus',\n  BLUR: 'blur',\n  DRAG_START: 'dragstart',\n  CHANGE: 'change',\n  VISIBILITY_CHANGE: 'visibilitychange',\n};\nConstant.TABLE_EVENT_TYPE = {\n  RENDER: 'render',\n  SNAPSHOT_CHANGE: 'snapshotchange',\n  CHANGE_ROW_HEIGHT: 'changerowheight',\n  CHANGE_COL_WIDTH: 'changecolwidth',\n  SCALE_CHANGE: 'scalechange',\n  EDIT_START: 'editstart',\n  EDIT_INPUT: 'editinput',\n  EDIT_FINISH: 'editfinish',\n  REMOVE_ROW: 'removerow',\n  REMOVE_COL: 'removecol',\n  ADD_NEW_ROW: 'addnewrow',\n  ADD_NEW_COL: 'addnewcol',\n  FIXED_CHANGE: 'fixedchange',\n  FIXED_COL_CHANGE: 'fixedcolchange',\n  FIXED_ROW_CHANGE: 'fixedrowchange',\n  SELECT_OVER: 'selectover',\n  SELECT_DOWN: 'selectdown',\n  SELECT_CHANGE: 'selectchange',\n  DATA_CHANGE: 'datachange',\n  RESIZE_CHANGE: 'resizechange',\n};\nConstant.FORM_EVENT_TYPE = {\n  SEARCH_INPUT_CHANGE: 'searchinputchange',\n  PLAIN_INPUT_CHANGE: 'plaininputchange',\n  FORM_SELECT_CHANGE: 'formselectchange',\n};\nexport {\n  XSheetVersion,\n  Constant,\n  cssPrefix,\n};\n","import { SheetUtils } from '../../utils/SheetUtils';\r\nimport { DateUtils } from '../../utils/DateUtils';\r\n\r\nclass Format {\r\n\r\n  default(value) {\r\n    return this.text(value);\r\n  }\r\n\r\n  text(value) {\r\n    return value ? `${value}` : '';\r\n  }\r\n\r\n  // =============================数字==============================\r\n\r\n  number(value) {\r\n    return this.text(value);\r\n  }\r\n\r\n  fraction(value) {\r\n    if (SheetUtils.isFraction(value)) {\r\n      const left = value.split('/')[0];\r\n      const right = value.split('/')[1];\r\n      return this.text(SheetUtils.parseInt(left) / SheetUtils.parseInt(right));\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  eNotation(value) {\r\n    if (SheetUtils.isNumber(value)) {\r\n      const number = SheetUtils.parseFloat(value);\r\n      return number.toExponential(2);\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  decimal(value) {\r\n    if (SheetUtils.isNumber(value)) {\r\n      const indexOf = value.toString().indexOf('.');\r\n      if (indexOf !== -1) {\r\n        return value.toString().substring(0, indexOf + 3);\r\n      }\r\n      return `${value}.00`;\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  percentage(value) {\r\n    if (SheetUtils.isNumber(value)) {\r\n      return `${value}%`;\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  // =============================货币==============================\r\n\r\n  rmb(value) {\r\n    if (SheetUtils.isNumber(value)) {\r\n      return `￥${value}`;\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  hk(value) {\r\n    if (SheetUtils.isNumber(value)) {\r\n      return `HK${value}`;\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  dollar(value) {\r\n    if (SheetUtils.isNumber(value)) {\r\n      return `$${value}`;\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  // =============================日期==============================\r\n\r\n  time(value) {\r\n    const result = DateUtils.parse(value);\r\n    if (result) {\r\n      return DateUtils.dateFormat('hh:mm:ss', result);\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  date1(value) {\r\n    const result = DateUtils.parse(value);\r\n    if (result) {\r\n      return DateUtils.dateFormat('yyyy/MM/dd', result);\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  date2(value) {\r\n    const result = DateUtils.parse(value);\r\n    if (result) {\r\n      return DateUtils.dateFormat('MM月dd日', result);\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  date3(value) {\r\n    const result = DateUtils.parse(value);\r\n    if (result) {\r\n      return DateUtils.dateFormat('yyyy年MM月', result);\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  date4(value) {\r\n    const result = DateUtils.parse(value);\r\n    if (result) {\r\n      return DateUtils.dateFormat('yyyy年MM月dd日', result);\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  date5(value) {\r\n    const result = DateUtils.parse(value);\r\n    if (result) {\r\n      return DateUtils.dateFormat('yyyy/MM/dd hh:mm:ss', result);\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n}\r\n\r\nconst format = new Format();\r\n\r\nexport default (type, value) => format[type](value);\r\n","import { LINE_TYPE } from '../../../draw/Line';\r\nimport { SheetUtils } from '../../../utils/SheetUtils';\r\nimport { XDraw } from '../../../draw/XDraw';\r\n\r\nlet zIndexID = 0;\r\n\r\n/**\r\n * Border\r\n * @author jerry\r\n */\r\nclass Border {\r\n\r\n  static getZIndex() {\r\n    zIndexID += 1;\r\n    return zIndexID;\r\n  }\r\n\r\n  constructor({\r\n    widthType = XDraw.LINE_WIDTH_TYPE.low,\r\n    type = LINE_TYPE.SOLID_LINE,\r\n    width = -1,\r\n    color = 'rgb(0,0,0)',\r\n    zIndex = 0,\r\n    display = false,\r\n  } = {}) {\r\n    this.zIndex = zIndex;\r\n    this.display = display;\r\n    this.color = color;\r\n    this.type = type;\r\n    if (width === 1) {\r\n      this.widthType = XDraw.LINE_WIDTH_TYPE.low;\r\n    } else if (width === 2) {\r\n      this.widthType = XDraw.LINE_WIDTH_TYPE.medium;\r\n    } else if (width === 3) {\r\n      this.widthType = XDraw.LINE_WIDTH_TYPE.high;\r\n    } else {\r\n      this.widthType = widthType;\r\n    }\r\n    if (zIndex > zIndexID) {\r\n      zIndexID = zIndex;\r\n    }\r\n  }\r\n\r\n  priority(border) {\r\n    if (SheetUtils.isUnDef(border)) {\r\n      return -2;\r\n    }\r\n    const origin = this.zIndex;\r\n    const target = border.zIndex;\r\n    if (origin > target) {\r\n      return 1;\r\n    }\r\n    if (target > origin) {\r\n      return -1;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  setColor(value) {\r\n    this.zIndex = Border.getZIndex();\r\n    this.color = value;\r\n  }\r\n\r\n  setDisplay(value) {\r\n    this.zIndex = Border.getZIndex();\r\n    this.display = value;\r\n  }\r\n\r\n  setType(value) {\r\n    this.zIndex = Border.getZIndex();\r\n    this.type = value;\r\n  }\r\n\r\n  setZIndex(value) {\r\n    this.zIndex = value;\r\n  }\r\n\r\n  setWidthType(value) {\r\n    this.zIndex = Border.getZIndex();\r\n    this.widthType = value;\r\n  }\r\n\r\n  clone() {\r\n    return new Border({\r\n      widthType: this.widthType,\r\n      color: this.color,\r\n      zIndex: this.zIndex,\r\n      type: this.type,\r\n      display: this.display,\r\n    });\r\n  }\r\n\r\n  equal(target) {\r\n    const widthType = this.widthType === target.widthType;\r\n    const color = this.color === target.color;\r\n    const type = this.type === target.type;\r\n    return color && widthType && type;\r\n  }\r\n\r\n}\r\n\r\nexport { Border };\r\n","import { SheetUtils } from '../../../utils/SheetUtils';\r\nimport { CellFont } from './CellFont';\r\nimport { CellBorder } from './CellBorder';\r\nimport { XIcon } from '../tableicon/XIcon';\r\nimport XTableFormat from '../XTableTextFormat';\r\nimport { RichFonts } from './RichFonts';\r\nimport { Formula } from '../../../formula/Formula';\r\nimport { DateUtils } from '../../../utils/DateUtils';\r\nimport { BaseFont } from '../../../draw/font/BaseFont';\r\n\r\n/**\r\n * 单元格\r\n */\r\nclass Cell {\r\n\r\n  /**\r\n   * Cell\r\n   * @param borderAttr\r\n   * @param fontAttr\r\n   * @param richText\r\n   * @param formula\r\n   * @param background\r\n   * @param text\r\n   * @param ruler\r\n   * @param contentWidth\r\n   * @param contentHeight\r\n   * @param format\r\n   * @param custom\r\n   * @param icons\r\n   * @param contentType\r\n   */\r\n  constructor({\r\n    borderAttr = SheetUtils.Undef,\r\n    fontAttr = SheetUtils.Undef,\r\n    richText = SheetUtils.Undef,\r\n    formula = SheetUtils.Undef,\r\n    background = SheetUtils.Undef,\r\n    text = SheetUtils.EMPTY,\r\n    custom = {},\r\n    icons = [],\r\n    ruler = SheetUtils.Undef,\r\n    contentWidth = 0,\r\n    contentHeight = 0,\r\n    format = 'default',\r\n    contentType = Cell.TYPE.STRING,\r\n  } = {}) {\r\n    // 背景颜色\r\n    this.background = background;\r\n    // 单元格图标\r\n    this.icons = XIcon.getInstance(icons);\r\n    // 自定义属性\r\n    this.custom = custom;\r\n    // 字体测量尺子\r\n    this.ruler = ruler;\r\n    // 格式化类型\r\n    this.format = format;\r\n    // 单元格公式\r\n    this.formula = Formula.getInstance(formula);\r\n    // 文本内容\r\n    this.text = text;\r\n    // 富文本内容\r\n    this.richText = RichFonts.getInstance(richText);\r\n    // 格式化后的内容\r\n    this.formatText = SheetUtils.EMPTY;\r\n    // 内容的宽度\r\n    this.contentWidth = contentWidth;\r\n    // 内容的高度\r\n    this.contentHeight = contentHeight;\r\n    // 字体属性\r\n    this.fontAttr = CellFont.getInstance(fontAttr);\r\n    // 边框属性\r\n    this.borderAttr = CellBorder.getInstance(borderAttr);\r\n    // 内容类型\r\n    this.setContentType(contentType);\r\n  }\r\n\r\n  /**\r\n   * 设置单元格小图标\r\n   * @param icons\r\n   */\r\n  setIcons(icons) {\r\n    this.icons = icons;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置内容文本\r\n   * @param text\r\n   */\r\n  setText(text) {\r\n    this.formatText = null;\r\n    this.text = text;\r\n    this.formula.setExpr(null);\r\n    this.richText.setRich([]);\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置富文本\r\n   */\r\n  setRichText(rich) {\r\n    this.formatText = null;\r\n    this.text = null;\r\n    this.formula.setExpr(null);\r\n    this.richText.setRich(rich);\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置公式\r\n   */\r\n  setExpr(expr) {\r\n    this.formatText = null;\r\n    this.text = null;\r\n    this.formula.setExpr(expr);\r\n    this.richText.setRich([]);\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 获取公式\r\n   */\r\n  getExpr() {\r\n    return this.formula.getExpr();\r\n  }\r\n\r\n  /**\r\n   * 设置格式化类型\r\n   * @param format\r\n   */\r\n  setFormat(format = 'default') {\r\n    this.format = format;\r\n    this.formatText = null;\r\n    this.setContentWidth(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 保存测量尺子\r\n   * @param ruler\r\n   */\r\n  setRuler(ruler) {\r\n    this.ruler = ruler;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置内容类型\r\n   * @param type\r\n   */\r\n  setContentType(type = Cell.TYPE.STRING) {\r\n    const { text } = this;\r\n    switch (type) {\r\n      case Cell.TYPE.STRING: {\r\n        this.contentType = Cell.TYPE.STRING;\r\n        break;\r\n      }\r\n      case Cell.TYPE.NUMBER: {\r\n        this.contentType = type;\r\n        if (SheetUtils.isNumber(text)) {\r\n          this.contentType = Cell.TYPE.NUMBER;\r\n          this.text = SheetUtils.parseFloat(text);\r\n        } else {\r\n          this.contentType = Cell.TYPE.STRING;\r\n          this.text = `${text}`;\r\n        }\r\n        break;\r\n      }\r\n      case Cell.TYPE.DATE_TIME: {\r\n        const parse = DateUtils.parse(text);\r\n        if (SheetUtils.isDate(parse)) {\r\n          this.contentType = Cell.TYPE.DATE_TIME;\r\n          this.text = text;\r\n        } else {\r\n          this.contentType = Cell.TYPE.STRING;\r\n          this.text = `${text}`;\r\n        }\r\n        break;\r\n      }\r\n      case Cell.TYPE.RICH_TEXT: {\r\n        this.contentType = Cell.TYPE.RICH_TEXT;\r\n        break;\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 单元格是否为空\r\n   * @returns {boolean}\r\n   */\r\n  isEmpty() {\r\n    return SheetUtils.isBlank(this.getComputeText());\r\n  }\r\n\r\n  /**\r\n   * 公式是否存在\r\n   */\r\n  hasFormula() {\r\n    return this.formula.hasExpr();\r\n  }\r\n\r\n  /**\r\n   * 获取格式后的文本\r\n   * @returns {string|*}\r\n   */\r\n  getFormatText() {\r\n    let {\r\n      text,\r\n      formula,\r\n      format,\r\n    } = this;\r\n    let { formatText } = this;\r\n    let { contentType } = this;\r\n    // 优先获取公式值\r\n    if (formula.hasExpr()) {\r\n      let value = formula.getValue();\r\n      if (value) {\r\n        if (SheetUtils.isBlank(formatText)) {\r\n          formatText = XTableFormat(format, value);\r\n        }\r\n      }\r\n      this.formatText = formatText;\r\n      return formatText;\r\n    }\r\n    // 格式化文本\r\n    switch (contentType) {\r\n      case Cell.TYPE.STRING:\r\n      case Cell.TYPE.NUMBER:\r\n      case Cell.TYPE.DATE_TIME: {\r\n        if (format) {\r\n          if (SheetUtils.isBlank(formatText)) {\r\n            this.formatText = XTableFormat(format, text);\r\n            return this.formatText;\r\n          }\r\n        }\r\n        return formatText;\r\n      }\r\n    }\r\n    // 默认返回\r\n    return SheetUtils.EMPTY;\r\n  }\r\n\r\n  /**\r\n   * 获取计算后的文本\r\n   * @returns {string|*}\r\n   */\r\n  getComputeText() {\r\n    let { text, formula } = this;\r\n    let { richText } = this;\r\n    let { contentType } = this;\r\n    // 优先获取公式值\r\n    if (formula.hasExpr()) {\r\n      return formula.getValue();\r\n    }\r\n    // 读取不同类型\r\n    switch (contentType) {\r\n      case Cell.TYPE.STRING:\r\n      case Cell.TYPE.NUMBER:\r\n      case Cell.TYPE.DATE_TIME: {\r\n        return text;\r\n      }\r\n      case Cell.TYPE.RICH_TEXT: {\r\n        return richText;\r\n      }\r\n    }\r\n    // 默认返回\r\n    return SheetUtils.EMPTY;\r\n  }\r\n\r\n  /**\r\n   * 字体属性\r\n   * @param attr\r\n   */\r\n  setFontAttr(attr) {\r\n    this.fontAttr = attr;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置边框类型\r\n   * @param attr\r\n   */\r\n  setBorderAttr(attr) {\r\n    this.borderAttr = attr;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 复制单元格\r\n   * @returns {Cell}\r\n   */\r\n  clone() {\r\n    return new Cell(this);\r\n  }\r\n\r\n  /**\r\n   * 复制单元格样式\r\n   * @returns {Cell}\r\n   */\r\n  cloneStyle() {\r\n    return new Cell({\r\n      borderAttr: this.borderAttr,\r\n      fontAttr: this.fontAttr,\r\n      background: this.background,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * toJSON\r\n   */\r\n  toJSON() {\r\n    const { background, text, format, custom } = this;\r\n    const { icons, contentType, formula } = this;\r\n    const { richText, fontAttr, borderAttr } = this;\r\n    return {\r\n      custom,\r\n      richText,\r\n      formula,\r\n      contentType,\r\n      text,\r\n      icons,\r\n      background,\r\n      format,\r\n      fontAttr,\r\n      borderAttr,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * toString\r\n   * @returns {string|*}\r\n   */\r\n  toString() {\r\n    return this.getFormatText();\r\n  }\r\n\r\n  /**\r\n   * 内容宽度\r\n   * @param width\r\n   */\r\n  setContentWidth(width) {\r\n    this.contentWidth = width;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 内容宽度\r\n   * @param height\r\n   */\r\n  setContentHeight(height) {\r\n    this.contentHeight = height;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置换行类型\r\n   * @param textWrap\r\n   */\r\n  setTextWrap(textWrap) {\r\n    this.fontAttr.textWrap = textWrap;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体颜色\r\n   * @param color\r\n   */\r\n  setFontColor(color) {\r\n    this.fontAttr.color = color;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体颜色\r\n   * @param color\r\n   */\r\n  setRichFontColor(color) {\r\n    this.richText.each((i) => {\r\n      i.color = color;\r\n    });\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体大小\r\n   * @param size\r\n   */\r\n  setFontSize(size) {\r\n    this.fontAttr.size = size;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体大小\r\n   * @param size\r\n   */\r\n  setRichFontSize(size) {\r\n    this.richText.each((i) => {\r\n      i.size = size;\r\n    });\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体加粗\r\n   * @param bold\r\n   */\r\n  setFontBold(bold) {\r\n    this.fontAttr.bold = bold;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体加粗\r\n   * @param bold\r\n   */\r\n  setRichFontBold(bold) {\r\n    this.richText.each((i) => {\r\n      i.bold = bold;\r\n    });\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置斜体字\r\n   * @param italic\r\n   */\r\n  setFontItalic(italic) {\r\n    this.fontAttr.italic = italic;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置斜体字\r\n   * @param italic\r\n   */\r\n  setRichFontItalic(italic) {\r\n    this.richText.each((i) => {\r\n      i.italic = italic;\r\n    });\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体名称\r\n   * @param name\r\n   */\r\n  setFontName(name) {\r\n    this.fontAttr.name = name;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体名称\r\n   * @param name\r\n   */\r\n  setRichFontName(name) {\r\n    this.richText.each((i) => {\r\n      i.name = name;\r\n    });\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置下划线\r\n   * @param underline\r\n   */\r\n  setUnderLine(underline) {\r\n    this.fontAttr.underline = underline;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置下划线\r\n   * @param underline\r\n   */\r\n  setRichUnderLine(underline) {\r\n    this.richText.each((i) => {\r\n      i.underline = underline;\r\n    });\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置删除线\r\n   * @param strikeline\r\n   */\r\n  setStrikeLine(strikeline) {\r\n    this.fontAttr.strikethrough = strikeline;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置删除线\r\n   * @param strikeline\r\n   */\r\n  setRichStrikeLine(strikeline) {\r\n    this.richText.each((i) => {\r\n      i.strikethrough = strikeline;\r\n    });\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体旋转角度\r\n   * @param number\r\n   */\r\n  setFontAngle(number) {\r\n    if (number === 0) {\r\n      this.fontAttr.angle = number;\r\n      this.fontAttr.direction = BaseFont.TEXT_DIRECTION.HORIZONTAL;\r\n    } else {\r\n      this.borderAttr.updateMaxIndex();\r\n      this.fontAttr.angle = number;\r\n      this.fontAttr.direction = BaseFont.TEXT_DIRECTION.ANGLE;\r\n    }\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体方向\r\n   * @param direction\r\n   */\r\n  setFontDirection(direction) {\r\n    this.fontAttr.angle = 0;\r\n    this.fontAttr.direction = direction;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置背景\r\n   */\r\n  setBackground(background) {\r\n    this.background = background;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体水平对齐\r\n   * @param align\r\n   */\r\n  setFontAlign(align) {\r\n    this.fontAttr.align = align;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置垂直对齐\r\n   * @param verticalAlign\r\n   */\r\n  setFontVerticalAlign(verticalAlign) {\r\n    this.fontAttr.verticalAlign = verticalAlign;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\n/**\r\n * 单元格类型\r\n */\r\nCell.TYPE = {\r\n  // 数字\r\n  NUMBER: 0,\r\n  // 字符\r\n  STRING: 1,\r\n  // 富文本\r\n  RICH_TEXT: 2,\r\n  // 日期\r\n  DATE_TIME: 3,\r\n};\r\n\r\nexport {\r\n  Cell,\r\n};\r\n","import { Border } from './Border';\r\nimport { LINE_TYPE } from '../../../draw/Line';\r\n\r\n/**\r\n * CellBorder\r\n * @author jerry\r\n */\r\nclass CellBorder {\r\n\r\n  /**\r\n   * CellBorder\r\n   * @param time\r\n   * @param left\r\n   * @param top\r\n   * @param right\r\n   * @param bottom\r\n   */\r\n  constructor({\r\n    left = {},\r\n    bottom = {},\r\n    top = {},\r\n    right = {},\r\n  } = {}) {\r\n    this.left = new Border(left);\r\n    this.bottom = new Border(bottom);\r\n    this.top = new Border(top);\r\n    this.right = new Border(right);\r\n  }\r\n\r\n  hasDouble() {\r\n    const { top, left, right, bottom } = this;\r\n    if (top.type === LINE_TYPE.DOUBLE_LINE) {\r\n      return true;\r\n    }\r\n    if (left.type === LINE_TYPE.DOUBLE_LINE) {\r\n      return true;\r\n    }\r\n    if (right.type === LINE_TYPE.DOUBLE_LINE) {\r\n      return true;\r\n    }\r\n    return bottom.type === LINE_TYPE.DOUBLE_LINE;\r\n  }\r\n\r\n  isDisplay() {\r\n    return this.left.display || this.top.display\r\n      || this.bottom.display || this.right.display;\r\n  }\r\n\r\n  setAllDisplay(display) {\r\n    this.setBDisplay(display);\r\n    this.setLDisplay(display);\r\n    this.setTDisplay(display);\r\n    this.setRDisplay(display);\r\n  }\r\n\r\n  setLDisplay(display) {\r\n    this.left.setDisplay(display);\r\n  }\r\n\r\n  setTDisplay(display) {\r\n    this.top.setDisplay(display);\r\n  }\r\n\r\n  setRDisplay(display) {\r\n    this.right.setDisplay(display);\r\n  }\r\n\r\n  setBDisplay(display) {\r\n    this.bottom.setDisplay(display);\r\n  }\r\n\r\n  setAllColor(color) {\r\n    this.setBColor(color);\r\n    this.setLColor(color);\r\n    this.setTColor(color);\r\n    this.setRColor(color);\r\n  }\r\n\r\n  setLColor(color) {\r\n    this.left.setColor(color);\r\n  }\r\n\r\n  setTColor(color) {\r\n    this.top.setColor(color);\r\n  }\r\n\r\n  setRColor(color) {\r\n    this.right.setColor(color);\r\n  }\r\n\r\n  setBColor(color) {\r\n    this.bottom.setColor(color);\r\n  }\r\n\r\n  setAllWidthType(widthType) {\r\n    this.setBWidthType(widthType);\r\n    this.setLWidthType(widthType);\r\n    this.setTWidthType(widthType);\r\n    this.setRWidthType(widthType);\r\n  }\r\n\r\n  setLWidthType(widthType) {\r\n    this.left.setWidthType(widthType);\r\n  }\r\n\r\n  setTWidthType(widthType) {\r\n    this.top.setWidthType(widthType);\r\n  }\r\n\r\n  setRWidthType(widthType) {\r\n    this.right.setWidthType(widthType);\r\n  }\r\n\r\n  setBWidthType(widthType) {\r\n    this.bottom.setWidthType(widthType);\r\n  }\r\n\r\n  setAllType(type) {\r\n    this.setBType(type);\r\n    this.setLType(type);\r\n    this.setTType(type);\r\n    this.setRType(type);\r\n  }\r\n\r\n  setLType(type) {\r\n    this.left.setType(type);\r\n  }\r\n\r\n  setTType(type) {\r\n    this.top.setType(type);\r\n  }\r\n\r\n  setRType(type) {\r\n    this.right.setType(type);\r\n  }\r\n\r\n  setBType(type) {\r\n    this.bottom.setType(type);\r\n  }\r\n\r\n  updateMaxIndex() {\r\n    const zIndex = Border.getZIndex();\r\n    this.left.setZIndex(zIndex);\r\n    this.bottom.setZIndex(zIndex);\r\n    this.top.setZIndex(zIndex);\r\n    this.right.setZIndex(zIndex);\r\n  }\r\n\r\n  clone() {\r\n    const { left, top, right, bottom } = this;\r\n    return new CellBorder({\r\n      left: left.clone(),\r\n      top: top.clone(),\r\n      right: right.clone(),\r\n      bottom: bottom.clone(),\r\n    });\r\n  }\r\n\r\n}\r\n\r\nCellBorder.EMPTY = new CellBorder();\r\n\r\nCellBorder.getInstance = (config) => {\r\n  if (config) {\r\n    return new CellBorder(config);\r\n  }\r\n  return CellBorder.EMPTY;\r\n};\r\n\r\nexport { CellBorder };\r\n","import { BaseFont } from '../../../draw/font/BaseFont';\r\nimport { ColorArray } from '../../../module/colorpicker/colorarray/ColorArray';\r\nimport { SheetUtils } from '../../../utils/SheetUtils';\r\n\r\n/**\r\n *  CellFont\r\n *  @author jerry\r\n */\r\nclass CellFont {\r\n\r\n  /**\r\n   * CellFont\r\n   * @param align\r\n   * @param verticalAlign\r\n   * @param textWrap\r\n   * @param strikethrough\r\n   * @param underline\r\n   * @param color\r\n   * @param name\r\n   * @param size\r\n   * @param bold\r\n   * @param italic\r\n   * @param angle\r\n   * @param direction\r\n   * @param padding\r\n   */\r\n  constructor({\r\n    align = BaseFont.ALIGN.left,\r\n    verticalAlign = BaseFont.VERTICAL_ALIGN.center,\r\n    textWrap = BaseFont.TEXT_WRAP.TRUNCATE,\r\n    strikethrough = false,\r\n    underline = false,\r\n    color = ColorArray.BLACK,\r\n    name = 'Arial',\r\n    size = 14,\r\n    bold = false,\r\n    italic = false,\r\n    angle = 0,\r\n    direction = BaseFont.TEXT_DIRECTION.HORIZONTAL,\r\n    padding = 5,\r\n  } = {}) {\r\n    this.align = align;\r\n    this.verticalAlign = verticalAlign;\r\n    this.textWrap = textWrap;\r\n    this.strikethrough = strikethrough;\r\n    this.underline = underline;\r\n    this.color = color;\r\n    this.name = name;\r\n    this.size = size;\r\n    this.bold = bold;\r\n    this.italic = italic;\r\n    this.direction = direction;\r\n    this.angle = angle;\r\n    this.padding = padding;\r\n  }\r\n\r\n  like(other) {\r\n    let keys1 = Object.keys(this);\r\n    let keys2 = Object.keys(other);\r\n    for (let key of keys2) {\r\n      if (!keys1.includes(key)) {\r\n        return false;\r\n      }\r\n    }\r\n    for (let key of keys2) {\r\n      let src = this[key];\r\n      let val = other[key];\r\n      switch (key) {\r\n        case 'color': {\r\n          src = SheetUtils.clearBlank(src);\r\n          val = SheetUtils.clearBlank(val);\r\n          break;\r\n        }\r\n      }\r\n      if (src !== val) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  clone() {\r\n    const {\r\n      align,\r\n      verticalAlign,\r\n      textWrap,\r\n      strikethrough,\r\n      underline,\r\n      color,\r\n      name,\r\n      size,\r\n      bold,\r\n      italic,\r\n      angle,\r\n      direction,\r\n      padding,\r\n    } = this;\r\n    return new CellFont({\r\n      align,\r\n      verticalAlign,\r\n      textWrap,\r\n      strikethrough,\r\n      underline,\r\n      color,\r\n      name,\r\n      size,\r\n      bold,\r\n      italic,\r\n      angle,\r\n      direction,\r\n      padding,\r\n    });\r\n  }\r\n\r\n  reset() {\r\n    this.align = BaseFont.ALIGN.left;\r\n    this.verticalAlign = BaseFont.VERTICAL_ALIGN.center;\r\n    this.textWrap = BaseFont.TEXT_WRAP.TRUNCATE;\r\n    this.strikethrough = false;\r\n    this.underline = false;\r\n    this.color = ColorArray.BLACK;\r\n    this.name = 'Arial';\r\n    this.size = 14;\r\n    this.bold = false;\r\n    this.italic = false;\r\n    this.angle = 0;\r\n    this.direction = BaseFont.TEXT_DIRECTION.HORIZONTAL;\r\n    this.padding = 5;\r\n  }\r\n\r\n  equals(other) {\r\n    let keys1 = Object.keys(this);\r\n    let keys2 = Object.keys(other);\r\n    for (let key of keys1) {\r\n      if (!keys2.includes(key)) {\r\n        return false;\r\n      }\r\n    }\r\n    for (let key of keys1) {\r\n      let src = this[key];\r\n      let val = other[key];\r\n      switch (key) {\r\n        case 'color': {\r\n          src = SheetUtils.clearBlank(src);\r\n          val = SheetUtils.clearBlank(val);\r\n          break;\r\n        }\r\n      }\r\n      if (src !== val) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n}\r\n\r\nCellFont.EMPTY = new CellFont();\r\n\r\nCellFont.getInstance = (config) => {\r\n  if (config) {\r\n    return new CellFont(config);\r\n  }\r\n  return CellFont.EMPTY;\r\n};\r\n\r\nexport { CellFont };\r\n","import { SheetUtils } from '../../../utils/SheetUtils';\r\nimport { ColorArray } from '../../../module/colorpicker/colorarray/ColorArray';\r\n\r\nclass RichFont {\r\n\r\n  constructor({\r\n    text = '',\r\n    color = ColorArray.BLACK,\r\n    name = 'Arial',\r\n    size = 14,\r\n    bold = false,\r\n    italic = false,\r\n    strikethrough = false,\r\n    underline = false,\r\n    scaleAdapter,\r\n  } = {}) {\r\n    this.color = color;\r\n    this.text = `${text}`;\r\n    this.name = name;\r\n    this.size = size;\r\n    this.italic = italic;\r\n    this.bold = bold;\r\n    this.strikethrough = strikethrough;\r\n    this.underline = underline;\r\n    this.scaleAdapter = scaleAdapter;\r\n  }\r\n\r\n  clone() {\r\n    const { text, color, name, size } = this;\r\n    const { italic, bold, underline } = this;\r\n    const { strikethrough, scaleAdapter } = this;\r\n    return new RichFont({\r\n      text, color, name, size, italic, bold, underline, strikethrough, scaleAdapter,\r\n    });\r\n  }\r\n\r\n  reset() {\r\n    this.color = ColorArray.BLACK;\r\n    this.name = 'Arial';\r\n    this.size = 14;\r\n    this.bold = false;\r\n    this.italic = false;\r\n    this.strikethrough = false;\r\n    this.underline = false;\r\n  }\r\n\r\n  plain(option = (v) => v) {\r\n    return option(this.clone());\r\n  }\r\n\r\n  like(other) {\r\n    let ignore = ['scaleAdapter'];\r\n    let keys1 = Object.keys(this);\r\n    let keys2 = Object.keys(other);\r\n    for (let key of keys2) {\r\n      if (ignore.includes(key)) {\r\n        continue;\r\n      }\r\n      if (!keys1.includes(key)) {\r\n        return false;\r\n      }\r\n    }\r\n    for (let key of keys2) {\r\n      if (ignore.includes(key)) {\r\n        continue;\r\n      }\r\n      let src = this[key];\r\n      let val = other[key];\r\n      switch (key) {\r\n        case 'color': {\r\n          src = SheetUtils.clearBlank(src);\r\n          val = SheetUtils.clearBlank(val);\r\n          break;\r\n        }\r\n      }\r\n      if (src !== val) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  equals(other) {\r\n    let ignore = ['scaleAdapter'];\r\n    let keys1 = Object.keys(this);\r\n    let keys2 = Object.keys(other);\r\n    for (let key of keys1) {\r\n      if (ignore.includes(key)) {\r\n        continue;\r\n      }\r\n      if (!keys2.includes(key)) {\r\n        return false;\r\n      }\r\n    }\r\n    for (let key of keys1) {\r\n      if (ignore.includes(key)) {\r\n        continue;\r\n      }\r\n      let src = this[key];\r\n      let val = other[key];\r\n      switch (key) {\r\n        case 'color': {\r\n          src = SheetUtils.clearBlank(src);\r\n          val = SheetUtils.clearBlank(val);\r\n          break;\r\n        }\r\n      }\r\n      if (src !== val) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  RichFont,\r\n};\r\n","import { RichFont } from './RichFont';\r\nimport { SheetUtils } from '../../../utils/SheetUtils';\r\n\r\nclass RichFonts {\r\n\r\n  constructor({\r\n    rich = [],\r\n  } = {}) {\r\n    this.rich = rich.map((font) => new RichFont(font));\r\n  }\r\n\r\n  setRich(rich = []) {\r\n    this.rich = rich;\r\n  }\r\n\r\n  each(cb = () => {}) {\r\n    this.rich.forEach((font) => {\r\n      cb(font);\r\n    });\r\n  }\r\n\r\n  reset() {\r\n    this.each((i) => {\r\n      i.reset();\r\n    });\r\n  }\r\n\r\n  getRich() {\r\n    return this.rich;\r\n  }\r\n\r\n  clone() {\r\n    const rich = [];\r\n    this.rich.forEach((font) => {\r\n      rich.push(font.clone());\r\n    });\r\n    return new RichFonts({\r\n      rich,\r\n    });\r\n  }\r\n\r\n  hasLength() {\r\n    return this.rich.length > 0;\r\n  }\r\n\r\n  plain(option) {\r\n    const result = [];\r\n    this.rich.forEach((font) => {\r\n      result.push(font.plain(option));\r\n    });\r\n    return result;\r\n  }\r\n\r\n  like(other) {\r\n    if (SheetUtils.isUnDef(other)) {\r\n      return false;\r\n    }\r\n    if (other.rich.length !== this.rich.length) {\r\n      return false;\r\n    }\r\n    for (let i = 0; i < this.rich.length; i++) {\r\n      let item1 = this.rich[i];\r\n      let item2 = other.rich[i];\r\n      if (!item1.like(item2)) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  toString() {\r\n    let text = [];\r\n    this.each((i) => text.push(i.text));\r\n    return text.join('');\r\n  }\r\n\r\n  equals(other) {\r\n    if (SheetUtils.isUnDef(other)) {\r\n      return false;\r\n    }\r\n    if (other.rich.length !== this.rich.length) {\r\n      return false;\r\n    }\r\n    for (let i = 0; i < this.rich.length; i++) {\r\n      let item1 = this.rich[i];\r\n      let item2 = other.rich[i];\r\n      if (!item1.equals(item2)) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n}\r\n\r\nRichFonts.EMPTY = new RichFonts();\r\n\r\nRichFonts.getInstance = (config) => {\r\n  if (config) {\r\n    return new RichFonts(config);\r\n  }\r\n  return RichFonts.EMPTY;\r\n};\r\n\r\nexport {\r\n  RichFonts,\r\n};\r\n","/* global Image */\r\nimport { SheetUtils } from '../../../utils/SheetUtils';\r\nimport { XDraw } from '../../../draw/XDraw';\r\nimport { Rect } from '../../../draw/Rect';\r\nimport { XIconOffset } from './XIconOffset';\r\nimport { Crop } from '../../../draw/Crop';\r\n\r\n/**\r\n * XIcon\r\n * @author jerry\r\n * @date 2020/10/20\r\n */\r\nclass XIcon {\r\n\r\n  /**\r\n   * 多图标初始化\r\n   * @param icons\r\n   * @returns {[]}\r\n   */\r\n  static newInstances(icons = []) {\r\n    const instances = [];\r\n    for (let i = 0; i < icons.length; i += 1) {\r\n      const icon = icons[i];\r\n      instances.push(new XIcon(icon));\r\n    }\r\n    return instances;\r\n  }\r\n\r\n  /**\r\n   * XIcon\r\n   * @param vertical\r\n   * @param horizontal\r\n   * @param type\r\n   * @param image\r\n   * @param focus\r\n   * @param height\r\n   * @param width\r\n   * @param color\r\n   * @param offset\r\n   * @param onDraw\r\n   * @param onLeave\r\n   * @param onMove\r\n   * @param onDown\r\n   * @param onEnter\r\n   */\r\n  constructor({\r\n    vertical = XIcon.ICON_VERTICAL.CENTER,\r\n    horizontal = XIcon.ICON_HORIZONTAL.RIGHT,\r\n    type = XIcon.ICON_TYPE.image,\r\n    image = SheetUtils.Nul,\r\n    iconFocus = null,\r\n    height = 16,\r\n    width = 16,\r\n    color = 'rgb(255,255,255)',\r\n    offset = { x: 0, y: 0 },\r\n    onDraw = () => {},\r\n    onLeave = () => {},\r\n    onMove = () => {},\r\n    onDown = () => {},\r\n    onEnter = () => {},\r\n  }) {\r\n    this.vertical = vertical;\r\n    this.horizontal = horizontal;\r\n    this.width = width;\r\n    this.height = height;\r\n    this.type = type;\r\n    this.image = image;\r\n    this.color = color;\r\n    this.iconFocus = iconFocus;\r\n    this.offset = new XIconOffset(offset);\r\n    this.onLeave = onLeave;\r\n    this.onMove = onMove;\r\n    this.onDraw = onDraw;\r\n    this.onDown = onDown;\r\n    this.onEnter = onEnter;\r\n    this.rect = null;\r\n  }\r\n\r\n  /**\r\n   * 计算绘制坐标\r\n   * @param rect\r\n   * @returns {{x: number, y: number}}\r\n   */\r\n  position(rect) {\r\n    // 图标信息\r\n    const iconHorizontal = this.horizontal;\r\n    const iconVertical = this.vertical;\r\n    const iconOffsetX = XDraw.stylePx(this.offset.x);\r\n    const iconOffsetY = XDraw.stylePx(this.offset.y);\r\n    const iconWidth = XDraw.stylePx(this.width);\r\n    const iconHeight = XDraw.stylePx(this.height);\r\n    // 矩形位置\r\n    const rectX = rect.x;\r\n    const rectY = rect.y;\r\n    const rectWidth = rect.width;\r\n    const rectHeight = rect.height;\r\n    // 计算位置\r\n    let px = 0;\r\n    let py = 0;\r\n    switch (iconHorizontal) {\r\n      case XIcon.ICON_HORIZONTAL.CENTER:\r\n        px = (rectX + rectWidth / 2) - (iconWidth / 2);\r\n        break;\r\n      case XIcon.ICON_HORIZONTAL.LEFT:\r\n        px = rectX;\r\n        break;\r\n      case XIcon.ICON_HORIZONTAL.RIGHT:\r\n        px = rectX + rectWidth - iconWidth;\r\n        break;\r\n    }\r\n    switch (iconVertical) {\r\n      case XIcon.ICON_VERTICAL.CENTER:\r\n        py = (rectY + rectHeight / 2) - (iconHeight / 2);\r\n        break;\r\n      case XIcon.ICON_VERTICAL.TOP:\r\n        py = rectY;\r\n        break;\r\n      case XIcon.ICON_VERTICAL.BOTTOM:\r\n        py = rectY + rectHeight - iconHeight;\r\n        break;\r\n    }\r\n    px += iconOffsetX;\r\n    py += iconOffsetY;\r\n    return new Rect({\r\n      x: px, y: py, width: iconWidth, height: iconHeight,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 加载图片信息\r\n   * @param async\r\n   * @param sync\r\n   */\r\n  loadImage({\r\n    load, sync,\r\n  }) {\r\n    const { image, type } = this;\r\n    switch (type) {\r\n      case XIcon.ICON_TYPE.image:\r\n        if (image instanceof Image) {\r\n          sync(image);\r\n        } else {\r\n          const loadImg = new Image();\r\n          loadImg.src = image;\r\n          if (loadImg.complete) {\r\n            this.image = loadImg;\r\n            sync(this.image);\r\n          } else {\r\n            loadImg.onload = () => {\r\n              this.image = loadImg;\r\n              load(loadImg);\r\n            };\r\n            loadImg.onerror = () => {\r\n              // eslint-disable-next-line no-console\r\n              console.error(`图片加载失败${image}`);\r\n            };\r\n          }\r\n        }\r\n        break;\r\n      case XIcon.ICON_TYPE.draw:\r\n        sync();\r\n        break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 绘制小图标\r\n   * @param rect\r\n   * @param draw\r\n   */\r\n  drawIcon({\r\n    rect, draw,\r\n  }) {\r\n    const { type } = this;\r\n    this.rect = rect;\r\n    switch (type) {\r\n      case XIcon.ICON_TYPE.image:\r\n        this.drawImage({\r\n          rect, draw,\r\n        });\r\n        break;\r\n      case XIcon.ICON_TYPE.draw:\r\n        this.drawCustom({\r\n          rect, draw,\r\n        });\r\n        break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 自定义绘制\r\n   * @param rect\r\n   * @param icon\r\n   * @param draw\r\n   */\r\n  drawCustom({\r\n    rect, draw,\r\n  }) {\r\n    this.onDraw({\r\n      rect, draw,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 绘制图片\r\n   * @param rect\r\n   * @param icon\r\n   * @param draw\r\n   */\r\n  drawImage({\r\n    rect, draw,\r\n  }) {\r\n    const image = this.image;\r\n    const color = this.color;\r\n    const positionRect = this.position(rect);\r\n    const {\r\n      x, y, width, height,\r\n    } = positionRect;\r\n    const include = rect.includeRect(positionRect);\r\n    const crop = new Crop({\r\n      rect, draw,\r\n    });\r\n    if (include === false) {\r\n      crop.open();\r\n    }\r\n    if (color) {\r\n      draw.attr({ fillStyle: color });\r\n      draw.fillRect(x, y, width, height);\r\n    }\r\n    draw.drawImage(image, 0, 0, image.width, image.height, x, y, width, height);\r\n    if (include === false) {\r\n      crop.close();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 事件处理\r\n   * @param type\r\n   * @param x\r\n   * @param y\r\n   * @param native\r\n   */\r\n  eventHandle({\r\n    type, x, y, native,\r\n  }) {\r\n    const { rect, iconFocus } = this;\r\n    if (rect) {\r\n      const position = this.position(rect);\r\n      const location = position.inRectPosition(rect);\r\n      const { activate } = iconFocus;\r\n      switch (type) {\r\n        case XIcon.ICON_EVENT_TYPE.MOUSE_DOWN:\r\n          if (location.includePoint(x, y)) {\r\n            iconFocus.setActivate(this);\r\n            this.onDown({\r\n              native, position,\r\n            });\r\n          }\r\n          break;\r\n        case XIcon.ICON_EVENT_TYPE.MOUSE_MOVE:\r\n          if (location.includePoint(x, y)) {\r\n            if (activate !== this) {\r\n              this.onEnter({\r\n                native, position,\r\n              });\r\n            }\r\n            iconFocus.setActivate(this);\r\n            this.onMove({\r\n              native, position,\r\n            });\r\n          } else if (activate) {\r\n            iconFocus.setActivate(null);\r\n            this.onLeave({\r\n              native, position,\r\n            });\r\n          }\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 绘制回调\r\n   * @param callback\r\n   */\r\n  setOnDraw(callback) {\r\n    this.onDraw = callback;\r\n  }\r\n\r\n  /**\r\n   * 按下回调\r\n   * @param callback\r\n   */\r\n  setOnDown(callback) {\r\n    this.onDown = callback;\r\n  }\r\n\r\n  /**\r\n   * 移动回调\r\n   * @param callback\r\n   */\r\n  setOnMove(callback) {\r\n    this.onMove = callback;\r\n  }\r\n\r\n  /**\r\n   * 进入回调\r\n   * @param callback\r\n   */\r\n  setOnEnter(callback) {\r\n    this.onEnter = callback;\r\n  }\r\n\r\n  /**\r\n   * 离开回调\r\n   * @param callback\r\n   */\r\n  setOnLeave(callback) {\r\n    this.onLeave = callback;\r\n  }\r\n\r\n  /**\r\n   * 设置焦点元素\r\n   * @param iconFocus\r\n   */\r\n  setFocus(iconFocus) {\r\n    this.iconFocus = iconFocus;\r\n  }\r\n\r\n}\r\n\r\nXIcon.ICON_HORIZONTAL = {\r\n  LEFT: 0,\r\n  RIGHT: 1,\r\n  CENTER: 2,\r\n};\r\nXIcon.ICON_VERTICAL = {\r\n  TOP: 3,\r\n  BOTTOM: 4,\r\n  CENTER: 5,\r\n};\r\nXIcon.ICON_TYPE = {\r\n  image: 1,\r\n  custom: 2,\r\n};\r\nXIcon.ICON_EVENT_TYPE = {\r\n  MOUSE_DOWN: 1,\r\n  MOUSE_MOVE: 2,\r\n};\r\n\r\nXIcon.EMPTY = [];\r\nXIcon.getInstance = (config) => {\r\n  if (config) {\r\n    return XIcon.newInstances(config);\r\n  }\r\n  return XIcon.EMPTY;\r\n};\r\n\r\nexport { XIcon };\r\n","/**\r\n * XIconOffset\r\n */\r\nclass XIconOffset {\r\n\r\n  /**\r\n   * XIconOffset\r\n   * @param x\r\n   * @param y\r\n   */\r\n  constructor({ x = 0, y = 0 } = {}) {\r\n    this.x = x;\r\n    this.y = y;\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  XIconOffset,\r\n};\r\n","import { Widget } from '../../../../lib/Widget';\r\nimport { cssPrefix } from '../../../../const/Constant';\r\nimport { h } from '../../../../lib/Element';\r\n\r\nclass Icon extends Widget {\r\n\r\n  constructor(className = '') {\r\n    super(`${cssPrefix}-icon`);\r\n    this.iconNameEl = h('div', `${cssPrefix}-icon-img ${className}`);\r\n    this.childrenNodes(this.iconNameEl);\r\n  }\r\n\r\n  setWidth(width) {\r\n    this.iconNameEl.css('width', `${width}px`);\r\n  }\r\n\r\n  setHeight(height) {\r\n    this.iconNameEl.css('height', `${height}px`);\r\n  }\r\n\r\n}\r\n\r\nexport { Icon };\r\n","class Crop {\r\n\r\n  constructor({\r\n    rect, draw, offset = 0,\r\n  }) {\r\n    this.rect = rect;\r\n    this.draw = draw;\r\n    this.offset = offset;\r\n  }\r\n\r\n  open() {\r\n    const {\r\n      rect, draw, offset,\r\n    } = this;\r\n    const {\r\n      x, y, width, height,\r\n    } = rect;\r\n    draw.save()\r\n      .rect(x, y, width + offset, height + offset)\r\n      .clip()\r\n      .beginPath();\r\n    return this;\r\n  }\r\n\r\n  close() {\r\n    const { draw } = this;\r\n    draw.restore();\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nexport { Crop };\r\n","import { SheetUtils } from '../utils/SheetUtils';\r\nimport { XDraw } from './XDraw';\r\n\r\nconst LINE_TYPE = {\r\n  SOLID_LINE: 0,\r\n  DOTTED_LINE: 1,\r\n  POINT_LINE: 2,\r\n  DOUBLE_LINE: 3,\r\n};\r\n\r\nclass SolidLine {\r\n\r\n  constructor(draw, attr) {\r\n    this.draw = draw;\r\n    SheetUtils.copy(this, {\r\n      color: 'rgb(0,0,0)',\r\n      widthType: XDraw.LINE_WIDTH_TYPE.low,\r\n    }, attr);\r\n  }\r\n\r\n  setWidthType(widthType) {\r\n    this.widthType = widthType;\r\n  }\r\n\r\n  setColor(color) {\r\n    this.color = color;\r\n  }\r\n\r\n  horizonLine(sx, sy, ex, ey) {\r\n    const { draw } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash([]);\r\n    draw.horizonLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n  verticalLine(sx, sy, ex, ey) {\r\n    const { draw } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash([]);\r\n    draw.verticalLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n  tiltingLine(sx, sy, ex, ey) {\r\n    const { draw } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash([]);\r\n    draw.corsLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n}\r\n\r\nclass DottedLine {\r\n\r\n  constructor(draw, attr) {\r\n    this.draw = draw;\r\n    SheetUtils.copy(this, {\r\n      color: 'rgb(0,0,0)',\r\n      widthType: XDraw.LINE_WIDTH_TYPE.low,\r\n      dash: [5],\r\n    }, attr);\r\n  }\r\n\r\n  setWidthType(widthType) {\r\n    this.widthType = widthType;\r\n  }\r\n\r\n  setColor(color) {\r\n    this.color = color;\r\n  }\r\n\r\n  horizonLine(sx, sy, ex, ey) {\r\n    const { draw, dash } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash(dash);\r\n    draw.horizonLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n  verticalLine(sx, sy, ex, ey) {\r\n    const { draw, dash } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash(dash);\r\n    draw.verticalLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n  tiltingLine(sx, sy, ex, ey) {\r\n    const { draw, dash } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash(dash);\r\n    draw.corsLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n}\r\n\r\nclass DoubleLine {\r\n\r\n  constructor(draw, attr) {\r\n    this.draw = draw;\r\n    SheetUtils.copy(this, {\r\n      color: 'rgb(0,0,0)',\r\n      widthType: XDraw.LINE_WIDTH_TYPE.low,\r\n      padding: 1,\r\n      spacing: DoubleLine.spacing,\r\n      leftShow: () => false,\r\n      topShow: () => false,\r\n      rightShow: () => false,\r\n      bottomShow: () => false,\r\n      iFMerge: () => false,\r\n      iFMergeFirstRow: () => false,\r\n      iFMergeLastRow: () => false,\r\n      iFMergeFirstCol: () => false,\r\n      iFMergeLastCol: () => false,\r\n    }, attr);\r\n  }\r\n\r\n  setWidthType(widthType) {\r\n    this.widthType = widthType;\r\n  }\r\n\r\n  setColor(color) {\r\n    this.color = color;\r\n  }\r\n\r\n  handleExternal(sx, sy, ex, ey, row, col, pos) {\r\n    const external = {};\r\n    const { leftShow, topShow, rightShow, bottomShow } = this;\r\n    const { iFMerge, iFMergeFirstRow, iFMergeLastRow, iFMergeFirstCol, iFMergeLastCol } = this;\r\n    const { spacing } = this;\r\n    let ifMerge = null;\r\n    let firstRow = null;\r\n    let lastRow = null;\r\n    let firstCol = null;\r\n    let lastCol = null;\r\n    switch (pos) {\r\n      case 'left':\r\n        ifMerge = iFMerge(row, col - 1);\r\n        if (ifMerge) {\r\n          firstRow = iFMergeFirstRow(row, col - 1);\r\n          lastRow = iFMergeLastRow(row, col - 1);\r\n          firstCol = iFMergeFirstCol(row, col - 1);\r\n          lastCol = iFMergeLastCol(row, col - 1);\r\n        }\r\n        break;\r\n      case 'top':\r\n        ifMerge = iFMerge(row - 1, col);\r\n        if (ifMerge) {\r\n          firstRow = iFMergeFirstRow(row - 1, col);\r\n          lastRow = iFMergeLastRow(row - 1, col);\r\n          firstCol = iFMergeFirstCol(row - 1, col);\r\n          lastCol = iFMergeLastCol(row - 1, col);\r\n        }\r\n        break;\r\n      case 'right':\r\n        ifMerge = iFMerge(row, col + 1);\r\n        if (ifMerge) {\r\n          firstRow = iFMergeFirstRow(row, col + 1);\r\n          lastRow = iFMergeLastRow(row, col + 1);\r\n          firstCol = iFMergeFirstCol(row, col + 1);\r\n          lastCol = iFMergeLastCol(row, col + 1);\r\n        }\r\n        break;\r\n      case 'bottom':\r\n        ifMerge = iFMerge(row + 1, col);\r\n        if (ifMerge) {\r\n          firstRow = iFMergeFirstRow(row + 1, col);\r\n          lastRow = iFMergeLastRow(row + 1, col);\r\n          firstCol = iFMergeFirstCol(row + 1, col);\r\n          lastCol = iFMergeLastCol(row + 1, col);\r\n        }\r\n        break;\r\n      default: break;\r\n    }\r\n    if (ifMerge) {\r\n      switch (pos) {\r\n        case 'left': {\r\n          external.sx = sx - spacing;\r\n          external.ex = ex - spacing;\r\n          // 检查顶边和上底边及左上角底边及左顶边\r\n          const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\r\n          const sTop = topShow(row, col);\r\n          const sBottom = bottomShow(row - 1, col);\r\n          external.sy = sy;\r\n          if (sTop || sBottom) external.sy = sy - spacing;\r\n          if (sTopLeftCorner && firstRow) external.sy = sy + spacing;\r\n          // 检查底边和下顶边及左下角顶边和左底边\r\n          const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\r\n          const eBottom = bottomShow(row, col);\r\n          const eTop = topShow(row + 1, col);\r\n          external.ey = ey;\r\n          if (eBottom || eTop) external.ey = ey + spacing;\r\n          if (eBottomLeftCorner && lastRow) external.ey = ey - spacing;\r\n          break;\r\n        }\r\n        case 'top': {\r\n          external.sy = sy - spacing;\r\n          external.ey = ey - spacing;\r\n          // 检查左边和左右边及左上角右边及上左边\r\n          const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\r\n          const sLeft = leftShow(row, col);\r\n          const sRight = rightShow(row, col - 1);\r\n          external.sx = sx;\r\n          if (sLeft || sRight) external.sx = sx - spacing;\r\n          if (sTopLeftCorner && firstCol) external.sx = sx + spacing;\r\n          // 检查右边和右左边及右上角左边及上右边\r\n          const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\r\n          const eRight = rightShow(row, col);\r\n          const eLeft = leftShow(row, col + 1);\r\n          external.ex = ex;\r\n          if (eRight || eLeft) external.ex = ex + spacing;\r\n          if (eTopRightCorner && lastCol) external.ex = ex - spacing;\r\n          break;\r\n        }\r\n        case 'right': {\r\n          external.sx = sx + spacing;\r\n          external.ex = ex + spacing;\r\n          // 检查顶边和上底边及右上角底边及右顶边\r\n          const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\r\n          const sTop = topShow(row, col);\r\n          const sBottom = bottomShow(row - 1, col);\r\n          external.sy = sy;\r\n          if (sTop || sBottom) external.sy = sy - spacing;\r\n          if (sTopRightCorner && firstRow) external.sy = sy + spacing;\r\n          // 检查底边和下顶边及右下角顶边及右底边\r\n          const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\r\n          const eBottom = bottomShow(row, col);\r\n          const eTop = topShow(row + 1, col);\r\n          external.ey = ey;\r\n          if (eBottom || eTop) external.ey = ey + spacing;\r\n          if (eBottomRightCorner && lastRow) external.ey = ey - spacing;\r\n          break;\r\n        }\r\n        case 'bottom': {\r\n          external.sy = sy + spacing;\r\n          external.ey = ey + spacing;\r\n          // 检查左边和左右边及左下角右边及下左边\r\n          const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\r\n          const sLeft = leftShow(row, col);\r\n          const sRight = rightShow(row, col - 1);\r\n          external.sx = sx;\r\n          if (sLeft || sRight) external.sx = sx - spacing;\r\n          if (sBottomLeftCorner && firstCol) external.sx = sx + spacing;\r\n          // 检查右边和右左边及右下角左边及下右边\r\n          const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\r\n          const eRight = rightShow(row, col);\r\n          const eLeft = leftShow(row, col + 1);\r\n          external.ex = ex;\r\n          if (eRight || eLeft) external.ex = ex + spacing;\r\n          if (eBottomRightCorner && lastCol) external.ex = ex - spacing;\r\n          break;\r\n        }\r\n        default: break;\r\n      }\r\n      return external;\r\n    }\r\n    switch (pos) {\r\n      case 'left': {\r\n        external.sx = sx - spacing;\r\n        external.ex = ex - spacing;\r\n        // 检查顶边和上底边及左上角底边及左顶边\r\n        const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\r\n        const sTop = topShow(row, col);\r\n        const sBottom = bottomShow(row - 1, col);\r\n        external.sy = sy;\r\n        if (sTop || sBottom) external.sy = sy - spacing;\r\n        if (sTopLeftCorner) external.sy = sy + spacing;\r\n        // 检查底边和下顶边及左下角顶边和左底边\r\n        const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\r\n        const eBottom = bottomShow(row, col);\r\n        const eTop = topShow(row + 1, col);\r\n        external.ey = ey;\r\n        if (eBottom || eTop) external.ey = ey + spacing;\r\n        if (eBottomLeftCorner) external.ey = ey - spacing;\r\n        break;\r\n      }\r\n      case 'top': {\r\n        external.sy = sy - spacing;\r\n        external.ey = ey - spacing;\r\n        // 检查左边和左右边及左上角右边及上左边\r\n        const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\r\n        const sLeft = leftShow(row, col);\r\n        const sRight = rightShow(row, col - 1);\r\n        external.sx = sx;\r\n        if (sLeft || sRight) external.sx = sx - spacing;\r\n        if (sTopLeftCorner) external.sx = sx + spacing;\r\n        // 检查右边和右左边及右上角左边及上右边\r\n        const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\r\n        const eRight = rightShow(row, col);\r\n        const eLeft = leftShow(row, col + 1);\r\n        external.ex = ex;\r\n        if (eRight || eLeft) external.ex = ex + spacing;\r\n        if (eTopRightCorner) external.ex = ex - spacing;\r\n        break;\r\n      }\r\n      case 'right': {\r\n        external.sx = sx + spacing;\r\n        external.ex = ex + spacing;\r\n        // 检查顶边和上底边及右上角底边及右顶边\r\n        const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\r\n        const sTop = topShow(row, col);\r\n        const sBottom = bottomShow(row - 1, col);\r\n        external.sy = sy;\r\n        if (sTop || sBottom) external.sy = sy - spacing;\r\n        if (sTopRightCorner) external.sy = sy + spacing;\r\n        // 检查底边和下顶边及右下角顶边及右底边\r\n        const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\r\n        const eBottom = bottomShow(row, col);\r\n        const eTop = topShow(row + 1, col);\r\n        external.ey = ey;\r\n        if (eBottom || eTop) external.ey = ey + spacing;\r\n        if (eBottomRightCorner) external.ey = ey - spacing;\r\n        break;\r\n      }\r\n      case 'bottom': {\r\n        external.sy = sy + spacing;\r\n        external.ey = ey + spacing;\r\n        // 检查左边和左右边及左下角右边及下左边\r\n        const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\r\n        const sLeft = leftShow(row, col);\r\n        const sRight = rightShow(row, col - 1);\r\n        external.sx = sx;\r\n        if (sLeft || sRight) external.sx = sx - spacing;\r\n        if (sBottomLeftCorner) external.sx = sx + spacing;\r\n        // 检查右边和右左边及右下角左边及下右边\r\n        const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\r\n        const eRight = rightShow(row, col);\r\n        const eLeft = leftShow(row, col + 1);\r\n        external.ex = ex;\r\n        if (eRight || eLeft) external.ex = ex + spacing;\r\n        if (eBottomRightCorner) external.ex = ex - spacing;\r\n        break;\r\n      }\r\n      default: break;\r\n    }\r\n    return external;\r\n  }\r\n\r\n  handleInternal(sx, sy, ex, ey, row, col, pos) {\r\n    const internal = {};\r\n    const { leftShow, topShow, rightShow, bottomShow } = this;\r\n    const { iFMerge, iFMergeFirstRow, iFMergeLastRow, iFMergeFirstCol, iFMergeLastCol } = this;\r\n    const { spacing } = this;\r\n    const ifMerge = iFMerge(row, col);\r\n    // merge\r\n    if (ifMerge) {\r\n      const firstRow = iFMergeFirstRow(row, col);\r\n      const lastRow = iFMergeLastRow(row, col);\r\n      const firstCol = iFMergeFirstCol(row, col);\r\n      const lastCol = iFMergeLastCol(row, col);\r\n      switch (pos) {\r\n        case 'left': {\r\n          internal.sx = sx + spacing;\r\n          internal.ex = ex + spacing;\r\n          // 检查顶边和上底边及左上角底边及左顶边\r\n          const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\r\n          const sTop = topShow(row, col);\r\n          const sBottom = bottomShow(row - 1, col);\r\n          internal.sy = sy;\r\n          if (sTopLeftCorner) internal.sy = sy - spacing;\r\n          if ((sTop || sBottom) && firstRow) internal.sy = sy + spacing;\r\n          // 检查底边和下顶边及左下角顶边和左底边\r\n          const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\r\n          const eBottom = bottomShow(row, col);\r\n          const eTop = topShow(row + 1, col);\r\n          internal.ey = ey;\r\n          if (eBottomLeftCorner) internal.ey = ey + spacing;\r\n          if ((eBottom || eTop) && lastRow) internal.ey = ey - spacing;\r\n          break;\r\n        }\r\n        case 'top': {\r\n          internal.sy = sy + spacing;\r\n          internal.ey = ey + spacing;\r\n          // 检查左边和左右边及左上角右边及上左边\r\n          const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\r\n          const sLeft = leftShow(row, col);\r\n          const sRight = rightShow(row, col - 1);\r\n          internal.sx = sx;\r\n          if (sTopLeftCorner) internal.sx = sx - spacing;\r\n          if ((sLeft || sRight) && firstCol) internal.sx = sx + spacing;\r\n          // 检查右边和右左边及右上角左边及上右边\r\n          const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\r\n          const eRight = rightShow(row, col);\r\n          const eLeft = leftShow(row, col + 1);\r\n          internal.ex = ex;\r\n          if (eTopRightCorner) internal.ex = ex + spacing;\r\n          if ((eRight || eLeft) && lastCol) internal.ex = ex - spacing;\r\n          break;\r\n        }\r\n        case 'right': {\r\n          internal.sx = sx - spacing;\r\n          internal.ex = ex - spacing;\r\n          // 检查顶边和上底边及右上角底边及右上边\r\n          const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\r\n          const sTop = topShow(row, col);\r\n          const sBottom = bottomShow(row - 1, col);\r\n          internal.sy = sy;\r\n          if (sTopRightCorner) internal.sy = sy - spacing;\r\n          if ((sTop || sBottom) && firstRow) internal.sy = sy + spacing;\r\n          // 检查底边和下顶边右下角顶边及右下边\r\n          const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\r\n          const eBottom = bottomShow(row, col);\r\n          const eTop = topShow(row + 1, col);\r\n          internal.ey = ey;\r\n          if (eBottomRightCorner) internal.ey = ey + spacing;\r\n          if ((eBottom || eTop) && lastRow) internal.ey = ey - spacing;\r\n          break;\r\n        }\r\n        case 'bottom': {\r\n          internal.sy = sy - spacing;\r\n          internal.ey = ey - spacing;\r\n          // 检查左边和左右边及左下角右边及下左边\r\n          const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\r\n          const sLeft = leftShow(row, col);\r\n          const sRight = rightShow(row, col - 1);\r\n          internal.sx = sx;\r\n          if (sBottomLeftCorner) internal.sx = sx - spacing;\r\n          if ((sLeft || sRight) && firstCol) internal.sx = sx + spacing;\r\n          // 检查右边和右左边及右下角左边及下右边\r\n          const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\r\n          const eRight = rightShow(row, col);\r\n          const eLeft = leftShow(row, col + 1);\r\n          internal.ex = ex;\r\n          if (eBottomRightCorner) internal.ex = ex + spacing;\r\n          if ((eRight || eLeft) && lastCol) internal.ex = ex - spacing;\r\n          break;\r\n        }\r\n        default: break;\r\n      }\r\n      return internal;\r\n    }\r\n    switch (pos) {\r\n      case 'left': {\r\n        internal.sx = sx + spacing;\r\n        internal.ex = ex + spacing;\r\n        // 检查顶边和上底边及左上角底边及左顶边\r\n        const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\r\n        const sTop = topShow(row, col);\r\n        const sBottom = bottomShow(row - 1, col);\r\n        internal.sy = sy;\r\n        if (sTopLeftCorner) internal.sy = sy - spacing;\r\n        if (sTop || sBottom) internal.sy = sy + spacing;\r\n        // 检查底边和下顶边及左下角顶边和左底边\r\n        const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\r\n        const eBottom = bottomShow(row, col);\r\n        const eTop = topShow(row + 1, col);\r\n        internal.ey = ey;\r\n        if (eBottomLeftCorner) internal.ey = ey + spacing;\r\n        if (eBottom || eTop) internal.ey = ey - spacing;\r\n        break;\r\n      }\r\n      case 'top': {\r\n        internal.sy = sy + spacing;\r\n        internal.ey = ey + spacing;\r\n        // 检查左边和左右边及左上角右边及上左边\r\n        const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\r\n        const sLeft = leftShow(row, col);\r\n        const sRight = rightShow(row, col - 1);\r\n        internal.sx = sx;\r\n        if (sTopLeftCorner) internal.sx = sx - spacing;\r\n        if (sLeft || sRight) internal.sx = sx + spacing;\r\n        // 检查右边和右左边及右上角左边及上右边\r\n        const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\r\n        const eRight = rightShow(row, col);\r\n        const eLeft = leftShow(row, col + 1);\r\n        internal.ex = ex;\r\n        if (eTopRightCorner) internal.ex = ex + spacing;\r\n        if (eRight || eLeft) internal.ex = ex - spacing;\r\n        break;\r\n      }\r\n      case 'right': {\r\n        internal.sx = sx - spacing;\r\n        internal.ex = ex - spacing;\r\n        // 检查顶边和上底边及右上角底边及右上边\r\n        const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\r\n        const sTop = topShow(row, col);\r\n        const sBottom = bottomShow(row - 1, col);\r\n        internal.sy = sy;\r\n        if (sTopRightCorner) internal.sy = sy - spacing;\r\n        if (sTop || sBottom) internal.sy = sy + spacing;\r\n        // 检查底边和下顶边右下角顶边及右下边\r\n        const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\r\n        const eBottom = bottomShow(row, col);\r\n        const eTop = topShow(row + 1, col);\r\n        internal.ey = ey;\r\n        if (eBottomRightCorner) internal.ey = ey + spacing;\r\n        if (eBottom || eTop) internal.ey = ey - spacing;\r\n        break;\r\n      }\r\n      case 'bottom': {\r\n        internal.sy = sy - spacing;\r\n        internal.ey = ey - spacing;\r\n        // 检查左边和左右边及左下角右边及下左边\r\n        const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\r\n        const sLeft = leftShow(row, col);\r\n        const sRight = rightShow(row, col - 1);\r\n        internal.sx = sx;\r\n        if (sBottomLeftCorner) internal.sx = sx - spacing;\r\n        if (sLeft || sRight) internal.sx = sx + spacing;\r\n        // 检查右边和右左边及右下角左边及下右边\r\n        const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\r\n        const eRight = rightShow(row, col);\r\n        const eLeft = leftShow(row, col + 1);\r\n        internal.ex = ex;\r\n        if (eBottomRightCorner) internal.ex = ex + spacing;\r\n        if (eRight || eLeft) internal.ex = ex - spacing;\r\n        break;\r\n      }\r\n      default: break;\r\n    }\r\n    return internal;\r\n  }\r\n\r\n  horizonLine(sx, sy, ex, ey, row, col, pos) {\r\n    const { draw } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash([]);\r\n    const external = this.handleExternal(sx, sy, ex, ey, row, col, pos);\r\n    const internal = this.handleInternal(sx, sy, ex, ey, row, col, pos);\r\n    if (!SheetUtils.isEmptyObject(internal)) {\r\n      draw.horizonLine([internal.sx, internal.sy], [internal.ex, internal.ey]);\r\n    }\r\n    if (!SheetUtils.isEmptyObject(external)) {\r\n      draw.horizonLine([external.sx, external.sy], [external.ex, external.ey]);\r\n    }\r\n  }\r\n\r\n  verticalLine(sx, sy, ex, ey, row, col, pos) {\r\n    const { draw } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash([]);\r\n    const external = this.handleExternal(sx, sy, ex, ey, row, col, pos);\r\n    const internal = this.handleInternal(sx, sy, ex, ey, row, col, pos);\r\n    if (!SheetUtils.isEmptyObject(internal)) {\r\n      draw.verticalLine([internal.sx, internal.sy], [internal.ex, internal.ey]);\r\n    }\r\n    if (!SheetUtils.isEmptyObject(external)) {\r\n      draw.verticalLine([external.sx, external.sy], [external.ex, external.ey]);\r\n    }\r\n  }\r\n\r\n  // eslint-disable-next-line no-unused-vars\r\n  tiltingLine(sx, sy, ex, ey, row, col, pos) {\r\n    // TODO ..\r\n    // ...\r\n  }\r\n\r\n}\r\nDoubleLine.spacing = XDraw.dpr() >= 2 ? 3 : 2;\r\n\r\nclass Line {\r\n\r\n  constructor(draw, attr = {}) {\r\n    this.widthType = XDraw.LINE_WIDTH_TYPE.low;\r\n    this.type = LINE_TYPE.SOLID_LINE;\r\n    this.solidLine = new SolidLine(draw, SheetUtils.copy({}, attr));\r\n    this.dottedLine = new DottedLine(draw, SheetUtils.copy({\r\n      dash: [5],\r\n    }, attr));\r\n    this.pointLine = new DottedLine(draw, SheetUtils.copy({\r\n      dash: [2, 2],\r\n    }, attr));\r\n    this.doubleLine = new DoubleLine(draw, SheetUtils.copy({}, attr));\r\n  }\r\n\r\n  setWidthType(widthType) {\r\n    if (widthType) {\r\n      if (this.type === LINE_TYPE.SOLID_LINE) {\r\n        this.solidLine.setWidthType(widthType);\r\n      }\r\n    }\r\n  }\r\n\r\n  setColor(color) {\r\n    if (color) {\r\n      this.solidLine.setColor(color);\r\n      this.dottedLine.setColor(color);\r\n      this.pointLine.setColor(color);\r\n      this.doubleLine.setColor(color);\r\n    }\r\n  }\r\n\r\n  setType(type) {\r\n    this.type = type;\r\n  }\r\n\r\n  horizonLine(sx, sy, ex, ey, row, col, pos) {\r\n    const {\r\n      type,\r\n      solidLine,\r\n      dottedLine,\r\n      pointLine,\r\n      doubleLine,\r\n    } = this;\r\n    switch (type) {\r\n      case LINE_TYPE.SOLID_LINE:\r\n        solidLine.horizonLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.DOTTED_LINE:\r\n        dottedLine.horizonLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.POINT_LINE:\r\n        pointLine.horizonLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.DOUBLE_LINE:\r\n        doubleLine.horizonLine(sx, sy, ex, ey, row, col, pos);\r\n        break;\r\n    }\r\n  }\r\n\r\n  verticalLine(sx, sy, ex, ey, row, col, pos) {\r\n    const {\r\n      type,\r\n      solidLine,\r\n      dottedLine,\r\n      pointLine,\r\n      doubleLine,\r\n    } = this;\r\n    switch (type) {\r\n      case LINE_TYPE.SOLID_LINE:\r\n        solidLine.verticalLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.DOTTED_LINE:\r\n        dottedLine.verticalLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.POINT_LINE:\r\n        pointLine.verticalLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.DOUBLE_LINE:\r\n        doubleLine.verticalLine(sx, sy, ex, ey, row, col, pos);\r\n        break;\r\n    }\r\n  }\r\n\r\n  tiltingLine(sx, sy, ex, ey, row, col, pos) {\r\n    const {\r\n      type,\r\n      solidLine,\r\n      dottedLine,\r\n      pointLine,\r\n      doubleLine,\r\n    } = this;\r\n    switch (type) {\r\n      case LINE_TYPE.SOLID_LINE:\r\n        solidLine.tiltingLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.DOTTED_LINE:\r\n        dottedLine.tiltingLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.POINT_LINE:\r\n        pointLine.tiltingLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.DOUBLE_LINE:\r\n        doubleLine.tiltingLine(sx, sy, ex, ey, row, col, pos);\r\n        break;\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  Line, LINE_TYPE, SolidLine,\r\n};\r\n","class Rect {\r\n\r\n  /**\r\n   * Rect\r\n   * @param x\r\n   * @param y\r\n   * @param width\r\n   * @param height\r\n   */\r\n  constructor({\r\n    x, y, width, height,\r\n  }) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.width = width;\r\n    this.height = height;\r\n  }\r\n\r\n  /**\r\n   * 判断两个矩形是否不发生重合\r\n   * @param {Rect} other 区域\r\n   * @returns {boolean}\r\n   */\r\n  disjoint(other) {\r\n    return this.x > other.x + other.width\r\n      || this.y > this.y + other.height\r\n      || other.x > this.x + this.width\r\n      || other.y > this.y + this.height;\r\n  }\r\n\r\n  /**\r\n   * 扩展尺寸\r\n   * @param size\r\n   * @returns {Rect}\r\n   */\r\n  expandSize(size) {\r\n    this.width += size;\r\n    this.height += size;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 是否包含点\r\n   * @param x\r\n   * @param y\r\n   * @returns {boolean}\r\n   */\r\n  includePoint(x, y) {\r\n    return x >= this.x && x <= this.x + this.width\r\n      && y >= this.y && y <= this.y + this.height;\r\n  }\r\n\r\n  /**\r\n   * 是否包含矩形\r\n   * @param rect\r\n   * @returns {boolean|boolean}\r\n   */\r\n  includeRect(rect) {\r\n    const { x, y, width, height } = rect;\r\n    return this.x <= x && this.x + this.width >= x + width\r\n      && this.y <= y && this.y + this.height >= y + height;\r\n  }\r\n\r\n  /**\r\n   * 计算当前矩形在指定矩形内部的位置\r\n   * @param rect\r\n   * @returns {Rect}\r\n   */\r\n  inRectPosition(rect) {\r\n    return new Rect({\r\n      x: this.x - rect.x,\r\n      y: this.y - rect.y,\r\n      width: this.width,\r\n      height: this.height,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 复制\r\n   * @returns {Rect}\r\n   */\r\n  clone() {\r\n    const { x, y, width, height } = this;\r\n    return new Rect({ x, y, width, height });\r\n  }\r\n\r\n}\r\n\r\nexport { Rect };\r\n","/* global devicePixelRatio */\r\nimport { SheetUtils } from '../utils/SheetUtils';\r\n\r\nlet DPR = SheetUtils.inWorker() ? 1 : devicePixelRatio;\r\nlet LINE_WIDTH_LOW = Math.round(DPR);\r\nlet LINE_WIDTH_MEDIUM = LINE_WIDTH_LOW + 2;\r\nlet LINE_WIDTH_HIGH = LINE_WIDTH_MEDIUM + 2;\r\nlet LINE_PIXEL_OFFSET = LINE_WIDTH_LOW / 2;\r\n\r\nclass Base {\r\n\r\n  static srcPx(px) {\r\n    return px / this.dpr();\r\n  }\r\n\r\n  static cssPx(px) {\r\n    return this.srcPx(this.stylePx(px));\r\n  }\r\n\r\n  static stylePx(px) {\r\n    return this.round(px * this.dpr());\r\n  }\r\n\r\n  static round(val) {\r\n    return Math.round(val);\r\n  }\r\n\r\n  static ceil(val) {\r\n    return Math.ceil(val);\r\n  }\r\n\r\n  static trunc(val) {\r\n    return Math.trunc(val);\r\n  }\r\n\r\n  static radian(angle) {\r\n    return -angle * (Math.PI / 180);\r\n  }\r\n\r\n  static dpr() {\r\n    return DPR;\r\n  }\r\n\r\n  static refresh(val = 1) {\r\n    DPR = SheetUtils.inWorker() ? val : devicePixelRatio;\r\n    LINE_WIDTH_LOW = Math.round(DPR);\r\n    LINE_WIDTH_MEDIUM = LINE_WIDTH_LOW + 2;\r\n    LINE_WIDTH_HIGH = LINE_WIDTH_MEDIUM + 2;\r\n    LINE_PIXEL_OFFSET = LINE_WIDTH_LOW / 2;\r\n  }\r\n\r\n  constructor(canvas) {\r\n    this.canvas = canvas;\r\n    this.ctx = canvas.getContext('2d');\r\n  }\r\n\r\n  attr(options) {\r\n    for (const key in options) {\r\n      if (options.hasOwnProperty(key)) {\r\n        let value = options[key];\r\n        if (typeof value === 'string' || value instanceof String) {\r\n          value = value.trim();\r\n        }\r\n        if (this.ctx[key] !== value) {\r\n          this.ctx[key] = value;\r\n        }\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  resize(width, height) {\r\n    const { canvas } = this;\r\n    canvas.width = Base.stylePx(width);\r\n    canvas.height = Base.stylePx(height);\r\n    canvas.style.width = `${canvas.width / Base.dpr()}px`;\r\n    canvas.style.height = `${canvas.height / Base.dpr()}px`;\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nclass Wrapping extends Base {\r\n\r\n  constructor(canvas) {\r\n    super(canvas);\r\n    this.dash = [];\r\n  }\r\n\r\n  beginPath() {\r\n    const { ctx } = this;\r\n    ctx.beginPath();\r\n    return this;\r\n  }\r\n\r\n  measureText(text) {\r\n    const { ctx } = this;\r\n    return ctx.measureText(text);\r\n  }\r\n\r\n  save() {\r\n    const { ctx } = this;\r\n    ctx.save();\r\n    return this;\r\n  }\r\n\r\n  restore() {\r\n    const { ctx } = this;\r\n    ctx.restore();\r\n    return this;\r\n  }\r\n\r\n  fill() {\r\n    const { ctx } = this;\r\n    ctx.fill();\r\n    return this;\r\n  }\r\n\r\n  clip() {\r\n    const { ctx } = this;\r\n    ctx.clip();\r\n    return this;\r\n  }\r\n\r\n  setLineDash(dash = []) {\r\n    const { ctx } = this;\r\n    this.dash = dash;\r\n    ctx.setLineDash(dash);\r\n    return this;\r\n  }\r\n\r\n  scale(x, y) {\r\n    const { ctx } = this;\r\n    ctx.scale(x, y);\r\n    return this;\r\n  }\r\n\r\n  translate(x, y) {\r\n    const { ctx } = this;\r\n    ctx.translate(x, y);\r\n    return this;\r\n  }\r\n\r\n  rotate(deg) {\r\n    const { ctx } = this;\r\n    ctx.rotate(deg);\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nclass Extends extends Wrapping {\r\n\r\n  polyStroke(interpolation = (xys) => xys, ...xys) {\r\n    const { ctx } = this;\r\n    if (xys.length > 1) {\r\n      this.beginPath();\r\n      const [x, y] = interpolation(xys[0]);\r\n      ctx.moveTo(x, y);\r\n      for (let i = 1, len = xys.length; i < len; i += 1) {\r\n        const [x, y] = interpolation(xys[i]);\r\n        ctx.lineTo(x, y);\r\n      }\r\n      ctx.stroke();\r\n    }\r\n  }\r\n\r\n  polyInFill(interpolation = (xys) => xys, ...xys) {\r\n    const { ctx } = this;\r\n    if (xys.length > 1) {\r\n      this.beginPath();\r\n      const [x, y] = interpolation(xys[0]);\r\n      ctx.moveTo(x, y);\r\n      for (let i = 1, len = xys.length; i < len; i += 1) {\r\n        const [x, y] = interpolation(xys[i]);\r\n        ctx.lineTo(x, y);\r\n      }\r\n      ctx.fill();\r\n    }\r\n  }\r\n\r\n  fullRect() {\r\n    const { canvas } = this;\r\n    const { width, height } = canvas;\r\n    this.ctx.fillRect(0, 0, width, height);\r\n    return this;\r\n  }\r\n\r\n  rotate(angle) {\r\n    super.rotate(Base.radian(angle));\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nclass Position extends Extends {\r\n\r\n  constructor(canvas) {\r\n    super(canvas);\r\n    this.offsetX = 0;\r\n    this.offsetY = 0;\r\n  }\r\n\r\n  offset(x, y) {\r\n    this.offsetX = x;\r\n    this.offsetY = y;\r\n  }\r\n\r\n  getOffsetX() {\r\n    return this.offsetX;\r\n  }\r\n\r\n  getOffsetY() {\r\n    return this.offsetY;\r\n  }\r\n\r\n  fillText() {\r\n    throw TypeError('child impl');\r\n  }\r\n\r\n  fillRect() {\r\n    throw TypeError('child impl');\r\n  }\r\n\r\n  rect() {\r\n    throw TypeError('child impl');\r\n  }\r\n\r\n  drawImage() {\r\n    throw TypeError('child impl');\r\n  }\r\n\r\n}\r\n\r\nclass BaseLine extends Position {\r\n\r\n  line(...xys) {\r\n    this.polyStroke((xys) => {\r\n      const [x, y] = xys;\r\n      return [this.linePx(Base.round(x + this.getOffsetX())),\r\n        this.linePx(Base.round(y + this.getOffsetY()))];\r\n    }, ...xys);\r\n    return this;\r\n  }\r\n\r\n  linePx(pixel) {\r\n    const { ctx } = this;\r\n    const {\r\n      lineWidth,\r\n    } = ctx;\r\n    return lineWidth % 2 === 0\r\n      ? pixel : pixel - 0.5;\r\n  }\r\n\r\n}\r\n\r\nclass CorsLine extends BaseLine {\r\n\r\n  static offsetToLineInside(val) {\r\n    return LINE_WIDTH_LOW > 1\r\n      ? val - LINE_PIXEL_OFFSET\r\n      : val - LINE_WIDTH_LOW;\r\n  }\r\n\r\n  static getLineWidthTypePx(type) {\r\n    switch (type) {\r\n      case CorsLine.LINE_WIDTH_TYPE.medium:\r\n        return LINE_WIDTH_MEDIUM;\r\n      case CorsLine.LINE_WIDTH_TYPE.low:\r\n        return LINE_WIDTH_LOW;\r\n      case CorsLine.LINE_WIDTH_TYPE.high:\r\n        return LINE_WIDTH_HIGH;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  constructor(canvas) {\r\n    super(canvas);\r\n    this.lineWidthType = CorsLine.LINE_WIDTH_TYPE.low;\r\n    this.lineColor = 'rgb(0,0,0)';\r\n  }\r\n\r\n  corsLine([sx, sy], [ex, ey]) {\r\n    const {\r\n      lineWidthType, lineColor,\r\n    } = this;\r\n    let lineWidth = LINE_WIDTH_LOW;\r\n    switch (lineWidthType) {\r\n      case CorsLine.LINE_WIDTH_TYPE.medium:\r\n        lineWidth = LINE_WIDTH_MEDIUM;\r\n        break;\r\n      case CorsLine.LINE_WIDTH_TYPE.low:\r\n        lineWidth = LINE_WIDTH_LOW;\r\n        break;\r\n      case CorsLine.LINE_WIDTH_TYPE.high:\r\n        lineWidth = LINE_WIDTH_HIGH;\r\n        break;\r\n    }\r\n    this.attr({\r\n      strokeStyle: lineColor,\r\n      lineWidth,\r\n    });\r\n    this.polyStroke((xys) => {\r\n      const [x, y] = xys;\r\n      return [\r\n        Base.round(x + this.getOffsetX()) - LINE_PIXEL_OFFSET,\r\n        Base.round(y + this.getOffsetY()) - LINE_PIXEL_OFFSET,\r\n      ];\r\n    }, [sx, sy], [ex, ey]);\r\n  }\r\n\r\n  setLineColor(color) {\r\n    this.lineColor = color;\r\n  }\r\n\r\n  setLineWidthType(type) {\r\n    this.lineWidthType = type;\r\n  }\r\n\r\n  horizonLine([sx, sy], [ex, ey]) {\r\n    if (sy !== ey) {\r\n      throw new TypeError('Error Horizon Line');\r\n    }\r\n    this.corsLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n  verticalLine([sx, sy], [ex, ey]) {\r\n    if (sx !== ex) {\r\n      throw new TypeError('Error Vertical Line');\r\n    }\r\n    this.corsLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n}\r\nCorsLine.LINE_WIDTH_TYPE = {\r\n  low: 'low',\r\n  medium: 'medium',\r\n  high: 'high',\r\n};\r\n\r\nclass XDraw extends CorsLine {\r\n\r\n  fillText(text, x, y) {\r\n    x += this.getOffsetX();\r\n    y += this.getOffsetY();\r\n    this.ctx.fillText(text, XDraw.round(x), XDraw.round(y));\r\n    return this;\r\n  }\r\n\r\n  fillPath(path) {\r\n    this.polyInFill((xys) => {\r\n      const { x, y } = xys;\r\n      return [Base.round(x + this.getOffsetX()), Base.round(y + this.getOffsetY())];\r\n    }, ...path.points);\r\n    return this;\r\n  }\r\n\r\n  fillRect(x, y, w, h) {\r\n    x += this.getOffsetX();\r\n    y += this.getOffsetY();\r\n    this.ctx.fillRect(\r\n      XDraw.round(x),\r\n      XDraw.round(y),\r\n      XDraw.round(w),\r\n      XDraw.round(h),\r\n    );\r\n    return this;\r\n  }\r\n\r\n  rect(x, y, w, h) {\r\n    x += this.getOffsetX();\r\n    y += this.getOffsetY();\r\n    this.ctx.rect(\r\n      XDraw.round(x),\r\n      XDraw.round(y),\r\n      XDraw.round(w),\r\n      XDraw.round(h),\r\n    );\r\n    return this;\r\n  }\r\n\r\n  copyImage(sx, sy, sw, sh, tx, ty, tw, th) {\r\n    const { ctx } = this;\r\n    tx += this.getOffsetX();\r\n    sx += this.getOffsetX();\r\n    ty += this.getOffsetY();\r\n    sy += this.getOffsetY();\r\n    ctx.drawImage(\r\n      this.canvas,\r\n      XDraw.round(sx),\r\n      XDraw.round(sy),\r\n      XDraw.round(sw),\r\n      XDraw.round(sh),\r\n      XDraw.round(tx),\r\n      XDraw.round(ty),\r\n      XDraw.round(tw),\r\n      XDraw.round(th),\r\n    );\r\n    return this;\r\n  }\r\n\r\n  drawImage(el, sx, sy, sw, sh, tx, ty, tw, th) {\r\n    const { ctx } = this;\r\n    tx += this.getOffsetX();\r\n    ty += this.getOffsetY();\r\n    ctx.drawImage(\r\n      el,\r\n      XDraw.round(sx),\r\n      XDraw.round(sy),\r\n      XDraw.round(sw),\r\n      XDraw.round(sh),\r\n      XDraw.round(tx),\r\n      XDraw.round(ty),\r\n      XDraw.round(tw),\r\n      XDraw.round(th),\r\n    );\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  XDraw,\r\n};\r\n","class BaseFont {\r\n\r\n  constructor({\r\n    draw, ruler, attr,\r\n  }) {\r\n    this.draw = draw;\r\n    this.attr = attr;\r\n    this.ruler = ruler;\r\n  }\r\n\r\n  setRuler(ruler) {\r\n    this.ruler = ruler;\r\n  }\r\n\r\n  getAlignPadding() {\r\n    if (this.attr.align === BaseFont.ALIGN.center) {\r\n      return 0;\r\n    }\r\n    return this.attr.padding;\r\n  }\r\n\r\n  getVerticalAlignPadding() {\r\n    if (this.attr.verticalAlign === BaseFont.VERTICAL_ALIGN.center) {\r\n      return 0;\r\n    }\r\n    return this.attr.padding;\r\n  }\r\n\r\n}\r\n\r\nBaseFont.VERTICAL_ALIGN = {\r\n  top: 'top',\r\n  center: 'middle',\r\n  bottom: 'bottom',\r\n};\r\nBaseFont.ALIGN = {\r\n  left: 'left',\r\n  center: 'center',\r\n  right: 'right',\r\n};\r\nBaseFont.TEXT_WRAP = {\r\n  OVER_FLOW: 1,\r\n  WORD_WRAP: 2,\r\n  TRUNCATE: 3,\r\n};\r\nBaseFont.TEXT_DIRECTION = {\r\n  HORIZONTAL: 'horizontal',\r\n  VERTICAL: 'vertical',\r\n  ANGLE: 'angle',\r\n  ANGLE_BAR: 'bar',\r\n};\r\nBaseFont.DEFAULT_FONT_ATTR = {\r\n  name: 'Arial',\r\n  size: 14,\r\n  color: 'rgb(0,0,0)',\r\n  bold: false,\r\n  italic: false,\r\n  strikethrough: false,\r\n  underline: false,\r\n  angle: 0,\r\n  padding: 8,\r\n  align: BaseFont.ALIGN.left,\r\n  textWrap: BaseFont.TEXT_WRAP.TRUNCATE,\r\n  verticalAlign: BaseFont.VERTICAL_ALIGN.center,\r\n  direction: BaseFont.TEXT_DIRECTION.HORIZONTAL,\r\n};\r\nBaseFont.DEFAULT_RICH_ATTR = {\r\n  angle: 0,\r\n  padding: 8,\r\n  align: BaseFont.ALIGN.left,\r\n  textWrap: BaseFont.TEXT_WRAP.TRUNCATE,\r\n  verticalAlign: BaseFont.VERTICAL_ALIGN.center,\r\n  direction: BaseFont.TEXT_DIRECTION.HORIZONTAL,\r\n};\r\nBaseFont.DEFAULT_RICH_ITEM_ATTR = {\r\n  name: 'Arial',\r\n  size: 14,\r\n  color: 'rgb(0,0,0)',\r\n  bold: false,\r\n  italic: false,\r\n  strikethrough: false,\r\n  underline: false,\r\n};\r\n\r\nexport {\r\n  BaseFont,\r\n};\r\n","/**\r\n * 运行函数注册\r\n * @type {{}}\r\n */\r\nclass EvalFunctions {\r\n\r\n  /**\r\n   * EvalFunctions\r\n   */\r\n  constructor() {\r\n    this.functions = {};\r\n  }\r\n\r\n  /**\r\n   * 删除函数\r\n   * @param name\r\n   */\r\n  remove(name) {\r\n    delete this.functions[name];\r\n  }\r\n\r\n  /**\r\n   * 获取函数\r\n   * @param name\r\n   * @returns {*}\r\n   */\r\n  getFunction(name) {\r\n    return this.functions[name.toLocaleString()];\r\n  }\r\n\r\n  /**\r\n   * 注册函数\r\n   * @param name\r\n   * @param func\r\n   */\r\n  register(name, func) {\r\n    this.functions[name.toLocaleString()] = func;\r\n  }\r\n}\r\n\r\n/**\r\n * 函数注册\r\n * @type {EvalFunctions}\r\n */\r\nconst Functions = new EvalFunctions();\r\n\r\n/**\r\n * 指令序列\r\n */\r\nclass Assembly {\r\n\r\n  /**\r\n   * Assembly\r\n   */\r\n  constructor() {\r\n    this.assembly = '';\r\n  }\r\n\r\n  /**\r\n   * 获取指令详情\r\n   * @returns {string}\r\n   */\r\n  getInstruct() {\r\n    let { assembly } = this;\r\n    let flag = '\\r\\n';\r\n    while (assembly.endsWith(flag)) {\r\n      let { length } = assembly;\r\n      assembly = assembly.substring(0, length - flag.length);\r\n    }\r\n    return assembly;\r\n  }\r\n\r\n  /**\r\n   * 写入操作数\r\n   * @param value\r\n   */\r\n  writeOperand(value) {\r\n    this.assembly += `OPush ${value}\\r\\n`;\r\n  }\r\n\r\n  /**\r\n   * 写入运算符\r\n   * @param op\r\n   */\r\n  writeOperator(op) {\r\n    this.assembly += `${op}\\r\\n`;\r\n  }\r\n\r\n  /**\r\n   * 写入操作数\r\n   * @param value\r\n   */\r\n  writeString(value) {\r\n    this.assembly += `SPush ${value}\\r\\n`;\r\n  }\r\n\r\n  /**\r\n   * 写入操作数\r\n   * @param value\r\n   */\r\n  writeNumber(value) {\r\n    this.assembly += `NPush ${value}\\r\\n`;\r\n  }\r\n}\r\n\r\n/**\r\n * 词法分析\r\n */\r\nclass Tokenizer {\r\n\r\n  /**\r\n   * Tokenizer\r\n   * @param syntaxCheck\r\n   */\r\n  constructor({\r\n    syntaxCheck = true,\r\n  } = {}) {\r\n    this.syntaxCheck = syntaxCheck;\r\n  }\r\n\r\n  /**\r\n   * 词法分析\r\n   * @param input\r\n   * @returns {*[]}\r\n   */\r\n  lexical(input) {\r\n    let OPERATOR = /^(\\+|-|\\*|\\/|%|>|<|,|\\^|=|&|!|:|>=|<=|<>)$/;\r\n    let NUMBERS = /[0-9.]/;\r\n    let SPACE = /\\s/;\r\n    let LETTERS = /[a-z0-9_$]/i;\r\n    // 文本字符长度\r\n    let { length } = input;\r\n    // 函数调用记录\r\n    let bracketsStack = [];\r\n    // 当前的字符索引\r\n    let current = 0;\r\n    // 处理的字符数组\r\n    let tokens = [];\r\n    // 循环处理所有字符\r\n    while (current < length) {\r\n      // 当前处理的字符\r\n      let char = input[current];\r\n      // 跳过连续空格\r\n      if (SPACE.test(char)) {\r\n        const next = input[current + 1];\r\n        if (SPACE.test(next)) {\r\n          current++;\r\n          continue;\r\n        }\r\n      }\r\n      // 记录交叉区域运算符\r\n      if (SPACE.test(char)) {\r\n        const last = input[current - 1];\r\n        const next = input[current + 1];\r\n        if (LETTERS.test(last) && LETTERS.test(next)) {\r\n          tokens.push({\r\n            type: 'operator',\r\n            value: char,\r\n          });\r\n        }\r\n        current++;\r\n        continue;\r\n      }\r\n      // 记录括号\r\n      if (char === '(') {\r\n        tokens.push({\r\n          type: 'brackets',\r\n          value: '(',\r\n        });\r\n        bracketsStack.push({\r\n          type: 'brackets',\r\n          value: '(',\r\n        });\r\n        current++;\r\n        continue;\r\n      }\r\n      if (char === ')') {\r\n        const brackets = bracketsStack.pop();\r\n        if (brackets && brackets.type === 'function') {\r\n          tokens.push({\r\n            type: 'function',\r\n            value: ')',\r\n          });\r\n        } else {\r\n          tokens.push({\r\n            type: 'brackets',\r\n            value: ')',\r\n          });\r\n        }\r\n        current++;\r\n        continue;\r\n      }\r\n      // 记录数组\r\n      if (char === '{') {\r\n        tokens.push({\r\n          type: 'array',\r\n          value: 'array',\r\n        });\r\n        tokens.push({\r\n          type: 'array',\r\n          value: '{',\r\n        });\r\n        current++;\r\n        continue;\r\n      }\r\n      if (char === '}') {\r\n        tokens.push({\r\n          type: 'array',\r\n          value: '}',\r\n        });\r\n        current++;\r\n        continue;\r\n      }\r\n      // 记录字符串\r\n      if (char === '\"') {\r\n        let result = '';\r\n        current++;\r\n        char = input[current];\r\n        while (char !== '\"') {\r\n          if (current < length) {\r\n            result += char;\r\n            current++;\r\n            char = input[current];\r\n          } else {\r\n            break;\r\n          }\r\n        }\r\n        current++;\r\n        char = input[current];\r\n        tokens.push({\r\n          type: 'string',\r\n          value: result,\r\n        });\r\n        continue;\r\n      }\r\n      if (char === '\\'') {\r\n        let result = '';\r\n        current++;\r\n        char = input[current];\r\n        while (char !== '\\'') {\r\n          if (current < length) {\r\n            result += char;\r\n            current++;\r\n            char = input[current];\r\n          } else {\r\n            break;\r\n          }\r\n        }\r\n        current++;\r\n        char = input[current];\r\n        tokens.push({\r\n          type: 'string',\r\n          value: result,\r\n        });\r\n        continue;\r\n      }\r\n      // 记录运算符\r\n      if (OPERATOR.test(char)) {\r\n        let next = input[current + 1];\r\n        let result = `${char}${next}`;\r\n        if (OPERATOR.test(result)) {\r\n          tokens.push({\r\n            type: 'operator',\r\n            value: result,\r\n          });\r\n          current++;\r\n        } else {\r\n          tokens.push({\r\n            type: 'operator',\r\n            value: char,\r\n          });\r\n        }\r\n        current++;\r\n        continue;\r\n      }\r\n      // 记录数字值\r\n      if (NUMBERS.test(char)) {\r\n        let result = '';\r\n        while (NUMBERS.test(char)) {\r\n          if (current < length) {\r\n            result += char;\r\n            current++;\r\n            char = input[current];\r\n          } else {\r\n            break;\r\n          }\r\n        }\r\n        tokens.push({\r\n          type: 'number',\r\n          value: result,\r\n        });\r\n        continue;\r\n      }\r\n      // 记录函数名称, 参数名称, 操作数名称\r\n      if (LETTERS.test(char)) {\r\n        let result = '';\r\n        while (LETTERS.test(char)) {\r\n          if (current < length) {\r\n            result += char;\r\n            current++;\r\n            char = input[current];\r\n          } else {\r\n            break;\r\n          }\r\n        }\r\n        // 是否为函数名称\r\n        if (char === '(') {\r\n          tokens.push({\r\n            type: 'function',\r\n            value: result,\r\n          });\r\n          tokens.push({\r\n            type: 'function',\r\n            value: '(',\r\n          });\r\n          bracketsStack.push({\r\n            type: 'function',\r\n            value: '(',\r\n          });\r\n          current++;\r\n        } else {\r\n          tokens.push({\r\n            type: 'operand',\r\n            value: result,\r\n          });\r\n        }\r\n        continue;\r\n      }\r\n      // 无法识别的token\r\n      throw new TypeError(`无法识别的token ${char} `);\r\n    }\r\n    // 返回处理结果\r\n    if (this.syntaxCheck) {\r\n      return this.syntax(tokens);\r\n    }\r\n    return tokens;\r\n  }\r\n\r\n  /**\r\n   * 语法分析\r\n   * @param tokens\r\n   */\r\n  syntax(tokens) {\r\n    // 单引号对校验\r\n    let sQuotesStack = [];\r\n    // 双引号对校验\r\n    let dQuotesStack = [];\r\n    // 函数闭合标签校验\r\n    let callStack = [];\r\n    // 数组闭合标签校验\r\n    let arrayStack = [];\r\n    // 括号闭合标签校验\r\n    let bracketsStack = [];\r\n    // 当前的字符索引\r\n    let current = 0;\r\n    // tokens长度\r\n    let { length } = tokens;\r\n    // 忽略的数组token\r\n    let ignoreArray = (token) => {\r\n      if (token.type === 'array') {\r\n        return token.value === 'array';\r\n      }\r\n      return false;\r\n    };\r\n    // 忽略的函数token\r\n    let ignoreFunc = (token) => {\r\n      if (token.type === 'function') {\r\n        return token.value !== '(' && token.value !== ')';\r\n      }\r\n      return false;\r\n    };\r\n    // 跳过忽略的元素\r\n    let skipIgnoreToken = (dir, index) => {\r\n      if (dir === 'last') {\r\n        while (index >= 0) {\r\n          let token = tokens[index];\r\n          if (ignoreFunc(token)) {\r\n            index--;\r\n            continue;\r\n          }\r\n          if (ignoreArray(token)) {\r\n            index--;\r\n            continue;\r\n          }\r\n          return token;\r\n        }\r\n      }\r\n      if (dir === 'next') {\r\n        while (index < length) {\r\n          let token = tokens[index];\r\n          if (ignoreFunc(token)) {\r\n            index++;\r\n            continue;\r\n          }\r\n          if (ignoreArray(token)) {\r\n            index++;\r\n            continue;\r\n          }\r\n          return token;\r\n        }\r\n      }\r\n      return null;\r\n    };\r\n    // 检查数组\r\n    let checkArray = (dir, target) => {\r\n      let token = tokens[current];\r\n      let local = dir === 'last' ? '前面' : '后面';\r\n      if (token.value === '{') {\r\n        if (dir === 'last') {\r\n          switch (target.type) {\r\n            case 'array': {\r\n              if (target.value === '{') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'function': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'operator': {\r\n              if (target.value === ',') {\r\n                return;\r\n              }\r\n              return;\r\n            }\r\n          }\r\n        }\r\n        if (dir === 'next') {\r\n          switch (target.type) {\r\n            case 'string':\r\n            case 'array':\r\n            case 'number':\r\n            case 'operand': {\r\n              return;\r\n            }\r\n            case 'function': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      if (token.value === '}') {\r\n        if (dir === 'last') {\r\n          switch (target.type) {\r\n            case 'number':\r\n            case 'string':\r\n            case 'array':\r\n            case 'operand': {\r\n              return;\r\n            }\r\n            case 'function': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        if (dir === 'next') {\r\n          switch (target.type) {\r\n            case 'array': {\r\n              if (target.value === '}') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'function': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'operator': {\r\n              if (target.value === ',') {\r\n                return;\r\n              }\r\n              return;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      throw TypeError(`错误表达式 ${token.value} ${local} ${target.value}`);\r\n    };\r\n    // 检查数字和字符\r\n    let checkValue = (dir, target) => {\r\n      let token = tokens[current];\r\n      let local = dir === 'last' ? '前面' : '后面';\r\n      switch (target.type) {\r\n        case 'array': {\r\n          if (dir === 'last') {\r\n            if (target.value === '{') {\r\n              return;\r\n            }\r\n          }\r\n          if (dir === 'next') {\r\n            if (target.value === '}') {\r\n              return;\r\n            }\r\n          }\r\n          break;\r\n        }\r\n        case 'brackets': {\r\n          if (dir === 'last') {\r\n            if (target.value === '(') {\r\n              return;\r\n            }\r\n          }\r\n          if (dir === 'next') {\r\n            if (target.value === ')') {\r\n              return;\r\n            }\r\n          }\r\n          break;\r\n        }\r\n        case 'function': {\r\n          if (dir === 'last') {\r\n            if (target.value === '(') {\r\n              return;\r\n            }\r\n          }\r\n          if (dir === 'next') {\r\n            if (target.value === ')') {\r\n              return;\r\n            }\r\n          }\r\n          break;\r\n        }\r\n        case 'operator': {\r\n          return;\r\n        }\r\n      }\r\n      throw TypeError(`错误表达式 ${token.value} ${local} ${target.value}`);\r\n    };\r\n    // 检查运算符\r\n    let checkOperator = (dir, target) => {\r\n      let token = tokens[current];\r\n      let local = dir === 'last' ? '前面' : '后面';\r\n      switch (target.type) {\r\n        case 'brackets':\r\n        case 'function':\r\n        case 'string':\r\n        case 'number':\r\n        case 'operand': {\r\n          return;\r\n        }\r\n        case 'array': {\r\n          if (token.value === ',') {\r\n            return;\r\n          }\r\n          break;\r\n        }\r\n      }\r\n      throw TypeError(`错误表达式 ${token.value} ${local} ${target.value}`);\r\n    };\r\n    // 检查函数\r\n    let checkFunction = (dir, target) => {\r\n      let token = tokens[current];\r\n      let local = dir === 'last' ? '前面' : '后面';\r\n      if (token.value === '(') {\r\n        if (dir === 'last') {\r\n          switch (target.type) {\r\n            case 'array': {\r\n              if (target.value === '{') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'function': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'operator': {\r\n              return;\r\n            }\r\n          }\r\n        }\r\n        if (dir === 'next') {\r\n          switch (target.type) {\r\n            case 'function':\r\n            case 'string':\r\n            case 'number':\r\n            case 'operand': {\r\n              return;\r\n            }\r\n            case 'array': {\r\n              if (target.value === '{') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      if (token.value === ')') {\r\n        if (dir === 'last') {\r\n          switch (target.type) {\r\n            case 'function':\r\n            case 'number':\r\n            case 'string':\r\n            case 'operand': {\r\n              return;\r\n            }\r\n            case 'array': {\r\n              if (target.value === '}') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        if (dir === 'next') {\r\n          switch (target.type) {\r\n            case 'array': {\r\n              if (target.value === '}') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'function': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'operator': {\r\n              if (target.value === ',') {\r\n                return;\r\n              }\r\n              return;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      throw TypeError(`错误表达式 ${token.value} ${local} ${target.value}`);\r\n    };\r\n    // 循环处理所有token\r\n    while (current < length) {\r\n      // 当前处理的token\r\n      let token = tokens[current];\r\n      // 跳过忽略token\r\n      if (ignoreArray(token)) {\r\n        current++;\r\n        continue;\r\n      }\r\n      if (ignoreFunc(token)) {\r\n        current++;\r\n        continue;\r\n      }\r\n      let { type, value } = token;\r\n      // 处理单引号\r\n      if (type === \"'\") {\r\n        if (sQuotesStack.length) {\r\n          sQuotesStack.pop();\r\n        } else {\r\n          // 双引号中嵌套单引号\r\n          if (!dQuotesStack.length) {\r\n            sQuotesStack.push(\"'\");\r\n          }\r\n        }\r\n      }\r\n      // 处理双引号\r\n      if (type === '\"') {\r\n        if (dQuotesStack.length) {\r\n          dQuotesStack.pop();\r\n        } else {\r\n          // 单引号中嵌套双引号\r\n          if (!sQuotesStack.length) {\r\n            dQuotesStack.push('\"');\r\n          }\r\n        }\r\n      }\r\n      // 处理字符\r\n      if (type === 'string') {\r\n        let last = skipIgnoreToken('last', current - 1);\r\n        let next = skipIgnoreToken('next', current + 1);\r\n        if (last) {\r\n          checkValue('last', last);\r\n        }\r\n        if (next) {\r\n          checkValue('next', next);\r\n        }\r\n      }\r\n      // 处理数字\r\n      if (type === 'number') {\r\n        let last = skipIgnoreToken('last', current - 1);\r\n        let next = skipIgnoreToken('next', current + 1);\r\n        if (last) {\r\n          checkValue('last', last);\r\n        }\r\n        if (next) {\r\n          checkValue('next', next);\r\n        }\r\n      }\r\n      // 处理数组\r\n      if (type === 'array') {\r\n        if (value === '{') {\r\n          arrayStack.push(token);\r\n        }\r\n        if (value === '}') {\r\n          if (arrayStack.length === 0) {\r\n            throw new TypeError('数组缺少闭合标签');\r\n          }\r\n          arrayStack.pop();\r\n        }\r\n        let last = skipIgnoreToken('last', current - 1);\r\n        let next = skipIgnoreToken('next', current + 1);\r\n        if (last) {\r\n          checkArray('last', last);\r\n        }\r\n        if (next) {\r\n          checkArray('next', next);\r\n        }\r\n      }\r\n      // 处理函数调用\r\n      if (type === 'function') {\r\n        if (value === '(') {\r\n          callStack.push(token);\r\n        }\r\n        if (value === ')') {\r\n          callStack.pop();\r\n        }\r\n        let last = skipIgnoreToken('last', current - 1);\r\n        let next = skipIgnoreToken('next', current + 1);\r\n        if (last) {\r\n          checkFunction('last', last);\r\n        }\r\n        if (next) {\r\n          checkFunction('next', next);\r\n        }\r\n      }\r\n      // 处理运算符号\r\n      if (type === 'operator') {\r\n        let last = skipIgnoreToken('last', current - 1);\r\n        let next = skipIgnoreToken('next', current + 1);\r\n        // 运算符需要两边都有操作数\r\n        if (last) {\r\n          checkOperator('last', last);\r\n        } else {\r\n          throw TypeError(`错误表达式: ${token.value} 错误`);\r\n        }\r\n        if (next) {\r\n          checkOperator('next', next);\r\n        } else {\r\n          throw TypeError(`错误表达式: ${token.value} 错误`);\r\n        }\r\n      }\r\n      // 处理括号\r\n      if (type === 'brackets') {\r\n        if (value === '(') {\r\n          bracketsStack.push(token);\r\n        }\r\n        if (value === ')') {\r\n          if (bracketsStack.length === 0) {\r\n            throw new TypeError('括号缺少闭合标签');\r\n          }\r\n          bracketsStack.pop();\r\n        }\r\n      }\r\n      // 处理下一个字符\r\n      current++;\r\n    }\r\n    // 闭合标签检查\r\n    if (arrayStack.length) {\r\n      throw new TypeError('数组缺少闭合标签');\r\n    }\r\n    if (callStack.length) {\r\n      throw new TypeError('函数缺少闭合标签');\r\n    }\r\n    if (sQuotesStack.length) {\r\n      throw new TypeError('单引号缺少闭合标签');\r\n    }\r\n    if (dQuotesStack.length) {\r\n      throw new TypeError('双引号缺少闭合标签');\r\n    }\r\n    if (bracketsStack.length) {\r\n      throw new TypeError('括号缺少闭合标签');\r\n    }\r\n    return tokens;\r\n  }\r\n}\r\n\r\n/**\r\n * 编译表达式\r\n */\r\nclass Compiler {\r\n\r\n  /**\r\n   * Compiler\r\n   * @param tokens\r\n   * @param writer\r\n   */\r\n  constructor({\r\n    tokens, writer,\r\n  } = {}) {\r\n    this.writer = writer;\r\n    this.tokens = tokens;\r\n    this.groupStack = [];\r\n    this.index = -1;\r\n    this.ignore = [','];\r\n    // 运算符\r\n    this.opIf = {\r\n      '>': 'ifge',\r\n      '<': 'ifgt',\r\n      '=': 'ifeq',\r\n      '>=': 'if_icmpge',\r\n      '<=': 'if_icmpgt',\r\n      '<>': 'ifne',\r\n    };\r\n    this.opAdd = {\r\n      '+': 'add',\r\n      '-': 'sub',\r\n      '&': 'link',\r\n    };\r\n    this.opMul = {\r\n      '*': 'mul',\r\n      '/': 'div',\r\n      '%': 'mod',\r\n      '^': 'power',\r\n    };\r\n    this.opCommon = {\r\n      ' ': 'common',\r\n    };\r\n    this.opRel = {\r\n      '!': 'rel',\r\n      ':': 'uni',\r\n    };\r\n    this.opNew = {\r\n      array: 'newarray',\r\n    };\r\n    this.opCell = {\r\n      function: 'invoke',\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 结束\r\n   */\r\n  eofToken() {\r\n    const { index, tokens } = this;\r\n    const { length } = tokens;\r\n    return index >= length - 1;\r\n  }\r\n\r\n  /**\r\n   * 切换下一个Token\r\n   */\r\n  nextToken() {\r\n    this.index++;\r\n    this.token = this.tokens[this.index];\r\n    return this.token;\r\n  }\r\n\r\n  /**\r\n   * 返回上一个Token\r\n   */\r\n  backToken() {\r\n    this.index--;\r\n    this.token = this.tokens[this.index];\r\n    return this.token;\r\n  }\r\n\r\n  /**\r\n   * 记录参数\r\n   */\r\n  reduceGroup() {\r\n    const { groupStack } = this;\r\n    const { length } = groupStack;\r\n    if (length > 0) {\r\n      const last = groupStack[length - 1];\r\n      const number = last.number;\r\n      last.number = number - 1;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 记录参数\r\n   */\r\n  increaseGroup() {\r\n    const { groupStack } = this;\r\n    const { length } = groupStack;\r\n    if (length > 0) {\r\n      const last = groupStack[length - 1];\r\n      const number = last.number;\r\n      last.number = number + 1;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 弹出组\r\n   */\r\n  popGroup() {\r\n    return this.groupStack.pop();\r\n  }\r\n\r\n  /**\r\n   * 添加组\r\n   */\r\n  addGroup(token) {\r\n    token.number = 0;\r\n    this.groupStack.push(token);\r\n    return token;\r\n  }\r\n\r\n  /**\r\n   * 忽略的Token\r\n   * @returns {*}\r\n   */\r\n  isSkipNextToken() {\r\n    if (!this.eofToken()) {\r\n      const { ignore } = this;\r\n      this.nextToken();\r\n      const { token } = this;\r\n      this.backToken();\r\n      const { value } = token;\r\n      return ignore.includes(value);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * 编译表达式\r\n   */\r\n  compile() {\r\n    const { writer } = this;\r\n    this.compileIfge();\r\n    while (this.isSkipNextToken()) {\r\n      this.nextToken();\r\n      this.compileIfge();\r\n    }\r\n    return writer.getInstruct();\r\n  }\r\n\r\n  /**\r\n   * 编译条件运算\r\n   */\r\n  compileIfge() {\r\n    this.compileAdd();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'operator') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      if (!this.opIf[value]) {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      let operator = this.opIf[value];\r\n      this.compileAdd();\r\n      this.reduceGroup();\r\n      this.writer.writeOperator(operator);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 编译加减运算\r\n   */\r\n  compileAdd() {\r\n    this.compileMul();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'operator') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      if (!this.opAdd[value]) {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      let operator = this.opAdd[value];\r\n      this.compileMul();\r\n      this.reduceGroup();\r\n      this.writer.writeOperator(operator);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 编译乘除运算\r\n   */\r\n  compileMul() {\r\n    this.compileCommon();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'operator') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      if (!this.opMul[value]) {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      let operator = this.opMul[value];\r\n      this.compileCommon();\r\n      this.reduceGroup();\r\n      this.writer.writeOperator(operator);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 编译公共区域运算\r\n   */\r\n  compileCommon() {\r\n    this.compileRel();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'operator') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      if (!this.opCommon[value]) {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      let operator = this.opCommon[value];\r\n      this.compileRel();\r\n      this.reduceGroup();\r\n      this.writer.writeOperator(operator);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 编译跨Sheet引用运算\r\n   */\r\n  compileRel() {\r\n    this.compileArray();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'operator') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      if (!this.opRel[value]) {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      let operator = this.opRel[value];\r\n      this.compileArray();\r\n      this.reduceGroup();\r\n      this.writer.writeOperator(operator);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 编译数组创建\r\n   */\r\n  compileArray() {\r\n    this.compileFunction();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'array') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      // 返回跳过 } 标记\r\n      if (value === '}') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      this.addGroup(token);\r\n      // 跳过当前 {  标记\r\n      this.nextToken();\r\n      // 处理数组中的子元素\r\n      this.compileIfge();\r\n      // 下一个是忽略的标记\r\n      // 则继续处理\r\n      while (this.isSkipNextToken()) {\r\n        this.nextToken();\r\n        this.compileIfge();\r\n      }\r\n      // 记录数组需要\r\n      // 操作的元素数量\r\n      this.popGroup();\r\n      const { number } = token;\r\n      const operator = this.opNew[type];\r\n      this.writer.writeOperator(`${operator} ${number}`);\r\n      // 跳过闭合标签 }\r\n      this.nextToken();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 编译函数调用\r\n   */\r\n  compileFunction() {\r\n    this.compilePushValue();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'function') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      // 返回跳过 ) 标记\r\n      if (value === ')') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      this.addGroup(token);\r\n      // 跳过当前 (  标记\r\n      this.nextToken();\r\n      // 处理函数的参数列表\r\n      this.compileIfge();\r\n      // 下一个是忽略的标记\r\n      // 则继续处理\r\n      while (this.isSkipNextToken()) {\r\n        this.nextToken();\r\n        this.compileIfge();\r\n      }\r\n      // 记录函数需要\r\n      // 操作的元素数量\r\n      this.popGroup();\r\n      const { number } = token;\r\n      const operator = this.opCell[type];\r\n      this.writer.writeOperator(`${operator} ${value} ${number}`);\r\n      // 跳过闭合标签 )\r\n      this.nextToken();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * compilePushValue\r\n   */\r\n  compilePushValue() {\r\n    if (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { writer } = this;\r\n      const { type, value } = token;\r\n      // 推送操作数\r\n      // 递增函数/数组的参数数量(有的话)\r\n      switch (type) {\r\n        case 'string': {\r\n          this.increaseGroup();\r\n          writer.writeString(`${value}`);\r\n          return;\r\n        }\r\n        case 'number': {\r\n          this.increaseGroup();\r\n          writer.writeNumber(`${value}`);\r\n          return;\r\n        }\r\n        case 'operand': {\r\n          this.increaseGroup();\r\n          writer.writeOperand(value);\r\n          return;\r\n        }\r\n      }\r\n      // 处理括号计算\r\n      switch (type) {\r\n        case 'brackets': {\r\n          if (value === '(') {\r\n            this.compileIfge();\r\n            // 下一个是忽略的标记\r\n            // 则继续处理\r\n            while (this.isSkipNextToken()) {\r\n              this.nextToken();\r\n              this.compileIfge();\r\n            }\r\n            // 跳过闭合标签 )\r\n            this.nextToken();\r\n          }\r\n          return;\r\n        }\r\n      }\r\n      // 递增函数/数组的参数数量(有的话)\r\n      switch (type) {\r\n        case 'array': {\r\n          // {} 这种清空不需要增加参数数量\r\n          if (value !== '}') {\r\n            this.increaseGroup();\r\n          }\r\n          this.backToken();\r\n          return;\r\n        }\r\n        case 'function': {\r\n          // func() 这种清空不需要增加参数数量\r\n          if (value !== ')') {\r\n            this.increaseGroup();\r\n          }\r\n          this.backToken();\r\n          return;\r\n        }\r\n      }\r\n      // 过滤掉运算符\r\n      switch (type) {\r\n        case 'operator': {\r\n          this.backToken();\r\n          return;\r\n        }\r\n      }\r\n      // 无法识别的token\r\n      throw new TypeError(`无法识别的token ${type} ${value} `);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * 运行表达式\r\n */\r\nclass Evaluation {\r\n\r\n  /**\r\n   * Evaluate\r\n   * @param instruct\r\n   */\r\n  constructor(instruct) {\r\n    this.instruct = instruct.split('\\r\\n');\r\n    this.memory = [];\r\n  }\r\n\r\n  /**\r\n   * 运行表达式\r\n   */\r\n  eval() {\r\n    const newArray = /^newarray/;\r\n    const invoke = /^invoke/;\r\n    const pushSRegexp = /^SPush/;\r\n    const pushNRegexp = /^NPush/;\r\n    const pushORegexp = /^OPush/;\r\n    const { instruct } = this;\r\n    instruct.forEach((name) => {\r\n      switch (name) {\r\n        case 'if_icmpge': {\r\n          this.ificmpge();\r\n          break;\r\n        }\r\n        case 'if_icmpgt': {\r\n          this.ificmpgt();\r\n          break;\r\n        }\r\n        case 'ifge': {\r\n          this.ifge();\r\n          break;\r\n        }\r\n        case 'ifgt': {\r\n          this.ifgt();\r\n          break;\r\n        }\r\n        case 'ifeq': {\r\n          this.ifeq();\r\n          break;\r\n        }\r\n        case 'ifne': {\r\n          this.ifne();\r\n          break;\r\n        }\r\n        case 'add': {\r\n          this.add();\r\n          break;\r\n        }\r\n        case 'sub': {\r\n          this.sub();\r\n          break;\r\n        }\r\n        case 'mul': {\r\n          this.mul();\r\n          break;\r\n        }\r\n        case 'div': {\r\n          this.div();\r\n          break;\r\n        }\r\n        case 'mod': {\r\n          this.mod();\r\n          break;\r\n        }\r\n        case 'power': {\r\n          this.power();\r\n          break;\r\n        }\r\n        case 'rel': {\r\n          this.rel();\r\n          break;\r\n        }\r\n        case 'link': {\r\n          this.link();\r\n          break;\r\n        }\r\n        case 'uni': {\r\n          this.uni();\r\n          break;\r\n        }\r\n        case 'common': {\r\n          this.common();\r\n          break;\r\n        }\r\n        default: {\r\n          if (newArray.test(name)) {\r\n            const group = name.split(' ');\r\n            const index = group[1];\r\n            this.array(index);\r\n            break;\r\n          }\r\n          if (invoke.test(name)) {\r\n            const group = name.split(' ');\r\n            const func = group[1];\r\n            const index = group[2];\r\n            this.invoke(func, index);\r\n            break;\r\n          }\r\n          if (pushSRegexp.test(name)) {\r\n            const value = name.split(' ')[1];\r\n            this.pushS(value);\r\n            break;\r\n          }\r\n          if (pushNRegexp.test(name)) {\r\n            const value = name.split(' ')[1];\r\n            this.pushN(value);\r\n            break;\r\n          }\r\n          if (pushORegexp.test(name)) {\r\n            const value = name.split(' ')[1];\r\n            this.pushO(value);\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    });\r\n    return this.memory.pop();\r\n  }\r\n\r\n  /**\r\n   * 推送操作数\r\n   * @param value\r\n   */\r\n  pushS(value) {\r\n    this.memory.push(value);\r\n  }\r\n\r\n  /**\r\n   * 推送操作数\r\n   * @param value\r\n   */\r\n  pushN(value) {\r\n    value = parseFloat(value);\r\n    this.memory.push(value);\r\n  }\r\n\r\n  /**\r\n   * 推送操作数\r\n   * @param value\r\n   */\r\n  pushO(value) {\r\n    this.memory.push(value);\r\n  }\r\n\r\n  /**\r\n   * 两个值的大于比较\r\n   */\r\n  ifge() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a > b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的小于比较\r\n   */\r\n  ifgt() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a < b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的相等比较\r\n   */\r\n  ifeq() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a === b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的不等比较\r\n   */\r\n  ifne() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a !== b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的大于等于比较\r\n   */\r\n  ificmpge() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a >= b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的小于等于比较\r\n   */\r\n  ificmpgt() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a <= b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的加法运算\r\n   */\r\n  add() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a + b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的减法运算\r\n   */\r\n  sub() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a - b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的乘法运算\r\n   */\r\n  mul() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a * b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的除法运算\r\n   */\r\n  div() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a / b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的mod运算\r\n   */\r\n  mod() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a % b);\r\n  }\r\n\r\n  /**\r\n   * 计算两个区域的并集\r\n   */\r\n  common() {\r\n    // TODO ...\r\n    // ....\r\n  }\r\n\r\n  /**\r\n   * 跨sheet引用运算\r\n   */\r\n  rel() {\r\n    // TODO ...\r\n    // ....\r\n  }\r\n\r\n  /**\r\n   * 计算两个区域连接的新区域\r\n   */\r\n  uni() {\r\n    // TODO ...\r\n    // ....\r\n  }\r\n\r\n  /**\r\n   * 字符串连接运算\r\n   */\r\n  link() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(`${a}${b}`);\r\n  }\r\n\r\n  /**\r\n   * 乘方计算\r\n   */\r\n  power() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a ** b);\r\n  }\r\n\r\n  /**\r\n   * 创建数组\r\n   * @param index\r\n   */\r\n  array(index) {\r\n    const array = [];\r\n    for (let i = 1; i <= index; i++) {\r\n      const item = this.memory.pop();\r\n      array.push(item);\r\n    }\r\n    array.reverse();\r\n    this.memory.push(array);\r\n  }\r\n\r\n  /**\r\n   * 执行函数\r\n   * @param func\r\n   * @param index\r\n   */\r\n  invoke(func, index) {\r\n    const array = [];\r\n    for (let i = 1; i <= index; i++) {\r\n      const item = this.memory.pop();\r\n      array.push(item);\r\n    }\r\n    array.reverse();\r\n    const execute = Functions.getFunction(func);\r\n    const result = execute.apply(this, array);\r\n    this.memory.push(result);\r\n  }\r\n}\r\n\r\n/**\r\n * 编译输出指令\r\n * @param input\r\n * @returns {string|*}\r\n * @constructor\r\n */\r\nconst Compile = (input) => {\r\n  if (input.startsWith('=')) {\r\n    input = input.substring(1);\r\n  }\r\n  const tokenizer = new Tokenizer();\r\n  const writer = new Assembly();\r\n  const tokens = tokenizer.lexical(input);\r\n  const compiler = new Compiler({\r\n    writer, tokens,\r\n  });\r\n  return compiler.compile();\r\n};\r\n\r\n/**\r\n * 运行指令\r\n * @param inst\r\n * @returns {*}\r\n * @constructor\r\n */\r\nconst Instruct = (inst) => {\r\n  const evaluation = new Evaluation(inst);\r\n  return evaluation.eval();\r\n};\r\n\r\n/**\r\n * 编译运行\r\n * @constructor\r\n */\r\nconst Evaluate = (input) => Instruct(Compile(input));\r\n\r\nexport {\r\n  Tokenizer,\r\n  Compiler,\r\n  Assembly,\r\n  Compile,\r\n  Evaluate,\r\n  Instruct,\r\n  Functions,\r\n};\r\n","import { Compile, Instruct } from './Compiler';\r\nimport { SheetUtils } from '../utils/SheetUtils';\r\n\r\n/**\r\n * Formula\r\n */\r\nclass Formula {\r\n\r\n  /**\r\n   * Formula\r\n   * @param expr\r\n   */\r\n  constructor({\r\n    expr = SheetUtils.EMPTY,\r\n  } = {}) {\r\n    this.expr = expr;\r\n    this.content = SheetUtils.Nul;\r\n    this.instruct = SheetUtils.Nul;\r\n  }\r\n\r\n  /**\r\n   * 计算公式\r\n   * @return {string}\r\n   */\r\n  getValue() {\r\n    let { expr } = this;\r\n    let { content } = this;\r\n    let { instruct } = this;\r\n    if (!content) {\r\n      if (!instruct) {\r\n        instruct = Compile(expr);\r\n      }\r\n      content = Instruct(instruct);\r\n    }\r\n    this.content = content;\r\n    this.instruct = instruct;\r\n    return content;\r\n  }\r\n\r\n  /**\r\n   * 有效的表达式\r\n   * @return {boolean}\r\n   */\r\n  hasExpr() {\r\n    let { expr } = this;\r\n    return !SheetUtils.isBlank(expr);\r\n  }\r\n\r\n  /**\r\n   * 获取表达式\r\n   * @return {string}\r\n   */\r\n  getExpr() {\r\n    return this.expr;\r\n  }\r\n\r\n  /**\r\n   * 设置表达式\r\n   * @param expr\r\n   */\r\n  setExpr(expr) {\r\n    this.expr = expr;\r\n    this.content = SheetUtils.Nul;\r\n    this.instruct = SheetUtils.Nul;\r\n  }\r\n\r\n  /**\r\n   * 复制\r\n   * @returns {Formula}\r\n   */\r\n  clone() {\r\n    return new Formula({\r\n      expr: this.expr,\r\n    });\r\n  }\r\n\r\n}\r\n\r\nFormula.EMPTY = new Formula();\r\n\r\nFormula.getInstance = (config) => {\r\n  if (config) {\r\n    return new Formula(config);\r\n  }\r\n  return Formula.EMPTY;\r\n};\r\n\r\nexport {\r\n  Formula,\r\n};\r\n","/* global document MouseEvent CustomEvent window NodeList HTMLCollection DocumentFragment */\nimport { SheetUtils } from '../utils/SheetUtils';\n\n/**\n * Element\n */\nclass Element {\n\n  /**\n   * 包装元素\n   */\n  static wrapElement(object) {\n    if ([\n      SheetUtils.isArray(object),\n      object instanceof HTMLCollection,\n      object instanceof NodeList,\n    ].includes(true)) {\n      let elements = [];\n      for (let i = 0; i < object.length; i++) {\n        const item = object[i];\n        if (item instanceof Element) {\n          elements.push(item);\n        } else {\n          elements.push(new Element(item));\n        }\n      }\n      return elements;\n    }\n    return new Element(object);\n  }\n\n  static createText(text) {\n    return new Element(document.createTextNode(text));\n  }\n\n  /**\n   * 驼峰转连字符\n   * @param value\n   * @returns {string|null}\n   */\n  static hyphenateRE(value) {\n    if (value) {\n      return value.replace(/([A-Z])/g, '-$1').toLowerCase();\n    }\n    return null;\n  }\n\n  /**\n   * Element\n   * @param tag\n   * @param className\n   */\n  constructor(tag, className = '') {\n    if (typeof tag === 'string') {\n      this.el = document.createElement(tag);\n      if (className) {\n        this.el.className = className;\n      }\n    } else {\n      this.el = tag;\n    }\n    this.map = {};\n  }\n\n  /**\n   * 数据绑定\n   * @param key\n   * @param value\n   * @returns {Element|*}\n   */\n  data(key, value) {\n    if (value !== undefined) {\n      this.map[key] = value;\n      return this;\n    }\n    return this.map[key];\n  }\n\n  /**\n   * 空参数时返回子元素,\n   * 有参数时插入子节点\n   * @param args\n   * @returns {*[]|Element}\n   */\n  children(...args) {\n    if (arguments.length === 0) {\n      return Element.wrapElement(this.el.children);\n    }\n    args.forEach((ele) => this.append(ele));\n    return this;\n  }\n\n  /**\n   * 空参数时返回子节点,\n   * 有参数时插入子节点\n   * @param args\n   * @returns {*[]|Element}\n   */\n  childrenNodes(...args) {\n    if (arguments.length === 0) {\n      return Element.wrapElement(this.el.childNodes);\n    }\n    args.forEach((ele) => this.append(ele));\n    return this;\n  }\n\n  /**\n   * 将目标节点添加到当前元素中\n   * @param ele\n   */\n  childrenNodesAppend(ele) {\n    if (!this.isTextNode()) {\n      ele.childrenNodes().forEach((i) => this.append(i));\n    }\n    return this;\n  }\n\n  /**\n   * 将目标节点添加到当前元素中\n   * @param ele\n   */\n  childrenNodesPrepend(ele) {\n    if (!this.isTextNode()) {\n      ele.childrenNodes().forEach((i) => this.prepend(i));\n    }\n    return this;\n  }\n\n  /**\n   * 在当前元素中插入指定节点\n   * @param ele\n   */\n  append(ele) {\n    if (!this.isTextNode()) {\n      if (ele && ele.el) {\n        this.el.append(ele.el);\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 在当前元素中插入指定节点\n   * @param ele\n   */\n  prepend(ele) {\n    if (!this.isTextNode()) {\n      if (ele && ele.el) {\n        this.el.prepend(ele.el);\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 元素定位\n   * @param value\n   * @returns {{top: *, left: *, width: *, height: *}|Element}\n   */\n  offset(value) {\n    if (value !== undefined) {\n      Object.keys(value).forEach((k) => {\n        this.css(k, `${value[k]}px`);\n      });\n      return this;\n    }\n    const { offsetTop, offsetLeft } = this.el;\n    const { offsetHeight, offsetWidth } = this.el;\n    return {\n      top: offsetTop,\n      left: offsetLeft,\n      height: offsetHeight,\n      width: offsetWidth,\n    };\n  }\n\n  /**\n   * 获取当前元素的父节点\n   * @returns {Element}\n   */\n  parent() {\n    return this.el.parentNode\n      ? new Element(this.el.parentNode) : null;\n  }\n\n  /**\n   * 添加Class名称\n   * @param name\n   * @returns {Element}\n   */\n  addClass(name) {\n    if (!this.isTextNode()) {\n      this.el.classList.add(name);\n    }\n    return this;\n  }\n\n  /**\n   * 是否具有指定Class名称\n   * @param name\n   * @returns {boolean}\n   */\n  hasClass(name) {\n    if (!this.isTextNode()) {\n      return this.el.classList.contains(name);\n    }\n    return false;\n  }\n\n  /**\n   * 是否有子元素\n   * @returns {boolean}\n   */\n  hasChildElement() {\n    return this.children().length > 0;\n  }\n\n  /**\n   * 是否有子节点\n   * @returns {boolean}\n   */\n  hasChild() {\n    return this.childrenNodes().length > 0;\n  }\n\n  /**\n   * 删除Class名称\n   * @param name\n   * @returns {Element}\n   */\n  removeClass(name) {\n    if (!this.isTextNode()) {\n      this.el.classList.remove(name);\n    }\n    return this;\n  }\n\n  /**\n   * 获取元素坐标信息\n   * getBoundingClientRect\n   * @returns {DOMRect}\n   */\n  box() {\n    if (!this.isTextNode()) {\n      return this.el.getBoundingClientRect();\n    }\n    return null;\n  }\n\n  /**\n   * 获取当前第一个子元素\n   * @returns {*}\n   */\n  first() {\n    if (!this.isTextNode()) {\n      return Element.wrapElement(this.el.firstChild);\n    }\n    return null;\n  }\n\n  /**\n   * 获取最后一个子元素\n   * @returns {*}\n   */\n  last() {\n    if (!this.isTextNode()) {\n      return Element.wrapElement(this.el.lastChild);\n    }\n    return null;\n  }\n\n  /**\n   * 获取第一个文本节点\n   */\n  firstTextNode() {\n    if (this.isTextNode()) {\n      return this;\n    }\n    let find = null;\n    let handle = (elem) => {\n      if (elem.hasChild()) {\n        elem.childrenNodes().forEach((elem) => {\n          if (find === null) {\n            handle(elem);\n          }\n        });\n      }\n      if (find === null) {\n        if (elem.isTextNode()) {\n          find = elem;\n        }\n      }\n    };\n    handle(this);\n    return find;\n  }\n\n  /**\n   * 获取最后一个文本节点\n   */\n  lastTextNode() {\n    if (this.isTextNode()) {\n      return this;\n    }\n    let find = null;\n    let handle = (elem) => {\n      if (elem.hasChild()) {\n        elem.childrenNodes().reverse().forEach((elem) => {\n          if (find === null) {\n            handle(elem);\n          }\n        });\n      }\n      if (find === null) {\n        if (elem.isTextNode()) {\n          find = elem;\n        }\n      }\n    };\n    handle(this);\n    return find;\n  }\n\n  /**\n   * 删除当前元素下的子元素\n   * @param target\n   * @returns {boolean|ActiveX.IXMLDOMNode|*}\n   */\n  remove(target = null) {\n    if (target) {\n      if (!this.isTextNode()) {\n        this.el.removeChild(target.el || target);\n      }\n    } else {\n      const parent = this.parent();\n      if (parent) {\n        this.parent().remove(this);\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 当前元素是否包含指定节点\n   * @param ele\n   * @returns {boolean|*}\n   */\n  contains(ele) {\n    if (this.isTextNode()) {\n      return false;\n    }\n    return this.el.contains(ele.el);\n  }\n\n  /**\n   * 获取当前元素的上一个元素\n   * @returns {*}\n   */\n  prev() {\n    return this.el.previousSibling\n      ? Element.wrapElement(this.el.previousSibling) : null;\n  }\n\n  /**\n   * 获取当前元素的下一个元素\n   * @returns {*}\n   */\n  next() {\n    return this.el.nextSibling\n      ? Element.wrapElement(this.el.nextSibling) : null;\n  }\n\n  /**\n   * 设置元素的激活状态\n   * @param flag\n   * @param cls\n   * @returns {Element}\n   */\n  active(flag = true, cls = 'active') {\n    if (!this.isTextNode()) {\n      if (flag) this.addClass(cls);\n      else this.removeClass(cls);\n    }\n    return this;\n  }\n\n  /**\n   * 设置元素文本\n   * @param text\n   * @returns {string|Element}\n   */\n  text(text) {\n    if (this.isTextNode()) {\n      return this.nodeValue();\n    }\n    if (text !== undefined) {\n      this.el.innerText = text;\n      return this;\n    }\n    return this.el.innerText;\n  }\n\n  /**\n   * 设置元素html内容\n   * @param html\n   * @returns {Element|*}\n   */\n  html(html) {\n    if (this.isTextNode()) {\n      return this.nodeValue();\n    }\n    if (html !== undefined) {\n      this.el.innerHTML = html;\n      return this;\n    }\n    return this.el.innerHTML;\n  }\n\n  /**\n   * 当前元素设置焦点\n   */\n  focus() {\n    if (!this.isTextNode()) {\n      this.el.focus();\n    }\n    return this;\n  }\n\n  /**\n   * 移除焦点\n   */\n  blur() {\n    if (!this.isTextNode()) {\n      this.el.blur();\n    }\n    return this;\n  }\n\n  /**\n   * 删除元素属性\n   * @param key\n   * @returns {Element}\n   */\n  removeAttr(key) {\n    if (!this.isTextNode()) {\n      this.el.removeAttribute(key);\n    }\n    return this;\n  }\n\n  /**\n   * 添加style\n   * @param style\n   */\n  style(style) {\n    if (!this.isTextNode()) {\n      this.attr('style', style);\n    }\n    return this;\n  }\n\n  /**\n   * 添加元素属性\n   * @param key\n   * @param value\n   * @returns {string|Element}\n   */\n  attr(key, value) {\n    if (!this.isTextNode()) {\n      if (value !== undefined) {\n        if (this.el.setAttribute) {\n          this.el.setAttribute(key, value);\n        }\n      } else {\n        if (typeof key === 'string') {\n          if (this.el.setAttribute) {\n            return this.el.getAttribute(key);\n          }\n          return null;\n        }\n        if (this.el.setAttribute) {\n          Object.keys(key).forEach((k) => {\n            this.el.setAttribute(k, key[k]);\n          });\n        }\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 设置元素Value\n   * @param v\n   * @returns {Element|*}\n   */\n  val(v) {\n    if (!this.isTextNode()) {\n      if (v !== undefined) {\n        this.el.value = v;\n        return this;\n      }\n      return this.el.value;\n    }\n    if (v === undefined) {\n      return this.nodeValue();\n    }\n    return this;\n  }\n\n  /**\n   * 获取原始节点\n   * @returns {*}\n   */\n  get() {\n    return this.el;\n  }\n\n  /**\n   * 删除元素style属性\n   * @param keys\n   * @returns {Element}\n   */\n  cssRemoveKeys(...keys) {\n    if (!this.isTextNode()) {\n      if (this.el.style) {\n        keys.forEach((k) => {\n          if (this.el.style) {\n            this.el.style.removeProperty(Element.hyphenateRE(k));\n          }\n        });\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 删除元素style属性\n   * @param key\n   * @param value\n   * @returns {Element}\n   */\n  cssRemoveVal(key, value) {\n    if (!this.isTextNode()) {\n      if (this.el.style) {\n        const property = Element.hyphenateRE(key);\n        const propertyValue = this.el.style.getPropertyValue(property);\n        const newValue = propertyValue.replace(value, '');\n        this.css(key, newValue);\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 设置元素属性\n   * @param name\n   * @param value\n   * @returns {string|null|Element}\n   */\n  css(name, value = undefined) {\n    if (!this.isTextNode()) {\n      if (this.el.style) {\n        if (value === undefined && typeof name !== 'string') {\n          Object.keys(name).forEach((key) => {\n            const property = Element.hyphenateRE(key);\n            this.el.style.setProperty(property, name[key]);\n          });\n          return this;\n        }\n        if (value !== undefined) {\n          const property = Element.hyphenateRE(name);\n          this.el.style.setProperty(property, value);\n          return this;\n        }\n        const property = Element.hyphenateRE(name);\n        return this.el.style.getPropertyValue(property);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * 获取元素计算完成的样式\n   * @returns {CSSStyleDeclaration}\n   */\n  computedStyle() {\n    if (!this.isTextNode()) {\n      return window.getComputedStyle(this.el, null);\n    }\n    return null;\n  }\n\n  /**\n   * 显示\n   * @returns {Element}\n   */\n  show() {\n    if (!this.isTextNode()) {\n      const style = this.computedStyle();\n      if (style && style.display !== 'block') {\n        this.css('display', 'block');\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 隐藏\n   * @returns {Element}\n   */\n  hide() {\n    if (!this.isTextNode()) {\n      const style = this.computedStyle();\n      if (style && style.display !== 'none') {\n        this.css('display', 'none');\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 事件触发\n   * @param type\n   * @param message\n   */\n  trigger(type, message) {\n    if (!this.isTextNode()) {\n      switch (type) {\n        case 'click': {\n          const evt = new MouseEvent(type, {\n            detail: message,\n            bubbles: true,\n            cancelable: false,\n          });\n          evt.initEvent('click', true, true);\n          this.el.dispatchEvent(evt);\n          break;\n        }\n        default: {\n          const evt = new CustomEvent(type, {\n            detail: message,\n            bubbles: true,\n            cancelable: false,\n          });\n          this.el.dispatchEvent(evt);\n          break;\n        }\n      }\n    }\n  }\n\n  /**\n   * 查找子元素\n   * @param select\n   * @returns {[]|Element}\n   */\n  find(select) {\n    if (!this.isTextNode()) {\n      const result = this.el.querySelectorAll(select);\n      if (result && result.length === 1) {\n        return new Element(result[0]);\n      }\n      const array = [];\n      if (result) {\n        for (const item of result) {\n          array.push(new Element(item));\n        }\n      }\n      return array;\n    }\n    return [];\n  }\n\n  /**\n   * 查找子元素\n   * @param select\n   * @returns {[]|Element}\n   */\n  finds(select) {\n    if (!this.isTextNode()) {\n      const result = this.el.querySelectorAll(select);\n      const array = [];\n      if (result) {\n        for (const item of result) {\n          array.push(new Element(item));\n        }\n      }\n      return array;\n    }\n    return [];\n  }\n\n  /**\n   * 获取当前元素的兄弟节点\n   * @returns {[]}\n   */\n  sibling() {\n    let sibling = this.el;\n    const result = [];\n    // eslint-disable-next-line no-cond-assign\n    while ((sibling = sibling.previousElementSibling) !== null) result.push(new Element(sibling));\n    sibling = this.el;\n    // eslint-disable-next-line no-cond-assign\n    while ((sibling = sibling.nextElementSibling) !== null) result.push(new Element(sibling));\n    return result;\n  }\n\n  /**\n   * 节点名称\n   * @returns {string}\n   */\n  tagName() {\n    return this.el.nodeName.toLocaleLowerCase();\n  }\n\n  /**\n   * 节点内容\n   * @returns {string}\n   */\n  nodeValue() {\n    return this.el.nodeValue;\n  }\n\n  /**\n   * 节点类型\n   * @returns {number}\n   */\n  nodeType() {\n    return this.el.nodeType;\n  }\n\n  /**\n   * 在当前元素之后插入新元素\n   * @param ele\n   */\n  after(ele) {\n    if (this.el && ele && ele.el) {\n      this.el.after(ele.el);\n    }\n    return this;\n  }\n\n  /**\n   * 在当前元素之前插入新元素\n   * @param ele\n   */\n  before(ele) {\n    if (this.el && ele && ele.el) {\n      this.el.before(ele.el);\n    }\n    return this;\n  }\n\n  /**\n   * 复制\n   */\n  clone() {\n    return new Element(this.el.cloneNode(true));\n  }\n\n  /**\n   * 清空元素中的所有内容\n   */\n  empty() {\n    if (!this.isTextNode()) {\n      this.html('');\n    }\n    return this;\n  }\n\n  /**\n   * 相等比较\n   * @param other\n   * @returns {boolean}\n   */\n  equals(other) {\n    return this.el === other.el;\n  }\n\n  /**\n   * 获取当前元素在父元素中的索引\n   * @returns {number}\n   */\n  index() {\n    let parent = this.parent();\n    let index = -1;\n    parent.childrenNodes()\n      .forEach((v, i) => {\n        if (v.equals(this)) {\n          index = i;\n        }\n      });\n    return index;\n  }\n\n  /**\n   * 比较dom是否相同\n   * @param ele\n   * @returns {boolean}\n   */\n  is(ele) {\n    return this.el === ele.el;\n  }\n\n  /**\n   * 是否文本节点\n   * @returns {boolean}\n   */\n  isTextNode() {\n    return this.tagName() === '#text';\n  }\n\n  /**\n   * 是否换行节点\n   * @returns {boolean}\n   */\n  isBreakNode() {\n    return this.tagName() === 'br';\n  }\n\n  /**\n   * 是否文档碎片\n   * @returns {boolean}\n   */\n  isDocumentFragment() {\n    return this.el instanceof DocumentFragment;\n  }\n\n}\n\nconst h = (tag, className = '') => new Element(tag, className);\n\nconst TextNode = (text) => Element.createText(text);\n\nexport {\n  Element,\n  TextNode,\n  h,\n};\n","/* global document */\r\n\r\nimport { Element, h } from './Element';\r\nimport { cssPrefix } from '../const/Constant';\r\nimport { XEvent } from './XEvent';\r\n\r\n/**\r\n * Life\r\n */\r\nclass Life extends Element {\r\n\r\n  onAttach() { }\r\n\r\n}\r\n\r\n/**\r\n * Widget\r\n */\r\nclass Widget extends Life {\r\n\r\n  /**\r\n   * Widget\r\n   * @param className\r\n   * @param nodeType\r\n   * @param $$rootFlag\r\n   */\r\n  constructor(className = '', nodeType = 'div', $$rootFlag = false) {\r\n    if (typeof className === 'string') {\r\n      super(nodeType, `${cssPrefix}-widget ${className}`);\r\n    } else {\r\n      super(className);\r\n    }\r\n    this.$$rootFlag = $$rootFlag;\r\n  }\r\n\r\n  /**\r\n   * 追加节点\r\n   * @param args[]\r\n   */\r\n  childrenNodes(...args) {\r\n    args.forEach((ele) => {\r\n      if (ele.parentWidget) {\r\n        ele.parentWidget(this);\r\n      }\r\n    });\r\n    return super.childrenNodes(...args);\r\n  }\r\n\r\n  /**\r\n   * 追加节点\r\n   * 触发onAttach事件\r\n   * @param widget\r\n   */\r\n  attach(widget) {\r\n    this.childrenNodes(widget);\r\n    widget.parentWidget(this);\r\n    widget.onAttach(this);\r\n  }\r\n\r\n  /**\r\n   * 追加节点\r\n   * @param widget\r\n   */\r\n  before(widget) {\r\n    widget.parentWidget(this);\r\n    return super.before(widget);\r\n  }\r\n\r\n  /**\r\n   * 追加节点\r\n   * @param widget\r\n   */\r\n  after(widget) {\r\n    widget.parentWidget(this);\r\n    return super.after(widget);\r\n  }\r\n\r\n  /**\r\n   * 解绑事件处理\r\n   */\r\n  unbind() {\r\n    XEvent.unbind(this);\r\n  }\r\n\r\n  /**\r\n   * 绑定处理事件\r\n   */\r\n  bind() {\r\n\r\n  }\r\n\r\n  /**\r\n   * 计算鼠标在当前\r\n   * 元素中的位置\r\n   * @param event\r\n   * @param elem\r\n   * @returns {{x: number, y: number}}\r\n   */\r\n  eventXy(event, elem = this) {\r\n    const { top, left } = elem.box();\r\n    return {\r\n      y: event.clientY - top,\r\n      x: event.clientX - left,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 销毁组件\r\n   */\r\n  destroy() {\r\n    this.unbind();\r\n    this.remove();\r\n  }\r\n\r\n  /**\r\n   * 查找最邻近\r\n   * 的class元素\r\n   * @param clazz\r\n   */\r\n  closestClass(clazz) {\r\n    let node = this;\r\n    while (!h(document.body).is(node)) {\r\n      if (node.hasClass(clazz)) {\r\n        return node;\r\n      }\r\n      node = node.parent();\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * 获取根节点box\r\n   */\r\n  getRootBox() {\r\n    return this.getRootWidget().box();\r\n  }\r\n\r\n  /**\r\n   * 获取相对于 root box的\r\n   * 元素box\r\n   * @returns {{top: number, left: number, width: number, height: number}}\r\n   */\r\n  relativeBox() {\r\n    const root = this.getRootWidget();\r\n    const thisBox = this.box();\r\n    const rootBox = root.box();\r\n    return {\r\n      right: rootBox.right - thisBox.right,\r\n      bottom: rootBox.bottom - thisBox.bottom,\r\n      top: thisBox.top - rootBox.top,\r\n      left: thisBox.left - rootBox.left,\r\n      width: thisBox.width,\r\n      height: thisBox.height,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 获取 root widget\r\n   */\r\n  getRootWidget() {\r\n    let parent = this.data('parent');\r\n    while (parent && !parent.$$rootFlag) {\r\n      parent = parent.data('parent');\r\n    }\r\n    return parent;\r\n  }\r\n\r\n  /**\r\n   * 设置 parent widget\r\n   * @param widget\r\n   */\r\n  parentWidget(widget) {\r\n    if (widget) {\r\n      this.data('parent', widget);\r\n      return this;\r\n    }\r\n    return this.data('parent');\r\n  }\r\n\r\n}\r\n\r\nconst w = (className = '', nodeType = 'div') => new Widget(className, nodeType);\r\n\r\nexport {\r\n  Widget,\r\n  w,\r\n};\r\n","import { Constant } from '../const/Constant';\r\nimport { Element } from './Element';\r\n\r\nclass BindPool {\r\n\r\n  constructor() {\r\n    this.pool = [];\r\n  }\r\n\r\n  unbind(ele, type, callback, option) {\r\n    if (ele instanceof Element) {\r\n      ele = ele.el;\r\n    }\r\n    const result = this.remove(ele, type, callback, option);\r\n    if (result.length) {\r\n      result.forEach((item) => {\r\n        ele.removeEventListener(item.type, item.callback, item.option);\r\n      });\r\n    } else {\r\n      ele.removeEventListener(type, callback, option);\r\n    }\r\n  }\r\n\r\n  bind(ele, type, callback, option) {\r\n    if (ele instanceof Element) {\r\n      ele = ele.el;\r\n    }\r\n    this.pool.push({\r\n      ele, type, callback, option,\r\n    });\r\n    ele.addEventListener(type, callback, option);\r\n  }\r\n\r\n  remove(ele, type = '*', callback = null, option = null) {\r\n    const pool = [];\r\n    const rem = [];\r\n    this.pool.forEach((item) => {\r\n      const eqElem = ele === item.ele;\r\n      const eqOpt = option === null || option === item.option;\r\n      const eqType = type === '*' || type === item.type;\r\n      const eqCall = callback === null || callback === item.callback;\r\n      if (eqElem && eqType && eqCall && eqOpt) {\r\n        rem.push(item);\r\n      } else {\r\n        pool.push(item);\r\n      }\r\n    });\r\n    this.pool = pool;\r\n    return rem;\r\n  }\r\n\r\n  multipleUnbind(eles, type, callback, option) {\r\n    eles.forEach((item) => {\r\n      this.unbind(item, type, callback, option);\r\n    });\r\n  }\r\n\r\n  multipleBind(eles, type, callback, option) {\r\n    eles.forEach((item) => {\r\n      this.bind(item, type, callback, option);\r\n    });\r\n  }\r\n\r\n}\r\n\r\nconst pool = new BindPool();\r\n\r\nclass XEvent {\r\n\r\n  static unbind(target, name, fn, option = false) {\r\n    if (Array.isArray(target)) {\r\n      pool.multipleUnbind(target, name, fn, option);\r\n    } else {\r\n      pool.unbind(target, name, fn, option);\r\n    }\r\n    return target;\r\n  }\r\n\r\n  static bind(target, name, fn, option = false) {\r\n    if (Array.isArray(target)) {\r\n      pool.multipleBind(target, name, fn, option);\r\n    } else {\r\n      pool.bind(target, name, fn, option);\r\n    }\r\n    return target;\r\n  }\r\n\r\n  static mouseHold(target, holdFunc = () => {}, endFunc = () => {}, time = 150) {\r\n    let handle = setInterval(() => {\r\n      holdFunc();\r\n    }, time);\r\n    let xEvtUp = (evt) => {\r\n      clearInterval(handle);\r\n      XEvent.unbind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_UP, xEvtUp, true);\r\n      endFunc(evt);\r\n    };\r\n    holdFunc();\r\n    XEvent.bind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_UP, xEvtUp, true);\r\n  }\r\n\r\n  static mouseMoveUp(target, moveFunc = () => {}, upFunc = () => {}) {\r\n    const xEvtMove = (evt) => {\r\n      moveFunc(evt);\r\n      evt.stopPropagation();\r\n      evt.preventDefault();\r\n    };\r\n    const xEvtUp = (evt) => {\r\n      XEvent.unbind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_MOVE, xEvtMove, true);\r\n      XEvent.unbind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_UP, xEvtUp, true);\r\n      upFunc(evt);\r\n      evt.preventDefault();\r\n    };\r\n    XEvent.bind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_MOVE, xEvtMove, true);\r\n    XEvent.bind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_UP, xEvtUp, true);\r\n    return target;\r\n  }\r\n\r\n}\r\n\r\nXEvent.WrapFuncion = {\r\n  doubleClick: (callback) => {\r\n    let lastPageX = 0;\r\n    let lastPageY = 0;\r\n    let lastTime = 0;\r\n    return (event) => {\r\n      if (event.button === 2) {\r\n        lastPageX = 0;\r\n        lastTime = 0;\r\n        lastPageY = 0;\r\n        return;\r\n      }\r\n      const { pageX, pageY } = event;\r\n      const current = Date.now();\r\n      const diffTime = current - lastTime <= 300;\r\n      const diffPageX = pageX === lastPageX;\r\n      const diffPageY = pageY === lastPageY;\r\n      if (diffTime && diffPageX && diffPageY) {\r\n        callback(event);\r\n        lastTime = 0;\r\n        lastPageX = 0;\r\n        lastPageY = 0;\r\n      } else {\r\n        lastPageX = pageX;\r\n        lastPageY = pageY;\r\n        lastTime = current;\r\n      }\r\n    };\r\n  },\r\n  mouseClick: (callback) => (event) => {\r\n    callback(event);\r\n  },\r\n};\r\n\r\nexport {\r\n  XEvent,\r\n};\r\n","/* global document */\r\nimport { h } from '../../lib/Element';\r\nimport { cssPrefix, Constant } from '../../const/Constant';\r\nimport { Widget } from '../../lib/Widget';\r\nimport { DragPanel } from '../dragpanel/DragPanel';\r\nimport { XEvent } from '../../lib/XEvent';\r\nimport { SheetUtils } from '../../utils/SheetUtils';\r\n\r\nclass ColorPicker extends Widget {\r\n\r\n  constructor(options) {\r\n    super(`${cssPrefix}-color-picker`);\r\n    this.options = SheetUtils.copy({\r\n      selectCb: () => {},\r\n    }, options);\r\n    // 拖拽组件\r\n    this.dragPanel = new DragPanel().parentWidget(this);\r\n    this.color = [360, 0, 100];\r\n    // 头部\r\n    this.preViewColorPoint = h('div', `${cssPrefix}-color-picker-pre-view-color-point`);\r\n    this.colorValueTips = h('div', `${cssPrefix}-color-picker-color-value-tips`);\r\n    this.colorValueTips.text('十六进制颜色值');\r\n    this.colorInput = h('input', `${cssPrefix}-color-picker-color-input`);\r\n    this.top = h('div', `${cssPrefix}-color-picker-top`);\r\n    this.top.childrenNodes(this.preViewColorPoint);\r\n    this.top.childrenNodes(this.colorValueTips);\r\n    this.top.childrenNodes(this.colorInput);\r\n    // 中间部分\r\n    this.selectColorPoint = h('div', `${cssPrefix}-color-picker-select-color-point`);\r\n    this.selectColorArea1 = h('div', `${cssPrefix}-color-picker-select-color-area area1`);\r\n    this.selectColorArea2 = h('div', `${cssPrefix}-color-picker-select-color-area area2`);\r\n    this.selectColorArea3 = h('div', `${cssPrefix}-color-picker-select-color-area area3`);\r\n    this.center = h('div', `${cssPrefix}-color-picker-center`);\r\n    this.center.childrenNodes(this.selectColorArea1);\r\n    this.center.childrenNodes(this.selectColorArea2);\r\n    this.center.childrenNodes(this.selectColorArea3);\r\n    this.center.childrenNodes(this.selectColorPoint);\r\n    // 底部\r\n    this.colorHuxTips = h('div', `${cssPrefix}-color-picker-color-hux-tips`);\r\n    this.colorBar = h('div', `${cssPrefix}-color-picker-color-bar`);\r\n    this.colorBarPoint = h('div', `${cssPrefix}-color-picker-bar-point`);\r\n    this.bottom = h('div', `${cssPrefix}-color-picker-bottom`);\r\n    this.colorHuxTips.text('HUE');\r\n    this.colorBar.childrenNodes(this.colorBarPoint);\r\n    this.bottom.childrenNodes(this.colorHuxTips);\r\n    this.bottom.childrenNodes(this.colorBar);\r\n    // 按钮\r\n    this.cancelButton = h('div', `${cssPrefix}-color-picker-button cancel`);\r\n    this.selectButton = h('div', `${cssPrefix}-color-picker-button select`);\r\n    this.buttons = h('div', `${cssPrefix}-color-picker-buttons`);\r\n    this.cancelButton.text('取消');\r\n    this.selectButton.text('确定');\r\n    this.buttons.childrenNodes(this.selectButton);\r\n    this.buttons.childrenNodes(this.cancelButton);\r\n    this.childrenNodes(this.top);\r\n    this.childrenNodes(this.center);\r\n    this.childrenNodes(this.bottom);\r\n    this.childrenNodes(this.buttons);\r\n    this.dragPanel.childrenNodes(this);\r\n    this.dragPanel.css('background', '#ffffff');\r\n    this.bind();\r\n  }\r\n\r\n  unbind() {\r\n    const { selectColorPoint } = this;\r\n    const { colorBarPoint } = this;\r\n    const {\r\n      colorInput, cancelButton, selectButton,\r\n    } = this;\r\n    XEvent.unbind(colorInput);\r\n    XEvent.unbind(colorInput);\r\n    XEvent.unbind(colorBarPoint);\r\n    XEvent.unbind(selectColorPoint);\r\n    XEvent.unbind(cancelButton);\r\n    XEvent.unbind(selectButton);\r\n  }\r\n\r\n  bind() {\r\n    const { selectColorPoint, center } = this;\r\n    const { colorBarPoint, colorBar } = this;\r\n    const {\r\n      colorInput, cancelButton, selectButton,\r\n    } = this;\r\n    XEvent.bind(colorInput, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (e1) => {\r\n      e1.stopPropagation();\r\n    });\r\n    XEvent.bind(colorInput, Constant.SYSTEM_EVENT_TYPE.CHANGE, () => {\r\n      const value = colorInput.val();\r\n      if (value) {\r\n        this.hexColor(value);\r\n      }\r\n    });\r\n    XEvent.bind(colorBarPoint, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (e1) => {\r\n      const xy = this.eventXy(e1, colorBar);\r\n      const colorBarBox = colorBar.box();\r\n      if (xy.x < 0) xy.x = 0;\r\n      if (xy.x > colorBarBox.width) xy.x = colorBarBox.width;\r\n      this.downHue(xy.x, colorBarBox.width);\r\n      XEvent.mouseMoveUp(h(document), (e2) => {\r\n        const xy = this.eventXy(e2, colorBar);\r\n        const colorBarBox = colorBar.box();\r\n        if (xy.x < 0) xy.x = 0;\r\n        if (xy.x > colorBarBox.width) xy.x = colorBarBox.width;\r\n        this.moveHue(xy.x, colorBarBox.width);\r\n      });\r\n      e1.stopPropagation();\r\n    });\r\n    XEvent.bind(selectColorPoint, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (e1) => {\r\n      const xy = this.eventXy(e1, center);\r\n      const centerBox = center.box();\r\n      if (xy.x < 0) xy.x = 0;\r\n      if (xy.x > centerBox.width) xy.x = centerBox.width;\r\n      if (xy.y < 0) xy.y = 0;\r\n      if (xy.y > centerBox.height) xy.y = centerBox.height;\r\n      this.downSelect(xy.x, xy.y, centerBox.width, centerBox.height);\r\n      XEvent.mouseMoveUp(h(document), (e2) => {\r\n        const xy = this.eventXy(e2, center);\r\n        if (xy.x < 0) xy.x = 0;\r\n        if (xy.x > centerBox.width) xy.x = centerBox.width;\r\n        if (xy.y < 0) xy.y = 0;\r\n        if (xy.y > centerBox.height) xy.y = centerBox.height;\r\n        this.moveSelect(xy.x, xy.y, centerBox.width, centerBox.height);\r\n      });\r\n      e1.stopPropagation();\r\n    });\r\n    XEvent.bind(cancelButton, Constant.SYSTEM_EVENT_TYPE.CLICK, () => {\r\n      this.close();\r\n    });\r\n    XEvent.bind(selectButton, Constant.SYSTEM_EVENT_TYPE.CLICK, () => {\r\n      const { color } = this;\r\n      const hsb = ColorPicker.fixHsx({\r\n        h: parseInt(color[0], 10),\r\n        s: parseInt(color[1], 10),\r\n        x: parseInt(color[2], 10),\r\n      });\r\n      const rgb = ColorPicker.hsbToRgb(hsb);\r\n      this.options.selectCb(`rgb(${rgb.r},${rgb.g},${rgb.b})`);\r\n      this.close();\r\n    });\r\n  }\r\n\r\n  open(hex) {\r\n    const { dragPanel } = this;\r\n    dragPanel.open();\r\n    if (hex) {\r\n      if (ColorPicker.isRgb(hex)) {\r\n        const rgb = ColorPicker.parseRgb(hex);\r\n        // eslint-disable-next-line no-param-reassign\r\n        hex = ColorPicker.rgbToHex(rgb);\r\n      }\r\n      this.hexColor(hex);\r\n    } else {\r\n      this.change();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  close() {\r\n    const { dragPanel } = this;\r\n    dragPanel.close();\r\n    return this;\r\n  }\r\n\r\n  sliderPosition(hsb) {\r\n    // hue 滑块位置\r\n    const { colorBar, colorBarPoint } = this;\r\n    const colorBarPointBox = colorBarPoint.box();\r\n    const colorBarBox = colorBar.box();\r\n    let colorBarPointLeft = parseInt(colorBarBox.width - colorBarBox.width * hsb.h / 360, 10);\r\n    colorBarPointLeft -= colorBarPointBox.width / 2;\r\n    colorBarPoint.offset({\r\n      left: colorBarPointLeft,\r\n    });\r\n    // select color 滑块位置\r\n    const { center, selectColorPoint } = this;\r\n    const selectColorPointBox = selectColorPoint.box();\r\n    const centerBox = center.box();\r\n    let selectColorPointLeft = parseInt(centerBox.width * hsb.s / 100, 10);\r\n    let selectColorPointTop = parseInt(centerBox.height * (100 - hsb.x) / 100, 10);\r\n    selectColorPointLeft -= selectColorPointBox.width / 2;\r\n    selectColorPointTop -= selectColorPointBox.height / 2;\r\n    selectColorPoint.offset({\r\n      left: selectColorPointLeft,\r\n      top: selectColorPointTop,\r\n    });\r\n  }\r\n\r\n  hueChange() {\r\n    const { color } = this;\r\n    const hsb = ColorPicker.fixHsx({\r\n      h: parseInt(color[0], 10),\r\n      s: parseInt(color[1], 10),\r\n      x: parseInt(color[2], 10),\r\n    });\r\n    const {\r\n      colorBarPoint, selectColorPoint, preViewColorPoint, selectColorArea1, colorInput,\r\n    } = this;\r\n    const colorValue = ColorPicker.hsbToHex(hsb);\r\n    const areaColorValue = ColorPicker.hsbToHex({ h: hsb.h, s: 100, x: 100 });\r\n    selectColorPoint.css('backgroundColor', `#${colorValue}`);\r\n    preViewColorPoint.css('backgroundColor', `#${colorValue}`);\r\n    colorBarPoint.css('backgroundColor', `#${areaColorValue}`);\r\n    selectColorArea1.css('backgroundColor', `#${areaColorValue}`);\r\n    colorInput.val(`#${colorValue}`);\r\n    this.sliderPosition(hsb);\r\n  }\r\n\r\n  selectChange() {\r\n    const { color } = this;\r\n    const hsb = ColorPicker.fixHsx({\r\n      h: parseInt(color[0], 10),\r\n      s: parseInt(color[1], 10),\r\n      x: parseInt(color[2], 10),\r\n    });\r\n    const { preViewColorPoint, selectColorPoint, colorInput } = this;\r\n    const colorValue = ColorPicker.hsbToHex(hsb);\r\n    selectColorPoint.css('backgroundColor', `#${colorValue}`);\r\n    preViewColorPoint.css('backgroundColor', `#${colorValue}`);\r\n    colorInput.val(`#${colorValue}`);\r\n    this.sliderPosition(hsb);\r\n  }\r\n\r\n  change() {\r\n    this.hueChange();\r\n    this.selectChange();\r\n  }\r\n\r\n  downSelect(x, y, width, height) {\r\n    const { color } = this;\r\n    color[1] = parseInt(100 * x / width, 10);\r\n    color[2] = parseInt(100 * (height - y) / height, 10);\r\n    this.selectChange();\r\n  }\r\n\r\n  moveSelect(x, y, width, height) {\r\n    const { color } = this;\r\n    color[1] = parseInt(100 * (Math.max(0, Math.min(width, x))) / width, 10);\r\n    color[2] = parseInt(100 * (height - Math.max(0, Math.min(height, y))) / height, 10);\r\n    this.selectChange();\r\n  }\r\n\r\n  downHue(x, width) {\r\n    const { color } = this;\r\n    color[0] = parseInt(360 * (width - x) / width, 10);\r\n    this.hueChange();\r\n  }\r\n\r\n  moveHue(x, width) {\r\n    const { color } = this;\r\n    color[0] = parseInt(360 * (width - Math.max(0, Math.min(width, x))) / width, 10);\r\n    this.hueChange();\r\n  }\r\n\r\n  hexColor(hex) {\r\n    const { color } = this;\r\n    const result = ColorPicker.hexToHsb(ColorPicker.fixHex(hex));\r\n    color[0] = result.h;\r\n    color[1] = result.s;\r\n    color[2] = result.x;\r\n    this.change();\r\n  }\r\n\r\n  destroy() {\r\n    super.destroy();\r\n    this.unbind();\r\n    this.dragPanel.destroy();\r\n  }\r\n\r\n  static fixHex(hex) {\r\n    const len = 6 - hex.length;\r\n    if (len > 0) {\r\n      const o = [];\r\n      for (let i = 0; i < len; i += 1) {\r\n        o.push('0');\r\n      }\r\n      o.push(hex);\r\n      // eslint-disable-next-line no-param-reassign\r\n      hex = o.join('');\r\n    }\r\n    return hex;\r\n  }\r\n\r\n  static fixHsx(hsx) {\r\n    return {\r\n      h: Math.min(360, Math.max(0, hsx.h)),\r\n      s: Math.min(100, Math.max(0, hsx.s)),\r\n      x: Math.min(100, Math.max(0, hsx.x)),\r\n    };\r\n  }\r\n\r\n  static isRgb(rgb) {\r\n    return rgb.startsWith('rgb');\r\n  }\r\n\r\n  static isHex(hex) {\r\n    return hex.startsWith('#');\r\n  }\r\n\r\n  static isDark(rgb) {\r\n    if (SheetUtils.isString(rgb)) {\r\n      if (this.isHex(rgb)) {\r\n        const v = ColorPicker.hexToRgb(rgb);\r\n        rgb = `rgb(${v.r}, ${v.g}, ${v.b})`;\r\n      }\r\n      const result = ColorPicker.parseRgb(rgb);\r\n      const { r, g, b } = result;\r\n      return (r * 0.299) + (g * 0.578) + (b * 0.114) >= 192;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  static hexToRgb(hex) {\r\n    // eslint-disable-next-line no-redeclare,no-param-reassign\r\n    hex = parseInt(((hex.indexOf('#') > -1) ? hex.substring(1) : hex), 16);\r\n    // eslint-disable-next-line no-bitwise\r\n    return { r: hex >> 16, g: (hex & 0x00FF00) >> 8, b: (hex & 0x0000FF) };\r\n  }\r\n\r\n  static hexToHsb(hex) {\r\n    return this.rgbToHsb(this.hexToRgb(hex));\r\n  }\r\n\r\n  static rgbToHsb(rgb) {\r\n    const hsb = { h: 0, s: 0, x: 0 };\r\n    const min = Math.min(rgb.r, rgb.g, rgb.b);\r\n    const max = Math.max(rgb.r, rgb.g, rgb.b);\r\n    const delta = max - min;\r\n    hsb.x = max;\r\n    hsb.s = max !== 0 ? 255 * delta / max : 0;\r\n    if (hsb.s !== 0) {\r\n      if (rgb.r === max) hsb.h = (rgb.g - rgb.b) / delta;\r\n      else if (rgb.g === max) hsb.h = 2 + (rgb.b - rgb.r) / delta;\r\n      else hsb.h = 4 + (rgb.r - rgb.g) / delta;\r\n    } else hsb.h = -1;\r\n    hsb.h *= 60;\r\n    if (hsb.h < 0) hsb.h += 360;\r\n    hsb.s *= 100 / 255;\r\n    hsb.x *= 100 / 255;\r\n    return hsb;\r\n  }\r\n\r\n  static hsbToRgb(hsb) {\r\n    const rgb = {};\r\n    let { h } = hsb;\r\n    const s = hsb.s * 255 / 100;\r\n    const v = hsb.x * 255 / 100;\r\n    if (s === 0) {\r\n      rgb.r = v;\r\n      rgb.g = v;\r\n      rgb.b = v;\r\n    } else {\r\n      const t1 = v;\r\n      const t2 = (255 - s) * v / 255;\r\n      const t3 = (t1 - t2) * (h % 60) / 60;\r\n      if (h === 360) h = 0;\r\n      if (h < 60) {\r\n        rgb.r = t1;\r\n        rgb.b = t2;\r\n        rgb.g = t2 + t3;\r\n      } else if (h < 120) {\r\n        rgb.g = t1;\r\n        rgb.b = t2;\r\n        rgb.r = t1 - t3;\r\n      } else if (h < 180) {\r\n        rgb.g = t1;\r\n        rgb.r = t2;\r\n        rgb.b = t2 + t3;\r\n      } else if (h < 240) {\r\n        rgb.b = t1;\r\n        rgb.r = t2;\r\n        rgb.g = t1 - t3;\r\n      } else if (h < 300) {\r\n        rgb.b = t1;\r\n        rgb.g = t2;\r\n        rgb.r = t2 + t3;\r\n      } else if (h < 360) {\r\n        rgb.r = t1;\r\n        rgb.g = t2;\r\n        rgb.b = t1 - t3;\r\n      } else {\r\n        rgb.r = 0;\r\n        rgb.g = 0;\r\n        rgb.b = 0;\r\n      }\r\n    }\r\n    return { r: Math.round(rgb.r), g: Math.round(rgb.g), b: Math.round(rgb.b) };\r\n  }\r\n\r\n  static rgbToHex(rgb) {\r\n    const hex = [\r\n      rgb.r.toString(16),\r\n      rgb.g.toString(16),\r\n      rgb.b.toString(16),\r\n    ];\r\n    hex.forEach((val, nr) => {\r\n      if (val.length === 1) {\r\n        hex[nr] = `0${val}`;\r\n      }\r\n    });\r\n    return hex.join('');\r\n  }\r\n\r\n  static hsbToHex(hsb) {\r\n    return this.rgbToHex(this.hsbToRgb(hsb));\r\n  }\r\n\r\n  static parseRgb(rgb) {\r\n    const rxp = /^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)$/;\r\n    const result = rgb.match(rxp);\r\n    return {\r\n      r: parseInt(result[1], 10),\r\n      g: parseInt(result[2], 10),\r\n      b: parseInt(result[3], 10),\r\n    };\r\n  }\r\n\r\n  static parseRgbToHex(rgb, defaultValue = null) {\r\n    if (rgb) {\r\n      if (this.isHex(rgb)) {\r\n        return rgb.substring(1);\r\n      }\r\n      const value = this.parseRgb(rgb);\r\n      return this.rgbToHex(value);\r\n    }\r\n    return defaultValue;\r\n  }\r\n\r\n  static parseHexToRgb(hex, defaultValue = null) {\r\n    if (hex) {\r\n      const rgb = ColorPicker.hexToRgb(hex);\r\n      return `rgb(${rgb.r},${rgb.g},${rgb.b})`;\r\n    }\r\n    return defaultValue;\r\n  }\r\n\r\n}\r\n\r\nexport { ColorPicker };\r\n","import { Widget } from '../../../lib/Widget';\r\nimport { cssPrefix, Constant } from '../../../const/Constant';\r\nimport { ColorItem } from './ColorItem';\r\nimport { SheetUtils } from '../../../utils/SheetUtils';\r\nimport { XEvent } from '../../../lib/XEvent';\r\n\r\nclass ColorArray extends Widget {\r\n\r\n  constructor(options) {\r\n    super(`${cssPrefix}-color-array`);\r\n    this.options = SheetUtils.copy({\r\n      colors: [\r\n        new ColorItem({ color: 'rgb(0, 0, 0)' }),\r\n        new ColorItem({ color: 'rgb(67, 67, 67)' }),\r\n        new ColorItem({ color: 'rgb(102, 102, 102)' }),\r\n        new ColorItem({ color: 'rgb(153, 153, 153)' }),\r\n        new ColorItem({ color: 'rgb(183, 183, 183)' }),\r\n        new ColorItem({ color: 'rgb(204, 204, 204)' }),\r\n        new ColorItem({ color: 'rgb(217, 217, 217)' }),\r\n        new ColorItem({ color: 'rgb(239, 239, 239)' }),\r\n        new ColorItem({ color: 'rgb(255, 255, 255)' }),\r\n\r\n        new ColorItem({ color: 'rgb(152, 0, 0)' }),\r\n        new ColorItem({ color: 'rgb(255, 0, 0)' }),\r\n        new ColorItem({ color: 'rgb(255, 153, 0)' }),\r\n        new ColorItem({ color: 'rgb(255, 255, 0)' }),\r\n        new ColorItem({ color: 'rgb(0, 255, 0)' }),\r\n        new ColorItem({ color: 'rgb(0, 255, 255)' }),\r\n        new ColorItem({ color: 'rgb(74, 134, 232)' }),\r\n        new ColorItem({ color: 'rgb(0, 0, 255)' }),\r\n        new ColorItem({ color: 'rgb(153, 0, 255)' }),\r\n        new ColorItem({ color: 'rgb(255, 0, 255)' }),\r\n\r\n        new ColorItem({ color: 'rgb(230, 184, 175)' }),\r\n        new ColorItem({ color: 'rgb(244, 204, 204)' }),\r\n        new ColorItem({ color: 'rgb(252, 229, 205)' }),\r\n        new ColorItem({ color: 'rgb(255, 242, 204)' }),\r\n        new ColorItem({ color: 'rgb(217, 234, 211)' }),\r\n        new ColorItem({ color: 'rgb(208, 224, 227)' }),\r\n        new ColorItem({ color: 'rgb(201, 218, 248)' }),\r\n        new ColorItem({ color: 'rgb(207, 226, 243)' }),\r\n        new ColorItem({ color: 'rgb(217, 210, 233)' }),\r\n        new ColorItem({ color: 'rgb(234, 209, 220)' }),\r\n\r\n        new ColorItem({ color: 'rgb(221, 126, 107)' }),\r\n        new ColorItem({ color: 'rgb(234, 153, 153)' }),\r\n        new ColorItem({ color: 'rgb(249, 203, 156)' }),\r\n        new ColorItem({ color: 'rgb(255, 229, 153)' }),\r\n        new ColorItem({ color: 'rgb(182, 215, 168)' }),\r\n        new ColorItem({ color: 'rgb(162, 196, 201)' }),\r\n        new ColorItem({ color: 'rgb(164, 194, 244)' }),\r\n        new ColorItem({ color: 'rgb(159, 197, 232)' }),\r\n        new ColorItem({ color: 'rgb(180, 167, 214)' }),\r\n        new ColorItem({ color: 'rgb(213, 166, 189)' }),\r\n\r\n        new ColorItem({ color: 'rgb(204, 65, 37)' }),\r\n        new ColorItem({ color: 'rgb(224, 102, 102)' }),\r\n        new ColorItem({ color: 'rgb(246, 178, 107)' }),\r\n        new ColorItem({ color: 'rgb(255, 217, 102)' }),\r\n        new ColorItem({ color: 'rgb(147, 196, 125)' }),\r\n        new ColorItem({ color: 'rgb(118, 165, 175)' }),\r\n        new ColorItem({ color: 'rgb(109, 158, 235)' }),\r\n        new ColorItem({ color: 'rgb(111, 168, 220)' }),\r\n        new ColorItem({ color: 'rgb(142, 124, 195)' }),\r\n        new ColorItem({ color: 'rgb(194, 123, 160)' }),\r\n\r\n        new ColorItem({ color: 'rgb(166, 28, 0)' }),\r\n        new ColorItem({ color: 'rgb(204, 0, 0)' }),\r\n        new ColorItem({ color: 'rgb(230, 145, 56)' }),\r\n        new ColorItem({ color: 'rgb(241, 194, 50)' }),\r\n        new ColorItem({ color: 'rgb(106, 168, 79)' }),\r\n        new ColorItem({ color: 'rgb(69, 129, 142)' }),\r\n        new ColorItem({ color: 'rgb(60, 120, 216)' }),\r\n        new ColorItem({ color: 'rgb(61, 133, 198)' }),\r\n        new ColorItem({ color: 'rgb(103, 78, 167)' }),\r\n        new ColorItem({ color: 'rgb(166, 77, 121)' }),\r\n\r\n        new ColorItem({ color: 'rgb(133, 32, 12)' }),\r\n        new ColorItem({ color: 'rgb(153, 0, 0)' }),\r\n        new ColorItem({ color: 'rgb(180, 95, 6)' }),\r\n        new ColorItem({ color: 'rgb(191, 144, 0)' }),\r\n        new ColorItem({ color: 'rgb(56, 118, 29)' }),\r\n        new ColorItem({ color: 'rgb(19, 79, 92)' }),\r\n        new ColorItem({ color: 'rgb(17, 85, 204)' }),\r\n        new ColorItem({ color: 'rgb(11, 83, 148)' }),\r\n        new ColorItem({ color: 'rgb(53, 28, 117)' }),\r\n        new ColorItem({ color: 'rgb(116, 27, 71)' }),\r\n\r\n        new ColorItem({ color: 'rgb(91, 15, 0)' }),\r\n        new ColorItem({ color: 'rgb(102, 0, 0)' }),\r\n        new ColorItem({ color: 'rgb(120, 63, 4)' }),\r\n        new ColorItem({ color: 'rgb(127, 96, 0)' }),\r\n        new ColorItem({ color: 'rgb(39, 78, 19)' }),\r\n        new ColorItem({ color: 'rgb(12, 52, 61)' }),\r\n        new ColorItem({ color: 'rgb(28, 69, 135)' }),\r\n        new ColorItem({ color: 'rgb(7, 55, 99)' }),\r\n        new ColorItem({ color: 'rgb(32, 18, 77)' }),\r\n        new ColorItem({ color: 'rgb(76, 17, 48)' }),\r\n      ],\r\n      selectCb: () => {},\r\n    }, options);\r\n    this.colors = [];\r\n    this.activeColor = null;\r\n    this.options.colors.forEach((item) => {\r\n      this.add(item);\r\n    });\r\n    if (this.colors.length > 0) {\r\n      this.setActiveByColor(this.colors[0].options.color);\r\n    }\r\n  }\r\n\r\n  add(item) {\r\n    const find = this.colors.findIndex((color) => color.color === item.color);\r\n    if (find === -1) {\r\n      const { colors } = this;\r\n      colors.push(item);\r\n      this.childrenNodes(item);\r\n      this.bind(item);\r\n    }\r\n  }\r\n\r\n  unbind() {\r\n    this.colors.forEach((item) => {\r\n      XEvent.unbind(item);\r\n    });\r\n  }\r\n\r\n  bind(item) {\r\n    XEvent.bind(item, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, () => {\r\n      this.options.selectCb(item);\r\n      if (item.options.color) {\r\n        this.setActiveByColor(item.options.color);\r\n      }\r\n    });\r\n  }\r\n\r\n  findItemByColor(color) {\r\n    color = SheetUtils.blankClear(color);\r\n    return this.colors.find((item) => item.color === color);\r\n  }\r\n\r\n  setActiveByColor(color) {\r\n    color = SheetUtils.blankClear(color);\r\n    this.colors.forEach((item) => {\r\n      if (item.color === color) {\r\n        item.setActive(true);\r\n        this.activeColor = item.color;\r\n      } else {\r\n        item.setActive(false);\r\n      }\r\n    });\r\n  }\r\n\r\n  clear() {\r\n    this.unbind();\r\n    this.colors = [];\r\n    this.empty();\r\n  }\r\n\r\n  destroy() {\r\n    super.destroy();\r\n    this.unbind();\r\n  }\r\n\r\n}\r\n\r\nColorArray.BLACK = 'rgb(0, 0, 0)';\r\nColorArray.NULL = null;\r\nColorArray.WHITE = 'rgb(255, 255, 255)';\r\n\r\nexport {\r\n  ColorArray,\r\n};\r\n","import { Widget } from '../../../lib/Widget';\r\nimport { cssPrefix } from '../../../const/Constant';\r\nimport { SheetUtils } from '../../../utils/SheetUtils';\r\nimport { Icon } from '../../../core/work/head/tool/Icon';\r\nimport { ColorPicker } from '../ColorPicker';\r\n\r\nclass ColorItem extends Widget {\r\n\r\n  constructor(options) {\r\n    super(`${cssPrefix}-color-array-item`);\r\n    this.options = SheetUtils.copy({\r\n      color: null,\r\n      icon: null,\r\n    }, options);\r\n    this.icon = this.options.icon;\r\n    this.color = SheetUtils.blankClear(this.options.color);\r\n    if (this.icon) {\r\n      this.childrenNodes(this.options.icon);\r\n    }\r\n    if (this.color) {\r\n      this.css('backgroundColor', this.color);\r\n      if (ColorPicker.isDark(this.options.color)) {\r\n        this.checkedIcon = new Icon('checked-dark');\r\n        this.childrenNodes(this.checkedIcon);\r\n      } else {\r\n        this.checkedIcon = new Icon('checked-light');\r\n        this.childrenNodes(this.checkedIcon);\r\n      }\r\n      this.checkedIcon.hide();\r\n    }\r\n  }\r\n\r\n  setActive(active) {\r\n    if (this.checkedIcon) {\r\n      if (active) {\r\n        this.checkedIcon.show();\r\n      } else {\r\n        this.checkedIcon.hide();\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport { ColorItem };\r\n","/* global document */\r\nimport { Widget } from '../../lib/Widget';\r\nimport { cssPrefix, Constant } from '../../const/Constant';\r\nimport { XEvent } from '../../lib/XEvent';\r\n\r\nimport { h } from '../../lib/Element';\r\nimport { SheetUtils } from '../../utils/SheetUtils';\r\n\r\nlet instances = [];\r\n\r\n/**\r\n * DragPanel\r\n * @author jerry\r\n * @date 2020/10/19\r\n */\r\nclass DragPanel extends Widget {\r\n\r\n  /**\r\n   * DragPanel\r\n   * @param options\r\n   */\r\n  constructor(options) {\r\n    super(`${cssPrefix}-drag-panel`);\r\n    instances.push(this);\r\n    this.options = SheetUtils.copy({\r\n      position: DragPanel.DRAG_PANEL_POSITION.CENTER,\r\n    }, options);\r\n    this.status = false;\r\n    this.mask = h('div', `${cssPrefix}-drag-panel-mask`);\r\n    this.content = h('div', `${cssPrefix}-drag-panel-content`);\r\n    super.childrenNodes(this.content);\r\n    this.bind();\r\n  }\r\n\r\n  /**\r\n   * 显示弹框\r\n   */\r\n  open() {\r\n    const root = this.getRootWidget();\r\n    const { mask } = this;\r\n    if (this.status === false && root) {\r\n      this.status = true;\r\n      root.childrenNodes(mask);\r\n      root.childrenNodes(this);\r\n      this.dragPanelLocation();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 关闭弹框\r\n   */\r\n  close() {\r\n    const root = this.getRootWidget();\r\n    if (this.status === true && root) {\r\n      const { mask } = this;\r\n      this.status = false;\r\n      root.remove(this);\r\n      root.remove(mask);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 卸载事件\r\n   */\r\n  unbind() {\r\n    const { mask } = this;\r\n    XEvent.unbind(mask);\r\n  }\r\n\r\n  /**\r\n   * 绑定事件\r\n   */\r\n  bind() {\r\n    const { mask } = this;\r\n    XEvent.bind(mask, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (evt1) => {\r\n      this.close();\r\n      evt1.stopPropagation();\r\n    });\r\n    XEvent.bind(this, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (evt1) => {\r\n      if (evt1.button !== 0) {\r\n        return;\r\n      }\r\n      const root = this.getRootWidget();\r\n      const box = root.box();\r\n      const dxy = this.eventXy(evt1);\r\n      XEvent.mouseMoveUp(h(document), (evt2) => {\r\n        const top = evt2.pageY - box.top - dxy.y;\r\n        const left = evt2.pageX - box.left - dxy.x;\r\n        this.offset({\r\n          top, left,\r\n        });\r\n        evt2.stopPropagation();\r\n      });\r\n      evt1.stopPropagation();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 设置显示位置\r\n   */\r\n  dragPanelLocation() {\r\n    const root = this.getRootWidget();\r\n    const { options } = this;\r\n    const { position } = options;\r\n    const rootBox = root.box();\r\n    const elemBox = this.box();\r\n    switch (position) {\r\n      case DragPanel.DRAG_PANEL_POSITION.LEFT:\r\n        break;\r\n      case DragPanel.DRAG_PANEL_POSITION.RIGHT:\r\n        break;\r\n      case DragPanel.DRAG_PANEL_POSITION.TOP:\r\n        break;\r\n      case DragPanel.DRAG_PANEL_POSITION.CENTER:\r\n        this.offset({\r\n          left: rootBox.width / 2 - elemBox.width / 2,\r\n          top: rootBox.height / 2 - elemBox.height / 2,\r\n        });\r\n        break;\r\n      default: break;\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 添加子元素\r\n   * @param args\r\n   * @returns {DragPanel}\r\n   */\r\n  childrenNodes(...args) {\r\n    this.content.childrenNodes(...args);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 销毁组件\r\n   */\r\n  destroy() {\r\n    super.destroy();\r\n    this.unbind();\r\n    DragPanel.removeInstance(this);\r\n  }\r\n\r\n  /**\r\n   * 删除实例\r\n   * @param instance\r\n   */\r\n  static removeInstance(instance) {\r\n    const filter = [];\r\n    instances.forEach((item) => {\r\n      if (item !== instance) {\r\n        filter.push(item);\r\n      }\r\n    });\r\n    instances = filter;\r\n  }\r\n\r\n  /**\r\n   * 关闭所有实例\r\n   * @param filter\r\n   */\r\n  static closeAll(filter = []) {\r\n    instances.forEach((item) => {\r\n      if (filter.indexOf(item) === -1) {\r\n        item.close();\r\n      }\r\n    });\r\n  }\r\n\r\n}\r\n\r\nDragPanel.DRAG_PANEL_POSITION = {\r\n  LEFT: 1,\r\n  TOP: 2,\r\n  RIGHT: 3,\r\n  CENTER: 4,\r\n};\r\n\r\nexport { DragPanel };\r\n","class DateUtils {\r\n\r\n  static dateFormat(fmt, date) {\r\n    if (!(date instanceof Date)) {\r\n      return date;\r\n    }\r\n    const o = {\r\n      'M+': date.getMonth() + 1,\r\n      'd+': date.getDate(),\r\n      'h+': date.getHours(),\r\n      'm+': date.getMinutes(),\r\n      's+': date.getSeconds(),\r\n      'q+': Math.floor((date.getMonth() + 3) / 3),\r\n      S: date.getMilliseconds(),\r\n    };\r\n    const reYear = /(y+)/;\r\n    const resultYear = reYear.exec(fmt);\r\n    if (resultYear) {\r\n      const yearFormatPart = resultYear[0];\r\n      const yearVal = (date.getFullYear().toString()).substr(4 - yearFormatPart.length);\r\n      fmt = fmt.replace(yearFormatPart, yearVal);\r\n    }\r\n    // eslint-disable-next-line guard-for-in,no-restricted-syntax\r\n    for (const k in o) {\r\n      const re = new RegExp(`(${k})`);\r\n      const res = re.exec(fmt);\r\n      if (res) {\r\n        const Val = o[k].toString();\r\n        const formatPart = res[0];\r\n        const replaceVal = (formatPart.length === 1) ? (Val) : ((`00${Val}`).substr(Val.length));\r\n        fmt = fmt.replace(formatPart, replaceVal);\r\n      }\r\n    }\r\n    return fmt;\r\n  }\r\n\r\n  static parse(text) {\r\n    let result = text;\r\n    if (result instanceof Date) {\r\n      return result;\r\n    }\r\n\r\n    result = DateUtils.parserToDate(text, 'yyyy/MM/dd');\r\n    if (result) {\r\n      return result;\r\n    }\r\n    result = DateUtils.parserToDate(text, 'MM/dd');\r\n    if (result) {\r\n      return result;\r\n    }\r\n    result = DateUtils.parserToDate(text, 'yyyy/MM/dd hh:mm:ss');\r\n    if (result) {\r\n      return result;\r\n    }\r\n\r\n    result = DateUtils.parserToDate(text, 'yyyy-MM-dd');\r\n    if (result) {\r\n      return result;\r\n    }\r\n    result = DateUtils.parserToDate(text, 'MM-dd');\r\n    if (result) {\r\n      return result;\r\n    }\r\n    result = DateUtils.parserToDate(text, 'yyyy-MM-dd hh:mm:ss');\r\n    if (result) {\r\n      return result;\r\n    }\r\n\r\n    result = DateUtils.parserToDate(text, 'hh:mm:ss');\r\n    if (result) {\r\n      return result;\r\n    }\r\n\r\n    result = DateUtils.parserToDate(text, 'yyyy年MM月');\r\n    if (result) {\r\n      return result;\r\n    }\r\n    result = DateUtils.parserToDate(text, 'MM月dd日');\r\n    if (result) {\r\n      return result;\r\n    }\r\n    result = DateUtils.parserToDate(text, 'yyyy年MM月dd日 hh:mm:ss');\r\n    if (result) {\r\n      return result;\r\n    }\r\n\r\n    return text;\r\n  }\r\n\r\n  static parserToDate(dateText, format) {\r\n    if (!dateText) {\r\n      return null;\r\n    }\r\n    const defaultVal = new Date('1970/01/01 00:00:00');\r\n    const o = [{\r\n      reg: 'y+',\r\n    }, {\r\n      reg: 'M+',\r\n    }, {\r\n      reg: 'd+',\r\n    }, {\r\n      reg: 'h+',\r\n    }, {\r\n      reg: 'm+',\r\n    }, {\r\n      reg: 's+',\r\n    }, {\r\n      reg: 'S',\r\n    }];\r\n    let year = defaultVal.getFullYear();\r\n    let month = defaultVal.getMonth() + 1;\r\n    let day = defaultVal.getDate();\r\n    let hours = defaultVal.getHours();\r\n    let minutes = defaultVal.getMinutes();\r\n    let seconds = defaultVal.getSeconds();\r\n    let milliseconds = defaultVal.getMilliseconds();\r\n    let index = 1;\r\n    for (let j = 0; j < format.length; j += 1) {\r\n      const oneChar = format[j];\r\n      for (let i = 0; i < o.length; i += 1) {\r\n        const onePart = o[i];\r\n        const onePartReg = onePart.reg;\r\n        if (onePartReg[0] === oneChar) {\r\n          if (!onePart.index) {\r\n            onePart.index = index;\r\n            index += 1;\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    for (let i = 0; i < o.length; i += 1) {\r\n      const onePart = o[i];\r\n      const onePartReg = onePart.reg;\r\n      const re = new RegExp(`(${onePartReg})`);\r\n      const res = re.exec(format);\r\n      if (res) {\r\n        const formatPart = res[0];\r\n        const replaceVal = `([0-9]{1,${formatPart.length}})`;\r\n        // eslint-disable-next-line no-param-reassign\r\n        format = format.replace(formatPart, replaceVal);\r\n      }\r\n    }\r\n    const dataInfo = {};\r\n    const re = new RegExp(format);\r\n    const res = re.exec(dateText);\r\n    if (res) {\r\n      for (let i = 1; i < res.length; i += 1) {\r\n        dataInfo[i] = res[i];\r\n      }\r\n    } else {\r\n      return null;\r\n    }\r\n    if (o[0].index) {\r\n      const { index } = o[0];\r\n      year = dataInfo[index];\r\n    }\r\n    if (o[1].index) {\r\n      const { index } = o[1];\r\n      month = dataInfo[index];\r\n    }\r\n    if (o[2].index) {\r\n      const { index } = o[2];\r\n      day = dataInfo[index];\r\n    }\r\n    if (o[3].index) {\r\n      const { index } = o[3];\r\n      hours = dataInfo[index];\r\n    }\r\n    if (o[4].index) {\r\n      const { index } = o[4];\r\n      minutes = dataInfo[index];\r\n    }\r\n    if (o[5].index) {\r\n      const { index } = o[5];\r\n      seconds = dataInfo[index];\r\n    }\r\n    if (o[6].index) {\r\n      const { index } = o[6];\r\n      milliseconds = dataInfo[index];\r\n    }\r\n    return new Date(year, month - 1, day, hours, minutes, seconds, milliseconds);\r\n  }\r\n\r\n}\r\n\r\nexport { DateUtils };\r\n","/* global navigator document window self */\nfunction S4() {\n  // eslint-disable-next-line no-bitwise\n  return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\n}\n\nconst alphabets = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];\n\nconst DATA_TYPE = {\n  String: 1,\n  Boolean: 2,\n  Number: 3,\n  Object: 4,\n  Array: 5,\n  Function: 6,\n  Null: 7,\n  Undefined: 8,\n  Promise: 9,\n  GeneratorFunction: 10,\n  AsyncFunction: 11,\n  BigInt: 12,\n  Symbol: 13,\n  DedicatedWorkerGlobalScope: 14,\n  Date: 15,\n  RegExp: 16,\n  Un: 0,\n};\n\nclass SheetUtils {\n\n  static isWindows() {\n    return /windows|win32/i.test(navigator.userAgent);\n  }\n\n  static isMac() {\n    return /macintosh|mac os x/i.test(navigator.userAgent);\n  }\n\n  static isNotEmptyObject(object) {\n    return !SheetUtils.isEmptyObject(object);\n  }\n\n  static isEmptyObject(object) {\n    // eslint-disable-next-line no-restricted-syntax\n    for (const key in object) {\n      // eslint-disable-next-line no-prototype-builtins\n      if (object.hasOwnProperty(key)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  static isUnDef(e) {\n    return e === undefined || e === null;\n  }\n\n  static isDef(e) {\n    return !this.isUnDef(e);\n  }\n\n  static isNumber(e) {\n    return /^(-?\\d+.\\d+)$|^(-?\\d+)$/.test(e);\n  }\n\n  static isFraction(e) {\n    return /^\\d+\\/\\d+$/.test(e);\n  }\n\n  static isDate(e) {\n    return SheetUtils.type(e) === DATA_TYPE.Date;\n  }\n\n  static isFunction(e) {\n    const type = SheetUtils.type(e);\n    return type === DATA_TYPE.Function;\n  }\n\n  static isArray(e) {\n    return SheetUtils.type(e) === DATA_TYPE.Array;\n  }\n\n  static isObject(e) {\n    return SheetUtils.type(e) === DATA_TYPE.Object;\n  }\n\n  static isRegExp(e) {\n    return SheetUtils.type(e) === DATA_TYPE.EX;\n  }\n\n  static isLikeArray(e) {\n    if (SheetUtils.isUnDef(e)) {\n      return false;\n    }\n    return typeof e.length === 'number';\n  }\n\n  static isBlank(s) {\n    if (SheetUtils.isUnDef(s)) {\n      return true;\n    }\n    return s.toString().trim() === '';\n  }\n\n  static isPlainObject(obj) {\n    if (SheetUtils.isUnDef(obj)) {\n      return false;\n    }\n    return Object.getPrototypeOf(obj) === Object.getPrototypeOf({});\n  }\n\n  static isString(obj) {\n    return SheetUtils.type(obj) === DATA_TYPE.String;\n  }\n\n  static isChildType(obj, parent) {\n    return obj instanceof parent;\n  }\n\n  static toLowCase(str) {\n    return str.toLowerCase();\n  }\n\n  static type(arg) {\n    const type = Object.prototype.toString.call(arg);\n    switch (type) {\n      case '[object Null]':\n        return DATA_TYPE.Null;\n      case '[object Object]':\n        return DATA_TYPE.Object;\n      case '[object Undefined]':\n        return DATA_TYPE.Undefined;\n      case '[object String]':\n        return DATA_TYPE.String;\n      case '[object Boolean]':\n        return DATA_TYPE.Boolean;\n      case '[object Number]':\n        return DATA_TYPE.Number;\n      case '[object Function]':\n        return DATA_TYPE.Function;\n      case '[object Array]':\n        return DATA_TYPE.Array;\n      case '[object Promise]':\n        return DATA_TYPE.Promise;\n      case '[object GeneratorFunction]':\n        return DATA_TYPE.GeneratorFunction;\n      case '[object AsyncFunction]':\n        return DATA_TYPE.AsyncFunction;\n      case '[object BigInt]':\n        return DATA_TYPE.BigInt;\n      case '[object Symbol]':\n        return DATA_TYPE.Symbol;\n      case '[object Date]':\n        return DATA_TYPE.Date;\n      case '[object DedicatedWorkerGlobalScope]':\n        return DATA_TYPE.DedicatedWorkerGlobalScope;\n      default:\n        return DATA_TYPE.Un;\n    }\n  }\n\n  static copy(object = {}, ...sources) {\n    if (SheetUtils.isUnDef(object)) {\n      return {};\n    }\n    if (SheetUtils.isUnDef(sources) || sources.length === 0) {\n      return object;\n    }\n    sources.forEach((source) => {\n      if (SheetUtils.isUnDef(source)) return;\n      Object.keys(source).forEach((key) => {\n        const v = source[key];\n        if (typeof v === 'string' || typeof v === 'number' || typeof v === 'boolean') {\n          object[key] = v;\n        } else if (typeof v !== 'function' && !Array.isArray(v) && SheetUtils.isPlainObject(v)) {\n          object[key] = object[key] || {};\n          SheetUtils.copy(object[key], v);\n        } else if (v) {\n          object[key] = v;\n        }\n      });\n    });\n    return object;\n  }\n\n  static cloneDeep(object) {\n    const json = JSON.stringify(object);\n    return JSON.parse(json);\n  }\n\n  static extends(target, ...src) {\n    for (let i = 0, len = src.length; i < len; i++) {\n      const item = src[i];\n      for (let key in item) {\n        if (item.hasOwnProperty(key)) {\n          const value = item[key];\n          if (SheetUtils.isDef(value)) {\n            target[key] = value;\n          }\n        }\n      }\n    }\n    return target;\n  }\n\n  static sum(objOrAry, cb = (value) => value) {\n    let total = 0;\n    let size = 0;\n    Object.keys(objOrAry).forEach((key) => {\n      total += cb(objOrAry[key], key);\n      size += 1;\n    });\n    return [total, size];\n  }\n\n  static parseFloat(val) {\n    if (SheetUtils.isNumber(val)) return parseFloat(val);\n    return 0;\n  }\n\n  static parseInt(val) {\n    if (SheetUtils.isNumber(val)) return parseInt(val, 10);\n    return 0;\n  }\n\n  static stringAt(index) {\n    let str = '';\n    let idx = index;\n    while (idx >= alphabets.length) {\n      idx /= alphabets.length;\n      idx -= 1;\n      str += alphabets[parseInt(idx, 10) % alphabets.length];\n    }\n    const last = index % alphabets.length;\n    str += alphabets[last];\n    return str;\n  }\n\n  static indexAt(str) {\n    let ret = 0;\n    for (let i = 0; i < str.length - 1; i += 1) {\n      const idx = str.charCodeAt(i) - 65;\n      const expoNet = str.length - 1 - i;\n      ret += (alphabets.length ** expoNet) + (alphabets.length * idx);\n    }\n    ret += str.charCodeAt(str.length - 1) - 65;\n    return ret;\n  }\n\n  static expr2xy(src) {\n    let x = '';\n    let y = '';\n    for (let i = 0; i < src.length; i += 1) {\n      if (src.charAt(i) >= '0' && src.charAt(i) <= '9') {\n        y += src.charAt(i);\n      } else {\n        x += src.charAt(i);\n      }\n    }\n    return [SheetUtils.indexAt(x), parseInt(y, 10) - 1];\n  }\n\n  static xy2expr(x, y) {\n    return `${SheetUtils.stringAt(x)}${y + 1}`;\n  }\n\n  static expr2expr(src, xn, yn) {\n    const [x, y] = SheetUtils.expr2xy(src);\n    return SheetUtils.xy2expr(x + xn, y + yn);\n  }\n\n  static minIf(v, min) {\n    if (v < min) return min;\n    return v;\n  }\n\n  static keepLastIndex(obj) {\n    const range = window.getSelection();\n    range.selectAllChildren(obj);\n    range.collapseToEnd();\n  }\n\n  static trim(s) {\n    if (this.isBlank(s)) return '';\n    return s.trim();\n  }\n\n  static now() {\n    return Date.now().toString();\n  }\n\n  static viewPort() {\n    return {\n      width: window.innerWidth,\n      height: window.innerHeight,\n    };\n  }\n\n  static exitFullscreen() {\n    if (document.exitFullscreen) {\n      document.exitFullscreen();\n    } else if (document.msExitFullscreen) {\n      document.msExitFullscreen();\n    } else if (document.mozCancelFullScreen) {\n      document.mozCancelFullScreen();\n    } else if (document.webkitExitFullscreen) {\n      document.webkitExitFullscreen();\n    }\n  }\n\n  static fullScreen(element) {\n    if (element.el) {\n      element = element.el;\n    }\n    if (element.requestFullscreen) {\n      element.requestFullscreen();\n    } else if (element.msRequestFullscreen) {\n      element.msRequestFullscreen();\n    } else if (element.mozRequestFullScreen) {\n      element.mozRequestFullScreen();\n    } else if (element.webkitRequestFullscreen) {\n      element.webkitRequestFullscreen();\n    }\n  }\n\n  static isFull() {\n    return !!(document.webkitIsFullScreen || document.mozFullScreen\n      || document.msFullscreenElement || document.fullscreenElement);\n  }\n\n  static uuid() {\n    return (`${S4() + S4()}${S4()}${S4()}${S4()}${S4()}${S4()}${S4()}`);\n  }\n\n  static equals(one, tow) {\n    function diffValue(oneValue, towValue) {\n      const oneType = SheetUtils.type(oneValue);\n      const towType = SheetUtils.type(towValue);\n      if (oneType !== towType) {\n        return false;\n      }\n      if (SheetUtils.isArray(oneValue)) {\n        return diffArrays(oneValue, towValue);\n      }\n      if (SheetUtils.isObject(oneValue)) {\n        return diffObject(oneValue, towValue);\n      }\n      if (SheetUtils.isDate(oneValue)) {\n        return oneValue.getTime() === towValue.getTime();\n      }\n      if (SheetUtils.isRegExp(oneValue)) {\n        return oneValue.toString() === towValue.toString();\n      }\n      return oneValue === towValue;\n    }\n    function diffArrays(one, tow) {\n      if (one.length !== tow.length) {\n        return false;\n      }\n      for (let i = 0, len = one.length; i < len; i++) {\n        const oneValue = one[i];\n        const towValue = tow[i];\n        if (!diffValue(oneValue, towValue)) {\n          return false;\n        }\n      }\n      return true;\n    }\n    function diffObject(one, tow) {\n      const oneKeys = Object.keys(one);\n      const towKeys = Object.keys(tow);\n      if (oneKeys.length !== towKeys.length) {\n        return false;\n      }\n      for (const key of oneKeys) {\n        if (!towKeys.includes(key)) {\n          return false;\n        }\n        const oneValue = one[key];\n        const towValue = tow[key];\n        if (!diffValue(oneValue, towValue)) {\n          return false;\n        }\n      }\n      return true;\n    }\n    return diffValue(one, tow);\n  }\n\n  static toFixed(num, fixed) {\n    if (num.toString().indexOf('.') > -1) {\n      return num.toFixed(fixed);\n    }\n    return num;\n  }\n\n  static getExplorerInfo() {\n    const explorer = window.navigator.userAgent.toLowerCase();\n    // firefox\n    if (explorer.indexOf('firefox') >= 0) {\n      const ver = explorer.match(/firefox\\/([\\d.]+)/)[1];\n      return { type: 'Firefox', version: ver };\n    }\n    // Chrome\n    if (explorer.indexOf('chrome') >= 0) {\n      const ver = explorer.match(/chrome\\/([\\d.]+)/)[1];\n      return { type: 'Chrome', version: ver };\n    }\n    // Opera\n    if (explorer.indexOf('opera') >= 0) {\n      const ver = explorer.match(/opera.([\\d.]+)/)[1];\n      return { type: 'Opera', version: ver };\n    }\n    // Safari\n    if (explorer.indexOf('safari') >= 0) {\n      const ver = explorer.match(/version\\/([\\d.]+)/)[1];\n      return { type: 'Safari', version: ver };\n    }\n    // ie\n    if (explorer.indexOf('msie') >= 0) {\n      const ver = explorer.match(/msie ([\\d.]+)/)[1];\n      return { type: 'IE', version: ver };\n    }\n    // undefined\n    return undefined;\n  }\n\n  static arrayLast(array) {\n    return array[array.length - 1];\n  }\n\n  static arrayHead(array) {\n    return array[0];\n  }\n\n  static blankClear(value) {\n    if (SheetUtils.isString(value)) {\n      return value.replace(/\\s*/g, SheetUtils.EMPTY);\n    }\n    return value;\n  }\n\n  static newArray(array) {\n    if (array) {\n      return [].concat(array);\n    }\n    return [];\n  }\n\n  static safeValue(value, defaultValue = '') {\n    return SheetUtils.isUnDef(value) ? defaultValue : value;\n  }\n\n  static inWorker() {\n    // eslint-disable-next-line no-restricted-globals\n    const type = SheetUtils.type(self);\n    return type === DATA_TYPE.DedicatedWorkerGlobalScope;\n  }\n\n  static if(condition, establish, otherwise) {\n    return condition ? establish() : otherwise();\n  }\n\n  static slice(likeArray) {\n    return Array.prototype.slice.call(likeArray);\n  }\n\n  static clearBlank(str) {\n    return str ? str.replace(/\\s/g, '') : str;\n  }\n\n  static clearHideCode(str) {\n    let result = '';\n    for (let i = 0; i < str.length; i++) {\n      let value = str.charAt(i);\n      // 过滤掉 &#xFEFF; 隐藏字符串\n      // 服了 ！！！！！\n      let code = encodeURI(value);\n      if (code !== '%EF%BB%BF') {\n        result += value;\n      }\n    }\n    return result;\n  }\n\n}\n\nSheetUtils.EMPTY = '';\nSheetUtils.Nul = null;\nSheetUtils.Undef = undefined;\nSheetUtils.noop = () => {};\nSheetUtils.DATA_TYPE = DATA_TYPE;\n\nexport {\n  SheetUtils,\n};\n"],"names":["cssPrefix","Constant","CHANGE_ACTIVE","REMOVE_SHEET","MOUSE_MOVE","MOUSE_DOWN","CONTEXT_MENU","SCROLL","RESIZE","MOUSE_UP","INPUT","KEY_DOWN","KEY_UP","MOUSE_OVER","MOUSE_LEAVE","MOUSE_WHEEL","MOUSE_ENTER","CLICK","FOCUS","BLUR","DRAG_START","CHANGE","VISIBILITY_CHANGE","RENDER","SNAPSHOT_CHANGE","CHANGE_ROW_HEIGHT","CHANGE_COL_WIDTH","SCALE_CHANGE","EDIT_START","EDIT_INPUT","EDIT_FINISH","REMOVE_ROW","REMOVE_COL","ADD_NEW_ROW","ADD_NEW_COL","FIXED_CHANGE","FIXED_COL_CHANGE","FIXED_ROW_CHANGE","SELECT_OVER","SELECT_DOWN","SELECT_CHANGE","DATA_CHANGE","RESIZE_CHANGE","SEARCH_INPUT_CHANGE","PLAIN_INPUT_CHANGE","FORM_SELECT_CHANGE","format","default","value","this","text","number","fraction","left","split","right","eNotation","toExponential","decimal","indexOf","toString","substring","percentage","rmb","hk","dollar","time","result","date1","date2","date3","date4","date5","type","zIndexID","Border","static","constructor","widthType","width","color","zIndex","display","priority","border","origin","target","setColor","getZIndex","setDisplay","setType","setZIndex","setWidthType","clone","equal","Cell","borderAttr","fontAttr","richText","formula","background","custom","icons","ruler","contentWidth","contentHeight","contentType","TYPE","STRING","formatText","setContentType","setIcons","setText","setExpr","setRich","setRuler","setContentWidth","setContentHeight","setRichText","rich","expr","getExpr","setFormat","NUMBER","DATE_TIME","parse","RICH_TEXT","isEmpty","getComputeText","hasFormula","hasExpr","getFormatText","getValue","setFontAttr","attr","setBorderAttr","cloneStyle","toJSON","height","setTextWrap","textWrap","setFontColor","setRichFontColor","each","i","setFontSize","size","setRichFontSize","setFontBold","bold","setRichFontBold","setFontItalic","italic","setRichFontItalic","setFontName","name","setRichFontName","setUnderLine","underline","setRichUnderLine","setStrikeLine","strikeline","strikethrough","setRichStrikeLine","setFontAngle","angle","direction","updateMaxIndex","setFontDirection","setBackground","setFontAlign","align","setFontVerticalAlign","verticalAlign","CellBorder","bottom","top","hasDouble","isDisplay","setAllDisplay","setBDisplay","setLDisplay","setTDisplay","setRDisplay","setAllColor","setBColor","setLColor","setTColor","setRColor","setAllWidthType","setBWidthType","setLWidthType","setTWidthType","setRWidthType","setAllType","setBType","setLType","setTType","setRType","EMPTY","getInstance","config","CellFont","padding","like","other","keys1","Object","keys","keys2","key","includes","src","val","reset","equals","RichFont","scaleAdapter","plain","option","v","ignore","RichFonts","map","font","R","cb","forEach","getRich","push","hasLength","length","item1","item2","join","XIcon","instances","icon","vertical","ICON_VERTICAL","CENTER","horizontal","ICON_HORIZONTAL","RIGHT","ICON_TYPE","image","iconFocus","offset","x","y","onDraw","onLeave","onMove","onDown","onEnter","rect","position","iconHorizontal","iconVertical","iconOffsetX","iconOffsetY","iconWidth","iconHeight","rectX","rectY","rectWidth","rectHeight","px","py","LEFT","TOP","BOTTOM","loadImage","load","sync","Image","loadImg","complete","onload","onerror","console","error","draw","drawIcon","drawImage","drawCustom","positionRect","include","includeRect","crop","open","fillStyle","fillRect","close","eventHandle","native","location","inRectPosition","activate","ICON_EVENT_TYPE","includePoint","setActivate","setOnDraw","callback","setOnDown","setOnMove","setOnEnter","setOnLeave","setFocus","newInstances","XIconOffset","Icon","className","super","iconNameEl","h","childrenNodes","setWidth","css","setHeight","Crop","save","clip","beginPath","restore","LINE_TYPE","SOLID_LINE","DOTTED_LINE","POINT_LINE","DOUBLE_LINE","DoubleLine","spacing","leftShow","topShow","rightShow","bottomShow","iFMerge","iFMergeFirstRow","iFMergeLastRow","iFMergeFirstCol","iFMergeLastCol","handleExternal","sx","sy","ex","ey","row","col","pos","external","ifMerge","firstRow","lastRow","firstCol","lastCol","sTopLeftCorner","sTop","sBottom","eBottomLeftCorner","eBottom","eTop","sLeft","sRight","eTopRightCorner","eRight","eLeft","sTopRightCorner","eBottomRightCorner","sBottomLeftCorner","handleInternal","internal","horizonLine","setLineColor","setLineWidthType","setLineDash","verticalLine","tiltingLine","Rect","disjoint","expandSize","DPR","devicePixelRatio","LINE_WIDTH_LOW","Math","round","LINE_WIDTH_MEDIUM","LINE_WIDTH_HIGH","LINE_PIXEL_OFFSET","Base","dpr","srcPx","stylePx","ceil","trunc","PI","canvas","ctx","getContext","options","hasOwnProperty","String","trim","resize","style","Wrapping","dash","measureText","fill","scale","translate","rotate","deg","Extends","polyStroke","interpolation","xys","moveTo","len","lineTo","stroke","polyInFill","fullRect","radian","Position","offsetX","offsetY","getOffsetX","getOffsetY","fillText","TypeError","BaseLine","line","linePx","pixel","lineWidth","CorsLine","LINE_WIDTH_TYPE","medium","low","high","lineWidthType","lineColor","corsLine","strokeStyle","XDraw","fillPath","path","points","w","copyImage","sw","sh","tx","ty","tw","th","el","BaseFont","getAlignPadding","ALIGN","center","getVerticalAlignPadding","VERTICAL_ALIGN","TEXT_WRAP","OVER_FLOW","WORD_WRAP","TRUNCATE","TEXT_DIRECTION","HORIZONTAL","VERTICAL","ANGLE","ANGLE_BAR","DEFAULT_FONT_ATTR","DEFAULT_RICH_ATTR","DEFAULT_RICH_ITEM_ATTR","Functions","functions","remove","getFunction","toLocaleString","register","func","Assembly","assembly","getInstruct","endsWith","writeOperand","writeOperator","op","writeString","writeNumber","Tokenizer","syntaxCheck","lexical","input","OPERATOR","NUMBERS","SPACE","LETTERS","bracketsStack","current","tokens","char","test","next","last","brackets","pop","syntax","sQuotesStack","dQuotesStack","callStack","arrayStack","ignoreArray","token","ignoreFunc","skipIgnoreToken","dir","index","checkArray","local","checkValue","checkOperator","checkFunction","Compiler","writer","groupStack","opIf","opAdd","opMul","opCommon","opRel","opNew","array","opCell","function","eofToken","nextToken","backToken","reduceGroup","increaseGroup","popGroup","addGroup","isSkipNextToken","compile","compileIfge","compileAdd","operator","compileMul","compileCommon","compileRel","compileArray","compileFunction","compilePushValue","Evaluation","instruct","memory","eval","newArray","invoke","pushSRegexp","pushNRegexp","pushORegexp","ificmpge","ificmpgt","ifge","ifgt","ifeq","ifne","add","sub","mul","div","mod","power","rel","link","uni","common","group","pushS","pushN","pushO","parseFloat","b","a","item","reverse","apply","Compile","startsWith","tokenizer","Instruct","inst","Formula","content","Element","object","HTMLCollection","NodeList","elements","document","createTextNode","replace","toLowerCase","tag","createElement","data","undefined","children","args","arguments","wrapElement","ele","append","childNodes","childrenNodesAppend","isTextNode","childrenNodesPrepend","prepend","k","offsetTop","offsetLeft","offsetHeight","offsetWidth","parent","parentNode","addClass","classList","hasClass","contains","hasChildElement","hasChild","removeClass","box","getBoundingClientRect","first","firstChild","lastChild","firstTextNode","find","handle","elem","lastTextNode","removeChild","prev","previousSibling","nextSibling","active","flag","cls","nodeValue","innerText","html","innerHTML","focus","blur","removeAttr","removeAttribute","setAttribute","getAttribute","get","cssRemoveKeys","removeProperty","hyphenateRE","cssRemoveVal","property","newValue","getPropertyValue","setProperty","computedStyle","window","getComputedStyle","show","hide","trigger","message","evt","MouseEvent","detail","bubbles","cancelable","initEvent","dispatchEvent","CustomEvent","select","querySelectorAll","finds","sibling","previousElementSibling","nextElementSibling","tagName","nodeName","toLocaleLowerCase","nodeType","after","before","cloneNode","empty","is","isBreakNode","isDocumentFragment","DocumentFragment","Life","onAttach","Widget","$$rootFlag","parentWidget","attach","widget","unbind","bind","eventXy","event","clientY","clientX","destroy","closestClass","clazz","node","body","getRootBox","getRootWidget","relativeBox","root","thisBox","rootBox","pool","removeEventListener","addEventListener","rem","eqElem","eqOpt","eqType","eqCall","multipleUnbind","eles","multipleBind","XEvent","fn","Array","isArray","holdFunc","endFunc","setInterval","xEvtUp","clearInterval","moveFunc","upFunc","xEvtMove","stopPropagation","preventDefault","WrapFuncion","doubleClick","lastPageX","lastPageY","lastTime","button","pageX","pageY","Date","now","mouseClick","ColorPicker","selectCb","dragPanel","preViewColorPoint","colorValueTips","colorInput","selectColorPoint","selectColorArea1","selectColorArea2","selectColorArea3","colorHuxTips","colorBar","colorBarPoint","cancelButton","selectButton","buttons","e1","hexColor","xy","colorBarBox","downHue","e2","moveHue","centerBox","downSelect","moveSelect","hsb","fixHsx","parseInt","s","rgb","hsbToRgb","r","g","hex","isRgb","parseRgb","rgbToHex","change","sliderPosition","colorBarPointBox","colorBarPointLeft","selectColorPointBox","selectColorPointLeft","selectColorPointTop","hueChange","colorValue","hsbToHex","areaColorValue","selectChange","max","min","hexToHsb","fixHex","o","hsx","isHex","hexToRgb","rgbToHsb","delta","t1","t2","t3","nr","match","defaultValue","ColorArray","colors","activeColor","setActiveByColor","findIndex","findItemByColor","setActive","clear","BLACK","NULL","WHITE","ColorItem","checkedIcon","DragPanel","DRAG_PANEL_POSITION","status","mask","dragPanelLocation","evt1","dxy","evt2","elemBox","removeInstance","instance","filter","DateUtils","fmt","date","getMonth","getDate","getHours","getMinutes","getSeconds","floor","S","getMilliseconds","resultYear","exec","yearFormatPart","yearVal","getFullYear","substr","res","RegExp","Val","formatPart","replaceVal","parserToDate","dateText","defaultVal","reg","year","month","day","hours","minutes","seconds","milliseconds","j","oneChar","onePart","onePartReg","dataInfo","S4","random","alphabets","DATA_TYPE","Boolean","Number","Function","Null","Undefined","Promise","GeneratorFunction","AsyncFunction","BigInt","Symbol","DedicatedWorkerGlobalScope","Un","SheetUtils","navigator","userAgent","isEmptyObject","e","isUnDef","EX","obj","getPrototypeOf","str","arg","prototype","call","sources","source","isPlainObject","copy","json","JSON","stringify","isDef","objOrAry","total","isNumber","idx","ret","charCodeAt","expoNet","charAt","indexAt","stringAt","xn","yn","expr2xy","xy2expr","range","getSelection","selectAllChildren","collapseToEnd","isBlank","innerWidth","innerHeight","exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","element","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","webkitIsFullScreen","mozFullScreen","msFullscreenElement","fullscreenElement","one","tow","diffValue","oneValue","towValue","diffArrays","isObject","oneKeys","towKeys","diffObject","isDate","getTime","isRegExp","num","fixed","toFixed","explorer","version","isString","concat","self","condition","establish","otherwise","likeArray","slice","encodeURI","Nul","Undef","noop"],"sourceRoot":""}