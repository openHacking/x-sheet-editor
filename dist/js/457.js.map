{"version":3,"file":"js/457.js","mappings":"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","sources":["webpack://x-sheet/./src/core/table/merges/Merges.js","webpack://x-sheet/./src/core/table/snapshot/Snapshot.js","webpack://x-sheet/./src/core/table/tablebase/RangeTree.js","webpack://x-sheet/./src/core/table/tablebase/RectRange.js","webpack://x-sheet/./src/core/table/tablecell/Cells.js","webpack://x-sheet/./src/lib/Listen.js","webpack://x-sheet/./src/lib/recttree/QkSelect.js","webpack://x-sheet/./src/lib/recttree/RectTree.js","webpack://x-sheet/./src/utils/RtreeUtils.js"],"sourcesContent":["import { RectRange } from '../tablebase/RectRange';\r\nimport { Snapshot } from '../snapshot/Snapshot';\r\nimport { RangeTree } from '../tablebase/RangeTree';\r\nimport { RtreeUtils } from '../../../utils/RtreeUtils';\r\n\r\n/**\r\n * Merges\r\n */\r\nclass Merges extends RangeTree {\r\n\r\n  /**\r\n     * Merges 合并区域管理\r\n     */\r\n  constructor({\r\n    snapshot = new Snapshot(),\r\n    merges = [],\r\n  } = {}) {\r\n    super({ snapshot });\r\n    merges.map((merge) => RectRange.valueOf(merge)).forEach((view) => this.add(view));\r\n  }\r\n\r\n  /**\r\n   * 获取矩形的json数据\r\n   */\r\n  getData() {\r\n    return {\r\n      merges: this.getAll().map((range) => range.toString()),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 删除行号\r\n   * @param ri\r\n   * @param number\r\n   */\r\n  removeRow(ri, number) {\r\n    let { rTree, snapshot } = this;\r\n    let footRange = new RectRange(ri, 0, RangeTree.MAX_ROW, RangeTree.MAX_COL);\r\n    let fullRange = this.getFullRowRange(ri, number);\r\n    let fullBbox = RtreeUtils.rangeToBbox(fullRange);\r\n    let footBbox = RtreeUtils.rangeToBbox(footRange);\r\n    let divers = [];\r\n    let search = [];\r\n    let mergeAction = {\r\n      undo: () => {\r\n        let { length } = divers;\r\n        for (let i = 0; i < length; i++) {\r\n          const item = divers[i];\r\n          rTree.remove(item);\r\n        }\r\n        rTree.load(search);\r\n      },\r\n      redo: () => {\r\n        divers = [];\r\n        search = rTree.search(footBbox);\r\n        let { length } = search;\r\n        for (let i = 0; i < length; i++) {\r\n          const item = search[i];\r\n          const clone = { ...item };\r\n          rTree.remove(item);\r\n          if (clone.minY < fullBbox.minY) {\r\n            if (clone.maxY < fullBbox.maxY) {\r\n              let diffMax = clone.maxY - fullBbox.minY;\r\n              diffMax += 1;\r\n              clone.oldMax = clone.maxY;\r\n              clone.maxY -= diffMax;\r\n              clone.style = 'oddValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n              continue;\r\n            }\r\n            if (clone.maxY > fullBbox.maxY) {\r\n              let diffMax = fullBbox.maxY - footBbox.minY;\r\n              diffMax += 1;\r\n              clone.oldMax = clone.maxY;\r\n              clone.maxY -= diffMax;\r\n              clone.style = 'oddValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n              continue;\r\n            }\r\n            if (clone.maxY === fullBbox.maxY) {\r\n              let diffMax = fullBbox.maxY - footBbox.minY;\r\n              diffMax += 1;\r\n              clone.oldMax = clone.maxY;\r\n              clone.maxY -= diffMax;\r\n              clone.style = 'oddValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n              continue;\r\n            }\r\n          }\r\n          if (clone.minY > fullBbox.minY) {\r\n            if (clone.minY < fullBbox.maxY) {\r\n              if (clone.maxY > fullBbox.maxY) {\r\n                let diffMin = clone.minY - fullBbox.minY;\r\n                let diffMax = fullBbox.maxY - clone.minY;\r\n                diffMax += diffMin + 1;\r\n                clone.oldMax = clone.maxY;\r\n                clone.oldMin = clone.minY;\r\n                clone.maxY -= diffMax;\r\n                clone.minY -= diffMin;\r\n                clone.style = 'evenValue';\r\n                if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                  divers.push(clone);\r\n                }\r\n                continue;\r\n              }\r\n            }\r\n            if (clone.minY > fullBbox.maxY) {\r\n              let diffValue = fullBbox.maxY - fullBbox.minY;\r\n              diffValue += 1;\r\n              clone.oldMax = clone.maxY;\r\n              clone.oldMin = clone.minY;\r\n              clone.maxY -= diffValue;\r\n              clone.minY -= diffValue;\r\n              clone.style = 'evenValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n              continue;\r\n            }\r\n          }\r\n          if (clone.minY === fullBbox.minY) {\r\n            if (clone.maxY > fullBbox.maxY) {\r\n              let diffMax = fullBbox.maxY - clone.minY;\r\n              diffMax += 1;\r\n              clone.oldMax = clone.maxY;\r\n              clone.maxY -= diffMax;\r\n              clone.style = 'oddValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n            }\r\n          }\r\n        }\r\n        rTree.load(divers);\r\n      },\r\n    };\r\n    snapshot.addAction(mergeAction);\r\n    mergeAction.redo();\r\n  }\r\n\r\n  /**\r\n   * 删除列号\r\n   * @param ci\r\n   * @param number\r\n   */\r\n  removeCol(ci, number) {\r\n    let { rTree, snapshot } = this;\r\n    let footRange = new RectRange(0, ci, RangeTree.MAX_ROW, RangeTree.MAX_COL);\r\n    let fullRange = this.getFullColRange(ci, number);\r\n    let fullBbox = RtreeUtils.rangeToBbox(fullRange);\r\n    let footBbox = RtreeUtils.rangeToBbox(footRange);\r\n    let divers = [];\r\n    let search = [];\r\n    let mergeAction = {\r\n      undo: () => {\r\n        let { length } = divers;\r\n        for (let i = 0; i < length; i++) {\r\n          const item = divers[i];\r\n          rTree.remove(item);\r\n        }\r\n        rTree.load(search);\r\n      },\r\n      redo: () => {\r\n        divers = [];\r\n        search = rTree.search(footBbox);\r\n        let { length } = search;\r\n        for (let i = 0; i < length; i++) {\r\n          const item = search[i];\r\n          const clone = { ...item };\r\n          rTree.remove(item);\r\n          if (clone.minX < fullBbox.minX) {\r\n            if (clone.maxX < fullBbox.maxX) {\r\n              let diffMax = clone.maxX - fullBbox.minX;\r\n              diffMax += 1;\r\n              clone.oldMax = clone.maxX;\r\n              clone.maxX -= diffMax;\r\n              clone.style = 'oddValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n              continue;\r\n            }\r\n            if (clone.maxX > fullBbox.maxX) {\r\n              let diffMax = fullBbox.maxX - footBbox.minX;\r\n              diffMax += 1;\r\n              clone.oldMax = clone.maxX;\r\n              clone.maxX -= diffMax;\r\n              clone.style = 'oddValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n              continue;\r\n            }\r\n            if (clone.maxX === fullBbox.maxX) {\r\n              let diffMax = fullBbox.maxX - footBbox.minX;\r\n              diffMax += 1;\r\n              clone.oldMax = clone.maxX;\r\n              clone.maxX -= diffMax;\r\n              clone.style = 'oddValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n              continue;\r\n            }\r\n          }\r\n          if (clone.minX > fullBbox.minX) {\r\n            if (clone.minX < fullBbox.maxX) {\r\n              if (clone.maxX > fullBbox.maxX) {\r\n                let diffMin = clone.minX - fullBbox.minX;\r\n                let diffMax = fullBbox.maxX - clone.minX;\r\n                diffMax += diffMin + 1;\r\n                clone.oldMax = clone.maxX;\r\n                clone.oldMin = clone.minX;\r\n                clone.maxX -= diffMax;\r\n                clone.minX -= diffMin;\r\n                clone.style = 'evenValue';\r\n                if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                  divers.push(clone);\r\n                }\r\n                continue;\r\n              }\r\n            }\r\n            if (clone.minX > fullBbox.maxX) {\r\n              let diffValue = fullBbox.maxX - fullBbox.minX;\r\n              diffValue += 1;\r\n              clone.oldMax = clone.maxX;\r\n              clone.oldMin = clone.minX;\r\n              clone.maxX -= diffValue;\r\n              clone.minX -= diffValue;\r\n              clone.style = 'evenValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n              continue;\r\n            }\r\n          }\r\n          if (clone.minX === fullBbox.minX) {\r\n            if (clone.maxX > fullBbox.maxX) {\r\n              let diffMax = fullBbox.maxX - clone.minX;\r\n              diffMax += 1;\r\n              clone.oldMax = clone.maxX;\r\n              clone.maxX -= diffMax;\r\n              clone.style = 'oddValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n            }\r\n          }\r\n        }\r\n        rTree.load(divers);\r\n      },\r\n    };\r\n    snapshot.addAction(mergeAction);\r\n    mergeAction.redo();\r\n  }\r\n\r\n  /**\r\n   * 插入新列时调整区域大小和位置\r\n   * @param ci\r\n   * @param number\r\n   */\r\n  insertColAfter(ci, number) {\r\n    const { snapshot } = this;\r\n    const mergeAction = {\r\n      undo: () => {\r\n        this.colAfterShrink(ci, number);\r\n      },\r\n      redo: () => {\r\n        this.colAfterExpand(ci, number);\r\n      },\r\n    };\r\n    snapshot.addAction(mergeAction);\r\n    mergeAction.redo();\r\n  }\r\n\r\n  /**\r\n   * 插入新列时调整区域大小和位置\r\n   * @param ci\r\n   * @param number\r\n   */\r\n  insertColBefore(ci, number) {\r\n    const { snapshot } = this;\r\n    const mergeAction = {\r\n      undo: () => {\r\n        this.colBeforeShrink(ci, number);\r\n      },\r\n      redo: () => {\r\n        this.colBeforeExpand(ci, number);\r\n      },\r\n    };\r\n    snapshot.addAction(mergeAction);\r\n    mergeAction.redo();\r\n  }\r\n\r\n  /**\r\n   * 插入新行时调整区域大小和位置\r\n   * @param ri\r\n   * @param number\r\n   */\r\n  insertRowAfter(ri, number) {\r\n    const { snapshot } = this;\r\n    const mergeAction = {\r\n      undo: () => {\r\n        this.rowAfterShrink(ri, number);\r\n      },\r\n      redo: () => {\r\n        this.rowAfterExpand(ri, number);\r\n      },\r\n    };\r\n    snapshot.addAction(mergeAction);\r\n    mergeAction.redo();\r\n  }\r\n\r\n  /**\r\n   * 插入新行时调整区域大小和位置\r\n   * @param ri\r\n   * @param number\r\n   */\r\n  insertRowBefore(ri, number) {\r\n    const { snapshot } = this;\r\n    const mergeAction = {\r\n      undo: () => {\r\n        this.rowBeforeShrink(ri, number);\r\n      },\r\n      redo: () => {\r\n        this.rowBeforeExpand(ri, number);\r\n      },\r\n    };\r\n    snapshot.addAction(mergeAction);\r\n    mergeAction.redo();\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  Merges,\r\n};\r\n","/**\r\n * 数据快照\r\n */\r\nimport { Listen } from '../../../lib/Listen';\r\n\r\nclass Snapshot {\r\n\r\n  /**\r\n   * Snapshot\r\n   */\r\n  constructor() {\r\n    // 撤销\r\n    this.undoStack = [];\r\n    // 反撤销\r\n    this.redoStack = [];\r\n    // 当前记录层\r\n    this.layer = {\r\n      event: '',\r\n      data: [],\r\n    };\r\n    // 启用记录\r\n    this.apply = false;\r\n    // 数据监听\r\n    this.listen = new Listen();\r\n  }\r\n\r\n  /**\r\n   * 撤销\r\n   */\r\n  undo() {\r\n    const layer = this.undoStack.pop();\r\n    for (let i = layer.data.length - 1; i >= 0; i--) {\r\n      const action = layer.data[i];\r\n      action.undo();\r\n    }\r\n    this.redoStack.push(layer);\r\n    this.listen.execute('change', layer.event, 'undo');\r\n  }\r\n\r\n  /**\r\n   * 反撤销\r\n   */\r\n  redo() {\r\n    const layer = this.redoStack.pop();\r\n    for (let i = 0, len = layer.data.length; i < len; i++) {\r\n      const action = layer.data[i];\r\n      action.redo();\r\n    }\r\n    this.undoStack.push(layer);\r\n    this.listen.execute('change', layer.event, 'redo');\r\n  }\r\n\r\n  /**\r\n   * 打开快照\r\n   */\r\n  open() {\r\n    this.layer = {\r\n      event: '',\r\n      data: [],\r\n    };\r\n    this.apply = true;\r\n  }\r\n\r\n  /**\r\n   * 能否反撤销\r\n   * @returns {boolean}\r\n   */\r\n  canRedo() {\r\n    return this.redoStack.length > 0;\r\n  }\r\n\r\n  /**\r\n   * 能否撤销\r\n   * @returns {boolean}\r\n   */\r\n  canUndo() {\r\n    return this.undoStack.length > 0;\r\n  }\r\n\r\n  /**\r\n   * 关闭快照\r\n   */\r\n  close(event) {\r\n    if (this.layer.data.length) {\r\n      this.layer.event = event;\r\n      this.redoStack = [];\r\n      this.undoStack.push(this.layer);\r\n    }\r\n    this.layer = {\r\n      event: '',\r\n      data: [],\r\n    };\r\n    this.apply = false;\r\n    this.listen.execute('change', event, 'close');\r\n  }\r\n\r\n  /**\r\n   * 添加动作\r\n   * @param action\r\n   */\r\n  addAction(action = {\r\n    undo: () => {},\r\n    redo: () => {},\r\n  }) {\r\n    if (this.apply) {\r\n      this.layer.data.push(action);\r\n    }\r\n  }\r\n}\r\n\r\nexport {\r\n  Snapshot,\r\n};\r\n","import { Snapshot } from '../snapshot/Snapshot';\r\nimport { RectTree } from '../../../lib/recttree/RectTree';\r\nimport { Listen } from '../../../lib/Listen';\r\nimport { RtreeUtils } from '../../../utils/RtreeUtils';\r\nimport { SheetUtils } from '../../../utils/SheetUtils';\r\nimport { RectRange } from './RectRange';\r\n\r\n/**\r\n * RangeTree\r\n */\r\nclass RangeTree {\r\n\r\n  /**\r\n     * RangeTree 区域管理\r\n     */\r\n  constructor({\r\n    snapshot = new Snapshot(),\r\n  }) {\r\n    this.snapshot = snapshot;\r\n    this.rTree = new RectTree();\r\n    this.listen = new Listen();\r\n  }\r\n\r\n  /**\r\n     * 获取包含点的矩形区域\r\n     * @param ri\r\n     * @param ci\r\n     */\r\n  getFirstInclude(ri, ci) {\r\n    let { rTree } = this;\r\n    let bbox = {\r\n      minX: ci,\r\n      minY: ri,\r\n      maxX: ci,\r\n      maxY: ri,\r\n    };\r\n    let find = rTree.first(bbox);\r\n    if (find) {\r\n      return RtreeUtils.bboxToRange(find);\r\n    }\r\n    return SheetUtils.Undef;\r\n  }\r\n\r\n  /**\r\n   * 获取包含点的矩形区域\r\n   * @param ri\r\n   * @param ci\r\n   */\r\n  getMasterInclude(ri, ci) {\r\n    const find = this.getFirstInclude(ri, ci);\r\n    if (find.sri === ri) {\r\n      if (find.sci === ci) {\r\n        return find;\r\n      }\r\n    }\r\n    return SheetUtils.Undef;\r\n  }\r\n\r\n  /**\r\n     * 获取重合的区域\r\n     * @param rectRange\r\n     */\r\n  getIntersects(rectRange) {\r\n    let { rTree } = this;\r\n    let bbox = RtreeUtils.rangeToBbox(rectRange);\r\n    const array = rTree.search(bbox);\r\n    return array.map((bbox) => RtreeUtils.bboxToRange(bbox));\r\n  }\r\n\r\n  /**\r\n     * 添加矩形区域\r\n     * @param rectRange\r\n     */\r\n  push(rectRange) {\r\n    let { rTree } = this;\r\n    let bbox = RtreeUtils.rangeToBbox(rectRange);\r\n    rTree.insert(bbox);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n     * 删除矩形区域\r\n     * @param rectRange\r\n     */\r\n  shift(rectRange) {\r\n    let { rTree } = this;\r\n    let bbox = RtreeUtils.rangeToBbox(rectRange);\r\n    let array = rTree.search(bbox);\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let item = array[i];\r\n      rTree.remove(item);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n     * 添加矩形区域\r\n     * @param rectRange\r\n     */\r\n  add(rectRange) {\r\n    let { listen, snapshot } = this;\r\n    let action = {\r\n      undo: () => {\r\n        this.shift(rectRange);\r\n      },\r\n      redo: () => {\r\n        this.push(rectRange);\r\n        listen.execute('add', rectRange);\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  /**\r\n     * 删除矩形区域\r\n     * @param rectRange\r\n     */\r\n  delete(rectRange) {\r\n    let { listen, snapshot } = this;\r\n    let action = {\r\n      undo: () => {\r\n        this.push(rectRange);\r\n      },\r\n      redo: () => {\r\n        this.shift(rectRange);\r\n        listen.execute('delete', rectRange);\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  /**\r\n   * 删除矩形区域\r\n   * @param rectRanges\r\n   */\r\n  batchDelete(rectRanges) {\r\n    let { listen, snapshot } = this;\r\n    let action = {\r\n      undo: () => {\r\n        rectRanges.forEach((rectRange) => {\r\n          this.push(rectRange);\r\n        });\r\n      },\r\n      redo: () => {\r\n        rectRanges.forEach((rectRange) => {\r\n          this.shift(rectRange);\r\n        });\r\n        listen.execute('batchDelete', rectRanges);\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  /**\r\n     * 获取所有的矩形区域\r\n     */\r\n  getAll() {\r\n    let { rTree } = this;\r\n    return rTree.all().map((bbox) => RtreeUtils.bboxToRange(bbox));\r\n  }\r\n\r\n  /**\r\n     * 获取交叉矩形新区域\r\n     * @param rectRange\r\n     */\r\n  union(rectRange) {\r\n    let { rTree } = this;\r\n    let bbox = RtreeUtils.rangeToBbox(rectRange);\r\n    let array = rTree.search(bbox);\r\n    if (array.length === 0) {\r\n      return rectRange;\r\n    }\r\n    let clone = rectRange.clone();\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let range = RtreeUtils.bboxToRange(array[i]);\r\n      clone = clone.union(range);\r\n    }\r\n    if (!clone.equals(rectRange)) {\r\n      return this.union(clone);\r\n    }\r\n    return rectRange;\r\n  }\r\n\r\n  /**\r\n   * 获取整行区域\r\n   * @param ri\r\n   * @param number\r\n   * @returns {RectRange}\r\n   */\r\n  getFullRowRange(ri, number) {\r\n    return new RectRange(ri, 0, Math.max(ri, ri + number - 1), RangeTree.MAX_COL);\r\n  }\r\n\r\n  /**\r\n   * 获取整列区域\r\n   * @param ci\r\n   * @param number\r\n   * @returns {RectRange}\r\n   */\r\n  getFullColRange(ci, number) {\r\n    return new RectRange(0, ci, RangeTree.MAX_ROW, Math.max(ci, ci + number - 1));\r\n  }\r\n\r\n  /**\r\n     * 行扩展\r\n     * @param ri\r\n     * @param number\r\n     */\r\n  rowAfterExpand(ri, number) {\r\n    let bbox = {\r\n      minX: 0,\r\n      minY: ri,\r\n      maxX: RangeTree.MAX_COL,\r\n      maxY: RangeTree.MAX_ROW,\r\n    };\r\n    let { rTree } = this;\r\n    let array = rTree.search(bbox);\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let item = array[i];\r\n      rTree.remove(item);\r\n      if (item.minY > ri) {\r\n        item.minY += number;\r\n      }\r\n      if (item.maxY > ri) {\r\n        item.maxY += number;\r\n      }\r\n    }\r\n    rTree.load(array);\r\n  }\r\n\r\n  /**\r\n     * 列扩展\r\n     * @param ci\r\n     * @param number\r\n     */\r\n  colAfterExpand(ci, number) {\r\n    const bbox = {\r\n      minX: ci,\r\n      minY: 0,\r\n      maxX: RangeTree.MAX_COL,\r\n      maxY: RangeTree.MAX_ROW,\r\n    };\r\n    let { rTree } = this;\r\n    let array = rTree.search(bbox);\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let item = array[i];\r\n      rTree.remove(item);\r\n      if (item.minX > ci) {\r\n        item.minX += number;\r\n      }\r\n      if (item.maxX > ci) {\r\n        item.maxX += number;\r\n      }\r\n    }\r\n    rTree.load(array);\r\n  }\r\n\r\n  /**\r\n     * 行收缩\r\n     * @param ri\r\n     * @param number\r\n     */\r\n  rowAfterShrink(ri, number) {\r\n    let bbox = {\r\n      minX: 0,\r\n      minY: ri,\r\n      maxX: RangeTree.MAX_COL,\r\n      maxY: RangeTree.MAX_ROW,\r\n    };\r\n    let { rTree } = this;\r\n    let array = rTree.search(bbox);\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let item = array[i];\r\n      rTree.remove(item);\r\n      if (item.minY > ri) {\r\n        item.minY -= number;\r\n      }\r\n      if (item.maxY > ri) {\r\n        item.maxY -= number;\r\n      }\r\n    }\r\n    rTree.load(array);\r\n  }\r\n\r\n  /**\r\n     * 列收索\r\n     * @param ci\r\n     * @param number\r\n     */\r\n  colAfterShrink(ci, number) {\r\n    const bbox = {\r\n      minX: ci,\r\n      minY: 0,\r\n      maxX: RangeTree.MAX_COL,\r\n      maxY: RangeTree.MAX_ROW,\r\n    };\r\n    let { rTree } = this;\r\n    let array = rTree.search(bbox);\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let item = array[i];\r\n      rTree.remove(item);\r\n      if (item.minX > ci) {\r\n        item.minX -= number;\r\n      }\r\n      if (item.maxX > ci) {\r\n        item.maxX -= number;\r\n      }\r\n    }\r\n    rTree.load(array);\r\n  }\r\n\r\n  /**\r\n   * 行扩展\r\n   * @param ri\r\n   * @param number\r\n   */\r\n  rowBeforeExpand(ri, number) {\r\n    let bbox = {\r\n      minX: 0,\r\n      minY: ri,\r\n      maxX: RangeTree.MAX_COL,\r\n      maxY: RangeTree.MAX_ROW,\r\n    };\r\n    let { rTree } = this;\r\n    let array = rTree.search(bbox);\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let item = array[i];\r\n      rTree.remove(item);\r\n      if (item.minY >= ri) {\r\n        item.minY += number;\r\n      }\r\n      if (item.maxY >= ri) {\r\n        item.maxY += number;\r\n      }\r\n    }\r\n    rTree.load(array);\r\n  }\r\n\r\n  /**\r\n   * 列扩展\r\n   * @param ci\r\n   * @param number\r\n   */\r\n  colBeforeExpand(ci, number) {\r\n    const bbox = {\r\n      minX: ci,\r\n      minY: 0,\r\n      maxX: RangeTree.MAX_COL,\r\n      maxY: RangeTree.MAX_ROW,\r\n    };\r\n    let { rTree } = this;\r\n    let array = rTree.search(bbox);\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let item = array[i];\r\n      rTree.remove(item);\r\n      if (item.minX >= ci) {\r\n        item.minX += number;\r\n      }\r\n      if (item.maxX >= ci) {\r\n        item.maxX += number;\r\n      }\r\n    }\r\n    rTree.load(array);\r\n  }\r\n\r\n  /**\r\n   * 行收缩\r\n   * @param ri\r\n   * @param number\r\n   */\r\n  rowBeforeShrink(ri, number) {\r\n    let bbox = {\r\n      minX: 0,\r\n      minY: ri,\r\n      maxX: RangeTree.MAX_COL,\r\n      maxY: RangeTree.MAX_ROW,\r\n    };\r\n    let { rTree } = this;\r\n    let array = rTree.search(bbox);\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let item = array[i];\r\n      rTree.remove(item);\r\n      if (item.minY >= ri) {\r\n        item.minY -= number;\r\n      }\r\n      if (item.maxY >= ri) {\r\n        item.maxY -= number;\r\n      }\r\n    }\r\n    rTree.load(array);\r\n  }\r\n\r\n  /**\r\n   * 列收索\r\n   * @param ci\r\n   * @param number\r\n   */\r\n  colBeforeShrink(ci, number) {\r\n    const bbox = {\r\n      minX: ci,\r\n      minY: 0,\r\n      maxX: RangeTree.MAX_COL,\r\n      maxY: RangeTree.MAX_ROW,\r\n    };\r\n    let { rTree } = this;\r\n    let array = rTree.search(bbox);\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let item = array[i];\r\n      rTree.remove(item);\r\n      if (item.minX >= ci) {\r\n        item.minX -= number;\r\n      }\r\n      if (item.maxX >= ci) {\r\n        item.maxX -= number;\r\n      }\r\n    }\r\n    rTree.load(array);\r\n  }\r\n}\r\n\r\nRangeTree.MAX_COL = 1433;\r\nRangeTree.MAX_ROW = 1048576;\r\n\r\nexport {\r\n  RangeTree,\r\n};\r\n","import { SheetUtils } from '../../../utils/SheetUtils';\r\n\r\nclass RectRange {\r\n\r\n  /**\r\n   * RectRange\r\n   * @param {int} sri 起始行\r\n   * @param {int} sci 起始列\r\n   * @param {int} eri 结束行\r\n   * @param {int} eci 结束列\r\n   * @param {int} w 宽度\r\n   * @param {int} h 高度\r\n   */\r\n  constructor(sri, sci, eri, eci, w = 0, h = 0) {\r\n    this.sri = sri;\r\n    this.sci = sci;\r\n    this.eri = eri;\r\n    this.eci = eci;\r\n    this.w = w;\r\n    this.h = h;\r\n  }\r\n\r\n  /**\r\n   * 循环过滤指定的行列\r\n   * @param {XIteratorBuilder} iteratorBuilder 迭代器\r\n   * @param {Function} cb 回调函数\r\n   * @param {Function} rowFilter 过滤使用的回调函数\r\n   */\r\n  each(iteratorBuilder, cb, rowFilter = () => true) {\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    let ret = false;\r\n    iteratorBuilder.getRowIterator()\r\n      .setBegin(sri)\r\n      .setEnd(eri)\r\n      .setLoop((i) => {\r\n        if (rowFilter(i)) {\r\n          iteratorBuilder.getColIterator()\r\n            .setBegin(sci)\r\n            .setEnd(eci)\r\n            .setLoop((j) => {\r\n              ret = cb(i, j);\r\n              return ret;\r\n            })\r\n            .execute();\r\n        }\r\n        return ret;\r\n      })\r\n      .execute();\r\n  }\r\n\r\n  /**\r\n   * 设置区域\r\n   * @param {int} sri 起始行\r\n   * @param {int} sci 起始列\r\n   * @param {int} eri 结束行\r\n   * @param {int} eci 结束列\r\n   */\r\n  set(sri, sci, eri, eci) {\r\n    this.sri = sri;\r\n    this.sci = sci;\r\n    this.eri = eri;\r\n    this.eci = eci;\r\n  }\r\n\r\n  /**\r\n   * 判断是否跨多个单元格\r\n   * @returns {boolean}\r\n   */\r\n  multiple() {\r\n    return this.eri - this.sri > 0 || this.eci - this.sci > 0;\r\n  }\r\n\r\n  /**\r\n   * 判断当前的区域是否包含指定的行和列\r\n   * 参数支持 ri, ci 和 A10 两种形式\r\n   * @param {[int, int] | String} args 行索引,列索引 或者 字符串\r\n   * @returns {boolean}\r\n   */\r\n  includes(...args) {\r\n    let [ri, ci] = [0, 0];\r\n    if (args.length === 1) {\r\n      [ci, ri] = SheetUtils.expr2xy(args[0]);\r\n    } else if (args.length === 2) {\r\n      [ri, ci] = args;\r\n    }\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    return sri <= ri && ri <= eri && sci <= ci && ci <= eci;\r\n  }\r\n\r\n  /**\r\n   * 判断当前的区域是否包含指定的区域\r\n   * @param {RectRange} other 区域\r\n   * @returns {boolean}\r\n   */\r\n  contains(other) {\r\n    return this.sri <= other.sri\r\n      && this.sci <= other.sci\r\n      && this.eri >= other.eri\r\n      && this.eci >= other.eci;\r\n  }\r\n\r\n  /**\r\n   * 判断当前的区域是否被指定的区域包含\r\n   * @param {RectRange} other 区域\r\n   * @returns {boolean}\r\n   */\r\n  within(other) {\r\n    return this.sri >= other.sri\r\n      && this.sci >= other.sci\r\n      && this.eri <= other.eri\r\n      && this.eci <= other.eci;\r\n  }\r\n\r\n  /**\r\n   * 判断当前的区域和指定的区域不发生重合\r\n   * @param {RectRange} other 区域\r\n   * @returns {boolean}\r\n   */\r\n  disjoint(other) {\r\n    return this.sri > other.eri\r\n      || this.sci > other.eci\r\n      || other.sri > this.eri\r\n      || other.sci > this.eci;\r\n  }\r\n\r\n  /**\r\n   * 判断当前的区域和指定的区域发生重合\r\n   * @param {RectRange} other 区域\r\n   * @returns {boolean}\r\n   */\r\n  intersects(other) {\r\n    return this.sri <= other.eri\r\n      && this.sci <= other.eci\r\n      && other.sri <= this.eri\r\n      && other.sci <= this.eci;\r\n  }\r\n\r\n  /**\r\n   * 返回当前区域和指定区域合并后的新区域\r\n   * @param {RectRange} other 区域\r\n   * @returns {RectRange}\r\n   */\r\n  union(other) {\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    return new RectRange(\r\n      other.sri < sri ? other.sri : sri,\r\n      other.sci < sci ? other.sci : sci,\r\n      other.eri > eri ? other.eri : eri,\r\n      other.eci > eci ? other.eci : eci,\r\n    );\r\n  }\r\n\r\n  /**\r\n   * 返回当前区域和指定区域合重合的新区域\r\n   * @param {RectRange} other\r\n   * @returns {RectRange}\r\n   */\r\n  coincide(other) {\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    if (this.disjoint(other)) {\r\n      return RectRange.EMPTY;\r\n    }\r\n    return new RectRange(\r\n      other.sri > sri ? other.sri : sri,\r\n      other.sci > sci ? other.sci : sci,\r\n      other.eri < eri ? other.eri : eri,\r\n      other.eci < eci ? other.eci : eci,\r\n    );\r\n  }\r\n\r\n  /**\r\n   * 当前区域和指定区域重合\r\n   * 返回当前区域和指定区域不重合的部分\r\n   * @param {RectRange} other 区域\r\n   * @returns {Array}\r\n   */\r\n  coincideDifference(other) {\r\n    if (this.coincide(other).equals(RectRange.EMPTY)) {\r\n      return [];\r\n    }\r\n    return this.difference(other);\r\n  }\r\n\r\n  /**\r\n   * 返回当前区域和指定区域不重合的部分\r\n   * @param {RectRange} other 区域\r\n   * @returns {Array}\r\n   */\r\n  difference(other) {\r\n    const ret = [];\r\n    const addRet = (sri, sci, eri, eci) => {\r\n      ret.push(new RectRange(sri, sci, eri, eci));\r\n    };\r\n    const { sri, sci, eri, eci } = this;\r\n    const dsr = other.sri - sri;\r\n    const dsc = other.sci - sci;\r\n    const der = eri - other.eri;\r\n    const dec = eci - other.eci;\r\n    if (dsr > 0) {\r\n      addRet(sri, sci, other.sri - 1, eci);\r\n      if (der > 0) {\r\n        addRet(other.eri + 1, sci, eri, eci);\r\n        if (dsc > 0) {\r\n          addRet(other.sri, sci, other.eri, other.sci - 1);\r\n        }\r\n        if (dec > 0) {\r\n          addRet(other.sri, other.eci + 1, other.eri, eci);\r\n        }\r\n      } else {\r\n        if (dsc > 0) {\r\n          addRet(other.sri, sci, eri, other.sci - 1);\r\n        }\r\n        if (dec > 0) {\r\n          addRet(other.sri, other.eci + 1, eri, eci);\r\n        }\r\n      }\r\n    } else if (der > 0) {\r\n      addRet(other.eri + 1, sci, eri, eci);\r\n      if (dsc > 0) {\r\n        addRet(sri, sci, other.eri, other.sci - 1);\r\n      }\r\n      if (dec > 0) {\r\n        addRet(sri, other.eci + 1, other.eri, eci);\r\n      }\r\n    }\r\n    if (dsc > 0) {\r\n      addRet(sri, sci, eri, other.sci - 1);\r\n      if (dec > 0) {\r\n        addRet(sri, other.eri + 1, eri, eci);\r\n        if (dsr > 0) {\r\n          addRet(sri, other.sci, other.sri - 1, other.eci);\r\n        }\r\n        if (der > 0) {\r\n          addRet(other.sri + 1, other.sci, eri, other.eci);\r\n        }\r\n      } else {\r\n        if (dsr > 0) {\r\n          addRet(sri, other.sci, other.sri - 1, eci);\r\n        }\r\n        if (der > 0) {\r\n          addRet(other.sri + 1, other.sci, eri, eci);\r\n        }\r\n      }\r\n    } else if (dec > 0) {\r\n      addRet(sri, other.eci + 1, eri, eci);\r\n      if (dsr > 0) {\r\n        addRet(sri, sci, other.sri - 1, other.eci);\r\n      }\r\n      if (der > 0) {\r\n        addRet(other.eri + 1, sci, eri, other.eci);\r\n      }\r\n    }\r\n    return ret;\r\n  }\r\n\r\n  /**\r\n   * 当前区域跨的行列数\r\n   * @returns {number[]}\r\n   */\r\n  size() {\r\n    return [\r\n      this.eri - this.sri + 1,\r\n      this.eci - this.sci + 1,\r\n    ];\r\n  }\r\n\r\n  /**\r\n   * 返回边缘区域\r\n   * @returns {{top: RectRange, left: RectRange, bottom: RectRange, right: RectRange}}\r\n   */\r\n  brink() {\r\n    const { sri, eri, sci, eci } = this;\r\n    const top = new RectRange(sri, sci, sri, eci);\r\n    const bottom = new RectRange(eri, sci, eri, eci);\r\n    const right = new RectRange(sri, eci, eri, eci);\r\n    const left = new RectRange(sri, sci, eri, sci);\r\n    return { top, right, bottom, left };\r\n  }\r\n\r\n  /**\r\n   * 方位点\r\n   * @returns {{rb: RectRange, rt: RectRange, lb: RectRange, lt: RectRange}}\r\n   */\r\n  point() {\r\n    const { sri, eri, sci, eci } = this;\r\n    const lt = new RectRange(sri, sci, sri, sci);\r\n    const rt = new RectRange(sri, eci, sri, eci);\r\n    const lb = new RectRange(eri, sci, eri, sci);\r\n    const rb = new RectRange(eri, eci, eri, eci);\r\n    return { lt, rt, lb, rb };\r\n  }\r\n\r\n  /**\r\n   * equals\r\n   * @param {RectRange} other 区域\r\n   * @returns {boolean}\r\n   */\r\n  equals(other) {\r\n    return this.eri === other.eri\r\n      && this.eci === other.eci\r\n      && this.sri === other.sri\r\n      && this.sci === other.sci;\r\n  }\r\n\r\n  /**\r\n   * 克隆\r\n   * @returns {RectRange}\r\n   */\r\n  clone() {\r\n    const {\r\n      sri, sci, eri, eci, w, h,\r\n    } = this;\r\n    return new RectRange(sri, sci, eri, eci, w, h);\r\n  }\r\n\r\n  toString() {\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    let ref = SheetUtils.xy2expr(sci, sri);\r\n    if (this.multiple()) {\r\n      ref = `${ref}:${SheetUtils.xy2expr(eci, eri)}`;\r\n    }\r\n    return ref;\r\n  }\r\n\r\n  /**\r\n   * 将 B1:B8 或者 B1 参数转换成新的区域\r\n   * @param {String} ref 行列字符串\r\n   * @returns {RectRange}\r\n   */\r\n  static valueOf(ref) {\r\n    const refs = ref.split(':');\r\n    const [sci, sri] = SheetUtils.expr2xy(refs[0]);\r\n    let [eri, eci] = [sri, sci];\r\n    if (refs.length > 1) {\r\n      [eci, eri] = SheetUtils.expr2xy(refs[1]);\r\n    }\r\n    return new RectRange(sri, sci, eri, eci);\r\n  }\r\n}\r\n\r\nRectRange.EMPTY = new RectRange(-1, -1, -1, -1);\r\n\r\nexport { RectRange };\r\n","import { Cell } from './Cell';\r\nimport { SheetUtils } from '../../../utils/SheetUtils';\r\nimport { Listen } from '../../../lib/Listen';\r\nimport { Merges } from '../merges/Merges';\r\nimport { Snapshot } from '../snapshot/Snapshot';\r\n\r\nclass Items {\r\n\r\n  constructor({ data = [] }) {\r\n    this.data = data;\r\n  }\r\n\r\n  getItems(ri) {\r\n    let { data } = this;\r\n    return data[ri];\r\n  }\r\n\r\n  clear(rectRange, { ignoreCorner = false } = {}) {\r\n    let { sri, eri } = rectRange;\r\n    let { sci, eci } = rectRange;\r\n    let { data } = this;\r\n    let { snapshot } = this;\r\n    let { length } = data;\r\n    let oldItems = [];\r\n    let effRiLength = eri - sri + 1;\r\n    let effCiLength = eci - sci + 1;\r\n    let action = {\r\n      undo: () => {\r\n        for (let ri = sri; ri <= eri; ri++) {\r\n          if (ri >= length) {\r\n            break;\r\n          }\r\n          let oldRowItem = oldItems[ri];\r\n          let rowItem = data[ri];\r\n          if (rowItem) {\r\n            for (let ci = sci; ci <= eci; ci++) {\r\n              if (ci >= length) {\r\n                break;\r\n              }\r\n              if (ignoreCorner) {\r\n                let firstRi = ri === sri;\r\n                let firstCi = ci === sci;\r\n                if (firstRi && firstCi) {\r\n                  continue;\r\n                }\r\n                rowItem[ci] = oldRowItem[ci];\r\n              } else {\r\n                rowItem[ci] = oldRowItem[ci];\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      redo: () => {\r\n        oldItems = new Array(effRiLength);\r\n        for (let ri = sri; ri <= eri; ri++) {\r\n          if (ri >= length) {\r\n            break;\r\n          }\r\n          let rowItem = data[ri];\r\n          if (rowItem) {\r\n            let oldRowItem = new Array(effCiLength);\r\n            let { length } = rowItem;\r\n            for (let ci = sci; ci <= eci; ci++) {\r\n              if (ci >= length) {\r\n                break;\r\n              }\r\n              if (ignoreCorner) {\r\n                let firstRi = ri === sri;\r\n                let firstCi = ci === sci;\r\n                if (firstRi && firstCi) {\r\n                  continue;\r\n                }\r\n                oldRowItem[ci] = rowItem[ci];\r\n                rowItem[ci] = undefined;\r\n              } else {\r\n                oldRowItem[ci] = rowItem[ci];\r\n                rowItem[ci] = undefined;\r\n              }\r\n            }\r\n            oldItems[ri] = oldRowItem;\r\n          }\r\n        }\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  shift() {\r\n    return this.data.shift();\r\n  }\r\n\r\n  slice(sri, sci, eri, eci) {\r\n    const rows = this.data.slice(sri, eri + 1);\r\n    return rows.map((row) => {\r\n      if (row) {\r\n        return row.slice(sci, eci + 1);\r\n      }\r\n      return row;\r\n    });\r\n  }\r\n\r\n  getData() {\r\n    return this.data;\r\n  }\r\n\r\n  getLength() {\r\n    return this.data.length;\r\n  }\r\n\r\n  hasItems(ri) {\r\n    return SheetUtils.isDef(this.getItems(ri));\r\n  }\r\n\r\n  getItemsOrNew(ri) {\r\n    let { data } = this;\r\n    let items = data[ri];\r\n    if (SheetUtils.isUnDef(items)) {\r\n      items = [];\r\n      data[ri] = items;\r\n    }\r\n    return items;\r\n  }\r\n\r\n}\r\n\r\nclass Cells extends Items {\r\n\r\n  static wrapCell(item) {\r\n    if (item instanceof Cell) {\r\n      return item;\r\n    }\r\n\r\n    if (SheetUtils.isString(item)) {\r\n      let config = { text: item };\r\n      return new Cell(config);\r\n    }\r\n    if (SheetUtils.isDef(item)) {\r\n      let config = item.cell ? item.cell : item;\r\n      return new Cell(config);\r\n    }\r\n\r\n    return item;\r\n  }\r\n\r\n  constructor({\r\n    snapshot = new Snapshot(),\r\n    data = [],\r\n    merges = new Merges(),\r\n  } = {}) {\r\n    super({ data });\r\n    this.snapshot = snapshot;\r\n    this.merges = merges;\r\n    this.listen = new Listen();\r\n  }\r\n\r\n  getCellOrNew(ri, ci) {\r\n    if (ri < 0) {\r\n      throw new TypeError(`错误的行号${ri}`);\r\n    }\r\n    if (ci < 0) {\r\n      throw new TypeError(`错误的列号${ci}`);\r\n    }\r\n    let cell = this.getCell(ri, ci);\r\n    if (SheetUtils.isUnDef(cell)) {\r\n      let items = this.getItemsOrNew(ri);\r\n      cell = new Cell();\r\n      items[ci] = cell;\r\n    }\r\n    return cell;\r\n  }\r\n\r\n  getCell(ri, ci) {\r\n    let { data } = this;\r\n    let items = data[ri];\r\n    if (items) {\r\n      const wrap = Cells.wrapCell(items[ci]);\r\n      items[ci] = wrap;\r\n      return wrap;\r\n    }\r\n    return SheetUtils.Undef;\r\n  }\r\n\r\n  each(callback) {\r\n    const { data } = this;\r\n    for (let i = 0, len = data.length; i < len; i++) {\r\n      let items = data[i];\r\n      if (items) {\r\n        for (let j = 0, len = items.length; j < len; j++) {\r\n          let cell = this.getCell(i, j);\r\n          callback(cell);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  getCellOrMergeCell(ri, ci) {\r\n    const { merges } = this;\r\n    const merge = merges.getFirstInclude(ri, ci);\r\n    if (merge) {\r\n      return this.getCell(merge.sri, merge.sci);\r\n    }\r\n    return this.getCell(ri, ci);\r\n  }\r\n\r\n  hasCell(ri, ci) {\r\n    return SheetUtils.isDef(this.getCell(ri, ci));\r\n  }\r\n\r\n  setCell(ri, ci, cell) {\r\n    if (ri < 0) {\r\n      throw new TypeError(`错误的行号${ri}`);\r\n    }\r\n    if (ci < 0) {\r\n      throw new TypeError(`错误的列号${ci}`);\r\n    }\r\n    let { listen, snapshot } = this;\r\n    let oldValue = this.getCell(ri, ci);\r\n    if (oldValue) {\r\n      let action = {\r\n        undo: () => {\r\n          const items = this.getItems(ri);\r\n          items[ci] = oldValue;\r\n          listen.execute('change', {\r\n            ri, ci, oldValue,\r\n          });\r\n        },\r\n        redo: () => {\r\n          const items = this.getItemsOrNew(ri);\r\n          items[ci] = cell;\r\n          listen.execute('change', {\r\n            ri, ci, oldValue,\r\n          });\r\n        },\r\n      };\r\n      snapshot.addAction(action);\r\n      action.redo();\r\n    }\r\n  }\r\n\r\n  setCellOrNew(ri, ci, cell) {\r\n    if (ri < 0) {\r\n      throw new TypeError(`错误的行号${ri}`);\r\n    }\r\n    if (ci < 0) {\r\n      throw new TypeError(`错误的列号${ci}`);\r\n    }\r\n    let { listen, snapshot } = this;\r\n    let hasCell = this.hasCell(ri, ci);\r\n    let hasItems = this.hasItems(ri);\r\n    let oldValue = this.getCell(ri, ci);\r\n    let action = {\r\n      undo: () => {\r\n        if (hasItems) {\r\n          const items = this.getItems(ri);\r\n          if (hasCell) {\r\n            items[ci] = oldValue;\r\n          } else {\r\n            items.splice(ci, 1);\r\n          }\r\n          listen.execute('change', {\r\n            ri, ci, oldValue,\r\n          });\r\n        } else {\r\n          const data = this.getData();\r\n          data.splice(ri, 1);\r\n          listen.execute('change', {\r\n            ri, ci, oldValue,\r\n          });\r\n        }\r\n      },\r\n      redo: () => {\r\n        if (hasItems) {\r\n          const items = this.getItems(ri);\r\n          items[ci] = cell;\r\n          listen.execute('change', {\r\n            ri, ci, oldValue,\r\n          });\r\n        } else {\r\n          const items = this.getItemsOrNew(ri);\r\n          items[ci] = cell;\r\n          listen.execute('change', {\r\n            ri, ci, oldValue,\r\n          });\r\n        }\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  removeRow(ri) {\r\n    let { snapshot } = this;\r\n    let orderValue;\r\n    let action = {\r\n      undo: () => {\r\n        if (orderValue) {\r\n          this.data.splice(ri, 0, orderValue);\r\n        }\r\n      },\r\n      redo: () => {\r\n        orderValue = this.data.splice(ri, 1)[0];\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  removeCol(ci) {\r\n    let { snapshot } = this;\r\n    let orderValue = [];\r\n    let action = {\r\n      undo: () => {\r\n        let { length } = orderValue;\r\n        for (let i = 0; i < length; i++) {\r\n          const value = orderValue[i];\r\n          const { ri, item } = value;\r\n          const items = this.data[ri];\r\n          items.splice(ci, 0, item);\r\n        }\r\n      },\r\n      redo: () => {\r\n        let { length } = this.data;\r\n        orderValue = [];\r\n        for (let ri = 0; ri < length; ri++) {\r\n          const items = this.data[ri];\r\n          if (items) {\r\n            const item = items.splice(ci, 1)[0];\r\n            orderValue.push({ ri, item });\r\n          }\r\n        }\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  copyRowStyle(ri) {\r\n    let row = this.data[ri];\r\n    let copy = [];\r\n    if (row) {\r\n      for (let i = 0, len = row.length; i < len; i++) {\r\n        let cell = row[i];\r\n        if (cell) {\r\n          copy[i] = this.getCell(ri, i).cloneStyle();\r\n        }\r\n      }\r\n    }\r\n    return copy;\r\n  }\r\n\r\n  insertRowAfter(ri) {\r\n    let { snapshot } = this;\r\n    let master = ri + 1;\r\n    let action = {\r\n      undo: () => {\r\n        this.data.splice(master, 1);\r\n      },\r\n      redo: () => {\r\n        const copy = this.copyRowStyle(master);\r\n        this.data.splice(master, 0, copy);\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  insertColAfter(ci) {\r\n    let { snapshot } = this;\r\n    let master = ci + 1;\r\n    let action = {\r\n      undo: () => {\r\n        for (let i = 0, len = this.data.length; i < len; i++) {\r\n          const items = this.data[i];\r\n          if (items) {\r\n            items.splice(master, 1);\r\n          }\r\n        }\r\n      },\r\n      redo: () => {\r\n        for (let i = 0, len = this.data.length; i < len; i++) {\r\n          const items = this.data[i];\r\n          if (items) {\r\n            const cell = this.getCell(i, master);\r\n            const copy = cell ? cell.cloneStyle() : undefined;\r\n            items.splice(master, 0, copy);\r\n          }\r\n        }\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  insertRowBefore(ri) {\r\n    let { snapshot } = this;\r\n    let master = ri;\r\n    let action = {\r\n      undo: () => {\r\n        this.data.splice(master, 1);\r\n      },\r\n      redo: () => {\r\n        const copy = this.copyRowStyle(master);\r\n        this.data.splice(master, 0, copy);\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  insertColBefore(ci) {\r\n    let { snapshot } = this;\r\n    let master = ci;\r\n    let action = {\r\n      undo: () => {\r\n        for (let i = 0, len = this.data.length; i < len; i++) {\r\n          const items = this.data[i];\r\n          if (items) {\r\n            items.splice(master, 1);\r\n          }\r\n        }\r\n      },\r\n      redo: () => {\r\n        for (let i = 0, len = this.data.length; i < len; i++) {\r\n          const items = this.data[i];\r\n          if (items) {\r\n            const cell = this.getCell(i, master);\r\n            const copy = cell ? cell.cloneStyle() : undefined;\r\n            items.splice(master, 0, copy);\r\n          }\r\n        }\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  Cells,\r\n};\r\n","class Listen {\r\n\r\n  constructor() {\r\n    this.pool = {};\r\n  }\r\n\r\n  clear() {\r\n    Object.keys((key) => {\r\n      delete this.pool[key];\r\n    });\r\n  }\r\n\r\n  removeListen(key) {\r\n    delete this.pool[key];\r\n  }\r\n\r\n  registerListen(key, call) {\r\n    this.pool[key] = call;\r\n  }\r\n\r\n  execute(key, ...message) {\r\n    if (this.pool[key]) {\r\n      this.pool[key](...message);\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  Listen,\r\n};\r\n","function Compare(a, b) {\r\n  return a < b ? -1 : a > b ? 1 : 0;\r\n}\r\n\r\nfunction Swap(arr, i, j) {\r\n  let tmp = arr[i];\r\n  arr[i] = arr[j];\r\n  arr[j] = tmp;\r\n}\r\n\r\nfunction QStep(arr, k, left, right, compare) {\r\n  while (right > left) {\r\n    if (right - left > 600) {\r\n      let n = right - left + 1;\r\n      let m = k - left + 1;\r\n      let z = Math.log(n);\r\n      let s = 0.5 * Math.exp(2 * z / 3);\r\n      let sd = 0.5 * Math.sqrt(z * s * (n - s) / n) * (m - n / 2 < 0 ? -1 : 1);\r\n      let newLeft = Math.max(left, Math.floor(k - m * s / n + sd));\r\n      let newRight = Math.min(right, Math.floor(k + (n - m) * s / n + sd));\r\n      QStep(arr, k, newLeft, newRight, compare);\r\n    }\r\n\r\n    let t = arr[k];\r\n    let i = left;\r\n    let j = right;\r\n\r\n    Swap(arr, left, k);\r\n    if (compare(arr[right], t) > 0) Swap(arr, left, right);\r\n\r\n    while (i < j) {\r\n      Swap(arr, i, j);\r\n      i++;\r\n      j--;\r\n      while (compare(arr[i], t) < 0) i++;\r\n      while (compare(arr[j], t) > 0) j--;\r\n    }\r\n\r\n    if (compare(arr[left], t) === 0) Swap(arr, left, j);\r\n    else {\r\n      j++;\r\n      Swap(arr, j, right);\r\n    }\r\n\r\n    if (j <= k) left = j + 1;\r\n    if (k <= j) right = j - 1;\r\n  }\r\n}\r\n\r\nfunction QkSelect(arr, k, left, right, compare) {\r\n  QStep(arr, k, left || 0, right || (arr.length - 1), compare || Compare);\r\n}\r\n\r\nexport {\r\n  QkSelect,\r\n};\r\n","import { QkSelect } from './QkSelect';\r\n\r\nfunction findItem(item, items, equalsFn) {\r\n  if (!equalsFn) {\r\n    return items.indexOf(item);\r\n  }\r\n  for (let i = 0; i < items.length; i++) {\r\n    if (equalsFn(item, items[i])) return i;\r\n  }\r\n  return -1;\r\n}\r\nfunction extend(a, b) {\r\n  a.minX = Math.min(a.minX, b.minX);\r\n  a.minY = Math.min(a.minY, b.minY);\r\n  a.maxX = Math.max(a.maxX, b.maxX);\r\n  a.maxY = Math.max(a.maxY, b.maxY);\r\n  return a;\r\n}\r\nfunction compareNodeMinX(a, b) {\r\n  return a.minX - b.minX;\r\n}\r\nfunction compareNodeMinY(a, b) {\r\n  return a.minY - b.minY;\r\n}\r\nfunction bboxArea(a) {\r\n  return (a.maxX - a.minX) * (a.maxY - a.minY);\r\n}\r\nfunction bboxMargin(a) {\r\n  return (a.maxX - a.minX) + (a.maxY - a.minY);\r\n}\r\nfunction enlargedArea(a, b) {\r\n  return (Math.max(b.maxX, a.maxX) - Math.min(b.minX, a.minX)) * (Math.max(b.maxY, a.maxY) - Math.min(b.minY, a.minY));\r\n}\r\nfunction intersectionArea(a, b) {\r\n  const minX = Math.max(a.minX, b.minX);\r\n  const minY = Math.max(a.minY, b.minY);\r\n  const maxX = Math.min(a.maxX, b.maxX);\r\n  const maxY = Math.min(a.maxY, b.maxY);\r\n  return Math.max(0, maxX - minX) * Math.max(0, maxY - minY);\r\n}\r\nfunction contains(a, b) {\r\n  return a.minX <= b.minX && a.minY <= b.minY && b.maxX <= a.maxX && b.maxY <= a.maxY;\r\n}\r\nfunction intersects(a, b) {\r\n  return b.minX <= a.maxX && b.minY <= a.maxY && b.maxX >= a.minX && b.maxY >= a.minY;\r\n}\r\nfunction createNode(childrenNodes) {\r\n  return {\r\n    childrenNodes,\r\n    height: 1,\r\n    leaf: true,\r\n    minX: Infinity,\r\n    minY: Infinity,\r\n    maxX: -Infinity,\r\n    maxY: -Infinity,\r\n  };\r\n}\r\nfunction distBBox(node, k, p, toBBox, destNode) {\r\n  // 从 k 到 p-1 的节点子节点的最小边界矩形\r\n  if (!destNode) destNode = createNode(null);\r\n  destNode.minX = Infinity;\r\n  destNode.minY = Infinity;\r\n  destNode.maxX = -Infinity;\r\n  destNode.maxY = -Infinity;\r\n  for (let i = k; i < p; i++) {\r\n    const child = node.childrenNodes[i];\r\n    extend(destNode, node.leaf ? toBBox(child) : child);\r\n  }\r\n  return destNode;\r\n}\r\nfunction calcBBox(node, toBBox) {\r\n  // 从其子节点的框计算节点框\r\n  distBBox(node, 0, node.childrenNodes.length, toBBox, node);\r\n}\r\nfunction multiSelect(arr, left, right, n, compare) {\r\n  // 对数组进行排序，以便项目以 n 个未排序项目为一组，各组在彼此之间排序；\r\n  // 将选择算法与二元分治法相结合\r\n  const stack = [left, right];\r\n  while (stack.length) {\r\n    right = stack.pop();\r\n    left = stack.pop();\r\n    if (right - left <= n) continue;\r\n    const mid = left + Math.ceil((right - left) / n / 2) * n;\r\n    QkSelect(arr, mid, left, right, compare);\r\n    stack.push(left, mid, mid, right);\r\n  }\r\n}\r\n\r\nclass RectTree {\r\n  constructor(maxEntries = 9) {\r\n    // 默认情况下，节点中的最大条目数为 9； 最小节点填充为 40% 以获得最佳性能\r\n    this._maxEntries = Math.max(4, maxEntries);\r\n    this._minEntries = Math.max(2, Math.ceil(this._maxEntries * 0.4));\r\n    this.clear();\r\n  }\r\n\r\n  all() {\r\n    return this._all(this.data, []);\r\n  }\r\n\r\n  search(bbox) {\r\n    let node = this.data;\r\n    const result = [];\r\n\r\n    if (!intersects(bbox, node)) {\r\n      return result;\r\n    }\r\n\r\n    const toBBox = this.toBBox;\r\n    const nodesToSearch = [];\r\n\r\n    while (node) {\r\n      for (let i = 0; i < node.childrenNodes.length; i++) {\r\n        const child = node.childrenNodes[i];\r\n        const childBBox = node.leaf ? toBBox(child) : child;\r\n        if (intersects(bbox, childBBox)) {\r\n          if (node.leaf) result.push(child);\r\n          else if (contains(bbox, childBBox)) this._all(child, result);\r\n          else nodesToSearch.push(child);\r\n        }\r\n      }\r\n      node = nodesToSearch.pop();\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  first(bbox) {\r\n    return this.search(bbox)[0];\r\n  }\r\n\r\n  collides(bbox) {\r\n    let node = this.data;\r\n\r\n    if (!intersects(bbox, node)) {\r\n      return false;\r\n    }\r\n\r\n    const nodesToSearch = [];\r\n    while (node) {\r\n      for (let i = 0; i < node.childrenNodes.length; i++) {\r\n        const child = node.childrenNodes[i];\r\n        const childBBox = node.leaf ? this.toBBox(child) : child;\r\n        if (intersects(bbox, childBBox)) {\r\n          if (node.leaf || contains(bbox, childBBox)) return true;\r\n          nodesToSearch.push(child);\r\n        }\r\n      }\r\n      node = nodesToSearch.pop();\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  load(data) {\r\n    if (!(data && data.length)) {\r\n      return this;\r\n    }\r\n\r\n    if (data.length < this._minEntries) {\r\n      for (let i = 0; i < data.length; i++) {\r\n        this.insert(data[i]);\r\n      }\r\n      return this;\r\n    }\r\n\r\n    // 使用 OMT 算法从头开始使用给定数据递归构建树\r\n    let node = this._build(data.slice(), 0, data.length - 1, 0);\r\n\r\n    if (!this.data.childrenNodes.length) {\r\n      // 如果树为空，则按原样保存\r\n      this.data = node;\r\n    } else if (this.data.height === node.height) {\r\n      // 如果树具有相同的高度，则拆分根\r\n      this._splitRoot(this.data, node);\r\n    } else {\r\n      if (this.data.height < node.height) {\r\n        // 如果插入的树更大，则交换树\r\n        const tmpNode = this.data;\r\n        this.data = node;\r\n        node = tmpNode;\r\n      }\r\n      // 将小树插入大树中适当的层次\r\n      this._insert(node, this.data.height - node.height - 1, true);\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  insert(item) {\r\n    if (item) {\r\n      this._insert(item, this.data.height - 1);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  clear() {\r\n    this.data = createNode([]);\r\n    return this;\r\n  }\r\n\r\n  remove(item, equalsFn) {\r\n    if (!item) {\r\n      return this;\r\n    }\r\n\r\n    let node = this.data;\r\n    const bbox = this.toBBox(item);\r\n    const path = [];\r\n    const indexes = [];\r\n    let i;\r\n    let parent;\r\n    let goingUp;\r\n\r\n    // 深度优先迭代树遍历\r\n    while (node || path.length) {\r\n      if (!node) {\r\n        // 往上\r\n        node = path.pop();\r\n        parent = path[path.length - 1];\r\n        i = indexes.pop();\r\n        goingUp = true;\r\n      }\r\n\r\n      if (node.leaf) {\r\n        // 检查当前节点\r\n        const index = findItem(item, node.childrenNodes, equalsFn);\r\n        if (index !== -1) {\r\n          // 找到项目，移除项目并向上压缩树\r\n          node.childrenNodes.splice(index, 1);\r\n          path.push(node);\r\n          this._condense(path);\r\n          return this;\r\n        }\r\n      }\r\n\r\n      if (!goingUp && !node.leaf && contains(node, bbox)) {\r\n        // 往下\r\n        path.push(node);\r\n        indexes.push(i);\r\n        i = 0;\r\n        parent = node;\r\n        node = node.childrenNodes[0];\r\n      } else if (parent) {\r\n        // 向右走\r\n        i++;\r\n        node = parent.childrenNodes[i];\r\n        goingUp = false;\r\n      } else {\r\n        // 没有发现\r\n        node = null;\r\n      }\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  toBBox(item) {\r\n    return item;\r\n  }\r\n\r\n  compareMinX(a, b) {\r\n    return a.minX - b.minX;\r\n  }\r\n\r\n  compareMinY(a, b) {\r\n    return a.minY - b.minY;\r\n  }\r\n\r\n  _all(node, result) {\r\n    const nodesToSearch = [];\r\n    while (node) {\r\n      if (node.leaf) {\r\n        result.push(...node.childrenNodes);\r\n      } else {\r\n        nodesToSearch.push(...node.childrenNodes);\r\n      }\r\n      node = nodesToSearch.pop();\r\n    }\r\n    return result;\r\n  }\r\n\r\n  _build(items, left, right, height) {\r\n    const N = right - left + 1;\r\n    let M = this._maxEntries;\r\n    let node;\r\n\r\n    if (N <= M) {\r\n      // 达到叶级； 回叶\r\n      node = createNode(items.slice(left, right + 1));\r\n      calcBBox(node, this.toBBox);\r\n      return node;\r\n    }\r\n\r\n    if (!height) {\r\n      // 散装树的目标高度\r\n      height = Math.ceil(Math.log(N) / Math.log(M));\r\n      // 目标根条目数以最大限度地提高存储利用率\r\n      M = Math.ceil(N / M ** (height - 1));\r\n    }\r\n\r\n    node = createNode([]);\r\n    node.leaf = false;\r\n    node.height = height;\r\n\r\n    // 将项目分成 M 个主要为方形的元素\r\n    const N2 = Math.ceil(N / M);\r\n    const N1 = N2 * Math.ceil(Math.sqrt(M));\r\n\r\n    multiSelect(items, left, right, N1, this.compareMinX);\r\n\r\n    for (let i = left; i <= right; i += N1) {\r\n      const right2 = Math.min(i + N1 - 1, right);\r\n      multiSelect(items, i, right2, N2, this.compareMinY);\r\n      for (let j = i; j <= right2; j += N2) {\r\n        const right3 = Math.min(j + N2 - 1, right2);\r\n        // 递归地打包每个条目\r\n        node.childrenNodes.push(this._build(items, j, right3, height - 1));\r\n      }\r\n    }\r\n\r\n    calcBBox(node, this.toBBox);\r\n\r\n    return node;\r\n  }\r\n\r\n  _chooseSubtree(bbox, node, level, path) {\r\n    while (true) {\r\n      path.push(node);\r\n\r\n      if (node.leaf || path.length - 1 === level) {\r\n        break;\r\n      }\r\n\r\n      let minArea = Infinity;\r\n      let minEnlargement = Infinity;\r\n      let targetNode;\r\n\r\n      for (let i = 0; i < node.childrenNodes.length; i++) {\r\n        const child = node.childrenNodes[i];\r\n        const area = bboxArea(child);\r\n        const enlargement = enlargedArea(bbox, child) - area;\r\n\r\n        // 选择最小面积扩大的入口\r\n        if (enlargement < minEnlargement) {\r\n          minEnlargement = enlargement;\r\n          minArea = area < minArea ? area : minArea;\r\n          targetNode = child;\r\n        } else if (enlargement === minEnlargement) {\r\n          // 否则选择面积最小的一个\r\n          if (area < minArea) {\r\n            minArea = area;\r\n            targetNode = child;\r\n          }\r\n        }\r\n      }\r\n\r\n      node = targetNode || node.childrenNodes[0];\r\n    }\r\n\r\n    return node;\r\n  }\r\n\r\n  _insert(item, level, isNode) {\r\n    const bbox = isNode ? item : this.toBBox(item);\r\n    const insertPath = [];\r\n\r\n    // 找到容纳物品的最佳节点，同时保存路径上的所有节点\r\n    const node = this._chooseSubtree(bbox, this.data, level, insertPath);\r\n\r\n    // 将项目放入节点\r\n    node.childrenNodes.push(item);\r\n    extend(node, bbox);\r\n\r\n    // 节点溢出时分裂； 必要时向上传播\r\n    while (level >= 0) {\r\n      if (insertPath[level].childrenNodes.length > this._maxEntries) {\r\n        this._split(insertPath, level);\r\n        level--;\r\n      } else {\r\n        break;\r\n      }\r\n    }\r\n\r\n    // 沿插入路径调整 bboxes\r\n    this._adjustParentBBoxes(bbox, insertPath, level);\r\n  }\r\n\r\n  // 将溢出的节点一分为二\r\n  _split(insertPath, level) {\r\n    const node = insertPath[level];\r\n    const M = node.childrenNodes.length;\r\n    const m = this._minEntries;\r\n\r\n    this._chooseSplitAxis(node, m, M);\r\n\r\n    const splitIndex = this._chooseSplitIndex(node, m, M);\r\n\r\n    const newNode = createNode(node.childrenNodes.splice(splitIndex, node.childrenNodes.length - splitIndex));\r\n    newNode.height = node.height;\r\n    newNode.leaf = node.leaf;\r\n\r\n    calcBBox(node, this.toBBox);\r\n    calcBBox(newNode, this.toBBox);\r\n\r\n    if (level) {\r\n      insertPath[level - 1].childrenNodes.push(newNode);\r\n    } else {\r\n      this._splitRoot(node, newNode);\r\n    }\r\n  }\r\n\r\n  _splitRoot(node, newNode) {\r\n    // 分裂根节点\r\n    this.data = createNode([node, newNode]);\r\n    this.data.height = node.height + 1;\r\n    this.data.leaf = false;\r\n    calcBBox(this.data, this.toBBox);\r\n  }\r\n\r\n  _chooseSplitIndex(node, m, M) {\r\n    let index;\r\n    let minOverlap = Infinity;\r\n    let minArea = Infinity;\r\n\r\n    for (let i = m; i <= M - m; i++) {\r\n      const bbox1 = distBBox(node, 0, i, this.toBBox);\r\n      const bbox2 = distBBox(node, i, M, this.toBBox);\r\n\r\n      const overlap = intersectionArea(bbox1, bbox2);\r\n      const area = bboxArea(bbox1) + bboxArea(bbox2);\r\n\r\n      // 选择重叠最小的分布\r\n      if (overlap < minOverlap) {\r\n        minOverlap = overlap;\r\n        index = i;\r\n        minArea = area < minArea ? area : minArea;\r\n      } else if (overlap === minOverlap) {\r\n        // 否则选择面积最小的分布\r\n        if (area < minArea) {\r\n          minArea = area;\r\n          index = i;\r\n        }\r\n      }\r\n    }\r\n\r\n    return index || M - m;\r\n  }\r\n\r\n  // 按最佳轴对节点子节点进行排序以进行拆分\r\n  _chooseSplitAxis(node, m, M) {\r\n    const compareMinX = node.leaf ? this.compareMinX : compareNodeMinX;\r\n    const compareMinY = node.leaf ? this.compareMinY : compareNodeMinY;\r\n    const xMargin = this._allDistMargin(node, m, M, compareMinX);\r\n    const yMargin = this._allDistMargin(node, m, M, compareMinY);\r\n    // 如果 x 的总分配边际值最小，则按 minX 排序,\r\n    // 否则它已经按 minY 排序\r\n    if (xMargin < yMargin) {\r\n      node.childrenNodes.sort(compareMinX);\r\n    }\r\n  }\r\n\r\n  // 所有可能的分割分布的总边际，其中每个节点至少是 m 满\r\n  _allDistMargin(node, m, M, compare) {\r\n    node.childrenNodes.sort(compare);\r\n\r\n    const toBBox = this.toBBox;\r\n    const leftBBox = distBBox(node, 0, m, toBBox);\r\n    const rightBBox = distBBox(node, M - m, M, toBBox);\r\n    let margin = bboxMargin(leftBBox) + bboxMargin(rightBBox);\r\n\r\n    for (let i = m; i < M - m; i++) {\r\n      const child = node.childrenNodes[i];\r\n      extend(leftBBox, node.leaf ? toBBox(child) : child);\r\n      margin += bboxMargin(leftBBox);\r\n    }\r\n\r\n    for (let i = M - m - 1; i >= m; i--) {\r\n      const child = node.childrenNodes[i];\r\n      extend(rightBBox, node.leaf ? toBBox(child) : child);\r\n      margin += bboxMargin(rightBBox);\r\n    }\r\n\r\n    return margin;\r\n  }\r\n\r\n  _adjustParentBBoxes(bbox, path, level) {\r\n    // 沿给定的树路径调整 bbox\r\n    for (let i = level; i >= 0; i--) {\r\n      extend(path[i], bbox);\r\n    }\r\n  }\r\n\r\n  _condense(path) {\r\n    // 遍历路径，删除空节点并更新 bboxes\r\n    for (let i = path.length - 1, siblings; i >= 0; i--) {\r\n      if (path[i].childrenNodes.length === 0) {\r\n        if (i > 0) {\r\n          siblings = path[i - 1].childrenNodes;\r\n          siblings.splice(siblings.indexOf(path[i]), 1);\r\n        } else {\r\n          this.clear();\r\n        }\r\n      } else {\r\n        calcBBox(path[i], this.toBBox);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport {\r\n  RectTree,\r\n};\r\n","import { RectRange } from '../core/table/tablebase/RectRange';\r\n\r\nclass RtreeUtils {\r\n\r\n  static bboxToRange(bbox) {\r\n    return new RectRange(bbox.minY, bbox.minX, bbox.maxY, bbox.maxX);\r\n  }\r\n\r\n  static rangeToBbox(range) {\r\n    return {\r\n      minX: range.sci,\r\n      minY: range.sri,\r\n      maxX: range.eci,\r\n      maxY: range.eri,\r\n    };\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  RtreeUtils,\r\n};\r\n"],"names":["Merges","constructor","snapshot","merges","super","map","merge","forEach","view","this","add","getData","getAll","range","toString","removeRow","ri","number","rTree","footRange","fullRange","getFullRowRange","fullBbox","footBbox","divers","search","mergeAction","undo","length","i","item","remove","load","redo","clone","minY","maxY","diffMax","oldMax","style","maxX","minX","push","diffMin","oldMin","diffValue","addAction","removeCol","ci","getFullColRange","insertColAfter","colAfterShrink","colAfterExpand","insertColBefore","colBeforeShrink","colBeforeExpand","insertRowAfter","rowAfterShrink","rowAfterExpand","insertRowBefore","rowBeforeShrink","rowBeforeExpand","Snapshot","undoStack","redoStack","layer","event","data","apply","listen","pop","execute","len","open","canRedo","canUndo","close","action","RangeTree","getFirstInclude","bbox","find","first","getMasterInclude","sri","sci","getIntersects","rectRange","insert","shift","array","delete","batchDelete","rectRanges","all","union","equals","Math","max","MAX_COL","MAX_ROW","RectRange","eri","eci","w","h","each","iteratorBuilder","cb","rowFilter","ret","getRowIterator","setBegin","setEnd","setLoop","getColIterator","j","set","multiple","includes","args","contains","other","within","disjoint","intersects","coincide","EMPTY","coincideDifference","difference","addRet","dsr","dsc","der","dec","size","brink","top","bottom","right","left","point","lt","rt","lb","rb","ref","static","refs","split","Cells","getItems","clear","ignoreCorner","oldItems","effRiLength","effCiLength","oldRowItem","rowItem","firstCi","Array","undefined","slice","row","getLength","hasItems","getItemsOrNew","items","config","text","cell","getCellOrNew","TypeError","getCell","wrap","wrapCell","callback","getCellOrMergeCell","hasCell","setCell","oldValue","setCellOrNew","splice","orderValue","value","copyRowStyle","copy","cloneStyle","master","Listen","pool","Object","keys","key","removeListen","registerListen","call","message","Compare","a","b","Swap","arr","tmp","QStep","k","compare","n","m","z","log","s","exp","sd","sqrt","floor","min","t","QkSelect","findItem","equalsFn","indexOf","extend","compareNodeMinX","compareNodeMinY","bboxArea","bboxMargin","intersectionArea","createNode","childrenNodes","height","leaf","Infinity","distBBox","node","p","toBBox","destNode","child","calcBBox","multiSelect","stack","mid","ceil","RectTree","maxEntries","_maxEntries","_minEntries","_all","result","nodesToSearch","childBBox","collides","_build","_splitRoot","tmpNode","_insert","path","indexes","parent","goingUp","index","_condense","compareMinX","compareMinY","N","M","N2","N1","right2","right3","_chooseSubtree","level","targetNode","minArea","minEnlargement","area","enlargement","isNode","insertPath","_split","_adjustParentBBoxes","_chooseSplitAxis","splitIndex","_chooseSplitIndex","newNode","minOverlap","bbox1","bbox2","overlap","_allDistMargin","sort","leftBBox","rightBBox","margin","siblings","RtreeUtils"],"sourceRoot":""}