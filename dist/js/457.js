"use strict";(self.webpackChunkx_sheet=self.webpackChunkx_sheet||[]).push([[457],{7206:(e,t,i)=>{i.d(t,{$:()=>a});var s=i(6413),n=i(4223),r=i(7031),o=i(8559);class a extends r.n{constructor({snapshot:e=new n.a,merges:t=[]}={}){super({snapshot:e}),t.map((e=>s.p.valueOf(e))).forEach((e=>this.add(e)))}getData(){return{merges:this.getAll().map((e=>e.toString()))}}removeRow(e,t){let{rTree:i,snapshot:n}=this,a=new s.p(e,0,r.n.MAX_ROW,r.n.MAX_COL),h=this.getFullRowRange(e,t),l=o.K.rangeToBbox(h),c=o.K.rangeToBbox(a),m=[],d=[],x={undo:()=>{let{length:e}=m;for(let t=0;t<e;t++){const e=m[t];i.remove(e)}i.load(d)},redo:()=>{m=[],d=i.search(c);let{length:e}=d;for(let t=0;t<e;t++){const e=d[t],s={...e};if(i.remove(e),s.minY<l.minY){if(s.maxY<l.maxY){let e=s.maxY-l.minY;e+=1,s.oldMax=s.maxY,s.maxY-=e,s.style="oddValue",s.maxX===s.minX&&s.maxY===s.minY||m.push(s);continue}if(s.maxY>l.maxY){let e=l.maxY-c.minY;e+=1,s.oldMax=s.maxY,s.maxY-=e,s.style="oddValue",s.maxX===s.minX&&s.maxY===s.minY||m.push(s);continue}if(s.maxY===l.maxY){let e=l.maxY-c.minY;e+=1,s.oldMax=s.maxY,s.maxY-=e,s.style="oddValue",s.maxX===s.minX&&s.maxY===s.minY||m.push(s);continue}}if(s.minY>l.minY){if(s.minY<l.maxY&&s.maxY>l.maxY){let e=s.minY-l.minY,t=l.maxY-s.minY;t+=e+1,s.oldMax=s.maxY,s.oldMin=s.minY,s.maxY-=t,s.minY-=e,s.style="evenValue",s.maxX===s.minX&&s.maxY===s.minY||m.push(s);continue}if(s.minY>l.maxY){let e=l.maxY-l.minY;e+=1,s.oldMax=s.maxY,s.oldMin=s.minY,s.maxY-=e,s.minY-=e,s.style="evenValue",s.maxX===s.minX&&s.maxY===s.minY||m.push(s);continue}}if(s.minY===l.minY&&s.maxY>l.maxY){let e=l.maxY-s.minY;e+=1,s.oldMax=s.maxY,s.maxY-=e,s.style="oddValue",s.maxX===s.minX&&s.maxY===s.minY||m.push(s)}}i.load(m)}};n.addAction(x),x.redo()}removeCol(e,t){let{rTree:i,snapshot:n}=this,a=new s.p(0,e,r.n.MAX_ROW,r.n.MAX_COL),h=this.getFullColRange(e,t),l=o.K.rangeToBbox(h),c=o.K.rangeToBbox(a),m=[],d=[],x={undo:()=>{let{length:e}=m;for(let t=0;t<e;t++){const e=m[t];i.remove(e)}i.load(d)},redo:()=>{m=[],d=i.search(c);let{length:e}=d;for(let t=0;t<e;t++){const e=d[t],s={...e};if(i.remove(e),s.minX<l.minX){if(s.maxX<l.maxX){let e=s.maxX-l.minX;e+=1,s.oldMax=s.maxX,s.maxX-=e,s.style="oddValue",s.maxX===s.minX&&s.maxY===s.minY||m.push(s);continue}if(s.maxX>l.maxX){let e=l.maxX-c.minX;e+=1,s.oldMax=s.maxX,s.maxX-=e,s.style="oddValue",s.maxX===s.minX&&s.maxY===s.minY||m.push(s);continue}if(s.maxX===l.maxX){let e=l.maxX-c.minX;e+=1,s.oldMax=s.maxX,s.maxX-=e,s.style="oddValue",s.maxX===s.minX&&s.maxY===s.minY||m.push(s);continue}}if(s.minX>l.minX){if(s.minX<l.maxX&&s.maxX>l.maxX){let e=s.minX-l.minX,t=l.maxX-s.minX;t+=e+1,s.oldMax=s.maxX,s.oldMin=s.minX,s.maxX-=t,s.minX-=e,s.style="evenValue",s.maxX===s.minX&&s.maxY===s.minY||m.push(s);continue}if(s.minX>l.maxX){let e=l.maxX-l.minX;e+=1,s.oldMax=s.maxX,s.oldMin=s.minX,s.maxX-=e,s.minX-=e,s.style="evenValue",s.maxX===s.minX&&s.maxY===s.minY||m.push(s);continue}}if(s.minX===l.minX&&s.maxX>l.maxX){let e=l.maxX-s.minX;e+=1,s.oldMax=s.maxX,s.maxX-=e,s.style="oddValue",s.maxX===s.minX&&s.maxY===s.minY||m.push(s)}}i.load(m)}};n.addAction(x),x.redo()}insertColAfter(e,t){const{snapshot:i}=this,s={undo:()=>{this.colAfterShrink(e,t)},redo:()=>{this.colAfterExpand(e,t)}};i.addAction(s),s.redo()}insertColBefore(e,t){const{snapshot:i}=this,s={undo:()=>{this.colBeforeShrink(e,t)},redo:()=>{this.colBeforeExpand(e,t)}};i.addAction(s),s.redo()}insertRowAfter(e,t){const{snapshot:i}=this,s={undo:()=>{this.rowAfterShrink(e,t)},redo:()=>{this.rowAfterExpand(e,t)}};i.addAction(s),s.redo()}insertRowBefore(e,t){const{snapshot:i}=this,s={undo:()=>{this.rowBeforeShrink(e,t)},redo:()=>{this.rowBeforeExpand(e,t)}};i.addAction(s),s.redo()}}},4223:(e,t,i)=>{i.d(t,{a:()=>n});var s=i(3926);class n{constructor(){this.undoStack=[],this.redoStack=[],this.layer={event:"",data:[]},this.apply=!1,this.listen=new s.Z}undo(){const e=this.undoStack.pop();for(let t=e.data.length-1;t>=0;t--){e.data[t].undo()}this.redoStack.push(e),this.listen.execute("change",e.event,"undo")}redo(){const e=this.redoStack.pop();for(let t=0,i=e.data.length;t<i;t++){e.data[t].redo()}this.undoStack.push(e),this.listen.execute("change",e.event,"redo")}open(){this.layer={event:"",data:[]},this.apply=!0}canRedo(){return this.redoStack.length>0}canUndo(){return this.undoStack.length>0}close(e){this.layer.data.length&&(this.layer.event=e,this.redoStack=[],this.undoStack.push(this.layer)),this.layer={event:"",data:[]},this.apply=!1,this.listen.execute("change",e,"close")}addAction(e={undo:()=>{},redo:()=>{}}){this.apply&&this.layer.data.push(e)}}},7031:(e,t,i)=>{i.d(t,{n:()=>l});var s=i(4223),n=i(7838),r=i(3926),o=i(8559),a=i(8134),h=i(6413);class l{constructor({snapshot:e=new s.a}){this.snapshot=e,this.rTree=new n.n,this.listen=new r.Z}getFirstInclude(e,t){let{rTree:i}=this,s={minX:t,minY:e,maxX:t,maxY:e},n=i.first(s);return n?o.K.bboxToRange(n):a.F.Undef}getMasterInclude(e,t){const i=this.getFirstInclude(e,t);return i.sri===e&&i.sci===t?i:a.F.Undef}getIntersects(e){let{rTree:t}=this,i=o.K.rangeToBbox(e);return t.search(i).map((e=>o.K.bboxToRange(e)))}push(e){let{rTree:t}=this,i=o.K.rangeToBbox(e);return t.insert(i),this}shift(e){let{rTree:t}=this,i=o.K.rangeToBbox(e),s=t.search(i);for(let e=0,i=s.length;e<i;e++){let i=s[e];t.remove(i)}return this}add(e){let{listen:t,snapshot:i}=this,s={undo:()=>{this.shift(e)},redo:()=>{this.push(e),t.execute("add",e)}};i.addAction(s),s.redo()}delete(e){let{listen:t,snapshot:i}=this,s={undo:()=>{this.push(e)},redo:()=>{this.shift(e),t.execute("delete",e)}};i.addAction(s),s.redo()}batchDelete(e){let{listen:t,snapshot:i}=this,s={undo:()=>{e.forEach((e=>{this.push(e)}))},redo:()=>{e.forEach((e=>{this.shift(e)})),t.execute("batchDelete",e)}};i.addAction(s),s.redo()}getAll(){let{rTree:e}=this;return e.all().map((e=>o.K.bboxToRange(e)))}union(e){let{rTree:t}=this,i=o.K.rangeToBbox(e),s=t.search(i);if(0===s.length)return e;let n=e.clone();for(let e=0,t=s.length;e<t;e++){let t=o.K.bboxToRange(s[e]);n=n.union(t)}return n.equals(e)?e:this.union(n)}getFullRowRange(e,t){return new h.p(e,0,Math.max(e,e+t-1),l.MAX_COL)}getFullColRange(e,t){return new h.p(0,e,l.MAX_ROW,Math.max(e,e+t-1))}rowAfterExpand(e,t){let i={minX:0,minY:e,maxX:l.MAX_COL,maxY:l.MAX_ROW},{rTree:s}=this,n=s.search(i);for(let i=0,r=n.length;i<r;i++){let r=n[i];s.remove(r),r.minY>e&&(r.minY+=t),r.maxY>e&&(r.maxY+=t)}s.load(n)}colAfterExpand(e,t){const i={minX:e,minY:0,maxX:l.MAX_COL,maxY:l.MAX_ROW};let{rTree:s}=this,n=s.search(i);for(let i=0,r=n.length;i<r;i++){let r=n[i];s.remove(r),r.minX>e&&(r.minX+=t),r.maxX>e&&(r.maxX+=t)}s.load(n)}rowAfterShrink(e,t){let i={minX:0,minY:e,maxX:l.MAX_COL,maxY:l.MAX_ROW},{rTree:s}=this,n=s.search(i);for(let i=0,r=n.length;i<r;i++){let r=n[i];s.remove(r),r.minY>e&&(r.minY-=t),r.maxY>e&&(r.maxY-=t)}s.load(n)}colAfterShrink(e,t){const i={minX:e,minY:0,maxX:l.MAX_COL,maxY:l.MAX_ROW};let{rTree:s}=this,n=s.search(i);for(let i=0,r=n.length;i<r;i++){let r=n[i];s.remove(r),r.minX>e&&(r.minX-=t),r.maxX>e&&(r.maxX-=t)}s.load(n)}rowBeforeExpand(e,t){let i={minX:0,minY:e,maxX:l.MAX_COL,maxY:l.MAX_ROW},{rTree:s}=this,n=s.search(i);for(let i=0,r=n.length;i<r;i++){let r=n[i];s.remove(r),r.minY>=e&&(r.minY+=t),r.maxY>=e&&(r.maxY+=t)}s.load(n)}colBeforeExpand(e,t){const i={minX:e,minY:0,maxX:l.MAX_COL,maxY:l.MAX_ROW};let{rTree:s}=this,n=s.search(i);for(let i=0,r=n.length;i<r;i++){let r=n[i];s.remove(r),r.minX>=e&&(r.minX+=t),r.maxX>=e&&(r.maxX+=t)}s.load(n)}rowBeforeShrink(e,t){let i={minX:0,minY:e,maxX:l.MAX_COL,maxY:l.MAX_ROW},{rTree:s}=this,n=s.search(i);for(let i=0,r=n.length;i<r;i++){let r=n[i];s.remove(r),r.minY>=e&&(r.minY-=t),r.maxY>=e&&(r.maxY-=t)}s.load(n)}colBeforeShrink(e,t){const i={minX:e,minY:0,maxX:l.MAX_COL,maxY:l.MAX_ROW};let{rTree:s}=this,n=s.search(i);for(let i=0,r=n.length;i<r;i++){let r=n[i];s.remove(r),r.minX>=e&&(r.minX-=t),r.maxX>=e&&(r.maxX-=t)}s.load(n)}}l.MAX_COL=1433,l.MAX_ROW=1048576},6413:(e,t,i)=>{i.d(t,{p:()=>n});var s=i(8134);class n{constructor(e,t,i,s,n=0,r=0){this.sri=e,this.sci=t,this.eri=i,this.eci=s,this.w=n,this.h=r}each(e,t,i=(()=>!0)){const{sri:s,sci:n,eri:r,eci:o}=this;let a=!1;e.getRowIterator().setBegin(s).setEnd(r).setLoop((s=>(i(s)&&e.getColIterator().setBegin(n).setEnd(o).setLoop((e=>(a=t(s,e),a))).execute(),a))).execute()}set(e,t,i,s){this.sri=e,this.sci=t,this.eri=i,this.eci=s}multiple(){return this.eri-this.sri>0||this.eci-this.sci>0}includes(...e){let[t,i]=[0,0];1===e.length?[i,t]=s.F.expr2xy(e[0]):2===e.length&&([t,i]=e);const{sri:n,sci:r,eri:o,eci:a}=this;return n<=t&&t<=o&&r<=i&&i<=a}contains(e){return this.sri<=e.sri&&this.sci<=e.sci&&this.eri>=e.eri&&this.eci>=e.eci}within(e){return this.sri>=e.sri&&this.sci>=e.sci&&this.eri<=e.eri&&this.eci<=e.eci}disjoint(e){return this.sri>e.eri||this.sci>e.eci||e.sri>this.eri||e.sci>this.eci}intersects(e){return this.sri<=e.eri&&this.sci<=e.eci&&e.sri<=this.eri&&e.sci<=this.eci}union(e){const{sri:t,sci:i,eri:s,eci:r}=this;return new n(e.sri<t?e.sri:t,e.sci<i?e.sci:i,e.eri>s?e.eri:s,e.eci>r?e.eci:r)}coincide(e){const{sri:t,sci:i,eri:s,eci:r}=this;return this.disjoint(e)?n.EMPTY:new n(e.sri>t?e.sri:t,e.sci>i?e.sci:i,e.eri<s?e.eri:s,e.eci<r?e.eci:r)}coincideDifference(e){return this.coincide(e).equals(n.EMPTY)?[]:this.difference(e)}difference(e){const t=[],i=(e,i,s,r)=>{t.push(new n(e,i,s,r))},{sri:s,sci:r,eri:o,eci:a}=this,h=e.sri-s,l=e.sci-r,c=o-e.eri,m=a-e.eci;return h>0?(i(s,r,e.sri-1,a),c>0?(i(e.eri+1,r,o,a),l>0&&i(e.sri,r,e.eri,e.sci-1),m>0&&i(e.sri,e.eci+1,e.eri,a)):(l>0&&i(e.sri,r,o,e.sci-1),m>0&&i(e.sri,e.eci+1,o,a))):c>0&&(i(e.eri+1,r,o,a),l>0&&i(s,r,e.eri,e.sci-1),m>0&&i(s,e.eci+1,e.eri,a)),l>0?(i(s,r,o,e.sci-1),m>0?(i(s,e.eri+1,o,a),h>0&&i(s,e.sci,e.sri-1,e.eci),c>0&&i(e.sri+1,e.sci,o,e.eci)):(h>0&&i(s,e.sci,e.sri-1,a),c>0&&i(e.sri+1,e.sci,o,a))):m>0&&(i(s,e.eci+1,o,a),h>0&&i(s,r,e.sri-1,e.eci),c>0&&i(e.eri+1,r,o,e.eci)),t}size(){return[this.eri-this.sri+1,this.eci-this.sci+1]}brink(){const{sri:e,eri:t,sci:i,eci:s}=this,r=new n(e,i,e,s),o=new n(t,i,t,s);return{top:r,right:new n(e,s,t,s),bottom:o,left:new n(e,i,t,i)}}point(){const{sri:e,eri:t,sci:i,eci:s}=this;return{lt:new n(e,i,e,i),rt:new n(e,s,e,s),lb:new n(t,i,t,i),rb:new n(t,s,t,s)}}equals(e){return this.eri===e.eri&&this.eci===e.eci&&this.sri===e.sri&&this.sci===e.sci}clone(){const{sri:e,sci:t,eri:i,eci:s,w:r,h:o}=this;return new n(e,t,i,s,r,o)}toString(){const{sri:e,sci:t,eri:i,eci:n}=this;let r=s.F.xy2expr(t,e);return this.multiple()&&(r=`${r}:${s.F.xy2expr(n,i)}`),r}static valueOf(e){const t=e.split(":"),[i,r]=s.F.expr2xy(t[0]);let[o,a]=[r,i];return t.length>1&&([a,o]=s.F.expr2xy(t[1])),new n(r,i,o,a)}}n.EMPTY=new n(-1,-1,-1,-1)},9457:(e,t,i)=>{i.d(t,{n:()=>h});var s=i(4924),n=i(8134),r=i(3926),o=i(7206),a=i(4223);class h extends class{constructor({data:e=[]}){this.data=e}getItems(e){let{data:t}=this;return t[e]}clear(e,{ignoreCorner:t=!1}={}){let{sri:i,eri:s}=e,{sci:n,eci:r}=e,{data:o}=this,{snapshot:a}=this,{length:h}=o,l=[],c=s-i+1,m=r-n+1,d={undo:()=>{for(let e=i;e<=s&&!(e>=h);e++){let s=l[e],a=o[e];if(a)for(let o=n;o<=r&&!(o>=h);o++)if(t){let t=o===n;if(e===i&&t)continue;a[o]=s[o]}else a[o]=s[o]}},redo:()=>{l=new Array(c);for(let e=i;e<=s&&!(e>=h);e++){let s=o[e];if(s){let o=new Array(m),{length:a}=s;for(let h=n;h<=r&&!(h>=a);h++)if(t){let t=h===n;if(e===i&&t)continue;o[h]=s[h],s[h]=void 0}else o[h]=s[h],s[h]=void 0;l[e]=o}}}};a.addAction(d),d.redo()}shift(){return this.data.shift()}slice(e,t,i,s){return this.data.slice(e,i+1).map((e=>e?e.slice(t,s+1):e))}getData(){return this.data}getLength(){return this.data.length}hasItems(e){return n.F.isDef(this.getItems(e))}getItemsOrNew(e){let{data:t}=this,i=t[e];return n.F.isUnDef(i)&&(i=[],t[e]=i),i}}{static wrapCell(e){if(e instanceof s.b)return e;if(n.F.isString(e)){let t={text:e};return new s.b(t)}if(n.F.isDef(e)){let t=e.cell?e.cell:e;return new s.b(t)}return e}constructor({snapshot:e=new a.a,data:t=[],merges:i=new o.$}={}){super({data:t}),this.snapshot=e,this.merges=i,this.listen=new r.Z}getCellOrNew(e,t){if(e<0)throw new TypeError(`错误的行号${e}`);if(t<0)throw new TypeError(`错误的列号${t}`);let i=this.getCell(e,t);if(n.F.isUnDef(i)){let n=this.getItemsOrNew(e);i=new s.b,n[t]=i}return i}getCell(e,t){let{data:i}=this,s=i[e];if(s){const e=h.wrapCell(s[t]);return s[t]=e,e}return n.F.Undef}each(e){const{data:t}=this;for(let i=0,s=t.length;i<s;i++){let s=t[i];if(s)for(let t=0,n=s.length;t<n;t++){e(this.getCell(i,t))}}}getCellOrMergeCell(e,t){const{merges:i}=this,s=i.getFirstInclude(e,t);return s?this.getCell(s.sri,s.sci):this.getCell(e,t)}hasCell(e,t){return n.F.isDef(this.getCell(e,t))}setCell(e,t,i){if(e<0)throw new TypeError(`错误的行号${e}`);if(t<0)throw new TypeError(`错误的列号${t}`);let{listen:s,snapshot:n}=this,r=this.getCell(e,t);if(r){let o={undo:()=>{this.getItems(e)[t]=r,s.execute("change",{ri:e,ci:t,oldValue:r})},redo:()=>{this.getItemsOrNew(e)[t]=i,s.execute("change",{ri:e,ci:t,oldValue:r})}};n.addAction(o),o.redo()}}setCellOrNew(e,t,i){if(e<0)throw new TypeError(`错误的行号${e}`);if(t<0)throw new TypeError(`错误的列号${t}`);let{listen:s,snapshot:n}=this,r=this.hasCell(e,t),o=this.hasItems(e),a=this.getCell(e,t),h={undo:()=>{if(o){const i=this.getItems(e);r?i[t]=a:i.splice(t,1),s.execute("change",{ri:e,ci:t,oldValue:a})}else{this.getData().splice(e,1),s.execute("change",{ri:e,ci:t,oldValue:a})}},redo:()=>{if(o){this.getItems(e)[t]=i,s.execute("change",{ri:e,ci:t,oldValue:a})}else{this.getItemsOrNew(e)[t]=i,s.execute("change",{ri:e,ci:t,oldValue:a})}}};n.addAction(h),h.redo()}removeRow(e){let t,{snapshot:i}=this,s={undo:()=>{t&&this.data.splice(e,0,t)},redo:()=>{t=this.data.splice(e,1)[0]}};i.addAction(s),s.redo()}removeCol(e){let{snapshot:t}=this,i=[],s={undo:()=>{let{length:t}=i;for(let s=0;s<t;s++){const t=i[s],{ri:n,item:r}=t;this.data[n].splice(e,0,r)}},redo:()=>{let{length:t}=this.data;i=[];for(let s=0;s<t;s++){const t=this.data[s];if(t){const n=t.splice(e,1)[0];i.push({ri:s,item:n})}}}};t.addAction(s),s.redo()}copyRowStyle(e){let t=this.data[e],i=[];if(t)for(let s=0,n=t.length;s<n;s++){t[s]&&(i[s]=this.getCell(e,s).cloneStyle())}return i}insertRowAfter(e){let{snapshot:t}=this,i=e+1,s={undo:()=>{this.data.splice(i,1)},redo:()=>{const e=this.copyRowStyle(i);this.data.splice(i,0,e)}};t.addAction(s),s.redo()}insertColAfter(e){let{snapshot:t}=this,i=e+1,s={undo:()=>{for(let e=0,t=this.data.length;e<t;e++){const t=this.data[e];t&&t.splice(i,1)}},redo:()=>{for(let e=0,t=this.data.length;e<t;e++){const t=this.data[e];if(t){const s=this.getCell(e,i),n=s?s.cloneStyle():void 0;t.splice(i,0,n)}}}};t.addAction(s),s.redo()}insertRowBefore(e){let{snapshot:t}=this,i=e,s={undo:()=>{this.data.splice(i,1)},redo:()=>{const e=this.copyRowStyle(i);this.data.splice(i,0,e)}};t.addAction(s),s.redo()}insertColBefore(e){let{snapshot:t}=this,i=e,s={undo:()=>{for(let e=0,t=this.data.length;e<t;e++){const t=this.data[e];t&&t.splice(i,1)}},redo:()=>{for(let e=0,t=this.data.length;e<t;e++){const t=this.data[e];if(t){const s=this.getCell(e,i),n=s?s.cloneStyle():void 0;t.splice(i,0,n)}}}};t.addAction(s),s.redo()}}},3926:(e,t,i)=>{i.d(t,{Z:()=>s});class s{constructor(){this.pool={}}clear(){Object.keys((e=>{delete this.pool[e]}))}removeListen(e){delete this.pool[e]}registerListen(e,t){this.pool[e]=t}execute(e,...t){this.pool[e]&&this.pool[e](...t)}}},3574:(e,t,i)=>{function s(e,t){return e<t?-1:e>t?1:0}function n(e,t,i){let s=e[t];e[t]=e[i],e[i]=s}function r(e,t,i,s,o){for(;s>i;){if(s-i>600){let n=s-i+1,a=t-i+1,h=Math.log(n),l=.5*Math.exp(2*h/3),c=.5*Math.sqrt(h*l*(n-l)/n)*(a-n/2<0?-1:1);r(e,t,Math.max(i,Math.floor(t-a*l/n+c)),Math.min(s,Math.floor(t+(n-a)*l/n+c)),o)}let a=e[t],h=i,l=s;for(n(e,i,t),o(e[s],a)>0&&n(e,i,s);h<l;){for(n(e,h,l),h++,l--;o(e[h],a)<0;)h++;for(;o(e[l],a)>0;)l--}0===o(e[i],a)?n(e,i,l):(l++,n(e,l,s)),l<=t&&(i=l+1),t<=l&&(s=l-1)}}function o(e,t,i,n,o){r(e,t,i||0,n||e.length-1,o||s)}i.d(t,{P:()=>o})},7838:(e,t,i)=>{i.d(t,{n:()=>X});var s=i(3574);function n(e,t,i){if(!i)return t.indexOf(e);for(let s=0;s<t.length;s++)if(i(e,t[s]))return s;return-1}function r(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function o(e,t){return e.minX-t.minX}function a(e,t){return e.minY-t.minY}function h(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function l(e){return e.maxX-e.minX+(e.maxY-e.minY)}function c(e,t){const i=Math.max(e.minX,t.minX),s=Math.max(e.minY,t.minY),n=Math.min(e.maxX,t.maxX),r=Math.min(e.maxY,t.maxY);return Math.max(0,n-i)*Math.max(0,r-s)}function m(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function d(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function x(e){return{childrenNodes:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function u(e,t,i,s,n){n||(n=x(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(let o=t;o<i;o++){const t=e.childrenNodes[o];r(n,e.leaf?s(t):t)}return n}function f(e,t){u(e,0,e.childrenNodes.length,t,e)}function p(e,t,i,n,r){const o=[t,i];for(;o.length;){if((i=o.pop())-(t=o.pop())<=n)continue;const a=t+Math.ceil((i-t)/n/2)*n;(0,s.P)(e,a,t,i,r),o.push(t,a,a,i)}}class X{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!d(e,t))return i;const s=this.toBBox,n=[];for(;t;){for(let r=0;r<t.childrenNodes.length;r++){const o=t.childrenNodes[r],a=t.leaf?s(o):o;d(e,a)&&(t.leaf?i.push(o):m(e,a)?this._all(o,i):n.push(o))}t=n.pop()}return i}first(e){return this.search(e)[0]}collides(e){let t=this.data;if(!d(e,t))return!1;const i=[];for(;t;){for(let s=0;s<t.childrenNodes.length;s++){const n=t.childrenNodes[s],r=t.leaf?this.toBBox(n):n;if(d(e,r)){if(t.leaf||m(e,r))return!0;i.push(n)}}t=i.pop()}return!1}load(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(let t=0;t<e.length;t++)this.insert(e[t]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(this.data.childrenNodes.length)if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const e=this.data;this.data=t,t=e}this._insert(t,this.data.height-t.height-1,!0)}else this.data=t;return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=x([]),this}remove(e,t){if(!e)return this;let i=this.data;const s=this.toBBox(e),r=[],o=[];let a,h,l;for(;i||r.length;){if(i||(i=r.pop(),h=r[r.length-1],a=o.pop(),l=!0),i.leaf){const s=n(e,i.childrenNodes,t);if(-1!==s)return i.childrenNodes.splice(s,1),r.push(i),this._condense(r),this}l||i.leaf||!m(i,s)?h?(a++,i=h.childrenNodes[a],l=!1):i=null:(r.push(i),o.push(a),a=0,h=i,i=i.childrenNodes[0])}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.childrenNodes):i.push(...e.childrenNodes),e=i.pop();return t}_build(e,t,i,s){const n=i-t+1;let r,o=this._maxEntries;if(n<=o)return r=x(e.slice(t,i+1)),f(r,this.toBBox),r;s||(s=Math.ceil(Math.log(n)/Math.log(o)),o=Math.ceil(n/o**(s-1))),r=x([]),r.leaf=!1,r.height=s;const a=Math.ceil(n/o),h=a*Math.ceil(Math.sqrt(o));p(e,t,i,h,this.compareMinX);for(let n=t;n<=i;n+=h){const t=Math.min(n+h-1,i);p(e,n,t,a,this.compareMinY);for(let i=n;i<=t;i+=a){const n=Math.min(i+a-1,t);r.childrenNodes.push(this._build(e,i,n,s-1))}}return f(r,this.toBBox),r}_chooseSubtree(e,t,i,s){for(;s.push(t),!t.leaf&&s.length-1!==i;){let i,s=1/0,o=1/0;for(let a=0;a<t.childrenNodes.length;a++){const l=t.childrenNodes[a],c=h(l),m=(n=e,r=l,(Math.max(r.maxX,n.maxX)-Math.min(r.minX,n.minX))*(Math.max(r.maxY,n.maxY)-Math.min(r.minY,n.minY))-c);m<o?(o=m,s=c<s?c:s,i=l):m===o&&c<s&&(s=c,i=l)}t=i||t.childrenNodes[0]}var n,r;return t}_insert(e,t,i){const s=i?e:this.toBBox(e),n=[],o=this._chooseSubtree(s,this.data,t,n);for(o.childrenNodes.push(e),r(o,s);t>=0&&n[t].childrenNodes.length>this._maxEntries;)this._split(n,t),t--;this._adjustParentBBoxes(s,n,t)}_split(e,t){const i=e[t],s=i.childrenNodes.length,n=this._minEntries;this._chooseSplitAxis(i,n,s);const r=this._chooseSplitIndex(i,n,s),o=x(i.childrenNodes.splice(r,i.childrenNodes.length-r));o.height=i.height,o.leaf=i.leaf,f(i,this.toBBox),f(o,this.toBBox),t?e[t-1].childrenNodes.push(o):this._splitRoot(i,o)}_splitRoot(e,t){this.data=x([e,t]),this.data.height=e.height+1,this.data.leaf=!1,f(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let s,n=1/0,r=1/0;for(let o=t;o<=i-t;o++){const t=u(e,0,o,this.toBBox),a=u(e,o,i,this.toBBox),l=c(t,a),m=h(t)+h(a);l<n?(n=l,s=o,r=m<r?m:r):l===n&&m<r&&(r=m,s=o)}return s||i-t}_chooseSplitAxis(e,t,i){const s=e.leaf?this.compareMinX:o,n=e.leaf?this.compareMinY:a;this._allDistMargin(e,t,i,s)<this._allDistMargin(e,t,i,n)&&e.childrenNodes.sort(s)}_allDistMargin(e,t,i,s){e.childrenNodes.sort(s);const n=this.toBBox,o=u(e,0,t,n),a=u(e,i-t,i,n);let h=l(o)+l(a);for(let s=t;s<i-t;s++){const t=e.childrenNodes[s];r(o,e.leaf?n(t):t),h+=l(o)}for(let s=i-t-1;s>=t;s--){const t=e.childrenNodes[s];r(a,e.leaf?n(t):t),h+=l(a)}return h}_adjustParentBBoxes(e,t,i){for(let s=i;s>=0;s--)r(t[s],e)}_condense(e){for(let t,i=e.length-1;i>=0;i--)0===e[i].childrenNodes.length?i>0?(t=e[i-1].childrenNodes,t.splice(t.indexOf(e[i]),1)):this.clear():f(e[i],this.toBBox)}}},8559:(e,t,i)=>{i.d(t,{K:()=>n});var s=i(6413);class n{static bboxToRange(e){return new s.p(e.minY,e.minX,e.maxY,e.maxX)}static rangeToBbox(e){return{minX:e.sci,minY:e.sri,maxX:e.eci,maxY:e.eri}}}}}]);
//# sourceMappingURL=457.js.map