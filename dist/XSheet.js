!function(t){var e={};function r(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(o,n,function(e){return t[e]}.bind(null,n));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=6)}([function(t,e,r){t.exports=r.p+"c4ab8001e109540f7ae6a34181d695d3.png"},function(t,e,r){t.exports=r.p+"42b436e7c64603182355d52d31ea49f1.png"},function(t,e,r){t.exports=r.p+"9dfd8685ea7e1e5c025514eec46a4547.png"},function(t,e,r){},function(t,e,r){},function(t,e){window.purchaseOrder={name:"采购",tableConfig:{table:{showGrid:!1},rows:{len:35,data:[{height:10},null,{height:55},null,null,null,null,{height:76}]},cols:{len:8,data:[{width:54},{width:100},{width:98},{width:93},{width:81},{width:114},{width:105}]},merges:{data:["B3:E3","B4:D4","B5:D5","B6:E6","B8:H8","B10:C10","D10:E10","B11:C11","D11:E11","F10:G10","F11:G11","B13:C13","B14:C14","D13:E13","D14:E14","F13:G13","F14:G14","B17:C17","B18:C18","B19:C19","B20:C20","B21:C21","B22:E22","B23:E23","F17:H17","F18:H18","F19:H19","F20:H20","F21:H21","F22:H22","F23:H23","F31:G31","F32:G32","F33:G33","F34:G34","G35:H35"]},data:[[{ID:"1584265551097",text:"",format:"default",background:"#293791",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265551097",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265589531",text:"",format:"default",background:"#293791",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265589531",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265589531",text:"",format:"default",background:"#293791",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265589531",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265589531",text:"",format:"default",background:"#293791",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265589531",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265589531",text:"",format:"default",background:"#293791",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265589531",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265589531",text:"",format:"default",background:"#293791",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265589531",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265589531",text:"",format:"default",background:"#293791",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265589531",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265589531",text:"",format:"default",background:"#293791",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265589531",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265548500",text:"",format:"default",background:"#293791",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265548500",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[{ID:"1584268542700",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268542700",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584268756905",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268756905",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},null,null,null,null,null,null,{ID:"1584268552706",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268552706",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[{ID:"1584265598114",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265598114",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265666862",text:"您的公司名称",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#6e65e6",name:"Arial",size:"36",bold:!1,italic:!1},borderAttr:{time:"1584265666862",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265695756",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#6e65e6",name:"Arial",size:"24",bold:!1,italic:!1},borderAttr:{time:"1584265695756",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265695756",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#6e65e6",name:"Arial",size:"24",bold:!1,italic:!1},borderAttr:{time:"1584265695756",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265695756",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#6e65e6",name:"Arial",size:"24",bold:!1,italic:!1},borderAttr:{time:"1584265695756",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},null,null,null,{ID:"1584268685046",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268685046",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584265734229",text:"省名称城市名称",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#666666",name:"Arial",size:"14",bold:!1,italic:!1},borderAttr:{time:"1584265734229",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265956137",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#666666",name:"Arial",size:"14",bold:!1,italic:!1},borderAttr:{time:"1584265956137",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265956137",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#666666",name:"Arial",size:"14",bold:!1,italic:!1},borderAttr:{time:"1584265956137",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265956137",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"14",bold:!1,italic:!1},borderAttr:{time:"1584265956137",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584265769035",text:"街道名称123号, 邮编: 123456",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#666666",name:"Arial",size:"14",bold:!1,italic:!1},borderAttr:{time:"1584265769035",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265684973",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#666666",name:"Arial",size:"14",bold:!1,italic:!1},borderAttr:{time:"1584265684973",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265956137",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#666666",name:"Arial",size:"14",bold:!1,italic:!1},borderAttr:{time:"1584265956137",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265956137",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"14",bold:!1,italic:!1},borderAttr:{time:"1584265956137",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584268660574",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268660574",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},null,{ID:"1584267762858",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267762858",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584268551819",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268551819",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584265817355",text:"(+86) 00000000000",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#666666",name:"Arial",size:"14",bold:!1,italic:!1},borderAttr:{time:"1584265817355",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265729405",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#666666",name:"Arial",size:"14",bold:!1,italic:!1},borderAttr:{time:"1584265729405",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265956137",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#666666",name:"Arial",size:"14",bold:!1,italic:!1},borderAttr:{time:"1584265956137",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265956137",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#666666",name:"Arial",size:"14",bold:!1,italic:!1},borderAttr:{time:"1584265956137",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},null,{ID:"1584268776505",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268776505",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,null,null,{ID:"1584265697565",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265697565",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584268628927",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268628927",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584266025831",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584266025831",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267233930",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267233930",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584265841044",text:"采购订单",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:"36",bold:!0,italic:!1},borderAttr:{time:"1584265841043",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265829570",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:"36",bold:!0,italic:!1},borderAttr:{time:"1584265829570",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265827658",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:"36",bold:!0,italic:!1},borderAttr:{time:"1584265827658",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584266925407",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:"36",bold:!0,italic:!1},borderAttr:{time:"1584266925407",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584266925407",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:"36",bold:!0,italic:!1},borderAttr:{time:"1584266925407",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584266925407",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:"36",bold:!0,italic:!1},borderAttr:{time:"1584266925407",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584266925407",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:"36",bold:!0,italic:!1},borderAttr:{time:"1584266925407",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584268550979",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268550979",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584265861443",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265861443",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267034578",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267034578",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584266907248",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584266907248",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265933049",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265933049",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267463928",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267463928",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584265864100",text:"日期",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584265864100",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584266981675",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584266981675",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265882100",text:"发票",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584265882100",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265590321",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584265590321",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265998087",text:"采购订单号",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584265998087",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267004960",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584267004960",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584265873947",text:"2000年9月7日",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267014208",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267014208",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"#123456",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"#123456",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},null,{ID:"1584268625622",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268625622",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,null,{ID:"1584266061000",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584266061000",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265890363",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265890363",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267091618",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267091618",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},null,null,{ID:"1584267061601",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267061601",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584266033671",text:"发运日期",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584266033671",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267026656",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584267026656",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584266063504",text:"运输方式",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584266063504",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267028537",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584267028537",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584266087704",text:"条款",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584266087704",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267045048",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584267045048",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},null,{ID:"1584268625327",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268625327",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584265873947",text:"2000年9月14日",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"货运公司",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"货运和付款条款",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584267068249",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268839422",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584267082938",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268839422",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584267082938",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268839422",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584267082938",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268839422",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584267082938",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268839422",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584267082938",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268839422",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584267082938",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268839422",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584268624575",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268624575",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,null,null,null,null,null,null,null,{ID:"1584268626159",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268626159",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584266140730",text:"供应商",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584266140730",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267107537",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584267107537",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},null,null,{ID:"1584266267125",text:"收货方",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584266267125",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267119753",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"18",bold:!1,italic:!1},borderAttr:{time:"1584267119753",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267119753",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:"18",bold:!1,italic:!1},borderAttr:{time:"1584267119753",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584268840007",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268840007",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584266165122",text:"姓名",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!0,italic:!1},borderAttr:{time:"1584266165122",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267115258",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!0,italic:!1},borderAttr:{time:"1584267115258",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},null,null,{ID:"1584266318641",text:"您的姓名",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!0,italic:!1},borderAttr:{time:"1584266318641",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267121234",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!0,italic:!1},borderAttr:{time:"1584267121234",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267121234",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!0,italic:!1},borderAttr:{time:"1584267121234",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584268626534",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268626534",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584265873947",text:"公司名称",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"您的公司名称",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584265873947",text:"街道地址",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"街道名称 123 号",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584265873947",text:"省名称城市名称，邮编",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"省名称城市名称，邮编：123456",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584265873947",text:"(+86) 00000000000",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"(+86) 00000000000",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584265873947",text:"no_reply@example.com",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"no_reply@example.com",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267307347",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267307347",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584267163033",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268846398",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584267168869",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268846398",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584267168869",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268846398",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584267168869",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268846398",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584267168869",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268846398",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584267168869",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268846398",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584267168869",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268846398",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584268852279",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268852279",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267447288",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267447288",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,null,null,null,null,{ID:"1584266627638",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584266627638",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},null,null,{ID:"1584267479264",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267479264",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584266534709",text:"产品编号",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584266534709",text:"说明",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584267363401",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584267363401",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584266534709",text:"数量",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584266534709",text:"单价",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584266534709",text:"总价",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:"18",bold:!0,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584267580321",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267580321",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267519616",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267519616",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584265873947",text:"12345-A",format:"default",background:"rgb(239, 239, 239)",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584265873947",text:"产品 A",format:"default",background:"rgb(239, 239, 239)",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584266652262",text:"",format:"default",background:"rgb(239, 239, 239)",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584267363401",text:"",format:"default",background:"rgb(239, 239, 239)",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584265873947",text:"1",format:"default",background:"rgb(239, 239, 239)",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584265873947",text:"200",format:"default",background:"rgb(239, 239, 239)",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584265873947",text:"200",format:"default",background:"rgb(239, 239, 239)",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584267306627",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267306627",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584265873947",text:"12345-B",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584265873947",text:"产品 B",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584266600670",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584267363401",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584265873947",text:"2",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584265873947",text:"200",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584265873947",text:"400",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584267485848",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267485848",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,{ID:"1584267363401",text:"",format:"default",background:"rgb(239, 239, 239)",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584267363401",text:"",format:"default",background:"rgb(239, 239, 239)",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584267363401",text:"",format:"default",background:"rgb(239, 239, 239)",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584267363401",text:"",format:"default",background:"rgb(239, 239, 239)",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584267363401",text:"",format:"default",background:"rgb(239, 239, 239)",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584266634294",text:"",format:"default",background:"rgb(239, 239, 239)",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584265873947",text:"0",format:"default",background:"rgb(239, 239, 239)",fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267363401",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000",type:0}}},{ID:"1584268614543",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268614543",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[{ID:"1584266731310",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584266731310",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267363401",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268851798",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584267363401",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268851798",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584267363401",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268851798",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584267363401",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268851798",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584267363401",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268851798",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584266681734",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268851798",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584265873947",text:"0",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584268851798",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!0,width:2,color:"rgb(217, 217, 217)",type:0}}},{ID:"1584267544032",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267544032",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,null,null,{ID:"1584266822680",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584266822680",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},null,{ID:"1584266766295",text:"小计",format:"default",background:null,fontAttr:{align:"right",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584266766295",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267250418",text:"",format:"default",background:null,fontAttr:{align:"right",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267250418",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267281659",text:"600.00",format:"rmb",background:null,fontAttr:{align:"right",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!0,italic:!1},borderAttr:{time:"1584267281659",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267216738",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267216738",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267640975",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267640975",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,null,null,null,null,{ID:"1584266787318",text:"运输和搬运",format:"default",background:null,fontAttr:{align:"right",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584266787318",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584266726118",text:"",format:"default",background:null,fontAttr:{align:"right",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584266726118",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"20.00",format:"rmb",background:null,fontAttr:{align:"right",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267576368",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267576368",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,null,null,null,null,{ID:"1584266799119",text:"税率",format:"default",background:null,fontAttr:{align:"right",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584266799119",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584266798671",text:"",format:"default",background:null,fontAttr:{align:"right",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584266798671",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"8.60",format:"default",background:null,fontAttr:{align:"right",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},null,{ID:"1584267646479",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267646479",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,null,null,null,{ID:"1584267364473",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267364473",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584266813030",text:"销售税",format:"default",background:null,fontAttr:{align:"right",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584266813030",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267250418",text:"",format:"default",background:null,fontAttr:{align:"right",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#293791",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267250418",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584265873947",text:"51.60",format:"rmb",background:null,fontAttr:{align:"right",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(67, 67, 67)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584265873947",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],[null,null,null,null,null,null,{ID:"1584266837999",text:"670.60",format:"rmb",background:null,fontAttr:{align:"right",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#de1d84",name:"Arial",size:"24",bold:!0,italic:!1},borderAttr:{time:"1584266837999",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}},{ID:"1584267306034",text:"",format:"rmb",background:null,fontAttr:{align:"right",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"#de1d84",name:"Arial",size:"24",bold:!0,italic:!1},borderAttr:{time:"1584267306034",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}],null,[null,null,null,null,{ID:"1584267369441",text:"",format:"default",background:null,fontAttr:{align:"left",verticalAlign:"middle",textWrap:1,strikethrough:!1,underline:!1,color:"rgb(0,0,0)",name:"Arial",size:14,bold:!1,italic:!1},borderAttr:{time:"1584267369441",left:{display:!1,width:1,color:"#000000"},top:{display:!1,width:1,color:"#000000"},right:{display:!1,width:1,color:"#000000"},bottom:{display:!1,width:1,color:"#000000"}}}]]}}},function(t,e,r){"use strict";r.r(e);var o={};o.SYSTEM_EVENT_TYPE={MOUSE_MOVE:"mouseMove".toLocaleLowerCase(),MOUSE_DOWN:"mouseDown".toLocaleLowerCase(),MOUSE_UP:"mouseUp".toLocaleLowerCase(),MOUSE_OVER:"mouseOver".toLocaleLowerCase(),MOUSE_LEAVE:"mouseLeave".toLocaleLowerCase(),MOUSE_WHEEL:"mouseWheel".toLocaleLowerCase(),MOUSE_ENTER:"mouseEnter".toLocaleLowerCase(),CLICK:"click".toLocaleLowerCase(),KEY_DOWN:"keyDown".toLocaleLowerCase(),KEY_UP:"keyUp".toLocaleLowerCase(),DRAG_START:"dragStart".toLocaleLowerCase(),SCROLL:"scroll".toLocaleLowerCase(),RESIZE:"resize".toLocaleLowerCase(),CHANGE:"change".toLocaleLowerCase(),INPUT:"input".toLocaleLowerCase(),VISIBILITY_CHANGE:"visibilityChange".toLocaleLowerCase()},o.TABLE_EVENT_TYPE={CHANGE_HEIGHT:"tableChangeHeight".toLocaleLowerCase(),CHANGE_WIDTH:"tableChangeWidth".toLocaleLowerCase(),DATA_CHANGE:"tableDataChange".toLocaleLowerCase(),SELECT_CHANGE:"tableSelectChange".toLocaleLowerCase(),SELECT_DOWN:"tableSelectDown".toLocaleLowerCase()},o.WORK_BODY_EVENT_TYPE={CHANGE_ACTIVE:"workBodyChangeActive".toLocaleLowerCase()},o.MOUSE_POINTER_TYPE={SELECT_ONE_COLUMN:{key:Symbol("选择一列"),type:"s-resize"},SELECT_ONE_ROW:{key:Symbol("选择一行"),type:"e-resize"},SELECT_CELL:{key:Symbol("选择单元格"),type:"cell"},AUTO_FILL:{key:Symbol("单元格内容自动填充"),type:"crosshair"},COL_RESIZE:{key:Symbol("调整列宽"),type:"col-resize"},ROW_RESIZE:{key:Symbol("调整行高"),type:"row-resize"}};var n="x-sheet";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var r=[],o=!0,n=!1,i=void 0;try{for(var l,c=t[Symbol.iterator]();!(o=(l=c.next()).done)&&(r.push(l.value),!e||r.length!==e);o=!0);}catch(t){n=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(n)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var a=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],s=null,u=1,f=2,h=3,d=5,p=6,y=7,b=8,g=9,w=10,v=11,m=12,x=13,O=14,k=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,o;return e=t,r=null,o=[{key:"type",value:function(t){var e=Object.prototype.toString.call(t);switch(e){case"[object Null]":return y;case"[object Undefined]":return b;case"[object String]":return u;case"[object Boolean]":return f;case"[object Number]":return h;case"[object Function]":return p;case"[object Array]":return d;case"[object Promise]":return g;case"[object GeneratorFunction]":return w;case"[object AsyncFunction]":return v;case"[object BigInt]":return m;case"[object Symbol]":return x;default:return O}}},{key:"cloneDeep",value:function(t){var e=JSON.stringify(t);return JSON.parse(e)}},{key:"mergeDeep",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.isUnDef(e))return{};for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];return t.isUnDef(o)||0===o.length?e:(o.forEach((function(r){t.isUnDef(r)||Object.keys(r).forEach((function(o){var n=r[o];"string"==typeof n||"number"==typeof n||"boolean"==typeof n?e[o]=n:"function"!=typeof n&&!Array.isArray(n)&&t.isPlainObject(n)?(e[o]=e[o]||{},t.mergeDeep(e[o],n)):e[o]=n}))})),e)}},{key:"copyProp",value:function(t,e){return Object.assign(t,e)}},{key:"isMac",value:function(){return/macintosh|mac os x/i.test(navigator.userAgent)}},{key:"isWindows",value:function(){return/windows|win32/i.test(navigator.userAgent)}},{key:"isEmptyObject",value:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}},{key:"isNotEmptyObject",value:function(e){return!t.isEmptyObject(e)}},{key:"isUnDef",value:function(t){return null==t}},{key:"isNotUnDef",value:function(t){return!this.isUnDef(t)}},{key:"isNotZero",value:function(t){return 0!==t}},{key:"isNumber",value:function(t){return/^(-?\d+.\d+)$|^(-?\d+)$/.test(t)}},{key:"isFraction",value:function(t){return/^\d+\/\d+$/.test(t)}},{key:"isFunction",value:function(e){return t.type(e)===p}},{key:"isArray",value:function(e){return t.type(e)===d}},{key:"isBlank",value:function(e){return!!t.isUnDef(e)||""===e.toString()}},{key:"isPlainObject",value:function(e){return!t.isUnDef(e)&&Object.getPrototypeOf(e)===Object.getPrototypeOf({})}},{key:"isString",value:function(e){return t.type(e)===u}},{key:"sum",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},r=0,o=0;return Object.keys(t).forEach((function(n){r+=e(t[n],n),o+=1})),[r,o]}},{key:"rangeSum",value:function(t,e,r){for(var o=0,n=t;n<e;n+=1)o+=r(n);return o}},{key:"parseFloat",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(e){return t.isNumber(e)?parseFloat(e):0}))},{key:"parseInt",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(e){return t.isNumber(e)?parseInt(e,10):0}))},{key:"stringAt",value:function(t){for(var e="",r=t;r>=a.length;)r/=a.length,r-=1,e+=a[parseInt(r,10)%a.length];return e+=a[t%a.length]}},{key:"indexAt",value:function(t){for(var e=0,r=0;r<t.length-1;r+=1){var o=t.charCodeAt(r)-65,n=t.length-1-r;e+=Math.pow(a.length,n)+a.length*o}return e+=t.charCodeAt(t.length-1)-65}},{key:"expr2xy",value:function(e){for(var r="",o="",n=0;n<e.length;n+=1)e.charAt(n)>="0"&&e.charAt(n)<="9"?o+=e.charAt(n):r+=e.charAt(n);return[t.indexAt(r),parseInt(o,10)-1]}},{key:"xy2expr",value:function(e,r){return"".concat(t.stringAt(e)).concat(r+1)}},{key:"expr2expr",value:function(e,r,o){var n=l(t.expr2xy(e),2),i=n[0],c=n[1];return t.xy2expr(i+r,c+o)}},{key:"rangeReduceIf",value:function(t,e,r,o,n,i){for(var l=r,c=o,a=t;a<e&&!(l>=n);a+=1)l+=c=i(a);return[a,l-c,c]}},{key:"throttle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;s&&clearTimeout(s),s=setTimeout(t,e)}},{key:"contrastDifference",value:function(e,r){var o={};if(t.isUnDef(e)||t.isUnDef(r))return o;for(var n in e)if(e.hasOwnProperty(n)){var i=r[n],l=e[n];t.isUnDef(i)||t.isUnDef(l)||t.equal(i,l)||(o[n]=e[n])}return o}},{key:"minIf",value:function(t,e){return t<e?e:t}},{key:"maxIf",value:function(t,e){return t>e?e:t}},{key:"equal",value:function(t,e){var r,o,n,l;function c(t,e){var r;if(isNaN(t)&&isNaN(e)&&"number"==typeof t&&"number"==typeof e)return!0;if(t===e)return!0;if("function"==typeof t&&"function"==typeof e||t instanceof Date&&e instanceof Date||t instanceof RegExp&&e instanceof RegExp||t instanceof String&&e instanceof String||t instanceof Number&&e instanceof Number)return t.toString()===e.toString();if(!(t instanceof Object&&e instanceof Object))return!1;if(t.isPrototypeOf(e)||e.isPrototypeOf(t))return!1;if(t.constructor!==e.constructor)return!1;if(t.prototype!==e.prototype)return!1;if(n.indexOf(t)>-1||l.indexOf(e)>-1)return!1;for(r in e){if(e.hasOwnProperty(r)!==t.hasOwnProperty(r))return!1;if(i(e[r])!==i(t[r]))return!1}for(r in t){if(e.hasOwnProperty(r)!==t.hasOwnProperty(r))return!1;if(i(e[r])!==i(t[r]))return!1;switch(i(t[r])){case"object":case"function":if(n.push(t),l.push(e),!c(t[r],e[r]))return!1;n.pop(),l.pop();break;default:if(t[r]!==e[r])return!1}}return!0}if(arguments.length<1)return!0;for(r=1,o=arguments.length;r<o;r++)if(n=[],l=[],!c(arguments[0],arguments[r]))return!1;return!0}},{key:"arrayIncludeArray",value:function(e,r){if(t.isUnDef(e)||t.isUnDef(r))return!1;if(e.length!==r.length)return!1;for(var o=0;o<e.length;o+=1)if(-1===r.indexOf(e[o]))return!1;return!0}},{key:"keepLastIndex",value:function(t){if(window.getSelection){t.focus();var e=window.getSelection();e.selectAllChildren(t),e.collapseToEnd()}else if(document.selection){var r=document.selection.createRange();r.moveToElementText(t),r.collapse(!1),r.select()}}},{key:"trim",value:function(t){return this.isBlank(t)?"":t.trim()}},{key:"now",value:function(){return Date.now().toString()}},{key:"viewPort",value:function(){return{width:window.innerWidth,height:window.innerHeight}}}],r&&c(e.prototype,r),o&&c(e,o),t}();function E(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function S(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}k.EMPTY="",k.Nul=null,k.Undef=void 0;var A=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=r):this.el=e,this.el.data=[]}var e,r,o;return e=t,(r=[{key:"data",value:function(t,e){return void 0!==e?(this.el.data[t]=e,this):this.el.data[t]}},{key:"on",value:function(t,e){var r=E(t.split(".")),o=r[0],n=r.slice(1),i=o;return"mousewheel"===i&&/Firefox/i.test(window.navigator.userAgent)&&(i="DOMMouseScroll"),this.el.addEventListener(i,(function(t){e(t);for(var r=0;r<n.length;r+=1){var o=n[r];if("left"===o&&0!==t.button)return;if("right"===o&&2!==t.button)return;"stop"===o&&t.stopPropagation()}})),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach((function(r){e.css(r,"".concat(t[r],"px"))})),this;var r=this.el;return{top:r.offsetTop,left:r.offsetLeft,height:r.offsetHeight,width:r.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"scrollTop",value:function(){return this.el.scrollTop}},{key:"clientHeight",value:function(){return this.el.clientHeight}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return 0===arguments.length?this.el.childNodes:(r.forEach((function(e){return t.child(e)})),this)}},{key:"first",value:function(){return this.el.firstChild}},{key:"last",value:function(){return this.el.lastChild}},{key:"remove",value:function(t){return this.el.removeChild(t.el||t)}},{key:"prepend",value:function(t){var e=this.el;return e.children.length>0?e.insertBefore(t,e.firstChild):e.appendChild(t),this}},{key:"prev",value:function(){return this.el.previousSibling}},{key:"next",value:function(){return this.el.nextSibling}},{key:"child",value:function(e){var r=e;return"string"==typeof e?r=document.createTextNode(e):e instanceof t&&(r=e.el),this.el.appendChild(r),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var r=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach((function(e){r.el.setAttribute(e,t[e])}))}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return r.forEach((function(e){return t.el.style.removeProperty(e)})),this}},{key:"css",value:function(t,e){var r=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach((function(e){r.el.style[e]=t[e]})),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){var t=this.computedStyle();return t&&"block"!==t.display&&this.css("display","block"),this}},{key:"hide",value:function(){var t=this.computedStyle();return t&&"none"!==t.display&&this.css("display","none"),this}},{key:"display",value:function(t){t?this.show():this.hide()}},{key:"text",value:function(t){return void 0===t?this.el.innerText:(this.el.innerText=t,t)}},{key:"sibling",value:function(){for(var e=this.el,r=[];null!==(e=e.previousElementSibling);)r.push(new t(e));for(e=this.el;null!==(e=e.nextElementSibling);)r.push(new t(e));return r}},{key:"position",value:function(){var t=0,e=0;return this.el.style.position&&(this.el.top&&(t=this.el.style.top.replace("%","").repeat("px","")),this.el.left&&(e=this.el.style.left.replace("%","").repeat("px","")),this.el.right&&(t=this.el.style.right.replace("%","").repeat("px","")),this.el.bottom&&(t=this.el.style.bottom.replace("%","").repeat("px",""))),{top:k.parseFloat(t),left:k.parseFloat(e),right:k.parseFloat(0),bottom:k.parseFloat(0)}}},{key:"trigger",value:function(t,e){var r=new CustomEvent(t,{detail:e,bubbles:!0,cancelable:!1});this.el.dispatchEvent(r)}},{key:"focus",value:function(){this.el.focus()}},{key:"find",value:function(e){var r=this.el.querySelectorAll(e);if(r&&1===r.length)return new t(r[0]);var o=[];if(r){var n=!0,i=!1,l=void 0;try{for(var c,a=r[Symbol.iterator]();!(n=(c=a.next()).done);n=!0){var s=c.value;o.push(new t(s))}}catch(t){i=!0,l=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw l}}}return o}},{key:"isChild",value:function(t){for(var e=t||t.el;null!=e&&e!==document.body;){if(e===this.el)return!0;e=e.parentNode}return!1}}])&&S(e.prototype,r),o&&S(e,o),t}(),_=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new A(t,e)};function T(t){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function C(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function P(t,e){return!e||"object"!==T(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function W(t,e){return(W=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var L=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),P(this,j(e).call(this,r,"".concat(n,"-widget ").concat(t)))}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&W(t,e)}(e,t),r=e,(o=[{key:"computeEventXy",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,r=e.box(),o=r.top,n=r.left;return{x:t.pageX-n,y:t.pageY-o}}},{key:"computeWidgetXy",value:function(t){if(!t)return{x:0,y:0};var e=t.box(),r=e.top,o=e.left,n=this.box(),i=n.top;return{x:o-n.left,y:r-i}}},{key:"attach",value:function(t){this.children(t),t.onAttach()}},{key:"onAttach",value:function(){}}])&&C(r.prototype,o),i&&C(r,i),e}(A);function R(t){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function D(t,e){return!e||"object"!==R(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function I(t){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function V(t,e){return(V=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var H=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),D(this,I(e).call(this,"".concat(n,"-layer ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&V(t,e)}(e,t),e}(L);function M(t){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function N(t,e){return!e||"object"!==M(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function z(t){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function B(t,e){return(B=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Y=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=N(this,z(e).call(this,"".concat(n,"-vertical-layer")))).options=k.mergeDeep({style:{}},t),r.css(r.options.style),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&B(t,e)}(e,t),e}(H);function F(t){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function U(t,e){return!e||"object"!==F(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function X(t){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function G(t,e){return(G=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var K=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=U(this,X(e).call(this,"".concat(n,"-vertical-layer-element")))).options=k.mergeDeep({style:{flexGrow:"0"}},t),r.css(r.options.style),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&G(t,e)}(e,t),e}(H);function q(t){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Z(t,e){return!e||"object"!==q(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function J(t){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Q(t,e){return(Q=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var tt=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Z(this,J(e).call(this,"".concat(n,"-icon")))).iconNameEl=_("div","".concat(n,"-icon-img ").concat(r)),t.child(t.iconNameEl),t}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Q(t,e)}(e,t),r=e,(o=[{key:"setWidth",value:function(t){this.iconNameEl.css("width","".concat(t,"px"))}},{key:"setHeight",value:function(t){this.iconNameEl.css("height","".concat(t,"px"))}}])&&$(r.prototype,o),i&&$(r,i),e}(L);function et(t){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rt(t,e){return!e||"object"!==et(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ot(t){return(ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nt(t,e){return(nt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var it=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),rt(this,ot(e).call(this,"".concat(n,"-tools-item ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nt(t,e)}(e,t),e}(L);function lt(t){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ct(t,e){return!e||"object"!==lt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function at(t){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function st(t,e){return(st=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ut=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ct(this,at(e).call(this,"".concat(n,"-tools-undo")))).icon=new tt("undo"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&st(t,e)}(e,t),e}(it);function ft(t){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ht(t,e){return!e||"object"!==ft(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dt(t){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pt(t,e){return(pt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ht(this,dt(e).call(this,"".concat(n,"-tools-redo")))).icon=new tt("redo"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pt(t,e)}(e,t),e}(it);function bt(t){return(bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gt(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function wt(t,e){return!e||"object"!==bt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vt(t){return(vt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mt(t,e){return(mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=wt(this,vt(e).call(this,"".concat(n,"-tools-point-format")))).icon=new tt("point-format"),t.sheets=[],t.children(t.icon),t}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mt(t,e)}(e,t),r=e,(o=[{key:"addSheet",value:function(t){this.sheets.push(t)}},{key:"removeSheet",value:function(t){for(var e=0;e<this.sheets.length;e+=1)if(this.sheets[e]===t)return void this.sheets.splice(e,1)}},{key:"includeSheet",value:function(t){for(var e=0;e<this.sheets.length;e+=1)if(this.sheets[e]===t)return!0;return!1}}])&&gt(r.prototype,o),i&&gt(r,i),e}(it);function Ot(t){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kt(t,e){return!e||"object"!==Ot(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Et(t){return(Et=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function St(t,e){return(St=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var At=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=kt(this,Et(e).call(this,"".concat(n,"-tools-clear-format")))).icon=new tt("clear-format"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&St(t,e)}(e,t),e}(it);function _t(t){return(_t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tt(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ct(t,e){return!e||"object"!==_t(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pt(t){return(Pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jt(t,e){return(jt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wt=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Ct(this,Pt(e).call(this,"".concat(n,"-tools-drop-down-item ").concat(t)))).drop=_("div","".concat(n,"-tools-drop-down-item-mark")),r.title=_("div","".concat(n,"-tools-drop-down-item-title")),r.drop.children(new tt("arrow-down")),r.children(r.title),r.children(r.drop),r}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jt(t,e)}(e,t),r=e,(o=[{key:"setTitle",value:function(t){this.title.text(t)}},{key:"setIcon",value:function(t){this.title.html(""),this.title.children(t)}},{key:"setWidth",value:function(t){this.title.css("width","".concat(t,"px"))}},{key:"setEllipsis",value:function(){this.title.css("overflow","hidden"),this.title.css("text-overflow","ellipsis"),this.title.css("white-space","nowrap")}},{key:"removeEllipsis",value:function(){this.title.cssRemoveKeys("overflow"),this.title.cssRemoveKeys("text-overflow"),this.title.cssRemoveKeys("white-space")}}])&&Tt(r.prototype,o),i&&Tt(r,i),e}(it);function Lt(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Rt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,n=[{key:"bind",value:function(t,e,r){if(Array.isArray(t)){var o=!0,n=!1,i=void 0;try{for(var l,c=t[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var a=l.value;(a.el||a).addEventListener(e,r)}}catch(t){n=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(n)throw i}}}else(t.el||t).addEventListener(e,r)}},{key:"unbind",value:function(t,e,r){if(Array.isArray(t)){var o=!0,n=!1,i=void 0;try{for(var l,c=t[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var a=l.value;(a.el||a).addEventListener(e,r)}}catch(t){n=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(n)throw i}}}else(t.el||t).removeEventListener(e,r)}},{key:"mouseMoveUp",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=function i(l){t.unbind(e,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,r),t.unbind(e,o.SYSTEM_EVENT_TYPE.MOUSE_UP,i),n(l)};t.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,r),t.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_UP,i)}},{key:"dbClick",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=0;t.bind(e,o.SYSTEM_EVENT_TYPE.CLICK,(function(t){var e=Date.now();e-n<=300?(r(t),n=0):n=e}))}}],(r=null)&&Lt(e.prototype,r),n&&Lt(e,n),t}();function Dt(t){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function It(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Vt(t,e){return!e||"object"!==Dt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ht(t){return(Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mt(t,e){return(Mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nt=function(t){function e(t){var r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Vt(this,Ht(e).call(this,"".concat(n,"-scroll-bar-x")))).option=k.mergeDeep({style:{},scroll:function(t){return t}},t),o.lastBut=_("div","".concat(n,"-scroll-bar-x-last-but")),o.nextBut=_("div","".concat(n,"-scroll-bar-x-next-but")),o.content=_("div","".concat(n,"-scroll-bar-x-content")),o.block=_("div","".concat(n,"-scroll-bar-x-block")),o.content.children(o.block),(r=o).children.apply(r,[o.lastBut,o.nextBut,o.content]),o.blockLeft=0,o.maxBlockLeft=0,o.blockWidth=0,o.minBlockWidth=20,o.scrollTo=0,o.contentWidth=0,o.viewPortWidth=0,o.isHide=!0,o.css(o.option.style),o.hide(),o}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mt(t,e)}(e,t),r=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"bind",value:function(){var t=this;this.block.on(o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(0===e.button){var r=t.computeEventXy(e,t.block);Rt.mouseMoveUp(_(document),(function(e){var o=t.computeEventXy(e,t.content).x-r.x;o<0&&(o=0),o>t.maxBlockLeft&&(o=t.maxBlockLeft),t.blockLeft=o,t.scrollTo=t.computeScrollTo(t.blockLeft),t.block.css("left","".concat(o,"px")),t.option.scroll(t.scrollTo),e.stopPropagation(),e.preventDefault()})),e.stopPropagation(),e.preventDefault()}}))}},{key:"setSize",value:function(t,e){if(t<e){this.isHide=!1,this.show();var r=this.content.box(),o=t/e*r.width;this.blockWidth=o<this.minBlockWidth?this.minBlockWidth:o,this.viewPortWidth=t,this.contentWidth=e,this.maxBlockLeft=r.width-this.blockWidth,this.block.css("width","".concat(this.blockWidth,"px"));var n=this.scrollTo/(e-t)*this.maxBlockLeft;this.blockLeft=n>this.maxBlockLeft?this.maxBlockLeft:n,this.scrollTo=this.computeScrollTo(this.blockLeft),this.block.css("left","".concat(this.blockLeft,"px"))}else this.isHide=!0,this.hide(),this.option.scroll(0)}},{key:"scrollMove",value:function(t){var e=t,r=this.contentWidth-this.viewPortWidth;e>r?e=r:e<0&&(e=0);var o=e/(this.contentWidth-this.viewPortWidth)*this.maxBlockLeft;this.blockLeft=o>this.maxBlockLeft?this.maxBlockLeft:o,this.scrollTo!==e&&(this.scrollTo=e,this.block.css("left","".concat(this.blockLeft,"px")),this.option.scroll(this.scrollTo))}},{key:"computeScrollTo",value:function(t){return t/this.maxBlockLeft*(this.contentWidth-this.viewPortWidth)}}])&&It(r.prototype,i),l&&It(r,l),e}(L);function zt(t){return(zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bt(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Yt(t,e){return!e||"object"!==zt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ft(t){return(Ft=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ut(t,e){return(Ut=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xt=function(t){function e(t){var r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Yt(this,Ft(e).call(this,"".concat(n,"-scroll-bar-y")))).option=k.mergeDeep({style:{},scroll:function(t){return t}},t),o.lastBut=_("div","".concat(n,"-scroll-bar-y-last-but")),o.nextBut=_("div","".concat(n,"-scroll-bar-y-next-but")),o.content=_("div","".concat(n,"-scroll-bar-y-content")),o.block=_("div","".concat(n,"-scroll-bar-y-block")),o.content.children(o.block),(r=o).children.apply(r,[o.lastBut,o.nextBut,o.content]),o.blockTop=0,o.maxBlockTop=0,o.blockHeight=0,o.minBlockHeight=20,o.scrollTo=0,o.contentHeight=0,o.viewPortHeight=0,o.isHide=!0,o.css(o.option.style),o.hide(),o}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ut(t,e)}(e,t),r=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"bind",value:function(){var t=this;Rt.bind(this.block,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(0===e.button){var r=t.computeEventXy(e,t.block);Rt.mouseMoveUp(_(document),(function(e){var o=t.computeEventXy(e,t.content).y-r.y;o<0&&(o=0),o>t.maxBlockTop&&(o=t.maxBlockTop),t.blockTop=o,t.scrollTo=t.computeScrollTo(t.blockTop),t.block.css("top","".concat(o,"px")),t.option.scroll(t.scrollTo),e.stopPropagation(),e.preventDefault()}))}}))}},{key:"setSize",value:function(t,e){if(t<e){this.isHide=!1,this.show();var r=this.content.box(),o=t/e*r.height;this.blockHeight=o<this.minBlockHeight?this.minBlockHeight:o,this.viewPortHeight=t,this.contentHeight=e,this.maxBlockTop=r.height-this.blockHeight,this.block.css("height","".concat(this.blockHeight,"px"));var n=this.scrollTo/(e-t)*this.maxBlockTop;this.blockTop=n>this.maxBlockTop?this.maxBlockTop:n,this.scrollTo=this.computeScrollTo(this.blockTop),this.block.css("top","".concat(this.blockTop,"px"))}else this.isHide=!0,this.hide(),this.option.scroll(0)}},{key:"scrollMove",value:function(t){var e=t,r=this.contentHeight-this.viewPortHeight;e>r?e=r:e<0&&(e=0);var o=e/(this.contentHeight-this.viewPortHeight)*this.maxBlockTop;this.blockTop=o>this.maxBlockTop?this.maxBlockTop:o,this.scrollTo!==e&&(this.scrollTo=e,this.block.css("top","".concat(this.blockTop,"px")),this.option.scroll(this.scrollTo))}},{key:"computeScrollTo",value:function(t){return t/this.maxBlockTop*(this.contentHeight-this.viewPortHeight)}}])&&Bt(r.prototype,i),l&&Bt(r,l),e}(L);function Gt(t){return(Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kt(t,e){return!e||"object"!==Gt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qt(t){return(qt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $t(t,e){return($t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zt=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Kt(this,qt(e).call(this,"".concat(n,"-horizontal-layer-element")))).options=k.mergeDeep({style:{flexGrow:"0"}},t),r.css(r.options.style),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$t(t,e)}(e,t),e}(H);function Jt(t){return(Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qt(t,e){return!e||"object"!==Jt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function te(t){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ee(t,e){return(ee=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var re=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Qt(this,te(e).call(this,"".concat(n,"-horizontal-layer")))).options=k.mergeDeep({style:{}},t),r.css(r.options.style),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ee(t,e)}(e,t),e}(H);function oe(t){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ne(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ie(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function le(t,e){return(le=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ce(t,e,r){return(ce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ae(t)););return t}(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(r):n.value}})(t,e,r||t)}function ae(t){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var se={TOP:1,LEFT:2,BOTTOM:3,RIGHT:4},ue=[],fe=function(t){function e(t){var r,o,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,r=!(i=ae(e).call(this,"".concat(n,"-el-pop-up")))||"object"!==oe(i)&&"function"!=typeof i?ie(o):i,ue.push(ie(r)),r.options=k.mergeDeep({position:se.BOTTOM,el:null},t),r.off=!0,r.content=new L("".concat(n,"-el-pop-up-content")),r.scrollBarX=new Nt,r.scrollBarY=new Xt;var l=new Zt({style:{flexGrow:1}});l.children(r.content);var c=new Zt({style:{overflow:"inherit"}});c.children(r.scrollBarY);var a=new re;a.children(l),a.children(c);var s=new K(a);s.children(a);var u=new K;u.children(r.scrollBarX);var f=new Y;return f.children(s),f.children(u),ce(ae(e.prototype),"children",ie(r)).call(ie(r),f),r.bind(),r}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&le(t,e)}(e,t),r=e,l=[{key:"closeAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];ue.forEach((function(e){-1===t.indexOf(e)&&e.close()}))}}],(i=[{key:"bind",value:function(){var t=this;Rt.bind(window,o.SYSTEM_EVENT_TYPE.RESIZE,(function(){t.position(),t.scrollbar()}))}},{key:"children",value:function(){var t;(t=this.content).children.apply(t,arguments)}},{key:"position",value:function(){var t=this.content,e=this.options,r=e.el,o=e.position,n=r.box(),i=t.box(),l=n.top,c=n.left;switch(o){case se.TOP:l=n.top-i.height;break;case se.LEFT:c=n.left-i.width;break;case se.RIGHT:c=n.left+n.width;break;case se.BOTTOM:l=n.top+n.height}var a=window.innerWidth,s=window.innerHeight;if(c<0||c+i.width>a)switch(o){case se.LEFT:c=n.left+n.width;break;case se.RIGHT:c=n.left-i.width}if(l<0||l+i.height>s)switch(o){case se.TOP:l=n.top+n.height;break;case se.BOTTOM:l=n.top-i.height}(c<0||c+i.width>a)&&(l=n.top+n.height,c=n.left),(l<0||l+i.height>s)&&(l=n.top+n.height,c=n.left),this.offset({top:l,left:c})}},{key:"scrollbar",value:function(){var t=this.content.box(),e=this.box();this.scrollBarY.setSize(e.height,t.height),this.scrollBarX.setSize(e.width,t.width)}},{key:"open",value:function(){this.off&&(_(document.body).children(this),this.position(),this.scrollbar(),this.off=!1)}},{key:"close",value:function(){!1===this.off&&(_(document.body).remove(this),this.off=!0)}}])&&ne(r.prototype,i),l&&ne(r,l),e}(L);function he(t){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function de(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function pe(t){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ye(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function be(t,e){return(be=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ge=function(t){function e(){var t,r,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(t=!(o=pe(e).call(this,"".concat(n,"-el-context-menu ").concat(i)))||"object"!==he(o)&&"function"!=typeof o?ye(r):o).options=k.mergeDeep({},l),t.menus=[],t.elPopUp=new fe(t.options),t.elPopUp.children(ye(t)),t.bind(),t}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&be(t,e)}(e,t),r=e,(i=[{key:"bind",value:function(){var t=this;Rt.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){t.stopPropagation(),t.preventDefault()})),Rt.bind(document.body,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.close()}))}},{key:"addItem",value:function(t){return this.menus.push(t),this.children(t),this}},{key:"open",value:function(){return this.elPopUp.open(),this}},{key:"close",value:function(){return this.elPopUp.close(),this}},{key:"isOpen",value:function(){return this.elPopUp.off}}])&&de(r.prototype,i),l&&de(r,l),e}(L);function we(t){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ve(t,e){return!e||"object"!==we(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function me(t){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xe(t,e){return(xe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Oe=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ve(this,me(e).call(this,"".concat(n,"-el-context-menu-item hover ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xe(t,e)}(e,t),e}(L);function ke(t){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ee(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Se(t){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ae(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _e(t,e){return(_e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Te=[],Ce=function(t){function e(t,r){var o,i,l;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i=this,(o=!(l=Se(e).call(this,"".concat(n,"-format-context-menu-item")))||"object"!==ke(l)&&"function"!=typeof l?Ae(i):l).title=t,o.desc=r,o.icon=new tt("checked"),o.iconElement=_("div","".concat(n,"-format-context-menu-item-icon")),o.iconElement.children(o.icon),o.titleElement=_("div","".concat(n,"-format-context-menu-item-title")),o.descElement=_("div","".concat(n,"-format-context-menu-item-desc")),o.titleElement.text(t),o.descElement.text(r),o.children(o.iconElement),o.children(o.titleElement),o.children(o.descElement),Te.push(Ae(o)),o}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_e(t,e)}(e,t),r=e,(o=[{key:"setTitle",value:function(t){this.titleElement.text(t)}},{key:"setDesc",value:function(t){this.descElement.text(t)}},{key:"setActive",value:function(){Te.forEach((function(t){t.removeClass("active")})),this.addClass("active")}}])&&Ee(r.prototype,o),i&&Ee(r,i),e}(Oe);function Pe(t){return(Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function je(t,e){return!e||"object"!==Pe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function We(t){return(We=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Le(t,e){return(Le=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Re=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),je(this,We(e).call(this,"".concat(n,"-el-context-menu-item-divider")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Le(t,e)}(e,t),e}(L);function De(t){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ie(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ve(t,e){return!e||"object"!==De(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function He(t){return(He=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Me(t,e){return(Me=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ne=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ve(this,He(e).call(this,"".concat(n,"-format-context-menu"),k.mergeDeep({onUpdate:function(){}},r)))).items=[new Ce("常规","").data("type","default"),new Ce("文本","").data("type","text"),new Re,new Ce("数值","0.59").data("type","number"),new Ce("百分比","90.00%").data("type","percentage"),new Ce("分数","1/2").data("type","fraction"),new Ce("科学计数","9.50e-01").data("type","ENotation"),new Re,new Ce("人民币","￥5.00").data("type","rmb"),new Ce("港币","HK5.00").data("type","hk"),new Ce("美元","$5.00").data("type","dollar"),new Re,new Ce("日期","2018/4/18").data("type","date1"),new Ce("日期","4月18日").data("type","date2"),new Ce("日期","2018年4月").data("type","date3"),new Ce("日期","2018年4月18日").data("type","date4"),new Ce("日期","2018/4/18 14:30:30").data("type","date5"),new Ce("时间","14:30:30").data("type","time"),new Re,new Ce("更多格式","")],t.items.forEach((function(e){e instanceof Ce&&e.data("type")&&e.on(o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.data("type"),e.title),e.setActive()})),t.addItem(e)})),t.init(),t}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Me(t,e)}(e,t),r=e,(i=[{key:"init",value:function(){var t=this.options,e=this.items,r=t.el,o=e[0];r.setTitle(o.title),o.setActive()}},{key:"update",value:function(t,e){this.options.onUpdate(t,e),this.close()}},{key:"setActiveByType",value:function(t){this.items.forEach((function(e){e.data("type")===t&&e.setActive()}))}}])&&Ie(r.prototype,i),l&&Ie(r,l),e}(ge);function ze(t){return(ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Be(t){return(Be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ye(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fe(t,e){return(Fe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ue=function(t){function e(t){var r,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(r=!(i=Be(e).call(this,"".concat(n,"-tools-format")))||"object"!==ze(i)&&"function"!=typeof i?Ye(o):i).options=k.copyProp({contextMenu:{}},t),r.setTitle("常规"),r.setWidth(50),r.setEllipsis(),r.formatContextMenu=new Ne(k.copyProp({el:Ye(r),position:se.BOTTOM},r.options.contextMenu)),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fe(t,e)}(e,t),e}(Wt);function Xe(t){return(Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ge(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ke(t){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qe(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $e(t,e){return($e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ze=[],Je=function(t){function e(t){var r,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(r=!(i=Ke(e).call(this,"".concat(n,"-font-context-menu-item")))||"object"!==Xe(i)&&"function"!=typeof i?qe(o):i).title=t,r.icon=new tt("checked"),r.iconElement=_("div","".concat(n,"-font-context-menu-item-icon")),r.iconElement.children(r.icon),r.titleElement=_("div","".concat(n,"-font-context-menu-item-title")),r.titleElement.text(t),r.titleElement.css("font-family",t),r.children(r.iconElement),r.children(r.titleElement),Ze.push(qe(r)),r}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$e(t,e)}(e,t),r=e,(o=[{key:"setTitle",value:function(t){this.title=t,this.titleElement.text(t)}},{key:"setActive",value:function(){Ze.forEach((function(t){t.removeClass("active")})),this.addClass("active")}}])&&Ge(r.prototype,o),i&&Ge(r,i),e}(Oe);function Qe(t){return(Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tr(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function er(t,e){return!e||"object"!==Qe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function rr(t){return(rr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function or(t,e){return(or=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nr=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=er(this,rr(e).call(this,"".concat(n,"-font-context-menu"),k.mergeDeep({onUpdate:function(){}},r)))).items=[new Je("Arial"),new Je("Helvetica"),new Je("Source Sans Pro"),new Je("Comic Sans Ms"),new Je("Courier New"),new Je("Verdana"),new Je("Lalo")],t.items.forEach((function(e){e.on(o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.title),e.setActive()})),t.addItem(e)})),t.setActiveByType(t.items[0].title),t}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&or(t,e)}(e,t),r=e,(i=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}},{key:"setActiveByType",value:function(t){this.items.forEach((function(e){e.title===t&&e.setActive()}))}}])&&tr(r.prototype,i),l&&tr(r,l),e}(ge);function ir(t){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lr(t){return(lr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ar(t,e){return(ar=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sr=function(t){function e(t){var r,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(r=!(i=lr(e).call(this,"".concat(n,"-tools-font")))||"object"!==ir(i)&&"function"!=typeof i?cr(o):i).options=k.copyProp({contextMenu:{}},t),r.setTitle("Arial"),r.setWidth(50),r.setEllipsis(),r.fontContextMenu=new nr(k.copyProp({el:cr(r),position:se.BOTTOM},r.options.contextMenu)),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ar(t,e)}(e,t),e}(Wt);function ur(t){return(ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fr(t,e){return!e||"object"!==ur(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hr(t){return(hr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dr(t,e){return(dr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pr=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=fr(this,hr(e).call(this,"".concat(n,"-font-size-context-menu-item")))).size=t,r.titleElement=_("div","".concat(n,"-font-size-context-menu-item-title")),r.titleElement.text(t),r.titleElement.css("text-align","center"),r.children(r.titleElement),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dr(t,e)}(e,t),e}(Oe);function yr(t){return(yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function br(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function gr(t,e){return!e||"object"!==yr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wr(t){return(wr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vr(t,e){return(vr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mr=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=gr(this,wr(e).call(this,"".concat(n,"-font-size-context-menu"),k.mergeDeep({onUpdate:function(){}},r)))).items=[new pr(6),new pr(7),new pr(8),new pr(9),new pr(10),new pr(11),new pr(12),new pr(14),new pr(15),new pr(18),new pr(24),new pr(36)],t.items.forEach((function(e){e.on(o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.size)})),t.addItem(e)})),t}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vr(t,e)}(e,t),r=e,(i=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}}])&&br(r.prototype,i),l&&br(r,l),e}(ge);function xr(t){return(xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Or(t){return(Or=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Er(t,e){return(Er=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Sr=function(t){function e(){var t,r,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(t=!(o=Or(e).call(this,"".concat(n,"-tools-font-size")))||"object"!==xr(o)&&"function"!=typeof o?kr(r):o).options=i,t.setTitle("10"),t.setWidth(30),t.setEllipsis(),t.fontSizeContextMenu=new mr(k.copyProp({el:kr(t),position:se.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Er(t,e)}(e,t),e}(Wt);function Ar(t){return(Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _r(t,e){return!e||"object"!==Ar(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tr(t){return(Tr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cr(t,e){return(Cr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=_r(this,Tr(e).call(this,"".concat(n,"-tools-font-bold")))).icon=new tt("font-bold"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cr(t,e)}(e,t),e}(it);function jr(t){return(jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wr(t,e){return!e||"object"!==jr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lr(t){return(Lr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rr(t,e){return(Rr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Dr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Wr(this,Lr(e).call(this,"".concat(n,"-tools-font-italic")))).icon=new tt("font-italic"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rr(t,e)}(e,t),e}(it);function Ir(t){return(Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vr(t,e){return!e||"object"!==Ir(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hr(t){return(Hr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mr(t,e){return(Mr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Vr(this,Hr(e).call(this,"".concat(n,"-tools-under-line")))).icon=new tt("under-line"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mr(t,e)}(e,t),e}(it);function zr(t){return(zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Br(t,e){return!e||"object"!==zr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yr(t){return(Yr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fr(t,e){return(Fr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ur=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Br(this,Yr(e).call(this,"".concat(n,"-tools-font-strike")))).icon=new tt("font-strike"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fr(t,e)}(e,t),e}(it);function Xr(t){return(Xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gr(t,e){return!e||"object"!==Xr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Kr(t){return(Kr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qr(t,e){return(qr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $r=function(t){function e(t,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Gr(this,Kr(e).call(this,"".concat(n,"-font-color-context-menu-item")))).title=t,o.icon=r,r&&(o.iconElement=_("div","".concat(n,"-font-color-context-menu-item-icon")),o.iconElement.children(o.icon),o.children(o.iconElement)),t&&(o.titleElement=_("div","".concat(n,"-font-color-context-menu-item-title")),o.titleElement.text(t),o.children(o.titleElement)),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qr(t,e)}(e,t),e}(Oe);function Zr(t){return(Zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jr(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Qr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function to(t,e){return(to=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function eo(t,e,r){return(eo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ro(t)););return t}(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(r):n.value}})(t,e,r||t)}function ro(t){return(ro=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var oo=[],no={LEFT:1,TOP:2,RIGHT:3,CENTER:4},io=function(t){function e(t){var r,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(r=!(i=ro(e).call(this,"".concat(n,"-drag-panel")))||"object"!==Zr(i)&&"function"!=typeof i?Qr(o):i).options=k.mergeDeep({position:no.CENTER},t),r.off=!0,r.mask=_("div","".concat(n,"-drag-panel-mask")),r.content=_("div","".concat(n,"-drag-panel-content")),eo(ro(e.prototype),"children",Qr(r)).call(Qr(r),r.content),r.bind(),oo.push(Qr(r)),r}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&to(t,e)}(e,t),r=e,l=[{key:"closeAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];oo.forEach((function(e){-1===t.indexOf(e)&&e.close()}))}}],(i=[{key:"bind",value:function(){var t=this,e=this.mask;Rt.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.close(),e.stopPropagation()})),Rt.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(0===e.button){var r=t.computeEventXy(e,t);Rt.mouseMoveUp(_(document),(function(e){var o=e.pageY-r.y,n=e.pageX-r.x;t.offset({top:o,left:n}),e.stopPropagation(),e.preventDefault()})),e.stopPropagation(),e.preventDefault()}}))}},{key:"position",value:function(){var t=this.options.position,e=k.viewPort(),r=e.width,o=e.height,n=this.box();switch(t){case no.LEFT:case no.RIGHT:case no.TOP:break;case no.CENTER:this.offset({left:r/2-n.width/2,top:o/2-n.height/2})}}},{key:"open",value:function(){if(this.off){var t=this.mask;_(document.body).children(t),_(document.body).children(this),this.position(),this.off=!1}}},{key:"close",value:function(){if(!1===this.off){var t=this.mask;_(document.body).remove(this),_(document.body).remove(t),this.off=!0}}},{key:"children",value:function(){var t;(t=this.content).children.apply(t,arguments)}}])&&Jr(r.prototype,i),l&&Jr(r,l),e}(L);function lo(t){return(lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function co(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ao(t){return(ao=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function so(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function uo(t,e){return(uo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fo=function(t){function e(t){var r,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(r=!(i=ao(e).call(this,"".concat(n,"-color-picker")))||"object"!==lo(i)&&"function"!=typeof i?so(o):i).options=k.mergeDeep({selectCb:function(){}},t),r.dragPanel=new io,r.color=[360,0,100],r.preViewColorPoint=_("div","".concat(n,"-color-picker-pre-view-color-point")),r.colorValueTips=_("div","".concat(n,"-color-picker-color-value-tips")),r.colorValueTips.text("十六进制颜色值"),r.colorInput=_("input","".concat(n,"-color-picker-color-input")),r.top=_("div","".concat(n,"-color-picker-top")),r.top.children(r.preViewColorPoint),r.top.children(r.colorValueTips),r.top.children(r.colorInput),r.selectColorPoint=_("div","".concat(n,"-color-picker-select-color-point")),r.selectColorArea1=_("div","".concat(n,"-color-picker-select-color-area area1")),r.selectColorArea2=_("div","".concat(n,"-color-picker-select-color-area area2")),r.selectColorArea3=_("div","".concat(n,"-color-picker-select-color-area area3")),r.center=_("div","".concat(n,"-color-picker-center")),r.center.children(r.selectColorArea1),r.center.children(r.selectColorArea2),r.center.children(r.selectColorArea3),r.center.children(r.selectColorPoint),r.colorHuxTips=_("div","".concat(n,"-color-picker-color-hux-tips")),r.colorBar=_("div","".concat(n,"-color-picker-color-bar")),r.colorBarPoint=_("div","".concat(n,"-color-picker-bar-point")),r.bottom=_("div","".concat(n,"-color-picker-bottom")),r.colorHuxTips.text("HUE"),r.colorBar.children(r.colorBarPoint),r.bottom.children(r.colorHuxTips),r.bottom.children(r.colorBar),r.cancelButton=_("div","".concat(n,"-color-picker-button cancel")),r.selectButton=_("div","".concat(n,"-color-picker-button select")),r.buttons=_("div","".concat(n,"-color-picker-buttons")),r.cancelButton.text("取消"),r.selectButton.text("确定"),r.buttons.children(r.selectButton),r.buttons.children(r.cancelButton),r.children(r.top),r.children(r.center),r.children(r.bottom),r.children(r.buttons),r.dragPanel.children(so(r)),r.dragPanel.css("background","#ffffff"),r.bind(),r}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&uo(t,e)}(e,t),r=e,l=[{key:"fixHex",value:function(t){var e=6-t.length;if(e>0){for(var r=[],o=0;o<e;o+=1)r.push("0");r.push(t),t=r.join("")}return t}},{key:"fixHsx",value:function(t){return{h:Math.min(360,Math.max(0,t.h)),s:Math.min(100,Math.max(0,t.s)),x:Math.min(100,Math.max(0,t.x))}}},{key:"hexToRgb",value:function(t){return{r:(t=parseInt(t.indexOf("#")>-1?t.substring(1):t,16))>>16,g:(65280&t)>>8,b:255&t}}},{key:"hexToHsb",value:function(t){return this.rgbToHsb(this.hexToRgb(t))}},{key:"rgbToHsb",value:function(t){var e={h:0,s:0,x:0},r=Math.min(t.r,t.g,t.b),o=Math.max(t.r,t.g,t.b),n=o-r;return e.x=o,e.s=0!==o?255*n/o:0,0!==e.s?t.r===o?e.h=(t.g-t.b)/n:t.g===o?e.h=2+(t.b-t.r)/n:e.h=4+(t.r-t.g)/n:e.h=-1,e.h*=60,e.h<0&&(e.h+=360),e.s*=100/255,e.x*=100/255,e}},{key:"hsbToRgb",value:function(t){var e={},r=t.h,o=255*t.s/100,n=255*t.x/100;if(0===o)e.r=n,e.g=n,e.b=n;else{var i=n,l=(255-o)*n/255,c=r%60*(i-l)/60;360===r&&(r=0),r<60?(e.r=i,e.b=l,e.g=l+c):r<120?(e.g=i,e.b=l,e.r=i-c):r<180?(e.g=i,e.r=l,e.b=l+c):r<240?(e.b=i,e.r=l,e.g=i-c):r<300?(e.b=i,e.g=l,e.r=l+c):r<360?(e.r=i,e.g=l,e.b=i-c):(e.r=0,e.g=0,e.b=0)}return{r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)}}},{key:"rgbToHex",value:function(t){var e=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return e.forEach((function(t,r){1===t.length&&(e[r]="0".concat(t))})),e.join("")}},{key:"hsbToHex",value:function(t){return this.rgbToHex(this.hsbToRgb(t))}},{key:"isRgb",value:function(t){return t.startsWith("rgb")}},{key:"isHex",value:function(t){return t.startsWith("#")}},{key:"parseRgb",value:function(t){var e=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return{r:e[1],g:e[2],b:e[3]}}},{key:"isDark",value:function(t){if(k.isBlank(t))return!1;if(this.isHex(t)){var r=e.hexToRgb(t);t="rgb(".concat(r.r,", ").concat(r.g,", ").concat(r.b,")")}var o=e.parseRgb(t);return.299*o.r+.578*o.g+.114*o.b>=192}}],(i=[{key:"bind",value:function(){var t=this,r=this.selectColorPoint,n=this.center,i=this.colorBarPoint,l=this.colorBar,c=this.colorInput,a=this.cancelButton,s=this.selectButton;Rt.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){t.stopPropagation()})),Rt.bind(r,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.computeEventXy(e,n),o=n.box();r.x<0&&(r.x=0),r.x>o.width&&(r.x=o.width),r.y<0&&(r.y=0),r.y>o.height&&(r.y=o.height),t.downSelect(r.x,r.y,o.width,o.height),Rt.mouseMoveUp(_(document),(function(e){var r=t.computeEventXy(e,n);r.x<0&&(r.x=0),r.x>o.width&&(r.x=o.width),r.y<0&&(r.y=0),r.y>o.height&&(r.y=o.height),t.moveSelect(r.x,r.y,o.width,o.height)}))})),Rt.bind(i,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.computeEventXy(e,l),o=l.box();r.x<0&&(r.x=0),r.x>o.width&&(r.x=o.width),t.downHue(r.x,o.width),Rt.mouseMoveUp(_(document),(function(e){var r=t.computeEventXy(e,l),o=l.box();r.x<0&&(r.x=0),r.x>o.width&&(r.x=o.width),t.moveHue(r.x,o.width)}))})),Rt.bind(c,o.SYSTEM_EVENT_TYPE.CHANGE,(function(){var e=c.val();e&&t.hexColor(e)})),Rt.bind(a,o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.close()})),Rt.bind(s,o.SYSTEM_EVENT_TYPE.CLICK,(function(){var r=t.color,o=e.fixHsx({h:parseInt(r[0],10),s:parseInt(r[1],10),x:parseInt(r[2],10)}),n=e.hsbToHex(o);t.options.selectCb("#".concat(n)),t.close()}))}},{key:"open",value:function(t){if(this.dragPanel.open(),t){if(e.isRgb(t)){var r=e.parseRgb(t);t=e.rgbToHex(r)}this.hexColor(t)}else this.change();return this}},{key:"close",value:function(){return this.dragPanel.close(),this}},{key:"sliderPosition",value:function(t){var e=this.colorBar,r=this.colorBarPoint,o=r.box(),n=e.box(),i=parseInt(n.width-n.width*t.h/360,10);i-=o.width/2,r.offset({left:i});var l=this.center,c=this.selectColorPoint,a=c.box(),s=l.box(),u=parseInt(s.width*t.s/100,10),f=parseInt(s.height*(100-t.x)/100,10);u-=a.width/2,f-=a.height/2,c.offset({left:u,top:f})}},{key:"hueChange",value:function(){var t=this.color,r=e.fixHsx({h:parseInt(t[0],10),s:parseInt(t[1],10),x:parseInt(t[2],10)}),o=this.colorBarPoint,n=this.selectColorPoint,i=this.preViewColorPoint,l=this.selectColorArea1,c=this.colorInput,a=e.hsbToHex(r),s=e.hsbToHex({h:r.h,s:100,x:100});n.css("backgroundColor","#".concat(a)),i.css("backgroundColor","#".concat(a)),o.css("backgroundColor","#".concat(s)),l.css("backgroundColor","#".concat(s)),c.val("#".concat(a)),this.sliderPosition(r)}},{key:"selectChange",value:function(){var t=this.color,r=e.fixHsx({h:parseInt(t[0],10),s:parseInt(t[1],10),x:parseInt(t[2],10)}),o=this.preViewColorPoint,n=this.selectColorPoint,i=this.colorInput,l=e.hsbToHex(r);n.css("backgroundColor","#".concat(l)),o.css("backgroundColor","#".concat(l)),i.val("#".concat(l)),this.sliderPosition(r)}},{key:"change",value:function(){this.hueChange(),this.selectChange()}},{key:"downSelect",value:function(t,e,r,o){var n=this.color;n[1]=parseInt(100*t/r,10),n[2]=parseInt(100*(o-e)/o,10),this.selectChange()}},{key:"moveSelect",value:function(t,e,r,o){var n=this.color;n[1]=parseInt(100*Math.max(0,Math.min(r,t))/r,10),n[2]=parseInt(100*(o-Math.max(0,Math.min(o,e)))/o,10),this.selectChange()}},{key:"downHue",value:function(t,e){this.color[0]=parseInt(360*(e-t)/e,10),this.hueChange()}},{key:"moveHue",value:function(t,e){this.color[0]=parseInt(360*(e-Math.max(0,Math.min(e,t)))/e,10),this.hueChange()}},{key:"hexColor",value:function(t){var r=this.color,o=e.hexToHsb(e.fixHex(t));r[0]=o.h,r[1]=o.s,r[2]=o.x,this.change()}}])&&co(r.prototype,i),l&&co(r,l),e}(L);function ho(t){return(ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function po(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function yo(t,e){return!e||"object"!==ho(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bo(t){return(bo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function go(t,e){return(go=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wo=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=yo(this,bo(e).call(this,"".concat(n,"-color-array-item")))).options=k.mergeDeep({color:null,icon:null},t),r.color=r.options.color,r.icon=r.options.icon,r.color&&(r.css("backgroundColor",r.color),fo.isDark(r.options.color)?(r.checkedIcon=new tt("checked-dark"),r.children(r.checkedIcon)):(r.checkedIcon=new tt("checked-light"),r.children(r.checkedIcon)),r.checkedIcon.hide()),r.icon&&r.children(r.options.icon),r}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&go(t,e)}(e,t),r=e,(o=[{key:"setActive",value:function(t){this.checkedIcon&&(t?this.checkedIcon.show():this.checkedIcon.hide())}}])&&po(r.prototype,o),i&&po(r,i),e}(L);function vo(t){return(vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mo(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function xo(t,e){return!e||"object"!==vo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Oo(t){return(Oo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ko(t,e){return(ko=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Eo=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=xo(this,Oo(e).call(this,"".concat(n,"-color-array")))).options=k.mergeDeep({colors:[new wo({color:"rgb(0,0,0)"}),new wo({color:"rgb(67, 67, 67)"}),new wo({color:"rgb(102, 102, 102)"}),new wo({color:"rgb(153, 153, 153)"}),new wo({color:"rgb(183, 183, 183)"}),new wo({color:"rgb(204, 204, 204)"}),new wo({color:"rgb(217, 217, 217)"}),new wo({color:"rgb(239, 239, 239)"}),new wo({color:"rgb(255, 255, 255)"}),new wo({color:"rgb(152, 0, 0)"}),new wo({color:"rgb(255, 0, 0)"}),new wo({color:"rgb(255, 153, 0)"}),new wo({color:"rgb(255, 255, 0)"}),new wo({color:"rgb(0, 255, 0)"}),new wo({color:"rgb(0, 255, 255)"}),new wo({color:"rgb(74, 134, 232)"}),new wo({color:"rgb(0, 0, 255)"}),new wo({color:"rgb(153, 0, 255)"}),new wo({color:"rgb(255, 0, 255)"}),new wo({color:"rgb(230, 184, 175)"}),new wo({color:"rgb(244, 204, 204)"}),new wo({color:"rgb(252, 229, 205)"}),new wo({color:"rgb(255, 242, 204)"}),new wo({color:"rgb(217, 234, 211)"}),new wo({color:"rgb(208, 224, 227)"}),new wo({color:"rgb(201, 218, 248)"}),new wo({color:"rgb(207, 226, 243)"}),new wo({color:"rgb(217, 210, 233)"}),new wo({color:"rgb(234, 209, 220)"}),new wo({color:"rgb(221, 126, 107)"}),new wo({color:"rgb(234, 153, 153)"}),new wo({color:"rgb(249, 203, 156)"}),new wo({color:"rgb(255, 229, 153)"}),new wo({color:"rgb(182, 215, 168)"}),new wo({color:"rgb(162, 196, 201)"}),new wo({color:"rgb(164, 194, 244)"}),new wo({color:"rgb(159, 197, 232)"}),new wo({color:"rgb(180, 167, 214)"}),new wo({color:"rgb(213, 166, 189)"}),new wo({color:"rgb(204, 65, 37)"}),new wo({color:"rgb(224, 102, 102)"}),new wo({color:"rgb(246, 178, 107)"}),new wo({color:"rgb(255, 217, 102)"}),new wo({color:"rgb(147, 196, 125)"}),new wo({color:"rgb(118, 165, 175)"}),new wo({color:"rgb(109, 158, 235)"}),new wo({color:"rgb(111, 168, 220)"}),new wo({color:"rgb(142, 124, 195)"}),new wo({color:"rgb(194, 123, 160)"}),new wo({color:"rgb(166, 28, 0)"}),new wo({color:"rgb(204, 0, 0)"}),new wo({color:"rgb(230, 145, 56)"}),new wo({color:"rgb(241, 194, 50)"}),new wo({color:"rgb(106, 168, 79)"}),new wo({color:"rgb(69, 129, 142)"}),new wo({color:"rgb(60, 120, 216)"}),new wo({color:"rgb(61, 133, 198)"}),new wo({color:"rgb(103, 78, 167)"}),new wo({color:"rgb(166, 77, 121)"}),new wo({color:"rgb(133, 32, 12)"}),new wo({color:"rgb(153, 0, 0)"}),new wo({color:"rgb(180, 95, 6)"}),new wo({color:"rgb(191, 144, 0)"}),new wo({color:"rgb(56, 118, 29)"}),new wo({color:"rgb(19, 79, 92)"}),new wo({color:"rgb(17, 85, 204)"}),new wo({color:"rgb(11, 83, 148)"}),new wo({color:"rgb(53, 28, 117)"}),new wo({color:"rgb(116, 27, 71)"}),new wo({color:"rgb(91, 15, 0)"}),new wo({color:"rgb(102, 0, 0)"}),new wo({color:"rgb(120, 63, 4)"}),new wo({color:"rgb(127, 96, 0)"}),new wo({color:"rgb(39, 78, 19)"}),new wo({color:"rgb(12, 52, 61)"}),new wo({color:"rgb(28, 69, 135)"}),new wo({color:"rgb(7, 55, 99)"}),new wo({color:"rgb(32, 18, 77)"}),new wo({color:"rgb(76, 17, 48)"})],selectCb:function(){}},t),r.colors=r.options.colors,r.activeColor=null,r.colors.forEach((function(t){r.children(t),t.on(o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){r.options.selectCb(t),t.options.color&&r.setActiveByColor(t.options.color)}))})),r.colors.length>0&&r.setActiveByColor(r.colors[0].options.color),r}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ko(t,e)}(e,t),r=e,(i=[{key:"add",value:function(t){var e=this;t.on(o.SYSTEM_EVENT_TYPE.CLICK,(function(){e.options.selectCb(t),t.options.color&&e.setActiveByColor(t.options.color)})),this.colors.push(t),this.children(t)}},{key:"setActiveByColor",value:function(t){var e=this;this.colors.forEach((function(r){var o=r.options;o.color===t?(r.setActive(!0),e.activeColor=o.color):r.setActive(!1)}))}}])&&mo(r.prototype,i),l&&mo(r,l),e}(L);function So(t){return(So="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ao(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _o(t,e){return!e||"object"!==So(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function To(t){return(To=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Co(t,e){return(Co=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Po=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=_o(this,To(e).call(this,"".concat(n,"-font-color-context-menu"),k.mergeDeep({onUpdate:function(){}},r)))).colorPicker=new fo({selectCb:function(e){var r=new wo({color:e});t.customizeColorArray.add(r),t.customizeColorArray.setActiveByColor(e),t.colorArray.setActiveByColor(null),t.options.onUpdate(e),t.close()}}),t.reset=new $r("重置",new tt("clear-color")),t.reset.on(o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.options.onUpdate("rgb(0,0,0)"),t.customizeColorArray.setActiveByColor(null),t.colorArray.setActiveByColor(null)})),t.array=new $r,t.array.removeClass("hover"),t.colorArray=new Eo({selectCb:function(e){var r=e.options.color;r&&t.options.onUpdate(r),t.customizeColorArray.setActiveByColor(null),t.close()}}),t.array.children(t.colorArray),t.title=_("div","".concat(n,"-font-color-context-menu-color-title")),t.title.text("自定义"),t.plus=new tt("plus"),t.customizeColorArray=new Eo({colors:[new wo({icon:t.plus})],selectCb:function(e){var r=e.options.color;r?(t.options.onUpdate(r),t.colorArray.setActiveByColor(null),t.close()):t.colorPicker.open(t.customizeColorArray.activeColor)}}),t.customize=new $r,t.customize.removeClass("hover"),t.customize.children(t.title),t.customize.children(t.customizeColorArray),t.addItem(t.reset),t.addItem(t.array),t.addItem(new Re),t.addItem(t.customize),t}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Co(t,e)}(e,t),r=e,(i=[{key:"setActiveByColor",value:function(t){this.customizeColorArray.setActiveByColor(t),this.colorArray.setActiveByColor(t)}}])&&Ao(r.prototype,i),l&&Ao(r,l),e}(ge);function jo(t){return(jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wo(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Lo(t){return(Lo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ro(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Do(t,e){return(Do=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Io=function(t){function e(t){var r,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(r=!(i=Lo(e).call(this,"".concat(n,"-tools-font-color")))||"object"!==jo(i)&&"function"!=typeof i?Ro(o):i).options=k.mergeDeep({contextMenu:{}},t),r.icon=new tt("color"),r.fontColorContextMenu=new Po(k.copyProp({el:Ro(r),position:se.BOTTOM},r.options.contextMenu)),r.setIcon(r.icon),r.setColor("rgb(0,0,0)"),r.fontColorContextMenu.setActiveByColor("rgb(0,0,0)"),r}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Do(t,e)}(e,t),r=e,(o=[{key:"setColor",value:function(t){this.icon.css("border-bottom","3px solid ".concat(t))}}])&&Wo(r.prototype,o),i&&Wo(r,i),e}(Wt);function Vo(t){return(Vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ho(t,e){return!e||"object"!==Vo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mo(t){return(Mo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function No(t,e){return(No=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zo=function(t){function e(t,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Ho(this,Mo(e).call(this,"".concat(n,"-fill-color-context-menu-item")))).title=t,o.icon=r,r&&(o.iconElement=_("div","".concat(n,"-fill-color-context-menu-item-icon")),o.iconElement.children(o.icon),o.children(o.iconElement)),t&&(o.titleElement=_("div","".concat(n,"-fill-color-context-menu-item-title")),o.titleElement.text(t),o.children(o.titleElement)),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&No(t,e)}(e,t),e}(Oe);function Bo(t){return(Bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yo(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Fo(t,e){return!e||"object"!==Bo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Uo(t){return(Uo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xo(t,e){return(Xo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Go=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Fo(this,Uo(e).call(this,"".concat(n,"-font-color-context-menu"),k.mergeDeep({onUpdate:function(){}},r)))).colorPicker=new fo({selectCb:function(e){var r=new wo({color:e});t.customizeColorArray.add(r),t.customizeColorArray.setActiveByColor(e),t.colorArray.setActiveByColor(null),t.options.onUpdate(e),t.close()}}),t.reset=new zo("重置",new tt("clear-color")),t.reset.on(o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.options.onUpdate(null),t.customizeColorArray.setActiveByColor(null),t.colorArray.setActiveByColor(null)})),t.array=new zo,t.array.removeClass("hover"),t.colorArray=new Eo({selectCb:function(e){var r=e.options.color;r&&t.options.onUpdate(r),t.customizeColorArray.setActiveByColor(null),t.close()}}),t.array.children(t.colorArray),t.title=_("div","".concat(n,"-font-color-context-menu-color-title")),t.title.text("自定义"),t.plus=new tt("plus"),t.customizeColorArray=new Eo({colors:[new wo({icon:t.plus})],selectCb:function(e){var r=e.options.color;r?(t.options.onUpdate(r),t.colorArray.setActiveByColor(null),t.close()):t.colorPicker.open(t.customizeColorArray.activeColor)}}),t.customize=new zo,t.customize.removeClass("hover"),t.customize.children(t.title),t.customize.children(t.customizeColorArray),t.addItem(t.reset),t.addItem(t.array),t.addItem(new Re),t.addItem(t.customize),t}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xo(t,e)}(e,t),r=e,(i=[{key:"setActiveByColor",value:function(t){this.customizeColorArray.setActiveByColor(t),this.colorArray.setActiveByColor(t)}}])&&Yo(r.prototype,i),l&&Yo(r,l),e}(ge);function Ko(t){return(Ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qo(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function $o(t){return($o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zo(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jo(t,e){return(Jo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qo=function(t){function e(t){var r,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(r=!(i=$o(e).call(this,"".concat(n,"-tools-fill-color")))||"object"!==Ko(i)&&"function"!=typeof i?Zo(o):i).options=k.mergeDeep({contextMenu:{}},t),r.icon=new tt("fill-color"),r.fillColorContextMenu=new Go(k.copyProp({el:Zo(r),position:se.BOTTOM},r.options.contextMenu)),r.setIcon(r.icon),r.setColor("rgb(255, 255, 255)"),r.fillColorContextMenu.setActiveByColor("rgb(255, 255, 255)"),r}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jo(t,e)}(e,t),r=e,(o=[{key:"setColor",value:function(t){this.icon.css("border-bottom","3px solid ".concat(t))}}])&&qo(r.prototype,o),i&&qo(r,i),e}(Wt);function tn(t){return(tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function en(t,e){return!e||"object"!==tn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function rn(t){return(rn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function on(t,e){return(on=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),en(this,rn(e).call(this,"".concat(n,"-border-type-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&on(t,e)}(e,t),e}(Oe);function ln(t){return(ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cn(t,e){return!e||"object"!==ln(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function an(t){return(an=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sn(t,e){return(sn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var un=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=cn(this,an(e).call(this,"".concat(n,"-tools-border1")))).icon=new tt("border1"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sn(t,e)}(e,t),e}(it);function fn(t){return(fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hn(t,e){return!e||"object"!==fn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dn(t){return(dn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pn(t,e){return(pn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=hn(this,dn(e).call(this,"".concat(n,"-tools-border2")))).icon=new tt("border2"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pn(t,e)}(e,t),e}(it);function bn(t){return(bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gn(t,e){return!e||"object"!==bn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wn(t){return(wn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vn(t,e){return(vn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=gn(this,wn(e).call(this,"".concat(n,"-tools-border3")))).icon=new tt("border3"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vn(t,e)}(e,t),e}(it);function xn(t){return(xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function On(t,e){return!e||"object"!==xn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kn(t){return(kn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function En(t,e){return(En=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Sn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=On(this,kn(e).call(this,"".concat(n,"-tools-border4")))).icon=new tt("border4"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&En(t,e)}(e,t),e}(it);function An(t){return(An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _n(t,e){return!e||"object"!==An(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tn(t){return(Tn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cn(t,e){return(Cn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=_n(this,Tn(e).call(this,"".concat(n,"-tools-border5")))).icon=new tt("border5"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cn(t,e)}(e,t),e}(it);function jn(t){return(jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wn(t,e){return!e||"object"!==jn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ln(t){return(Ln=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rn(t,e){return(Rn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Dn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Wn(this,Ln(e).call(this,"".concat(n,"-tools-border6")))).icon=new tt("border6"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rn(t,e)}(e,t),e}(it);function In(t){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vn(t,e){return!e||"object"!==In(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hn(t){return(Hn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mn(t,e){return(Mn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Vn(this,Hn(e).call(this,"".concat(n,"-tools-border7")))).icon=new tt("border7"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mn(t,e)}(e,t),e}(it);function zn(t){return(zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bn(t,e){return!e||"object"!==zn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yn(t){return(Yn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fn(t,e){return(Fn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Un=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Bn(this,Yn(e).call(this,"".concat(n,"-tools-border8")))).icon=new tt("border8"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fn(t,e)}(e,t),e}(it);function Xn(t){return(Xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gn(t,e){return!e||"object"!==Xn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Kn(t){return(Kn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qn(t,e){return(qn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $n=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Gn(this,Kn(e).call(this,"".concat(n,"-tools-border9")))).icon=new tt("border9"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qn(t,e)}(e,t),e}(it);function Zn(t){return(Zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jn(t,e){return!e||"object"!==Zn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qn(t){return(Qn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ti(t,e){return(ti=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ei=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Jn(this,Qn(e).call(this,"".concat(n,"-tools-border10")))).icon=new tt("border10"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ti(t,e)}(e,t),e}(it);function ri(t){return(ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oi(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ni(t,e){return!e||"object"!==ri(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ii(t){return(ii=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function li(t,e){return(li=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ci=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ni(this,ii(e).call(this,"".concat(n,"-tools-border-color")))).icon=new tt("border-color"),t.setIcon(t.icon),t.setColor("#000000"),t}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&li(t,e)}(e,t),r=e,(o=[{key:"setColor",value:function(t){this.icon.css("border-bottom","3px solid ".concat(t))}}])&&oi(r.prototype,o),i&&oi(r,i),e}(Wt);function ai(t){return(ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function si(t,e){return!e||"object"!==ai(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ui(t){return(ui=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fi(t,e){return(fi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hi=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=si(this,ui(e).call(this,"".concat(n,"-tools-border-type")))).icon=new tt("border-type"),t.setIcon(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fi(t,e)}(e,t),e}(Wt);function di(t){return(di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pi(t,e){return!e||"object"!==di(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function yi(t){return(yi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bi(t,e){return(bi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gi=function(t){function e(t,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=pi(this,yi(e).call(this,"".concat(n,"-border-color-context-menu-item")))).title=t,o.icon=r,r&&(o.iconElement=_("div","".concat(n,"-border-color-context-menu-item-icon")),o.iconElement.children(o.icon),o.children(o.iconElement)),t&&(o.titleElement=_("div","".concat(n,"-border-color-context-menu-item-title")),o.titleElement.text(t),o.children(o.titleElement)),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bi(t,e)}(e,t),e}(Oe);function wi(t){return(wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vi(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function mi(t,e){return!e||"object"!==wi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xi(t){return(xi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oi(t,e){return(Oi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ki=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=mi(this,xi(e).call(this,"".concat(n,"-border-color-context-menu"),k.mergeDeep({onUpdate:function(){}},r)))).colorPicker=new fo({selectCb:function(e){var r=new wo({color:e});t.customizeColorArray.add(r),t.customizeColorArray.setActiveByColor(e),t.colorArray.setActiveByColor(null),t.options.onUpdate(e),t.close()}}),t.reset=new gi("重置",new tt("clear-color")),t.reset.on(o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.options.onUpdate("rgb(0,0,0)"),t.customizeColorArray.setActiveByColor(null),t.colorArray.setActiveByColor(null)})),t.array=new gi,t.array.removeClass("hover"),t.colorArray=new Eo({selectCb:function(e){var r=e.options.color;r&&t.options.onUpdate(r),t.customizeColorArray.setActiveByColor(null),t.close()}}),t.array.children(t.colorArray),t.title=_("div","".concat(n,"-border-color-context-menu-color-title")),t.title.text("自定义"),t.plus=new tt("plus"),t.customizeColorArray=new Eo({colors:[new wo({icon:t.plus})],selectCb:function(e){var r=e.options.color;r?(t.options.onUpdate(r),t.colorArray.setActiveByColor(null),t.close()):t.colorPicker.open(t.customizeColorArray.activeColor)}}),t.customize=new gi,t.customize.removeClass("hover"),t.customize.children(t.title),t.customize.children(t.customizeColorArray),t.addItem(t.reset),t.addItem(t.array),t.addItem(new Re),t.addItem(t.customize),t}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oi(t,e)}(e,t),r=e,(i=[{key:"setActiveByColor",value:function(t){this.customizeColorArray.setActiveByColor(t),this.colorArray.setActiveByColor(t)}}])&&vi(r.prototype,i),l&&vi(r,l),e}(ge);function Ei(t){return(Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Si(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ai(t){return(Ai=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ti(t,e){return(Ti=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ci=[],Pi=function(t){function e(t){var r,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(r=!(i=Ai(e).call(this,"".concat(n,"-font-context-menu-item")))||"object"!==Ei(i)&&"function"!=typeof i?_i(o):i).type=t,r.icon=new tt("checked"),r.typeIcon=new tt(t),r.typeIcon.setWidth(50),r.iconElement=_("div","".concat(n,"-font-context-menu-item-icon")),r.titleElement=_("div","".concat(n,"-font-context-menu-item-title")),r.iconElement.children(r.icon),r.titleElement.children(r.typeIcon),r.children(r.iconElement),r.children(r.titleElement),Ci.push(_i(r)),r}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ti(t,e)}(e,t),r=e,(o=[{key:"setTitle",value:function(t){this.title=t,this.titleElement.text(t)}},{key:"setActive",value:function(){Ci.forEach((function(t){t.removeClass("active")})),this.addClass("active")}}])&&Si(r.prototype,o),i&&Si(r,i),e}(Oe);function ji(t){return(ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wi(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Li(t,e){return!e||"object"!==ji(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ri(t){return(Ri=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Di(t,e){return(Di=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ii=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Li(this,Ri(e).call(this,"".concat(n,"-line-type-context-menu"),k.mergeDeep({onUpdate:function(){}},r)))).items=[new Pi("line1"),new Pi("line2"),new Pi("line3"),new Pi("line4"),new Pi("line5"),new Pi("line6")],t.items.forEach((function(e){e.on(o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.type),e.setActive()})),t.addItem(e)})),t.setActiveByType(t.items[0].type),t}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Di(t,e)}(e,t),r=e,(i=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}},{key:"setActiveByType",value:function(t){this.items.forEach((function(e){e.type===t&&e.setActive()}))}}])&&Wi(r.prototype,i),l&&Wi(r,l),e}(ge);function Vi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hi(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Mi(t,e,r){return e&&Hi(t.prototype,e),r&&Hi(t,r),t}var Ni={SOLID_LINE:0,DOTTED_LINE:1,POINT_LINE:2,DOUBLE_LINE:3},zi=function(){function t(e,r){Vi(this,t),this.draw=e,k.mergeDeep(this,{color:"#000000",width:1},r)}return Mi(t,[{key:"drawLine",value:function(t,e,r,o){var n=this.draw,i=this.width,l=this.color;n.beginPath(),n.attr({lineWidth:i,strokeStyle:l}),n.setLineDash([]),n.line([t,e],[r,o])}},{key:"setColor",value:function(t){this.color=t}},{key:"setWidth",value:function(t){this.width=t}}]),t}(),Bi=function(){function t(e,r){Vi(this,t),this.draw=e,k.mergeDeep(this,{color:"#000000",width:1,dash:[5]},r)}return Mi(t,[{key:"drawLine",value:function(t,e,r,o){var n=this.draw,i=this.dash,l=this.width,c=this.color;n.beginPath(),n.attr({lineWidth:l,strokeStyle:c}),n.setLineDash(i),n.line([t,e],[r,o])}},{key:"setColor",value:function(t){this.color=t}},{key:"setWidth",value:function(t){this.width=t}}]),t}(),Yi=function(){function t(e,r){Vi(this,t),this.draw=e,k.mergeDeep(this,{color:"#000000",width:1,padding:1,spacing:1.5,leftShow:function(){return!1},topShow:function(){return!1},rightShow:function(){return!1},bottomShow:function(){return!1},iFMerge:function(){return!1},iFMergeFirstRow:function(){return!1},iFMergeLastRow:function(){return!1},iFMergeFirstCol:function(){return!1},iFMergeLastCol:function(){return!1}},r)}return Mi(t,[{key:"handleExternal",value:function(t,e,r,o,n,i,l){var c={},a=this.leftShow,s=this.topShow,u=this.rightShow,f=this.bottomShow,h=this.iFMerge,d=this.iFMergeFirstRow,p=this.iFMergeLastRow,y=this.iFMergeFirstCol,b=this.iFMergeLastCol,g=this.spacing,w=null,v=null,m=null,x=null,O=null;switch(l){case"left":(w=h(n,i-1))&&(v=d(n,i-1),m=p(n,i-1),x=y(n,i-1),O=b(n,i-1));break;case"top":(w=h(n-1,i))&&(v=d(n-1,i),m=p(n-1,i),x=y(n-1,i),O=b(n-1,i));break;case"right":(w=h(n,i+1))&&(v=d(n,i+1),m=p(n,i+1),x=y(n,i+1),O=b(n,i+1));break;case"bottom":(w=h(n+1,i))&&(v=d(n+1,i),m=p(n+1,i),x=y(n+1,i),O=b(n+1,i))}if(w){switch(l){case"left":c.sx=t-g,c.ex=r-g;var k=f(n-1,i-1)||s(n,i-1),E=s(n,i),S=f(n-1,i);c.sy=e,(E||S)&&(c.sy=e-g),k&&v&&(c.sy=e+g);var A=s(n+1,i-1)||f(n,i-1),_=f(n,i),T=s(n+1,i);c.ey=o,(_||T)&&(c.ey=o+g),A&&m&&(c.ey=o-g);break;case"top":c.sy=e-g,c.ey=o-g;var C=u(n-1,i-1)||a(n-1,i),P=a(n,i),j=u(n,i-1);c.sx=t,(P||j)&&(c.sx=t-g),C&&x&&(c.sx=t+g);var W=a(n-1,i+1)||u(n-1,i),L=u(n,i),R=a(n,i+1);c.ex=r,(L||R)&&(c.ex=r+g),W&&O&&(c.ex=r-g);break;case"right":c.sx=t+g,c.ex=r+g;var D=f(n-1,i+1)||s(n,i+1),I=s(n,i),V=f(n-1,i);c.sy=e,(I||V)&&(c.sy=e-g),D&&v&&(c.sy=e+g);var H=s(n+1,i+1)||f(n,i+1),M=f(n,i),N=s(n+1,i);c.ey=o,(M||N)&&(c.ey=o+g),H&&m&&(c.ey=o-g);break;case"bottom":c.sy=e+g,c.ey=o+g;var z=u(n+1,i-1)||a(n+1,i),B=a(n,i),Y=u(n,i-1);c.sx=t,(B||Y)&&(c.sx=t-g),z&&x&&(c.sx=t+g);var F=a(n+1,i+1)||u(n+1,i),U=u(n,i),X=a(n,i+1);c.ex=r,(U||X)&&(c.ex=r+g),F&&O&&(c.ex=r-g)}return c}switch(l){case"left":c.sx=t-g,c.ex=r-g;var G=f(n-1,i-1)||s(n,i-1),K=s(n,i),q=f(n-1,i);c.sy=e,(K||q)&&(c.sy=e-g),G&&(c.sy=e+g);var $=s(n+1,i-1)||f(n,i-1),Z=f(n,i),J=s(n+1,i);c.ey=o,(Z||J)&&(c.ey=o+g),$&&(c.ey=o-g);break;case"top":c.sy=e-g,c.ey=o-g;var Q=u(n-1,i-1)||a(n-1,i),tt=a(n,i),et=u(n,i-1);c.sx=t,(tt||et)&&(c.sx=t-g),Q&&(c.sx=t+g);var rt=a(n-1,i+1)||u(n-1,i),ot=u(n,i),nt=a(n,i+1);c.ex=r,(ot||nt)&&(c.ex=r+g),rt&&(c.ex=r-g);break;case"right":c.sx=t+g,c.ex=r+g;var it=f(n-1,i+1)||s(n,i+1),lt=s(n,i),ct=f(n-1,i);c.sy=e,(lt||ct)&&(c.sy=e-g),it&&(c.sy=e+g);var at=s(n+1,i+1)||f(n,i+1),st=f(n,i),ut=s(n+1,i);c.ey=o,(st||ut)&&(c.ey=o+g),at&&(c.ey=o-g);break;case"bottom":c.sy=e+g,c.ey=o+g;var ft=u(n+1,i-1)||a(n+1,i),ht=a(n,i),dt=u(n,i-1);c.sx=t,(ht||dt)&&(c.sx=t-g),ft&&(c.sx=t+g);var pt=a(n+1,i+1)||u(n+1,i),yt=u(n,i),bt=a(n,i+1);c.ex=r,(yt||bt)&&(c.ex=r+g),pt&&(c.ex=r-g)}return c}},{key:"handleInternal",value:function(t,e,r,o,n,i,l){var c={},a=this.leftShow,s=this.topShow,u=this.rightShow,f=this.bottomShow,h=this.iFMerge,d=this.iFMergeFirstRow,p=this.iFMergeLastRow,y=this.iFMergeFirstCol,b=this.iFMergeLastCol,g=this.spacing;if(h(n,i)){var w=d(n,i),v=p(n,i),m=y(n,i),x=b(n,i);switch(l){case"left":c.sx=t+g,c.ex=r+g;var O=f(n-1,i-1)||s(n,i-1),k=s(n,i),E=f(n-1,i);c.sy=e,O&&(c.sy=e-g),(k||E)&&w&&(c.sy=e+g);var S=s(n+1,i-1)||f(n,i-1),A=f(n,i),_=s(n+1,i);c.ey=o,S&&(c.ey=o+g),(A||_)&&v&&(c.ey=o-g);break;case"top":c.sy=e+g,c.ey=o+g;var T=u(n-1,i-1)||a(n-1,i),C=a(n,i),P=u(n,i-1);c.sx=t,T&&(c.sx=t-g),(C||P)&&m&&(c.sx=t+g);var j=a(n-1,i+1)||u(n-1,i),W=u(n,i),L=a(n,i+1);c.ex=r,j&&(c.ex=r+g),(W||L)&&x&&(c.ex=r-g);break;case"right":c.sx=t-g,c.ex=r-g;var R=f(n-1,i+1)||s(n,i+1),D=s(n,i),I=f(n-1,i);c.sy=e,R&&(c.sy=e-g),(D||I)&&w&&(c.sy=e+g);var V=s(n+1,i+1)||f(n,i+1),H=f(n,i),M=s(n+1,i);c.ey=o,V&&(c.ey=o+g),(H||M)&&v&&(c.ey=o-g);break;case"bottom":c.sy=e-g,c.ey=o-g;var N=u(n+1,i-1)||a(n+1,i),z=a(n,i),B=u(n,i-1);c.sx=t,N&&(c.sx=t-g),(z||B)&&m&&(c.sx=t+g);var Y=a(n+1,i+1)||u(n+1,i),F=u(n,i),U=a(n,i+1);c.ex=r,Y&&(c.ex=r+g),(F||U)&&x&&(c.ex=r-g)}return c}switch(l){case"left":c.sx=t+g,c.ex=r+g;var X=f(n-1,i-1)||s(n,i-1),G=s(n,i),K=f(n-1,i);c.sy=e,X&&(c.sy=e-g),(G||K)&&(c.sy=e+g);var q=s(n+1,i-1)||f(n,i-1),$=f(n,i),Z=s(n+1,i);c.ey=o,q&&(c.ey=o+g),($||Z)&&(c.ey=o-g);break;case"top":c.sy=e+g,c.ey=o+g;var J=u(n-1,i-1)||a(n-1,i),Q=a(n,i),tt=u(n,i-1);c.sx=t,J&&(c.sx=t-g),(Q||tt)&&(c.sx=t+g);var et=a(n-1,i+1)||u(n-1,i),rt=u(n,i),ot=a(n,i+1);c.ex=r,et&&(c.ex=r+g),(rt||ot)&&(c.ex=r-g);break;case"right":c.sx=t-g,c.ex=r-g;var nt=f(n-1,i+1)||s(n,i+1),it=s(n,i),lt=f(n-1,i);c.sy=e,nt&&(c.sy=e-g),(it||lt)&&(c.sy=e+g);var ct=s(n+1,i+1)||f(n,i+1),at=f(n,i),st=s(n+1,i);c.ey=o,ct&&(c.ey=o+g),(at||st)&&(c.ey=o-g);break;case"bottom":c.sy=e-g,c.ey=o-g;var ut=u(n+1,i-1)||a(n+1,i),ft=a(n,i),ht=u(n,i-1);c.sx=t,ut&&(c.sx=t-g),(ft||ht)&&(c.sx=t+g);var dt=a(n+1,i+1)||u(n+1,i),pt=u(n,i),yt=a(n,i+1);c.ex=r,dt&&(c.ex=r+g),(pt||yt)&&(c.ex=r-g)}return c}},{key:"drawLine",value:function(t,e,r,o,n,i,l){var c=this.draw,a=this.width,s=this.color;c.beginPath(),c.attr({lineWidth:a,strokeStyle:s}),c.setLineDash([]);var u=this.handleExternal(t,e,r,o,n,i,l),f=this.handleInternal(t,e,r,o,n,i,l);k.isEmptyObject(f)||c.line([f.sx,f.sy],[f.ex,f.ey]),k.isEmptyObject(u)||c.line([u.sx,u.sy],[u.ex,u.ey])}},{key:"setColor",value:function(t){this.color=t}},{key:"setWidth",value:function(t){this.width=t}}]),t}(),Fi=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Vi(this,t),this.type=Ni.SOLID_LINE,this.solidLine=new zi(e,k.mergeDeep({},r)),this.dottedLine=new Bi(e,k.mergeDeep({dash:[5]},r)),this.pointLine=new Bi(e,k.mergeDeep({dash:[2,2]},r)),this.doubleLine=new Yi(e,k.mergeDeep({},r))}return Mi(t,[{key:"drawLine",value:function(t,e,r,o,n,i,l){var c=this.type,a=this.solidLine,s=this.dottedLine,u=this.pointLine,f=this.doubleLine;switch(c){case Ni.SOLID_LINE:a.drawLine(t,e,r,o);break;case Ni.DOTTED_LINE:s.drawLine(t,e,r,o);break;case Ni.POINT_LINE:u.drawLine(t,e,r,o);break;case Ni.DOUBLE_LINE:f.drawLine(t,e,r,o,n,i,l)}}},{key:"setType",value:function(t){this.type=t}},{key:"setWidth",value:function(t){t&&this.type===Ni.SOLID_LINE&&this.solidLine.setWidth(t)}},{key:"setColor",value:function(t){t&&(this.solidLine.setColor(t),this.dottedLine.setColor(t),this.pointLine.setColor(t),this.doubleLine.setColor(t))}}]),t}();function Ui(t){return(Ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xi(t){return(Xi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ki(t,e){return(Ki=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qi=function(t){function e(){var t,r,i,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,i=Xi(e).call(this,"".concat(n,"-border-type-context-menu"),k.mergeDeep({onUpdate:function(){}},l)),(t=!i||"object"!==Ui(i)&&"function"!=typeof i?Gi(r):i).type=Ni.SOLID_LINE,t.color="#000000",t.borderIcon1=new un,t.borderIcon2=new yn,t.borderIcon3=new mn,t.borderIcon4=new Sn,t.borderIcon5=new Pn;var c=_("div","".concat(n,"-border-type-context-menu-type-icon-line"));c.children(t.borderIcon1),c.children(t.borderIcon2),c.children(t.borderIcon3),c.children(t.borderIcon4),c.children(t.borderIcon5),t.borderIcon6=new Dn,t.borderIcon7=new Nn,t.borderIcon8=new Un,t.borderIcon9=new $n,t.borderIcon10=new ei;var a=_("div","".concat(n,"-border-type-context-menu-type-icon-line"));a.children(t.borderIcon6),a.children(t.borderIcon7),a.children(t.borderIcon8),a.children(t.borderIcon9),a.children(t.borderIcon10),t.borderIcons=new nn,t.borderIcons.removeClass("hover"),t.borderIcons.children(c),t.borderIcons.children(a),t.borderColor=new ci,t.borderType=new hi;var s=_("div","".concat(n,"-border-type-context-menu-type-icon-line"));return s.children(t.borderColor),s.children(t.borderType),t.borderColorAndType=new nn,t.borderColorAndType.removeClass("hover"),t.borderColorAndType.children(s),t.addItem(t.borderIcons),t.addItem(new Re),t.addItem(t.borderColorAndType),t.borderColorContextMenu=new ki(k.copyProp({el:t.borderColor,position:se.BOTTOM},{onUpdate:function(e){t.color=e,t.borderColor.setColor(e)}})),t.lineTypeContextMenu=new Ii(k.copyProp({el:t.borderType,position:se.BOTTOM},{onUpdate:function(e){t.type=e}})),Rt.bind(t.borderColor,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=Gi(t).borderColorContextMenu,o=r.elPopUp;fe.closeAll([o,t.elPopUp]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Rt.bind(t.borderType,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=Gi(t).lineTypeContextMenu,o=r.elPopUp;fe.closeAll([o,t.elPopUp]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Rt.bind(t.borderIcon1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border1",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Rt.bind(t.borderIcon2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border2",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Rt.bind(t.borderIcon3,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border3",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Rt.bind(t.borderIcon4,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border4",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Rt.bind(t.borderIcon5,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border5",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Rt.bind(t.borderIcon6,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border6",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Rt.bind(t.borderIcon7,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border7",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Rt.bind(t.borderIcon8,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border8",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Rt.bind(t.borderIcon9,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border9",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Rt.bind(t.borderIcon10,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border10",t.color,t.type),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ki(t,e)}(e,t),e}(ge);function $i(t){return($i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zi(t){return(Zi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ji(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qi(t,e){return(Qi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var tl=function(t){function e(t){var r,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(r=!(i=Zi(e).call(this,"".concat(n,"-tools-border")))||"object"!==$i(i)&&"function"!=typeof i?Ji(o):i).options=k.copyProp({contextMenu:{}},t),r.icon=new tt("border"),r.setIcon(r.icon),r.borderTypeContextMenu=new qi(k.copyProp({el:Ji(r),position:se.BOTTOM},r.options.contextMenu)),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qi(t,e)}(e,t),e}(Wt);function el(t){return(el="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rl(t,e){return!e||"object"!==el(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ol(t){return(ol=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nl(t,e){return(nl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var il=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=rl(this,ol(e).call(this,"".concat(n,"-tools-merge")))).icon=new tt("merge"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nl(t,e)}(e,t),e}(it);function ll(t){return(ll="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cl(t,e){return!e||"object"!==ll(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function al(t){return(al=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sl(t,e){return(sl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ul=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=cl(this,al(e).call(this,"".concat(n,"-tools-horizontal1")))).icon=new tt("align-left"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sl(t,e)}(e,t),e}(it);function fl(t){return(fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hl(t,e){return!e||"object"!==fl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dl(t){return(dl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pl(t,e){return(pl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yl=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=hl(this,dl(e).call(this,"".concat(n,"-tools-horizontal2")))).icon=new tt("align-center"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pl(t,e)}(e,t),e}(it);function bl(t){return(bl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gl(t,e){return!e||"object"!==bl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wl(t){return(wl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vl(t,e){return(vl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ml=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=gl(this,wl(e).call(this,"".concat(n,"-tools-horizontal3")))).icon=new tt("align-right"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vl(t,e)}(e,t),e}(it);function xl(t){return(xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ol(t,e){return!e||"object"!==xl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kl(t){return(kl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function El(t,e){return(El=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Sl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ol(this,kl(e).call(this,"".concat(n,"-horizontal-type-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&El(t,e)}(e,t),e}(Oe);function Al(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var _l=function(){function t(e){var r=e.rect,o=e.draw,n=e.offset,i=void 0===n?0:n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rect=r,this.draw=o,this.offset=i}var e,r,o;return e=t,(r=[{key:"open",value:function(){var t=this.rect,e=this.draw,r=this.offset,o=t.x,n=t.y,i=t.width,l=t.height;return e.save(),e.rect(o,n,i+r,l+r),e.clip(),this}},{key:"close",value:function(){return this.draw.restore(),this}}])&&Al(e.prototype,r),o&&Al(e,o),t}();function Tl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var r=[],o=!0,n=!1,i=void 0;try{for(var l,c=t[Symbol.iterator]();!(o=(l=c.next()).done)&&(r.push(l.value),!e||r.length!==e);o=!0);}catch(t){n=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(n)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Cl(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Pl(){return window.devicePixelRatio||1}function jl(t){return Math.ceil(t*Pl())}function Wl(t){return-t*(Math.PI/180)}var Ll=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.ctx=e.getContext("2d"),this.width=e.width,this.height=e.height,this.offsetX=0,this.offsetY=0}var e,r,o;return e=t,(r=[{key:"rotate",value:function(t){return this.ctx.rotate(Wl(t)),this}},{key:"offset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offsetX=t,this.offsetY=e}},{key:"resize",value:function(t,e){var r=this.el;return this.width=t,this.height=e,r.style.width="".concat(t,"px"),r.style.height="".concat(e,"px"),r.width=jl(t),r.height=jl(e),this}},{key:"clear",value:function(){var t=this.width,e=this.height;return this.clearRect(0,0,t,e),this}},{key:"attr",value:function(t){for(var e in t)if(t.hasOwnProperty(e)){var r=t[e];("string"==typeof r||r instanceof String)&&(r=r.trim()),this.ctx[e]!==r&&(this.ctx[e]=r)}return this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"save",value:function(){return this.ctx.save(),this.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"clip",value:function(){return this.ctx.clip(),this}},{key:"fill",value:function(){this.ctx.fill()}},{key:"setLineDash",value:function(t){this.ctx.setLineDash(t)}},{key:"measureText",value:function(t){return this.ctx.measureText(t)}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){var e=arguments.length<=0?void 0:arguments[0],r=Tl(e,2),o=r[0],n=r[1];this.moveTo(o,n);for(var i=1,l=arguments.length;i<l;i+=1){var c=i<0||arguments.length<=i?void 0:arguments[i],a=Tl(c,2),s=a[0],u=a[1];this.lineTo(s,u)}t.stroke()}return this}},{key:"clearRect",value:function(t,e,r,o){var n=this.offsetX,i=this.offsetY;return this.ctx.clearRect(jl(t+n),jl(e+i),jl(r),jl(o)),this}},{key:"rect",value:function(t,e,r,o){var n=this.offsetX,i=this.offsetY;return this.ctx.rect(jl(t+n),jl(e+i),jl(r),jl(o)),this}},{key:"fillRect",value:function(t,e,r,o){var n=this.offsetX,i=this.offsetY;return this.ctx.fillRect(jl(t+n),jl(e+i),jl(r),jl(o)),this}},{key:"fillText",value:function(t,e,r){var o=this.offsetX,n=this.offsetY;return this.ctx.fillText(t,jl(e+o),jl(r+n)),this}},{key:"moveTo",value:function(t,e){var r=this.ctx,o=this.offsetX,n=this.offsetY,i=r.lineWidth%2==0,l=i?jl(t+o):jl(t+o)+.5,c=i?jl(e+n):jl(e+n)+.5;r.moveTo(l,c)}},{key:"lineTo",value:function(t,e){var r=this.ctx,o=this.offsetX,n=this.offsetY,i=r.lineWidth%2==0,l=i?jl(t+o):jl(t+o)+.5,c=i?jl(e+n):jl(e+n)+.5;r.lineTo(l,c)}},{key:"drawImage",value:function(t,e,r,o,n,i,l,c,a){var s=this.offsetX,u=this.offsetY;this.ctx.drawImage(t,jl(e+s),jl(r+u),jl(o),jl(n),jl(i+s),jl(l+u),jl(c),jl(a))}}])&&Cl(e.prototype,r),o&&Cl(e,o),t}();function Rl(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Dl=function(){function t(e){var r=e.x,o=e.y,n=e.width,i=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=r,this.y=o,this.width=n,this.height=i}var e,r,o;return e=t,(r=[{key:"expandSize",value:function(t){return this.width+=t,this.height+=t,this}},{key:"clone",value:function(){return new t({x:this.x,y:this.y,width:this.width,height:this.height})}}])&&Rl(e.prototype,r),o&&Rl(e,o),t}();function Il(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vl(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Hl(t,e,r){return e&&Vl(t.prototype,e),r&&Vl(t,r),t}var Ml={TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right",MIDDLE_LEFT:"middle-left",MIDDLE_CENTER:"middle-center",MIDDLE_RIGHT:"middle-right",BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right"},Nl=function(){function t(e){var r=e.dw,o=e.angle,n=e.origin,i=void 0===n?Ml.MIDDLE_CENTER:n,l=e.rect,c=void 0===l?new Dl({x:0,y:0,width:0,height:0}):l;Il(this,t),this.dw=r,this.origin=i,this.rect=c,this.angle=o}return Hl(t,[{key:"rotate",value:function(){var t=this.origin,e=this.dw,r=this.rect,o=this.angle,n=r.x,i=r.y,l=r.width,c=r.height;e.save();var a=0,s=0;switch(t){case Ml.TOP_LEFT:a=n,s=i;break;case Ml.TOP_CENTER:a=n+l/2,s=i;break;case Ml.TOP_RIGHT:a=n+l,s=i;break;case Ml.MIDDLE_LEFT:a=n,s=i+c/2;break;case Ml.MIDDLE_CENTER:a=n+l/2,s=i+c/2;break;case Ml.MIDDLE_RIGHT:a=n+l,s=i+c/2;break;case Ml.BOTTOM_LEFT:a=n,s=i+c;break;case Ml.BOTTOM_CENTER:a=n+l/2,s=i+c;break;case Ml.BOTTOM_RIGHT:a=n+l,s=i+c}return e.ctx.translate(jl(a+e.offsetX),jl(s+e.offsetY)),e.rotate(o),e.ctx.translate(-jl(a+e.offsetX),-jl(s+e.offsetY)),this}},{key:"revert",value:function(){return this.dw.restore(),this}},{key:"setOrigin",value:function(t){return this.origin=t,this}},{key:"setRect",value:function(t){return this.rect=t,this}}],[{key:"triangleHypotenuse",value:function(t,e){var r=Math.cos(Wl(t)),o=Math.sin(Wl(t));return{width:Math.abs(r*e),height:Math.abs(o*e)}}}]),t}(),zl=function(){function t(e){var r=e.angle,o=e.width,n=e.height;Il(this,t),this.angle=r,this.width=o,this.height=n}return Hl(t,[{key:"sinWidthAngle",value:function(){var t=this.angle,e=this.width;return Math.abs(Math.sin(Wl(t))*e)}},{key:"cosWidthAngle",value:function(){var t=this.angle,e=this.width;return Math.abs(Math.cos(Wl(t))*e)}},{key:"sinHeightAngle",value:function(){var t=this.angle,e=this.height;return Math.abs(e/Math.sin(Wl(t)))}},{key:"setWidth",value:function(t){this.width=t}},{key:"setHeight",value:function(t){this.height=t}},{key:"setAngle",value:function(t){this.angle=t}}]),t}();function Bl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yl(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Fl(t,e,r){return e&&Yl(t.prototype,e),r&&Yl(t,r),t}var Ul={left:"left",center:"center",right:"right"},Xl={top:"top",center:"middle",bottom:"bottom"},Gl={OVER_FLOW:1,WORD_WRAP:2,TRUNCATE:3},Kl={HORIZONTAL:"horizontal",VERTICAL:"vertical",ANGLE:"angle"},ql=function(){function t(e){var r=e.text,o=e.rect,n=e.dw,i=e.overflow,l=e.overflowCrop,c=e.attr;Bl(this,t),this.text=r,this.dw=n,this.rect=o,this.overflow=i,this.overflowCrop=l,this.attr=c}return Fl(t,[{key:"textWidth",value:function(t){return this.dw.measureText(t).width}},{key:"drawLine",value:function(t,e,r,o){var n=this.dw,i=this.attr,l=i.size,c=i.verticalAlign,a=i.align,s=[0,0],u=[0,0];if("strike"===t){switch(a){case Ul.right:s[0]=e-o,u[0]=e;break;case Ul.center:s[0]=e-o/2,u[0]=e+o/2;break;case Ul.left:s[0]=e,u[0]=e+o}switch(c){case Xl.top:s[1]=r+l/2,u[1]=r+l/2;break;case Xl.center:s[1]=r,u[1]=r;break;case Xl.bottom:s[1]=r-l/2,u[1]=r-l/2}}if("underline"===t){switch(a){case Ul.right:s[0]=e-o,u[0]=e;break;case Ul.center:s[0]=e-o/2,u[0]=e+o/2;break;case Ul.left:s[0]=e,u[0]=e+o}switch(c){case Xl.top:s[1]=r+l,u[1]=r+l;break;case Xl.center:s[1]=r+l/2,u[1]=r+l/2;break;case Xl.bottom:s[1]=r,u[1]=r}}n.line(s,u)}},{key:"drawTextTruncate",value:function(){var t,e=this.text,r=this.dw,o=this.attr,n=this.rect,i=o.underline,l=o.strikethrough,c=o.align,a=o.verticalAlign,s=n.width,u=n.height,f=this.textWidth(e)/Pl(),h=n.x,d=n.y;switch(c){case Ul.left:h+=8;break;case Ul.center:h+=s/2;break;case Ul.right:h+=s-8}switch(a){case Xl.top:d+=8;break;case Xl.center:d+=u/2;break;case Xl.bottom:d+=u-8}switch(c){case Ul.right:case Ul.left:t=f+16;break;case Ul.center:default:t=f}var p=new _l({draw:r,rect:n});return p.open(),r.fillText(e,h,d),(i||l)&&r.beginPath(),i&&this.drawLine("underline",h,d,f),l&&this.drawLine("strike",h,d,f),p.close(),t}},{key:"drawTextOverFlow",value:function(){var t,e=this.text,r=this.dw,o=this.attr,n=this.rect,i=this.overflow,l=this.overflowCrop,c=o.size,a=o.underline,s=o.strikethrough,u=o.align,f=o.verticalAlign,h=n.width,d=n.height,p=this.textWidth(e)/Pl(),y=n.x,b=n.y,g=0,w=0;switch(u){case Ul.left:y+=8,g=8;break;case Ul.center:y+=h/2;break;case Ul.right:y+=h-8,g=8}switch(f){case Xl.top:b+=8,w=8;break;case Xl.center:b+=d/2;break;case Xl.bottom:b+=d-8,w=8}switch(u){case Ul.right:case Ul.left:t=p+16;break;case Ul.center:default:t=p}if(l||i&&(p+g>i.width||c+w>i.height)){var v=new _l({draw:r,rect:i});v.open(),r.fillText(e,y,b),(a||s)&&r.beginPath(),a&&this.drawLine("underline",y,b,p),s&&this.drawLine("strike",y,b,p),v.close()}else r.fillText(e,y,b),(a||s)&&r.beginPath(),a&&this.drawLine("underline",y,b,p),s&&this.drawLine("strike",y,b,p);return t}},{key:"drawTextWarp",value:function(){for(var t=this.text,e=this.dw,r=this.attr,o=this.rect,n=r.size,i=r.underline,l=r.strikethrough,c=r.align,a=r.verticalAlign,s=o.width,u=o.height,f=s-16,h=[],d={len:0,start:0},p=t.length,y=0,b=0,g=0;b<p;){var w=this.textWidth(t.charAt(b))/Pl(),v=d.len+w;v>f?(0===d.len?(h.push({text:t.substring(b,b+1),len:v,tx:0,ty:y}),b+=1,v>g&&(g=v)):(h.push({text:t.substring(d.start,b),len:d.len,tx:0,ty:y}),d.len>g&&(g=d.len)),y+=n+4,d.len=0,d.start=b):(d.len=v,b+=1)}d.len>0&&(h.push({text:t.substring(d.start),len:d.len,tx:0,ty:y}),d.len>g&&(g=d.len));var m,x=o.x,O=o.y;switch(c){case Ul.left:x+=8;break;case Ul.center:x+=s/2;break;case Ul.right:x+=s-8}switch(a){case Xl.top:O+=8;break;case Xl.center:O+=u/2-y/2;break;case Xl.bottom:O+=u-y-8}switch(c){case Ul.right:case Ul.left:m=g+16;break;case Ul.center:default:m=g}var k=new _l({draw:e,rect:o});k.open();for(var E=0,S=h.length;E<S;E+=1){var A=h[E];A.tx+=x,A.ty+=O,e.fillText(A.text,A.tx,A.ty),(i||l)&&e.beginPath(),i&&this.drawLine("underline",A.tx,A.ty,A.len),l&&this.drawLine("strike",A.tx,A.ty,A.len)}return k.close(),m}},{key:"draw",value:function(){var t=this.dw,e=this.attr,r=e.textWrap;switch(t.attr({textAlign:e.align,textBaseline:e.verticalAlign,font:"".concat(e.italic?"italic":""," ").concat(e.bold?"bold":""," ").concat(jl(e.size),"px ").concat(e.name),fillStyle:e.color,strokeStyle:e.color}),r){case Gl.TRUNCATE:return this.drawTextTruncate();case Gl.WORD_WRAP:return this.drawTextWarp();case Gl.OVER_FLOW:default:return this.drawTextOverFlow()}}},{key:"setTextWrap",value:function(t){this.attr.textWrap=t}},{key:"setOverflowCrop",value:function(t){this.overflowCrop=t}}]),t}(),$l=function(){function t(e){var r=e.text,o=e.rect,n=e.dw,i=e.overflow,l=e.overflowCrop,c=e.attr;Bl(this,t),this.text=r,this.dw=n,this.rect=o,this.overflow=i,this.overflowCrop=l,this.attr=c}return Fl(t,[{key:"textWidth",value:function(t){return this.dw.measureText(t).width}},{key:"drawLine",value:function(t,e,r,o,n,i){var l=this.dw,c=this.attr.size,a=[0,0],s=[0,0];if("strike"===t){switch(n){case Ul.right:a[0]=e-o,s[0]=e;break;case Ul.center:a[0]=e-o/2,s[0]=e+o/2;break;case Ul.left:a[0]=e,s[0]=e+o}switch(i){case Xl.top:a[1]=r+c/2,s[1]=r+c/2;break;case Xl.center:a[1]=r,s[1]=r;break;case Xl.bottom:a[1]=r-c/2,s[1]=r-c/2}}if("underline"===t){switch(n){case Ul.right:a[0]=e-o,s[0]=e;break;case Ul.center:a[0]=e-o/2,s[0]=e+o/2;break;case Ul.left:a[0]=e,s[0]=e+o}switch(i){case Xl.top:a[1]=r+c,s[1]=r+c;break;case Xl.center:a[1]=r+c/2,s[1]=r+c/2;break;case Xl.bottom:a[1]=r,s[1]=r}}l.line(a,s)}},{key:"drawTextTruncate",value:function(){for(var t=this.text,e=this.dw,r=this.attr,o=this.rect,n=r.underline,i=r.strikethrough,l=r.align,c=r.verticalAlign,a=r.size,s=o.width,u=o.height,f=[],h=0,d=0;d<t.length;d+=1){var p=t.charAt(d);f.push({len:this.textWidth(p)/Pl(),text:p,tx:0,ty:h}),d<t.length-1?h+=a+2:h+=a}var y,b=o.x,g=o.y;switch(l){case Ul.left:b+=8;break;case Ul.center:b+=s/2;break;case Ul.right:b+=s-8}switch(c){case Xl.top:g+=8;break;case Xl.center:g+=u/2-h/2+8;break;case Xl.bottom:g+=u-h+8}switch(l){case Ul.left:case Ul.right:y=a+16;break;case Ul.center:default:y=a}var w=new _l({draw:e,rect:o});w.open();for(var v=0,m=f.length;v<m;v+=1){var x=f[v];x.tx+=b,x.ty+=g,e.fillText(x.text,x.tx,x.ty),(n||i)&&e.beginPath(),n&&this.drawLine("underline",x.tx,x.ty,x.len,l,c),i&&this.drawLine("strike",x.tx,x.ty,x.len,l,c)}return w.close(),y}},{key:"drawTextOverFlow",value:function(){for(var t=this.text,e=this.dw,r=this.attr,o=this.rect,n=this.overflow,i=this.overflowCrop,l=r.underline,c=r.strikethrough,a=r.align,s=r.verticalAlign,u=r.size,f=o.width,h=o.height,d=[],p=0,y=0;y<t.length;y+=1){var b=t.charAt(y);d.push({len:this.textWidth(b)/Pl(),text:b,tx:0,ty:p}),y<t.length-1?p+=u+2:p+=u}var g,w=o.x,v=o.y,m=0,x=0;switch(a){case Ul.left:w+=8,m=8;break;case Ul.center:w+=f/2;break;case Ul.right:w+=f-8,m=8}switch(s){case Xl.top:v+=8,x=8;break;case Xl.center:v+=h/2-p/2+8;break;case Xl.bottom:v+=h-p+8,x=8}switch(a){case Ul.left:case Ul.right:g=u+16;break;case Ul.center:default:g=u}if(i||n&&(p+x>n.height||u+m>n.width)){var O=new _l({draw:e,rect:n});O.open();for(var k=0,E=d.length;k<E;k+=1){var S=d[k];S.tx+=w,S.ty+=v,e.fillText(S.text,S.tx,S.ty),(l||c)&&e.beginPath(),l&&this.drawLine("underline",S.tx,S.ty,S.len,a,s),c&&this.drawLine("strike",S.tx,S.ty,S.len,a,s)}O.close()}else for(var A=0,_=d.length;A<_;A+=1){var T=d[A];T.tx+=w,T.ty+=v,e.fillText(T.text,T.tx,T.ty),(l||c)&&e.beginPath(),l&&this.drawLine("underline",T.tx,T.ty,T.len,a,s),c&&this.drawLine("strike",T.tx,T.ty,T.len,a,s)}return g}},{key:"drawTextWarp",value:function(){for(var t=this.text,e=this.dw,r=this.attr,o=this.rect,n=r.underline,i=r.strikethrough,l=r.align,c=r.verticalAlign,a=r.size,s=o.width,u=o.height,f=[],h=t.length,d=u-16,p=[],y=0,b=0,g=0,w=0,v=0;v<h;){var m=v===h-1,x=0===v,O=t.charAt(v),k=this.textWidth(O)/Pl(),E=void 0;(E=m?y+a:y+a+2)>d?(p.length>0&&f.push(p),y=0,x||(g+=a+0),w+=1,(p=[]).push({len:k,text:O,tx:g,ty:b=0}),y=m?a:a+2):(p.push({len:k,text:O,tx:g,ty:b}),y=E),b+=m?a:a+2,v+=1}p.length>0&&f.push(p);var S,A=o.x,_=o.y,T=c;switch(l){case Ul.left:A+=8;break;case Ul.center:A+=s/2-g/2;break;case Ul.right:A+=s-g-8}switch(c){case Xl.top:e.attr({textBaseline:r.verticalAlign}),_+=8,T=Xl.top;break;case Xl.center:0===w?(e.attr({textBaseline:r.verticalAlign}),_+=u/2-b/2+8,T=Xl.center):(e.attr({textBaseline:Xl.top}),_+=8,T=Xl.top);break;case Xl.bottom:0===w?(e.attr({textBaseline:Xl.bottom}),_+=u-b+8,T=Xl.bottom):(e.attr({textBaseline:Xl.top}),_+=8,T=Xl.top)}switch(l){case Ul.left:case Ul.right:S=g+a+16;break;case Ul.center:default:S=g+a}var C=new _l({draw:e,rect:o});C.open();for(var P=0,j=f.length;P<j;P+=1)for(var W=f[P],L=0;L<W.length;L+=1){var R=W[L];R.tx+=A,R.ty+=_,e.fillText(R.text,R.tx,R.ty),(n||i)&&e.beginPath(),n&&this.drawLine("underline",R.tx,R.ty,R.len,l,T),i&&this.drawLine("strike",R.tx,R.ty,R.len,l,T)}return C.close(),S}},{key:"draw",value:function(){var t=this.dw,e=this.attr;switch(e.textWrap){case Gl.TRUNCATE:return t.attr({textAlign:e.align,textBaseline:e.verticalAlign,font:"".concat(e.italic?"italic":""," ").concat(e.bold?"bold":""," ").concat(jl(e.size),"px ").concat(e.name),fillStyle:e.color,strokeStyle:e.color}),this.drawTextTruncate();case Gl.WORD_WRAP:return t.attr({textAlign:e.align,font:"".concat(e.italic?"italic":""," ").concat(e.bold?"bold":""," ").concat(jl(e.size),"px ").concat(e.name),fillStyle:e.color,strokeStyle:e.color}),this.drawTextWarp();case Gl.OVER_FLOW:default:return t.attr({textAlign:e.align,textBaseline:e.verticalAlign,font:"".concat(e.italic?"italic":""," ").concat(e.bold?"bold":""," ").concat(jl(e.size),"px ").concat(e.name),fillStyle:e.color,strokeStyle:e.color}),this.drawTextOverFlow()}}},{key:"setTextWrap",value:function(t){this.attr.textWrap=t}},{key:"setOverflowCrop",value:function(t){this.overflowCrop=t}}]),t}(),Zl=function(){function t(e){var r=e.text,o=e.rect,n=e.dw,i=e.overflow,l=e.overflowCrop,c=e.attr;Bl(this,t),this.text=r,this.dw=n,this.rect=o,this.overflow=i,this.overflowCrop=l,this.attr=c}return Fl(t,[{key:"textWidth",value:function(t){return this.dw.measureText(t).width}},{key:"drawLine",value:function(t,e,r,o){var n=this.dw,i=this.attr.size,l=[0,0],c=[0,0];"strike"===t&&(l[0]=e,c[0]=e+o,l[1]=r+i/2,c[1]=r+i/2),"underline"===t&&(l[0]=e,c[0]=e+o,l[1]=r+i,c[1]=r+i),n.line(l,c)}},{key:"drawTextTruncate",value:function(){var t=this.text,e=this.dw,r=this.attr,o=this.rect,n=r.underline,i=r.strikethrough,l=r.align,c=r.verticalAlign,a=r.size,s=r.angle,u=o.width,f=o.height;s>90&&(s=90),s<-90&&(s=-90);var h,d=this.textWidth(t)/Pl(),p=new zl({angle:s,width:d,height:a}),y=p.cosWidthAngle(),b=p.sinWidthAngle(),g=o.x,w=o.y;switch(l){case Ul.left:g+=8;break;case Ul.center:g+=u/2-y/2;break;case Ul.right:g+=u-y-8}switch(c){case Xl.top:w+=8;break;case Xl.center:w+=f/2-b/2;break;case Xl.bottom:w+=f-b-8}switch(l){case Ul.right:case Ul.left:h=y+16;break;case Ul.center:default:h=y}var v,m=g+(y/2-d/2),x=w+(b/2-a/2),O=new Nl({dw:e,angle:s,rect:new Dl({x:g,y:w,width:y,height:b})});return(v=new _l(0===s?{draw:e,rect:o}:{draw:e,rect:new Dl({x:0,y:o.y,width:h,height:o.height})})).open(),O.rotate(),e.fillText(t,m,x),(n||i)&&e.beginPath(),n&&this.drawLine("underline",m,x,d),i&&this.drawLine("strike",m,x,d),O.revert(),v.close(),h}},{key:"drawTextOverFlow",value:function(){var t=this.text,e=this.dw,r=this.attr,o=this.rect,n=this.overflow,i=r.underline,l=r.strikethrough,c=r.align,a=r.verticalAlign,s=r.size,u=r.overflowCrop,f=r.angle,h=o.width,d=o.height;f>90&&(f=90),f<-90&&(f=-90);var p,y=this.textWidth(t)/Pl(),b=new zl({angle:f,width:y,height:s}),g=b.cosWidthAngle(),w=b.sinWidthAngle(),v=o.x,m=o.y;switch(c){case Ul.left:v+=8;break;case Ul.center:v+=h/2-g/2;break;case Ul.right:v+=h-g-8}switch(a){case Xl.top:m+=8;break;case Xl.center:m+=d/2-w/2;break;case Xl.bottom:m+=d-w-8}switch(c){case Ul.right:case Ul.left:p=g+16;break;case Ul.center:default:p=g}var x,O=v+(g/2-y/2),k=m+(w/2-s/2),E=new Nl({dw:e,angle:f,rect:new Dl({x:v,y:m,width:g,height:w})});return x=new _l(0===f?{draw:e,rect:n}:{draw:e,rect:new Dl({x:0,y:o.y,width:p,height:o.height})}),u||n&&(g>n.width||w>n.height)?(x.open(),E.rotate(),e.fillText(t,O,k),(i||l)&&e.beginPath(),i&&this.drawLine("underline",O,k,y),l&&this.drawLine("strike",O,k,y),E.revert(),x.close()):(E.rotate(),e.fillText(t,O,k),(i||l)&&e.beginPath(),i&&this.drawLine("underline",O,k,y),l&&this.drawLine("strike",O,k,y),E.revert()),p}},{key:"drawTextWarp",value:function(){var t=this.text,e=this.dw,r=this.attr,o=this.rect,n=r.underline,i=r.strikethrough,l=r.align,c=r.verticalAlign,a=r.size,s=r.angle;s>90&&(s=90),s<-90&&(s=-90);var u=o.width,f=o.height;if(s>0){var h=new zl({angle:s});h.setHeight(f-16);var d=h.sinHeightAngle();h.setHeight(a+4);for(var p=h.sinHeightAngle(),y=[],b={len:0,start:0},g=t.length,w=0;w<g;){var v=this.textWidth(t.charAt(w))/Pl(),m=b.len+v;m>d?(0===b.len?(y.push({text:t.substring(w,w+1),len:m,tx:0,ty:0}),w+=1):y.push({text:t.substring(b.start,w),len:b.len,tx:0,ty:0}),b.len=0,b.start=w):(b.len=m,w+=1)}b.len>0&&y.push({text:t.substring(b.start),len:b.len,tx:0,ty:0});for(var x=y.length,O=0,k=0;k<x;k+=1){y[k].tx=O,O+=p}if(x>1){h.setWidth(d);var E,S=Math.max(h.cosWidthAngle(),a),A=h.sinWidthAngle(),_=S+(y.length-1)*p,T=o.x,C=o.y;switch(l){case Ul.left:T+=8;break;case Ul.center:T+=u/2-_/2;break;case Ul.right:T+=u-_-8}switch(c){case Xl.top:C+=8;break;case Xl.center:C+=f/2-A/2;break;case Xl.bottom:C+=f-A-8}switch(l){case Ul.right:case Ul.left:E=_+16;break;case Ul.center:default:E=_}for(var P=0;P<y.length;P+=1){var j=y[P],W=j.tx+T,L=j.ty+C,R=0,D=0;switch(l){case Ul.left:h.setWidth(j.len/2),R+=W+Math.max(h.cosWidthAngle(),a),D+=L+A-h.sinWidthAngle();break;case Ul.center:R=W+S/2,D=L+A/2;break;case Ul.right:h.setWidth(j.len/2),R+=W+S-Math.max(h.cosWidthAngle(),a),D+=L+h.sinWidthAngle()}var I=R-j.len/2,V=D-a/2;-1===P&&(e.attr({fillStyle:"#000000"}),e.fillRect(W,L,S,A),e.attr({fillStyle:"red"}));var H=new Nl({dw:e,angle:s,rect:new Dl({x:I,y:V,width:j.len,height:a})});H.rotate(),e.fillText(j.text,I,V),(n||i)&&e.beginPath(),n&&this.drawLine("underline",I,V,j.len),i&&this.drawLine("strike",I,V,j.len),H.revert()}return E}var M=this.textWidth(t)/Pl();h.setWidth(M);var N,z=Math.max(h.cosWidthAngle(),a),B=h.sinWidthAngle(),Y=o.x,F=o.y;switch(l){case Ul.left:Y+=8;break;case Ul.center:Y+=u/2-z/2;break;case Ul.right:Y+=u-z-8}switch(c){case Xl.top:F+=8;break;case Xl.center:F+=f/2-B/2;break;case Xl.bottom:F+=f-B-8}switch(l){case Ul.right:case Ul.left:N=z+16;break;case Ul.center:default:N=z}var U=new Nl({dw:e,angle:s,rect:new Dl({x:Y,y:F,width:z,height:B})});U.rotate();var X=Y+(z/2-M/2),G=F+(B/2-a/2);return e.fillText(t,X,G),(n||i)&&e.beginPath(),n&&this.drawLine("underline",X,G,M),i&&this.drawLine("strike",X,G,M),U.revert(),N}if(s<0){var K=new zl({angle:s});K.setHeight(f-16);var q=K.sinHeightAngle();K.setHeight(a+4);for(var $=K.sinHeightAngle(),Z=[],J={len:0,start:0},Q=t.length,tt=0;tt<Q;){var et=this.textWidth(t.charAt(tt))/Pl(),rt=J.len+et;rt>q?(0===J.len?(Z.push({text:t.substring(tt,tt+1),len:rt,tx:0,ty:0}),tt+=1):Z.push({text:t.substring(J.start,tt),len:J.len,tx:0,ty:0}),J.len=0,J.start=tt):(J.len=rt,tt+=1)}J.len>0&&Z.push({text:t.substring(J.start),len:J.len,tx:0,ty:0});for(var ot=Z.length,nt=0,it=ot-1;it>=0;it-=1){Z[it].tx=nt,nt+=$}if(ot>1){K.setWidth(q);var lt,ct=Math.max(K.cosWidthAngle(),a),at=K.sinWidthAngle(),st=ct+(Z.length-1)*$,ut=o.x,ft=o.y;switch(l){case Ul.left:ut+=8;break;case Ul.center:ut+=u/2-st/2;break;case Ul.right:ut+=u-st-8}switch(c){case Xl.top:ft+=8;break;case Xl.center:ft+=f/2-at/2;break;case Xl.bottom:ft+=f-at-8}switch(l){case Ul.right:case Ul.left:lt=st+16;break;case Ul.center:default:lt=st}for(var ht=0;ht<Z.length;ht+=1){var dt=Z[ht],pt=dt.tx+ut,yt=dt.ty+ft,bt=0,gt=0;switch(l){case Ul.left:K.setWidth(dt.len/2),bt+=pt+Math.max(K.cosWidthAngle(),a),gt+=yt+K.sinWidthAngle();break;case Ul.center:bt=pt+ct/2,gt=yt+at/2;break;case Ul.right:K.setWidth(dt.len/2),bt+=pt+ct-Math.max(K.cosWidthAngle(),a),gt+=yt+at-K.sinWidthAngle()}var wt=bt-dt.len/2,vt=gt-a/2;-1===ht&&(e.attr({fillStyle:"#000000"}),e.fillRect(pt,yt,ct,at),e.attr({fillStyle:"red"}));var mt=new Nl({dw:e,angle:s,rect:new Dl({x:wt,y:vt,width:dt.len,height:a})});mt.rotate(),e.fillText(dt.text,wt,vt),(n||i)&&e.beginPath(),n&&this.drawLine("underline",wt,vt,dt.len),i&&this.drawLine("strike",wt,vt,dt.len),mt.revert()}return lt}var xt=this.textWidth(t)/Pl();K.setWidth(xt);var Ot,kt=Math.max(K.cosWidthAngle(),a),Et=K.sinWidthAngle(),St=o.x,At=o.y;switch(l){case Ul.left:St+=8;break;case Ul.center:St+=u/2-kt/2;break;case Ul.right:St+=u-kt-8}switch(c){case Xl.top:At+=8;break;case Xl.center:At+=f/2-Et/2;break;case Xl.bottom:At+=f-Et-8}switch(l){case Ul.right:case Ul.left:Ot=kt+16;break;case Ul.center:default:Ot=kt}var _t=new Nl({dw:e,angle:s,rect:new Dl({x:St,y:At,width:kt,height:Et})});_t.rotate();var Tt=St+(kt/2-xt/2),Ct=At+(Et/2-a/2);return e.fillText(t,Tt,Ct),(n||i)&&e.beginPath(),n&&this.drawLine("underline",Tt,Ct,xt),i&&this.drawLine("strike",Tt,Ct,xt),_t.revert(),Ot}if(0===s){for(var Pt=u-16,jt=[],Wt={len:0,start:0},Lt=t.length,Rt=0,Dt=0;Rt<Lt;){var It=this.textWidth(t.charAt(Rt))/Pl(),Vt=Wt.len+It;Vt>Pt?(0===Wt.len?(jt.push({text:t.substring(Rt,Rt+1),len:Vt,tx:0,ty:0}),Rt+=1,Vt>Dt&&(Dt=Vt)):(jt.push({text:t.substring(Wt.start,Rt),len:Wt.len,tx:0,ty:0}),Wt.len>Dt&&(Dt=Wt.len)),Wt.len=0,Wt.start=Rt):(Wt.len=Vt,Rt+=1)}Wt.len>0&&(jt.push({text:t.substring(Wt.start),len:Wt.len,tx:0,ty:0}),Wt.len>Dt&&(Dt=Wt.len));for(var Ht=jt.length,Mt=0,Nt=0;Nt<Ht;Nt+=1){jt[Nt].ty=Mt,Mt+=a+4}var zt,Bt=Ht*(a+4);switch(l){case Ul.right:case Ul.left:zt=Dt+16;break;case Ul.center:default:zt=Dt}var Yt=new _l({draw:e,rect:o});Yt.open();for(var Ft=0;Ft<Ht;Ft+=1){var Ut=jt[Ft],Xt=o.x,Gt=o.y;switch(l){case Ul.left:Xt+=8;break;case Ul.center:Xt+=u/2-Ut.len/2;break;case Ul.right:Xt+=u-Ut.len-8}switch(c){case Xl.top:Gt+=Ut.ty+8;break;case Xl.center:Gt+=Ut.ty+(f/2-Bt/2);break;case Xl.bottom:Gt+=Ut.ty+(f-Bt-8)}e.fillText(Ut.text,Xt,Gt),(n||i)&&e.beginPath(),n&&this.drawLine("underline",Xt,Gt,Ut.len),i&&this.drawLine("strike",Xt,Gt,Ut.len)}return Yt.close(),zt}return 0}},{key:"draw",value:function(){var t=this.dw,e=this.attr,r=e.textWrap;switch(t.attr({textAlign:Ul.left,textBaseline:Xl.top,font:"".concat(e.italic?"italic":""," ").concat(e.bold?"bold":""," ").concat(jl(e.size),"px ").concat(e.name),fillStyle:e.color,strokeStyle:e.color}),r){case Gl.TRUNCATE:return this.drawTextTruncate();case Gl.WORD_WRAP:return this.drawTextWarp();case Gl.OVER_FLOW:default:return this.drawTextOverFlow()}}},{key:"setOverflowCrop",value:function(t){this.overflowCrop=t}}]),t}(),Jl=function(){function t(e){var r=e.text,o=e.rect,n=e.dw,i=e.overflow,l=e.attr;Bl(this,t),this.attr=k.mergeDeep({},{name:"Arial",size:jl(13),color:"#000000",bold:!1,italic:!1,textWrap:!1,underline:!1,strikethrough:!1,align:Ul.left,verticalAlign:Xl.center,direction:Kl.HORIZONTAL,angle:0},l),this.verticalFontDraw=new $l({text:r,rect:o,dw:n,overflow:i,attr:this.attr}),this.horizontalFontDraw=new ql({text:r,rect:o,dw:n,overflow:i,attr:this.attr}),this.angleFontDraw=new Zl({text:r,rect:o,dw:n,overflow:i,attr:this.attr})}return Fl(t,[{key:"draw",value:function(){switch(this.attr.direction){case Kl.VERTICAL:return this.verticalFontDraw.draw();case Kl.ANGLE:return this.angleFontDraw.draw();case Kl.HORIZONTAL:default:return this.horizontalFontDraw.draw()}}},{key:"setTextWrap",value:function(t){switch(this.attr.direction){case Kl.VERTICAL:this.verticalFontDraw.setTextWrap(t);break;case Kl.HORIZONTAL:default:this.horizontalFontDraw.setTextWrap(t)}}},{key:"setOverflowCrop",value:function(t){this.verticalFontDraw.setOverflowCrop(t),this.horizontalFontDraw.setOverflowCrop(t),this.angleFontDraw.setOverflowCrop(t)}}]),t}();function Ql(t){return(Ql="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tc(t,e){return!e||"object"!==Ql(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ec(t){return(ec=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rc(t,e){return(rc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var oc=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=tc(this,ec(e).call(this,"".concat(n,"-horizontal-type-context-menu"),k.mergeDeep({onUpdate:function(){}},r)))).horizontalIcon1=new ul,t.horizontalIcon2=new yl,t.horizontalIcon3=new ml;var i=_("div","".concat(n,"-horizontal-type-context-menu-type-icon-line"));return i.children(t.horizontalIcon1),i.children(t.horizontalIcon2),i.children(t.horizontalIcon3),t.horizontalIcons=new Sl,t.horizontalIcons.removeClass("hover"),t.horizontalIcons.children(i),t.addItem(t.horizontalIcons),Rt.bind(t.horizontalIcon1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(Ul.left),e.stopPropagation(),e.preventDefault()})),Rt.bind(t.horizontalIcon2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(Ul.center),e.stopPropagation(),e.preventDefault()})),Rt.bind(t.horizontalIcon3,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(Ul.right),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rc(t,e)}(e,t),e}(ge);function nc(t){return(nc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ic(t){return(ic=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cc(t,e){return(cc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ac=function(t){function e(){var t,r,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(t=!(o=ic(e).call(this,"".concat(n,"-tools-horizontal-align")))||"object"!==nc(o)&&"function"!=typeof o?lc(r):o).options=k.mergeDeep({contextMenu:{}},i),t.icon=new tt("align-left"),t.setIcon(t.icon),t.horizontalContextMenu=new oc(k.copyProp({el:lc(t),position:se.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cc(t,e)}(e,t),e}(Wt);function sc(t){return(sc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uc(t,e){return!e||"object"!==sc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fc(t){return(fc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hc(t,e){return(hc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),uc(this,fc(e).call(this,"".concat(n,"-vertical-type-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hc(t,e)}(e,t),e}(Oe);function pc(t){return(pc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yc(t,e){return!e||"object"!==pc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bc(t){return(bc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gc(t,e){return(gc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=yc(this,bc(e).call(this,"".concat(n,"-tools-verticalIcon1")))).icon=new tt("align-top"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gc(t,e)}(e,t),e}(it);function vc(t){return(vc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mc(t,e){return!e||"object"!==vc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xc(t){return(xc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oc(t,e){return(Oc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=mc(this,xc(e).call(this,"".concat(n,"-tools-verticalIcon2")))).icon=new tt("align-middle"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oc(t,e)}(e,t),e}(it);function Ec(t){return(Ec="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sc(t,e){return!e||"object"!==Ec(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ac(t){return(Ac=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _c(t,e){return(_c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Sc(this,Ac(e).call(this,"".concat(n,"-tools-verticalIcon3")))).icon=new tt("align-bottom"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_c(t,e)}(e,t),e}(it);function Cc(t){return(Cc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pc(t,e){return!e||"object"!==Cc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jc(t){return(jc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wc(t,e){return(Wc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Lc=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Pc(this,jc(e).call(this,"".concat(n,"-vertical-type-context-menu"),k.mergeDeep({onUpdate:function(){}},r)))).verticalIcon1=new wc,t.verticalIcon2=new kc,t.verticalIcon3=new Tc;var i=_("div","".concat(n,"-vertical-type-context-menu-type-icon-line"));return i.children(t.verticalIcon1),i.children(t.verticalIcon2),i.children(t.verticalIcon3),t.verticalIcons=new dc,t.verticalIcons.removeClass("hover"),t.verticalIcons.children(i),t.addItem(t.verticalIcons),Rt.bind(t.verticalIcon1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(Xl.top),e.stopPropagation(),e.preventDefault()})),Rt.bind(t.verticalIcon2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(Xl.center),e.stopPropagation(),e.preventDefault()})),Rt.bind(t.verticalIcon3,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(Xl.bottom),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wc(t,e)}(e,t),e}(ge);function Rc(t){return(Rc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dc(t){return(Dc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ic(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Vc(t,e){return(Vc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hc=function(t){function e(){var t,r,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(t=!(o=Dc(e).call(this,"".concat(n,"-tools-vertical-align")))||"object"!==Rc(o)&&"function"!=typeof o?Ic(r):o).options=k.mergeDeep({contextMenu:{}},i),t.icon=new tt("align-middle"),t.setIcon(t.icon),t.verticalContextMenu=new Lc(k.copyProp({el:Ic(t),position:se.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vc(t,e)}(e,t),e}(Wt);function Mc(t){return(Mc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nc(t,e){return!e||"object"!==Mc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zc(t){return(zc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bc(t,e){return(Bc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Nc(this,zc(e).call(this,"".concat(n,"-tools-text-wrapping1")))).icon=new tt("truncate"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bc(t,e)}(e,t),e}(it);function Fc(t){return(Fc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uc(t,e){return!e||"object"!==Fc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xc(t){return(Xc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gc(t,e){return(Gc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Kc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Uc(this,Xc(e).call(this,"".concat(n,"-tools-text-wrapping2")))).icon=new tt("overflow"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gc(t,e)}(e,t),e}(it);function qc(t){return(qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $c(t,e){return!e||"object"!==qc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zc(t){return(Zc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jc(t,e){return(Jc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=$c(this,Zc(e).call(this,"".concat(n,"-tools-text-wrapping3")))).icon=new tt("wrap"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jc(t,e)}(e,t),e}(it);function ta(t){return(ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ea(t,e){return!e||"object"!==ta(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ra(t){return(ra=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oa(t,e){return(oa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var na=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ea(this,ra(e).call(this,"".concat(n,"-text-wrapping-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oa(t,e)}(e,t),e}(Oe);function ia(t){return(ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function la(t,e){return!e||"object"!==ia(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ca(t){return(ca=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function aa(t,e){return(aa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sa=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=la(this,ca(e).call(this,"".concat(n,"-text-wrapping-context-menu"),k.mergeDeep({onUpdate:function(){}},r)))).textWrappingIcon1=new Yc,t.textWrappingIcon2=new Kc,t.textWrappingIcon3=new Qc;var i=_("div","".concat(n,"-text-wrapping-context-menu-type-icon-line"));return i.children(t.textWrappingIcon1),i.children(t.textWrappingIcon2),i.children(t.textWrappingIcon3),t.textWrappingIcons=new na,t.textWrappingIcons.removeClass("hover"),t.textWrappingIcons.children(i),t.addItem(t.textWrappingIcons),Rt.bind(t.textWrappingIcon1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(Gl.TRUNCATE),e.stopPropagation(),e.preventDefault()})),Rt.bind(t.textWrappingIcon2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(Gl.OVER_FLOW),e.stopPropagation(),e.preventDefault()})),Rt.bind(t.textWrappingIcon3,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(Gl.WORD_WRAP),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&aa(t,e)}(e,t),e}(ge);function ua(t){return(ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fa(t){return(fa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ha(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function da(t,e){return(da=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pa=function(t){function e(){var t,r,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(t=!(o=fa(e).call(this,"".concat(n,"-tools-text-wrapping")))||"object"!==ua(o)&&"function"!=typeof o?ha(r):o).options=k.mergeDeep({contextMenu:{}},i),t.icon=new tt("text-wrap"),t.setIcon(t.icon),t.textWrappingContextMenu=new sa(k.copyProp({el:ha(t),position:se.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&da(t,e)}(e,t),e}(Wt);function ya(t){return(ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ba(t,e){return!e||"object"!==ya(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ga(t){return(ga=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wa(t,e){return(wa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var va=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ba(this,ga(e).call(this,"".concat(n,"-tools-fixed")))).icon=new tt("freeze"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wa(t,e)}(e,t),e}(it);function ma(t){return(ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xa(t,e){return!e||"object"!==ma(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Oa(t){return(Oa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ka(t,e){return(ka=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ea=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=xa(this,Oa(e).call(this,"".concat(n,"-tools-filter")))).icon=new tt("filter"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ka(t,e)}(e,t),e}(it);function Sa(t){return(Sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Aa(t,e){return!e||"object"!==Sa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _a(t){return(_a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ta(t,e){return(Ta=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ca=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Aa(this,_a(e).call(this,"".concat(n,"-tools-format")))).icon=new tt("functions"),t.setIcon(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ta(t,e)}(e,t),e}(Wt);function Pa(t){return(Pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ja(t,e){return!e||"object"!==Pa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wa(t){return(Wa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function La(t,e){return(La=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ra='\n  <svg class="'.concat(n,'-copy-style-svg" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">\n    <line class="').concat(n,'-copy-style-stroked-top" x1="0" y1="0" x2="100%" y2="0"/>\n    <line class="').concat(n,'-copy-style-stroked-left" x1="0" y1="0" x2="0" y2="100%"/>\n    <line class="').concat(n,'-copy-style-stroked-bottom" x1="0" y1="100%" x2="100%" y2="100%"/>\n    <line class="').concat(n,'-copy-style-stroked-right" x1="100%" y1="0" x2="100%" y2="100%"/>\n  </svg>\n'),Da=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=ja(this,Wa(e).call(this,"".concat(n,"-copy-style")))).options=k.mergeDeep({},t),r.mask=_("div","".concat(n,"-copy-style-mask")),r.html(Ra),r.children(r.mask),r.top=r.find(".".concat(n,"-copy-style-stroked-top")),r.left=r.find(".".concat(n,"-copy-style-stroked-left")),r.bottom=r.find(".".concat(n,"-copy-style-stroked-bottom")),r.right=r.find(".".concat(n,"-copy-style-stroked-right")),r.hide(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&La(t,e)}(e,t),e}(L);function Ia(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Va=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.screen=e,this.lt=null,this.t=null,this.l=null,this.br=null}var e,r,o;return e=t,(r=[{key:"getLT",value:function(){return this.lt}},{key:"getT",value:function(){return this.t}},{key:"getL",value:function(){return this.l}},{key:"getBR",value:function(){return this.br}},{key:"onAppendScreen",value:function(){}}])&&Ia(e.prototype,r),o&&Ia(e,o),t}();function Ha(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var r=[],o=!0,n=!1,i=void 0;try{for(var l,c=t[Symbol.iterator]();!(o=(l=c.next()).done)&&(r.push(l.value),!e||r.length!==e);o=!0);}catch(t){n=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(n)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ma(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Na=function(){function t(e,r,o,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sri=e,this.sci=r,this.eri=o,this.eci=n,this.w=i,this.h=l}var e,r,o;return e=t,o=[{key:"valueOf",value:function(e){var r=e.split(":"),o=Ha(k.expr2xy(r[0]),2),n=o[0],i=o[1],l=i,c=n;if(r.length>1){var a=Ha(k.expr2xy(r[1]),2);c=a[0],l=a[1]}return new t(i,n,l,c)}}],(r=[{key:"set",value:function(t,e,r,o){this.sri=t,this.sci=e,this.eri=r,this.eci=o}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,r=arguments.length,o=new Array(r),n=0;n<r;n++)o[n]=arguments[n];if(1===o.length){var i=k.expr2xy(o[0]),l=Ha(i,2);e=l[0],t=l[1]}else 2===o.length&&(t=o[0],e=o[1]);var c=this.sri,a=this.sci,s=this.eri,u=this.eci;return c<=t&&t<=s&&a<=e&&e<=u}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},r=this.sri,o=this.sci,n=this.eri,i=this.eci,l=r;l<=n;l+=1)if(e(l))for(var c=o;c<=i;c+=1)t(l,c)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var r=this.sri,o=this.sci,n=this.eri,i=this.eci;return new t(e.sri<r?e.sri:r,e.sci<o?e.sci:o,e.eri>n?e.eri:n,e.eci>i?e.eci:i)}},{key:"coincide",value:function(e){var r=this.sri,o=this.sci,n=this.eri,i=this.eci;return this.disjoint(e)?t.EMPTY:new t(e.sri>r?e.sri:r,e.sci>o?e.sci:o,e.eri<n?e.eri:n,e.eci<i?e.eci:i)}},{key:"coincideDifference",value:function(e){return this.coincide(e).equals(t.EMPTY)?[]:this.difference(e)}},{key:"difference",value:function(e){var r=[],o=function(e,o,n,i){r.push(new t(e,o,n,i))},n=this.sri,i=this.sci,l=this.eri,c=this.eci,a=e.sri-n,s=e.sci-i,u=l-e.eri,f=c-e.eci;return a>0?(o(n,i,e.sri-1,c),u>0?(o(e.eri+1,i,l,c),s>0&&o(e.sri,i,e.eri,e.sci-1),f>0&&o(e.sri,e.eci+1,e.eri,c)):(s>0&&o(e.sri,i,l,e.sci-1),f>0&&o(e.sri,e.eci+1,l,c))):u>0&&(o(e.eri+1,i,l,c),s>0&&o(n,i,e.eri,e.sci-1),f>0&&o(n,e.eci+1,e.eri,c)),s>0?(o(n,i,l,e.sci-1),f>0?(o(n,e.eri+1,l,c),a>0&&o(n,e.sci,e.sri-1,e.eci),u>0&&o(e.sri+1,e.sci,l,e.eci)):(a>0&&o(n,e.sci,e.sri-1,c),u>0&&o(e.sri+1,e.sci,l,c))):f>0&&(o(n,e.eci+1,l,c),a>0&&o(n,i,e.sri-1,e.eci),u>0&&o(e.eri+1,i,l,e.eci)),r}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"brink",value:function(){var e=this.sri,r=this.eri,o=this.sci,n=this.eci,i=new t(e,o,e,n),l=new t(r,o,r,n);return{top:i,right:new t(e,n,r,n),bottom:l,left:new t(e,o,r,o)}}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"toString",value:function(){var t=this.sri,e=this.sci,r=this.eri,o=this.eci,n=k.xy2expr(e,t);return this.multiple()&&(n="".concat(n,":").concat(k.xy2expr(o,r))),n}}])&&Ma(e.prototype,r),o&&Ma(e,o),t}();function za(t){return(za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ba(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ya(t,e){return!e||"object"!==za(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fa(t){return(Fa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ua(t,e){return(Ua=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Na.EMPTY=new Na(-1,-1,-1,-1);var Xa=function(t){function e(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Ya(this,Fa(e).call(this,t))).options=k.mergeDeep({},o),r.lt=new Da,r.t=new Da,r.l=new Da,r.br=new Da,r.selectorAttr=null,r.bind(),r}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ua(t,e)}(e,t),r=e,(n=[{key:"setLTOffset",value:function(t){var e=this.screen.table,r=e.frozenLeftTop,o=e.cols,n=e.rows,i=e.grid,l=r.getScrollViewRange(),c=t.rect,a=new Na(-1,-1,-1,-1),s=c.coincide(l);if(a.equals(s))this.lt.hide();else{var u=o.sectionSumWidth(s.sci,s.eci),f=n.sectionSumHeight(s.sri,s.eri),h=n.sectionSumHeight(l.sri,s.sri-1),d=o.sectionSumWidth(l.sci,s.sci-1);c.eci>l.eci?(this.lt.right.hide(),this.lt.mask.css("border-right","none")):(this.lt.right.show(),this.lt.mask.cssRemoveKeys("border-right")),c.eri>l.eri?(this.lt.bottom.hide(),this.lt.mask.css("border-bottom","none")):(this.lt.bottom.show(),this.lt.mask.cssRemoveKeys("border-bottom"));var p=new Dl({x:d,y:h,width:u,height:f});p.expandSize(i.lineWidth()),this.lt.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setTOffset",value:function(t){var e=this.screen.table,r=e.fixedTop,o=e.cols,n=e.rows,i=e.grid,l=r.getScrollViewRange(),c=t.rect,a=new Na(-1,-1,-1,-1),s=c.coincide(l);if(a.equals(s))this.t.hide();else{var u=o.sectionSumWidth(s.sci,s.eci),f=n.sectionSumHeight(s.sri,s.eri),h=n.sectionSumHeight(l.sri,s.sri-1),d=o.sectionSumWidth(l.sci,s.sci-1);c.sci<l.sci?(this.t.left.hide(),this.t.mask.css("border-left","none")):(this.t.left.show(),this.t.mask.cssRemoveKeys("border-left")),c.eri>l.eri?(this.t.bottom.hide(),this.t.mask.css("border-bottom","none")):(this.t.bottom.show(),this.t.mask.cssRemoveKeys("border-bottom")),c.eci>l.eci?(this.t.right.hide(),this.t.mask.css("border-right","none")):(this.t.right.show(),this.t.mask.cssRemoveKeys("border-right"));var p=new Dl({x:d,y:h,width:u,height:f});p.expandSize(i.lineWidth()),this.t.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setLOffset",value:function(t){var e=this.screen.table,r=e.fixedLeft,o=e.cols,n=e.rows,i=e.grid,l=r.getScrollViewRange(),c=t.rect,a=new Na(-1,-1,-1,-1),s=c.coincide(l);if(a.equals(s))this.l.hide();else{var u=o.sectionSumWidth(s.sci,s.eci),f=n.sectionSumHeight(s.sri,s.eri),h=n.sectionSumHeight(l.sri,s.sri-1),d=o.sectionSumWidth(l.sci,s.sci-1);c.sri<l.sri?(this.l.top.hide(),this.l.mask.css("border-top","none")):(this.l.top.show(),this.l.mask.cssRemoveKeys("border-top")),c.eci>l.eci?(this.l.right.hide(),this.l.mask.css("border-right","none")):(this.l.right.show(),this.l.mask.cssRemoveKeys("border-right")),c.eri>l.eri?(this.l.bottom.hide(),this.l.mask.css("border-bottom","none")):(this.l.bottom.show(),this.l.mask.cssRemoveKeys("border-bottom"));var p=new Dl({x:d,y:h,width:u,height:f});p.expandSize(i.lineWidth()),this.l.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setBROffset",value:function(t){var e=this.screen.table,r=e.cols,o=e.rows,n=e.grid,i=e.getScrollViewRange(),l=t.rect,c=new Na(-1,-1,-1,-1),a=l.coincide(i);if(c.equals(a))this.br.hide();else{var s=r.sectionSumWidth(a.sci,a.eci),u=o.sectionSumHeight(a.sri,a.eri),f=o.sectionSumHeight(i.sri,a.sri-1),h=r.sectionSumWidth(i.sci,a.sci-1);l.sci<i.sci?(this.br.left.hide(),this.br.mask.css("border-left","none")):(this.br.left.show(),this.br.mask.cssRemoveKeys("border-left")),l.sri<i.sri?(this.br.top.hide(),this.br.mask.css("border-top","none")):(this.br.top.show(),this.br.mask.cssRemoveKeys("border-top")),l.eri>i.eri?(this.br.bottom.hide(),this.br.mask.css("border-bottom","none")):(this.br.bottom.show(),this.br.mask.cssRemoveKeys("border-bottom")),l.eci>i.eci?(this.br.right.hide(),this.br.mask.css("border-right","none")):(this.br.right.show(),this.br.mask.cssRemoveKeys("border-right"));var d=new Dl({x:h,y:f,width:s,height:u});d.expandSize(n.lineWidth()),this.br.offset({width:d.width,height:d.height,left:d.x,top:d.y}).show()}}},{key:"setOffset",value:function(t){this.setLTOffset(t),this.setTOffset(t),this.setLOffset(t),this.setBROffset(t)}},{key:"bind",value:function(){var t=this,e=this.screen.table;Rt.bind(e,o.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.selectorAttr&&t.setOffset(t.selectorAttr)})),Rt.bind(e,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(e){t.selectorAttr&&t.setOffset(t.selectorAttr)})),Rt.bind(e,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(e){t.selectorAttr&&t.setOffset(t.selectorAttr)}))}},{key:"setShow",value:function(t){this.selectorAttr=t,this.setOffset(t)}},{key:"setHide",value:function(){this.selectorAttr=null,this.lt.hide(),this.t.hide(),this.l.hide(),this.br.hide()}}])&&Ba(r.prototype,n),i&&Ba(r,i),e}(Va);function Ga(t){return(Ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ka(t,e){return!e||"object"!==Ga(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qa(t){return(qa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $a(t,e){return($a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Za=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ka(this,qa(e).call(this,"".concat(n,"-selector")))).cornerEl=_("div","".concat(n,"-selector-corner")),t.areaEl=_("div","".concat(n,"-selector-area")),t.areaEl.children(t.cornerEl),t.children(t.areaEl),t.hide(),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$a(t,e)}(e,t),e}(L);function Ja(t){return(Ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qa(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ts(t,e){return!e||"object"!==Ja(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function es(t){return(es=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rs(t,e){return(rs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var os={DOWN_SELECT:Symbol("选择单元格时触发"),CHANGE:Symbol("选择区域大小发生变化时触发"),SELECT_CHANGE:Symbol("选择区域发生变化时触发"),SELECT_CHANGE_OVER:Symbol("选择区域结束时触发")},ns=function(t){function e(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=ts(this,es(e).call(this,t))).options=o,r.selectorAttr=null,r.downSelectorAttr=null,r.onChangeStack=[],r.onSelectChangeStack=[],r.onSelectChangeOver=[],r.onDownSelectStack=[],r.lt=new Za,r.t=new Za,r.l=new Za,r.br=new Za,r.bind(),r}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rs(t,e)}(e,t),r=e,(n=[{key:"bind",value:function(){var t=this,e=this.screen.table,r=e.mousePointer,n=e.focus;Rt.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(i){if(0===i.button&&n.activate.el===e){var l,c=e.computeEventXy(i),a=c.x,s=c.y,u=t.getDownXYSelectorAttr(a,s);switch(t.setSelectAttr(u),t.setDownSelectAttr(u),t.setOffset(u),t.onDownSelectStack.forEach((function(t){return t()})),t.onChangeStack.forEach((function(t){return t()})),t.onSelectChangeStack.forEach((function(t){return t()})),u.edgeType){case"left":l=o.MOUSE_POINTER_TYPE.SELECT_ONE_ROW;break;case"top":l=o.MOUSE_POINTER_TYPE.SELECT_ONE_COLUMN;break;default:l=o.MOUSE_POINTER_TYPE.SELECT_CELL}r.on(l),Rt.mouseMoveUp(document,(function(r){var o=e.computeEventXy(r),n=o.x,i=o.y,l=t.getMoveXySelectorAttr(u,n,i);t.setSelectAttr(l),t.setOffset(l),t.onChangeStack.forEach((function(t){return t()})),t.onSelectChangeStack.forEach((function(t){return t()}))}),(function(){r.off(l),t.onSelectChangeOver.forEach((function(t){return t()}))}))}})),Rt.bind(e,o.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.selectorAttr&&t.setOffset(t.selectorAttr)})),Rt.bind(e,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.selectorAttr&&(t.setOffset(t.selectorAttr),t.onChangeStack.forEach((function(t){return t()})))})),Rt.bind(e,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.selectorAttr&&(t.setOffset(t.selectorAttr),t.onChangeStack.forEach((function(t){return t()})))}))}},{key:"setLTOffset",value:function(t){var e=this.screen.table,r=e.frozenLeftTop,o=e.cols,n=e.rows,i=e.grid,l=r.getScrollViewRange(),c=t.rect,a=new Na(-1,-1,-1,-1),s=c.coincide(l);if(a.equals(s))this.lt.hide();else{var u=o.sectionSumWidth(s.sci,s.eci),f=n.sectionSumHeight(s.sri,s.eri),h=n.sectionSumHeight(l.sri,s.sri-1),d=o.sectionSumWidth(l.sci,s.sci-1);c.eci>l.eci?this.lt.areaEl.css("border-right","none"):this.lt.areaEl.cssRemoveKeys("border-right"),c.eri>l.eri?this.lt.areaEl.css("border-bottom","none"):this.lt.areaEl.cssRemoveKeys("border-bottom");var p=new Dl({x:d,y:h,width:u,height:f});p.expandSize(i.lineWidth()),this.lt.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setTOffset",value:function(t){var e=this.screen.table,r=e.fixedTop,o=e.cols,n=e.rows,i=e.grid,l=r.getScrollViewRange(),c=t.rect,a=new Na(-1,-1,-1,-1),s=c.coincide(l);if(a.equals(s))this.t.hide();else{var u=o.sectionSumWidth(s.sci,s.eci),f=n.sectionSumHeight(s.sri,s.eri),h=n.sectionSumHeight(l.sri,s.sri-1),d=o.sectionSumWidth(l.sci,s.sci-1);c.sci<l.sci?this.t.areaEl.css("border-left","none"):this.t.areaEl.cssRemoveKeys("border-left"),c.eri>l.eri?this.t.areaEl.css("border-bottom","none"):this.t.areaEl.cssRemoveKeys("border-bottom"),c.eci>l.eci?this.t.areaEl.css("border-right","none"):this.t.areaEl.cssRemoveKeys("border-right");var p=new Dl({x:d,y:h,width:u,height:f});p.expandSize(i.lineWidth()),this.t.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setLOffset",value:function(t){var e=this.screen.table,r=e.fixedLeft,o=e.cols,n=e.rows,i=e.grid,l=r.getScrollViewRange(),c=t.rect,a=new Na(-1,-1,-1,-1),s=c.coincide(l);if(a.equals(s))this.l.hide();else{var u=o.sectionSumWidth(s.sci,s.eci),f=n.sectionSumHeight(s.sri,s.eri),h=n.sectionSumHeight(l.sri,s.sri-1),d=o.sectionSumWidth(l.sci,s.sci-1);c.sri<l.sri?this.l.areaEl.css("border-top","none"):this.l.areaEl.cssRemoveKeys("border-top"),c.eci>l.eci?this.l.areaEl.css("border-right","none"):this.l.areaEl.cssRemoveKeys("border-right"),c.eri>l.eri?this.l.areaEl.css("border-bottom","none"):this.l.areaEl.cssRemoveKeys("border-bottom");var p=new Dl({x:d,y:h,width:u,height:f});p.expandSize(i.lineWidth()),this.l.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setBROffset",value:function(t){var e=this.screen.table,r=e.cols,o=e.rows,n=e.grid,i=e.getScrollViewRange(),l=t.rect,c=new Na(-1,-1,-1,-1),a=l.coincide(i);if(c.equals(a))this.br.hide();else{var s=r.sectionSumWidth(a.sci,a.eci),u=o.sectionSumHeight(a.sri,a.eri),f=o.sectionSumHeight(i.sri,a.sri-1),h=r.sectionSumWidth(i.sci,a.sci-1);l.sci<i.sci?this.br.areaEl.css("border-left","none"):this.br.areaEl.cssRemoveKeys("border-left"),l.sri<i.sri?this.br.areaEl.css("border-top","none"):this.br.areaEl.cssRemoveKeys("border-top"),l.eri>i.eri?this.br.areaEl.css("border-bottom","none"):this.br.areaEl.cssRemoveKeys("border-bottom"),l.eci>i.eci?this.br.areaEl.css("border-right","none"):this.br.areaEl.cssRemoveKeys("border-right");var d=new Dl({x:h,y:f,width:s,height:u});d.expandSize(n.lineWidth()),this.br.offset({width:d.width,height:d.height,left:d.x,top:d.y}).show()}}},{key:"setLTCorner",value:function(t,e){var r=this.screen.table.frozenLeftTop.getScrollViewRange(),o=t.rect,n=t.edge,i=t.edgeType,l=new Na(-1,-1,-1,-1),c=o.coincide(r);if(!l.equals(c))if(this.lt.cornerEl.cssRemoveKeys("left"),this.lt.cornerEl.cssRemoveKeys("top"),this.lt.cornerEl.cssRemoveKeys("right"),this.lt.cornerEl.cssRemoveKeys("bottom"),this.lt.cornerEl.hide(),n){var a="ltl"===e;"left"===i&&"ltt"===e&&(this.lt.cornerEl.show(),this.lt.cornerEl.css("left","0px"),this.lt.cornerEl.css("bottom","0px")),"top"===i&&a&&(this.lt.cornerEl.show(),this.lt.cornerEl.css("right","0px"),this.lt.cornerEl.css("top","0px"))}else"lt"===e&&(this.lt.cornerEl.show(),this.lt.cornerEl.css("right","0px"),this.lt.cornerEl.css("bottom","0px")),o.eci>r.eci&&this.lt.cornerEl.hide(),o.eri>r.eri&&this.lt.cornerEl.hide()}},{key:"setTCorner",value:function(t,e){var r=this.screen.table.fixedTop.getScrollViewRange(),o=t.rect,n=t.edge,i=t.edgeType,l=new Na(-1,-1,-1,-1),c=o.coincide(r);if(!l.equals(c))if(this.t.cornerEl.cssRemoveKeys("left"),this.t.cornerEl.cssRemoveKeys("top"),this.t.cornerEl.cssRemoveKeys("right"),this.t.cornerEl.cssRemoveKeys("bottom"),this.t.cornerEl.hide(),n){var a="lttlbr"===e;"top"===i&&"tbr"===e&&(this.t.cornerEl.show(),this.t.cornerEl.css("right","0px"),this.t.cornerEl.css("top","0px")),"top"===i&&a&&(this.t.cornerEl.show(),this.t.cornerEl.css("right","0px"),this.t.cornerEl.css("top","0px")),"top"===i&&o.eci>r.eci&&this.t.cornerEl.hide()}else("t"===e||"ltt"===e)&&(this.t.cornerEl.show(),this.t.cornerEl.css("right","0px"),this.t.cornerEl.css("bottom","0px")),o.eci>r.eci&&this.t.cornerEl.hide(),o.eri>r.eri&&this.t.cornerEl.hide()}},{key:"setLCorner",value:function(t,e){var r=this.screen.table.fixedLeft.getScrollViewRange(),o=t.rect,n=t.edge,i=t.edgeType,l=new Na(-1,-1,-1,-1),c=o.coincide(r);if(!l.equals(c))if(this.l.cornerEl.cssRemoveKeys("left"),this.l.cornerEl.cssRemoveKeys("top"),this.l.cornerEl.cssRemoveKeys("right"),this.l.cornerEl.cssRemoveKeys("bottom"),this.l.cornerEl.hide(),n){var a="lttlbr"===e;"left"===i&&"lbr"===e&&(this.l.cornerEl.show(),this.l.cornerEl.css("left","0"),this.l.cornerEl.css("bottom","0")),"left"===i&&a&&(this.l.cornerEl.show(),this.l.cornerEl.css("left","0"),this.l.cornerEl.css("bottom","0")),"left"===i&&o.eri>r.eri&&this.l.cornerEl.hide()}else("l"===e||"ltl"===e)&&(this.l.cornerEl.show(),this.l.cornerEl.css("right","0px"),this.l.cornerEl.css("bottom","0px")),o.eci>r.eci&&this.l.cornerEl.hide(),o.eri>r.eri&&this.l.cornerEl.hide()}},{key:"setBrCorner",value:function(t,e){var r=this.screen.table.getScrollViewRange(),o=t.rect,n=t.edge,i=t.edgeType,l=new Na(-1,-1,-1,-1),c=o.coincide(r);if(!l.equals(c))if(this.br.cornerEl.cssRemoveKeys("left"),this.br.cornerEl.cssRemoveKeys("top"),this.br.cornerEl.cssRemoveKeys("right"),this.br.cornerEl.cssRemoveKeys("bottom"),this.br.cornerEl.hide(),n){var a="br"===e,s="lttlbr"===e;"left"===i&&a&&(this.br.cornerEl.show(),this.br.cornerEl.css("left","0"),this.br.cornerEl.css("bottom","0")),"top"===i&&a&&(this.br.cornerEl.show(),this.br.cornerEl.css("right","0"),this.br.cornerEl.css("top","0")),"left-top"===i&&s&&(this.br.cornerEl.show(),this.br.cornerEl.css("right","0"),this.br.cornerEl.css("bottom","0")),"left-top"===i&&a&&(this.br.cornerEl.show(),this.br.cornerEl.css("right","0"),this.br.cornerEl.css("bottom","0")),"left"===i&&o.eri>r.eri&&this.br.cornerEl.hide(),"top"===i&&o.eci>r.eci&&this.br.cornerEl.hide()}else{var u="lbr"===e;("br"===e||"tbr"===e||u||u||"lttlbr"===e)&&(this.br.cornerEl.show(),this.br.cornerEl.css("right","0px"),this.br.cornerEl.css("bottom","0px")),o.eri>r.eri&&this.br.cornerEl.hide(),o.eci>r.eci&&this.br.cornerEl.hide()}}},{key:"setSelectAttr",value:function(t){this.selectorAttr=t,this.selectorAttr.id=Date.now()}},{key:"setDownSelectAttr",value:function(t){this.downSelectorAttr=t}},{key:"getIntersectsArea",value:function(t){var e=this.screen.table,r=e.fixed,o=e.cols,n=e.rows,i=t.rect,l="",c=new Na(0,0,r.fxTop,r.fxLeft),a=new Na(0,r.fxLeft+1,r.fxTop,o.len),s=new Na(r.fxTop+1,0,n.len,r.fxLeft),u=new Na(r.fxTop+1,r.fxLeft+1,n.len,o.len);return i.intersects(c)&&(l+="lt"),i.intersects(a)&&(l+="t"),i.intersects(s)&&(l+="l"),i.intersects(u)&&(l+="br"),l}},{key:"setOffset",value:function(t){var e=this.getIntersectsArea(t);this.setLTOffset(t),this.setTOffset(t),this.setLOffset(t),this.setBROffset(t),this.setLTCorner(t,e),this.setTCorner(t,e),this.setLCorner(t,e),this.setBrCorner(t,e)}},{key:"getViewRange",value:function(){var t=this.screen.table,e=t.cols,r=t.rows,o=t.getScrollViewRange(),n=o.sri,i=o.sci,l=o.eri,c=o.eci;t.getFixedWidth()>0&&(n=0),t.getFixedHeight()>0&&(i=0);var a=e.sectionSumWidth(i,c),s=r.sectionSumHeight(n,l);return new Na(n,i,l,c,a,s)}},{key:"getDownXYSelectorAttr",value:function(t,e){var r=this.screen.table,o=r.merges,n=r.rows,i=r.cols,l=r.getRiCiByXy(t,e),c=l.ri,a=l.ci;if(-1===c&&-1===a)return{rect:new Na(0,0,n.len-1,i.len-1),edge:!0,edgeType:"left-top"};if(-1===c)return{rect:new Na(0,a,n.len-1,a),edge:!0,edgeType:"top"};if(-1===a)return{rect:new Na(c,0,c,i.len-1),edge:!0,edgeType:"left"};var s=o.getFirstIncludes(c,a),u=new Na(c,a,c,a);return s&&(u=s),{rect:u}}},{key:"getMoveXySelectorAttr",value:function(t,e,r){var o=this.screen.table,n=o.merges,i=o.rows,l=o.cols,c=t.rect,a=t.edgeType,s=this.getViewRange(),u=o.getRiCiByXy(e,r),f=u.ri,h=u.ci;switch(-1===f&&(f=s.sri),-1===h&&(h=s.sci),a){case"left-top":var d=c.union(new Na(0,0,i.len-1,l.len-1));return{rect:d=c.union(d),edge:!0,edgeType:"left-top"};case"top":var p=c.union(new Na(0,h,0,h));return{rect:p=c.union(p),edge:!0,edgeType:"top"};case"left":var y=c.union(new Na(f,0,f,0));return{rect:y=c.union(y),edge:!0,edgeType:"left"}}var b=c.union(new Na(f,h,f,h));return{rect:b=n.union(b)}}},{key:"getSelectRange",value:function(){return this.selectorAttr.rect}},{key:"on",value:function(t,e){var r;switch(t){case os.CHANGE:r=this.onChangeStack;break;case os.SELECT_CHANGE_OVER:r=this.onSelectChangeOver;break;case os.DOWN_SELECT:r=this.onDownSelectStack;break;case os.SELECT_CHANGE:r=this.onSelectChangeStack}r&&r.push(e)}},{key:"remove",value:function(t,e){var r;switch(t){case os.CHANGE:r=this.onChangeStack;break;case os.SELECT_CHANGE_OVER:r=this.onSelectChangeOver;break;case os.DOWN_SELECT:r=this.onDownSelectStack;break;case os.SELECT_CHANGE:r=this.onSelectChangeStack}if(r)for(var o=0;o<r.length;o+=1)if(r[o]===e)return void r.splice(o,1)}}])&&Qa(r.prototype,n),i&&Qa(r,i),e}(Va);function is(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var ls=function(){function t(e){var r=e.align,o=void 0===r?Ul.left:r,n=e.verticalAlign,i=void 0===n?Xl.center:n,l=e.textWrap,c=void 0===l?Gl.OVER_FLOW:l,a=e.strikethrough,s=void 0!==a&&a,u=e.underline,f=void 0!==u&&u,h=e.color,d=void 0===h?"rgb(0,0,0)":h,p=e.name,y=void 0===p?"Arial":p,b=e.size,g=void 0===b?14:b,w=e.bold,v=void 0!==w&&w,m=e.italic,x=void 0!==m&&m,O=e.angle,k=void 0===O?0:O,E=e.direction,S=void 0===E?Kl.HORIZONTAL:E;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.align=o,this.verticalAlign=i,this.textWrap=c,this.strikethrough=s,this.underline=f,this.color=d,this.name=y,this.size=g,this.bold=v,this.italic=x,this.direction=S,this.angle=k}var e,r,o;return e=t,(r=[{key:"clone",value:function(){return new t({align:this.align,verticalAlign:this.verticalAlign,textWrap:this.textWrap,strikethrough:this.strikethrough,underline:this.underline,color:this.color,name:this.name,size:this.size,bold:this.bold,italic:this.italic,angle:this.angle,direction:this.direction})}}])&&is(e.prototype,r),o&&is(e,o),t}();function cs(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var as=function(){function t(e){var r=e.time,o=void 0===r?k.now():r,n=e.display,i=void 0!==n&&n,l=e.width,c=void 0===l?1:l,a=e.color,s=void 0===a?"#000000":a,u=e.type,f=void 0===u?Ni.SOLID_LINE:u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$time=o,this.$display=i,this.$width=c,this.$color=s,this.$type=f}var e,r,o;return e=t,(r=[{key:"equal",value:function(t){var e=this.color===t.color,r=this.width===t.width,o=this.type===t.type;return e&&r&&o}},{key:"compareTime",value:function(t){if(k.isUnDef(t))return-2;var e=this.time,r=t.time;return e>r?1:r>e?-1:0}},{key:"time",get:function(){return this.$time}},{key:"display",get:function(){return this.$display},set:function(t){this.$time=k.now(),this.$display=t}},{key:"width",get:function(){return this.$width},set:function(t){this.$time=k.now(),this.$width=t}},{key:"color",get:function(){return this.$color},set:function(t){this.$time=k.now(),this.$color=t}},{key:"type",get:function(){return this.$type},set:function(t){this.$time=k.now(),this.$type=t}}])&&cs(e.prototype,r),o&&cs(e,o),t}();function ss(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var us=function(){function t(e){var r=e.left,o=void 0===r?{}:r,n=e.top,i=void 0===n?{}:n,l=e.right,c=void 0===l?{}:l,a=e.bottom,s=void 0===a?{}:a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.left=new as(o),this.top=new as(i),this.right=new as(c),this.bottom=new as(s)}var e,r,o;return e=t,(r=[{key:"clone",value:function(){return new t({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}}])&&ss(e.prototype,r),o&&ss(e,o),t}();function fs(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var hs=function(){function t(e){var r=e.text,o=void 0===r?k.EMPTY:r,n=e.background,i=void 0===n?k.Nul:n,l=e.format,c=void 0===l?"default":l,a=e.fontAttr,s=void 0===a?{}:a,u=e.borderAttr,f=void 0===u?{}:u,h=e.contentWidth,d=void 0===h?0:h;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.background=i,this.format=c,this.text=o,this.fontAttr=new ls(s),this.borderAttr=new us(f),this.contentWidth=d}var e,r,o;return e=t,(r=[{key:"setContentWidth",value:function(t){this.contentWidth=t}},{key:"clone",value:function(){var e=this.background,r=this.format,o=this.text,n=this.fontAttr,i=this.borderAttr;return new t({background:e,format:r,text:o,fontAttr:n.clone(),borderAttr:i.clone()})}}])&&fs(e.prototype,r),o&&fs(e,o),t}();function ds(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ps(t){return(ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ys(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bs(t,e){return!e||"object"!==ps(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gs(t){return(gs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ws(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vs(t,e)}function vs(t,e){return(vs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ms=function(t){function e(){return ys(this,e),bs(this,gs(e).call(this,"".concat(n,"-tools-divider")))}return ws(e,t),e}(L),xs=function(t){function e(t){var r;ys(this,e),(r=bs(this,gs(e).call(this,"".concat(n,"-tools-menu")))).workTop=t;var o=r.workTop.work.body.sheetView;return r.undo=new ut,r.redo=new yt,r.paintFormat=new xt,r.clearFormat=new At,r.format=new Ue({contextMenu:{onUpdate:function(t,e){var n=o.getActiveSheet().table,i=n.screen,l=n.cellsHelper,c=n.tableDataSnapshot,a=i.findByClass(ns).selectorAttr;if(r.format.setTitle(e),a){c.begin();var s=c.cellDataProxy;l.getCellOrNewCellByViewRange({rectRange:a.rect,callback:function(e,r,o){var n=o.clone();n.format=t,s.setCell(e,r,n)}}),c.end(),n.render()}}}}),r.font=new sr({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,n=e.screen,i=e.cellsHelper,l=e.tableDataSnapshot,c=n.findByClass(ns).selectorAttr;if(r.font.setTitle(t),c){l.begin();var a=l.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:c.rect,callback:function(e,r,o){var n=o.clone();n.fontAttr.name=t,a.setCell(e,r,n)}}),l.end(),e.render()}}}}),r.fontSize=new Sr({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,n=e.screen,i=e.cellsHelper,l=e.tableDataSnapshot,c=n.findByClass(ns).selectorAttr;if(r.fontSize.setTitle(t),c){l.begin();var a=l.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:c.rect,callback:function(e,r,o){var n=o.clone();n.fontAttr.size=t,a.setCell(e,r,n)}}),l.end(),e.render()}}}}),r.fontColor=new Io({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,n=e.screen,i=e.cellsHelper,l=e.tableDataSnapshot,c=n.findByClass(ns).selectorAttr;if(r.fontColor.setColor(t),c){l.begin();var a=l.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:c.rect,callback:function(e,r,o){var n=o.clone();n.fontAttr.color=t,a.setCell(e,r,n)}}),l.end(),e.render()}}}}),r.fillColor=new Qo({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,n=e.screen,i=e.cellsHelper,l=e.tableDataSnapshot,c=n.findByClass(ns).selectorAttr;if(r.fillColor.setColor(t),c){l.begin();var a=l.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:c.rect,callback:function(e,r,o){var n=o.clone();n.background=t,a.setCell(e,r,n)}}),l.end(),e.render()}}}}),r.border=new tl({contextMenu:{onUpdate:function(t,e,r){var n=o.getActiveSheet().table,i=n.screen,l=n.cellsHelper,c=n.cells,a=n.tableDataSnapshot,s=i.findByClass(ns).selectorAttr;if(s){a.begin();var u=a.cellDataProxy,f=1,h=Ni.SOLID_LINE;switch(r){case"line1":f=1,h=Ni.SOLID_LINE;break;case"line2":f=2,h=Ni.SOLID_LINE;break;case"line3":f=3,h=Ni.SOLID_LINE;break;case"line4":h=Ni.DOTTED_LINE;break;case"line5":h=Ni.POINT_LINE;break;case"line6":h=Ni.DOUBLE_LINE}switch(t){case"border1":l.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,r,o){var n=o.clone();n.borderAttr.left.display=!0,n.borderAttr.top.display=!0,n.borderAttr.right.display=!0,n.borderAttr.bottom.display=!0,n.borderAttr.left.color=e,n.borderAttr.top.color=e,n.borderAttr.right.color=e,n.borderAttr.bottom.color=e,n.borderAttr.left.width=f,n.borderAttr.top.width=f,n.borderAttr.right.width=f,n.borderAttr.bottom.width=f,n.borderAttr.left.type=h,n.borderAttr.top.type=h,n.borderAttr.right.type=h,n.borderAttr.bottom.type=h,u.setCell(t,r,n)}});break;case"border2":l.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,r,o){var n=o.clone();s.rect.sri===t?n.borderAttr.bottom.display=!0:s.rect.eri===t?n.borderAttr.top.display=!0:(n.borderAttr.bottom.display=!0,n.borderAttr.top.display=!0),s.rect.sci===r?n.borderAttr.right.display=!0:s.rect.eci===r?n.borderAttr.left.display=!0:(n.borderAttr.right.display=!0,n.borderAttr.left.display=!0),s.rect.sri===t?n.borderAttr.bottom.color=e:s.rect.eri===t?n.borderAttr.top.color=e:(n.borderAttr.bottom.color=e,n.borderAttr.top.color=e),s.rect.sci===r?n.borderAttr.right.color=e:s.rect.eci===r?n.borderAttr.left.color=e:(n.borderAttr.right.color=e,n.borderAttr.left.color=e),s.rect.sri===t?n.borderAttr.bottom.width=f:s.rect.eri===t?n.borderAttr.top.width=f:(n.borderAttr.bottom.width=f,n.borderAttr.top.width=f),s.rect.sci===r?n.borderAttr.right.width=f:s.rect.eci===r?n.borderAttr.left.width=f:(n.borderAttr.right.width=f,n.borderAttr.left.width=f),s.rect.sri===t?n.borderAttr.bottom.type=h:s.rect.eri===t?n.borderAttr.top.type=h:(n.borderAttr.bottom.type=h,n.borderAttr.top.type=h),s.rect.sci===r?n.borderAttr.right.type=h:s.rect.eci===r?n.borderAttr.left.type=h:(n.borderAttr.right.type=h,n.borderAttr.left.type=h),u.setCell(t,r,n)}});break;case"border3":l.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,r,o){var n=o.clone();s.rect.sri===t?n.borderAttr.bottom.display=!0:s.rect.eri===t?n.borderAttr.top.display=!0:(n.borderAttr.bottom.display=!0,n.borderAttr.top.display=!0),s.rect.sri===t?n.borderAttr.bottom.color=e:s.rect.eri===t?n.borderAttr.top.color=e:(n.borderAttr.bottom.color=e,n.borderAttr.top.color=e),s.rect.sri===t?n.borderAttr.bottom.width=f:s.rect.eri===t?n.borderAttr.top.width=f:(n.borderAttr.bottom.width=f,n.borderAttr.top.width=f),s.rect.sri===t?n.borderAttr.bottom.type=h:s.rect.eri===t?n.borderAttr.top.type=h:(n.borderAttr.bottom.type=h,n.borderAttr.top.type=h),u.setCell(t,r,n)}});break;case"border4":l.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,r,o){var n=o.clone();s.rect.sci===r?n.borderAttr.right.display=!0:s.rect.eci===r?n.borderAttr.left.display=!0:(n.borderAttr.right.display=!0,n.borderAttr.left.display=!0),s.rect.sci===r?n.borderAttr.right.color=e:s.rect.eci===r?n.borderAttr.left.color=e:(n.borderAttr.right.color=e,n.borderAttr.left.color=e),s.rect.sci===r?n.borderAttr.right.width=f:s.rect.eci===r?n.borderAttr.left.width=f:(n.borderAttr.right.width=f,n.borderAttr.left.width=f),s.rect.sci===r?n.borderAttr.right.type=h:s.rect.eci===r?n.borderAttr.left.type=h:(n.borderAttr.right.type=h,n.borderAttr.left.type=h),u.setCell(t,r,n)}});break;case"border5":l.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,r,o){var n=o.clone();s.rect.sci===r?n.borderAttr.left.display=!0:s.rect.eci===r&&(n.borderAttr.right.display=!0),s.rect.sri===t?n.borderAttr.top.display=!0:s.rect.eri===t&&(n.borderAttr.bottom.display=!0),s.rect.sci===r?n.borderAttr.left.color=e:s.rect.eci===r&&(n.borderAttr.right.color=e),s.rect.sri===t?n.borderAttr.top.color=e:s.rect.eri===t&&(n.borderAttr.bottom.color=e),s.rect.sci===r?n.borderAttr.left.width=f:s.rect.eci===r&&(n.borderAttr.right.width=f),s.rect.sri===t?n.borderAttr.top.width=f:s.rect.eri===t&&(n.borderAttr.bottom.width=f),s.rect.sci===r?n.borderAttr.left.type=h:s.rect.eci===r&&(n.borderAttr.right.type=h),s.rect.sri===t?n.borderAttr.top.type=h:s.rect.eri===t&&(n.borderAttr.bottom.type=h),u.setCell(t,r,n)}});break;case"border6":l.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,r,o){var n=o.clone();r===s.rect.sci&&(n.borderAttr.left.display=!0),n.borderAttr.left.color=e,n.borderAttr.left.width=f,n.borderAttr.left.type=h,u.setCell(t,r,n)}});break;case"border7":l.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,r,o){var n=o.clone();t===s.rect.sri&&(n.borderAttr.top.display=!0),n.borderAttr.top.color=e,n.borderAttr.top.width=f,n.borderAttr.top.type=h,u.setCell(t,r,n)}});break;case"border8":l.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,r,o){var n=o.clone();r===s.rect.eci&&(n.borderAttr.right.display=!0),n.borderAttr.right.color=e,n.borderAttr.right.width=f,n.borderAttr.right.type=h,u.setCell(t,r,n)}});break;case"border9":l.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,r,o){var n=o.clone();t===s.rect.eri&&(n.borderAttr.bottom.display=!0),n.borderAttr.bottom.color=e,n.borderAttr.bottom.width=f,n.borderAttr.bottom.type=h,u.setCell(t,r,n)}});break;case"border10":l.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,e,r){var o=r.clone();s.rect.sri===t&&(c.getCellOrNew(t-1,e).borderAttr.bottom.display=!1);s.rect.eri===t&&(c.getCellOrNew(t+1,e).borderAttr.top.display=!1);s.rect.sci===e&&(c.getCellOrNew(t,e-1).borderAttr.right.display=!1);s.rect.eci===e&&(c.getCellOrNew(t,e+1).borderAttr.left.display=!1);o.borderAttr.left.display=!1,o.borderAttr.top.display=!1,o.borderAttr.right.display=!1,o.borderAttr.bottom.display=!1,o.borderAttr.left.color=!1,o.borderAttr.top.color=!1,o.borderAttr.right.color=!1,o.borderAttr.bottom.color=!1,o.borderAttr.left.width=!1,o.borderAttr.top.width=!1,o.borderAttr.right.width=!1,o.borderAttr.bottom.width=!1,o.borderAttr.left.type=!1,o.borderAttr.top.type=!1,o.borderAttr.right.type=!1,o.borderAttr.bottom.type=!1,u.setCell(t,e,o)}})}a.end(),n.render()}}}}),r.fontBold=new Pr,r.fontItalic=new Dr,r.underLine=new Nr,r.fontStrike=new Ur,r.merge=new il,r.horizontalAlign=new ac({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,n=e.screen,i=e.cellsHelper,l=e.tableDataSnapshot,c=n.findByClass(ns).selectorAttr;switch(t){case Ul.left:r.horizontalAlign.setIcon(new tt("align-left"));break;case Ul.center:r.horizontalAlign.setIcon(new tt("align-center"));break;case Ul.right:r.horizontalAlign.setIcon(new tt("align-right"))}if(c){l.begin();var a=l.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:c.rect,callback:function(e,r,o){var n=o.clone();n.fontAttr.align=t,a.setCell(e,r,n)}}),l.end(),e.render()}}}}),r.verticalAlign=new Hc({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,n=e.screen,i=e.cellsHelper,l=e.tableDataSnapshot,c=n.findByClass(ns).selectorAttr;switch(t){case Xl.top:r.verticalAlign.setIcon(new tt("align-top"));break;case Xl.center:r.verticalAlign.setIcon(new tt("align-middle"));break;case Xl.bottom:r.verticalAlign.setIcon(new tt("align-bottom"))}if(c){l.begin();var a=l.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:c.rect,callback:function(e,r,o){var n=o.clone();n.fontAttr.verticalAlign=t,a.setCell(e,r,n)}}),l.end(),e.render()}}}}),r.textWrapping=new pa({contextMenu:{onUpdate:function(t){var e,n=o.getActiveSheet().table,i=n.screen,l=n.cellsHelper,c=n.tableDataSnapshot,a=i.findByClass(ns).selectorAttr;switch(t){case Gl.TRUNCATE:e=new tt("truncate");break;case Gl.WORD_WRAP:e=new tt("text-wrap");break;case Gl.OVER_FLOW:default:e=new tt("overflow")}if(r.textWrapping.setIcon(e),a){c.begin();var s=c.cellDataProxy;l.getCellOrNewCellByViewRange({rectRange:a.rect,callback:function(e,r,o){var n=o.clone();n.fontAttr.textWrap=t,s.setCell(e,r,n)}}),c.end(),n.render()}}}}),r.fixed=new va,r.filter=new Ea,r.functions=new Ca,r.children(r.undo),r.children(r.redo),r.children(r.paintFormat),r.children(r.clearFormat),r.children(new ms),r.children(r.format),r.children(new ms),r.children(r.font),r.children(r.fontSize),r.children(new ms),r.children(r.fontBold),r.children(r.fontItalic),r.children(r.underLine),r.children(r.fontStrike),r.children(r.fontColor),r.children(new ms),r.children(r.fillColor),r.children(r.border),r.children(r.merge),r.children(r.horizontalAlign),r.children(r.verticalAlign),r.children(r.textWrapping),r.children(r.fixed),r.children(r.filter),r.children(r.functions),r}var r,i,l;return ws(e,t),r=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"bind",value:function(){var t=this,e=this.workTop.work.body,r=e.sheetView;Rt.bind(e,o.WORK_BODY_EVENT_TYPE.CHANGE_ACTIVE,(function(){t.setStatus()})),Rt.bind(e,o.TABLE_EVENT_TYPE.DATA_CHANGE,(function(){t.setStatus()})),Rt.bind(e,o.TABLE_EVENT_TYPE.SELECT_DOWN,(function(){t.setFormatStatus(),t.setFontStatus(),t.setFontSizeStatus(),t.setFontBoldStatus(),t.setFontItalicStatus(),t.setUnderLineStatus(),t.setFontStrikeStatus(),t.setFontColorStatus(),t.setFillColorStatus(),t.setHorizontalAlignStatus(),t.setVerticalAlignStatus(),t.setTextWrappingStatus()})),Rt.bind(this.undo,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=r.getActiveSheet().table.tableDataSnapshot;t.canBack()&&t.back()})),Rt.bind(this.redo,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=r.getActiveSheet().table.tableDataSnapshot;t.canGo()&&t.go()})),Rt.bind(this.paintFormat,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var e=r.getActiveSheet(),o=e.table,n=o.screen,i=o.cells,l=o.tableDataSnapshot,c=n.findByClass(Xa),a=n.findByClass(ns),s=a.selectorAttr;s&&(c.setShow(s),t.paintFormat.active(!0),t.paintFormat.addSheet(e),a.on(os.SELECT_CHANGE_OVER,(function r(){c.setHide(),t.paintFormat.active(!1),t.paintFormat.removeSheet(e),a.remove(os.SELECT_CHANGE_OVER,r);var n=s.rect,u=a.selectorAttr.rect;l.begin();for(var f=l.cellDataProxy,h=n.sri,d=u.sri;h<=n.eri;h+=1,d+=1)for(var p=n.sci,y=u.sci;p<=n.eci;p+=1,y+=1){var b=i.getCellOrNew(h,p),g=i.getCellOrNew(d,y).text,w=b.clone();w.text=g,f.setCell(d,y,w)}l.end(),o.render()})))})),Rt.bind(this.clearFormat,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=r.getActiveSheet().table,e=t.screen,o=t.cellsHelper,n=t.tableDataSnapshot,i=e.findByClass(ns).selectorAttr;if(i){n.begin();var l=n.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:i.rect,callback:function(t,e,r){var o=r.text;l.setCell(t,e,new hs({text:o}))}}),n.end(),t.render()}})),Rt.bind(this.format,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.format.formatContextMenu,o=r.elPopUp;fe.closeAll([o]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Rt.bind(this.font,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.font.fontContextMenu,o=r.elPopUp;fe.closeAll([o]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Rt.bind(this.fontSize,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.fontSize.fontSizeContextMenu,o=r.elPopUp;fe.closeAll([o]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Rt.bind(this.fontBold,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=r.getActiveSheet().table,e=t.screen,o=t.cells,n=t.cellsHelper,i=t.tableDataSnapshot,l=e.findByClass(ns).selectorAttr;if(l){var c=!o.getCellOrNew(l.rect.sri,l.rect.sci).fontAttr.bold;i.begin();var a=i.cellDataProxy;n.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(t,e,r){var o=r.clone();o.fontAttr.bold=c,a.setCell(t,e,o)}}),i.end(),t.render()}})),Rt.bind(this.fontItalic,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=r.getActiveSheet().table,e=t.screen,o=t.cells,n=t.cellsHelper,i=t.tableDataSnapshot,l=e.findByClass(ns).selectorAttr;if(l){var c=!o.getCellOrNew(l.rect.sri,l.rect.sci).fontAttr.italic;i.begin();var a=i.cellDataProxy;n.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(t,e,r){var o=r.clone();o.fontAttr.italic=c,a.setCell(t,e,o)}}),i.end(),t.render()}})),Rt.bind(this.underLine,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=r.getActiveSheet().table,e=t.screen,o=t.cells,n=t.cellsHelper,i=t.tableDataSnapshot,l=e.findByClass(ns).selectorAttr;if(l){var c=!o.getCellOrNew(l.rect.sri,l.rect.sci).fontAttr.underline;i.begin();var a=i.cellDataProxy;n.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(t,e,r){var o=r.clone();o.fontAttr.underline=c,a.setCell(t,e,o)}}),i.end(),t.render()}})),Rt.bind(this.fontStrike,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=r.getActiveSheet().table,e=t.screen,o=t.cells,n=t.cellsHelper,i=t.tableDataSnapshot,l=e.findByClass(ns).selectorAttr;if(l){var c=!o.getCellOrNew(l.rect.sri,l.rect.sci).fontAttr.strikethrough;i.begin();var a=i.cellDataProxy;n.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(t,e,r){var o=r.clone();o.fontAttr.strikethrough=c,a.setCell(t,e,o)}}),i.end(),t.render()}})),Rt.bind(this.fontColor,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.fontColor.fontColorContextMenu,o=r.elPopUp;fe.closeAll([o]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Rt.bind(this.fillColor,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.fillColor.fillColorContextMenu,o=r.elPopUp;fe.closeAll([o]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Rt.bind(this.border,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.border.borderTypeContextMenu,o=r.elPopUp;fe.closeAll([o]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Rt.bind(this.merge,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){var e=r.getActiveSheet().table,o=e.screen,n=e.merges,i=e.tableDataSnapshot,l=o.findByClass(ns).selectorAttr;if(l){var c=l.rect.clone(),a=n.getFirstIncludes(c.sri,c.sci);i.begin();var s=i.mergeDataProxy;null!==a?s.deleteMerge(a):c.multiple()&&s.addMerge(c),i.end(),e.render()}t.stopPropagation(),t.preventDefault()})),Rt.bind(this.horizontalAlign,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.horizontalAlign.horizontalContextMenu,o=r.elPopUp;fe.closeAll([o]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Rt.bind(this.verticalAlign,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.verticalAlign.verticalContextMenu,o=r.elPopUp;fe.closeAll([o]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Rt.bind(this.textWrapping,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.textWrapping.textWrappingContextMenu,o=r.elPopUp;fe.closeAll([o]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()}))}},{key:"setUndoStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table.tableDataSnapshot;this.undo.active(t.canBack())}},{key:"setRedoStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table.tableDataSnapshot;this.redo.active(t.canGo())}},{key:"setPaintFormatStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet();this.paintFormat.active(this.paintFormat.includeSheet(t))}},{key:"setFormatStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,o=e.findByClass(ns).selectorAttr,n="常规",i="default";if(o)switch(i=r.getCellOrNew(o.rect.sri,o.rect.sci).format){case"default":n="常规";break;case"text":n="文本";break;case"number":n="数字";break;case"percentage":n="百分比";break;case"fraction":n="分数";break;case"ENotation":n="科学计数";break;case"rmb":n="人民币";break;case"hk":n="港币";break;case"dollar":n="美元";break;case"date1":case"date2":case"date3":case"date4":case"date5":n="日期";break;case"time":n="时间"}this.format.setTitle(n),this.format.formatContextMenu.setActiveByType(i)}},{key:"setFontStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,o=e.findByClass(ns).selectorAttr,n="Arial";o&&(n=r.getCellOrNew(o.rect.sri,o.rect.sci).fontAttr.name),this.font.setTitle(n),this.font.fontContextMenu.setActiveByType(n)}},{key:"setFontSizeStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,o=e.findByClass(ns).selectorAttr,n="12";o&&(n=r.getCellOrNew(o.rect.sri,o.rect.sci).fontAttr.size),this.fontSize.setTitle(n)}},{key:"setFontBoldStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,o=e.findByClass(ns).selectorAttr,n=!1;o&&(n=r.getCellOrNew(o.rect.sri,o.rect.sci).fontAttr.bold),this.fontBold.active(n)}},{key:"setFontItalicStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,o=e.findByClass(ns).selectorAttr,n=!1;o&&(n=r.getCellOrNew(o.rect.sri,o.rect.sci).fontAttr.italic),this.fontItalic.active(n)}},{key:"setUnderLineStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,o=e.findByClass(ns).selectorAttr,n=!1;o&&(n=r.getCellOrNew(o.rect.sri,o.rect.sci).fontAttr.underline),this.underLine.active(n)}},{key:"setFontStrikeStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,o=e.findByClass(ns).selectorAttr,n=!1;o&&(n=r.getCellOrNew(o.rect.sri,o.rect.sci).fontAttr.strikethrough),this.fontStrike.active(n)}},{key:"setFontColorStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,o=e.findByClass(ns).selectorAttr,n="rgb(0, 0, 0)";o&&(n=r.getCellOrNew(o.rect.sri,o.rect.sci).fontAttr.color),this.fontColor.setColor(n),this.fontColor.fontColorContextMenu.setActiveByColor(n)}},{key:"setFillColorStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,o=e.findByClass(ns).selectorAttr,n="rgb(255, 255, 255)";if(o){var i=r.getCellOrNew(o.rect.sri,o.rect.sci);i.background&&(n=i.background)}this.fillColor.setColor(n),this.fillColor.fillColorContextMenu.setActiveByColor(n)}},{key:"setHorizontalAlignStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,o=e.findByClass(ns).selectorAttr,n=new tt("align-left");if(o)switch(r.getCellOrNew(o.rect.sri,o.rect.sci).fontAttr.align){case Ul.left:n=new tt("align-left");break;case Ul.center:n=new tt("align-center");break;case Ul.right:n=new tt("align-right")}this.horizontalAlign.setIcon(n)}},{key:"setVerticalAlignStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,o=e.findByClass(ns).selectorAttr,n=new tt("align-middle");if(o)switch(r.getCellOrNew(o.rect.sri,o.rect.sci).fontAttr.verticalAlign){case Xl.top:n=new tt("align-top");break;case Xl.center:n=new tt("align-middle");break;case Xl.bottom:n=new tt("align-bottom")}this.verticalAlign.setIcon(n)}},{key:"setTextWrappingStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,o=e.findByClass(ns).selectorAttr,n=new tt("text-wrap");if(o)switch(r.getCellOrNew(o.rect.sri,o.rect.sci).fontAttr.textWrap){case Gl.TRUNCATE:n=new tt("truncate");break;case Gl.WORD_WRAP:n=new tt("text-wrap");break;case Gl.OVER_FLOW:default:n=new tt("overflow")}this.textWrapping.setIcon(n)}},{key:"setStatus",value:function(){this.setUndoStatus(),this.setRedoStatus(),this.setPaintFormatStatus(),this.setFormatStatus(),this.setFontStatus(),this.setFontSizeStatus(),this.setFontBoldStatus(),this.setFontItalicStatus(),this.setUnderLineStatus(),this.setFontStrikeStatus(),this.setFontColorStatus(),this.setFillColorStatus(),this.setHorizontalAlignStatus(),this.setVerticalAlignStatus(),this.setTextWrappingStatus()}}])&&ds(r.prototype,i),l&&ds(r,l),e}(L);function Os(t){return(Os="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ks(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Es(t,e){return!e||"object"!==Os(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ss(t){return(Ss=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function As(t,e){return(As=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _s=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Es(this,Ss(e).call(this,"".concat(n,"-option-item ").concat(t)))).title="",r}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&As(t,e)}(e,t),r=e,(o=[{key:"setTitle",value:function(t){this.title=t,this.text(this.title)}}])&&ks(r.prototype,o),i&&ks(r,i),e}(L);function Ts(t){return(Ts="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cs(t,e){return!e||"object"!==Ts(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ps(t){return(Ps=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function js(t,e){return(js=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ws=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Cs(this,Ps(e).call(this,"".concat(n,"-tools-file")))).setTitle("文件"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&js(t,e)}(e,t),e}(_s);function Ls(t){return(Ls="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rs(t,e){return!e||"object"!==Ls(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ds(t){return(Ds=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Is(t,e){return(Is=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vs=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Rs(this,Ds(e).call(this,"".concat(n,"-tools-format")))).setTitle("格式"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Is(t,e)}(e,t),e}(_s);function Hs(t){return(Hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ms(t,e){return!e||"object"!==Hs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ns(t){return(Ns=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zs(t,e){return(zs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bs=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ms(this,Ns(e).call(this,"".concat(n,"-tools-insert")))).setTitle("插入"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zs(t,e)}(e,t),e}(_s);function Ys(t){return(Ys="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fs(t,e){return!e||"object"!==Ys(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Us(t){return(Us=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xs(t,e){return(Xs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gs=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Fs(this,Us(e).call(this,"".concat(n,"-tools-look")))).setTitle("查看"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xs(t,e)}(e,t),e}(_s);function Ks(t){return(Ks="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qs(t,e){return!e||"object"!==Ks(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $s(t){return($s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zs(t,e){return(Zs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Js=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=qs(this,$s(e).call(this,"".concat(n,"-tools-update")))).setTitle("修改"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zs(t,e)}(e,t),e}(_s);function Qs(t){return(Qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tu(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function eu(t,e){return!e||"object"!==Qs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ru(t){return(ru=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ou(t,e){return(ou=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nu=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=eu(this,ru(e).call(this,"".concat(n,"-option")))).workTop=t,r.title=" X-Sheet 工作簿",r.logoEle=_("div","".concat(n,"-option-logo")),r.titleEle=_("div","".concat(n,"-option-title")),r.optionsEle=_("div","".concat(n,"-option-box")),r.leftEle=_("div","".concat(n,"-option-left")),r.rightEle=_("div","".concat(n,"-option-right")),r.leftEle.children(r.logoEle),r.rightEle.children(r.titleEle,r.optionsEle),r.children(r.leftEle),r.children(r.rightEle),r.setTitle(r.title),r.file=new Ws,r.format=new Vs,r.insert=new Bs,r.look=new Gs,r.update=new Js,r.optionsEle.children(r.file),r.optionsEle.children(r.format),r.optionsEle.children(r.insert),r.optionsEle.children(r.look),r.optionsEle.children(r.update),r}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ou(t,e)}(e,t),r=e,(o=[{key:"setTitle",value:function(t){this.title=t,this.titleEle.text(t)}}])&&tu(r.prototype,o),i&&tu(r,i),e}(L);function iu(t){return(iu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lu(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function cu(t,e){return!e||"object"!==iu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function au(t){return(au=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function su(t,e){return(su=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var uu=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=cu(this,au(e).call(this,"".concat(n,"-work-top")))).work=t,r}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&su(t,e)}(e,t),r=e,(o=[{key:"onAttach",value:function(){this.toolsMenu=new xs(this),this.option=new nu(this),this.attach(this.option),this.attach(this.toolsMenu)}}])&&lu(r.prototype,o),i&&lu(r,i),e}(L);function fu(t){return(fu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hu(t,e){return!e||"object"!==fu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function du(t){return(du=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pu(t,e){return(pu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yu=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=hu(this,du(e).call(this,"".concat(n,"-vertical-center-element")))).options=k.mergeDeep({style:{}},t),r.css(r.options.style),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pu(t,e)}(e,t),e}(H);function bu(t){return(bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gu(t,e){return!e||"object"!==bu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wu(t){return(wu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vu(t,e){return(vu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mu=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=gu(this,wu(e).call(this,"div","".concat(n,"-vertical-center")))).options=k.mergeDeep({style:{}},t),r.css(r.options.style),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vu(t,e)}(e,t),e}(H);function xu(t){return(xu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ou(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ku(t,e){return!e||"object"!==xu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Eu(t,e,r){return(Eu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Su(t)););return t}(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(r):n.value}})(t,e,r||t)}function Su(t){return(Su=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Au(t,e){return(Au=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _u=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ku(this,Su(e).call(this,"".concat(n,"-sheet-view")))).sheetList=[],t.activeIndex=-1,t}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Au(t,e)}(e,t),r=e,(i=[{key:"attach",value:function(t){var r=this;this.sheetList.push(t),Eu(Su(e.prototype),"attach",this).call(this,t),t.hide(),Rt.bind(t,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){r.trigger(o.TABLE_EVENT_TYPE.CHANGE_WIDTH)})),Rt.bind(t,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){r.trigger(o.TABLE_EVENT_TYPE.CHANGE_HEIGHT)})),Rt.bind(t,o.TABLE_EVENT_TYPE.DATA_CHANGE,(function(){r.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE)})),Rt.bind(t,o.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(){r.trigger(o.TABLE_EVENT_TYPE.SELECT_CHANGE)})),Rt.bind(t,o.TABLE_EVENT_TYPE.SELECT_DOWN,(function(){r.trigger(o.TABLE_EVENT_TYPE.SELECT_DOWN,r)}))}},{key:"setActiveSheet",value:function(t){var e=this.sheetList;return e[t]?(this.activeIndex=t,this.setActive(e[t])):null}},{key:"setActive",value:function(t){return t.show(),t.sibling().forEach((function(t){t.hide()})),t}},{key:"getActiveSheet",value:function(){return this.sheetList[this.activeIndex]}},{key:"getLastIndex",value:function(){return this.sheetList.length-1}}])&&Ou(r.prototype,i),l&&Ou(r,l),e}(L);function Tu(t){return(Tu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cu(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Pu(t,e){return!e||"object"!==Tu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ju(t){return(ju=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wu(t,e){return(Wu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Lu=function(t){function e(t){var r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Pu(this,ju(e).call(this,"".concat(n,"-sheet-switch-tab")))).last=_("div","".concat(n,"-switch-tab-last-btn")),o.next=_("div","".concat(n,"-switch-tab-next-btn")),o.content=_("div","".concat(n,"-sheet-tab-content")),o.tabs=_("div","".concat(n,"-sheet-tab-tabs")),o.plus=_("div","".concat(n,"-sheet-tab-plus")),o.content.children(o.tabs),(r=o).children.apply(r,[o.last,o.next,o.content,o.plus]),o.optiions=k.mergeDeep({onAdd:function(t){return t},onSwitch:function(t){return t}},t),o.left=null,o.tabList=[],o}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wu(t,e)}(e,t),r=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"offsetSizeLeft",value:function(){var t=this.content.offset().width,e=this.tabs.offset().width;e>t&&(this.left=-(e-t),this.tabs.css("marginLeft","".concat(this.left,"px")))}},{key:"bind",value:function(){var t=this,e=this.next,r=this.last,n=this.plus;Rt.bind(e,o.SYSTEM_EVENT_TYPE.CLICK,(function(){var e=t.content.offset().width,r=-(t.tabs.offset().width-e),o=t.left||0;(o-=30)<r&&(o=r),t.left=o,t.tabs.css("marginLeft","".concat(t.left,"px"))})),Rt.bind(r,o.SYSTEM_EVENT_TYPE.CLICK,(function(){var e=t.left||0;(e+=30)>0&&(e=0),t.left=e,t.tabs.css("marginLeft","".concat(t.left,"px"))})),Rt.bind(n,o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.optiions.onAdd(),t.offsetSizeLeft()}))}},{key:"attach",value:function(t){var e=this;this.tabList.push(t),this.tabs.children(t),t.onAttach(),Rt.bind(t,o.SYSTEM_EVENT_TYPE.CLICK,(function(){e.setActive(t),e.optiions.onSwitch(t)}))}},{key:"setActiveTab",value:function(t){var e=this.tabList;return e[t]?(this.setActive(e[t]),e[t]):null}},{key:"setActive",value:function(t){t.addClass("active"),t.sibling().forEach((function(t){t.removeClass("active")}))}},{key:"getLastIndex",value:function(){return this.tabList.length-1}}])&&Cu(r.prototype,i),l&&Cu(r,l),e}(L);function Ru(t){return(Ru="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Du(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Iu(t,e){return!e||"object"!==Ru(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vu(t){return(Vu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hu(t,e){return(Hu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mu=0,Nu=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Sheet".concat(Mu+=1);return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Iu(this,Vu(e).call(this,"".concat(n,"-sheet-tab")))).setName(r),t}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hu(t,e)}(e,t),r=e,(o=[{key:"setName",value:function(t){this.name=t,this.text(this.name)}}])&&Du(r.prototype,o),i&&Du(r,i),e}(L);function zu(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Bu=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,o;return e=t,o=[{key:"dateFormat",value:function(t,e){var r={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()},o=/(y+)/.exec(t);if(o){var n=o[0],i=e.getFullYear().toString().substr(4-n.length);t=t.replace(n,i)}for(var l in r){var c=new RegExp("(".concat(l,")")).exec(t);if(c){var a=r[l].toString(),s=c[0],u=1===s.length?a:"00".concat(a).substr(a.length);t=t.replace(s,u)}}return t}},{key:"parserToDate",value:function(t,e){if(!t)return null;for(var r=new Date("1970/01/01 00:00:00"),o=[{reg:"y+"},{reg:"M+"},{reg:"d+"},{reg:"h+"},{reg:"m+"},{reg:"s+"},{reg:"S"}],n=r.getFullYear(),i=r.getMonth()+1,l=r.getDate(),c=r.getHours(),a=r.getMinutes(),s=r.getSeconds(),u=r.getMilliseconds(),f=1,h=0;h<e.length;h+=1)for(var d=e[h],p=0;p<o.length;p+=1){var y=o[p];if(y.reg[0]===d){y.index||(y.index=f,f+=1);break}}for(var b=0;b<o.length;b+=1){var g=o[b].reg,w=new RegExp("(".concat(g,")")).exec(e);if(w){var v=w[0],m="([0-9]{1,".concat(v.length,"})");e=e.replace(v,m)}}var x={},O=new RegExp(e).exec(t);if(!O)return null;for(var k=1;k<O.length;k+=1)x[k]=O[k];return o[0].index&&(n=x[o[0].index]),o[1].index&&(i=x[o[1].index]),o[2].index&&(l=x[o[2].index]),o[3].index&&(c=x[o[3].index]),o[4].index&&(a=x[o[4].index]),o[5].index&&(s=x[o[5].index]),o[6].index&&(u=x[o[6].index]),new Date(n,i-1,l,c,a,s,u)}}],(r=null)&&zu(e.prototype,r),o&&zu(e,o),t}();function Yu(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Fu(t){var e=Bu.parserToDate(t,"yyyy/MM/dd hh:mm:ss");return e||((e=Bu.parserToDate(t,"yyyy/MM/dd"))?e:(e=Bu.parserToDate(t,"hh:mm:ss"))?e:(e=Bu.parserToDate(t,"MM月dd日"))?e:(e=Bu.parserToDate(t,"yyyy年MM月"))?e:(e=Bu.parserToDate(t,"yyyy年MM月dd日"))||null)}var Uu=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,o;return e=t,(r=[{key:"default",value:function(t){return t}},{key:"text",value:function(t){return t}},{key:"number",value:function(t){if(k.isNumber(t)){if(-1!==t.toString().indexOf(".")){var e=t.toString().lastIndexOf(".")+1;return t.toString().substring(0,e+2)}return"".concat(t,".00")}return t}},{key:"percentage",value:function(t){return k.isNumber(t)?"".concat(t,"%"):t}},{key:"fraction",value:function(t){if(k.isFraction(t)){var e=t.split("/")[0],r=t.split("/")[1];return k.parseInt(e)/k.parseInt(r)}return t}},{key:"ENotation",value:function(t){return k.isNumber(t)?k.parseFloat(t).toExponential(2):t}},{key:"rmb",value:function(t){return k.isNumber(t)?"￥".concat(t):t}},{key:"hk",value:function(t){return k.isNumber(t)?"HK".concat(t):t}},{key:"dollar",value:function(t){return k.isNumber(t)?"$".concat(t):t}},{key:"date1",value:function(t){var e=Fu(t);return e?Bu.dateFormat("yyyy/MM/dd",e):t}},{key:"date2",value:function(t){var e=Fu(t);return e?Bu.dateFormat("MM月dd日",e):t}},{key:"date3",value:function(t){var e=Fu(t);return e?Bu.dateFormat("yyyy年MM月",e):t}},{key:"date4",value:function(t){var e=Fu(t);return e?Bu.dateFormat("yyyy年MM月dd日",e):t}},{key:"date5",value:function(t){var e=Fu(t);return e?Bu.dateFormat("yyyy/MM/dd hh:mm:ss",e):t}},{key:"time",value:function(t){var e=Fu(t);return e?Bu.dateFormat("hh:mm:ss",e):t}}])&&Yu(e.prototype,r),o&&Yu(e,o),t}()),Xu=function(t,e){return Uu[t](e)};function Gu(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Ku=function(){function t(e){var r=e.data,o=void 0===r?[]:r,n=e.len,i=void 0===n?10:n,l=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._=[],this.minHeight=5,this.height=k.minIf(l,this.minHeight),this.len=i,this.cacheTotalHeight=-1,this.setData(o)}var e,r,o;return e=t,(r=[{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"getHeight",value:function(t){var e=this.get(t);return e&&e.height?e.height:this.height}},{key:"setHeight",value:function(t,e){this.getOrNew(t).height=k.minIf(e,this.minHeight),this.cacheTotalHeight=-1}},{key:"eachHeight",value:function(t,e,r){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=o,i=t;i<=e;i+=1){var l=this.getHeight(i);r(i,l,n),n+=l}}},{key:"sectionSumHeight",value:function(t,e){var r=this;return k.rangeSum(t,e+1,(function(t){return r.getHeight(t)}))}},{key:"rectRangeSumHeight",value:function(t){return this.sectionSumHeight(t.sri,t.eri)}},{key:"totalHeight",value:function(){var t=this;return-1===this.cacheTotalHeight&&(this.cacheTotalHeight=k.rangeSum(0,this.len,(function(e){return t.getHeight(e)}))),this.cacheTotalHeight}},{key:"getData",value:function(){return this._}},{key:"setData",value:function(t){this._=t}}])&&Gu(e.prototype,r),o&&Gu(e,o),t}();function qu(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var $u=function(){function t(e){var r=e.data,o=void 0===r?[]:r,n=e.len,i=void 0===n?10:n,l=e.width;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._=[],this.minWidth=5,this.width=k.minIf(l,this.minWidth),this.len=i,this.cacheTotalWidth=-1,this.setData(o)}var e,r,o;return e=t,(r=[{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"getWidth",value:function(t){var e=this._[t];return e&&e.width?e.width:this.width}},{key:"setWidth",value:function(t,e){this.getOrNew(t).width=k.minIf(e,this.minWidth),this.cacheTotalWidth=-1}},{key:"eachWidth",value:function(t,e,r){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=o,i=t;i<=e;i+=1){var l=this.getWidth(i);r(i,l,n),n+=l}}},{key:"sectionSumWidth",value:function(t,e){var r=this;return k.rangeSum(t,e+1,(function(t){return r.getWidth(t)}))}},{key:"rectRangeSumWidth",value:function(t){return this.sectionSumWidth(t.sci,t.eci)}},{key:"totalWidth",value:function(){var t=this;return-1===this.cacheTotalWidth&&(this.cacheTotalWidth=k.rangeSum(0,this.len,(function(e){return t.getWidth(e)}))),this.cacheTotalWidth}},{key:"getData",value:function(){return this._}},{key:"setData",value:function(t){this._=t}}])&&qu(e.prototype,r),o&&qu(e,o),t}();var Zu={H_LEFT:Symbol("水平方向左边滚动条"),H_RIGHT:Symbol("水平方向向右边滚动"),V_TOP:Symbol("垂直方向向上滚动"),V_BOTTOM:Symbol("垂直方向下滚动"),UN:Symbol("未知")},Ju=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.x=0,this.y=0,this.ri=e.fixed.fxTop+1,this.ci=e.fixed.fxLeft+1,this.type=Zu.UN};function Qu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var tf=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{fxTop:-1,fxLeft:-1};Qu(this,t),this.fxTop=e.fxTop,this.fxLeft=e.fxLeft};function ef(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var rf=function(){function t(e){var r=e.data,o=void 0===r?[]:r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._=[],this.setData(o)}var e,r,o;return e=t,(r=[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(t){this._=this._.filter((function(e){return!e.within(t)}))}},{key:"getFirstIncludes",value:function(t,e){for(var r=0;r<this._.length;r+=1){var o=this._[r];if(o.includes(t,e))return o}return null}},{key:"filterIntersects",value:function(e){return new t(this._.filter((function(t){return t.intersects(e)})))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1)if(this._[e].intersects(t))return!0;return!1}},{key:"deleteIntersects",value:function(t){for(var e=0;e<this._.length;e+=1)this._[e].intersects(t)&&this._.splice(e,1)}},{key:"union",value:function(t){for(var e=this,r=t,o=[],n=function(t){var n=e._[t];if(o.find((function(t){return t===n})))return i=t,"continue";n.intersects(r)&&(o.push(n),r=n.union(r),t=-1),i=t},i=0;i<this._.length;i+=1)n(i);return r}},{key:"add",value:function(t){t&&(this.deleteWithin(t),this._.push(t))}},{key:"move",value:function(t,e,r){this._.forEach((function(o){var n=o;n.within(t)&&(n.eri+=e,n.sri+=e,n.sci+=r,n.eci+=r)}))}},{key:"shift",value:function(t,e,r,o){this._.forEach((function(n){var i=n.sri,l=n.sci,c=n.eri,a=n.eci,s=n;"row"===t?i>=e?(s.sri+=r,s.eri+=r):i<e&&e<=c&&(s.eri+=r,o(i,l,r,0)):"column"===t&&(l>=e?(s.sci+=r,s.eci+=r):l<e&&e<=a&&(s.eci+=r,o(i,l,0,r)))}))}},{key:"setData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this._=t.map((function(t){return Na.valueOf(t)})),this}},{key:"getData",value:function(){return this._.map((function(t){return t.toString()}))}}])&&ef(e.prototype,r),o&&ef(e,o),t}();function of(t){return(of="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nf(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function lf(t,e){return!e||"object"!==of(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cf(t){return(cf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function af(t,e){return(af=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sf=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=lf(this,cf(e).call(this,"".concat(n,"-screen-element ").concat(t)))).widgets=[],r}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&af(t,e)}(e,t),r=e,(o=[{key:"addWidget",value:function(t){this.widgets.push(t),this.children(t)}}])&&nf(r.prototype,o),i&&nf(r,i),e}(L);function uf(t){return(uf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ff(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function hf(t,e){return!e||"object"!==uf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function df(t){return(df=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pf(t,e){return(pf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yf=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=hf(this,df(e).call(this,"".concat(n,"-screen")))).table=t,r.widgets=[],r.lt=new sf("".concat(n,"-screen-element-lt")),r.t=new sf("".concat(n,"-screen-element-t")),r.l=new sf("".concat(n,"-screen-element-l")),r.br=new sf("".concat(n,"-screen-element-br")),r.children(r.lt,r.t,r.l,r.br),r}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pf(t,e)}(e,t),r=e,(i=[{key:"onAttach",value:function(){this.bind(),this.setDivideLayer()}},{key:"init",value:function(){}},{key:"bind",value:function(){var t=this,e=this.table;Rt.bind(window,o.SYSTEM_EVENT_TYPE.RESIZE,(function(){t.setDivideLayer()})),Rt.bind(e,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.setDivideLayer()})),Rt.bind(e,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.setDivideLayer()}))}},{key:"addWidget",value:function(t){this.widgets.push(t),this.lt.addWidget(t.getLT(this)),this.t.addWidget(t.getT(this)),this.l.addWidget(t.getL(this)),this.br.addWidget(t.getBR(this))}},{key:"setDivideLayer",value:function(){var t=this.table,e=t.settings,r=t.grid,o=e.index,n=t.getFixedWidth(),i=t.getFixedHeight(),l=o.width+n,c=o.height+i;this.br.offset({left:l,top:c}),n>0&&i>0?(this.lt.offset({left:o.width,top:o.height,width:n,height:i}).show(),this.lt.css("border-width","".concat(r.lineWidth(),"px"))):this.lt.hide(),n>0?(this.l.offset({left:o.width,top:c,width:n}).show(),this.l.css("border-width","".concat(r.lineWidth(),"px"))):this.l.hide(),i>0?(this.t.offset({left:l,top:o.height,height:i}).show(),this.t.css("border-width","".concat(r.lineWidth(),"px"))):this.t.hide()}},{key:"findByClass",value:function(t){var e=null;return this.widgets.forEach((function(r){return!(r instanceof t&&(e=r,1))})),e}}])&&ff(r.prototype,i),l&&ff(r,l),e}(L);function bf(t){return(bf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gf(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function wf(t,e){return!e||"object"!==bf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vf(t){return(vf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mf(t,e){return(mf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xf=function(t){function e(t){var r,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:5};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=wf(this,vf(e).call(this,"".concat(n,"-re-sizer-horizontal")))).table=t,o.options=i,o.width=i.width,o.hoverEl=_("div","".concat(n,"-re-sizer-hover")),o.lineEl=_("div","".concat(n,"-re-sizer-line")),(r=o).children.apply(r,[o.hoverEl,o.lineEl]),o}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mf(t,e)}(e,t),r=e,(i=[{key:"onAttach",value:function(){this.bind(),this.table.focus.register({el:this})}},{key:"getEventLeft",value:function(t){var e=this.table,r=e.settings,o=e.cols,n=e.fixed,i=e.scroll,l=r.index,c=e.computeEventXy(t),a=c.x,s=c.y,u=e.getRiCiByXy(a,s),f=u.ri,h=u.ci;if(-1!==f)return{left:-1,x:a,y:s,ri:f,ci:h};var d=l.width+o.sectionSumWidth(0,h);return h>n.fxLeft&&(d-=i.x),{left:d,x:a,y:s,ri:f,ci:h}}},{key:"bind",value:function(){var t=this,e=this.table,r=e.settings,n=e.cols,i=e.mousePointer,l=e.tableDataSnapshot,c=l.colsDataProxy,a=r.index,s=o.MOUSE_POINTER_TYPE.COL_RESIZE,u=s.key,f=s.type,h=!1;Rt.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){h||(i.on(u),i.set(f,u))})),Rt.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){h||i.off(u)})),Rt.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(r){h=!0,i.on(u),i.set(f,u);var o=t.getEventLeft(r),a=o.left,s=o.ci,d=a-n.getWidth(s)+n.minWidth,p=e.computeEventXy(r).x;Rt.mouseMoveUp(document,(function(r){var o=e.computeEventXy(r);p=o.x,p-=t.width/2,p=Math.ceil(k.minIf(p,d)),t.css("left","".concat(p,"px")),t.lineEl.css("height","".concat(e.visualHeight(),"px")),t.lineEl.show()}),(function(r){h=!1,i.off(u),t.lineEl.hide(),t.css("left","".concat(p,"px")),e.computeEventXy(r).y<=0&&t.hide();var o=p-(a-n.getWidth(s))+t.width;l.begin(),c.setWidth(s,o),l.end(),e.resize()}))})),Rt.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(r){if(!h){var o=t.getEventLeft(r),i=o.left,l=o.ci,c=i-n.getWidth(l)+n.minWidth,s=e.visualWidth();i>s&&(i=s),-1===i||c>s||-1===l?t.hide():(t.show(),t.css("left","".concat(i-t.width,"px")),t.hoverEl.css("width","".concat(t.width,"px")),t.hoverEl.css("height","".concat(a.height,"px")))}})),Rt.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){h||t.hide()}))}}])&&gf(r.prototype,i),l&&gf(r,l),e}(L);function Of(t){return(Of="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kf(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ef(t,e){return!e||"object"!==Of(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sf(t){return(Sf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Af(t,e){return(Af=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _f=function(t){function e(t){var r,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{height:5};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Ef(this,Sf(e).call(this,"".concat(n,"-re-sizer-vertical")))).table=t,o.options=i,o.height=i.height,o.hoverEl=_("div","".concat(n,"-re-sizer-hover")),o.lineEl=_("div","".concat(n,"-re-sizer-line")),(r=o).children.apply(r,[o.hoverEl,o.lineEl]),o}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Af(t,e)}(e,t),r=e,(i=[{key:"onAttach",value:function(){this.bind(),this.table.focus.register({el:this})}},{key:"getEventTop",value:function(t){var e=this.table,r=e.settings,o=e.rows,n=e.fixed,i=e.scroll,l=r.index,c=e.computeEventXy(t),a=c.x,s=c.y,u=e.getRiCiByXy(a,s),f=u.ri,h=u.ci;if(-1!==h)return{top:-1,x:a,y:s,ri:f,ci:h};var d=l.height+o.sectionSumHeight(0,f);return f>n.fxTop&&(d-=i.y),{top:d,x:a,y:s,ri:f,ci:h}}},{key:"bind",value:function(){var t=this,e=this.table,r=e.settings,n=e.rows,i=e.mousePointer,l=e.tableDataSnapshot,c=l.rowsDataProxy,a=r.index,s=o.MOUSE_POINTER_TYPE.ROW_RESIZE,u=s.key,f=s.type,h=!1;Rt.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){h||(i.on(u),i.set(f,u))})),Rt.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){h||i.off(u)})),Rt.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(r){h=!0,i.on(u),i.set(f,u);var o=t.getEventTop(r),a=o.top,s=o.ri,d=a-n.getHeight(s)+n.minHeight,p=e.computeEventXy(r).y;Rt.mouseMoveUp(document,(function(r){var o=e.computeEventXy(r);p=o.y,p-=t.height/2,p=Math.ceil(k.minIf(p,d)),t.css("top","".concat(p,"px")),t.lineEl.css("width","".concat(e.visualWidth(),"px")),t.lineEl.show()}),(function(r){h=!1,i.off(u),t.lineEl.hide(),t.css("top","".concat(p,"px")),e.computeEventXy(r).x<=0&&t.hide();var o=p-(a-n.getHeight(s))+t.height;l.begin(),c.setHeight(s,o),l.end(),e.resize()}))})),Rt.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(r){if(!h){var o=t.getEventTop(r),i=o.top,l=o.ri,c=i-n.getHeight(l)+n.minHeight,s=e.visualHeight();i>s&&(i=s),-1===i||c>s||-1===l?t.hide():(t.show(),t.css("top","".concat(i-t.height,"px")),t.hoverEl.css("width","".concat(a.width,"px")),t.hoverEl.css("height","".concat(t.height,"px")))}})),Rt.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){h||t.hide()}))}}])&&kf(r.prototype,i),l&&kf(r,l),e}(L);function Tf(t){return(Tf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cf(t,e){return!e||"object"!==Tf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pf(t){return(Pf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jf(t,e){return(jf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wf=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Cf(this,Pf(e).call(this,"".concat(n,"-autofill")))).areaEl=_("div","".concat(n,"-autofill-area")),t.children(t.areaEl),t.hide(),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jf(t,e)}(e,t),e}(L);function Lf(t){return(Lf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rf(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var r=[],o=!0,n=!1,i=void 0;try{for(var l,c=t[Symbol.iterator]();!(o=(l=c.next()).done)&&(r.push(l.value),!e||r.length!==e);o=!0);}catch(t){n=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(n)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Df(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function If(t,e){return!e||"object"!==Lf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vf(t){return(Vf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hf(t,e){return(Hf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mf=function(t){function e(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=If(this,Vf(e).call(this,t))).options=k.mergeDeep({mergeForceSplit:!1,onBeforeAutoFill:function(){},onAfterAutoFill:function(){}},o),r.lt=new Wf,r.t=new Wf,r.l=new Wf,r.br=new Wf,r.autoFillAttr=null,r.bind(),r}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hf(t,e)}(e,t),r=e,(n=[{key:"bind",value:function(){var t=this,e=this.screen.table,r=e.mousePointer,n=e.screenSelector,i=o.MOUSE_POINTER_TYPE.AUTO_FILL,l=i.key,c=i.type;Rt.bind([n.lt.cornerEl,n.t.cornerEl,n.l.cornerEl,n.br.cornerEl],o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){r.on(l),r.set(c,l),Rt.mouseMoveUp(document,(function(r){var o=e.computeEventXy(r),n=o.x,i=o.y,l=t.getMoveAutoFillAttr(n,i);l?t.setOffset(l):(t.lt.hide(),t.t.hide(),t.l.hide(),t.br.hide()),t.autoFillAttr=l}),(function(){r.off(l),t.lt.hide(),t.t.hide(),t.l.hide(),t.br.hide(),t.autoFillAttr&&(t.autoFillTo(),e.render())}))})),Rt.bind([n.lt.cornerEl,n.t.cornerEl,n.l.cornerEl,n.br.cornerEl],o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){r.set(c,l)}))}},{key:"setLTOffset",value:function(t){var e=this.screen.table,r=e.frozenLeftTop,o=e.cols,n=e.rows,i=r.getScrollViewRange(),l=t.rect,c=new Na(-1,-1,-1,-1),a=l.coincide(i);if(c.equals(a))this.lt.hide();else{var s=o.sectionSumWidth(a.sci,a.eci),u=n.sectionSumHeight(a.sri,a.eri),f=n.sectionSumHeight(i.sri,a.sri-1),h=o.sectionSumWidth(i.sci,a.sci-1);l.eci>i.eci?this.lt.areaEl.css("border-right","none"):this.lt.areaEl.cssRemoveKeys("border-right"),l.eri>i.eri?this.lt.areaEl.css("border-bottom","none"):this.lt.areaEl.cssRemoveKeys("border-bottom"),this.lt.offset({width:s,height:u,left:h,top:f}).show()}}},{key:"setTOffset",value:function(t){var e=this.screen.table,r=e.fixedTop,o=e.cols,n=e.rows,i=r.getScrollViewRange(),l=t.rect,c=new Na(-1,-1,-1,-1),a=l.coincide(i);if(c.equals(a))this.t.hide();else{var s=o.sectionSumWidth(a.sci,a.eci),u=n.sectionSumHeight(a.sri,a.eri),f=n.sectionSumHeight(i.sri,a.sri-1),h=o.sectionSumWidth(i.sci,a.sci-1);l.sci<i.sci?this.t.areaEl.css("border-left","none"):this.t.areaEl.cssRemoveKeys("border-left"),l.eri>i.eri?this.t.areaEl.css("border-bottom","none"):this.t.areaEl.cssRemoveKeys("border-bottom"),l.eci>i.eci?this.t.areaEl.css("border-right","none"):this.t.areaEl.cssRemoveKeys("border-right"),this.t.offset({width:s,height:u,left:h,top:f}).show()}}},{key:"setLOffset",value:function(t){var e=this.screen.table,r=e.fixedLeft,o=e.cols,n=e.rows,i=r.getScrollViewRange(),l=t.rect,c=new Na(-1,-1,-1,-1),a=l.coincide(i);if(c.equals(a))this.l.hide();else{var s=o.sectionSumWidth(a.sci,a.eci),u=n.sectionSumHeight(a.sri,a.eri),f=n.sectionSumHeight(i.sri,a.sri-1),h=o.sectionSumWidth(i.sci,a.sci-1);l.sri<i.sri?this.l.areaEl.css("border-top","none"):this.l.areaEl.cssRemoveKeys("border-top"),l.eci>i.eci?this.l.areaEl.css("border-right","none"):this.l.areaEl.cssRemoveKeys("border-right"),l.eri>i.eri?this.l.areaEl.css("border-bottom","none"):this.l.areaEl.cssRemoveKeys("border-bottom"),this.l.offset({width:s,height:u,left:h,top:f}).show()}}},{key:"setBROffset",value:function(t){var e=this.screen.table,r=e.cols,o=e.rows,n=e.getScrollViewRange(),i=t.rect,l=new Na(-1,-1,-1,-1),c=i.coincide(n);if(l.equals(c))this.br.hide();else{var a=r.sectionSumWidth(c.sci,c.eci),s=o.sectionSumHeight(c.sri,c.eri),u=o.sectionSumHeight(n.sri,c.sri-1),f=r.sectionSumWidth(n.sci,c.sci-1);i.sci<n.sci?this.br.areaEl.css("border-left","none"):this.br.areaEl.cssRemoveKeys("border-left"),i.sri<n.sri?this.br.areaEl.css("border-top","none"):this.br.areaEl.cssRemoveKeys("border-top"),i.eri>n.eri?this.br.areaEl.css("border-bottom","none"):this.br.areaEl.cssRemoveKeys("border-bottom"),i.eci>n.eci?this.br.areaEl.css("border-right","none"):this.br.areaEl.cssRemoveKeys("border-right"),this.br.offset({width:a,height:s,left:f,top:u}).show()}}},{key:"setOffset",value:function(t){this.setLTOffset(t),this.setTOffset(t),this.setLOffset(t),this.setBROffset(t)}},{key:"getMoveAutoFillAttr",value:function(t,e){var r=this.screen,o=this.screenSelector,n=r.table,i=o.selectorAttr,l=n.cols,c=n.rows,a=n.merges,s=i.rect,u=i.edge,f=i.edgeType,h=u||a.intersects(s),d=Rf(s.size(),2),p=d[0],y=d[1],b=n.getRiCiByXy(t,e),g=b.ri,w=b.ci;g<0?g=0:g>c.len&&(g=c.len-1),w<0?w=0:w>l.len&&(w=l.len-1);var v=s.sri,m=s.sci,x=s.eri,O=s.eci;"left"===f&&(O=l.len-1),"top"===f&&(x=c.len-1);var k=null,E="un";if(g<v||g>x){if(g<v)if(E="top",h){var S=v-p;if(S>=0){for(var A=v-1-g,_=1;_<=A;_+=1)_%p==0&&S-p>=0&&(S-=p);k=new Na(S,m,v-1,O)}}else k=new Na(g,m,v-1,O);if(g>x)if(E="bottom",h){var T=x+p;if(T<=c.len-1){for(var C=g-(x+1),P=1;P<=C;P+=1)P%p==0&&T+p<=c.len-1&&(T+=p);k=new Na(x+1,m,T,O)}}else k=new Na(x+1,m,g,O)}else if(w<m||w>O){if(w<m)if(E="left",h){var j=m-y;if(j>=0){for(var W=m-1-w,L=1;L<=W;L+=1)L%y==0&&j-y>=0&&(j-=y);k=new Na(v,j,x,m-1)}}else k=new Na(v,w,x,m-1);if(w>O)if(E="right",h){var R=O+y;if(R<=l.len-1){for(var D=w-(O+1),I=1;I<=D;I+=1)I%y==0&&R+y<=l.len-1&&(R+=y);k=new Na(v,O+1,x,R)}}else k=new Na(v,O+1,x,w)}if(null!==k){var V=l.sectionSumWidth(k.sci,k.eci),H=c.sectionSumHeight(k.sri,k.eri);return k.w=V,k.h=H,{rect:k,direction:E}}return null}},{key:"mergeCellForceSplit",value:function(){for(var t=this.screen,e=this.screenSelector,r=t.table.merges,o=this.autoFillAttr,n=e.selectorAttr,i=o.rect,l=n.rect,c=l.sri,a=i.sri;a<=i.eri;){for(var s=l.sci,u=i.sci;u<=i.eci;){var f=new Na(a,u,a,u),h=r.getFirstIncludes(a,u);h&&l.intersects(h)||r.deleteIntersects(f),u+=1,(s+=1)>l.eci&&(s=l.sci)}a+=1,(c+=1)>l.eri&&(c=l.sri)}}},{key:"copyContent",value:function(){for(var t=0,e=this.screen,r=this.screenSelector,o=e.table,n=o.cells,i=o.tableDataSnapshot.cellDataProxy,l=this.autoFillAttr,c=r.selectorAttr,a=l.rect,s=c.rect,u=s.sri,f=a.sri;f<=a.eri;){for(var h=s.sci,d=a.sci;d<=a.eci;){var p=n.getCell(u,h);if(p){var y=p.clone();i.setCell(f,d,y),k.isBlank(p.text)||(t+=1)}d+=1,(h+=1)>s.eci&&(h=s.sci)}f+=1,(u+=1)>s.eri&&(u=s.sri)}return t}},{key:"copyMerge",value:function(){var t=this.screen,e=this.screenSelector,r=t.table,o=r.merges,n=r.tableDataSnapshot.mergeDataProxy,i=this.autoFillAttr,l=e.selectorAttr,c=i.rect,a=i.direction,s=l.rect,u=l.edge,f=s.sri,h=c.sri;if(!u||"top"!==a&&"left"!==a)for(;h<=c.eri;){for(var d=s.sci,p=c.sci;p<=c.eci;){var y=o.getFirstIncludes(f,d);if(y&&y.sri===f&&y.sci===d){var b=Rf(y.size(),2),g=b[0],w=b[1],v=new Na(h,p,h+(g-=1),p+(w-=1));o.intersects(v)||n.addMerge(v)}p+=1,(d+=1)>s.eci&&(d=s.sci)}h+=1,(f+=1)>s.eri&&(f=s.sri)}}},{key:"autoFillTo",value:function(){var t=this.screen,e=this.options.mergeForceSplit,r=t.table.merges,o=this.autoFillAttr.rect,n=r.getFirstIncludes(o.sri,o.sci);if(n&&n.equals(o)){this.options.onBeforeAutoFill(),this.mergeCellForceSplit();var i=this.copyContent();this.copyMerge(),this.options.onAfterAutoFill(i)}else{if(r.intersects(o)&&!1===e)return void alert("此操作要求合并单元格都具有相同大小");this.options.onBeforeAutoFill(),this.mergeCellForceSplit();var l=this.copyContent();this.copyMerge(),this.options.onAfterAutoFill(l)}}}])&&Df(r.prototype,n),i&&Df(r,i),e}(Va);function Nf(t){return(Nf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zf(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Bf(t,e){return!e||"object"!==Nf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yf(t){return(Yf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ff(t,e){return(Ff=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Uf=function(t){function e(t){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Bf(this,Yf(e).call(this,"".concat(n,"-table-x-height-light")))).table=t;var o=t.settings.index;return r.css("height","".concat(o.height,"px")),r}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ff(t,e)}(e,t),r=e,(i=[{key:"onAttach",value:function(){this.bind(),this.hide()}},{key:"disjoint",value:function(t,e){return t.sci>e.eci||e.sci>t.eci}},{key:"coincide",value:function(t,e){return this.disjoint(t,e)?new Na(0,-1,0,-1):new Na(0,e.sci>t.sci?e.sci:t.sci,0,e.eci<t.eci?e.eci:t.eci)}},{key:"offsetHeightLight",value:function(t,e){var r=this.table,o=r.settings.index,n=new Na(0,-1,0,-1);switch(this.hide(),e){case"lt":var i=t.rect,l=r.frozenLeftTop,c=r.cols,a=l.getScrollViewRange(),s=this.coincide(i,a);if(!n.equals(s)){var u=c.sectionSumWidth(s.sci,s.eci),f=c.sectionSumWidth(a.sci,s.sci-1)+o.width;"".concat(u,"px")!==this.css("width")&&this.css("width","".concat(u,"px")),"".concat(f,"px")!==this.css("left")&&this.css("left","".concat(f,"px")),this.show()}break;case"t":var h=t.rect,d=r.fixedTop,p=r.cols,y=d.getScrollViewRange(),b=this.coincide(h,y);if(!n.equals(b)){var g=p.sectionSumWidth(b.sci,b.eci),w=p.sectionSumWidth(y.sci,b.sci-1)+r.getFixedWidth()+o.width;"".concat(g,"px")!==this.css("width")&&this.css("width","".concat(g,"px")),"".concat(w,"px")!==this.css("left")&&this.css("left","".concat(w,"px")),this.show()}break;case"br":var v=t.rect,m=r.cols,x=r.getScrollViewRange(),O=this.coincide(v,x);if(!n.equals(O)){var k=m.sectionSumWidth(O.sci,O.eci),E=m.sectionSumWidth(x.sci,O.sci-1)+r.getFixedWidth()+o.width;"".concat(k,"px")!==this.css("width")&&this.css("width","".concat(k,"px")),"".concat(E,"px")!==this.css("left")&&this.css("left","".concat(E,"px")),this.show()}break;case"l":var S=t.rect,A=r.fixedLeft,_=r.cols,T=A.getScrollViewRange(),C=this.coincide(S,T);if(!n.equals(C)){var P=_.sectionSumWidth(C.sci,C.eci),j=_.sectionSumWidth(T.sci,C.sci-1)+o.width;"".concat(P,"px")!==this.css("width")&&this.css("width","".concat(P,"px")),"".concat(j,"px")!==this.css("left")&&this.css("left","".concat(j,"px")),this.show()}break;case"ltt":var W=t.rect,L=r.frozenLeftTop,R=r.fixedTop,D=r.cols,I=L.getScrollViewRange(),V=R.getScrollViewRange(),H=this.coincide(W,I),M=this.coincide(W,V),N=0,z=D.sectionSumWidth(I.sci,H.sci-1)+o.width;n.equals(H)||(N+=D.sectionSumWidth(H.sci,H.eci)),n.equals(M)||(N+=D.sectionSumWidth(M.sci,M.eci)),"".concat(N,"px")!==this.css("width")&&this.css("width","".concat(N,"px")),"".concat(z,"px")!==this.css("left")&&this.css("left","".concat(z,"px")),this.show();break;case"ltl":var B=t.rect,Y=r.frozenLeftTop,F=r.cols,U=Y.getScrollViewRange(),X=this.coincide(B,U);if(!n.equals(X)){var G=F.sectionSumWidth(X.sci,X.eci),K=F.sectionSumWidth(U.sci,X.sci-1)+o.width;"".concat(G,"px")!==this.css("width")&&this.css("width","".concat(G,"px")),"".concat(K,"px")!==this.css("left")&&this.css("left","".concat(K,"px")),this.show()}break;case"tbr":var q=t.rect,$=r.fixedTop,Z=r.cols,J=$.getScrollViewRange(),Q=this.coincide(q,J);if(!n.equals(Q)){var tt=Z.sectionSumWidth(Q.sci,Q.eci),et=Z.sectionSumWidth(J.sci,Q.sci-1)+r.getFixedWidth()+o.width;"".concat(tt,"px")!==this.css("width")&&this.css("width","".concat(tt,"px")),"".concat(et,"px")!==this.css("left")&&this.css("left","".concat(et,"px")),this.show()}break;case"lbr":var rt=t.rect,ot=r.fixedLeft,nt=r.cols,it=ot.getScrollViewRange(),lt=r.getScrollViewRange(),ct=this.coincide(rt,it),at=this.coincide(rt,lt),st=0,ut=nt.sectionSumWidth(it.sci,ct.sci-1)+o.width;n.equals(ct)||(st+=nt.sectionSumWidth(ct.sci,ct.eci)),n.equals(at)||(st+=nt.sectionSumWidth(at.sci,at.eci)),"".concat(st,"px")!==this.css("width")&&this.css("width","".concat(st,"px")),"".concat(ut,"px")!==this.css("left")&&this.css("left","".concat(ut,"px")),this.show();break;case"lttlbr":var ft=t.rect,ht=r.frozenLeftTop,dt=r.fixedTop,pt=r.cols,yt=ht.getScrollViewRange(),bt=dt.getScrollViewRange(),gt=this.coincide(ft,yt),wt=this.coincide(ft,bt),vt=0,mt=pt.sectionSumWidth(yt.sci,gt.sci-1)+o.width;n.equals(gt)||(vt+=pt.sectionSumWidth(gt.sci,gt.eci)),n.equals(wt)||(vt+=pt.sectionSumWidth(wt.sci,wt.eci)),"".concat(vt,"px")!==this.css("width")&&this.css("width","".concat(vt,"px")),"".concat(mt,"px")!==this.css("left")&&this.css("left","".concat(mt,"px")),this.show()}}},{key:"bind",value:function(){var t=this,e=this.table,r=e.screenSelector;r.on(os.CHANGE,(function(){var e=r.selectorAttr;if(e){var o=r.getIntersectsArea(e);t.offsetHeightLight(e,o)}})),Rt.bind(e,o.SYSTEM_EVENT_TYPE.SCROLL,(function(){var e=r.selectorAttr;if(e){var o=r.getIntersectsArea(e);t.offsetHeightLight(e,o)}}))}}])&&zf(r.prototype,i),l&&zf(r,l),e}(L);function Xf(t){return(Xf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gf(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Kf(t,e){return!e||"object"!==Xf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qf(t){return(qf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $f(t,e){return($f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zf=function(t){function e(t){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Kf(this,qf(e).call(this,"".concat(n,"-table-y-height-light")))).table=t;var o=t.settings.index;return r.css("width","".concat(o.width,"px")),r}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$f(t,e)}(e,t),r=e,(i=[{key:"onAttach",value:function(){this.bind(),this.hide()}},{key:"disjoint",value:function(t,e){return t.sri>e.eri||e.sri>t.eri}},{key:"coincide",value:function(t,e){return this.disjoint(t,e)?new Na(-1,0,-1,0):new Na(e.sri>t.sri?e.sri:t.sri,0,e.eri<t.eri?e.eri:t.eri,0)}},{key:"offsetHeightLight",value:function(t,e){var r=this.table,o=r.settings.index,n=new Na(-1,0,-1,0);switch(this.hide(),e){case"lt":var i=t.rect,l=r.frozenLeftTop,c=r.rows,a=l.getScrollViewRange(),s=this.coincide(i,a);if(!n.equals(s)){var u=c.sectionSumHeight(s.sri,s.eri),f=c.sectionSumHeight(a.sri,s.sri-1)+o.height;"".concat(u,"px")!==this.css("height")&&this.css("height","".concat(u,"px")),"".concat(f,"px")!==this.css("top")&&this.css("top","".concat(f,"px")),this.show()}break;case"t":var h=t.rect,d=r.fixedTop,p=r.rows,y=d.getScrollViewRange(),b=this.coincide(h,y);if(!n.equals(b)){var g=p.sectionSumHeight(b.sri,b.eri),w=p.sectionSumHeight(y.sri,b.sri-1)+o.height;"".concat(g,"px")!==this.css("height")&&this.css("height","".concat(g,"px")),"".concat(w,"px")!==this.css("top")&&this.css("top","".concat(w,"px")),this.show()}break;case"l":var v=t.rect,m=r.fixedLeft,x=r.rows,O=m.getScrollViewRange(),k=this.coincide(v,O);if(!n.equals(k)){var E=x.sectionSumHeight(k.sri,k.eri),S=x.sectionSumHeight(O.sri,k.sri-1)+r.getFixedHeight()+o.height;"".concat(E,"px")!==this.css("height")&&this.css("height","".concat(E,"px")),"".concat(S,"px")!==this.css("top")&&this.css("top","".concat(S,"px")),this.show()}break;case"br":var A=t.rect,_=r.rows,T=r.getScrollViewRange(),C=this.coincide(A,T);if(!n.equals(C)){var P=_.sectionSumHeight(C.sri,C.eri),j=_.sectionSumHeight(T.sri,C.sri-1)+r.getFixedHeight()+o.height;"".concat(P,"px")!==this.css("height")&&this.css("height","".concat(P,"px")),"".concat(j,"px")!==this.css("top")&&this.css("top","".concat(j,"px")),this.show()}break;case"ltt":var W=t.rect,L=r.frozenLeftTop,R=r.rows,D=L.getScrollViewRange(),I=this.coincide(W,D);if(!n.equals(I)){var V=R.sectionSumHeight(D.sri,I.sri-1)+o.height,H=R.sectionSumHeight(I.sri,I.eri);"".concat(H,"px")!==this.css("height")&&this.css("height","".concat(H,"px")),"".concat(V,"px")!==this.css("top")&&this.css("top","".concat(V,"px")),this.show()}break;case"ltl":var M=t.rect,N=r.frozenLeftTop,z=r.fixedLeft,B=r.rows,Y=N.getScrollViewRange(),F=z.getScrollViewRange(),U=this.coincide(M,Y),X=this.coincide(M,F),G=B.sectionSumHeight(Y.sri,U.sri-1)+o.height,K=0;n.equals(U)||(K+=B.sectionSumHeight(U.sri,U.eri)),n.equals(X)||(K+=B.sectionSumHeight(X.sri,X.eri)),"".concat(K,"px")!==this.css("height")&&this.css("height","".concat(K,"px")),"".concat(G,"px")!==this.css("top")&&this.css("top","".concat(G,"px")),this.show();break;case"tbr":var q=t.rect,$=r.fixedTop,Z=r.rows,J=$.getScrollViewRange(),Q=r.getScrollViewRange(),tt=this.coincide(q,J),et=this.coincide(q,Q),rt=Z.sectionSumHeight(J.sri,tt.sri-1)+o.height,ot=0;n.equals(tt)||(ot+=Z.sectionSumHeight(tt.sri,tt.eri)),n.equals(et)||(ot+=Z.sectionSumHeight(et.sri,et.eri)),"".concat(ot,"px")!==this.css("height")&&this.css("height","".concat(ot,"px")),"".concat(rt,"px")!==this.css("top")&&this.css("top","".concat(rt,"px")),this.show();break;case"lbr":var nt=t.rect,it=r.fixedLeft,lt=r.rows,ct=it.getScrollViewRange(),at=this.coincide(nt,ct);if(!n.equals(at)){var st=lt.sectionSumHeight(at.sri,at.eri),ut=lt.sectionSumHeight(ct.sri,at.sri-1)+r.getFixedHeight()+o.height;"".concat(st,"px")!==this.css("height")&&this.css("height","".concat(st,"px")),"".concat(ut,"px")!==this.css("top")&&this.css("top","".concat(ut,"px")),this.show()}break;case"lttlbr":var ft=t.rect,ht=r.frozenLeftTop,dt=r.fixedLeft,pt=r.rows,yt=ht.getScrollViewRange(),bt=dt.getScrollViewRange(),gt=this.coincide(ft,yt),wt=this.coincide(ft,bt),vt=0,mt=pt.sectionSumHeight(yt.sri,gt.sri-1)+o.height;n.equals(gt)||(vt+=pt.sectionSumHeight(gt.sri,gt.eri)),n.equals(wt)||(vt+=pt.sectionSumHeight(wt.sri,wt.eri)),"".concat(vt,"px")!==this.css("height")&&this.css("height","".concat(vt,"px")),"".concat(mt,"px")!==this.css("top")&&this.css("top","".concat(mt,"px")),this.show()}}},{key:"bind",value:function(){var t=this,e=this.table,r=e.screenSelector;r.on(os.CHANGE,(function(){var e=r.selectorAttr;if(e){var o=r.getIntersectsArea(e);t.offsetHeightLight(e,o)}})),Rt.bind(e,o.SYSTEM_EVENT_TYPE.SCROLL,(function(){var e=r.selectorAttr;if(e){var o=r.getIntersectsArea(e);t.offsetHeightLight(e,o)}}))}}])&&Gf(r.prototype,i),l&&Gf(r,l),e}(L);function Jf(t){return(Jf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qf(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function th(t,e){return!e||"object"!==Jf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function eh(t){return(eh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rh(t,e){return(rh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var oh=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=th(this,eh(e).call(this,"".concat(n,"-table-edit")))).input=_("div","".concat(n,"-table-edit-input")),r.input.attr("contenteditable",!0),r.input.html("<p>&nbsp;</p>"),r.table=t,r.text="",r.select=null,r.children(r.input),r}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rh(t,e)}(e,t),r=e,(i=[{key:"onAttach",value:function(){this.bind(),this.hide()}},{key:"bind",value:function(){var t=this,e=this.table,r=e.screenSelector;Rt.bind(this.input,o.SYSTEM_EVENT_TYPE.INPUT,(function(){var e=t.input;k.isBlank(t.input.text())&&e.html("<p>&nbsp;</p>"),t.text=e.text()})),Rt.bind(e,o.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.hideEdit()})),Rt.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.hideEdit()})),Rt.dbClick([r.lt,r.t,r.l,r.br],(function(){t.showEdit()}))}},{key:"showEdit",value:function(){var t=this.table,e=this.input,r=t.screen,o=t.cells,n=r.findByClass(ns).selectorAttr;if(n){var i=n.rect,l=o.getCellOrNew(i.sri,i.sci);this.select=i,this.editOffset(i),this.text=l.text,k.isBlank(this.text)?e.html("<p>&nbsp;</p>"):e.text(this.text),k.keepLastIndex(this.input.el)}}},{key:"hideEdit",value:function(){var t=this.select,e=this.table,r=e.cells,o=e.tableDataSnapshot,n=o.cellDataProxy;if(t){var i=r.getCellOrNew(t.sri,t.sci).clone(),l=k.trim(this.text);i.text!==l&&(o.begin(),i.text=l,n.setCell(t.sri,t.sci,i),o.end(),e.render()),this.select=null}this.hide()}},{key:"editOffset",value:function(){var t=this.table,e=t.screen.findByClass(ns),r=e.selectorAttr,o=r.rect,n=t.cols,i=t.rows;switch(e.getIntersectsArea(r)){case"lt":var l=t.frozenLeftTop.getScrollViewRange(),c=o.coincide(l);if(new Na(-1,-1,-1,-1).equals(c))return void this.hide();var a=n.sectionSumWidth(c.sci,c.eci)-6,s=i.sectionSumHeight(c.sri,c.eri)-6,u=i.sectionSumHeight(l.sri,c.sri-1),f=n.sectionSumWidth(l.sci,c.sci-1);u+=t.getIndexHeight()+3,f+=t.getIndexWidth()+3,this.offset({width:a,height:s,top:u,left:f}).show();break;case"t":var h=t.fixedTop.getScrollViewRange(),d=o.coincide(h);if(new Na(-1,-1,-1,-1).equals(d))return void this.hide();var p=n.sectionSumWidth(d.sci,d.eci)-6,y=i.sectionSumHeight(d.sri,d.eri)-6,b=i.sectionSumHeight(h.sri,d.sri-1),g=n.sectionSumWidth(h.sci,d.sci-1);b+=t.getIndexHeight()+3,g+=t.getFixedWidth()+t.getIndexWidth()+3,this.offset({width:p,height:y,top:b,left:g}).show();break;case"br":var w=t.getScrollViewRange(),v=o.coincide(w);if(new Na(-1,-1,-1,-1).equals(v))return void this.hide();var m=n.sectionSumWidth(v.sci,v.eci)-6,x=i.sectionSumHeight(v.sri,v.eri)-6,O=i.sectionSumHeight(w.sri,v.sri-1),k=n.sectionSumWidth(w.sci,v.sci-1);O+=t.getFixedHeight()+t.getIndexHeight()+3,k+=t.getFixedWidth()+t.getIndexWidth()+3,this.offset({width:m,height:x,top:O,left:k}).show();break;case"l":var E=t.fixedLeft.getScrollViewRange(),S=o.coincide(E);if(new Na(-1,-1,-1,-1).equals(S))return void this.hide();var A=n.sectionSumWidth(S.sci,S.eci)-6,_=i.sectionSumHeight(S.sri,S.eri)-6,T=i.sectionSumHeight(E.sri,S.sri-1),C=n.sectionSumWidth(E.sci,S.sci-1);T+=t.getFixedHeight()+t.getIndexHeight()+3,C+=t.getIndexWidth()+3,this.offset({width:A,height:_,top:T,left:C}).show();break;case"ltt":var P=t.frozenLeftTop,j=t.fixedTop,W=P.getScrollViewRange(),L=o.coincide(W),R=j.getScrollViewRange(),D=o.coincide(R),I=new Na(-1,-1,-1,-1);if(I.equals(D)&&I.equals(L))return void this.hide();var V=n.sectionSumWidth(L.sci,L.eci),H=i.sectionSumHeight(L.sri,L.eri),M=i.sectionSumHeight(W.sri,L.sri-1),N=n.sectionSumWidth(W.sci,L.sci-1),z=n.sectionSumWidth(D.sci,D.eci);this.offset({width:V+z-6,height:H-6,top:M+t.getIndexHeight()+3,left:N+t.getIndexWidth()+3}).show();break;case"ltl":var B=t.frozenLeftTop,Y=t.fixedLeft,F=B.getScrollViewRange(),U=o.coincide(F),X=Y.getScrollViewRange(),G=o.coincide(X),K=new Na(-1,-1,-1,-1);if(K.equals(U)&&K.equals(G))return void this.hide();var q=n.sectionSumWidth(U.sci,U.eci),$=i.sectionSumHeight(U.sri,U.eri),Z=i.sectionSumHeight(G.sri,G.eri),J=i.sectionSumHeight(F.sri,U.sri-1),Q=n.sectionSumWidth(F.sci,U.sci-1);J+=t.getIndexHeight()+3,Q+=t.getIndexWidth()+3,this.offset({width:q-6,height:$+Z-6,top:J,left:Q}).show();break;case"tbr":var tt=t.fixedTop,et=t.getScrollViewRange(),rt=o.coincide(et),ot=tt.getScrollViewRange(),nt=o.coincide(ot),it=new Na(-1,-1,-1,-1);if(it.equals(rt)&&it.equals(nt))return void this.hide();var lt=n.sectionSumWidth(nt.sci,nt.eci),ct=i.sectionSumHeight(nt.sri,nt.eri),at=i.sectionSumHeight(ot.sri,nt.sri-1),st=n.sectionSumWidth(ot.sci,nt.sci-1),ut=i.sectionSumHeight(rt.sri,rt.eri);this.offset({width:lt-6,height:ut+ct-6,top:at+t.getIndexHeight()+3,left:st+t.getFixedWidth()+t.getIndexWidth()+3}).show();break;case"lbr":var ft=t.fixedLeft,ht=t.getScrollViewRange(),dt=o.coincide(ht),pt=ft.getScrollViewRange(),yt=o.coincide(pt),bt=new Na(-1,-1,-1,-1);if(bt.equals(dt)&&bt.equals(yt))return void this.hide();var gt=n.sectionSumWidth(yt.sci,yt.eci),wt=i.sectionSumHeight(yt.sri,yt.eri),vt=i.sectionSumHeight(pt.sri,yt.sri-1),mt=n.sectionSumWidth(pt.sci,yt.sci-1),xt=n.sectionSumWidth(dt.sci,dt.eci);this.offset({width:gt+xt-6,height:wt-6,top:vt+t.getFixedHeight()+t.getIndexHeight()+3,left:mt+t.getIndexWidth()+3}).show();break;case"lttlbr":var Ot=t.frozenLeftTop.getScrollViewRange(),kt=o.coincide(Ot),Et=t.fixedTop.getScrollViewRange(),St=o.coincide(Et),At=t.fixedLeft.getScrollViewRange(),_t=o.coincide(At),Tt=new Na(-1,-1,-1,-1);if(Tt.equals(kt)&&Tt.equals(St)&&Tt.equals(_t))return void this.hide();var Ct=n.sectionSumWidth(kt.sci,kt.eci),Pt=i.sectionSumHeight(kt.sri,kt.eri),jt=n.sectionSumWidth(St.sci,St.eci),Wt=i.sectionSumHeight(_t.sri,_t.eri),Lt=i.sectionSumHeight(Ot.sri,kt.sri-1),Rt=n.sectionSumWidth(Ot.sci,kt.sci-1);this.offset({width:Ct+jt-6,height:Pt+Wt-6,top:Lt+t.getIndexHeight()+3,left:Rt+t.getIndexWidth()+3}).show()}}}])&&Qf(r.prototype,i),l&&Qf(r,l),e}(L);function nh(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var ih=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.draw=e,this.color="#000000",k.mergeDeep(this,r)}var e,r,o;return e=t,(r=[{key:"lineWidth",value:function(){var t=Math.floor(Pl());return t>2?t:1}},{key:"verticalLine",value:function(t,e,r,o){if(t!==r)throw new Error("coordinate errors sx should be equal to ex !!!");var n=this.draw,i=this.color,l=this.lineWidth();n.attr({fillStyle:i});var c=o-e;n.fillRect(t,e,l,c)}},{key:"horizontalLine",value:function(t,e,r,o){if(e!==o)throw new Error("coordinate errors sy should be equal to ey !!!");var n=this.draw,i=this.color,l=this.lineWidth();n.attr({fillStyle:i});var c=r-t;n.fillRect(t,e,c,l)}}])&&nh(e.prototype,r),o&&nh(e,o),t}();function lh(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var ch=function(){function t(e){var r=e.rect,o=e.draw;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.draw=o,this.rect=r,this.backgroundColor=null}var e,r,o;return e=t,(r=[{key:"drawBackgroundColor",value:function(t){if(t){this.backgroundColor=t;var e=this.draw,r=this.rect;e.attr({fillStyle:t}),e.fillRect(r.x,r.y,r.width,r.height)}}}])&&lh(e.prototype,r),o&&lh(e,o),t}();function ah(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var sh=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e}var e,r,o;return e=t,(r=[{key:"vLineRightOverFlowChecked",value:function(t,e){var r=this.table,o=r.cells,n=r.cols,i=r.merges,l=n.len,c=o.getMergeCellOrCell(e,t),a=o.getMergeCellOrCell(e,t+1);if(i.getFirstIncludes(e,t+1))return!0;var s=!0,u=!0;if(c&&!k.isBlank(c.text)){var f=c.fontAttr,h=!0;if(f.direction===Kl.ANGLE){var d=f.angle;90!==d&&-90!==d||(h=!1),f.textWrap===Gl.TRUNCATE&&(h=!1)}else f.textWrap!==Gl.OVER_FLOW&&(h=!1);var p=f.align,y=n.getWidth(t);p!==Ul.left&&p!==Ul.center&&(h=!1),h&&this.getCellContentWidth(c,t)>y&&(null===a||k.isBlank(a.text))&&(u=!1)}for(var b=n.getWidth(t-1)+n.getWidth(t),g=t-1;g>=0;g-=1,b+=n.getWidth(g)){var w=o.getCell(e,g);if(null!==w){var v=w.text;if(!k.isBlank(v)){var m=w.fontAttr;if(m.direction===Kl.ANGLE){var x=m.angle,O=m.textWrap;if(90===x||-90===x)break;if(O===Gl.TRUNCATE)break}else{if(m.textWrap!==Gl.OVER_FLOW)break;var E=m.align;if(E!==Ul.left&&E!==Ul.center)break}if(this.getCellContentWidth(w,g)>b){var S=null===c||k.isBlank(c.text),A=null===a||k.isBlank(a.text);S&&A&&(u=!1)}break}}}for(var _=n.getWidth(t+1),T=t+1;T<=l;T+=1,_+=n.getWidth(T)){var C=o.getCell(e,T);if(null!==C){var P=C.text;if(!k.isBlank(P)){var j=C.fontAttr;if(j.direction===Kl.ANGLE){var W=j.angle,L=j.textWrap;if(90===W||-90===W)break;if(L===Gl.TRUNCATE)break}else{if(j.textWrap!==Gl.OVER_FLOW)break;var R=j.align;if(R!==Ul.right&&R!==Ul.center)break}this.getCellContentWidth(C,T)>_&&(null===c||k.isBlank(c.text))&&(s=!1);break}}}return u&&s}},{key:"vLineLeftOverFlowChecked",value:function(t,e){var r=this.table,o=r.cells,n=r.cols,i=r.merges,l=n.len,c=o.getMergeCellOrCell(e,t),a=o.getMergeCellOrCell(e,t-1);if(i.getFirstIncludes(e,t-1))return!0;var s=!0,u=!0;if(c&&!k.isBlank(c.text)){var f=c.fontAttr,h=!0;if(f.direction===Kl.ANGLE){var d=f.angle;90!==d&&-90!==d||(h=!1),f.textWrap===Gl.TRUNCATE&&(h=!1)}else f.textWrap!==Gl.OVER_FLOW&&(h=!1);var p=f.align,y=n.getWidth(t);p!==Ul.right&&p!==Ul.center&&(h=!1),h&&this.getCellContentWidth(c,t)>y&&(null===a||k.isBlank(a.text))&&(u=!1)}for(var b=n.getWidth(t-1),g=t-1;g>=0;g-=1,b+=n.getWidth(g)){var w=o.getCell(e,g);if(null!==w){var v=w.text;if(!k.isBlank(v)){var m=w.fontAttr;if(m.direction===Kl.ANGLE){var x=m.angle,O=m.textWrap;if(90===x||-90===x)break;if(O===Gl.TRUNCATE)break}else{if(m.textWrap!==Gl.OVER_FLOW)break;var E=m.align;if(E!==Ul.left&&E!==Ul.center)break}this.getCellContentWidth(w,g)>b&&(null===c||k.isBlank(c.text))&&(u=!1);break}}}for(var S=n.getWidth(t+1)+n.getWidth(t),A=t+1;A<=l;A+=1,S+=n.getWidth(A)){var _=o.getCell(e,A);if(null!==_){var T=_.text;if(!k.isBlank(T)){var C=_.fontAttr;if(C.direction===Kl.ANGLE){var P=C.angle,j=C.textWrap;if(90===P||-90===P)break;if(j===Gl.TRUNCATE)break}else{if(C.textWrap!==Gl.OVER_FLOW)break;var W=C.align;if(W!==Ul.right&&W!==Ul.center)break}if(this.getCellContentWidth(_,A)>S){var L=null===c||k.isBlank(c.text),R=null===a||k.isBlank(a.text);L&&R&&(s=!1)}break}}}return u&&s}},{key:"getCellContentWidth",value:function(t,e){var r=this.table.cols.getWidth(e),o=t.contentWidth;switch(t.fontAttr.align){case Ul.right:case Ul.left:return o;case Ul.center:return r+(o-r)/2;default:return 0}}},{key:"hEach",value:function(t){for(var e=t.viewRange,r=void 0===e?new Na(0,0,0,0):e,o=t.newRow,n=void 0===o?function(){return!0}:o,i=t.filter,l=void 0===i?function(){return!0}:i,c=t.jump,a=void 0===c?function(){return!0}:c,s=t.handle,u=void 0===s?function(){return!0}:s,f=t.endRow,h=void 0===f?function(){return!0}:f,d=t.bx,p=void 0===d?0:d,y=t.by,b=void 0===y?0:y,g=this.table,w=g.cols,v=g.rows,m=r.sri,x=r.eri,O=r.sci,k=r.eci,E=b,S=m;S<=x;S+=1){var A=v.getHeight(S),_=p;n(S,E);for(var T=O;T<=k;T+=1){var C=w.getWidth(T);l(S,T,_,E)?u(S,T,_,E):a(S,T,_,E),_+=C}h(),E+=A}}},{key:"vEach",value:function(t){for(var e=t.viewRange,r=void 0===e?new Na(0,0,0,0):e,o=t.newCol,n=void 0===o?function(){return!0}:o,i=t.filter,l=void 0===i?function(){return!0}:i,c=t.jump,a=void 0===c?function(){return!0}:c,s=t.handle,u=void 0===s?function(){return!0}:s,f=t.endCol,h=void 0===f?function(){return!0}:f,d=t.bx,p=void 0===d?0:d,y=t.by,b=void 0===y?0:y,g=this.table,w=g.cols,v=g.rows,m=r.sri,x=r.eri,O=r.sci,k=r.eci,E=p,S=O;S<=k;S+=1){var A=w.getWidth(S),_=b;n(S,E);for(var T=m;T<=x;T+=1){var C=v.getHeight(T);l(S,T,E,_)?u(S,T,E,_):a(S,T,E,_),_+=C}h(),E+=A}}},{key:"viewRangeAndMergeCoincideView",value:function(t){var e=t.viewRange,r=void 0===e?new Na(0,0,0,0):e,o=this.table,n=o.merges,i=o.cols,l=o.rows,c=[],a=[];return this.hEach({viewRange:r,handle:function(t,e,o,s){var u=n.getFirstIncludes(t,e);if(u&&-1===c.indexOf(u)){c.push(u);var f=r.coincide(u),h=i.sectionSumWidth(f.sci,f.eci),d=l.sectionSumHeight(f.sri,f.eri),p=new Dl({x:o,y:s,width:h,height:d});a.push({rect:p,view:f,merge:u})}}}),a}},{key:"coincideViewBrink",value:function(t){for(var e=t.coincideView,r=this.table,o=r.cols,n=r.rows,i=[],l=0;l<e.length;l+=1){var c=e[l],a=c.view,s=c.rect,u=c.merge,f=a.brink(),h={view:f.top,x:s.x,y:s.y},d={view:f.left,x:s.x,y:s.y},p={view:f.bottom,x:s.x,y:s.y+s.height-n.rectRangeSumHeight(f.bottom)},y={view:f.right,x:s.x+s.width-o.rectRangeSumWidth(f.right),y:s.y},b={};u.sri===a.sri&&(b.top=h),u.sci===a.sci&&(b.left=d),u.eri===a.eri&&(b.bottom=p),u.eci===a.eci&&(b.right=y),i.push(b)}return i}}])&&ah(e.prototype,r),o&&ah(e,o),t}();function uh(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var fh=function(){function t(e){var r=e.table,o=e.cols,n=e.rows,i=e.data,l=void 0===i?[]:i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=r,this.cols=o,this.rows=n,this.data=l}var e,r,o;return e=t,(r=[{key:"getCell",value:function(t,e){var r=this.data[t];if(r&&r[e]){var o=r[e];return o instanceof hs?r[e]:(k.isString(o)&&(o={text:o}),r[e]=new hs(o),r[e])}return null}},{key:"getMergeCellOrCell",value:function(t,e){var r=this.table.merges.getFirstIncludes(t,e);return r?this.getCell(r.sri,r.sci):this.getCell(t,e)}},{key:"getCellOrNew",value:function(t,e){return k.isUnDef(this.data[t])&&(this.data[t]=[]),k.isUnDef(this.data[t][e])&&(this.data[t][e]={text:""}),this.getCell(t,e)}},{key:"setCell",value:function(t,e,r){var o=this.data[t];o&&o[e]&&(o[e]=r)}},{key:"setCellOrNew",value:function(t,e,r){k.isUnDef(this.data[t])&&(this.data[t]=[]),this.data[t][e]=r}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.data=t,this}}])&&uh(e.prototype,r),o&&uh(e,o),t}();function hh(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var dh=function(){function t(e){var r=e.cells,o=e.merges,n=e.rows,i=e.cols;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cells=r,this.merges=o,this.rows=n,this.cols=i}var e,r,o;return e=t,(r=[{key:"getCellTextMaxHeight",value:function(t,e){var r=this.cells,o=this.rows,n=r.getCell(t,e).fontAttr.verticalAlign,i=0,l=0;if(n===Xl.top)for(var c=t,a=o.len;c<=a;c+=1){var s=r.getCell(c,e);if(c===e)i+=o.getHeight(c);else{if(!k.isUnDef(s)&&!k.isBlank(s.text))break;i+=o.getHeight(c)}}if(n===Xl.center){for(var u=t,f=o.len;u<=f;u+=1){var h=r.getCell(u,e);if(u===e)i+=o.getHeight(u);else{if(!k.isUnDef(h)&&!k.isBlank(h.text))break;i+=o.getHeight(u)}}for(var d=t-1;d>=0;d-=1){var p=r.getCell(t,d);if(!k.isUnDef(p)&&!k.isBlank(p.text))break;var y=o.getHeight(d);i+=y,l-=y}}if(n===Xl.bottom)for(var b=t;b>=0;b-=1){var g=r.getCell(t,b);if(b===e)i+=o.getHeight(b);else{if(!k.isUnDef(g)&&!k.isBlank(g.text))break;var w=o.getHeight(b);i+=w,l-=w}}return{height:i,offset:l}}},{key:"getCellTextMaxWidth",value:function(t,e){var r=this.cells,o=this.cols,n=this.merges,i=r.getCell(t,e).fontAttr.align,l=0,c=0;if(i===Ul.left)for(var a=e,s=o.len;a<=s;a+=1){var u=r.getCell(t,a),f=n.getFirstIncludes(t,a);if(a===e)l+=o.getWidth(a);else{if(!k.isUnDef(u)&&!k.isBlank(u.text)||!k.isUnDef(f))break;l+=o.getWidth(a)}}if(i===Ul.center){for(var h=0,d=0,p=e+1,y=o.len;p<=y;p+=1){var b=r.getCell(t,p),g=n.getFirstIncludes(t,p);if(!k.isUnDef(b)&&!k.isBlank(b.text)||!k.isUnDef(g))break;h+=o.getWidth(p)}for(var w=e-1;w>=0;w-=1){var v=r.getCell(t,w),m=n.getFirstIncludes(t,w);if(!k.isUnDef(v)&&!k.isBlank(v.text)||!k.isUnDef(m))break;var x=o.getWidth(w);d+=x,c-=x}l=o.getWidth(e)+d+h}if(i===Ul.right)for(var O=e;O>=0;O-=1){var E=r.getCell(t,O),S=n.getFirstIncludes(t,O);if(O===e)l+=o.getWidth(O);else{if(!k.isUnDef(E)&&!k.isBlank(E.text)||!k.isUnDef(S))break;var A=o.getWidth(O);l+=A,c-=A}}return{width:l,offset:c}}},{key:"getCellOverFlow",value:function(t,e,r,o){var n=o.fontAttr,i=n.direction,l=n.textWrap,c=r.x,a=r.y,s=r.width,u=r.height;if(l===Gl.OVER_FLOW){if(i===Kl.VERTICAL){var f=this.getCellTextMaxHeight(t,e);return new Dl({x:c,y:a+f.offset,width:s,height:f.height})}var h=this.getCellTextMaxWidth(t,e);return new Dl({x:c+h.offset,y:a,width:h.width,height:u})}return null}},{key:"getCellByViewRange",value:function(t){for(var e=t.rectRange,r=t.callback,o=t.startX,n=void 0===o?0:o,i=t.startY,l=void 0===i?0:i,c=this.rows,a=this.cols,s=this.cells,u=e.sri,f=e.eri,h=e.sci,d=e.eci,p=l,y=u;y<=f;y+=1){for(var b=c.getHeight(y),g=n,w=h;w<=d;w+=1){var v=a.getWidth(w),m=s.getCell(y,w);if(m){var x=new Dl({x:g,y:p,width:v,height:b});if(!1===r(y,w,m,x,this.getCellOverFlow(y,w,x,m)))return}g+=v}p+=b}}},{key:"getCellOrNewCellByViewRange",value:function(t){for(var e=t.rectRange,r=t.callback,o=t.startX,n=void 0===o?0:o,i=t.startY,l=void 0===i?0:i,c=this.rows,a=this.cols,s=this.cells,u=e.sri,f=e.eri,h=e.sci,d=e.eci,p=l,y=u;y<=f;y+=1){for(var b=c.getHeight(y),g=n,w=h;w<=d;w+=1){var v=a.getWidth(w),m=s.getCellOrNew(y,w),x=new Dl({x:g,y:p,width:v,height:b});if(!1===r(y,w,m,x,this.getCellOverFlow(y,w,x,m)))return;g+=v}p+=b}}},{key:"getMergeCellByViewRange",value:function(t){for(var e=t.rectRange,r=t.callback,o=t.startX,n=void 0===o?0:o,i=t.startY,l=void 0===i?0:i,c=this.rows,a=this.cols,s=this.cells,u=this.merges,f=e.sri,h=e.eri,d=e.sci,p=e.eci,y=[],b=f;b<=h;b+=1)for(var g=function(t){var o=u.getFirstIncludes(b,t);if(o&&!y.find((function(t){return t===o}))){y.push(o);var i=s.getCellOrNew(o.sri,o.sci),f=a.sectionSumWidth(o.sci,o.eci),h=c.sectionSumHeight(o.sri,o.eri),d=Math.min(e.sri,o.sri),p=Math.min(e.sci,o.sci),g=Math.max(e.sri,o.sri),w=Math.max(e.sci,o.sci);g-=1,w-=1;var v=a.sectionSumWidth(p,w),m=c.sectionSumHeight(d,g);v=e.sci>o.sci?-1*v:v,m=e.sri>o.sri?-1*m:m;var x=new Dl({x:v+=n,y:m+=l,width:f,height:h});r(x,i)}},w=d;w<=p;w+=1)g(w)}},{key:"getCellSkipMergeCellByViewRange",value:function(t){var e=t.rectRange,r=t.callback,o=t.startX,n=void 0===o?0:o,i=t.startY,l=void 0===i?0:i,c=this.merges;this.getCellByViewRange({rectRange:e,callback:function(t,e,o,n,i){null===c.getFirstIncludes(t,e)&&r(t,e,o,n,i)},startX:n,startY:l})}}])&&hh(e.prototype,r),o&&hh(e,o),t}();function ph(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var yh=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e}var e,r,o;return e=t,(r=[{key:"vLineBorderChecked",value:function(t,e){var r=this.table.cells,o=r.getMergeCellOrCell(e,t),n=r.getMergeCellOrCell(e,t+1);return o&&n?!(o.borderAttr.right.display||n.borderAttr.left.display):o?!o.borderAttr.right.display:!n||!n.borderAttr.left.display}},{key:"hLineBorderChecked",value:function(t,e){var r=this.table.cells,o=r.getMergeCellOrCell(t,e),n=r.getMergeCellOrCell(t+1,e);return o&&n?!(o.borderAttr.bottom.display||n.borderAttr.top.display):o?!o.borderAttr.bottom.display:!n||!n.borderAttr.top.display}},{key:"gridHLine",value:function(t){var e,r,o,n,i,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},s=this.table,u=s.lineHandle,f=s.cols,h=s.rows,d=[];return u.hEach({viewRange:t,newRow:function(t,a){var s=h.getHeight(t);o=e=l,n=r=c+a+s,i=!1},filter:a,jump:function(t,l){i&&(i=!1,d.push({sx:e,sy:r,ex:o,ey:n}));var c=f.getWidth(l);o=e=o+c},handle:function(t,e){i=!0;var r=f.getWidth(e);o+=r},endRow:function(){i&&d.push({sx:e,sy:r,ex:o,ey:n})}}),d}},{key:"gridVLine",value:function(t){var e,r,o,n,i,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},s=this.table,u=s.lineHandle,f=s.cols,h=s.rows,d=[];return u.vEach({viewRange:t,newCol:function(t,a){var s=f.getWidth(t);o=e=l+a+s,n=r=c,i=!1},filter:a,jump:function(t,l){i&&(i=!1,d.push({sx:e,sy:r,ex:o,ey:n}));var c=h.getHeight(l);n=r=n+c},handle:function(t,e){i=!0;var r=h.getHeight(e);n+=r},endCol:function(){i&&d.push({sx:e,sy:r,ex:o,ey:n})}}),d}},{key:"hLine",value:function(t){var e=this,r=this.table.merges;return this.gridHLine(t,0,0,(function(t,o){return!r.getFirstIncludes(t,o)&&e.hLineBorderChecked(t,o)}))}},{key:"vLine",value:function(t){var e=this,r=this.table,o=r.merges,n=r.lineHandle;return this.gridVLine(t,0,0,(function(t,r){return!o.getFirstIncludes(r,t)&&!1!==e.vLineBorderChecked(t,r)&&n.vLineRightOverFlowChecked(t,r)}))}},{key:"hMergeLine",value:function(t){for(var e=this,r=[],o=0;o<t.length;o+=1){var n=t[o].bottom;if(n){var i=n.view,l=n.x,c=n.y,a=this.gridHLine(i,l,c,(function(t,r){return e.hLineBorderChecked(t,r)}));r=r.concat(a)}}return r}},{key:"vMergeLine",value:function(t){for(var e=this,r=[],o=0;o<t.length;o+=1){var n=t[o].right;if(n){var i=n.view,l=n.x,c=n.y,a=this.gridVLine(i,l,c,(function(t,r){return e.vLineBorderChecked(t,r)}));r=r.concat(a)}}return r}}])&&ph(e.prototype,r),o&&ph(e,o),t}();function bh(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var gh=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.drawOptimization=!0,this.borderOptimization=!0}var e,r,o;return e=t,(r=[{key:"borderHTLine",value:function(t){var e,r,o,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},a=this.table,s=this.drawOptimization,u=a.lineHandle,f=a.cols,h=a.cells,d=[];if(u.hEach({viewRange:t,newRow:function(t,c){o=e=i,n=r=l+c},filter:c,jump:function(t,r){var n=f.getWidth(r);o=e=o+n},handle:function(t,i){var l=f.getWidth(i),c=h.getCell(t,i).borderAttr;o+=l,d.push({sx:e,sy:r,ex:o,ey:n,row:t,col:i,borderAttr:c}),e=o}}),s)for(var p=1;p<d.length;){var y=d[p],b=d[p-1],g=y.borderAttr.top.equal(b.borderAttr.top),w=y.col-b.col==1,v=y.row===b.row;g&&w&&v?(b.ex=y.ex,b.col=y.col,d.splice(p,1)):p+=1}return d}},{key:"borderHBLine",value:function(t){var e,r,o,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},a=this.table,s=this.drawOptimization,u=a.lineHandle,f=a.cols,h=a.rows,d=a.cells,p=[];if(u.hEach({viewRange:t,newRow:function(t,c){var a=h.getHeight(t);o=e=i,n=r=l+c+a},filter:c,jump:function(t,r){var n=f.getWidth(r);o=e=o+n},handle:function(t,i){var l=f.getWidth(i),c=d.getCell(t,i).borderAttr;o+=l,p.push({sx:e,sy:r,ex:o,ey:n,row:t,col:i,borderAttr:c}),e=o}}),s)for(var y=1;y<p.length;){var b=p[y],g=p[y-1],w=b.borderAttr.bottom.equal(g.borderAttr.bottom),v=b.col-g.col==1,m=b.row===g.row;w&&v&&m?(g.ex=b.ex,g.col=b.col,p.splice(y,1)):y+=1}return p}},{key:"borderVLLine",value:function(t){var e,r,o,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},a=this.table,s=this.drawOptimization,u=a.lineHandle,f=a.rows,h=a.cells,d=[];if(u.vEach({viewRange:t,newCol:function(t,c){o=e=i+c,n=r=l},filter:c,jump:function(t,e){var o=f.getHeight(e);n=r=n+o},handle:function(t,i){var l=f.getHeight(i),c=h.getCell(i,t).borderAttr;n+=l,d.push({sx:e,sy:r,ex:o,ey:n,row:i,col:t,borderAttr:c}),r=n}}),s)for(var p=1;p<d.length;){var y=d[p],b=d[p-1],g=y.borderAttr.left.equal(b.borderAttr.left),w=y.row-b.row==1,v=y.col===b.col;g&&w&&v?(b.ey=y.ey,b.row=y.row,d.splice(p,1)):p+=1}return d}},{key:"borderVRLine",value:function(t){var e,r,o,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},a=this.table,s=this.drawOptimization,u=a.lineHandle,f=a.rows,h=a.cols,d=a.cells,p=[];if(u.vEach({viewRange:t,newCol:function(t,c){var a=h.getWidth(t);o=e=i+c+a,n=r=l},filter:c,jump:function(t,e){var o=f.getHeight(e);n=r=n+o},handle:function(t,i){var l=f.getHeight(i),c=d.getCell(i,t).borderAttr;n+=l,p.push({sx:e,sy:r,ex:o,ey:n,row:i,col:t,borderAttr:c}),r=n}}),s)for(var y=1;y<p.length;){var b=p[y],g=p[y-1],w=b.borderAttr.right.equal(g.borderAttr.right),v=b.row-g.row==1,m=b.col===g.col;w&&v&&m?(g.ey=b.ey,g.row=b.row,p.splice(y,1)):y+=1}return p}},{key:"htLine",value:function(t){var e=this.table,r=this.borderOptimization,o=e.merges,n=e.cells;return this.borderHTLine(t,0,0,(function(t,e){var i=o.getFirstIncludes(t,e),l=n.getMergeCellOrCell(t,e),c=n.getMergeCellOrCell(t-1,e);if(!l||i)return!1;if(c&&r){var a=l.borderAttr.top.display&&c.borderAttr.bottom.display,s=l.borderAttr.top.compareTime(c.borderAttr.bottom);if(a)return 1===s}return l.borderAttr.top.display}))}},{key:"hbLine",value:function(t){var e=this.table,r=this.borderOptimization,o=e.merges,n=e.cells;return this.borderHBLine(t,0,0,(function(t,e){var i=o.getFirstIncludes(t,e),l=n.getMergeCellOrCell(t,e),c=n.getMergeCellOrCell(t+1,e);if(!l||i)return!1;if(c&&r){var a=l.borderAttr.bottom.display&&c.borderAttr.top.display,s=l.borderAttr.bottom.compareTime(c.borderAttr.top);if(a)return 1===s||0===s}return l.borderAttr.bottom.display}))}},{key:"vlLine",value:function(t){var e=this.table,r=this.borderOptimization,o=e.merges,n=e.cells,i=e.lineHandle;return this.borderVLLine(t,0,0,(function(t,e){var l=o.getFirstIncludes(e,t),c=n.getMergeCellOrCell(e,t),a=n.getMergeCellOrCell(e,t-1);return!(!c||l)&&(a&&r&&c.borderAttr.left.display&&a.borderAttr.right.display?!(1!==c.borderAttr.left.compareTime(a.borderAttr.right))&&i.vLineLeftOverFlowChecked(t,e):c.borderAttr.left.display?i.vLineLeftOverFlowChecked(t,e):c.borderAttr.left.display)}))}},{key:"vrLine",value:function(t){var e=this.table,r=this.borderOptimization,o=e.merges,n=e.cells,i=e.lineHandle;return this.borderVRLine(t,0,0,(function(t,e){var l=o.getFirstIncludes(e,t),c=n.getMergeCellOrCell(e,t),a=n.getMergeCellOrCell(e,t+1);if(!c||l)return!1;if(a&&r&&c.borderAttr.right.display&&a.borderAttr.left.display){var s=c.borderAttr.right.compareTime(a.borderAttr.left);return!(1!==s&&0!==s)&&i.vLineRightOverFlowChecked(t,e)}return c.borderAttr.right.display?i.vLineRightOverFlowChecked(t,e):c.borderAttr.right.display}))}},{key:"htMergeLine",value:function(t){for(var e=this.table,r=this.borderOptimization,o=e.cells,n=[],i=0;i<t.length;i+=1){var l=t[i].top;if(l){var c=this.borderHTLine(l.view,l.x,l.y,(function(t,e){var n=o.getCell(t,e),i=o.getCell(t-1,e);if(!n)return!1;if(i&&r){var l=n.borderAttr.top.display&&i.borderAttr.bottom.display,c=n.borderAttr.top.compareTime(i.borderAttr.bottom);if(l)return 1===c}return n.borderAttr.top.display}));n=n.concat(c)}}return n}},{key:"hbMergeLine",value:function(t){for(var e=this.table,r=this.borderOptimization,o=e.cells,n=[],i=0;i<t.length;i+=1){var l=t[i].bottom;if(l){var c=this.borderHBLine(l.view,l.x,l.y,(function(t,e){var n=o.getCell(t,e),i=o.getCell(t+1,e);if(!n)return!1;if(i&&r){var l=n.borderAttr.bottom.display&&i.borderAttr.top.display,c=n.borderAttr.bottom.compareTime(i.borderAttr.top);if(l)return 1===c||0===c}return n.borderAttr.bottom.display}));n=n.concat(c)}}return n}},{key:"vlMergeLine",value:function(t){for(var e=this.table,r=this.borderOptimization,o=e.cells,n=[],i=0;i<t.length;i+=1){var l=t[i].left;if(l){var c=this.borderVLLine(l.view,l.x,l.y,(function(t,e){var n=o.getCell(e,t),i=o.getCell(e,t-1);if(!n)return!1;if(i&&r){var l=n.borderAttr.left.display&&i.borderAttr.right.display,c=n.borderAttr.left.compareTime(i.borderAttr.right);if(l)return 1===c}return n.borderAttr.left.display}));n=n.concat(c)}}return n}},{key:"vrMergeLine",value:function(t){for(var e=this.table,r=this.borderOptimization,o=e.cells,n=[],i=0;i<t.length;i+=1){var l=t[i].right;if(l){var c=this.borderVRLine(l.view,l.x,l.y,(function(t,e){var n=o.getCell(e,t),i=o.getCell(e,t+1);if(!n)return!1;if(i&&r){var l=n.borderAttr.right.display&&i.borderAttr.left.display,c=n.borderAttr.right.compareTime(i.borderAttr.left);if(l)return 1===c||0===c}return n.borderAttr.right.display}));n=n.concat(c)}}return n}},{key:"openDrawOptimization",value:function(){this.drawOptimization=!0}},{key:"closeDrawOptimization",value:function(){this.drawOptimization=!1}},{key:"openBorderOptimization",value:function(){this.borderOptimization=!0}},{key:"closeBorderOptimization",value:function(){this.borderOptimization=!1}}])&&bh(e.prototype,r),o&&bh(e,o),t}();function wh(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var vh=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.change=!1}var e,r,o;return e=t,(r=[{key:"endNotice",value:function(){this.change&&(this.change=!1)}},{key:"backNotice",value:function(){this.change&&(this.change=!1)}},{key:"goNotice",value:function(){this.change&&(this.change=!1)}}])&&wh(e.prototype,r),o&&wh(e,o),t}();function mh(t){return(mh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xh(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Oh(t,e){return!e||"object"!==mh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kh(t,e,r){return(kh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Eh(t)););return t}(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(r):n.value}})(t,e,r||t)}function Eh(t){return(Eh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sh(t,e){return(Sh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ah=function(t){function e(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{setCell:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Oh(this,Eh(e).call(this))).table=t,r.option=o,r}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sh(t,e)}(e,t),r=e,(n=[{key:"$setCell",value:function(t,e,r){this.change=!0,this.table.cells.setCellOrNew(t,e,r)}},{key:"setCell",value:function(t,e,r){var o=this.option,n=this.table,i=o.on.setCell;i(t,e,n.cells.getCell(t,e),r),this.$setCell(t,e,r)}},{key:"endNotice",value:function(){var t=this.table;this.change&&t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),kh(Eh(e.prototype),"endNotice",this).call(this)}},{key:"goNotice",value:function(){var t=this.table;this.change&&t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),kh(Eh(e.prototype),"goNotice",this).call(this)}},{key:"backNotice",value:function(){var t=this.table;this.change&&t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),kh(Eh(e.prototype),"backNotice",this).call(this)}}])&&xh(r.prototype,n),i&&xh(r,i),e}(vh);var _h=function t(e){var r=e.ri,o=e.ci,n=e.oldCell,i=e.newCell;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ri=r,this.ci=o,this.oldCell=n,this.newCell=i};var Th={ADD:Symbol("添加一个合并单元格"),DELETE:Symbol("删除一个合并单元格")},Ch=function t(e){var r=e.merge,o=e.recordType;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.merge=r,this.recordType=o};function Ph(t){return(Ph="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jh(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Wh(t,e){return!e||"object"!==Ph(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lh(t){return(Lh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rh(t,e){return(Rh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Dh=function(t){function e(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{addMerge:function(){},deleteMerge:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Wh(this,Lh(e).call(this))).table=t,r.option=o,r}var r,o,n;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rh(t,e)}(e,t),r=e,(o=[{key:"$addMerge",value:function(t){this.change=!0,this.table.merges.add(t)}},{key:"$deleteMerge",value:function(t){this.change=!0,this.table.merges.deleteIntersects(t)}},{key:"deleteMerge",value:function(t){var e=this.option.on.deleteMerge;e(t),this.$deleteMerge(t)}},{key:"addMerge",value:function(t){var e=this.option.on.addMerge;e(t),this.$addMerge(t)}}])&&jh(r.prototype,o),n&&jh(r,n),e}(vh);function Ih(t){return(Ih="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vh(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Hh(t,e){return!e||"object"!==Ih(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mh(t,e,r){return(Mh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Nh(t)););return t}(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(r):n.value}})(t,e,r||t)}function Nh(t){return(Nh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zh(t,e){return(zh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bh=function(t){function e(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{setWidth:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Hh(this,Nh(e).call(this))).table=t,r.option=o,r}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zh(t,e)}(e,t),r=e,(n=[{key:"$setWidth",value:function(t,e){this.change=!0,this.table.cols.setWidth(t,e)}},{key:"setWidth",value:function(t,e){var r=this.option,o=this.table,n=r.on.setWidth;n(t,o.cols.getWidth(t),e),this.$setWidth(t,e)}},{key:"endNotice",value:function(){var t=this.table;this.change&&(t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(o.TABLE_EVENT_TYPE.CHANGE_WIDTH)),Mh(Nh(e.prototype),"endNotice",this).call(this)}},{key:"backNotice",value:function(){var t=this.table;this.change&&(t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(o.TABLE_EVENT_TYPE.CHANGE_WIDTH)),Mh(Nh(e.prototype),"backNotice",this).call(this)}},{key:"goNotice",value:function(){var t=this.table;this.change&&(t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(o.TABLE_EVENT_TYPE.CHANGE_WIDTH)),Mh(Nh(e.prototype),"goNotice",this).call(this)}}])&&Vh(r.prototype,n),i&&Vh(r,i),e}(vh);var Yh=function t(e){var r=e.ci,o=e.oldWidth,n=e.newWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ci=r,this.oldWidth=o,this.newWidth=n};function Fh(t){return(Fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uh(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Xh(t,e){return!e||"object"!==Fh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gh(t,e,r){return(Gh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Kh(t)););return t}(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(r):n.value}})(t,e,r||t)}function Kh(t){return(Kh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qh(t,e){return(qh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $h=function(t){function e(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{setHeight:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Xh(this,Kh(e).call(this))).table=t,r.option=o,r}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qh(t,e)}(e,t),r=e,(n=[{key:"$setHeight",value:function(t,e){this.change=!0,this.table.rows.setHeight(t,e)}},{key:"setHeight",value:function(t,e){var r=this.option,o=this.table,n=r.on.setHeight;n(t,o.rows.getHeight(t),e),this.$setHeight(t,e)}},{key:"endNotice",value:function(){var t=this.table;this.change&&(t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(o.TABLE_EVENT_TYPE.CHANGE_HEIGHT)),Gh(Kh(e.prototype),"endNotice",this).call(this)}},{key:"backNotice",value:function(){var t=this.table;this.change&&(t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(o.TABLE_EVENT_TYPE.CHANGE_HEIGHT)),Gh(Kh(e.prototype),"backNotice",this).call(this)}},{key:"goNotice",value:function(){var t=this.table;this.change&&(t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(o.TABLE_EVENT_TYPE.CHANGE_HEIGHT)),Gh(Kh(e.prototype),"goNotice",this).call(this)}}])&&Uh(r.prototype,n),i&&Uh(r,i),e}(vh);var Zh=function t(e){var r=e.ri,o=e.oldHeight,n=e.newHeight;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ri=r,this.oldHeight=o,this.newHeight=n};function Jh(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Qh=function(){function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.record=!1,this.backLayerStack=[],this.goLayerStack=[],this.recordLayer=[],this.table=e,this.mergeDataProxy=new Dh(e,{on:{addMerge:function(t){!1!==r.record&&r.recordLayer.push(new Ch({merge:t,recordType:Th.ADD}))},deleteMerge:function(t){!1!==r.record&&r.recordLayer.push(new Ch({merge:t,recordType:Th.DELETE}))}}}),this.cellDataProxy=new Ah(e,{on:{setCell:function(t,e,o,n){!1!==r.record&&r.recordLayer.push(new _h({ri:t,ci:e,oldCell:o,newCell:n}))}}}),this.colsDataProxy=new Bh(e,{on:{setWidth:function(t,e,o){!1!==r.record&&r.recordLayer.push(new Yh({ci:t,oldWidth:e,newWidth:o}))}}}),this.rowsDataProxy=new $h(e,{on:{setHeight:function(t,e,o){!1!==r.record&&r.recordLayer.push(new Zh({ri:t,oldHeight:e,newHeight:o}))}}})}var e,r,o;return e=t,(r=[{key:"back",value:function(){for(var t=this.backLayerStack,e=this.goLayerStack,r=this.table,o=t.pop(),n=0,i=o.length;n<i;n+=1){var l=o[n];if(l instanceof _h){var c=l.ri,a=l.ci,s=l.oldCell;this.cellDataProxy.$setCell(c,a,s)}else if(l instanceof Ch){var u=l.merge;switch(l.recordType){case Th.ADD:this.mergeDataProxy.$addMerge(u);break;case Th.DELETE:this.mergeDataProxy.$deleteMerge(u)}}else if(l instanceof Yh){var f=l.ci,h=l.oldWidth;this.colsDataProxy.$setWidth(f,h)}else if(l instanceof Zh){var d=l.ri,p=l.oldHeight;this.rowsDataProxy.$setHeight(d,p)}}e.push(o),this.mergeDataProxy.backNotice(),this.cellDataProxy.backNotice(),this.colsDataProxy.backNotice(),this.rowsDataProxy.backNotice(),r.render()}},{key:"go",value:function(){for(var t=this.backLayerStack,e=this.goLayerStack,r=this.table,o=e.pop(),n=0,i=o.length;n<i;n+=1){var l=o[n];if(l instanceof _h){var c=l.ri,a=l.ci,s=l.newCell;this.cellDataProxy.$setCell(c,a,s)}else if(l instanceof Ch){var u=l.merge;switch(l.recordType){case Th.ADD:this.mergeDataProxy.$addMerge(u);break;case Th.DELETE:this.mergeDataProxy.$deleteMerge(u)}}else if(l instanceof Yh){var f=l.ci,h=l.newWidth;this.colsDataProxy.$setWidth(f,h)}else if(l instanceof Zh){var d=l.ri,p=l.newHeight;this.rowsDataProxy.$setHeight(d,p)}}t.push(o),this.mergeDataProxy.goNotice(),this.cellDataProxy.goNotice(),this.colsDataProxy.goNotice(),this.rowsDataProxy.goNotice(),r.render()}},{key:"end",value:function(){var t=this.recordLayer,e=this.backLayerStack;this.record=!1,t.length&&e.push(t),this.recordLayer=[],this.mergeDataProxy.endNotice(),this.cellDataProxy.endNotice(),this.colsDataProxy.endNotice(),this.rowsDataProxy.endNotice()}},{key:"begin",value:function(){this.record=!0,this.goLayerStack=[]}},{key:"canBack",value:function(){return 0!==this.backLayerStack.length}},{key:"canGo",value:function(){return 0!==this.goLayerStack.length}}])&&Jh(e.prototype,r),o&&Jh(e,o),t}(),td=r(0),ed=r.n(td),rd=r(1),od=r.n(rd),nd=r(2),id=r.n(nd);function ld(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var cd=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.lock=null}var e,r,o;return e=t,(r=[{key:"on",value:function(t){null===this.lock&&(this.lock=t)}},{key:"set",value:function(t,e){if(!this.lock||e===this.lock){var r=this.table;switch(t){case"cell":r.css("cursor","url(".concat(ed.a,") 7.5 7.5,auto"));break;case"s-resize":r.css("cursor","url(".concat(od.a,") 2.5 7.5,auto"));break;case"e-resize":r.css("cursor","url(".concat(id.a,") 7.5 2.5,auto"));break;default:r.css("cursor",t)}}}},{key:"off",value:function(t){this.lock===t&&(this.lock=null)}}])&&ld(e.prototype,r),o&&ld(e,o),t}();function ad(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var sd=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.bind()}var e,r,n;return e=t,(r=[{key:"register",value:function(t){var e=t.el,r=t.attr,o=void 0===r?{}:r,n=t.stop,i=void 0===n||n,l=t.focus,c=void 0!==l&&l;this.table.focus.register({el:e,attr:o,stop:i,focus:c})}},{key:"bind",value:function(){var t=this.table.focus;Rt.bind(document,o.SYSTEM_EVENT_TYPE.KEY_DOWN,(function(e){var r=t.activate,o=e.keyCode;if(r){var n=r.attr,i=n.key,l=n.code,c=n.callback;i?e[i]&&o===l&&c(e):o===l&&c(e)}9===o&&e.preventDefault()}))}}])&&ad(e.prototype,r),n&&ad(e,n),t}();function ud(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var fd=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.pool=[],this.activate=null}var e,r,n;return e=t,(r=[{key:"findByEl",value:function(t){for(var e=0;e<this.pool.length;e+=1){var r=this.pool[e];if(r.el===t)return r}return null}},{key:"register",value:function(t){var e=this,r=t.el,n=t.attr,i=void 0===n?{}:n,l=t.stop,c=void 0===l||l,a=t.focus,s=void 0!==a&&a,u=this.findByEl(r);if(u)Object.assign(u.attr,i);else{var f={el:r,attr:i};this.pool.push(f),s&&(this.activate=f),Rt.bind(r,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){e.activate=f,c&&t.stopPropagation()}))}}}])&&ud(e.prototype,r),n&&ud(e,n),t}();function hd(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var dd=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.origin=e,this.draw=new Ll(document.createElement("canvas"))}var e,r,o;return e=t,(r=[{key:"fullColor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#ffffff",e=this.draw,r=e.width,o=e.height;e.attr({fillStyle:t}),e.fillRect(0,0,r,o)}},{key:"resize",value:function(t,e){this.draw.resize(t,e)}},{key:"mapping",value:function(t,e,r,o){var n=this.origin;this.draw.drawImage(n.el,t,e,r,o,0,0,r,o)}},{key:"reflection",value:function(t,e,r,o){var n=this.origin,i=this.draw;n.drawImage(i.el,0,0,r,o,t,e,r,o)}}])&&hd(e.prototype,r),o&&hd(e,o),t}();function pd(t){return(pd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yd(t){return(yd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bd(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gd(t,e){return(gd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function wd(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var r=[],o=!0,n=!1,i=void 0;try{for(var l,c=t[Symbol.iterator]();!(o=(l=c.next()).done)&&(r.push(l.value),!e||r.length!==e);o=!0);}catch(t){n=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(n)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function vd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function md(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function xd(t,e,r){return e&&md(t.prototype,e),r&&md(t,r),t}var Od={SCROLL:1,RENDER:2},kd=function(){function t(e){vd(this,t),this.table=e}return xd(t,[{key:"getFixedXOffset",value:function(){return 0}},{key:"getFixedYOffset",value:function(){return this.table.settings.index.height}},{key:"getFixedWidth",value:function(){return this.table.settings.index.width}},{key:"getFixedHeight",value:function(){var t=this.table,e=t.fixed.fxTop;return t.rows.sectionSumHeight(0,e)}},{key:"getScrollViewChange",value:function(){return this.table.mode!==Od.SCROLL}},{key:"getScrollView",value:function(){var t=this.table.fixed.fxTop,e=this.getFixedWidth(),r=this.getFixedHeight();return new Na(0,0,t,0,e,r)}}]),t}(),Ed=function(){function t(e){vd(this,t),this.table=e}return xd(t,[{key:"getFixedXOffset",value:function(){return this.table.settings.index.width}},{key:"getFixedYOffset",value:function(){return 0}},{key:"getFixedWidth",value:function(){var t=this.table,e=t.fixed.fxLeft;return t.cols.sectionSumWidth(0,e)}},{key:"getFixedHeight",value:function(){return this.table.settings.index.height}},{key:"getScrollViewChange",value:function(){return this.table.mode!==Od.SCROLL}},{key:"getScrollView",value:function(){var t=this.table.fixed.fxLeft,e=this.getFixedWidth(),r=this.getFixedHeight();return new Na(0,0,0,t,e,r)}}]),t}(),Sd=function(){function t(e){vd(this,t),this.table=e}return xd(t,[{key:"getFixedXOffset",value:function(){return this.table.settings.index.width}},{key:"getFixedYOffset",value:function(){return this.table.settings.index.height}},{key:"getFixedWidth",value:function(){var t=this.table,e=t.fixed.fxLeft;return t.cols.sectionSumWidth(0,e)}},{key:"getFixedHeight",value:function(){var t=this.table,e=t.fixed.fxTop;return t.rows.sectionSumHeight(0,e)}},{key:"getScrollViewChange",value:function(){return this.table.mode!==Od.SCROLL}},{key:"getScrollView",value:function(){var t=this.table.fixed,e=t.fxTop,r=t.fxLeft,o=this.getFixedWidth(),n=this.getFixedHeight();return new Na(0,0,e,r,o,n)}}]),t}(),Ad=function(){function t(e){vd(this,t),this.table=e}return xd(t,[{key:"getFixedXOffset",value:function(){var t=this.table,e=t.fixed,r=t.settings.index,o=e.fxLeft,n=t.cols.sectionSumWidth(0,o);return r.width+n}},{key:"getFixedYOffset",value:function(){return this.table.settings.index.height}},{key:"getFixedWidth",value:function(){var t=this.table,e=t.fixed,r=t.settings.index,o=e.fxLeft,n=t.cols.sectionSumWidth(0,o);return t.visualWidth()-(r.width+n)}},{key:"getFixedHeight",value:function(){var t=this.table,e=t.fixed.fxTop;return t.rows.sectionSumHeight(0,e)}},{key:"getCaptureX",value:function(){var t=this.table.dynamicView.difference.getCaptureX();return this.getFixedXOffset()+t}},{key:"getCaptureY",value:function(){var t=this.table.dynamicView.difference.getCaptureY();return this.getFixedYOffset()+t}},{key:"getDwXOffset",value:function(){var t=this.table.dynamicView.difference.getDwXOffset();return this.getFixedXOffset()+t}},{key:"getDwYOffset",value:function(){var t=this.table.dynamicView.difference.getDwYOffset();return this.getFixedYOffset()+t}},{key:"getScrollViewChange",value:function(){var t=this.table,e=t.fixed.fxTop;if(t.mode===Od.SCROLL){var r=t.dynamicView,o=r.getOriginLastScrollView(),n=r.getOriginScrollView();return null===o||(o.sri=0,o.eri=e,n.sri=0,n.eri=e,!1===n.equals(o))}return!0}},{key:"getContentView",value:function(){var t=this.table,e=t.dynamicView,r=t.fixed.fxTop,o=e.getContentView();return o.sri=0,o.eri=r,o}},{key:"getScrollView",value:function(){var t=this.table,e=t.dynamicView,r=t.fixed.fxTop,o=e.getScrollView();return o.sri=0,o.eri=r,o}},{key:"getScrollXOffset",value:function(){return this.table.dynamicView.getScrollXOffset()}}]),t}(),_d=function(){function t(e){vd(this,t),this.table=e}return xd(t,[{key:"getFixedXOffset",value:function(){return this.table.settings.index.width}},{key:"getFixedYOffset",value:function(){var t=this.table,e=t.fixed,r=t.settings.index,o=e.fxTop,n=t.rows.sectionSumHeight(0,o);return r.height+n}},{key:"getFixedWidth",value:function(){var t=this.table,e=t.fixed.fxLeft;return t.cols.sectionSumWidth(0,e)}},{key:"getFixedHeight",value:function(){var t=this.table,e=t.fixed,r=t.settings.index,o=e.fxTop,n=t.rows.sectionSumHeight(0,o);return t.visualHeight()-(r.height+n)}},{key:"getCaptureX",value:function(){var t=this.table.dynamicView.difference.getCaptureX();return this.getFixedXOffset()+t}},{key:"getCaptureY",value:function(){var t=this.table.dynamicView.difference.getCaptureY();return this.getFixedYOffset()+t}},{key:"getDwXOffset",value:function(){var t=this.table.dynamicView.difference.getDwXOffset();return this.getFixedXOffset()+t}},{key:"getDwYOffset",value:function(){var t=this.table.dynamicView.difference.getDwYOffset();return this.getFixedYOffset()+t}},{key:"getScrollViewChange",value:function(){var t=this.table,e=t.fixed.fxLeft;if(t.mode===Od.SCROLL){var r=t.dynamicView,o=r.getOriginLastScrollView(),n=r.getOriginScrollView();return null===o||(o.sci=0,o.eci=e,n.sci=0,n.eci=e,!1===n.equals(o))}return!0}},{key:"getContentView",value:function(){var t=this.table,e=t.dynamicView,r=t.fixed.fxLeft,o=e.getContentView();return o.sci=0,o.eci=r,o}},{key:"getScrollView",value:function(){var t=this.table,e=t.dynamicView,r=t.fixed.fxLeft,o=e.getScrollView();return o.sci=0,o.eci=r,o}}]),t}(),Td=function(){function t(e){vd(this,t),this.table=e}return xd(t,[{key:"getFixedXOffset",value:function(){var t=this.table,e=t.fixed,r=t.settings.index,o=e.fxLeft;return t.cols.sectionSumWidth(0,o)+r.width}},{key:"getFixedYOffset",value:function(){var t=this.table,e=t.fixed,r=t.settings.index,o=e.fxTop,n=t.rows.sectionSumHeight(0,o);return r.height+n}},{key:"getFixedWidth",value:function(){var t=this.table,e=t.fixed,r=t.settings.index,o=e.fxLeft,n=t.cols.sectionSumWidth(0,o);return t.visualWidth()-(n+r.width)}},{key:"getFixedHeight",value:function(){var t=this.table,e=t.fixed,r=t.settings.index,o=e.fxTop,n=t.rows.sectionSumHeight(0,o);return t.visualHeight()-(r.height+n)}},{key:"getCaptureX",value:function(){var t=this.table.dynamicView.difference.getCaptureX();return this.getFixedXOffset()+t}},{key:"getCaptureY",value:function(){var t=this.table.dynamicView.difference.getCaptureY();return this.getFixedYOffset()+t}},{key:"getDwXOffset",value:function(){var t=this.table.dynamicView.difference.getDwXOffset();return this.getFixedXOffset()+t}},{key:"getDwYOffset",value:function(){var t=this.table.dynamicView.difference.getDwYOffset();return this.getFixedYOffset()+t}},{key:"getScrollViewChange",value:function(){var t=this.table;if(t.mode===Od.SCROLL){var e=t.dynamicView,r=e.getOriginLastScrollView(),o=e.getOriginScrollView();return null===r||!1===o.equals(r)}return!0}},{key:"getContentView",value:function(){return this.table.dynamicView.getContentView()}},{key:"getScrollView",value:function(){return this.table.dynamicView.getScrollView()}},{key:"getScrollXOffset",value:function(){return this.table.dynamicView.getScrollXOffset()}}]),t}(),Cd=function(){function t(e){vd(this,t),this.table=e}return xd(t,[{key:"getFixedXOffset",value:function(){var t=this.table,e=t.fixed,r=t.settings.index,o=e.fxLeft,n=t.cols.sectionSumWidth(0,o);return r.width+n}},{key:"getFixedYOffset",value:function(){return 0}},{key:"getFixedWidth",value:function(){var t=this.table,e=t.fixed,r=t.settings.index,o=e.fxLeft,n=t.cols.sectionSumWidth(0,o);return t.visualWidth()-(r.width+n)}},{key:"getFixedHeight",value:function(){return this.table.settings.index.height}},{key:"getCaptureX",value:function(){var t=this.table.dynamicView.difference.getCaptureX();return this.getFixedXOffset()+t}},{key:"getCaptureY",value:function(){var t=this.table.dynamicView.difference.getCaptureY();return this.getFixedYOffset()+t}},{key:"getDwXOffset",value:function(){var t=this.table.dynamicView.difference.getDwXOffset();return this.getFixedXOffset()+t}},{key:"getDwYOffset",value:function(){var t=this.table.dynamicView.difference.getDwYOffset();return this.getFixedYOffset()+t}},{key:"getScrollViewChange",value:function(){var t=this.table;if(t.mode===Od.SCROLL){var e=t.dynamicView,r=e.getOriginLastScrollView(),o=e.getOriginScrollView();return null===r||(r.sri=0,r.eri=0,o.sri=0,o.eri=0,!1===o.equals(r))}return!0}},{key:"getContentView",value:function(){var t=this.table.dynamicView.getContentView();return t.sri=0,t.eri=0,t}},{key:"getScrollView",value:function(){var t=this.table.dynamicView.getScrollView();return t.sri=0,t.eri=0,t}}]),t}(),Pd=function(){function t(e){vd(this,t),this.table=e}return xd(t,[{key:"getFixedXOffset",value:function(){return 0}},{key:"getFixedYOffset",value:function(){var t=this.table,e=t.fixed,r=t.settings.index,o=e.fxTop,n=t.rows.sectionSumHeight(0,o);return r.height+n}},{key:"getFixedWidth",value:function(){return this.table.settings.index.width}},{key:"getFixedHeight",value:function(){var t=this.table,e=t.fixed,r=t.settings.index,o=e.fxTop,n=t.rows.sectionSumHeight(0,o);return t.visualHeight()-(r.height+n)}},{key:"getCaptureX",value:function(){var t=this.table.dynamicView.difference.getCaptureX();return this.getFixedXOffset()+t}},{key:"getCaptureY",value:function(){var t=this.table.dynamicView.difference.getCaptureY();return this.getFixedYOffset()+t}},{key:"getDwXOffset",value:function(){var t=this.table.dynamicView.difference.getDwXOffset();return this.getFixedXOffset()+t}},{key:"getDwYOffset",value:function(){var t=this.table.dynamicView.difference.getDwYOffset();return this.getFixedYOffset()+t}},{key:"getScrollViewChange",value:function(){var t=this.table;if(t.mode===Od.SCROLL){var e=t.dynamicView,r=e.getOriginLastScrollView(),o=e.getOriginScrollView();return null===r||(r.sci=0,r.eci=0,o.sci=0,o.eci=0,!1===o.equals(r))}return!0}},{key:"getContentView",value:function(){var t=this.table.dynamicView.getContentView();return t.sci=0,t.eci=0,t}},{key:"getScrollView",value:function(){var t=this.table.dynamicView.getScrollView();return t.sci=0,t.eci=0,t}}]),t}(),jd=function(){function t(e){vd(this,t),this.dynamicView=e,this.subtractRange=null,this.addRange=null,this.captureX=0,this.captureY=0,this.dwAddRange=null,this.dwContentRange=null,this.dwXOffset=0,this.dwYOffset=0}return xd(t,[{key:"cpSubtractRange",value:function(){var t=this.dynamicView,e=t.table,r=t.lastScrollRange,o=t.scrollRange,n=e.cols,i=e.rows;if(r){var l=wd(r.coincideDifference(o),1)[0];l&&(l.w=n.rectRangeSumWidth(l),l.h=i.rectRangeSumHeight(l),this.subtractRange=l)}}},{key:"cpAddRange",value:function(){var t=this.dynamicView,e=t.table,r=t.lastScrollRange,o=t.scrollRange,n=e.cols,i=e.rows;if(r){var l=wd(o.coincideDifference(r),1)[0];l&&(l.w=n.rectRangeSumWidth(l),l.h=i.rectRangeSumHeight(l),this.addRange=l)}}},{key:"cpCaptureXY",value:function(){var t=this.dynamicView,e=this.addRange,r=this.subtractRange,o=t.table.scroll;if(e||r){var n=0,i=0;switch(o.type){case Zu.V_TOP:i=e.h;break;case Zu.V_BOTTOM:i=-r.h;break;case Zu.H_LEFT:n=e.w;break;case Zu.H_RIGHT:n=-r.w}this.captureX=n,this.captureY=i}}},{key:"cpRange",value:function(){this.subtractRange=null,this.addRange=null,this.captureX=0,this.captureY=0,this.dwAddRange=null,this.dwContentRange=null,this.dwXOffset=0,this.dwYOffset=0,this.cpSubtractRange(),this.cpAddRange(),this.cpDwAddRange(),this.cpDwContentRange(),this.cpCaptureXY(),this.cpDwOffsetXY()}},{key:"cpDwAddRange",value:function(){var t=this.dynamicView,e=this.addRange,r=t.table,o=r.scroll;if(e){this.dwAddRange=e.clone();var n=r.rows,i=r.cols;switch(o.type){case Zu.H_RIGHT:this.dwAddRange.sci-=1,this.dwAddRange.w=i.rectRangeSumWidth(this.dwAddRange);break;case Zu.V_BOTTOM:this.dwAddRange.sri-=1,this.dwAddRange.h=n.rectRangeSumHeight(this.dwAddRange);break;case Zu.H_LEFT:this.dwAddRange.eci+=1,this.dwAddRange.w=i.rectRangeSumWidth(this.dwAddRange);break;case Zu.V_TOP:this.dwAddRange.eri+=1,this.dwAddRange.h=n.rectRangeSumHeight(this.dwAddRange)}}}},{key:"cpDwContentRange",value:function(){var t=this.dynamicView.table,e=this.dwAddRange;if(e){var r=e.sri,o=e.eri,n=t.cols;this.dwContentRange=e.clone(),this.dwContentRange.set(r,0,o,n.len),this.dwContentRange.w=n.rectRangeSumWidth(this.dwContentRange)}}},{key:"cpDwOffsetXY",value:function(){var t=this.dynamicView,e=this.dwAddRange,r=t.table;if(e){var o=e.w,n=e.h,i=0,l=0;switch(r.scroll.type){case Zu.V_TOP:l=0;break;case Zu.V_BOTTOM:var c=r.rows,a=t.scrollRange;l=c.rectRangeSumHeight(a)-n;break;case Zu.H_LEFT:i=0;break;case Zu.H_RIGHT:var s=r.cols,u=t.scrollRange;i=s.rectRangeSumWidth(u)-o}this.dwXOffset=i,this.dwYOffset=l}}},{key:"getCaptureX",value:function(){return this.dynamicView.table.mode===Od.SCROLL?this.captureX:0}},{key:"getCaptureY",value:function(){return this.dynamicView.table.mode===Od.SCROLL?this.captureY:0}},{key:"getDwXOffset",value:function(){return this.dynamicView.table.mode===Od.SCROLL?this.dwXOffset:0}},{key:"getDwYOffset",value:function(){return this.dynamicView.table.mode===Od.SCROLL?this.dwYOffset:0}}]),t}(),Wd=function(){function t(e){vd(this,t),this.difference=new jd(this),this.table=e,this.lastScrollRange=null,this.scrollRange=null,this.contentRange=null,this.scrollXOffset=0}return xd(t,[{key:"cpScrollRange",value:function(){for(var t=this.table,e=t.rows,r=t.cols,o=t.scroll,n=t.contentOffset,i=0,l=0,c=o.ri,a=o.ci,s=[e.len,r.len],u=s[0],f=s[1],h=c;h<e.len&&(u=h,!((l+=e.getHeight(h))>n.getFixedHeight()));h+=1);for(var d=a;d<r.len&&(f=d,!((i+=r.getWidth(d))>n.getFixedWidth()));d+=1);this.scrollRange=new Na(c,a,u,f,i,l)}},{key:"cpContentRange",value:function(){var t=this.table,e=this.scrollRange,r=e.sri,o=e.eri,n=t.cols;this.contentRange=e.clone(),this.contentRange.set(r,0,o,n.len),this.contentRange.w=n.rectRangeSumWidth(e)}},{key:"cpScrollXOffset",value:function(){var t=this.table,e=t.scroll,r=t.cols,o=e.ci;this.scrollXOffset=-r.sectionSumWidth(0,o-1)}},{key:"cpRange",value:function(){this.lastScrollRange=this.scrollRange,this.scrollRange=null,this.contentRange=null,this.scrollXOffset=0,this.cpScrollRange(),this.cpContentRange(),this.cpScrollXOffset(),this.difference.cpRange()}},{key:"getOriginScrollView",value:function(){return this.scrollRange.clone()}},{key:"getOriginContentView",value:function(){return this.contentRange.clone()}},{key:"getOriginLastScrollView",value:function(){var t=this.lastScrollRange;return t?t.clone():null}},{key:"getScrollXOffset",value:function(){return this.scrollXOffset}},{key:"getScrollView",value:function(){var t=this.table,e=this.scrollRange;if(t.mode===Od.SCROLL){var r=this.difference.dwAddRange;if(r)return r.clone()}return e.clone()}},{key:"getContentView",value:function(){var t=this.contentRange,e=this.table;if(e.mode===Od.SCROLL){var r=e.scroll,o=this.difference;switch(r.type){case Zu.V_TOP:case Zu.V_BOTTOM:var n=o.dwContentRange;if(n)return n.clone()}}return t.clone()}}]),t}(),Ld=function(){function t(e){vd(this,t),this.table=e}return xd(t,[{key:"getScrollViewRange",value:function(){var t=this.table,e=t.dynamicView,r=t.fixed,o=r.fxLeft,n=r.fxTop,i=e.getOriginScrollView();return i.sci=0,i.eci=o,i.sri=0,i.eri=n,i}},{key:"drawGrid",value:function(t,e,r){var o=this.table,n=o.draw,i=o.grid,l=o.lineHandle,c=o.gridLineHandle;n.save(),n.offset(e,r);var a=l.viewRangeAndMergeCoincideView({viewRange:t}),s=l.coincideViewBrink({coincideView:a}),u=c.hLine(t),f=c.vLine(t);u.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),f.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)}));var h=c.hMergeLine(s),d=c.vMergeLine(s);h.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),d.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)})),n.offset(0,0),n.restore()}},{key:"drawBorder",value:function(t,e,r){var o=this.table,n=o.draw,i=o.line,l=o.lineHandle,c=o.borderLineHandle;n.save(),n.offset(e,r);var a=l.viewRangeAndMergeCoincideView({viewRange:t}),s=l.coincideViewBrink({coincideView:a}),u=c.htLine(t),f=c.hbLine(t),h=c.vlLine(t),d=c.vrLine(t);u.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.top,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"top")})),f.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.bottom,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"bottom")})),h.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.left,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"left")})),d.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.right,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"right")}));var p=c.htMergeLine(s),y=c.hbMergeLine(s),b=c.vlMergeLine(s),g=c.vrMergeLine(s);p.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.top,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"top")})),y.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.bottom,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"bottom")})),b.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.left,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"left")})),g.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.right,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"right")})),n.offset(0,0),n.restore()}},{key:"drawBackGround",value:function(t,e,r){var o=this.table,n=o.draw,i=o.grid,l=o.cellsHelper;n.save(),n.offset(e,r),l.getCellByViewRange({rectRange:t,callback:function(t,e,r,o){o.expandSize(i.lineWidth()),new ch({draw:n,rect:o}).drawBackgroundColor(r.background)}}),l.getMergeCellByViewRange({rectRange:t,callback:function(t,e){t.expandSize(i.lineWidth()),new ch({draw:n,rect:t}).drawBackgroundColor(e.background)}}),n.offset(0,0),n.restore()}},{key:"drawCells",value:function(t,e,r){var o=this.table,n=o.draw,i=o.cellsHelper,l=o.grid;n.save(),n.offset(e,r),i.getCellSkipMergeCellByViewRange({rectRange:t,callback:function(t,e,r,o,i){var c=r.fontAttr,a=c.align,s=new Jl({text:Xu(r.format,r.text),rect:o.expandSize(l.lineWidth()),dw:n,overflow:i,attr:c});s.setOverflowCrop(a===Ul.center),r.setContentWidth(s.draw())}}),i.getMergeCellByViewRange({rectRange:t,callback:function(t,e){var r=e.fontAttr,o=new Jl({text:Xu(e.format,e.text),rect:t.expandSize(l.lineWidth()),dw:n,overflow:null,attr:r});o.setTextWrap(Gl.WORD_WRAP),e.setContentWidth(o.draw())}}),n.offset(0,0),n.restore()}},{key:"renderClear",value:function(){var t=this.table,e=t.draw,r=t.settings,o=t.frozenLeftTopOffset,n=o.getFixedWidth(),i=o.getFixedHeight(),l=o.getFixedXOffset(),c=o.getFixedYOffset();e.attr({fillStyle:r.table.background}),e.fillRect(l,c,n,i)}},{key:"render",value:function(){var t=this.table,e=t.draw,r=t.grid,o=t.settings,n=t.frozenLeftTopOffset;if(n.getScrollViewChange()){var i=n.getScrollView(),l=n.getFixedXOffset(),c=n.getFixedYOffset(),a=n.getFixedWidth(),s=n.getFixedHeight();this.renderClear();var u=new Dl({x:l+r.lineWidth(),y:c+r.lineWidth(),width:a,height:s}),f=new _l({draw:e,rect:u,offset:r.lineWidth()});f.open(),this.drawBackGround(i,l,c),this.drawCells(i,l,c),o.table.showGrid&&this.drawGrid(i,l,c),this.drawBorder(i,l,c),f.close()}}}]),t}(),Rd=function(){function t(e){vd(this,t),this.table=e}return xd(t,[{key:"draw",value:function(t,e,r,o,n){var i=this.table,l=i.draw,c=i.grid,a=i.rows,s=i.settings,u=t.sri,f=t.eri;l.save(),l.offset(e,r),l.attr({fillStyle:"#f6f7fa"}),l.fillRect(0,0,o,n),l.attr({textAlign:"center",textBaseline:"middle",font:"".concat(jl(11),"px Arial"),fillStyle:"#585757"}),a.eachHeight(u,f,(function(t,e,r){l.fillText(t+1,o/2,r+e/2)}));var h=0;l.attr({strokeStyle:s.table.borderColor}),a.eachHeight(u,f,(function(t,e,r){h+=e,c.horizontalLine(0,r,o,r),t===f&&c.horizontalLine(0,r+e,o,r+e)})),c.verticalLine(o,0,o,h),l.offset(0,0),l.restore()}},{key:"renderClear",value:function(){var t=this.table,e=t.draw,r=t.settings,o=t.frozenLeftIndexOffset,n=o.getFixedWidth(),i=o.getFixedHeight(),l=o.getFixedXOffset(),c=o.getFixedYOffset();e.attr({fillStyle:r.table.background}),e.fillRect(l,c,n,i)}},{key:"render",value:function(){var t=this.table.frozenLeftIndexOffset;if(t.getScrollViewChange()){var e=t.getFixedXOffset(),r=t.getFixedYOffset(),o=t.getFixedWidth(),n=t.getFixedHeight(),i=t.getScrollView();this.renderClear(),this.draw(i,e,r,o,n)}}}]),t}(),Dd=function(){function t(e){vd(this,t),this.table=e}return xd(t,[{key:"draw",value:function(t,e,r,o,n){var i=this.table,l=i.draw,c=i.grid,a=i.cols,s=i.settings,u=t.sci,f=t.eci;l.save(),l.offset(e,r),l.attr({fillStyle:"#f6f7fa"}),l.fillRect(0,0,o,n),l.attr({textAlign:"center",textBaseline:"middle",font:"".concat(jl(11),"px Arial"),fillStyle:"#585757"}),a.eachWidth(u,f,(function(t,e,r){l.fillText(k.stringAt(t),r+e/2,n/2)})),l.attr({strokeStyle:s.table.borderColor});var h=0;l.attr({strokeStyle:s.table.borderColor}),a.eachWidth(u,f,(function(t,e,r){h+=e,c.verticalLine(r,0,r,n),t===f&&c.verticalLine(r+e,0,r+e,n)})),c.horizontalLine(0,n,h,n),l.offset(0,0),l.restore()}},{key:"renderClear",value:function(){var t=this.table,e=t.draw,r=t.settings,o=t.frozenTopIndexOffset,n=o.getFixedWidth(),i=o.getFixedHeight(),l=o.getFixedXOffset(),c=o.getFixedYOffset();e.attr({fillStyle:r.table.background}),e.fillRect(l,c,n,i)}},{key:"render",value:function(){var t=this.table.frozenTopIndexOffset;if(t.getScrollViewChange()){var e=t.getFixedXOffset(),r=t.getFixedYOffset(),o=t.getFixedWidth(),n=t.getFixedHeight(),i=t.getScrollView();this.renderClear(),this.draw(i,e,r,o,n)}}}]),t}(),Id=function(){function t(e){vd(this,t),this.table=e}return xd(t,[{key:"draw",value:function(t,e,r,o){var n=this.table,i=n.draw,l=n.grid,c=n.settings;i.save(),i.offset(t,e),i.attr({fillStyle:"#f4f5f8"}),i.fillRect(0,0,r,o),i.offset(0,0),i.restore(),i.attr({strokeStyle:c.table.borderColor}),l.verticalLine(r,e,r,o),l.horizontalLine(0,o,r,o)}},{key:"render",value:function(){var t=this.table.settings.index;this.draw(0,0,t.width,t.height)}}]),t}(),Vd=function(){function t(e){vd(this,t),this.table=e}return xd(t,[{key:"getScrollViewRange",value:function(){var t=this.table,e=t.dynamicView,r=t.fixed.fxTop,o=e.getOriginScrollView();return o.sri=0,o.eri=r,o}},{key:"drawCells",value:function(t,e,r,o){var n=this.table,i=n.draw,l=n.cellsHelper,c=n.grid;i.save(),i.offset(r,o),l.getCellSkipMergeCellByViewRange({rectRange:t,callback:function(t,e,r,o,n){var l=r.fontAttr,a=l.align,s=new Jl({text:Xu(r.format,r.text),rect:o.expandSize(c.lineWidth()),dw:i,overflow:n,attr:l});s.setOverflowCrop(a===Ul.center),r.setContentWidth(s.draw())},startX:e}),l.getMergeCellByViewRange({rectRange:t,callback:function(t,e){var r=e.fontAttr,o=new Jl({text:Xu(e.format,e.text),rect:t.expandSize(c.lineWidth()),dw:i,overflow:null,attr:r});o.setTextWrap(Gl.WORD_WRAP),e.setContentWidth(o.draw())},startX:e}),i.offset(0,0),i.restore()}},{key:"drawGrid",value:function(t,e,r){var o=this.table,n=o.draw,i=o.grid,l=o.lineHandle,c=o.gridLineHandle;n.save(),n.offset(e,r);var a=l.viewRangeAndMergeCoincideView({viewRange:t}),s=l.coincideViewBrink({coincideView:a}),u=c.hLine(t),f=c.vLine(t);u.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),f.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)}));var h=c.hMergeLine(s),d=c.vMergeLine(s);h.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),d.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)})),n.offset(0,0),n.restore()}},{key:"drawBorder",value:function(t,e,r){var o=this.table,n=o.draw,i=o.line,l=o.lineHandle,c=o.borderLineHandle;n.save(),n.offset(e,r);var a=l.viewRangeAndMergeCoincideView({viewRange:t}),s=l.coincideViewBrink({coincideView:a}),u=c.htLine(t),f=c.hbLine(t),h=c.vlLine(t),d=c.vrLine(t);u.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.top,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"top")})),f.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.bottom,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"bottom")})),h.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.left,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"left")})),d.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.right,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"right")}));var p=c.htMergeLine(s),y=c.hbMergeLine(s),b=c.vlMergeLine(s),g=c.vrMergeLine(s);p.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.top,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"top")})),y.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.bottom,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"bottom")})),b.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.left,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"left")})),g.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.right,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"right")})),n.offset(0,0),n.restore()}},{key:"drawBackGround",value:function(t,e,r){var o=this.table,n=o.draw,i=o.grid,l=o.cellsHelper;n.save(),n.offset(e,r),l.getCellByViewRange({rectRange:t,callback:function(t,e,r,o){o.expandSize(i.lineWidth()),new ch({draw:n,rect:o}).drawBackgroundColor(r.background)}}),l.getMergeCellByViewRange({rectRange:t,callback:function(t,e){t.expandSize(i.lineWidth()),new ch({draw:n,rect:t}).drawBackgroundColor(e.background)}}),n.offset(0,0),n.restore()}},{key:"renderClear",value:function(){var t=this.table,e=t.draw,r=t.settings,o=t.offDraw,n=t.grid,i=t.cols,l=t.dynamicView,c=t.fixedTopOffset,a=c.getFixedWidth(),s=c.getFixedHeight(),u=c.getFixedXOffset(),f=c.getFixedYOffset(),h=c.getDwXOffset(),d=c.getDwYOffset(),p=c.getCaptureX(),y=t.scroll,b=c.getScrollView();switch(y.type){case Zu.H_RIGHT:case Zu.H_LEFT:var g=u,w=f,v=f;o.mapping(g+n.lineWidth(),w,a,s),e.attr({fillStyle:r.table.background}),e.fillRect(g,w,a,s),o.reflection(p+n.lineWidth(),v,a,s)}switch(y.type){case Zu.H_RIGHT:if(i.len-1===b.eci){var m=l.getOriginScrollView();e.fillRect(h+4,d,b.w+(a-m.w),s)}else e.fillRect(h+4,d,b.w,s);break;case Zu.H_LEFT:e.fillRect(h,d,b.w-4,s);break;default:e.attr({fillStyle:r.table.background}),e.fillRect(u,f,a,s)}}},{key:"render",value:function(){var t=this.table,e=t.draw,r=t.grid,o=t.settings,n=t.fixedTopOffset;if(n.getScrollViewChange()){var i=n.getScrollXOffset(),l=n.getScrollView(),c=n.getContentView(),a=n.getDwXOffset(),s=n.getDwYOffset(),u=n.getFixedXOffset(),f=n.getFixedYOffset(),h=n.getFixedWidth(),d=n.getFixedHeight(),p=new Dl({x:u+r.lineWidth(),y:f+r.lineWidth(),width:h,height:d}),y=new _l({draw:e,rect:p,offset:r.lineWidth()});y.open(),this.renderClear(),y.close();var b=new Dl({x:a+r.lineWidth(),y:s+r.lineWidth(),width:l.w,height:d}),g=new _l({draw:e,rect:b,offset:r.lineWidth()});g.open(),this.drawBackGround(l,a,s),this.drawCells(c,i,u,s),o.table.showGrid&&this.drawGrid(l,a,s),this.drawBorder(l,a,s),g.close()}}}]),t}(),Hd=function(){function t(e){vd(this,t),this.table=e}return xd(t,[{key:"getScrollViewRange",value:function(){var t=this.table,e=t.dynamicView,r=t.fixed.fxLeft,o=e.getOriginScrollView();return o.sci=0,o.eci=r,o}},{key:"drawGrid",value:function(t,e,r){var o=this.table,n=o.draw,i=o.grid,l=o.lineHandle,c=o.gridLineHandle;n.save(),n.offset(e,r);var a=l.viewRangeAndMergeCoincideView({viewRange:t}),s=l.coincideViewBrink({coincideView:a}),u=c.hLine(t),f=c.vLine(t);u.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),f.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)}));var h=c.hMergeLine(s),d=c.vMergeLine(s);h.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),d.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)})),n.offset(0,0),n.restore()}},{key:"drawBorder",value:function(t,e,r){var o=this.table,n=o.draw,i=o.line,l=o.lineHandle,c=o.borderLineHandle;n.save(),n.offset(e,r);var a=l.viewRangeAndMergeCoincideView({viewRange:t}),s=l.coincideViewBrink({coincideView:a}),u=c.htLine(t),f=c.hbLine(t),h=c.vlLine(t),d=c.vrLine(t);u.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.top,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"top")})),f.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.bottom,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"bottom")})),h.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.left,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"left")})),d.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.right,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"right")}));var p=c.htMergeLine(s),y=c.hbMergeLine(s),b=c.vlMergeLine(s),g=c.vrMergeLine(s);p.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.top,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"top")})),y.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.bottom,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"bottom")})),b.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.left,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"left")})),g.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.right,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"right")})),n.offset(0,0),n.restore()}},{key:"drawBackGround",value:function(t,e,r){var o=this.table,n=o.draw,i=o.grid,l=o.cellsHelper;n.save(),n.offset(e,r),l.getCellByViewRange({rectRange:t,callback:function(t,e,r,o){o.expandSize(i.lineWidth()),new ch({draw:n,rect:o}).drawBackgroundColor(r.background)}}),l.getMergeCellByViewRange({rectRange:t,callback:function(t,e){t.expandSize(i.lineWidth()),new ch({draw:n,rect:t}).drawBackgroundColor(e.background)}}),n.offset(0,0),n.restore()}},{key:"drawCells",value:function(t,e,r){var o=this.table,n=o.draw,i=o.cellsHelper,l=o.grid;n.save(),n.offset(e,r),i.getCellSkipMergeCellByViewRange({rectRange:t,callback:function(t,e,r,o,i){var c=r.fontAttr,a=c.align,s=new Jl({text:Xu(r.format,r.text),rect:o.expandSize(l.lineWidth()),dw:n,overflow:i,attr:c});s.setOverflowCrop(a===Ul.center),r.setContentWidth(s.draw())}}),i.getMergeCellByViewRange({rectRange:t,callback:function(t,e){var r=e.fontAttr,o=new Jl({text:Xu(e.format,e.text),rect:t.expandSize(l.lineWidth()),dw:n,overflow:null,attr:r});o.setTextWrap(Gl.WORD_WRAP),e.setContentWidth(o.draw())}}),n.offset(0,0),n.restore()}},{key:"renderClear",value:function(){var t=this.table,e=t.draw,r=t.settings,o=t.offDraw,n=t.grid,i=t.dynamicView,l=t.rows,c=t.fixedLeftOffset,a=c.getFixedWidth(),s=c.getFixedHeight(),u=c.getFixedXOffset(),f=c.getFixedYOffset(),h=c.getDwXOffset(),d=c.getDwYOffset(),p=c.getCaptureY(),y=t.scroll,b=c.getScrollView();switch(y.type){case Zu.V_BOTTOM:case Zu.V_TOP:var g=u,w=u,v=f;o.mapping(g,v+n.lineWidth(),a,s),e.attr({fillStyle:r.table.background}),e.fillRect(g,v,a,s),o.reflection(w,p+n.lineWidth(),a,s)}switch(y.type){case Zu.V_BOTTOM:if(l.len-1===b.eri){var m=i.getOriginScrollView();e.fillRect(h,d+4,a,b.h+(s-m.h))}else e.fillRect(h,d+4,a,b.h);break;case Zu.V_TOP:e.fillRect(h,d,a,b.h-4);break;default:e.attr({fillStyle:r.table.background}),e.fillRect(u,f,a,s)}}},{key:"render",value:function(){var t=this.table,e=t.draw,r=t.grid,o=t.settings,n=t.fixedLeftOffset;if(n.getScrollViewChange()){var i=n.getScrollView(),l=n.getContentView(),c=n.getDwXOffset(),a=n.getDwYOffset(),s=n.getFixedXOffset(),u=n.getFixedYOffset(),f=n.getFixedWidth(),h=n.getFixedHeight(),d=new Dl({x:s+r.lineWidth(),y:u+r.lineWidth(),width:f,height:h}),p=new _l({draw:e,rect:d});p.open(),this.renderClear(),p.close();var y=new Dl({x:c+r.lineWidth(),y:a+r.lineWidth(),width:f,height:i.h}),b=new _l({draw:e,rect:y});b.open(),this.drawBackGround(i,c,a),this.drawCells(l,s,a),o.table.showGrid&&this.drawGrid(i,c,a),this.drawBorder(i,c,a),b.close()}}}]),t}(),Md=function(){function t(e){vd(this,t),this.table=e}return xd(t,[{key:"getContentWidth",value:function(){var t=this.table,e=t.cols,r=t.fixed;return e.totalWidth()-e.sectionSumWidth(0,r.fxLeft)}},{key:"getContentHeight",value:function(){var t=this.table,e=t.rows,r=t.fixed;return e.totalHeight()-e.sectionSumHeight(0,r.fxTop)}},{key:"drawCells",value:function(t,e,r,o){var n=this.table,i=n.draw,l=n.cellsHelper,c=n.grid;i.save(),i.offset(r,o),l.getCellSkipMergeCellByViewRange({rectRange:t,callback:function(t,e,r,o,n){var l=r.fontAttr,a=l.align,s=new Jl({text:Xu(r.format,r.text),rect:o.expandSize(c.lineWidth()),dw:i,overflow:n,attr:l});s.setOverflowCrop(a===Ul.center),r.setContentWidth(s.draw())},startX:e}),l.getMergeCellByViewRange({rectRange:t,callback:function(t,e){var r=e.fontAttr,o=new Jl({text:Xu(e.format,e.text),rect:t.expandSize(c.lineWidth()),dw:i,overflow:null,attr:r});o.setTextWrap(Gl.WORD_WRAP),e.setContentWidth(o.draw())},startX:e}),i.offset(0,0),i.restore()}},{key:"drawGrid",value:function(t,e,r){var o=this.table,n=o.draw,i=o.grid,l=o.lineHandle,c=o.gridLineHandle;n.save(),n.offset(e,r);var a=l.viewRangeAndMergeCoincideView({viewRange:t}),s=l.coincideViewBrink({coincideView:a}),u=c.hLine(t),f=c.vLine(t);u.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),f.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)}));var h=c.hMergeLine(s),d=c.vMergeLine(s);h.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),d.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)})),n.offset(0,0),n.restore()}},{key:"drawBorder",value:function(t,e,r){var o=this.table,n=o.draw,i=o.line,l=o.lineHandle,c=o.borderLineHandle;n.save(),n.offset(e,r);var a=l.viewRangeAndMergeCoincideView({viewRange:t}),s=l.coincideViewBrink({coincideView:a}),u=c.htLine(t),f=c.hbLine(t),h=c.vlLine(t),d=c.vrLine(t);u.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.top,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"top")})),f.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.bottom,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"bottom")})),h.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.left,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"left")})),d.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.right,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"right")}));var p=c.htMergeLine(s),y=c.hbMergeLine(s),b=c.vlMergeLine(s),g=c.vrMergeLine(s);p.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.top,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"top")})),y.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.bottom,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"bottom")})),b.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.left,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"left")})),g.forEach((function(t){var e=t.borderAttr,r=t.row,o=t.col,n=e.right,l=n.color,c=n.width,a=n.type;i.setType(a),i.setColor(l),i.setWidth(c),i.drawLine(t.sx,t.sy,t.ex,t.ey,r,o,"right")})),n.offset(0,0),n.restore()}},{key:"drawBackGround",value:function(t,e,r){var o=this.table,n=o.draw,i=o.grid,l=o.cellsHelper;n.save(),n.offset(e,r),l.getCellByViewRange({rectRange:t,callback:function(t,e,r,o){o.expandSize(i.lineWidth()),new ch({draw:n,rect:o}).drawBackgroundColor(r.background)}}),l.getMergeCellByViewRange({rectRange:t,callback:function(t,e){t.expandSize(i.lineWidth()),new ch({draw:n,rect:t}).drawBackgroundColor(e.background)}}),n.offset(0,0),n.restore()}},{key:"renderClear",value:function(){var t=this.table,e=t.draw,r=t.settings,o=t.offDraw,n=t.grid,i=t.rows,l=t.dynamicView,c=t.cols,a=t.contentOffset,s=a.getFixedWidth(),u=a.getFixedHeight(),f=a.getFixedXOffset(),h=a.getFixedYOffset(),d=a.getCaptureX(),p=a.getCaptureY(),y=a.getDwXOffset(),b=a.getDwYOffset(),g=t.scroll,w=l.getScrollView();switch(g.type){case Zu.V_BOTTOM:case Zu.V_TOP:var v=f,m=f,x=h;o.mapping(v,x+n.lineWidth(),s,u),e.attr({fillStyle:r.table.background}),e.fillRect(v,x,s,u),o.reflection(m,p+n.lineWidth(),s,u);break;case Zu.H_RIGHT:case Zu.H_LEFT:var O=f,k=h,E=h;o.mapping(O+n.lineWidth(),k,s,u),e.attr({fillStyle:r.table.background}),e.fillRect(O,k,s,u),o.reflection(d+n.lineWidth(),E,s,u)}switch(g.type){case Zu.V_BOTTOM:if(i.len-1===w.eri){var S=l.getOriginScrollView();e.fillRect(y,b+4,s,w.h+(u-S.h))}else e.fillRect(y,b+4,s,w.h);break;case Zu.V_TOP:e.fillRect(y,b,s,w.h-4);break;case Zu.H_RIGHT:if(c.len-1===w.eci){var A=l.getOriginScrollView();e.fillRect(y+4,b,w.w+(s-A.w),u)}else e.fillRect(y+4,b,w.w,u);break;case Zu.H_LEFT:e.fillRect(y,b,w.w-4,u);break;default:e.attr({fillStyle:r.table.background}),e.fillRect(f,h,s,u)}}},{key:"render",value:function(){var t=this.table,e=t.draw,r=t.grid,o=t.settings,n=t.contentOffset;if(n.getScrollViewChange()){var i=n.getScrollXOffset(),l=n.getScrollView(),c=n.getContentView(),a=n.getDwXOffset(),s=n.getDwYOffset(),u=n.getFixedXOffset(),f=n.getFixedYOffset(),h=n.getFixedWidth(),d=n.getFixedHeight(),p=new Dl({x:u+r.lineWidth(),y:f+r.lineWidth(),width:h,height:d}),y=new _l({draw:e,rect:p});y.open(),this.renderClear(),y.close();var b=new Dl({x:a+r.lineWidth(),y:s+r.lineWidth(),width:l.w,height:l.h}),g=new _l({draw:e,rect:b});g.open(),this.drawBackGround(l,a,s),this.drawCells(c,i,u,s),o.table.showGrid&&this.drawGrid(l,a,s),this.drawBorder(l,a,s),g.close()}}}]),t}(),Nd=function(){function t(e){vd(this,t),this.table=e}return xd(t,[{key:"draw",value:function(t,e,r,o,n){var i=this.table,l=i.draw,c=i.grid,a=i.cols,s=i.settings,u=t.sci,f=t.eci;l.save(),l.offset(e,r),l.attr({fillStyle:"#f6f7fa"}),l.fillRect(0,0,o,n),l.attr({textAlign:"center",textBaseline:"middle",font:"".concat(jl(11),"px Arial"),fillStyle:"#585757"}),a.eachWidth(u,f,(function(t,e,r){l.fillText(k.stringAt(t),r+e/2,n/2)})),l.attr({strokeStyle:s.table.borderColor});var h=0;l.attr({strokeStyle:s.table.borderColor}),a.eachWidth(u,f,(function(t,e,r){h+=e,c.verticalLine(r,0,r,n),t===f&&c.verticalLine(r+e,0,r+e,n)})),c.horizontalLine(0,n,h,n),l.offset(0,0),l.restore()}},{key:"renderClear",value:function(){var t=this.table,e=t.draw,r=t.settings,o=t.cols,n=t.grid,i=t.dynamicView,l=t.fixedTopIndexOffset,c=l.getFixedWidth(),a=l.getFixedHeight(),s=l.getFixedXOffset(),u=l.getFixedYOffset(),f=l.getDwXOffset(),h=l.getDwYOffset(),d=l.getCaptureX(),p=t.scroll,y=t.canvas.el,b=l.getScrollView();switch(p.type){case Zu.H_RIGHT:case Zu.H_LEFT:var g=s,w=u,v=u;if(e.drawImage(y,g,w,c,a+n.lineWidth(),d,v,c,a+n.lineWidth()),e.attr({fillStyle:r.table.background}),o.len-1===b.eci){var m=i.getOriginScrollView();e.fillRect(f,h,b.w+(c-m.w),a+n.lineWidth())}else e.fillRect(f,h,b.w,a+n.lineWidth());break;default:e.attr({fillStyle:r.table.background}),e.fillRect(s,u,c,a)}}},{key:"render",value:function(){var t=this.table,e=t.fixedTopIndexOffset,r=t.grid,o=t.draw;if(e.getScrollViewChange()){var n=e.getScrollView(),i=e.getDwXOffset(),l=e.getDwYOffset(),c=e.getFixedXOffset(),a=e.getFixedYOffset(),s=e.getFixedWidth(),u=e.getFixedHeight(),f=new Dl({x:c,y:a,width:s,height:u+r.lineWidth()}),h=new _l({draw:o,rect:f});h.open(),this.renderClear(),this.draw(n,i,l,n.w,u),h.close()}}}]),t}(),zd=function(){function t(e){vd(this,t),this.table=e}return xd(t,[{key:"draw",value:function(t,e,r,o,n){var i=this.table,l=i.draw,c=i.grid,a=i.rows,s=i.settings,u=t.sri,f=t.eri;l.save(),l.offset(e,r),l.attr({fillStyle:"#f6f7fa"}),l.fillRect(0,0,o,n),l.attr({textAlign:"center",textBaseline:"middle",font:"".concat(jl(11),"px Arial"),fillStyle:"#585757"}),a.eachHeight(u,f,(function(t,e,r){l.fillText(t+1,o/2,r+e/2)}));var h=0;l.attr({strokeStyle:s.table.borderColor}),a.eachHeight(u,f,(function(t,e,r){h+=e,c.horizontalLine(0,r,o,r),t===f&&c.horizontalLine(0,r+e,o,r+e)})),c.verticalLine(o,0,o,h),l.offset(0,0),l.restore()}},{key:"renderClear",value:function(){var t=this.table,e=t.draw,r=t.settings,o=t.rows,n=t.grid,i=t.dynamicView,l=t.fixedLeftIndexOffset,c=l.getFixedWidth(),a=l.getFixedHeight(),s=l.getFixedXOffset(),u=l.getFixedYOffset(),f=l.getDwXOffset(),h=l.getDwYOffset(),d=l.getCaptureY(),p=t.scroll,y=t.canvas.el,b=l.getScrollView();switch(p.type){case Zu.V_BOTTOM:case Zu.V_TOP:var g=s,w=s,v=u;if(e.drawImage(y,g,v,c+n.lineWidth(),a,w,d,c+n.lineWidth(),a),e.attr({fillStyle:r.table.background}),o.len-1===b.eri){var m=i.getOriginScrollView();e.fillRect(f,h,c+n.lineWidth(),b.h+(a-m.h))}else e.fillRect(f,h,c+n.lineWidth(),b.h);break;default:e.attr({fillStyle:r.table.background}),e.fillRect(s,u,c,a)}}},{key:"render",value:function(){var t=this.table,e=t.fixedLeftIndexOffset,r=t.grid,o=t.draw;if(e.getScrollViewChange()){var n=e.getScrollView(),i=e.getDwXOffset(),l=e.getDwYOffset(),c=e.getFixedXOffset(),a=e.getFixedYOffset(),s=e.getFixedWidth(),u=e.getFixedHeight(),f=new Dl({x:c,y:a,width:s+r.lineWidth(),height:u}),h=new _l({draw:o,rect:f,offset:r.lineWidth()});h.open(),this.renderClear(),this.draw(n,i,l,s,n.h),h.close()}}}]),t}(),Bd=function t(e){vd(this,t);var r=e.keyboard,o=e.cols,n=e.rows,i=e.edit,l=e.merges,c=e.screenSelector,a=0,s=null;r.register({el:e,focus:!0,stop:!1,attr:{code:9,callback:function(){i.hideEdit();var t=c.selectorAttr,e=t,r=t.rect.clone();if(a!==e){var u=r.sri,f=r.sci;a=e,s={sri:u,sci:f}}var h=o.len-1,d=n.len-1,p=s,y=p.sri,b=p.sci,g=l.getFirstIncludes(y,b);if(g&&(b=g.eci),!(b>=h&&y>=d)){b>=h?(y+=1,b=0):b+=1,s.sri=y,s.sci=b;var w=y,v=b,m=l.getFirstIncludes(y,b);m&&(y=m.sri,b=m.sci,w=m.eri,v=m.eci),r.sri=y,r.sci=b,r.eri=w,r.eci=v,c.selectorAttr.rect=r,c.setOffset(c.selectorAttr),c.onChangeStack.forEach((function(t){return t()})),c.onSelectChangeStack.forEach((function(t){return t()})),i.showEdit()}}}})},Yd={tipsRenderTime:!1,tipsScrollTime:!1,index:{height:30,width:50,bgColor:"#f4f5f8",color:"#000000"},table:{background:"#ffffff",borderColor:"#e5e5e5",gridColor:"#000000",showGrid:!0},data:[],rows:{len:1e4,height:30},cols:{len:26,width:137},merges:[],fixed:{fxTop:-1,fxLeft:-1}},Fd=function(t){function e(t){var r,o,i;return vd(this,e),o=this,i=yd(e).call(this,"".concat(n,"-table")),(r=!i||"object"!==pd(i)&&"function"!=typeof i?bd(o):i).mode=Od.RENDER,r.settings=k.mergeDeep({},Yd,t),r.canvas=new L("".concat(n,"-table-canvas"),"canvas"),r.dynamicView=new Wd(bd(r)),r.cells=new fh({table:bd(r),rows:r.rows,cols:r.cols,data:r.settings.data}),r.fixed=new tf(r.settings.fixed),r.rows=new Ku(r.settings.rows),r.cols=new $u(r.settings.cols),r.merges=new rf(r.settings.merges),r.scroll=new Ju(bd(r)),r.cellsHelper=new dh({cells:r.cells,merges:r.merges,rows:r.rows,cols:r.cols}),r.focus=new fd(bd(r)),r.tableDataSnapshot=new Qh(bd(r)),r.mousePointer=new cd(bd(r)),r.keyboard=new sd(bd(r)),r.draw=new Ll(r.canvas.el),r.offDraw=new dd(r.draw),r.line=new Fi(r.draw,{leftShow:function(t,e){var o=r.cells.getCell(t,e);if(null===o)return!1;var n=r.merges.getFirstIncludes(t,e);return n?r.cells.getCell(n.sri,n.sci).borderAttr.left.display:!!o.borderAttr.left.display&&r.lineHandle.vLineLeftOverFlowChecked(e,t)},topShow:function(t,e){var o=r.cells.getMergeCellOrCell(t,e);return o&&o.borderAttr.top.display},rightShow:function(t,e){var o=r.cells.getCell(t,e);if(null===o)return!1;var n=r.merges.getFirstIncludes(t,e);return n?r.cells.getCell(n.sri,n.sci).borderAttr.right.display:!!o.borderAttr.right.display&&r.lineHandle.vLineRightOverFlowChecked(e,t)},bottomShow:function(t,e){var o=r.cells.getMergeCellOrCell(t,e);return o&&o.borderAttr.bottom.display},iFMerge:function(t,e){return null!==r.merges.getFirstIncludes(t,e)},iFMergeFirstRow:function(t,e){return r.merges.getFirstIncludes(t,e).sri===t},iFMergeLastRow:function(t,e){return r.merges.getFirstIncludes(t,e).eri===t},iFMergeFirstCol:function(t,e){return r.merges.getFirstIncludes(t,e).sci===e},iFMergeLastCol:function(t,e){return r.merges.getFirstIncludes(t,e).eci===e}}),r.grid=new ih(r.draw,{color:r.settings.table.borderColor}),r.lineHandle=new sh(bd(r)),r.borderLineHandle=new gh(bd(r)),r.gridLineHandle=new yh(bd(r)),r.fixedTopOffset=new Ad(bd(r)),r.fixedLeftOffset=new _d(bd(r)),r.contentOffset=new Td(bd(r)),r.fixedTopIndexOffset=new Cd(bd(r)),r.fixedLeftIndexOffset=new Pd(bd(r)),r.frozenLeftIndexOffset=new kd(bd(r)),r.frozenTopIndexOffset=new Ed(bd(r)),r.frozenLeftTopOffset=new Sd(bd(r)),r.content=new Md(bd(r)),r.fixedLeft=new Hd(bd(r)),r.fixedTop=new Vd(bd(r)),r.fixedTopIndex=new Nd(bd(r)),r.fixedLeftIndex=new zd(bd(r)),r.frozenLeftTop=new Ld(bd(r)),r.frozenLeftIndex=new Rd(bd(r)),r.frozenTopIndex=new Dd(bd(r)),r.frozenRect=new Id(bd(r)),r.screen=new yf(bd(r)),r.xReSizer=new xf(bd(r)),r.yReSizer=new _f(bd(r)),r.xHeightLight=new Uf(bd(r)),r.yHeightLight=new Zf(bd(r)),r.edit=new oh(bd(r)),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gd(t,e)}(e,t),xd(e,[{key:"onAttach",value:function(){var t=this;this.bind(),this.screenSelector=new ns(this.screen),this.screenAutoFill=new Mf(this.screen,{onBeforeAutoFill:function(){t.tableDataSnapshot.begin()},onAfterAutoFill:function(){t.tableDataSnapshot.end()}}),this.copyStyle=new Xa(this.screen,{}),this.screen.addWidget(this.screenSelector),this.screen.addWidget(this.screenAutoFill),this.screen.addWidget(this.copyStyle),this.screenSelector.on(os.SELECT_CHANGE,(function(){t.trigger(o.TABLE_EVENT_TYPE.SELECT_CHANGE)})),this.screenSelector.on(os.DOWN_SELECT,(function(){t.trigger(o.TABLE_EVENT_TYPE.SELECT_DOWN)})),this.attach(this.canvas),this.attach(this.screen),this.attach(this.xReSizer),this.attach(this.yReSizer),this.attach(this.xHeightLight),this.attach(this.yHeightLight),this.attach(this.edit),this.keyBoardTab=new Bd(this)}},{key:"bind",value:function(){var t=this,e=this.mousePointer,r=this.dynamicView;Rt.bind(this,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){r.cpRange(),t.render()})),Rt.bind(this,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){r.cpRange(),t.render()})),Rt.bind(this,o.SYSTEM_EVENT_TYPE.SCROLL,(function(){r.cpRange(),t.render()})),Rt.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(r){var n=t.computeEventXy(r),i=n.x,l=n.y,c=t.getRiCiByXy(i,l),a=c.ri,s=c.ci;if(-1!==a)if(-1!==s){var u=o.MOUSE_POINTER_TYPE.SELECT_CELL,f=u.type,h=u.key;e.set(f,h)}else{var d=o.MOUSE_POINTER_TYPE.SELECT_ONE_ROW,p=d.type,y=d.key;e.set(p,y)}else{var b=o.MOUSE_POINTER_TYPE.SELECT_ONE_COLUMN,g=b.type,w=b.key;e.set(g,w)}}))}},{key:"drawOptimization",value:function(){var t=this.cellsHelper,e=this.dynamicView.getOriginScrollView(),r=!0;t.getCellByViewRange({rectRange:e,callback:function(t,e,o){var n=o.borderAttr,i=n.top,l=n.left,c=n.right,a=n.bottom;return i.type===Ni.DOUBLE_LINE?r=!1:l.type===Ni.DOUBLE_LINE?r=!1:c.type===Ni.DOUBLE_LINE?r=!1:a.type!==Ni.DOUBLE_LINE||(r=!1)}}),r?this.borderLineHandle.openDrawOptimization():this.borderLineHandle.closeDrawOptimization()}},{key:"scrollX",value:function(t){var e=this.cols,r=this.fixed,n=this.settings,i=this.scroll;n.tipsScrollTime&&console.time();var l=r.fxLeft;l+=1;var c,a=wd(k.rangeReduceIf(l,e.len,0,0,t,(function(t){return e.getWidth(t)})),3),s=a[0],u=a[1],f=a[2],h=u;t>0&&(h+=f),i.x>h?c=Zu.H_LEFT:i.x<h&&(c=Zu.H_RIGHT),i.type=c,i.ci=s,i.x=h,n.tipsScrollTime&&(console.log("滚动条计算耗时:"),console.timeEnd()),this.mode=Od.SCROLL,this.trigger(o.SYSTEM_EVENT_TYPE.SCROLL),this.mode=Od.RENDER,i.type=Zu.UN}},{key:"scrollY",value:function(t){var e=this.rows,r=this.fixed,n=this.settings,i=this.scroll;n.tipsScrollTime&&console.time();var l=r.fxTop;l+=1;var c,a=wd(k.rangeReduceIf(l,e.len,0,0,t,(function(t){return e.getHeight(t)})),3),s=a[0],u=a[1],f=a[2],h=u;t>0&&(h+=f),i.y>h?c=Zu.V_TOP:i.y<h&&(c=Zu.V_BOTTOM),i.type=c,i.ri=s,i.y=h,n.tipsScrollTime&&(console.log("滚动条计算耗时:"),console.timeEnd()),this.mode=Od.SCROLL,this.trigger(o.SYSTEM_EVENT_TYPE.SCROLL),this.mode=Od.RENDER,i.type=Zu.UN}},{key:"visualHeight",value:function(){return this.box().height}},{key:"visualWidth",value:function(){return this.box().width}},{key:"resize",value:function(){var t=this.offDraw,e=this.draw,r=this.dynamicView,o=[this.visualWidth(),this.visualHeight()],n=o[0],i=o[1];e.resize(n,i),t.resize(n,i),r.cpRange(),this.render()}},{key:"render",value:function(){var t=this.settings,e=this.fixed;t.tipsRenderTime&&console.time(),this.drawOptimization(),this.frozenRect.render(),e.fxLeft>-1&&e.fxTop>-1&&this.frozenLeftTop.render(),e.fxTop>-1&&(this.frozenLeftIndex.render(),this.fixedTop.render()),e.fxLeft>-1&&(this.frozenTopIndex.render(),this.fixedLeft.render()),this.content.render(),this.fixedLeftIndex.render(),this.fixedTopIndex.render(),t.tipsRenderTime&&(console.log("渲染界面耗时:"),console.timeEnd())}},{key:"getContentWidth",value:function(){return this.content.getContentWidth()}},{key:"getContentHeight",value:function(){return this.content.getContentHeight()}},{key:"getFixedWidth",value:function(){return this.fixedLeftOffset.getFixedWidth()}},{key:"getFixedHeight",value:function(){return this.fixedTopOffset.getFixedHeight()}},{key:"getContentViewRange",value:function(){return this.dynamicView.getOriginContentView()}},{key:"getScrollViewRange",value:function(){return this.dynamicView.getOriginScrollView()}},{key:"getScrollViewXOffset",value:function(){return this.dynamicView.getScrollXOffset()}},{key:"getRiCiByXy",value:function(t,e){var r=this.settings,o=this.fixed,n=this.rows,i=this.cols,l=r.index,c=this.getFixedHeight(),a=this.getFixedWidth(),s=t,u=e,f=-1,h=-1;if(s-=l.width,u-=l.height,s<=a&&t>l.width)for(var d=0,p=0;p<=o.fxLeft;p+=1){if(f=p,(d+=i.getWidth(p))>s)break}else if(t>l.width)for(var y=a,b=this.getScrollViewRange(),g=b.sci;g<=b.eci;g+=1){if(f=g,(y+=i.getWidth(g))>s)break}if(u<c&&e>l.height)for(var w=0,v=0;v<=o.fxTop;v+=1){if(h=v,(w+=n.getHeight(v))>u)break}else if(e>l.height)for(var m=c,x=this.getScrollViewRange(),O=x.sri;O<=x.eri;O+=1){if(h=O,(m+=n.getHeight(O))>u)break}return{ri:h,ci:f}}},{key:"getIndexWidth",value:function(){return this.settings.index.width}},{key:"getIndexHeight",value:function(){return this.settings.index.height}},{key:"toString",value:function(){var t={rows:{data:this.rows.getData()},cols:{data:this.cols.getData()},merges:{data:this.merges.getData()}};return JSON.stringify(t)}}]),e}(L);function Ud(t){return(Ud="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xd(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Gd(t,e){return!e||"object"!==Ud(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Kd(t){return(Kd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qd(t,e){return(qd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $d=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{tableConfig:{data:[]}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Gd(this,Kd(e).call(this,"".concat(n,"-sheet")))).options=r,t.table=new Fd(t.options.tableConfig),t}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qd(t,e)}(e,t),r=e,(i=[{key:"bind",value:function(){var t=this;Rt.bind(this.table,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(e){t.trigger(o.TABLE_EVENT_TYPE.CHANGE_WIDTH,t),e.stopPropagation()})),Rt.bind(this.table,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(e){t.trigger(o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,t),e.stopPropagation()})),Rt.bind(this.table,o.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(e){t.trigger(o.TABLE_EVENT_TYPE.SELECT_CHANGE,t),e.stopPropagation()})),Rt.bind(this.table,o.TABLE_EVENT_TYPE.SELECT_DOWN,(function(e){t.trigger(o.TABLE_EVENT_TYPE.SELECT_DOWN,t),e.stopPropagation()}))}},{key:"onAttach",value:function(){this.attach(this.table),this.bind()}}])&&Xd(r.prototype,i),l&&Xd(r,l),e}(L);function Zd(t){return(Zd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jd(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Qd(t,e){return!e||"object"!==Zd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tp(t){return(tp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ep(t,e){return(ep=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rp=function(t){function e(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{sheets:[]};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Qd(this,tp(e).call(this,"".concat(n,"-work-body")))).work=t,r.workConfig=o,r.sheets=r.workConfig.sheets,r.tabSheet=[],r.poweredBy=_("div","".concat(n,"-powered-by-tips")),r.poweredBy.text(" X-Sheet 1.0.1-development "),r.children(r.poweredBy),r.sheetViewLayer=new Zt({style:{flexGrow:1}}),r.scrollBarYLayer=new Zt({style:{overflow:"inherit"}}),r.scrollBarXLayer=new yu,r.scrollBarXVerticalCenter=new mu,r.scrollBarXHorizontalLayer=new Zt({style:{flexGrow:2}}),r.scrollBarXVerticalCenter.children(r.scrollBarXLayer),r.scrollBarXHorizontalLayer.children(r.scrollBarXVerticalCenter),r.sheetSwitchTabLayer=new Zt({style:{flexGrow:3}}),r.horizontalLayer1=new re,r.horizontalLayer2=new re,r.horizontalLayer1.children(r.sheetViewLayer),r.horizontalLayer1.children(r.scrollBarYLayer),r.horizontalLayer2.children(r.sheetSwitchTabLayer),r.horizontalLayer2.children(r.scrollBarXHorizontalLayer),r.horizontalLayer1Layer=new K({style:{flexGrow:1}}),r.horizontalLayer2Layer=new K,r.layerVerticalLayer=new Y,r.horizontalLayer1Layer.children(r.horizontalLayer1),r.horizontalLayer2Layer.children(r.horizontalLayer2),r.layerVerticalLayer.children(r.horizontalLayer1Layer),r.layerVerticalLayer.children(r.horizontalLayer2Layer),r.children(r.layerVerticalLayer),r.sheetView=new _u,r.scrollBarY=new Xt({scroll:function(t){r.sheetView.getActiveSheet().table.scrollY(t)}}),r.tabView=new Lu({onAdd:function(){var t=new $d,e=new Nu;r.addTabSheet({tab:e,sheet:t})},onSwitch:function(t){r.setActiveTab(t)}}),r.scrollBarX=new Nt({scroll:function(t){r.sheetView.getActiveSheet().table.scrollX(t)}}),r}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ep(t,e)}(e,t),r=e,(i=[{key:"updateScroll",value:function(){var t=this.sheetView.getActiveSheet();if(!k.isUnDef(t)){var e=this.scrollBarXHorizontalLayer,r=t.table,o=r.content,n=r.contentOffset,i=r.scroll;e.display(n.getFixedWidth()<o.getContentWidth()),this.scrollBarY.setSize(n.getFixedHeight(),o.getContentHeight()),this.scrollBarX.setSize(n.getFixedWidth(),o.getContentWidth()),this.scrollBarY.scrollMove(i.y),this.scrollBarX.scrollMove(i.x)}}},{key:"createSheet",value:function(){var t=!0,e=!1,r=void 0;try{for(var o,n=this.sheets[Symbol.iterator]();!(t=(o=n.next()).done);t=!0){var i=o.value,l=i.name,c=new $d(i),a=new Nu(l);this.addTabSheet({tab:a,sheet:c})}}catch(t){e=!0,r=t}finally{try{t||null==n.return||n.return()}finally{if(e)throw r}}this.tabSheet.length&&this.setActiveIndex(0)}},{key:"bind",value:function(){var t=this;this.on(o.SYSTEM_EVENT_TYPE.MOUSE_WHEEL,(function(e){var r=t.sheetView.getActiveSheet();if(!k.isUnDef(r)){var o=r.table,n=o.rows,i=o.scroll,l=t.scrollBarY.scrollTo,c=e.deltaY;e.detail&&(c=40*e.detail),c>0?t.scrollBarY.scrollMove(l+n.getHeight(i.ri)):t.scrollBarY.scrollMove(l-n.getHeight(i.ri-1)),i.blockTop<i.maxBlockTop&&i.blockTop>0&&(e.preventDefault(),e.stopPropagation())}})),Rt.bind(window,o.SYSTEM_EVENT_TYPE.RESIZE,(function(){t.sheetView.getActiveSheet().table.resize(),t.updateScroll()})),Rt.bind(this.sheetView,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.updateScroll()})),Rt.bind(this.sheetView,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.updateScroll()})),Rt.bind(this.sheetView,o.TABLE_EVENT_TYPE.DATA_CHANGE,(function(e){t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),e.stopPropagation()})),Rt.bind(this.sheetView,o.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(e){t.trigger(o.TABLE_EVENT_TYPE.SELECT_CHANGE),e.stopPropagation()})),Rt.bind(this.sheetView,o.TABLE_EVENT_TYPE.SELECT_DOWN,(function(e){t.trigger(o.TABLE_EVENT_TYPE.SELECT_DOWN,t),e.stopPropagation()}))}},{key:"onAttach",value:function(){var t=this.sheetViewLayer,e=this.scrollBarYLayer,r=this.sheetSwitchTabLayer,o=this.scrollBarXLayer;t.attach(this.sheetView),e.attach(this.scrollBarY),r.attach(this.tabView),o.attach(this.scrollBarX),this.bind(),this.createSheet(),this.updateScroll()}},{key:"addTabSheet",value:function(t){var e=t.tab,r=t.sheet,o=this.tabSheet,n=this.sheetView,i=this.tabView;n.attach(r),i.attach(e),o.push({tab:e,sheet:r})}},{key:"setActiveIndex",value:function(t){var e=this.sheetView,r=this.tabView,n=e.setActiveSheet(t),i=r.setActiveTab(t);if(n&&i){var l=n.table;this.updateScroll(),l.resize(),this.trigger(o.WORK_BODY_EVENT_TYPE.CHANGE_ACTIVE)}}},{key:"setActiveTab",value:function(t){var e=this;this.tabSheet.forEach((function(r,o){r.tab===t&&e.setActiveIndex(o)}))}}])&&Jd(r.prototype,i),l&&Jd(r,l),e}(L);function op(t){return(op="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function np(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ip(t,e){return!e||"object"!==op(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function lp(t){return(lp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cp(t,e){return(cp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ap=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ip(this,lp(e).call(this,"".concat(n,"-bottom-menu")))).sum=_("div","".concat(n,"-bottom-sum")),t.avg=_("div","".concat(n,"-bottom-avg")),t.number=_("div","".concat(n,"-bottom-number")),t.children(t.sum),t.children(t.avg),t.children(t.number),t}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cp(t,e)}(e,t),r=e,(o=[{key:"setSum",value:function(t){this.sum.text("求和: ".concat(t))}},{key:"setAvg",value:function(t){this.avg.text("平均数: ".concat(t))}},{key:"setNumber",value:function(t){this.number.text("数量: ".concat(t))}}])&&np(r.prototype,o),i&&np(r,i),e}(L);function sp(t){return(sp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function up(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function fp(t,e){return!e||"object"!==sp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hp(t){return(hp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dp(t,e){return(dp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pp=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=fp(this,hp(e).call(this,"".concat(n,"-work-bottom")))).work=t,r}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dp(t,e)}(e,t),r=e,(o=[{key:"onAttach",value:function(){this.bottomMenu=new ap,this.attach(this.bottomMenu)}}])&&up(r.prototype,o),i&&up(r,i),e}(L);function yp(t){return(yp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bp(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function gp(t){return(gp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function vp(t,e){return(vp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mp=function(t){function e(){var t,r,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{body:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(t=!(o=gp(e).call(this,"".concat(n,"-work")))||"object"!==yp(o)&&"function"!=typeof o?wp(r):o).options=i.workConfig,t.topLayer=new K,t.bodyLayer=new K({style:{flexGrow:1}}),t.bottomLayer=new K,t.verticalLayer=new Y,t.verticalLayer.children(t.topLayer),t.verticalLayer.children(t.bodyLayer),t.verticalLayer.children(t.bottomLayer),t.children(t.verticalLayer),t.top=new uu(wp(t)),t.body=new rp(wp(t),t.options.body),t.bottom=new pp(wp(t)),t}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vp(t,e)}(e,t),r=e,(o=[{key:"onAttach",value:function(){var t=this.bodyLayer,e=this.topLayer,r=this.bottomLayer;e.attach(this.top),r.attach(this.bottom),t.attach(this.body),this.bottom.bottomMenu.setSum(0),this.bottom.bottomMenu.setAvg(0),this.bottom.bottomMenu.setNumber(0)}}])&&bp(r.prototype,o),i&&bp(r,i),e}(L);r(3),r(4),r(5);function xp(t){return(xp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Op(t){return(Op=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ep(t,e){return(Ep=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}r.d(e,"XSheet",(function(){return Sp}));var Sp=function(t){function e(t){var r,o,i,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{workConfig:{body:{sheets:[{tableConfig:{}}]}}};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,r=!(i=Op(e).call(this,"".concat(n)))||"object"!==xp(i)&&"function"!=typeof i?kp(o):i;var c=t;return"string"==typeof t&&(c=document.querySelector(t)),(c=_(c)).children(kp(r)),r.work=new mp(l),r.attach(r.work),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ep(t,e)}(e,t),e}(L);Sp.version="1.0.1-alpha",window&&(window.XSheet=Sp)}]);
//# sourceMappingURL=XSheet.js.map