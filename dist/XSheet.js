!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=5)}([function(t,e,n){t.exports=n.p+"c4ab8001e109540f7ae6a34181d695d3.png"},function(t,e,n){t.exports=n.p+"42b436e7c64603182355d52d31ea49f1.png"},function(t,e,n){t.exports=n.p+"9dfd8685ea7e1e5c025514eec46a4547.png"},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var r={};r.SYSTEM_EVENT_TYPE={MOUSE_MOVE:"mouseMove".toLocaleLowerCase(),MOUSE_DOWN:"mouseDown".toLocaleLowerCase(),MOUSE_UP:"mouseUp".toLocaleLowerCase(),MOUSE_OVER:"mouseOver".toLocaleLowerCase(),MOUSE_LEAVE:"mouseLeave".toLocaleLowerCase(),MOUSE_WHEEL:"mouseWheel".toLocaleLowerCase(),MOUSE_ENTER:"mouseEnter".toLocaleLowerCase(),CLICK:"click".toLocaleLowerCase(),KEY_DOWN:"keyDown".toLocaleLowerCase(),KEY_UP:"keyUp".toLocaleLowerCase(),DRAG_START:"dragStart".toLocaleLowerCase(),SCROLL:"scroll".toLocaleLowerCase(),RESIZE:"resize".toLocaleLowerCase(),CHANGE:"change".toLocaleLowerCase(),INPUT:"input".toLocaleLowerCase(),VISIBILITY_CHANGE:"visibilityChange".toLocaleLowerCase()},r.TABLE_EVENT_TYPE={CHANGE_HEIGHT:"tableChangeHeight".toLocaleLowerCase(),CHANGE_WIDTH:"tableChangeWidth".toLocaleLowerCase(),DATA_CHANGE:"tableDataChange".toLocaleLowerCase(),SELECT_CHANGE:"tableSelectChange".toLocaleLowerCase(),SELECT_DOWN:"tableSelectDown".toLocaleLowerCase()},r.WORK_BODY_EVENT_TYPE={CHANGE_ACTIVE:"workBodyChangeActive".toLocaleLowerCase()},r.MOUSE_POINTER_TYPE={SELECT_ONE_COLUMN:{key:Symbol("选择一列"),type:"s-resize"},SELECT_ONE_ROW:{key:Symbol("选择一行"),type:"e-resize"},SELECT_CELL:{key:Symbol("选择单元格"),type:"cell"},AUTO_FILL:{key:Symbol("单元格内容自动填充"),type:"crosshair"},COL_RESIZE:{key:Symbol("调整列宽"),type:"col-resize"},ROW_RESIZE:{key:Symbol("调整行高"),type:"row-resize"}};var o="x-sheet";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],s=null,u=1,f=2,h=3,p=5,y=6,b=7,d=8,g=9,v=10,w=11,m=12,O=13,E=14,S=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,n=null,r=[{key:"type",value:function(t){var e=Object.prototype.toString.call(t);switch(e){case"[object Null]":return b;case"[object Undefined]":return d;case"[object String]":return u;case"[object Boolean]":return f;case"[object Number]":return h;case"[object Function]":return y;case"[object Array]":return p;case"[object Promise]":return g;case"[object GeneratorFunction]":return v;case"[object AsyncFunction]":return w;case"[object BigInt]":return m;case"[object Symbol]":return O;default:return E}}},{key:"cloneDeep",value:function(t){var e=JSON.stringify(t);return JSON.parse(e)}},{key:"mergeDeep",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.isUnDef(e))return{};for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return t.isUnDef(r)||0===r.length?e:(r.forEach((function(n){t.isUnDef(n)||Object.keys(n).forEach((function(r){var o=n[r];"string"==typeof o||"number"==typeof o||"boolean"==typeof o?e[r]=o:"function"!=typeof o&&!Array.isArray(o)&&t.isPlainObject(o)?(e[r]=e[r]||{},t.mergeDeep(e[r],o)):e[r]=o}))})),e)}},{key:"copyProp",value:function(t,e){return Object.assign(t,e)}},{key:"isMac",value:function(){return/macintosh|mac os x/i.test(navigator.userAgent)}},{key:"isWindows",value:function(){return/windows|win32/i.test(navigator.userAgent)}},{key:"isEmptyObject",value:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}},{key:"isNotEmptyObject",value:function(e){return!t.isEmptyObject(e)}},{key:"isUnDef",value:function(t){return null==t}},{key:"isNotUnDef",value:function(t){return!this.isUnDef(t)}},{key:"isNotZero",value:function(t){return 0!==t}},{key:"isNumber",value:function(t){return/^(-?\d+.\d+)$|^(-?\d+)$/.test(t)}},{key:"isFraction",value:function(t){return/^\d+\/\d+$/.test(t)}},{key:"isFunction",value:function(e){return t.type(e)===y}},{key:"isArray",value:function(e){return t.type(e)===p}},{key:"isBlank",value:function(e){return!!t.isUnDef(e)||""===e.toString()}},{key:"isPlainObject",value:function(e){return!t.isUnDef(e)&&Object.getPrototypeOf(e)===Object.getPrototypeOf({})}},{key:"isString",value:function(e){return t.type(e)===u}},{key:"sum",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},n=0,r=0;return Object.keys(t).forEach((function(o){n+=e(t[o],o),r+=1})),[n,r]}},{key:"rangeSum",value:function(t,e,n){for(var r=0,o=t;o<e;o+=1)r+=n(o);return r}},{key:"parseFloat",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(e){return t.isNumber(e)?parseFloat(e):0}))},{key:"parseInt",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(e){return t.isNumber(e)?parseInt(e,10):0}))},{key:"stringAt",value:function(t){for(var e="",n=t;n>=a.length;)n/=a.length,n-=1,e+=a[parseInt(n,10)%a.length];return e+=a[t%a.length]}},{key:"indexAt",value:function(t){for(var e=0,n=0;n<t.length-1;n+=1){var r=t.charCodeAt(n)-65,o=t.length-1-n;e+=Math.pow(a.length,o)+a.length*r}return e+=t.charCodeAt(t.length-1)-65}},{key:"expr2xy",value:function(e){for(var n="",r="",o=0;o<e.length;o+=1)e.charAt(o)>="0"&&e.charAt(o)<="9"?r+=e.charAt(o):n+=e.charAt(o);return[t.indexAt(n),parseInt(r,10)-1]}},{key:"xy2expr",value:function(e,n){return"".concat(t.stringAt(e)).concat(n+1)}},{key:"expr2expr",value:function(e,n,r){var o=c(t.expr2xy(e),2),i=o[0],l=o[1];return t.xy2expr(i+n,l+r)}},{key:"rangeReduceIf",value:function(t,e,n,r,o,i){for(var c=n,l=r,a=t;a<e&&!(c>=o);a+=1)c+=l=i(a);return[a,c-l,l]}},{key:"throttle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;s&&clearTimeout(s),s=setTimeout(t,e)}},{key:"contrastDifference",value:function(e,n){var r={};if(t.isUnDef(e)||t.isUnDef(n))return r;for(var o in e)if(e.hasOwnProperty(o)){var i=n[o],c=e[o];t.isUnDef(i)||t.isUnDef(c)||t.equal(i,c)||(r[o]=e[o])}return r}},{key:"minIf",value:function(t,e){return t<e?e:t}},{key:"maxIf",value:function(t,e){return t>e?e:t}},{key:"equal",value:function(t,e){var n,r,o,c;function l(t,e){var n;if(isNaN(t)&&isNaN(e)&&"number"==typeof t&&"number"==typeof e)return!0;if(t===e)return!0;if("function"==typeof t&&"function"==typeof e||t instanceof Date&&e instanceof Date||t instanceof RegExp&&e instanceof RegExp||t instanceof String&&e instanceof String||t instanceof Number&&e instanceof Number)return t.toString()===e.toString();if(!(t instanceof Object&&e instanceof Object))return!1;if(t.isPrototypeOf(e)||e.isPrototypeOf(t))return!1;if(t.constructor!==e.constructor)return!1;if(t.prototype!==e.prototype)return!1;if(o.indexOf(t)>-1||c.indexOf(e)>-1)return!1;for(n in e){if(e.hasOwnProperty(n)!==t.hasOwnProperty(n))return!1;if(i(e[n])!==i(t[n]))return!1}for(n in t){if(e.hasOwnProperty(n)!==t.hasOwnProperty(n))return!1;if(i(e[n])!==i(t[n]))return!1;switch(i(t[n])){case"object":case"function":if(o.push(t),c.push(e),!l(t[n],e[n]))return!1;o.pop(),c.pop();break;default:if(t[n]!==e[n])return!1}}return!0}if(arguments.length<1)return!0;for(n=1,r=arguments.length;n<r;n++)if(o=[],c=[],!l(arguments[0],arguments[n]))return!1;return!0}},{key:"arrayIncludeArray",value:function(e,n){if(t.isUnDef(e)||t.isUnDef(n))return!1;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r+=1)if(-1===n.indexOf(e[r]))return!1;return!0}},{key:"keepLastIndex",value:function(t){if(window.getSelection){t.focus();var e=window.getSelection();e.selectAllChildren(t),e.collapseToEnd()}else if(document.selection){var n=document.selection.createRange();n.moveToElementText(t),n.collapse(!1),n.select()}}},{key:"trim",value:function(t){return this.isBlank(t)?"":t.trim()}},{key:"now",value:function(){return Date.now().toString()}},{key:"viewPort",value:function(){return{width:window.innerWidth,height:window.innerHeight}}}],n&&l(e.prototype,n),r&&l(e,r),t}();function x(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function _(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}S.EMPTY="",S.Nul=null,S.Undef=void 0;var k=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=n):this.el=e,this.el.data=[]}var e,n,r;return e=t,(n=[{key:"data",value:function(t,e){return void 0!==e?(this.el.data[t]=e,this):this.el.data[t]}},{key:"on",value:function(t,e){var n=x(t.split(".")),r=n[0],o=n.slice(1),i=r;return"mousewheel"===i&&/Firefox/i.test(window.navigator.userAgent)&&(i="DOMMouseScroll"),this.el.addEventListener(i,(function(t){e(t);for(var n=0;n<o.length;n+=1){var r=o[n];if("left"===r&&0!==t.button)return;if("right"===r&&2!==t.button)return;"stop"===r&&t.stopPropagation()}})),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach((function(n){e.css(n,"".concat(t[n],"px"))})),this;var n=this.el;return{top:n.offsetTop,left:n.offsetLeft,height:n.offsetHeight,width:n.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"scrollTop",value:function(){return this.el.scrollTop}},{key:"clientHeight",value:function(){return this.el.clientHeight}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return 0===arguments.length?this.el.childNodes:(n.forEach((function(e){return t.child(e)})),this)}},{key:"first",value:function(){return this.el.firstChild}},{key:"last",value:function(){return this.el.lastChild}},{key:"remove",value:function(t){return this.el.removeChild(t.el||t)}},{key:"prepend",value:function(t){var e=this.el;return e.children.length>0?e.insertBefore(t,e.firstChild):e.appendChild(t),this}},{key:"prev",value:function(){return this.el.previousSibling}},{key:"next",value:function(){return this.el.nextSibling}},{key:"child",value:function(e){var n=e;return"string"==typeof e?n=document.createTextNode(e):e instanceof t&&(n=e.el),this.el.appendChild(n),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var n=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach((function(e){n.el.setAttribute(e,t[e])}))}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach((function(e){return t.el.style.removeProperty(e)})),this}},{key:"css",value:function(t,e){var n=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach((function(e){n.el.style[e]=t[e]})),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){var t=this.computedStyle();return t&&"block"!==t.display&&this.css("display","block"),this}},{key:"hide",value:function(){var t=this.computedStyle();return t&&"none"!==t.display&&this.css("display","none"),this}},{key:"display",value:function(t){t?this.show():this.hide()}},{key:"text",value:function(t){return void 0===t?this.el.innerText:(this.el.innerText=t,t)}},{key:"sibling",value:function(){for(var e=this.el,n=[];null!==(e=e.previousElementSibling);)n.push(new t(e));for(e=this.el;null!==(e=e.nextElementSibling);)n.push(new t(e));return n}},{key:"position",value:function(){var t=0,e=0;return this.el.style.position&&(this.el.top&&(t=this.el.style.top.replace("%","").repeat("px","")),this.el.left&&(e=this.el.style.left.replace("%","").repeat("px","")),this.el.right&&(t=this.el.style.right.replace("%","").repeat("px","")),this.el.bottom&&(t=this.el.style.bottom.replace("%","").repeat("px",""))),{top:S.parseFloat(t),left:S.parseFloat(e),right:S.parseFloat(0),bottom:S.parseFloat(0)}}},{key:"trigger",value:function(t,e){var n=new CustomEvent(t,{detail:e,bubbles:!0,cancelable:!1});this.el.dispatchEvent(n)}},{key:"focus",value:function(){this.el.focus()}},{key:"find",value:function(e){var n=this.el.querySelectorAll(e);if(n&&1===n.length)return new t(n[0]);var r=[];if(n){var o=!0,i=!1,c=void 0;try{for(var l,a=n[Symbol.iterator]();!(o=(l=a.next()).done);o=!0){var s=l.value;r.push(new t(s))}}catch(t){i=!0,c=t}finally{try{o||null==a.return||a.return()}finally{if(i)throw c}}}return r}},{key:"isChild",value:function(t){for(var e=t||t.el;null!=e&&e!==document.body;){if(e===this.el)return!0;e=e.parentNode}return!1}}])&&_(e.prototype,n),r&&_(e,r),t}(),T=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new k(t,e)};function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function P(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function A(t,e){return!e||"object"!==C(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function L(t,e){return(L=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var R=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),A(this,j(e).call(this,n,"".concat(o,"-widget ").concat(t)))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(e,t),n=e,(r=[{key:"computeEventXy",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=e.box(),r=n.top,o=n.left;return{x:t.pageX-o,y:t.pageY-r}}},{key:"computeWidgetXy",value:function(t){if(!t)return{x:0,y:0};var e=t.box(),n=e.top,r=e.left,o=this.box(),i=o.top;return{x:r-o.left,y:n-i}}},{key:"attach",value:function(t){this.children(t),t.onAttach()}},{key:"onAttach",value:function(){}}])&&P(n.prototype,r),i&&P(n,i),e}(k);function W(t){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function V(t,e){return!e||"object"!==W(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function H(t){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function M(t,e){return(M=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var N=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),V(this,H(e).call(this,"".concat(o,"-layer ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&M(t,e)}(e,t),e}(R);function D(t){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function I(t,e){return!e||"object"!==D(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function B(t){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Y(t,e){return(Y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var F=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=I(this,B(e).call(this,"".concat(o,"-vertical-layer")))).options=S.mergeDeep({style:{}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Y(t,e)}(e,t),e}(N);function z(t){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function U(t,e){return!e||"object"!==z(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function X(t){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function G(t,e){return(G=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var K=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=U(this,X(e).call(this,"".concat(o,"-vertical-layer-element")))).options=S.mergeDeep({style:{flexGrow:"0"}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&G(t,e)}(e,t),e}(N);function q(t){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Z(t,e){return!e||"object"!==q(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function J(t){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Q(t,e){return(Q=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var tt=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Z(this,J(e).call(this,"".concat(o,"-icon")))).iconNameEl=T("div","".concat(o,"-icon-img ").concat(n)),t.child(t.iconNameEl),t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Q(t,e)}(e,t),n=e,(r=[{key:"setWidth",value:function(t){this.iconNameEl.css("width","".concat(t,"px"))}},{key:"setHeight",value:function(t){this.iconNameEl.css("height","".concat(t,"px"))}}])&&$(n.prototype,r),i&&$(n,i),e}(R);function et(t){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nt(t,e){return!e||"object"!==et(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function rt(t){return(rt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ot(t,e){return(ot=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var it=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),nt(this,rt(e).call(this,"".concat(o,"-tools-item ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ot(t,e)}(e,t),e}(R);function ct(t){return(ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lt(t,e){return!e||"object"!==ct(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function at(t){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function st(t,e){return(st=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ut=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=lt(this,at(e).call(this,"".concat(o,"-tools-undo")))).icon=new tt("undo"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&st(t,e)}(e,t),e}(it);function ft(t){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ht(t,e){return!e||"object"!==ft(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pt(t){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yt(t,e){return(yt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ht(this,pt(e).call(this,"".concat(o,"-tools-redo")))).icon=new tt("redo"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yt(t,e)}(e,t),e}(it);function dt(t){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vt(t,e){return!e||"object"!==dt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wt(t){return(wt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mt(t,e){return(mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ot=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=vt(this,wt(e).call(this,"".concat(o,"-tools-point-format")))).icon=new tt("point-format"),t.sheets=[],t.children(t.icon),t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mt(t,e)}(e,t),n=e,(r=[{key:"addSheet",value:function(t){this.sheets.push(t)}},{key:"removeSheet",value:function(t){for(var e=0;e<this.sheets.length;e+=1)if(this.sheets[e]===t)return void this.sheets.splice(e,1)}},{key:"includeSheet",value:function(t){for(var e=0;e<this.sheets.length;e+=1)if(this.sheets[e]===t)return!0;return!1}}])&&gt(n.prototype,r),i&&gt(n,i),e}(it);function Et(t){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function St(t,e){return!e||"object"!==Et(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xt(t){return(xt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _t(t,e){return(_t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=St(this,xt(e).call(this,"".concat(o,"-tools-clear-format")))).icon=new tt("clear-format"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_t(t,e)}(e,t),e}(it);function Tt(t){return(Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ct(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pt(t,e){return!e||"object"!==Tt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function At(t){return(At=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jt(t,e){return(jt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Lt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Pt(this,At(e).call(this,"".concat(o,"-tools-drop-down-item ").concat(t)))).drop=T("div","".concat(o,"-tools-drop-down-item-mark")),n.title=T("div","".concat(o,"-tools-drop-down-item-title")),n.drop.children(new tt("arrow-down")),n.children(n.title),n.children(n.drop),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jt(t,e)}(e,t),n=e,(r=[{key:"setTitle",value:function(t){this.title.text(t)}},{key:"setIcon",value:function(t){this.title.html(""),this.title.children(t)}},{key:"setWidth",value:function(t){this.title.css("width","".concat(t,"px"))}},{key:"setEllipsis",value:function(){this.title.css("overflow","hidden"),this.title.css("text-overflow","ellipsis"),this.title.css("white-space","nowrap")}},{key:"removeEllipsis",value:function(){this.title.cssRemoveKeys("overflow"),this.title.cssRemoveKeys("text-overflow"),this.title.cssRemoveKeys("white-space")}}])&&Ct(n.prototype,r),i&&Ct(n,i),e}(it);function Rt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Wt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,o=[{key:"bind",value:function(t,e,n){if(Array.isArray(t)){var r=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var a=c.value;(a.el||a).addEventListener(e,n)}}catch(t){o=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}}else(t.el||t).addEventListener(e,n)}},{key:"unbind",value:function(t,e,n){if(Array.isArray(t)){var r=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var a=c.value;(a.el||a).addEventListener(e,n)}}catch(t){o=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}}else(t.el||t).removeEventListener(e,n)}},{key:"mouseMoveUp",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=function i(c){t.unbind(e,r.SYSTEM_EVENT_TYPE.MOUSE_MOVE,n),t.unbind(e,r.SYSTEM_EVENT_TYPE.MOUSE_UP,i),o(c)};t.bind(e,r.SYSTEM_EVENT_TYPE.MOUSE_MOVE,n),t.bind(e,r.SYSTEM_EVENT_TYPE.MOUSE_UP,i)}},{key:"dbClick",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=0;t.bind(e,r.SYSTEM_EVENT_TYPE.CLICK,(function(t){var e=Date.now();e-o<=300?(n(t),o=0):o=e}))}}],(n=null)&&Rt(e.prototype,n),o&&Rt(e,o),t}();function Vt(t){return(Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mt(t,e){return!e||"object"!==Vt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Nt(t){return(Nt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dt(t,e){return(Dt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var It=function(t){function e(t){var n,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Mt(this,Nt(e).call(this,"".concat(o,"-scroll-bar-x")))).option=S.mergeDeep({style:{},scroll:function(t){return t}},t),r.lastBut=T("div","".concat(o,"-scroll-bar-x-last-but")),r.nextBut=T("div","".concat(o,"-scroll-bar-x-next-but")),r.content=T("div","".concat(o,"-scroll-bar-x-content")),r.block=T("div","".concat(o,"-scroll-bar-x-block")),r.content.children(r.block),(n=r).children.apply(n,[r.lastBut,r.nextBut,r.content]),r.blockLeft=0,r.maxBlockLeft=0,r.blockWidth=0,r.minBlockWidth=20,r.scrollTo=0,r.contentWidth=0,r.viewPortWidth=0,r.isHide=!0,r.css(r.option.style),r.hide(),r}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dt(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"bind",value:function(){var t=this;this.block.on(r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(0===e.button){var n=t.computeEventXy(e,t.block);Wt.mouseMoveUp(T(document),(function(e){var r=t.computeEventXy(e,t.content).x-n.x;r<0&&(r=0),r>t.maxBlockLeft&&(r=t.maxBlockLeft),t.blockLeft=r,t.scrollTo=t.computeScrollTo(t.blockLeft),t.block.css("left","".concat(r,"px")),t.option.scroll(t.scrollTo),e.stopPropagation(),e.preventDefault()})),e.stopPropagation(),e.preventDefault()}}))}},{key:"setSize",value:function(t,e){if(t<e){this.isHide=!1,this.show();var n=this.content.box(),r=t/e*n.width;this.blockWidth=r<this.minBlockWidth?this.minBlockWidth:r,this.viewPortWidth=t,this.contentWidth=e,this.maxBlockLeft=n.width-this.blockWidth,this.block.css("width","".concat(this.blockWidth,"px"));var o=this.scrollTo/(e-t)*this.maxBlockLeft;this.blockLeft=o>this.maxBlockLeft?this.maxBlockLeft:o,this.scrollTo=this.computeScrollTo(this.blockLeft),this.block.css("left","".concat(this.blockLeft,"px"))}else this.isHide=!0,this.hide(),this.option.scroll(0)}},{key:"scrollMove",value:function(t){var e=t,n=this.contentWidth-this.viewPortWidth;e>n?e=n:e<0&&(e=0);var r=e/(this.contentWidth-this.viewPortWidth)*this.maxBlockLeft;this.blockLeft=r>this.maxBlockLeft?this.maxBlockLeft:r,this.scrollTo!==e&&(this.scrollTo=e,this.block.css("left","".concat(this.blockLeft,"px")),this.option.scroll(this.scrollTo))}},{key:"computeScrollTo",value:function(t){return t/this.maxBlockLeft*(this.contentWidth-this.viewPortWidth)}}])&&Ht(n.prototype,i),c&&Ht(n,c),e}(R);function Bt(t){return(Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ft(t,e){return!e||"object"!==Bt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zt(t){return(zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ut(t,e){return(Ut=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xt=function(t){function e(t){var n,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Ft(this,zt(e).call(this,"".concat(o,"-scroll-bar-y")))).option=S.mergeDeep({style:{},scroll:function(t){return t}},t),r.lastBut=T("div","".concat(o,"-scroll-bar-y-last-but")),r.nextBut=T("div","".concat(o,"-scroll-bar-y-next-but")),r.content=T("div","".concat(o,"-scroll-bar-y-content")),r.block=T("div","".concat(o,"-scroll-bar-y-block")),r.content.children(r.block),(n=r).children.apply(n,[r.lastBut,r.nextBut,r.content]),r.blockTop=0,r.maxBlockTop=0,r.blockHeight=0,r.minBlockHeight=20,r.scrollTo=0,r.contentHeight=0,r.viewPortHeight=0,r.isHide=!0,r.css(r.option.style),r.hide(),r}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ut(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"bind",value:function(){var t=this;Wt.bind(this.block,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(0===e.button){var n=t.computeEventXy(e,t.block);Wt.mouseMoveUp(T(document),(function(e){var r=t.computeEventXy(e,t.content).y-n.y;r<0&&(r=0),r>t.maxBlockTop&&(r=t.maxBlockTop),t.blockTop=r,t.scrollTo=t.computeScrollTo(t.blockTop),t.block.css("top","".concat(r,"px")),t.option.scroll(t.scrollTo),e.stopPropagation(),e.preventDefault()}))}}))}},{key:"setSize",value:function(t,e){if(t<e){this.isHide=!1,this.show();var n=this.content.box(),r=t/e*n.height;this.blockHeight=r<this.minBlockHeight?this.minBlockHeight:r,this.viewPortHeight=t,this.contentHeight=e,this.maxBlockTop=n.height-this.blockHeight,this.block.css("height","".concat(this.blockHeight,"px"));var o=this.scrollTo/(e-t)*this.maxBlockTop;this.blockTop=o>this.maxBlockTop?this.maxBlockTop:o,this.scrollTo=this.computeScrollTo(this.blockTop),this.block.css("top","".concat(this.blockTop,"px"))}else this.isHide=!0,this.hide(),this.option.scroll(0)}},{key:"scrollMove",value:function(t){var e=t,n=this.contentHeight-this.viewPortHeight;e>n?e=n:e<0&&(e=0);var r=e/(this.contentHeight-this.viewPortHeight)*this.maxBlockTop;this.blockTop=r>this.maxBlockTop?this.maxBlockTop:r,this.scrollTo!==e&&(this.scrollTo=e,this.block.css("top","".concat(this.blockTop,"px")),this.option.scroll(this.scrollTo))}},{key:"computeScrollTo",value:function(t){return t/this.maxBlockTop*(this.contentHeight-this.viewPortHeight)}}])&&Yt(n.prototype,i),c&&Yt(n,c),e}(R);function Gt(t){return(Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kt(t,e){return!e||"object"!==Gt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qt(t){return(qt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $t(t,e){return($t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Kt(this,qt(e).call(this,"".concat(o,"-horizontal-layer-element")))).options=S.mergeDeep({style:{flexGrow:"0"}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$t(t,e)}(e,t),e}(N);function Jt(t){return(Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qt(t,e){return!e||"object"!==Jt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function te(t){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ee(t,e){return(ee=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ne=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Qt(this,te(e).call(this,"".concat(o,"-horizontal-layer")))).options=S.mergeDeep({style:{}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ee(t,e)}(e,t),e}(N);function re(t){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ie(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ce(t,e){return(ce=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function le(t,e,n){return(le="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ae(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ae(t){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var se={TOP:1,LEFT:2,BOTTOM:3,RIGHT:4},ue=[],fe=function(t){function e(t){var n,r,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,n=!(i=ae(e).call(this,"".concat(o,"-el-pop-up")))||"object"!==re(i)&&"function"!=typeof i?ie(r):i,ue.push(ie(n)),n.options=S.mergeDeep({position:se.BOTTOM,el:null},t),n.off=!0,n.content=new R("".concat(o,"-el-pop-up-content")),n.scrollBarX=new It,n.scrollBarY=new Xt;var c=new Zt({style:{flexGrow:1}});c.children(n.content);var l=new Zt({style:{overflow:"inherit"}});l.children(n.scrollBarY);var a=new ne;a.children(c),a.children(l);var s=new K(a);s.children(a);var u=new K;u.children(n.scrollBarX);var f=new F;return f.children(s),f.children(u),le(ae(e.prototype),"children",ie(n)).call(ie(n),f),n.bind(),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ce(t,e)}(e,t),n=e,c=[{key:"closeAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];ue.forEach((function(e){-1===t.indexOf(e)&&e.close()}))}}],(i=[{key:"bind",value:function(){var t=this;Wt.bind(window,r.SYSTEM_EVENT_TYPE.RESIZE,(function(){t.position(),t.scrollbar()}))}},{key:"children",value:function(){var t;(t=this.content).children.apply(t,arguments)}},{key:"position",value:function(){var t=this.content,e=this.options,n=e.el,r=e.position,o=n.box(),i=t.box(),c=o.top,l=o.left;switch(r){case se.TOP:c=o.top-i.height;break;case se.LEFT:l=o.left-i.width;break;case se.RIGHT:l=o.left+o.width;break;case se.BOTTOM:c=o.top+o.height}var a=window.innerWidth,s=window.innerHeight;if(l<0||l+i.width>a)switch(r){case se.LEFT:l=o.left+o.width;break;case se.RIGHT:l=o.left-i.width}if(c<0||c+i.height>s)switch(r){case se.TOP:c=o.top+o.height;break;case se.BOTTOM:c=o.top-i.height}(l<0||l+i.width>a)&&(c=o.top+o.height,l=o.left),(c<0||c+i.height>s)&&(c=o.top+o.height,l=o.left),this.offset({top:c,left:l})}},{key:"scrollbar",value:function(){var t=this.content.box(),e=this.box();this.scrollBarY.setSize(e.height,t.height),this.scrollBarX.setSize(e.width,t.width)}},{key:"open",value:function(){this.off&&(T(document.body).children(this),this.position(),this.scrollbar(),this.off=!1)}},{key:"close",value:function(){!1===this.off&&(T(document.body).remove(this),this.off=!0)}}])&&oe(n.prototype,i),c&&oe(n,c),e}(R);function he(t){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ye(t){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function be(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function de(t,e){return(de=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ge=function(t){function e(){var t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(r=ye(e).call(this,"".concat(o,"-el-context-menu ").concat(i)))||"object"!==he(r)&&"function"!=typeof r?be(n):r).options=S.mergeDeep({},c),t.menus=[],t.elPopUp=new fe(t.options),t.elPopUp.children(be(t)),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&de(t,e)}(e,t),n=e,(i=[{key:"bind",value:function(){var t=this;Wt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){t.stopPropagation(),t.preventDefault()})),Wt.bind(document.body,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.close()}))}},{key:"addItem",value:function(t){return this.menus.push(t),this.children(t),this}},{key:"open",value:function(){return this.elPopUp.open(),this}},{key:"close",value:function(){return this.elPopUp.close(),this}},{key:"isOpen",value:function(){return this.elPopUp.off}}])&&pe(n.prototype,i),c&&pe(n,c),e}(R);function ve(t){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function we(t,e){return!e||"object"!==ve(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function me(t){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oe(t,e){return(Oe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ee=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),we(this,me(e).call(this,"".concat(o,"-el-context-menu-item hover ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oe(t,e)}(e,t),e}(R);function Se(t){return(Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _e(t){return(_e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ke(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Te(t,e){return(Te=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ce=[],Pe=function(t){function e(t,n){var r,i,c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i=this,(r=!(c=_e(e).call(this,"".concat(o,"-format-context-menu-item")))||"object"!==Se(c)&&"function"!=typeof c?ke(i):c).title=t,r.desc=n,r.icon=new tt("checked"),r.iconElement=T("div","".concat(o,"-format-context-menu-item-icon")),r.iconElement.children(r.icon),r.titleElement=T("div","".concat(o,"-format-context-menu-item-title")),r.descElement=T("div","".concat(o,"-format-context-menu-item-desc")),r.titleElement.text(t),r.descElement.text(n),r.children(r.iconElement),r.children(r.titleElement),r.children(r.descElement),Ce.push(ke(r)),r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Te(t,e)}(e,t),n=e,(r=[{key:"setTitle",value:function(t){this.titleElement.text(t)}},{key:"setDesc",value:function(t){this.descElement.text(t)}},{key:"setActive",value:function(){Ce.forEach((function(t){t.removeClass("active")})),this.addClass("active")}}])&&xe(n.prototype,r),i&&xe(n,i),e}(Ee);function Ae(t){return(Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function je(t,e){return!e||"object"!==Ae(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Le(t){return(Le=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Re(t,e){return(Re=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var We=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),je(this,Le(e).call(this,"".concat(o,"-el-context-menu-item-divider")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Re(t,e)}(e,t),e}(R);function Ve(t){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function He(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Me(t,e){return!e||"object"!==Ve(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ne(t){return(Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function De(t,e){return(De=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ie=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Me(this,Ne(e).call(this,"".concat(o,"-format-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).items=[new Pe("常规","").data("type","default"),new Pe("文本","").data("type","text"),new We,new Pe("数值","0.59").data("type","number"),new Pe("百分比","90.00%").data("type","percentage"),new Pe("分数","1/2").data("type","fraction"),new Pe("科学计数","9.50e-01").data("type","ENotation"),new We,new Pe("人民币","￥5.00").data("type","rmb"),new Pe("港币","HK5.00").data("type","hk"),new Pe("美元","$5.00").data("type","dollar"),new We,new Pe("日期","2018/4/18").data("type","date1"),new Pe("日期","4月18日").data("type","date2"),new Pe("日期","2018年4月").data("type","date3"),new Pe("日期","2018年4月18日").data("type","date4"),new Pe("日期","2018/4/18 14:30:30").data("type","date5"),new Pe("时间","14:30:30").data("type","time"),new We,new Pe("更多格式","")],t.items.forEach((function(e){e instanceof Pe&&e.data("type")&&e.on(r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.data("type"),e.title),e.setActive()})),t.addItem(e)})),t.init(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&De(t,e)}(e,t),n=e,(i=[{key:"init",value:function(){var t=this.options,e=this.items,n=t.el,r=e[0];n.setTitle(r.title),r.setActive()}},{key:"update",value:function(t,e){this.options.onUpdate(t,e),this.close()}},{key:"setActiveByType",value:function(t){this.items.forEach((function(e){e.data("type")===t&&e.setActive()}))}}])&&He(n.prototype,i),c&&He(n,c),e}(ge);function Be(t){return(Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ye(t){return(Ye=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fe(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ze(t,e){return(ze=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ue=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(i=Ye(e).call(this,"".concat(o,"-tools-format")))||"object"!==Be(i)&&"function"!=typeof i?Fe(r):i).options=S.copyProp({contextMenu:{}},t),n.setTitle("常规"),n.setWidth(50),n.setEllipsis(),n.formatContextMenu=new Ie(S.copyProp({el:Fe(n),position:se.BOTTOM},n.options.contextMenu)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ze(t,e)}(e,t),e}(Lt);function Xe(t){return(Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ge(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ke(t){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qe(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $e(t,e){return($e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ze=[],Je=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(i=Ke(e).call(this,"".concat(o,"-font-context-menu-item")))||"object"!==Xe(i)&&"function"!=typeof i?qe(r):i).title=t,n.icon=new tt("checked"),n.iconElement=T("div","".concat(o,"-font-context-menu-item-icon")),n.iconElement.children(n.icon),n.titleElement=T("div","".concat(o,"-font-context-menu-item-title")),n.titleElement.text(t),n.titleElement.css("font-family",t),n.children(n.iconElement),n.children(n.titleElement),Ze.push(qe(n)),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$e(t,e)}(e,t),n=e,(r=[{key:"setTitle",value:function(t){this.title=t,this.titleElement.text(t)}},{key:"setActive",value:function(){Ze.forEach((function(t){t.removeClass("active")})),this.addClass("active")}}])&&Ge(n.prototype,r),i&&Ge(n,i),e}(Ee);function Qe(t){return(Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function en(t,e){return!e||"object"!==Qe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nn(t){return(nn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rn(t,e){return(rn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var on=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=en(this,nn(e).call(this,"".concat(o,"-font-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).items=[new Je("Arial"),new Je("Helvetica"),new Je("Source Sans Pro"),new Je("Comic Sans Ms"),new Je("Courier New"),new Je("Verdana"),new Je("Lalo")],t.items.forEach((function(e){e.on(r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.title),e.setActive()})),t.addItem(e)})),t.setActiveByType(t.items[0].title),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rn(t,e)}(e,t),n=e,(i=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}},{key:"setActiveByType",value:function(t){this.items.forEach((function(e){e.title===t&&e.setActive()}))}}])&&tn(n.prototype,i),c&&tn(n,c),e}(ge);function cn(t){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ln(t){return(ln=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function an(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sn(t,e){return(sn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var un=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(i=ln(e).call(this,"".concat(o,"-tools-font")))||"object"!==cn(i)&&"function"!=typeof i?an(r):i).options=S.copyProp({contextMenu:{}},t),n.setTitle("Arial"),n.setWidth(50),n.setEllipsis(),n.fontContextMenu=new on(S.copyProp({el:an(n),position:se.BOTTOM},n.options.contextMenu)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sn(t,e)}(e,t),e}(Lt);function fn(t){return(fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hn(t,e){return!e||"object"!==fn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pn(t){return(pn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yn(t,e){return(yn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bn=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=hn(this,pn(e).call(this,"".concat(o,"-font-size-context-menu-item")))).size=t,n.titleElement=T("div","".concat(o,"-font-size-context-menu-item-title")),n.titleElement.text(t),n.titleElement.css("text-align","center"),n.children(n.titleElement),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yn(t,e)}(e,t),e}(Ee);function dn(t){return(dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vn(t,e){return!e||"object"!==dn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wn(t){return(wn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mn(t,e){return(mn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var On=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=vn(this,wn(e).call(this,"".concat(o,"-font-size-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).items=[new bn(6),new bn(7),new bn(8),new bn(9),new bn(10),new bn(11),new bn(12),new bn(14),new bn(15),new bn(18),new bn(24),new bn(36)],t.items.forEach((function(e){e.on(r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.size)})),t.addItem(e)})),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mn(t,e)}(e,t),n=e,(i=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}}])&&gn(n.prototype,i),c&&gn(n,c),e}(ge);function En(t){return(En="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sn(t){return(Sn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _n(t,e){return(_n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kn=function(t){function e(){var t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(r=Sn(e).call(this,"".concat(o,"-tools-font-size")))||"object"!==En(r)&&"function"!=typeof r?xn(n):r).options=i,t.setTitle("10"),t.setWidth(30),t.setEllipsis(),t.fontSizeContextMenu=new On(S.copyProp({el:xn(t),position:se.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_n(t,e)}(e,t),e}(Lt);function Tn(t){return(Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cn(t,e){return!e||"object"!==Tn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pn(t){return(Pn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function An(t,e){return(An=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Cn(this,Pn(e).call(this,"".concat(o,"-tools-font-bold")))).icon=new tt("font-bold"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&An(t,e)}(e,t),e}(it);function Ln(t){return(Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rn(t,e){return!e||"object"!==Ln(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wn(t){return(Wn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vn(t,e){return(Vn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Rn(this,Wn(e).call(this,"".concat(o,"-tools-font-italic")))).icon=new tt("font-italic"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vn(t,e)}(e,t),e}(it);function Mn(t){return(Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nn(t,e){return!e||"object"!==Mn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dn(t){return(Dn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function In(t,e){return(In=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Nn(this,Dn(e).call(this,"".concat(o,"-tools-under-line")))).icon=new tt("under-line"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&In(t,e)}(e,t),e}(it);function Yn(t){return(Yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fn(t,e){return!e||"object"!==Yn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zn(t){return(zn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Un(t,e){return(Un=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Fn(this,zn(e).call(this,"".concat(o,"-tools-font-strike")))).icon=new tt("font-strike"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Un(t,e)}(e,t),e}(it);function Gn(t){return(Gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kn(t,e){return!e||"object"!==Gn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qn(t){return(qn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $n(t,e){return($n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zn=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Kn(this,qn(e).call(this,"".concat(o,"-font-color-context-menu-item")))).title=t,r.icon=n,n&&(r.iconElement=T("div","".concat(o,"-font-color-context-menu-item-icon")),r.iconElement.children(r.icon),r.children(r.iconElement)),t&&(r.titleElement=T("div","".concat(o,"-font-color-context-menu-item-title")),r.titleElement.text(t),r.children(r.titleElement)),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$n(t,e)}(e,t),e}(Ee);function Jn(t){return(Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function er(t,e){return(er=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function nr(t,e,n){return(nr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=rr(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function rr(t){return(rr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var or=[],ir={LEFT:1,TOP:2,RIGHT:3,CENTER:4},cr=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(i=rr(e).call(this,"".concat(o,"-drag-panel")))||"object"!==Jn(i)&&"function"!=typeof i?tr(r):i).options=S.mergeDeep({position:ir.CENTER},t),n.off=!0,n.mask=T("div","".concat(o,"-drag-panel-mask")),n.content=T("div","".concat(o,"-drag-panel-content")),nr(rr(e.prototype),"children",tr(n)).call(tr(n),n.content),n.bind(),or.push(tr(n)),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&er(t,e)}(e,t),n=e,c=[{key:"closeAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];or.forEach((function(e){-1===t.indexOf(e)&&e.close()}))}}],(i=[{key:"bind",value:function(){var t=this,e=this.mask;Wt.bind(e,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.close(),e.stopPropagation()})),Wt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(0===e.button){var n=t.computeEventXy(e,t);Wt.mouseMoveUp(T(document),(function(e){var r=e.pageY-n.y,o=e.pageX-n.x;t.offset({top:r,left:o}),e.stopPropagation(),e.preventDefault()})),e.stopPropagation(),e.preventDefault()}}))}},{key:"position",value:function(){var t=this.options.position,e=S.viewPort(),n=e.width,r=e.height,o=this.box();switch(t){case ir.LEFT:case ir.RIGHT:case ir.TOP:break;case ir.CENTER:this.offset({left:n/2-o.width/2,top:r/2-o.height/2})}}},{key:"open",value:function(){if(this.off){var t=this.mask;T(document.body).children(t),T(document.body).children(this),this.position(),this.off=!1}}},{key:"close",value:function(){if(!1===this.off){var t=this.mask;T(document.body).remove(this),T(document.body).remove(t),this.off=!0}}},{key:"children",value:function(){var t;(t=this.content).children.apply(t,arguments)}}])&&Qn(n.prototype,i),c&&Qn(n,c),e}(R);function lr(t){return(lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ar(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function sr(t){return(sr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ur(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fr(t,e){return(fr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hr=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(i=sr(e).call(this,"".concat(o,"-color-picker")))||"object"!==lr(i)&&"function"!=typeof i?ur(r):i).options=S.mergeDeep({selectCb:function(){}},t),n.dragPanel=new cr,n.color=[360,0,100],n.preViewColorPoint=T("div","".concat(o,"-color-picker-pre-view-color-point")),n.colorValueTips=T("div","".concat(o,"-color-picker-color-value-tips")),n.colorValueTips.text("十六进制颜色值"),n.colorInput=T("input","".concat(o,"-color-picker-color-input")),n.top=T("div","".concat(o,"-color-picker-top")),n.top.children(n.preViewColorPoint),n.top.children(n.colorValueTips),n.top.children(n.colorInput),n.selectColorPoint=T("div","".concat(o,"-color-picker-select-color-point")),n.selectColorArea1=T("div","".concat(o,"-color-picker-select-color-area area1")),n.selectColorArea2=T("div","".concat(o,"-color-picker-select-color-area area2")),n.selectColorArea3=T("div","".concat(o,"-color-picker-select-color-area area3")),n.center=T("div","".concat(o,"-color-picker-center")),n.center.children(n.selectColorArea1),n.center.children(n.selectColorArea2),n.center.children(n.selectColorArea3),n.center.children(n.selectColorPoint),n.colorHuxTips=T("div","".concat(o,"-color-picker-color-hux-tips")),n.colorBar=T("div","".concat(o,"-color-picker-color-bar")),n.colorBarPoint=T("div","".concat(o,"-color-picker-bar-point")),n.bottom=T("div","".concat(o,"-color-picker-bottom")),n.colorHuxTips.text("HUE"),n.colorBar.children(n.colorBarPoint),n.bottom.children(n.colorHuxTips),n.bottom.children(n.colorBar),n.cancelButton=T("div","".concat(o,"-color-picker-button cancel")),n.selectButton=T("div","".concat(o,"-color-picker-button select")),n.buttons=T("div","".concat(o,"-color-picker-buttons")),n.cancelButton.text("取消"),n.selectButton.text("确定"),n.buttons.children(n.selectButton),n.buttons.children(n.cancelButton),n.children(n.top),n.children(n.center),n.children(n.bottom),n.children(n.buttons),n.dragPanel.children(ur(n)),n.dragPanel.css("background","#ffffff"),n.bind(),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fr(t,e)}(e,t),n=e,c=[{key:"fixHex",value:function(t){var e=6-t.length;if(e>0){for(var n=[],r=0;r<e;r+=1)n.push("0");n.push(t),t=n.join("")}return t}},{key:"fixHsx",value:function(t){return{h:Math.min(360,Math.max(0,t.h)),s:Math.min(100,Math.max(0,t.s)),x:Math.min(100,Math.max(0,t.x))}}},{key:"hexToRgb",value:function(t){return{r:(t=parseInt(t.indexOf("#")>-1?t.substring(1):t,16))>>16,g:(65280&t)>>8,b:255&t}}},{key:"hexToHsb",value:function(t){return this.rgbToHsb(this.hexToRgb(t))}},{key:"rgbToHsb",value:function(t){var e={h:0,s:0,x:0},n=Math.min(t.r,t.g,t.b),r=Math.max(t.r,t.g,t.b),o=r-n;return e.x=r,e.s=0!==r?255*o/r:0,0!==e.s?t.r===r?e.h=(t.g-t.b)/o:t.g===r?e.h=2+(t.b-t.r)/o:e.h=4+(t.r-t.g)/o:e.h=-1,e.h*=60,e.h<0&&(e.h+=360),e.s*=100/255,e.x*=100/255,e}},{key:"hsbToRgb",value:function(t){var e={},n=t.h,r=255*t.s/100,o=255*t.x/100;if(0===r)e.r=o,e.g=o,e.b=o;else{var i=o,c=(255-r)*o/255,l=n%60*(i-c)/60;360===n&&(n=0),n<60?(e.r=i,e.b=c,e.g=c+l):n<120?(e.g=i,e.b=c,e.r=i-l):n<180?(e.g=i,e.r=c,e.b=c+l):n<240?(e.b=i,e.r=c,e.g=i-l):n<300?(e.b=i,e.g=c,e.r=c+l):n<360?(e.r=i,e.g=c,e.b=i-l):(e.r=0,e.g=0,e.b=0)}return{r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)}}},{key:"rgbToHex",value:function(t){var e=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return e.forEach((function(t,n){1===t.length&&(e[n]="0".concat(t))})),e.join("")}},{key:"hsbToHex",value:function(t){return this.rgbToHex(this.hsbToRgb(t))}},{key:"isRgb",value:function(t){return t.startsWith("rgb")}},{key:"isHex",value:function(t){return t.startsWith("#")}},{key:"parseRgb",value:function(t){var e=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return{r:e[1],g:e[2],b:e[3]}}},{key:"isDark",value:function(t){if(S.isBlank(t))return!1;if(this.isHex(t)){var n=e.hexToRgb(t);t="rgb(".concat(n.r,", ").concat(n.g,", ").concat(n.b,")")}var r=e.parseRgb(t);return.299*r.r+.578*r.g+.114*r.b>=192}}],(i=[{key:"bind",value:function(){var t=this,n=this.selectColorPoint,o=this.center,i=this.colorBarPoint,c=this.colorBar,l=this.colorInput,a=this.cancelButton,s=this.selectButton;Wt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){t.stopPropagation()})),Wt.bind(n,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.computeEventXy(e,o),r=o.box();n.x<0&&(n.x=0),n.x>r.width&&(n.x=r.width),n.y<0&&(n.y=0),n.y>r.height&&(n.y=r.height),t.downSelect(n.x,n.y,r.width,r.height),Wt.mouseMoveUp(T(document),(function(e){var n=t.computeEventXy(e,o);n.x<0&&(n.x=0),n.x>r.width&&(n.x=r.width),n.y<0&&(n.y=0),n.y>r.height&&(n.y=r.height),t.moveSelect(n.x,n.y,r.width,r.height)}))})),Wt.bind(i,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.computeEventXy(e,c),r=c.box();n.x<0&&(n.x=0),n.x>r.width&&(n.x=r.width),t.downHue(n.x,r.width),Wt.mouseMoveUp(T(document),(function(e){var n=t.computeEventXy(e,c),r=c.box();n.x<0&&(n.x=0),n.x>r.width&&(n.x=r.width),t.moveHue(n.x,r.width)}))})),Wt.bind(l,r.SYSTEM_EVENT_TYPE.CHANGE,(function(){var e=l.val();e&&t.hexColor(e)})),Wt.bind(a,r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.close()})),Wt.bind(s,r.SYSTEM_EVENT_TYPE.CLICK,(function(){var n=t.color,r=e.fixHsx({h:parseInt(n[0],10),s:parseInt(n[1],10),x:parseInt(n[2],10)}),o=e.hsbToHex(r);t.options.selectCb("#".concat(o)),t.close()}))}},{key:"open",value:function(t){if(this.dragPanel.open(),t){if(e.isRgb(t)){var n=e.parseRgb(t);t=e.rgbToHex(n)}this.hexColor(t)}else this.change();return this}},{key:"close",value:function(){return this.dragPanel.close(),this}},{key:"sliderPosition",value:function(t){var e=this.colorBar,n=this.colorBarPoint,r=n.box(),o=e.box(),i=parseInt(o.width-o.width*t.h/360,10);i-=r.width/2,n.offset({left:i});var c=this.center,l=this.selectColorPoint,a=l.box(),s=c.box(),u=parseInt(s.width*t.s/100,10),f=parseInt(s.height*(100-t.x)/100,10);u-=a.width/2,f-=a.height/2,l.offset({left:u,top:f})}},{key:"hueChange",value:function(){var t=this.color,n=e.fixHsx({h:parseInt(t[0],10),s:parseInt(t[1],10),x:parseInt(t[2],10)}),r=this.colorBarPoint,o=this.selectColorPoint,i=this.preViewColorPoint,c=this.selectColorArea1,l=this.colorInput,a=e.hsbToHex(n),s=e.hsbToHex({h:n.h,s:100,x:100});o.css("backgroundColor","#".concat(a)),i.css("backgroundColor","#".concat(a)),r.css("backgroundColor","#".concat(s)),c.css("backgroundColor","#".concat(s)),l.val("#".concat(a)),this.sliderPosition(n)}},{key:"selectChange",value:function(){var t=this.color,n=e.fixHsx({h:parseInt(t[0],10),s:parseInt(t[1],10),x:parseInt(t[2],10)}),r=this.preViewColorPoint,o=this.selectColorPoint,i=this.colorInput,c=e.hsbToHex(n);o.css("backgroundColor","#".concat(c)),r.css("backgroundColor","#".concat(c)),i.val("#".concat(c)),this.sliderPosition(n)}},{key:"change",value:function(){this.hueChange(),this.selectChange()}},{key:"downSelect",value:function(t,e,n,r){var o=this.color;o[1]=parseInt(100*t/n,10),o[2]=parseInt(100*(r-e)/r,10),this.selectChange()}},{key:"moveSelect",value:function(t,e,n,r){var o=this.color;o[1]=parseInt(100*Math.max(0,Math.min(n,t))/n,10),o[2]=parseInt(100*(r-Math.max(0,Math.min(r,e)))/r,10),this.selectChange()}},{key:"downHue",value:function(t,e){this.color[0]=parseInt(360*(e-t)/e,10),this.hueChange()}},{key:"moveHue",value:function(t,e){this.color[0]=parseInt(360*(e-Math.max(0,Math.min(e,t)))/e,10),this.hueChange()}},{key:"hexColor",value:function(t){var n=this.color,r=e.hexToHsb(e.fixHex(t));n[0]=r.h,n[1]=r.s,n[2]=r.x,this.change()}}])&&ar(n.prototype,i),c&&ar(n,c),e}(R);function pr(t){return(pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function br(t,e){return!e||"object"!==pr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dr(t){return(dr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gr(t,e){return(gr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vr=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=br(this,dr(e).call(this,"".concat(o,"-color-array-item")))).options=S.mergeDeep({color:null,icon:null},t),n.color=n.options.color,n.icon=n.options.icon,n.color&&(n.css("backgroundColor",n.color),hr.isDark(n.options.color)?(n.checkedIcon=new tt("checked-dark"),n.children(n.checkedIcon)):(n.checkedIcon=new tt("checked-light"),n.children(n.checkedIcon)),n.checkedIcon.hide()),n.icon&&n.children(n.options.icon),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gr(t,e)}(e,t),n=e,(r=[{key:"setActive",value:function(t){this.checkedIcon&&(t?this.checkedIcon.show():this.checkedIcon.hide())}}])&&yr(n.prototype,r),i&&yr(n,i),e}(R);function wr(t){return(wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Or(t,e){return!e||"object"!==wr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Er(t){return(Er=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sr(t,e){return(Sr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xr=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Or(this,Er(e).call(this,"".concat(o,"-color-array")))).options=S.mergeDeep({colors:[new vr({color:"rgb(0,0,0)"}),new vr({color:"rgb(67, 67, 67)"}),new vr({color:"rgb(102, 102, 102)"}),new vr({color:"rgb(153, 153, 153)"}),new vr({color:"rgb(183, 183, 183)"}),new vr({color:"rgb(204, 204, 204)"}),new vr({color:"rgb(217, 217, 217)"}),new vr({color:"rgb(239, 239, 239)"}),new vr({color:"rgb(255, 255, 255)"}),new vr({color:"rgb(152, 0, 0)"}),new vr({color:"rgb(255, 0, 0)"}),new vr({color:"rgb(255, 153, 0)"}),new vr({color:"rgb(255, 255, 0)"}),new vr({color:"rgb(0, 255, 0)"}),new vr({color:"rgb(0, 255, 255)"}),new vr({color:"rgb(74, 134, 232)"}),new vr({color:"rgb(0, 0, 255)"}),new vr({color:"rgb(153, 0, 255)"}),new vr({color:"rgb(255, 0, 255)"}),new vr({color:"rgb(230, 184, 175)"}),new vr({color:"rgb(244, 204, 204)"}),new vr({color:"rgb(252, 229, 205)"}),new vr({color:"rgb(255, 242, 204)"}),new vr({color:"rgb(217, 234, 211)"}),new vr({color:"rgb(208, 224, 227)"}),new vr({color:"rgb(201, 218, 248)"}),new vr({color:"rgb(207, 226, 243)"}),new vr({color:"rgb(217, 210, 233)"}),new vr({color:"rgb(234, 209, 220)"}),new vr({color:"rgb(221, 126, 107)"}),new vr({color:"rgb(234, 153, 153)"}),new vr({color:"rgb(249, 203, 156)"}),new vr({color:"rgb(255, 229, 153)"}),new vr({color:"rgb(182, 215, 168)"}),new vr({color:"rgb(162, 196, 201)"}),new vr({color:"rgb(164, 194, 244)"}),new vr({color:"rgb(159, 197, 232)"}),new vr({color:"rgb(180, 167, 214)"}),new vr({color:"rgb(213, 166, 189)"}),new vr({color:"rgb(204, 65, 37)"}),new vr({color:"rgb(224, 102, 102)"}),new vr({color:"rgb(246, 178, 107)"}),new vr({color:"rgb(255, 217, 102)"}),new vr({color:"rgb(147, 196, 125)"}),new vr({color:"rgb(118, 165, 175)"}),new vr({color:"rgb(109, 158, 235)"}),new vr({color:"rgb(111, 168, 220)"}),new vr({color:"rgb(142, 124, 195)"}),new vr({color:"rgb(194, 123, 160)"}),new vr({color:"rgb(166, 28, 0)"}),new vr({color:"rgb(204, 0, 0)"}),new vr({color:"rgb(230, 145, 56)"}),new vr({color:"rgb(241, 194, 50)"}),new vr({color:"rgb(106, 168, 79)"}),new vr({color:"rgb(69, 129, 142)"}),new vr({color:"rgb(60, 120, 216)"}),new vr({color:"rgb(61, 133, 198)"}),new vr({color:"rgb(103, 78, 167)"}),new vr({color:"rgb(166, 77, 121)"}),new vr({color:"rgb(133, 32, 12)"}),new vr({color:"rgb(153, 0, 0)"}),new vr({color:"rgb(180, 95, 6)"}),new vr({color:"rgb(191, 144, 0)"}),new vr({color:"rgb(56, 118, 29)"}),new vr({color:"rgb(19, 79, 92)"}),new vr({color:"rgb(17, 85, 204)"}),new vr({color:"rgb(11, 83, 148)"}),new vr({color:"rgb(53, 28, 117)"}),new vr({color:"rgb(116, 27, 71)"}),new vr({color:"rgb(91, 15, 0)"}),new vr({color:"rgb(102, 0, 0)"}),new vr({color:"rgb(120, 63, 4)"}),new vr({color:"rgb(127, 96, 0)"}),new vr({color:"rgb(39, 78, 19)"}),new vr({color:"rgb(12, 52, 61)"}),new vr({color:"rgb(28, 69, 135)"}),new vr({color:"rgb(7, 55, 99)"}),new vr({color:"rgb(32, 18, 77)"}),new vr({color:"rgb(76, 17, 48)"})],selectCb:function(){}},t),n.colors=n.options.colors,n.activeColor=null,n.colors.forEach((function(t){n.children(t),t.on(r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){n.options.selectCb(t),t.options.color&&n.setActiveByColor(t.options.color)}))})),n.colors.length>0&&n.setActiveByColor(n.colors[0].options.color),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sr(t,e)}(e,t),n=e,(i=[{key:"add",value:function(t){var e=this;t.on(r.SYSTEM_EVENT_TYPE.CLICK,(function(){e.options.selectCb(t),t.options.color&&e.setActiveByColor(t.options.color)})),this.colors.push(t),this.children(t)}},{key:"setActiveByColor",value:function(t){var e=this;this.colors.forEach((function(n){var r=n.options;r.color===t?(n.setActive(!0),e.activeColor=r.color):n.setActive(!1)}))}}])&&mr(n.prototype,i),c&&mr(n,c),e}(R);function _r(t){return(_r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Tr(t,e){return!e||"object"!==_r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Cr(t){return(Cr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pr(t,e){return(Pr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ar=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Tr(this,Cr(e).call(this,"".concat(o,"-font-color-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).colorPicker=new hr({selectCb:function(e){var n=new vr({color:e});t.customizeColorArray.add(n),t.customizeColorArray.setActiveByColor(e),t.colorArray.setActiveByColor(null),t.options.onUpdate(e),t.close()}}),t.reset=new Zn("重置",new tt("clear-color")),t.reset.on(r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.options.onUpdate("rgb(0,0,0)"),t.customizeColorArray.setActiveByColor(null),t.colorArray.setActiveByColor(null)})),t.array=new Zn,t.array.removeClass("hover"),t.colorArray=new xr({selectCb:function(e){var n=e.options.color;n&&t.options.onUpdate(n),t.customizeColorArray.setActiveByColor(null),t.close()}}),t.array.children(t.colorArray),t.title=T("div","".concat(o,"-font-color-context-menu-color-title")),t.title.text("自定义"),t.plus=new tt("plus"),t.customizeColorArray=new xr({colors:[new vr({icon:t.plus})],selectCb:function(e){var n=e.options.color;n?(t.options.onUpdate(n),t.colorArray.setActiveByColor(null),t.close()):t.colorPicker.open(t.customizeColorArray.activeColor)}}),t.customize=new Zn,t.customize.removeClass("hover"),t.customize.children(t.title),t.customize.children(t.customizeColorArray),t.addItem(t.reset),t.addItem(t.array),t.addItem(new We),t.addItem(t.customize),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pr(t,e)}(e,t),n=e,(i=[{key:"setActiveByColor",value:function(t){this.customizeColorArray.setActiveByColor(t),this.colorArray.setActiveByColor(t)}}])&&kr(n.prototype,i),c&&kr(n,c),e}(ge);function jr(t){return(jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Rr(t){return(Rr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Vr(t,e){return(Vr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hr=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(i=Rr(e).call(this,"".concat(o,"-tools-font-color")))||"object"!==jr(i)&&"function"!=typeof i?Wr(r):i).options=S.mergeDeep({contextMenu:{}},t),n.icon=new tt("color"),n.fontColorContextMenu=new Ar(S.copyProp({el:Wr(n),position:se.BOTTOM},n.options.contextMenu)),n.setIcon(n.icon),n.setColor("rgb(0,0,0)"),n.fontColorContextMenu.setActiveByColor("rgb(0,0,0)"),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vr(t,e)}(e,t),n=e,(r=[{key:"setColor",value:function(t){this.icon.css("border-bottom","3px solid ".concat(t))}}])&&Lr(n.prototype,r),i&&Lr(n,i),e}(Lt);function Mr(t){return(Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nr(t,e){return!e||"object"!==Mr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dr(t){return(Dr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ir(t,e){return(Ir=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Br=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Nr(this,Dr(e).call(this,"".concat(o,"-fill-color-context-menu-item")))).title=t,r.icon=n,n&&(r.iconElement=T("div","".concat(o,"-fill-color-context-menu-item-icon")),r.iconElement.children(r.icon),r.children(r.iconElement)),t&&(r.titleElement=T("div","".concat(o,"-fill-color-context-menu-item-title")),r.titleElement.text(t),r.children(r.titleElement)),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ir(t,e)}(e,t),e}(Ee);function Yr(t){return(Yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zr(t,e){return!e||"object"!==Yr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ur(t){return(Ur=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xr(t,e){return(Xr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gr=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=zr(this,Ur(e).call(this,"".concat(o,"-font-color-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).colorPicker=new hr({selectCb:function(e){var n=new vr({color:e});t.customizeColorArray.add(n),t.customizeColorArray.setActiveByColor(e),t.colorArray.setActiveByColor(null),t.options.onUpdate(e),t.close()}}),t.reset=new Br("重置",new tt("clear-color")),t.reset.on(r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.options.onUpdate(null),t.customizeColorArray.setActiveByColor(null),t.colorArray.setActiveByColor(null)})),t.array=new Br,t.array.removeClass("hover"),t.colorArray=new xr({selectCb:function(e){var n=e.options.color;n&&t.options.onUpdate(n),t.customizeColorArray.setActiveByColor(null),t.close()}}),t.array.children(t.colorArray),t.title=T("div","".concat(o,"-font-color-context-menu-color-title")),t.title.text("自定义"),t.plus=new tt("plus"),t.customizeColorArray=new xr({colors:[new vr({icon:t.plus})],selectCb:function(e){var n=e.options.color;n?(t.options.onUpdate(n),t.colorArray.setActiveByColor(null),t.close()):t.colorPicker.open(t.customizeColorArray.activeColor)}}),t.customize=new Br,t.customize.removeClass("hover"),t.customize.children(t.title),t.customize.children(t.customizeColorArray),t.addItem(t.reset),t.addItem(t.array),t.addItem(new We),t.addItem(t.customize),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xr(t,e)}(e,t),n=e,(i=[{key:"setActiveByColor",value:function(t){this.customizeColorArray.setActiveByColor(t),this.colorArray.setActiveByColor(t)}}])&&Fr(n.prototype,i),c&&Fr(n,c),e}(ge);function Kr(t){return(Kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $r(t){return($r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jr(t,e){return(Jr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qr=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(i=$r(e).call(this,"".concat(o,"-tools-fill-color")))||"object"!==Kr(i)&&"function"!=typeof i?Zr(r):i).options=S.mergeDeep({contextMenu:{}},t),n.icon=new tt("fill-color"),n.fillColorContextMenu=new Gr(S.copyProp({el:Zr(n),position:se.BOTTOM},n.options.contextMenu)),n.setIcon(n.icon),n.setColor("rgb(255, 255, 255)"),n.fillColorContextMenu.setActiveByColor("rgb(255, 255, 255)"),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jr(t,e)}(e,t),n=e,(r=[{key:"setColor",value:function(t){this.icon.css("border-bottom","3px solid ".concat(t))}}])&&qr(n.prototype,r),i&&qr(n,i),e}(Lt);function to(t){return(to="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eo(t,e){return!e||"object"!==to(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function no(t){return(no=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ro(t,e){return(ro=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var oo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),eo(this,no(e).call(this,"".concat(o,"-border-type-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ro(t,e)}(e,t),e}(Ee);function io(t){return(io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function co(t,e){return!e||"object"!==io(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function lo(t){return(lo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ao(t,e){return(ao=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var so=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=co(this,lo(e).call(this,"".concat(o,"-tools-border1")))).icon=new tt("border1"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ao(t,e)}(e,t),e}(it);function uo(t){return(uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fo(t,e){return!e||"object"!==uo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ho(t){return(ho=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function po(t,e){return(po=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yo=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=fo(this,ho(e).call(this,"".concat(o,"-tools-border2")))).icon=new tt("border2"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&po(t,e)}(e,t),e}(it);function bo(t){return(bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function go(t,e){return!e||"object"!==bo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vo(t){return(vo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wo(t,e){return(wo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mo=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=go(this,vo(e).call(this,"".concat(o,"-tools-border3")))).icon=new tt("border3"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wo(t,e)}(e,t),e}(it);function Oo(t){return(Oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Eo(t,e){return!e||"object"!==Oo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function So(t){return(So=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xo(t,e){return(xo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _o=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Eo(this,So(e).call(this,"".concat(o,"-tools-border4")))).icon=new tt("border4"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xo(t,e)}(e,t),e}(it);function ko(t){return(ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function To(t,e){return!e||"object"!==ko(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Co(t){return(Co=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Po(t,e){return(Po=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ao=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=To(this,Co(e).call(this,"".concat(o,"-tools-border5")))).icon=new tt("border5"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Po(t,e)}(e,t),e}(it);function jo(t){return(jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lo(t,e){return!e||"object"!==jo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ro(t){return(Ro=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wo(t,e){return(Wo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vo=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Lo(this,Ro(e).call(this,"".concat(o,"-tools-border6")))).icon=new tt("border6"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wo(t,e)}(e,t),e}(it);function Ho(t){return(Ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mo(t,e){return!e||"object"!==Ho(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function No(t){return(No=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Do(t,e){return(Do=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Io=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Mo(this,No(e).call(this,"".concat(o,"-tools-border7")))).icon=new tt("border7"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Do(t,e)}(e,t),e}(it);function Bo(t){return(Bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yo(t,e){return!e||"object"!==Bo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fo(t){return(Fo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zo(t,e){return(zo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Uo=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Yo(this,Fo(e).call(this,"".concat(o,"-tools-border8")))).icon=new tt("border8"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zo(t,e)}(e,t),e}(it);function Xo(t){return(Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Go(t,e){return!e||"object"!==Xo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ko(t){return(Ko=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qo(t,e){return(qo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $o=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Go(this,Ko(e).call(this,"".concat(o,"-tools-border9")))).icon=new tt("border9"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qo(t,e)}(e,t),e}(it);function Zo(t){return(Zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jo(t,e){return!e||"object"!==Zo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qo(t){return(Qo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ti(t,e){return(ti=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ei=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Jo(this,Qo(e).call(this,"".concat(o,"-tools-border10")))).icon=new tt("border10"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ti(t,e)}(e,t),e}(it);function ni(t){return(ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ri(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oi(t,e){return!e||"object"!==ni(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ii(t){return(ii=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ci(t,e){return(ci=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var li=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=oi(this,ii(e).call(this,"".concat(o,"-tools-border-color")))).icon=new tt("border-color"),t.setIcon(t.icon),t.setColor("#000000"),t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ci(t,e)}(e,t),n=e,(r=[{key:"setColor",value:function(t){this.icon.css("border-bottom","3px solid ".concat(t))}}])&&ri(n.prototype,r),i&&ri(n,i),e}(Lt);function ai(t){return(ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function si(t,e){return!e||"object"!==ai(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ui(t){return(ui=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fi(t,e){return(fi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hi=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=si(this,ui(e).call(this,"".concat(o,"-tools-border-type")))).icon=new tt("border-type"),t.setIcon(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fi(t,e)}(e,t),e}(Lt);function pi(t){return(pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yi(t,e){return!e||"object"!==pi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bi(t){return(bi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function di(t,e){return(di=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gi=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=yi(this,bi(e).call(this,"".concat(o,"-border-color-context-menu-item")))).title=t,r.icon=n,n&&(r.iconElement=T("div","".concat(o,"-border-color-context-menu-item-icon")),r.iconElement.children(r.icon),r.children(r.iconElement)),t&&(r.titleElement=T("div","".concat(o,"-border-color-context-menu-item-title")),r.titleElement.text(t),r.children(r.titleElement)),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&di(t,e)}(e,t),e}(Ee);function vi(t){return(vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mi(t,e){return!e||"object"!==vi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Oi(t){return(Oi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ei(t,e){return(Ei=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Si=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=mi(this,Oi(e).call(this,"".concat(o,"-border-color-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).colorPicker=new hr({selectCb:function(e){var n=new vr({color:e});t.customizeColorArray.add(n),t.customizeColorArray.setActiveByColor(e),t.colorArray.setActiveByColor(null),t.options.onUpdate(e),t.close()}}),t.reset=new gi("重置",new tt("clear-color")),t.reset.on(r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.options.onUpdate("rgb(0,0,0)"),t.customizeColorArray.setActiveByColor(null),t.colorArray.setActiveByColor(null)})),t.array=new gi,t.array.removeClass("hover"),t.colorArray=new xr({selectCb:function(e){var n=e.options.color;n&&t.options.onUpdate(n),t.customizeColorArray.setActiveByColor(null),t.close()}}),t.array.children(t.colorArray),t.title=T("div","".concat(o,"-border-color-context-menu-color-title")),t.title.text("自定义"),t.plus=new tt("plus"),t.customizeColorArray=new xr({colors:[new vr({icon:t.plus})],selectCb:function(e){var n=e.options.color;n?(t.options.onUpdate(n),t.colorArray.setActiveByColor(null),t.close()):t.colorPicker.open(t.customizeColorArray.activeColor)}}),t.customize=new gi,t.customize.removeClass("hover"),t.customize.children(t.title),t.customize.children(t.customizeColorArray),t.addItem(t.reset),t.addItem(t.array),t.addItem(new We),t.addItem(t.customize),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ei(t,e)}(e,t),n=e,(i=[{key:"setActiveByColor",value:function(t){this.customizeColorArray.setActiveByColor(t),this.colorArray.setActiveByColor(t)}}])&&wi(n.prototype,i),c&&wi(n,c),e}(ge);function xi(t){return(xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ki(t){return(ki=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ti(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ci(t,e){return(Ci=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pi=[],Ai=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(i=ki(e).call(this,"".concat(o,"-font-context-menu-item")))||"object"!==xi(i)&&"function"!=typeof i?Ti(r):i).type=t,n.icon=new tt("checked"),n.typeIcon=new tt(t),n.typeIcon.setWidth(50),n.iconElement=T("div","".concat(o,"-font-context-menu-item-icon")),n.titleElement=T("div","".concat(o,"-font-context-menu-item-title")),n.iconElement.children(n.icon),n.titleElement.children(n.typeIcon),n.children(n.iconElement),n.children(n.titleElement),Pi.push(Ti(n)),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ci(t,e)}(e,t),n=e,(r=[{key:"setTitle",value:function(t){this.title=t,this.titleElement.text(t)}},{key:"setActive",value:function(){Pi.forEach((function(t){t.removeClass("active")})),this.addClass("active")}}])&&_i(n.prototype,r),i&&_i(n,i),e}(Ee);function ji(t){return(ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Li(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ri(t,e){return!e||"object"!==ji(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wi(t){return(Wi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vi(t,e){return(Vi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hi=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ri(this,Wi(e).call(this,"".concat(o,"-line-type-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).items=[new Ai("line1"),new Ai("line2"),new Ai("line3"),new Ai("line4"),new Ai("line5"),new Ai("line6")],t.items.forEach((function(e){e.on(r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.type),e.setActive()})),t.addItem(e)})),t.setActiveByType(t.items[0].type),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vi(t,e)}(e,t),n=e,(i=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}},{key:"setActiveByType",value:function(t){this.items.forEach((function(e){e.type===t&&e.setActive()}))}}])&&Li(n.prototype,i),c&&Li(n,c),e}(ge);function Mi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ni(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Di(t,e,n){return e&&Ni(t.prototype,e),n&&Ni(t,n),t}var Ii={SOLID_LINE:0,DOTTED_LINE:1,POINT_LINE:2,DOUBLE_LINE:3},Bi=function(){function t(e,n){Mi(this,t),this.draw=e,S.mergeDeep(this,{color:"#000000",width:1},n)}return Di(t,[{key:"drawLine",value:function(t,e,n,r){var o=this.draw,i=this.width,c=this.color;o.beginPath(),o.attr({lineWidth:i,strokeStyle:c}),o.setLineDash([]),o.line([t,e],[n,r])}},{key:"setColor",value:function(t){this.color=t}},{key:"setWidth",value:function(t){this.width=t}}]),t}(),Yi=function(){function t(e,n){Mi(this,t),this.draw=e,S.mergeDeep(this,{color:"#000000",width:1,dash:[5]},n)}return Di(t,[{key:"drawLine",value:function(t,e,n,r){var o=this.draw,i=this.dash,c=this.width,l=this.color;o.beginPath(),o.attr({lineWidth:c,strokeStyle:l}),o.setLineDash(i),o.line([t,e],[n,r])}},{key:"setColor",value:function(t){this.color=t}},{key:"setWidth",value:function(t){this.width=t}}]),t}(),Fi=function(){function t(e,n){Mi(this,t),this.draw=e,S.mergeDeep(this,{color:"#000000",width:1,padding:1,spacing:1.5,leftShow:function(){return!1},topShow:function(){return!1},rightShow:function(){return!1},bottomShow:function(){return!1},iFMerge:function(){return!1},iFMergeFirstRow:function(){return!1},iFMergeLastRow:function(){return!1},iFMergeFirstCol:function(){return!1},iFMergeLastCol:function(){return!1}},n)}return Di(t,[{key:"handleExternal",value:function(t,e,n,r,o,i,c){var l={},a=this.leftShow,s=this.topShow,u=this.rightShow,f=this.bottomShow,h=this.iFMerge,p=this.iFMergeFirstRow,y=this.iFMergeLastRow,b=this.iFMergeFirstCol,d=this.iFMergeLastCol,g=this.spacing,v=null,w=null,m=null,O=null,E=null;switch(c){case"left":(v=h(o,i-1))&&(w=p(o,i-1),m=y(o,i-1),O=b(o,i-1),E=d(o,i-1));break;case"top":(v=h(o-1,i))&&(w=p(o-1,i),m=y(o-1,i),O=b(o-1,i),E=d(o-1,i));break;case"right":(v=h(o,i+1))&&(w=p(o,i+1),m=y(o,i+1),O=b(o,i+1),E=d(o,i+1));break;case"bottom":(v=h(o+1,i))&&(w=p(o+1,i),m=y(o+1,i),O=b(o+1,i),E=d(o+1,i))}if(v){switch(c){case"left":l.sx=t-g,l.ex=n-g;var S=f(o-1,i-1)||s(o,i-1),x=s(o,i),_=f(o-1,i);l.sy=e,(x||_)&&(l.sy=e-g),S&&w&&(l.sy=e+g);var k=s(o+1,i-1)||f(o,i-1),T=f(o,i),C=s(o+1,i);l.ey=r,(T||C)&&(l.ey=r+g),k&&m&&(l.ey=r-g);break;case"top":l.sy=e-g,l.ey=r-g;var P=u(o-1,i-1)||a(o-1,i),A=a(o,i),j=u(o,i-1);l.sx=t,(A||j)&&(l.sx=t-g),P&&O&&(l.sx=t+g);var L=a(o-1,i+1)||u(o-1,i),R=u(o,i),W=a(o,i+1);l.ex=n,(R||W)&&(l.ex=n+g),L&&E&&(l.ex=n-g);break;case"right":l.sx=t+g,l.ex=n+g;var V=f(o-1,i+1)||s(o,i+1),H=s(o,i),M=f(o-1,i);l.sy=e,(H||M)&&(l.sy=e-g),V&&w&&(l.sy=e+g);var N=s(o+1,i+1)||f(o,i+1),D=f(o,i),I=s(o+1,i);l.ey=r,(D||I)&&(l.ey=r+g),N&&m&&(l.ey=r-g);break;case"bottom":l.sy=e+g,l.ey=r+g;var B=u(o+1,i-1)||a(o+1,i),Y=a(o,i),F=u(o,i-1);l.sx=t,(Y||F)&&(l.sx=t-g),B&&O&&(l.sx=t+g);var z=a(o+1,i+1)||u(o+1,i),U=u(o,i),X=a(o,i+1);l.ex=n,(U||X)&&(l.ex=n+g),z&&E&&(l.ex=n-g)}return l}switch(c){case"left":l.sx=t-g,l.ex=n-g;var G=f(o-1,i-1)||s(o,i-1),K=s(o,i),q=f(o-1,i);l.sy=e,(K||q)&&(l.sy=e-g),G&&(l.sy=e+g);var $=s(o+1,i-1)||f(o,i-1),Z=f(o,i),J=s(o+1,i);l.ey=r,(Z||J)&&(l.ey=r+g),$&&(l.ey=r-g);break;case"top":l.sy=e-g,l.ey=r-g;var Q=u(o-1,i-1)||a(o-1,i),tt=a(o,i),et=u(o,i-1);l.sx=t,(tt||et)&&(l.sx=t-g),Q&&(l.sx=t+g);var nt=a(o-1,i+1)||u(o-1,i),rt=u(o,i),ot=a(o,i+1);l.ex=n,(rt||ot)&&(l.ex=n+g),nt&&(l.ex=n-g);break;case"right":l.sx=t+g,l.ex=n+g;var it=f(o-1,i+1)||s(o,i+1),ct=s(o,i),lt=f(o-1,i);l.sy=e,(ct||lt)&&(l.sy=e-g),it&&(l.sy=e+g);var at=s(o+1,i+1)||f(o,i+1),st=f(o,i),ut=s(o+1,i);l.ey=r,(st||ut)&&(l.ey=r+g),at&&(l.ey=r-g);break;case"bottom":l.sy=e+g,l.ey=r+g;var ft=u(o+1,i-1)||a(o+1,i),ht=a(o,i),pt=u(o,i-1);l.sx=t,(ht||pt)&&(l.sx=t-g),ft&&(l.sx=t+g);var yt=a(o+1,i+1)||u(o+1,i),bt=u(o,i),dt=a(o,i+1);l.ex=n,(bt||dt)&&(l.ex=n+g),yt&&(l.ex=n-g)}return l}},{key:"handleInternal",value:function(t,e,n,r,o,i,c){var l={},a=this.leftShow,s=this.topShow,u=this.rightShow,f=this.bottomShow,h=this.iFMerge,p=this.iFMergeFirstRow,y=this.iFMergeLastRow,b=this.iFMergeFirstCol,d=this.iFMergeLastCol,g=this.spacing;if(h(o,i)){var v=p(o,i),w=y(o,i),m=b(o,i),O=d(o,i);switch(c){case"left":l.sx=t+g,l.ex=n+g;var E=f(o-1,i-1)||s(o,i-1),S=s(o,i),x=f(o-1,i);l.sy=e,E&&(l.sy=e-g),(S||x)&&v&&(l.sy=e+g);var _=s(o+1,i-1)||f(o,i-1),k=f(o,i),T=s(o+1,i);l.ey=r,_&&(l.ey=r+g),(k||T)&&w&&(l.ey=r-g);break;case"top":l.sy=e+g,l.ey=r+g;var C=u(o-1,i-1)||a(o-1,i),P=a(o,i),A=u(o,i-1);l.sx=t,C&&(l.sx=t-g),(P||A)&&m&&(l.sx=t+g);var j=a(o-1,i+1)||u(o-1,i),L=u(o,i),R=a(o,i+1);l.ex=n,j&&(l.ex=n+g),(L||R)&&O&&(l.ex=n-g);break;case"right":l.sx=t-g,l.ex=n-g;var W=f(o-1,i+1)||s(o,i+1),V=s(o,i),H=f(o-1,i);l.sy=e,W&&(l.sy=e-g),(V||H)&&v&&(l.sy=e+g);var M=s(o+1,i+1)||f(o,i+1),N=f(o,i),D=s(o+1,i);l.ey=r,M&&(l.ey=r+g),(N||D)&&w&&(l.ey=r-g);break;case"bottom":l.sy=e-g,l.ey=r-g;var I=u(o+1,i-1)||a(o+1,i),B=a(o,i),Y=u(o,i-1);l.sx=t,I&&(l.sx=t-g),(B||Y)&&m&&(l.sx=t+g);var F=a(o+1,i+1)||u(o+1,i),z=u(o,i),U=a(o,i+1);l.ex=n,F&&(l.ex=n+g),(z||U)&&O&&(l.ex=n-g)}return l}switch(c){case"left":l.sx=t+g,l.ex=n+g;var X=f(o-1,i-1)||s(o,i-1),G=s(o,i),K=f(o-1,i);l.sy=e,X&&(l.sy=e-g),(G||K)&&(l.sy=e+g);var q=s(o+1,i-1)||f(o,i-1),$=f(o,i),Z=s(o+1,i);l.ey=r,q&&(l.ey=r+g),($||Z)&&(l.ey=r-g);break;case"top":l.sy=e+g,l.ey=r+g;var J=u(o-1,i-1)||a(o-1,i),Q=a(o,i),tt=u(o,i-1);l.sx=t,J&&(l.sx=t-g),(Q||tt)&&(l.sx=t+g);var et=a(o-1,i+1)||u(o-1,i),nt=u(o,i),rt=a(o,i+1);l.ex=n,et&&(l.ex=n+g),(nt||rt)&&(l.ex=n-g);break;case"right":l.sx=t-g,l.ex=n-g;var ot=f(o-1,i+1)||s(o,i+1),it=s(o,i),ct=f(o-1,i);l.sy=e,ot&&(l.sy=e-g),(it||ct)&&(l.sy=e+g);var lt=s(o+1,i+1)||f(o,i+1),at=f(o,i),st=s(o+1,i);l.ey=r,lt&&(l.ey=r+g),(at||st)&&(l.ey=r-g);break;case"bottom":l.sy=e-g,l.ey=r-g;var ut=u(o+1,i-1)||a(o+1,i),ft=a(o,i),ht=u(o,i-1);l.sx=t,ut&&(l.sx=t-g),(ft||ht)&&(l.sx=t+g);var pt=a(o+1,i+1)||u(o+1,i),yt=u(o,i),bt=a(o,i+1);l.ex=n,pt&&(l.ex=n+g),(yt||bt)&&(l.ex=n-g)}return l}},{key:"drawLine",value:function(t,e,n,r,o,i,c){var l=this.draw,a=this.width,s=this.color;l.beginPath(),l.attr({lineWidth:a,strokeStyle:s}),l.setLineDash([]);var u=this.handleExternal(t,e,n,r,o,i,c),f=this.handleInternal(t,e,n,r,o,i,c);S.isEmptyObject(f)||l.line([f.sx,f.sy],[f.ex,f.ey]),S.isEmptyObject(u)||l.line([u.sx,u.sy],[u.ex,u.ey])}},{key:"setColor",value:function(t){this.color=t}},{key:"setWidth",value:function(t){this.width=t}}]),t}(),zi=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Mi(this,t),this.type=Ii.SOLID_LINE,this.solidLine=new Bi(e,S.mergeDeep({},n)),this.dottedLine=new Yi(e,S.mergeDeep({dash:[5]},n)),this.pointLine=new Yi(e,S.mergeDeep({dash:[2,2]},n)),this.doubleLine=new Fi(e,S.mergeDeep({},n))}return Di(t,[{key:"drawLine",value:function(t,e,n,r,o,i,c){var l=this.type,a=this.solidLine,s=this.dottedLine,u=this.pointLine,f=this.doubleLine;switch(l){case Ii.SOLID_LINE:a.drawLine(t,e,n,r);break;case Ii.DOTTED_LINE:s.drawLine(t,e,n,r);break;case Ii.POINT_LINE:u.drawLine(t,e,n,r);break;case Ii.DOUBLE_LINE:f.drawLine(t,e,n,r,o,i,c)}}},{key:"setType",value:function(t){this.type=t}},{key:"setWidth",value:function(t){t&&this.type===Ii.SOLID_LINE&&this.solidLine.setWidth(t)}},{key:"setColor",value:function(t){t&&(this.solidLine.setColor(t),this.dottedLine.setColor(t),this.pointLine.setColor(t),this.doubleLine.setColor(t))}}]),t}();function Ui(t){return(Ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xi(t){return(Xi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ki(t,e){return(Ki=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qi=function(t){function e(){var t,n,i,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,i=Xi(e).call(this,"".concat(o,"-border-type-context-menu"),S.mergeDeep({onUpdate:function(){}},c)),(t=!i||"object"!==Ui(i)&&"function"!=typeof i?Gi(n):i).type=Ii.SOLID_LINE,t.color="#000000",t.borderIcon1=new so,t.borderIcon2=new yo,t.borderIcon3=new mo,t.borderIcon4=new _o,t.borderIcon5=new Ao;var l=T("div","".concat(o,"-border-type-context-menu-type-icon-line"));l.children(t.borderIcon1),l.children(t.borderIcon2),l.children(t.borderIcon3),l.children(t.borderIcon4),l.children(t.borderIcon5),t.borderIcon6=new Vo,t.borderIcon7=new Io,t.borderIcon8=new Uo,t.borderIcon9=new $o,t.borderIcon10=new ei;var a=T("div","".concat(o,"-border-type-context-menu-type-icon-line"));a.children(t.borderIcon6),a.children(t.borderIcon7),a.children(t.borderIcon8),a.children(t.borderIcon9),a.children(t.borderIcon10),t.borderIcons=new oo,t.borderIcons.removeClass("hover"),t.borderIcons.children(l),t.borderIcons.children(a),t.borderColor=new li,t.borderType=new hi;var s=T("div","".concat(o,"-border-type-context-menu-type-icon-line"));return s.children(t.borderColor),s.children(t.borderType),t.borderColorAndType=new oo,t.borderColorAndType.removeClass("hover"),t.borderColorAndType.children(s),t.addItem(t.borderIcons),t.addItem(new We),t.addItem(t.borderColorAndType),t.borderColorContextMenu=new Si(S.copyProp({el:t.borderColor,position:se.BOTTOM},{onUpdate:function(e){t.color=e,t.borderColor.setColor(e)}})),t.lineTypeContextMenu=new Hi(S.copyProp({el:t.borderType,position:se.BOTTOM},{onUpdate:function(e){t.type=e}})),Wt.bind(t.borderColor,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=Gi(t).borderColorContextMenu,r=n.elPopUp;fe.closeAll([r,t.elPopUp]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Wt.bind(t.borderType,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=Gi(t).lineTypeContextMenu,r=n.elPopUp;fe.closeAll([r,t.elPopUp]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Wt.bind(t.borderIcon1,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border1",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Wt.bind(t.borderIcon2,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border2",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Wt.bind(t.borderIcon3,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border3",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Wt.bind(t.borderIcon4,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border4",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Wt.bind(t.borderIcon5,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border5",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Wt.bind(t.borderIcon6,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border6",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Wt.bind(t.borderIcon7,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border7",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Wt.bind(t.borderIcon8,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border8",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Wt.bind(t.borderIcon9,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border9",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Wt.bind(t.borderIcon10,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border10",t.color,t.type),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ki(t,e)}(e,t),e}(ge);function $i(t){return($i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zi(t){return(Zi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ji(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qi(t,e){return(Qi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var tc=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(i=Zi(e).call(this,"".concat(o,"-tools-border")))||"object"!==$i(i)&&"function"!=typeof i?Ji(r):i).options=S.copyProp({contextMenu:{}},t),n.icon=new tt("border"),n.setIcon(n.icon),n.borderTypeContextMenu=new qi(S.copyProp({el:Ji(n),position:se.BOTTOM},n.options.contextMenu)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qi(t,e)}(e,t),e}(Lt);function ec(t){return(ec="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nc(t,e){return!e||"object"!==ec(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function rc(t){return(rc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oc(t,e){return(oc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ic=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=nc(this,rc(e).call(this,"".concat(o,"-tools-merge")))).icon=new tt("merge"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oc(t,e)}(e,t),e}(it);function cc(t){return(cc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lc(t,e){return!e||"object"!==cc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ac(t){return(ac=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sc(t,e){return(sc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var uc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=lc(this,ac(e).call(this,"".concat(o,"-tools-horizontal1")))).icon=new tt("align-left"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sc(t,e)}(e,t),e}(it);function fc(t){return(fc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hc(t,e){return!e||"object"!==fc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pc(t){return(pc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yc(t,e){return(yc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=hc(this,pc(e).call(this,"".concat(o,"-tools-horizontal2")))).icon=new tt("align-center"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yc(t,e)}(e,t),e}(it);function dc(t){return(dc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gc(t,e){return!e||"object"!==dc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vc(t){return(vc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wc(t,e){return(wc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=gc(this,vc(e).call(this,"".concat(o,"-tools-horizontal3")))).icon=new tt("align-right"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wc(t,e)}(e,t),e}(it);function Oc(t){return(Oc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ec(t,e){return!e||"object"!==Oc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sc(t){return(Sc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xc(t,e){return(xc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _c=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ec(this,Sc(e).call(this,"".concat(o,"-horizontal-type-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xc(t,e)}(e,t),e}(Ee);function kc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Tc=function(){function t(e){var n=e.rect,r=e.draw,o=e.offset,i=void 0===o?0:o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rect=n,this.draw=r,this.offset=i}var e,n,r;return e=t,(n=[{key:"open",value:function(){var t=this.rect,e=this.draw,n=this.offset,r=t.x,o=t.y,i=t.width,c=t.height;return e.save(),e.rect(r,o,i+n,c+n),e.clip(),this}},{key:"close",value:function(){return this.draw.restore(),this}}])&&kc(e.prototype,n),r&&kc(e,r),t}();function Cc(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Pc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ac(){return window.devicePixelRatio||1}function jc(t){return Math.ceil(t*Ac())}function Lc(t){return-t*(Math.PI/180)}var Rc=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.ctx=e.getContext("2d"),this.width=e.width,this.height=e.height,this.offsetX=0,this.offsetY=0}var e,n,r;return e=t,(n=[{key:"rotate",value:function(t){return this.ctx.rotate(Lc(t)),this}},{key:"offset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offsetX=t,this.offsetY=e}},{key:"resize",value:function(t,e){var n=this.el;return this.width=t,this.height=e,n.style.width="".concat(t,"px"),n.style.height="".concat(e,"px"),n.width=jc(t),n.height=jc(e),this}},{key:"clear",value:function(){var t=this.width,e=this.height;return this.clearRect(0,0,t,e),this}},{key:"attr",value:function(t){for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];("string"==typeof n||n instanceof String)&&(n=n.trim()),this.ctx[e]!==n&&(this.ctx[e]=n)}return this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"save",value:function(){return this.ctx.save(),this.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"clip",value:function(){return this.ctx.clip(),this}},{key:"fill",value:function(){this.ctx.fill()}},{key:"setLineDash",value:function(t){this.ctx.setLineDash(t)}},{key:"measureText",value:function(t){return this.ctx.measureText(t)}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){var e=arguments.length<=0?void 0:arguments[0],n=Cc(e,2),r=n[0],o=n[1];this.moveTo(r,o);for(var i=1,c=arguments.length;i<c;i+=1){var l=i<0||arguments.length<=i?void 0:arguments[i],a=Cc(l,2),s=a[0],u=a[1];this.lineTo(s,u)}t.stroke()}return this}},{key:"clearRect",value:function(t,e,n,r){var o=this.offsetX,i=this.offsetY;return this.ctx.clearRect(jc(t+o),jc(e+i),jc(n),jc(r)),this}},{key:"rect",value:function(t,e,n,r){var o=this.offsetX,i=this.offsetY;return this.ctx.rect(jc(t+o),jc(e+i),jc(n),jc(r)),this}},{key:"fillRect",value:function(t,e,n,r){var o=this.offsetX,i=this.offsetY;return this.ctx.fillRect(jc(t+o),jc(e+i),jc(n),jc(r)),this}},{key:"fillText",value:function(t,e,n){var r=this.offsetX,o=this.offsetY;return this.ctx.fillText(t,jc(e+r),jc(n+o)),this}},{key:"moveTo",value:function(t,e){var n=this.ctx,r=this.offsetX,o=this.offsetY,i=n.lineWidth%2==0,c=i?jc(t+r):jc(t+r)+.5,l=i?jc(e+o):jc(e+o)+.5;n.moveTo(c,l)}},{key:"lineTo",value:function(t,e){var n=this.ctx,r=this.offsetX,o=this.offsetY,i=n.lineWidth%2==0,c=i?jc(t+r):jc(t+r)+.5,l=i?jc(e+o):jc(e+o)+.5;n.lineTo(c,l)}},{key:"drawImage",value:function(t,e,n,r,o,i,c,l,a){var s=this.offsetX,u=this.offsetY;this.ctx.drawImage(t,jc(e+s),jc(n+u),jc(r),jc(o),jc(i+s),jc(c+u),jc(l),jc(a))}}])&&Pc(e.prototype,n),r&&Pc(e,r),t}();function Wc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Vc=function(){function t(e){var n=e.x,r=e.y,o=e.width,i=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=n,this.y=r,this.width=o,this.height=i}var e,n,r;return e=t,(n=[{key:"expandSize",value:function(t){return this.width+=t,this.height+=t,this}},{key:"clone",value:function(){return new t({x:this.x,y:this.y,width:this.width,height:this.height})}}])&&Wc(e.prototype,n),r&&Wc(e,r),t}();function Hc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Nc(t,e,n){return e&&Mc(t.prototype,e),n&&Mc(t,n),t}var Dc={TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right",MIDDLE_LEFT:"middle-left",MIDDLE_CENTER:"middle-center",MIDDLE_RIGHT:"middle-right",BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right"},Ic=function(){function t(e){var n=e.dw,r=e.angle,o=e.origin,i=void 0===o?Dc.MIDDLE_CENTER:o,c=e.rect,l=void 0===c?new Vc({x:0,y:0,width:0,height:0}):c;Hc(this,t),this.dw=n,this.origin=i,this.rect=l,this.angle=r}return Nc(t,[{key:"rotate",value:function(){var t=this.origin,e=this.dw,n=this.rect,r=this.angle,o=n.x,i=n.y,c=n.width,l=n.height;e.save();var a=0,s=0;switch(t){case Dc.TOP_LEFT:a=o,s=i;break;case Dc.TOP_CENTER:a=o+c/2,s=i;break;case Dc.TOP_RIGHT:a=o+c,s=i;break;case Dc.MIDDLE_LEFT:a=o,s=i+l/2;break;case Dc.MIDDLE_CENTER:a=o+c/2,s=i+l/2;break;case Dc.MIDDLE_RIGHT:a=o+c,s=i+l/2;break;case Dc.BOTTOM_LEFT:a=o,s=i+l;break;case Dc.BOTTOM_CENTER:a=o+c/2,s=i+l;break;case Dc.BOTTOM_RIGHT:a=o+c,s=i+l}return e.ctx.translate(jc(a+e.offsetX),jc(s+e.offsetY)),e.rotate(r),e.ctx.translate(-jc(a+e.offsetX),-jc(s+e.offsetY)),this}},{key:"revert",value:function(){return this.dw.restore(),this}},{key:"setOrigin",value:function(t){return this.origin=t,this}},{key:"setRect",value:function(t){return this.rect=t,this}}],[{key:"triangleHypotenuse",value:function(t,e){var n=Math.cos(Lc(t)),r=Math.sin(Lc(t));return{width:Math.abs(n*e),height:Math.abs(r*e)}}}]),t}(),Bc=function(){function t(e){var n=e.angle,r=e.width,o=e.height;Hc(this,t),this.angle=n,this.width=r,this.height=o}return Nc(t,[{key:"sinWidthAngle",value:function(){var t=this.angle,e=this.width;return Math.abs(Math.sin(Lc(t))*e)}},{key:"cosWidthAngle",value:function(){var t=this.angle,e=this.width;return Math.abs(Math.cos(Lc(t))*e)}},{key:"sinHeightAngle",value:function(){var t=this.angle,e=this.height;return Math.abs(e/Math.sin(Lc(t)))}},{key:"setWidth",value:function(t){this.width=t}},{key:"setHeight",value:function(t){this.height=t}},{key:"setAngle",value:function(t){this.angle=t}}]),t}();function Yc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zc(t,e,n){return e&&Fc(t.prototype,e),n&&Fc(t,n),t}var Uc={left:"left",center:"center",right:"right"},Xc={top:"top",center:"middle",bottom:"bottom"},Gc={OVER_FLOW:1,WORD_WRAP:2,TRUNCATE:3},Kc={HORIZONTAL:"horizontal",VERTICAL:"vertical",ANGLE:"angle"},qc=function(){function t(e){var n=e.text,r=e.rect,o=e.dw,i=e.overflow,c=e.overflowCrop,l=e.attr;Yc(this,t),this.text=n,this.dw=o,this.rect=r,this.overflow=i,this.overflowCrop=c,this.attr=l}return zc(t,[{key:"textWidth",value:function(t){return this.dw.measureText(t).width}},{key:"drawLine",value:function(t,e,n,r){var o=this.dw,i=this.attr,c=i.size,l=i.verticalAlign,a=i.align,s=[0,0],u=[0,0];if("strike"===t){switch(a){case Uc.right:s[0]=e-r,u[0]=e;break;case Uc.center:s[0]=e-r/2,u[0]=e+r/2;break;case Uc.left:s[0]=e,u[0]=e+r}switch(l){case Xc.top:s[1]=n+c/2,u[1]=n+c/2;break;case Xc.center:s[1]=n,u[1]=n;break;case Xc.bottom:s[1]=n-c/2,u[1]=n-c/2}}if("underline"===t){switch(a){case Uc.right:s[0]=e-r,u[0]=e;break;case Uc.center:s[0]=e-r/2,u[0]=e+r/2;break;case Uc.left:s[0]=e,u[0]=e+r}switch(l){case Xc.top:s[1]=n+c,u[1]=n+c;break;case Xc.center:s[1]=n+c/2,u[1]=n+c/2;break;case Xc.bottom:s[1]=n,u[1]=n}}o.line(s,u)}},{key:"drawTextTruncate",value:function(){var t,e=this.text,n=this.dw,r=this.attr,o=this.rect,i=r.underline,c=r.strikethrough,l=r.align,a=r.verticalAlign,s=o.width,u=o.height,f=this.textWidth(e)/Ac(),h=o.x,p=o.y;switch(l){case Uc.left:h+=8;break;case Uc.center:h+=s/2;break;case Uc.right:h+=s-8}switch(a){case Xc.top:p+=8;break;case Xc.center:p+=u/2;break;case Xc.bottom:p+=u-8}switch(l){case Uc.right:case Uc.left:t=f+16;break;case Uc.center:default:t=f}var y=new Tc({draw:n,rect:o});return y.open(),n.fillText(e,h,p),(i||c)&&n.beginPath(),i&&this.drawLine("underline",h,p,f),c&&this.drawLine("strike",h,p,f),y.close(),t}},{key:"drawTextOverFlow",value:function(){var t,e=this.text,n=this.dw,r=this.attr,o=this.rect,i=this.overflow,c=this.overflowCrop,l=r.size,a=r.underline,s=r.strikethrough,u=r.align,f=r.verticalAlign,h=o.width,p=o.height,y=this.textWidth(e)/Ac(),b=o.x,d=o.y,g=0,v=0;switch(u){case Uc.left:b+=8,g=8;break;case Uc.center:b+=h/2;break;case Uc.right:b+=h-8,g=8}switch(f){case Xc.top:d+=8,v=8;break;case Xc.center:d+=p/2;break;case Xc.bottom:d+=p-8,v=8}switch(u){case Uc.right:case Uc.left:t=y+16;break;case Uc.center:default:t=y}if(c||i&&(y+g>i.width||l+v>i.height)){var w=new Tc({draw:n,rect:i});w.open(),n.fillText(e,b,d),(a||s)&&n.beginPath(),a&&this.drawLine("underline",b,d,y),s&&this.drawLine("strike",b,d,y),w.close()}else n.fillText(e,b,d),(a||s)&&n.beginPath(),a&&this.drawLine("underline",b,d,y),s&&this.drawLine("strike",b,d,y);return t}},{key:"drawTextWarp",value:function(){for(var t=this.text,e=this.dw,n=this.attr,r=this.rect,o=n.size,i=n.underline,c=n.strikethrough,l=n.align,a=n.verticalAlign,s=r.width,u=r.height,f=s-16,h=[],p={len:0,start:0},y=t.length,b=0,d=0,g=0;d<y;){var v=this.textWidth(t.charAt(d))/Ac(),w=p.len+v;w>f?(0===p.len?(h.push({text:t.substring(d,d+1),len:w,tx:0,ty:b}),d+=1,w>g&&(g=w)):(h.push({text:t.substring(p.start,d),len:p.len,tx:0,ty:b}),p.len>g&&(g=p.len)),b+=o+4,p.len=0,p.start=d):(p.len=w,d+=1)}p.len>0&&(h.push({text:t.substring(p.start),len:p.len,tx:0,ty:b}),p.len>g&&(g=p.len));var m,O=r.x,E=r.y;switch(l){case Uc.left:O+=8;break;case Uc.center:O+=s/2;break;case Uc.right:O+=s-8}switch(a){case Xc.top:E+=8;break;case Xc.center:E+=u/2-b/2;break;case Xc.bottom:E+=u-b-8}switch(l){case Uc.right:case Uc.left:m=g+16;break;case Uc.center:default:m=g}var S=new Tc({draw:e,rect:r});S.open();for(var x=0,_=h.length;x<_;x+=1){var k=h[x];k.tx+=O,k.ty+=E,e.fillText(k.text,k.tx,k.ty),(i||c)&&e.beginPath(),i&&this.drawLine("underline",k.tx,k.ty,k.len),c&&this.drawLine("strike",k.tx,k.ty,k.len)}return S.close(),m}},{key:"draw",value:function(){var t=this.dw,e=this.attr,n=e.textWrap;switch(t.attr({textAlign:e.align,textBaseline:e.verticalAlign,font:"".concat(e.italic?"italic":""," ").concat(e.bold?"bold":""," ").concat(jc(e.size),"px ").concat(e.name),fillStyle:e.color,strokeStyle:e.color}),n){case Gc.TRUNCATE:return this.drawTextTruncate();case Gc.WORD_WRAP:return this.drawTextWarp();case Gc.OVER_FLOW:default:return this.drawTextOverFlow()}}},{key:"setTextWrap",value:function(t){this.attr.textWrap=t}},{key:"setOverflowCrop",value:function(t){this.overflowCrop=t}}]),t}(),$c=function(){function t(e){var n=e.text,r=e.rect,o=e.dw,i=e.overflow,c=e.overflowCrop,l=e.attr;Yc(this,t),this.text=n,this.dw=o,this.rect=r,this.overflow=i,this.overflowCrop=c,this.attr=l}return zc(t,[{key:"textWidth",value:function(t){return this.dw.measureText(t).width}},{key:"drawLine",value:function(t,e,n,r,o,i){var c=this.dw,l=this.attr.size,a=[0,0],s=[0,0];if("strike"===t){switch(o){case Uc.right:a[0]=e-r,s[0]=e;break;case Uc.center:a[0]=e-r/2,s[0]=e+r/2;break;case Uc.left:a[0]=e,s[0]=e+r}switch(i){case Xc.top:a[1]=n+l/2,s[1]=n+l/2;break;case Xc.center:a[1]=n,s[1]=n;break;case Xc.bottom:a[1]=n-l/2,s[1]=n-l/2}}if("underline"===t){switch(o){case Uc.right:a[0]=e-r,s[0]=e;break;case Uc.center:a[0]=e-r/2,s[0]=e+r/2;break;case Uc.left:a[0]=e,s[0]=e+r}switch(i){case Xc.top:a[1]=n+l,s[1]=n+l;break;case Xc.center:a[1]=n+l/2,s[1]=n+l/2;break;case Xc.bottom:a[1]=n,s[1]=n}}c.line(a,s)}},{key:"drawTextTruncate",value:function(){for(var t=this.text,e=this.dw,n=this.attr,r=this.rect,o=n.underline,i=n.strikethrough,c=n.align,l=n.verticalAlign,a=n.size,s=r.width,u=r.height,f=[],h=0,p=0;p<t.length;p+=1){var y=t.charAt(p);f.push({len:this.textWidth(y)/Ac(),text:y,tx:0,ty:h}),p<t.length-1?h+=a+2:h+=a}var b,d=r.x,g=r.y;switch(c){case Uc.left:d+=8;break;case Uc.center:d+=s/2;break;case Uc.right:d+=s-8}switch(l){case Xc.top:g+=8;break;case Xc.center:g+=u/2-h/2+8;break;case Xc.bottom:g+=u-h+8}switch(c){case Uc.left:case Uc.right:b=a+16;break;case Uc.center:default:b=a}var v=new Tc({draw:e,rect:r});v.open();for(var w=0,m=f.length;w<m;w+=1){var O=f[w];O.tx+=d,O.ty+=g,e.fillText(O.text,O.tx,O.ty),(o||i)&&e.beginPath(),o&&this.drawLine("underline",O.tx,O.ty,O.len,c,l),i&&this.drawLine("strike",O.tx,O.ty,O.len,c,l)}return v.close(),b}},{key:"drawTextOverFlow",value:function(){for(var t=this.text,e=this.dw,n=this.attr,r=this.rect,o=this.overflow,i=this.overflowCrop,c=n.underline,l=n.strikethrough,a=n.align,s=n.verticalAlign,u=n.size,f=r.width,h=r.height,p=[],y=0,b=0;b<t.length;b+=1){var d=t.charAt(b);p.push({len:this.textWidth(d)/Ac(),text:d,tx:0,ty:y}),b<t.length-1?y+=u+2:y+=u}var g,v=r.x,w=r.y,m=0,O=0;switch(a){case Uc.left:v+=8,m=8;break;case Uc.center:v+=f/2;break;case Uc.right:v+=f-8,m=8}switch(s){case Xc.top:w+=8,O=8;break;case Xc.center:w+=h/2-y/2+8;break;case Xc.bottom:w+=h-y+8,O=8}switch(a){case Uc.left:case Uc.right:g=u+16;break;case Uc.center:default:g=u}if(i||o&&(y+O>o.height||u+m>o.width)){var E=new Tc({draw:e,rect:o});E.open();for(var S=0,x=p.length;S<x;S+=1){var _=p[S];_.tx+=v,_.ty+=w,e.fillText(_.text,_.tx,_.ty),(c||l)&&e.beginPath(),c&&this.drawLine("underline",_.tx,_.ty,_.len,a,s),l&&this.drawLine("strike",_.tx,_.ty,_.len,a,s)}E.close()}else for(var k=0,T=p.length;k<T;k+=1){var C=p[k];C.tx+=v,C.ty+=w,e.fillText(C.text,C.tx,C.ty),(c||l)&&e.beginPath(),c&&this.drawLine("underline",C.tx,C.ty,C.len,a,s),l&&this.drawLine("strike",C.tx,C.ty,C.len,a,s)}return g}},{key:"drawTextWarp",value:function(){for(var t=this.text,e=this.dw,n=this.attr,r=this.rect,o=n.underline,i=n.strikethrough,c=n.align,l=n.verticalAlign,a=n.size,s=r.width,u=r.height,f=[],h=t.length,p=u-16,y=[],b=0,d=0,g=0,v=0,w=0;w<h;){var m=w===h-1,O=0===w,E=t.charAt(w),S=this.textWidth(E)/Ac(),x=void 0;(x=m?b+a:b+a+2)>p?(y.length>0&&f.push(y),b=0,O||(g+=a+0),v+=1,(y=[]).push({len:S,text:E,tx:g,ty:d=0}),b=m?a:a+2):(y.push({len:S,text:E,tx:g,ty:d}),b=x),d+=m?a:a+2,w+=1}y.length>0&&f.push(y);var _,k=r.x,T=r.y,C=l;switch(c){case Uc.left:k+=8;break;case Uc.center:k+=s/2-g/2;break;case Uc.right:k+=s-g-8}switch(l){case Xc.top:e.attr({textBaseline:n.verticalAlign}),T+=8,C=Xc.top;break;case Xc.center:0===v?(e.attr({textBaseline:n.verticalAlign}),T+=u/2-d/2+8,C=Xc.center):(e.attr({textBaseline:Xc.top}),T+=8,C=Xc.top);break;case Xc.bottom:0===v?(e.attr({textBaseline:Xc.bottom}),T+=u-d+8,C=Xc.bottom):(e.attr({textBaseline:Xc.top}),T+=8,C=Xc.top)}switch(c){case Uc.left:case Uc.right:_=g+a+16;break;case Uc.center:default:_=g+a}var P=new Tc({draw:e,rect:r});P.open();for(var A=0,j=f.length;A<j;A+=1)for(var L=f[A],R=0;R<L.length;R+=1){var W=L[R];W.tx+=k,W.ty+=T,e.fillText(W.text,W.tx,W.ty),(o||i)&&e.beginPath(),o&&this.drawLine("underline",W.tx,W.ty,W.len,c,C),i&&this.drawLine("strike",W.tx,W.ty,W.len,c,C)}return P.close(),_}},{key:"draw",value:function(){var t=this.dw,e=this.attr;switch(e.textWrap){case Gc.TRUNCATE:return t.attr({textAlign:e.align,textBaseline:e.verticalAlign,font:"".concat(e.italic?"italic":""," ").concat(e.bold?"bold":""," ").concat(jc(e.size),"px ").concat(e.name),fillStyle:e.color,strokeStyle:e.color}),this.drawTextTruncate();case Gc.WORD_WRAP:return t.attr({textAlign:e.align,font:"".concat(e.italic?"italic":""," ").concat(e.bold?"bold":""," ").concat(jc(e.size),"px ").concat(e.name),fillStyle:e.color,strokeStyle:e.color}),this.drawTextWarp();case Gc.OVER_FLOW:default:return t.attr({textAlign:e.align,textBaseline:e.verticalAlign,font:"".concat(e.italic?"italic":""," ").concat(e.bold?"bold":""," ").concat(jc(e.size),"px ").concat(e.name),fillStyle:e.color,strokeStyle:e.color}),this.drawTextOverFlow()}}},{key:"setTextWrap",value:function(t){this.attr.textWrap=t}},{key:"setOverflowCrop",value:function(t){this.overflowCrop=t}}]),t}(),Zc=function(){function t(e){var n=e.text,r=e.rect,o=e.dw,i=e.overflow,c=e.overflowCrop,l=e.attr;Yc(this,t),this.text=n,this.dw=o,this.rect=r,this.overflow=i,this.overflowCrop=c,this.attr=l}return zc(t,[{key:"textWidth",value:function(t){return this.dw.measureText(t).width}},{key:"drawLine",value:function(t,e,n,r){var o=this.dw,i=this.attr.size,c=[0,0],l=[0,0];"strike"===t&&(c[0]=e,l[0]=e+r,c[1]=n+i/2,l[1]=n+i/2),"underline"===t&&(c[0]=e,l[0]=e+r,c[1]=n+i,l[1]=n+i),o.line(c,l)}},{key:"drawTextTruncate",value:function(){var t=this.text,e=this.dw,n=this.attr,r=this.rect,o=n.underline,i=n.strikethrough,c=n.align,l=n.verticalAlign,a=n.size,s=n.angle,u=r.width,f=r.height;s>90&&(s=90),s<-90&&(s=-90);var h,p=this.textWidth(t)/Ac(),y=new Bc({angle:s,width:p,height:a}),b=y.cosWidthAngle(),d=y.sinWidthAngle(),g=r.x,v=r.y;switch(c){case Uc.left:g+=8;break;case Uc.center:g+=u/2-b/2;break;case Uc.right:g+=u-b-8}switch(l){case Xc.top:v+=8;break;case Xc.center:v+=f/2-d/2;break;case Xc.bottom:v+=f-d-8}switch(c){case Uc.right:case Uc.left:h=b+16;break;case Uc.center:default:h=b}var w,m=g+(b/2-p/2),O=v+(d/2-a/2),E=new Ic({dw:e,angle:s,rect:new Vc({x:g,y:v,width:b,height:d})});return(w=new Tc(0===s?{draw:e,rect:r}:{draw:e,rect:new Vc({x:0,y:r.y,width:h,height:r.height})})).open(),E.rotate(),e.fillText(t,m,O),(o||i)&&e.beginPath(),o&&this.drawLine("underline",m,O,p),i&&this.drawLine("strike",m,O,p),E.revert(),w.close(),h}},{key:"drawTextOverFlow",value:function(){var t=this.text,e=this.dw,n=this.attr,r=this.rect,o=this.overflow,i=n.underline,c=n.strikethrough,l=n.align,a=n.verticalAlign,s=n.size,u=n.overflowCrop,f=n.angle,h=r.width,p=r.height;f>90&&(f=90),f<-90&&(f=-90);var y,b=this.textWidth(t)/Ac(),d=new Bc({angle:f,width:b,height:s}),g=d.cosWidthAngle(),v=d.sinWidthAngle(),w=r.x,m=r.y;switch(l){case Uc.left:w+=8;break;case Uc.center:w+=h/2-g/2;break;case Uc.right:w+=h-g-8}switch(a){case Xc.top:m+=8;break;case Xc.center:m+=p/2-v/2;break;case Xc.bottom:m+=p-v-8}switch(l){case Uc.right:case Uc.left:y=g+16;break;case Uc.center:default:y=g}var O,E=w+(g/2-b/2),S=m+(v/2-s/2),x=new Ic({dw:e,angle:f,rect:new Vc({x:w,y:m,width:g,height:v})});return O=new Tc(0===f?{draw:e,rect:o}:{draw:e,rect:new Vc({x:0,y:r.y,width:y,height:r.height})}),u||o&&(g>o.width||v>o.height)?(O.open(),x.rotate(),e.fillText(t,E,S),(i||c)&&e.beginPath(),i&&this.drawLine("underline",E,S,b),c&&this.drawLine("strike",E,S,b),x.revert(),O.close()):(x.rotate(),e.fillText(t,E,S),(i||c)&&e.beginPath(),i&&this.drawLine("underline",E,S,b),c&&this.drawLine("strike",E,S,b),x.revert()),y}},{key:"drawTextWarp",value:function(){var t=this.text,e=this.dw,n=this.attr,r=this.rect,o=n.underline,i=n.strikethrough,c=n.align,l=n.verticalAlign,a=n.size,s=n.angle;s>90&&(s=90),s<-90&&(s=-90);var u=r.width,f=r.height;if(s>0){var h=new Bc({angle:s});h.setHeight(f-16);var p=h.sinHeightAngle();h.setHeight(a+4);for(var y=h.sinHeightAngle(),b=[],d={len:0,start:0},g=t.length,v=0;v<g;){var w=this.textWidth(t.charAt(v))/Ac(),m=d.len+w;m>p?(0===d.len?(b.push({text:t.substring(v,v+1),len:m,tx:0,ty:0}),v+=1):b.push({text:t.substring(d.start,v),len:d.len,tx:0,ty:0}),d.len=0,d.start=v):(d.len=m,v+=1)}d.len>0&&b.push({text:t.substring(d.start),len:d.len,tx:0,ty:0});for(var O=b.length,E=0,S=0;S<O;S+=1){b[S].tx=E,E+=y}if(O>1){h.setWidth(p);var x,_=Math.max(h.cosWidthAngle(),a),k=h.sinWidthAngle(),T=_+(b.length-1)*y,C=r.x,P=r.y;switch(c){case Uc.left:C+=8;break;case Uc.center:C+=u/2-T/2;break;case Uc.right:C+=u-T-8}switch(l){case Xc.top:P+=8;break;case Xc.center:P+=f/2-k/2;break;case Xc.bottom:P+=f-k-8}switch(c){case Uc.right:case Uc.left:x=T+16;break;case Uc.center:default:x=T}for(var A=0;A<b.length;A+=1){var j=b[A],L=j.tx+C,R=j.ty+P,W=0,V=0;switch(c){case Uc.left:h.setWidth(j.len/2),W+=L+Math.max(h.cosWidthAngle(),a),V+=R+k-h.sinWidthAngle();break;case Uc.center:W=L+_/2,V=R+k/2;break;case Uc.right:h.setWidth(j.len/2),W+=L+_-Math.max(h.cosWidthAngle(),a),V+=R+h.sinWidthAngle()}var H=W-j.len/2,M=V-a/2;-1===A&&(e.attr({fillStyle:"#000000"}),e.fillRect(L,R,_,k),e.attr({fillStyle:"red"}));var N=new Ic({dw:e,angle:s,rect:new Vc({x:H,y:M,width:j.len,height:a})});N.rotate(),e.fillText(j.text,H,M),(o||i)&&e.beginPath(),o&&this.drawLine("underline",H,M,j.len),i&&this.drawLine("strike",H,M,j.len),N.revert()}return x}var D=this.textWidth(t)/Ac();h.setWidth(D);var I,B=Math.max(h.cosWidthAngle(),a),Y=h.sinWidthAngle(),F=r.x,z=r.y;switch(c){case Uc.left:F+=8;break;case Uc.center:F+=u/2-B/2;break;case Uc.right:F+=u-B-8}switch(l){case Xc.top:z+=8;break;case Xc.center:z+=f/2-Y/2;break;case Xc.bottom:z+=f-Y-8}switch(c){case Uc.right:case Uc.left:I=B+16;break;case Uc.center:default:I=B}var U=new Ic({dw:e,angle:s,rect:new Vc({x:F,y:z,width:B,height:Y})});U.rotate();var X=F+(B/2-D/2),G=z+(Y/2-a/2);return e.fillText(t,X,G),(o||i)&&e.beginPath(),o&&this.drawLine("underline",X,G,D),i&&this.drawLine("strike",X,G,D),U.revert(),I}if(s<0){var K=new Bc({angle:s});K.setHeight(f-16);var q=K.sinHeightAngle();K.setHeight(a+4);for(var $=K.sinHeightAngle(),Z=[],J={len:0,start:0},Q=t.length,tt=0;tt<Q;){var et=this.textWidth(t.charAt(tt))/Ac(),nt=J.len+et;nt>q?(0===J.len?(Z.push({text:t.substring(tt,tt+1),len:nt,tx:0,ty:0}),tt+=1):Z.push({text:t.substring(J.start,tt),len:J.len,tx:0,ty:0}),J.len=0,J.start=tt):(J.len=nt,tt+=1)}J.len>0&&Z.push({text:t.substring(J.start),len:J.len,tx:0,ty:0});for(var rt=Z.length,ot=0,it=rt-1;it>=0;it-=1){Z[it].tx=ot,ot+=$}if(rt>1){K.setWidth(q);var ct,lt=Math.max(K.cosWidthAngle(),a),at=K.sinWidthAngle(),st=lt+(Z.length-1)*$,ut=r.x,ft=r.y;switch(c){case Uc.left:ut+=8;break;case Uc.center:ut+=u/2-st/2;break;case Uc.right:ut+=u-st-8}switch(l){case Xc.top:ft+=8;break;case Xc.center:ft+=f/2-at/2;break;case Xc.bottom:ft+=f-at-8}switch(c){case Uc.right:case Uc.left:ct=st+16;break;case Uc.center:default:ct=st}for(var ht=0;ht<Z.length;ht+=1){var pt=Z[ht],yt=pt.tx+ut,bt=pt.ty+ft,dt=0,gt=0;switch(c){case Uc.left:K.setWidth(pt.len/2),dt+=yt+Math.max(K.cosWidthAngle(),a),gt+=bt+K.sinWidthAngle();break;case Uc.center:dt=yt+lt/2,gt=bt+at/2;break;case Uc.right:K.setWidth(pt.len/2),dt+=yt+lt-Math.max(K.cosWidthAngle(),a),gt+=bt+at-K.sinWidthAngle()}var vt=dt-pt.len/2,wt=gt-a/2;-1===ht&&(e.attr({fillStyle:"#000000"}),e.fillRect(yt,bt,lt,at),e.attr({fillStyle:"red"}));var mt=new Ic({dw:e,angle:s,rect:new Vc({x:vt,y:wt,width:pt.len,height:a})});mt.rotate(),e.fillText(pt.text,vt,wt),(o||i)&&e.beginPath(),o&&this.drawLine("underline",vt,wt,pt.len),i&&this.drawLine("strike",vt,wt,pt.len),mt.revert()}return ct}var Ot=this.textWidth(t)/Ac();K.setWidth(Ot);var Et,St=Math.max(K.cosWidthAngle(),a),xt=K.sinWidthAngle(),_t=r.x,kt=r.y;switch(c){case Uc.left:_t+=8;break;case Uc.center:_t+=u/2-St/2;break;case Uc.right:_t+=u-St-8}switch(l){case Xc.top:kt+=8;break;case Xc.center:kt+=f/2-xt/2;break;case Xc.bottom:kt+=f-xt-8}switch(c){case Uc.right:case Uc.left:Et=St+16;break;case Uc.center:default:Et=St}var Tt=new Ic({dw:e,angle:s,rect:new Vc({x:_t,y:kt,width:St,height:xt})});Tt.rotate();var Ct=_t+(St/2-Ot/2),Pt=kt+(xt/2-a/2);return e.fillText(t,Ct,Pt),(o||i)&&e.beginPath(),o&&this.drawLine("underline",Ct,Pt,Ot),i&&this.drawLine("strike",Ct,Pt,Ot),Tt.revert(),Et}if(0===s){for(var At=u-16,jt=[],Lt={len:0,start:0},Rt=t.length,Wt=0,Vt=0;Wt<Rt;){var Ht=this.textWidth(t.charAt(Wt))/Ac(),Mt=Lt.len+Ht;Mt>At?(0===Lt.len?(jt.push({text:t.substring(Wt,Wt+1),len:Mt,tx:0,ty:0}),Wt+=1,Mt>Vt&&(Vt=Mt)):(jt.push({text:t.substring(Lt.start,Wt),len:Lt.len,tx:0,ty:0}),Lt.len>Vt&&(Vt=Lt.len)),Lt.len=0,Lt.start=Wt):(Lt.len=Mt,Wt+=1)}Lt.len>0&&(jt.push({text:t.substring(Lt.start),len:Lt.len,tx:0,ty:0}),Lt.len>Vt&&(Vt=Lt.len));for(var Nt=jt.length,Dt=0,It=0;It<Nt;It+=1){jt[It].ty=Dt,Dt+=a+4}var Bt,Yt=Nt*(a+4);switch(c){case Uc.right:case Uc.left:Bt=Vt+16;break;case Uc.center:default:Bt=Vt}var Ft=new Tc({draw:e,rect:r});Ft.open();for(var zt=0;zt<Nt;zt+=1){var Ut=jt[zt],Xt=r.x,Gt=r.y;switch(c){case Uc.left:Xt+=8;break;case Uc.center:Xt+=u/2-Ut.len/2;break;case Uc.right:Xt+=u-Ut.len-8}switch(l){case Xc.top:Gt+=Ut.ty+8;break;case Xc.center:Gt+=Ut.ty+(f/2-Yt/2);break;case Xc.bottom:Gt+=Ut.ty+(f-Yt-8)}e.fillText(Ut.text,Xt,Gt),(o||i)&&e.beginPath(),o&&this.drawLine("underline",Xt,Gt,Ut.len),i&&this.drawLine("strike",Xt,Gt,Ut.len)}return Ft.close(),Bt}return 0}},{key:"draw",value:function(){var t=this.dw,e=this.attr,n=e.textWrap;switch(t.attr({textAlign:Uc.left,textBaseline:Xc.top,font:"".concat(e.italic?"italic":""," ").concat(e.bold?"bold":""," ").concat(jc(e.size),"px ").concat(e.name),fillStyle:e.color,strokeStyle:e.color}),n){case Gc.TRUNCATE:return this.drawTextTruncate();case Gc.WORD_WRAP:return this.drawTextWarp();case Gc.OVER_FLOW:default:return this.drawTextOverFlow()}}},{key:"setOverflowCrop",value:function(t){this.overflowCrop=t}}]),t}(),Jc=function(){function t(e){var n=e.text,r=e.rect,o=e.dw,i=e.overflow,c=e.attr;Yc(this,t),this.attr=S.mergeDeep({},{name:"Arial",size:jc(13),color:"#000000",bold:!1,italic:!1,textWrap:!1,underline:!1,strikethrough:!1,align:Uc.left,verticalAlign:Xc.center,direction:Kc.HORIZONTAL,angle:0},c),this.verticalFontDraw=new $c({text:n,rect:r,dw:o,overflow:i,attr:this.attr}),this.horizontalFontDraw=new qc({text:n,rect:r,dw:o,overflow:i,attr:this.attr}),this.angleFontDraw=new Zc({text:n,rect:r,dw:o,overflow:i,attr:this.attr})}return zc(t,[{key:"draw",value:function(){switch(this.attr.direction){case Kc.VERTICAL:return this.verticalFontDraw.draw();case Kc.ANGLE:return this.angleFontDraw.draw();case Kc.HORIZONTAL:default:return this.horizontalFontDraw.draw()}}},{key:"setTextWrap",value:function(t){switch(this.attr.direction){case Kc.VERTICAL:this.verticalFontDraw.setTextWrap(t);break;case Kc.HORIZONTAL:default:this.horizontalFontDraw.setTextWrap(t)}}},{key:"setOverflowCrop",value:function(t){this.verticalFontDraw.setOverflowCrop(t),this.horizontalFontDraw.setOverflowCrop(t),this.angleFontDraw.setOverflowCrop(t)}}]),t}();function Qc(t){return(Qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tl(t,e){return!e||"object"!==Qc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function el(t){return(el=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nl(t,e){return(nl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rl=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=tl(this,el(e).call(this,"".concat(o,"-horizontal-type-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).horizontalIcon1=new uc,t.horizontalIcon2=new bc,t.horizontalIcon3=new mc;var i=T("div","".concat(o,"-horizontal-type-context-menu-type-icon-line"));return i.children(t.horizontalIcon1),i.children(t.horizontalIcon2),i.children(t.horizontalIcon3),t.horizontalIcons=new _c,t.horizontalIcons.removeClass("hover"),t.horizontalIcons.children(i),t.addItem(t.horizontalIcons),Wt.bind(t.horizontalIcon1,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(Uc.left),e.stopPropagation(),e.preventDefault()})),Wt.bind(t.horizontalIcon2,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(Uc.center),e.stopPropagation(),e.preventDefault()})),Wt.bind(t.horizontalIcon3,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(Uc.right),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nl(t,e)}(e,t),e}(ge);function ol(t){return(ol="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function il(t){return(il=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cl(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ll(t,e){return(ll=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var al=function(t){function e(){var t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(r=il(e).call(this,"".concat(o,"-tools-horizontal-align")))||"object"!==ol(r)&&"function"!=typeof r?cl(n):r).options=S.mergeDeep({contextMenu:{}},i),t.icon=new tt("align-left"),t.setIcon(t.icon),t.horizontalContextMenu=new rl(S.copyProp({el:cl(t),position:se.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ll(t,e)}(e,t),e}(Lt);function sl(t){return(sl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ul(t,e){return!e||"object"!==sl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fl(t){return(fl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hl(t,e){return(hl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ul(this,fl(e).call(this,"".concat(o,"-vertical-type-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hl(t,e)}(e,t),e}(Ee);function yl(t){return(yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bl(t,e){return!e||"object"!==yl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dl(t){return(dl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gl(t,e){return(gl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vl=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=bl(this,dl(e).call(this,"".concat(o,"-tools-verticalIcon1")))).icon=new tt("align-top"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gl(t,e)}(e,t),e}(it);function wl(t){return(wl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ml(t,e){return!e||"object"!==wl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ol(t){return(Ol=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function El(t,e){return(El=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Sl=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ml(this,Ol(e).call(this,"".concat(o,"-tools-verticalIcon2")))).icon=new tt("align-middle"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&El(t,e)}(e,t),e}(it);function xl(t){return(xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _l(t,e){return!e||"object"!==xl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kl(t){return(kl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tl(t,e){return(Tl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Cl=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=_l(this,kl(e).call(this,"".concat(o,"-tools-verticalIcon3")))).icon=new tt("align-bottom"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tl(t,e)}(e,t),e}(it);function Pl(t){return(Pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Al(t,e){return!e||"object"!==Pl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jl(t){return(jl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ll(t,e){return(Ll=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rl=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Al(this,jl(e).call(this,"".concat(o,"-vertical-type-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).verticalIcon1=new vl,t.verticalIcon2=new Sl,t.verticalIcon3=new Cl;var i=T("div","".concat(o,"-vertical-type-context-menu-type-icon-line"));return i.children(t.verticalIcon1),i.children(t.verticalIcon2),i.children(t.verticalIcon3),t.verticalIcons=new pl,t.verticalIcons.removeClass("hover"),t.verticalIcons.children(i),t.addItem(t.verticalIcons),Wt.bind(t.verticalIcon1,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(Xc.top),e.stopPropagation(),e.preventDefault()})),Wt.bind(t.verticalIcon2,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(Xc.center),e.stopPropagation(),e.preventDefault()})),Wt.bind(t.verticalIcon3,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(Xc.bottom),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ll(t,e)}(e,t),e}(ge);function Wl(t){return(Wl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vl(t){return(Vl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hl(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ml(t,e){return(Ml=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nl=function(t){function e(){var t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(r=Vl(e).call(this,"".concat(o,"-tools-vertical-align")))||"object"!==Wl(r)&&"function"!=typeof r?Hl(n):r).options=S.mergeDeep({contextMenu:{}},i),t.icon=new tt("align-middle"),t.setIcon(t.icon),t.verticalContextMenu=new Rl(S.copyProp({el:Hl(t),position:se.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ml(t,e)}(e,t),e}(Lt);function Dl(t){return(Dl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Il(t,e){return!e||"object"!==Dl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bl(t){return(Bl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yl(t,e){return(Yl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fl=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Il(this,Bl(e).call(this,"".concat(o,"-tools-text-wrapping1")))).icon=new tt("truncate"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yl(t,e)}(e,t),e}(it);function zl(t){return(zl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ul(t,e){return!e||"object"!==zl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xl(t){return(Xl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gl(t,e){return(Gl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Kl=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ul(this,Xl(e).call(this,"".concat(o,"-tools-text-wrapping2")))).icon=new tt("overflow"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gl(t,e)}(e,t),e}(it);function ql(t){return(ql="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $l(t,e){return!e||"object"!==ql(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zl(t){return(Zl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jl(t,e){return(Jl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ql=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=$l(this,Zl(e).call(this,"".concat(o,"-tools-text-wrapping3")))).icon=new tt("wrap"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jl(t,e)}(e,t),e}(it);function ta(t){return(ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ea(t,e){return!e||"object"!==ta(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function na(t){return(na=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ra(t,e){return(ra=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var oa=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ea(this,na(e).call(this,"".concat(o,"-text-wrapping-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ra(t,e)}(e,t),e}(Ee);function ia(t){return(ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ca(t,e){return!e||"object"!==ia(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function la(t){return(la=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function aa(t,e){return(aa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sa=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ca(this,la(e).call(this,"".concat(o,"-text-wrapping-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).textWrappingIcon1=new Fl,t.textWrappingIcon2=new Kl,t.textWrappingIcon3=new Ql;var i=T("div","".concat(o,"-text-wrapping-context-menu-type-icon-line"));return i.children(t.textWrappingIcon1),i.children(t.textWrappingIcon2),i.children(t.textWrappingIcon3),t.textWrappingIcons=new oa,t.textWrappingIcons.removeClass("hover"),t.textWrappingIcons.children(i),t.addItem(t.textWrappingIcons),Wt.bind(t.textWrappingIcon1,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(Gc.TRUNCATE),e.stopPropagation(),e.preventDefault()})),Wt.bind(t.textWrappingIcon2,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(Gc.OVER_FLOW),e.stopPropagation(),e.preventDefault()})),Wt.bind(t.textWrappingIcon3,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(Gc.WORD_WRAP),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&aa(t,e)}(e,t),e}(ge);function ua(t){return(ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fa(t){return(fa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ha(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pa(t,e){return(pa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ya=function(t){function e(){var t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(r=fa(e).call(this,"".concat(o,"-tools-text-wrapping")))||"object"!==ua(r)&&"function"!=typeof r?ha(n):r).options=S.mergeDeep({contextMenu:{}},i),t.icon=new tt("text-wrap"),t.setIcon(t.icon),t.textWrappingContextMenu=new sa(S.copyProp({el:ha(t),position:se.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pa(t,e)}(e,t),e}(Lt);function ba(t){return(ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function da(t,e){return!e||"object"!==ba(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ga(t){return(ga=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function va(t,e){return(va=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wa=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=da(this,ga(e).call(this,"".concat(o,"-tools-fixed")))).icon=new tt("freeze"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&va(t,e)}(e,t),e}(it);function ma(t){return(ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oa(t,e){return!e||"object"!==ma(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ea(t){return(Ea=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sa(t,e){return(Sa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xa=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Oa(this,Ea(e).call(this,"".concat(o,"-tools-filter")))).icon=new tt("filter"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sa(t,e)}(e,t),e}(it);function _a(t){return(_a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ka(t,e){return!e||"object"!==_a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ta(t){return(Ta=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ca(t,e){return(Ca=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pa=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ka(this,Ta(e).call(this,"".concat(o,"-tools-format")))).icon=new tt("functions"),t.setIcon(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ca(t,e)}(e,t),e}(Lt);function Aa(t){return(Aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ja(t,e){return!e||"object"!==Aa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function La(t){return(La=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ra(t,e){return(Ra=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wa='\n  <svg class="'.concat(o,'-copy-style-svg" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">\n    <line class="').concat(o,'-copy-style-stroked-top" x1="0" y1="0" x2="100%" y2="0"/>\n    <line class="').concat(o,'-copy-style-stroked-left" x1="0" y1="0" x2="0" y2="100%"/>\n    <line class="').concat(o,'-copy-style-stroked-bottom" x1="0" y1="100%" x2="100%" y2="100%"/>\n    <line class="').concat(o,'-copy-style-stroked-right" x1="100%" y1="0" x2="100%" y2="100%"/>\n  </svg>\n'),Va=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ja(this,La(e).call(this,"".concat(o,"-copy-style")))).options=S.mergeDeep({},t),n.mask=T("div","".concat(o,"-copy-style-mask")),n.html(Wa),n.children(n.mask),n.top=n.find(".".concat(o,"-copy-style-stroked-top")),n.left=n.find(".".concat(o,"-copy-style-stroked-left")),n.bottom=n.find(".".concat(o,"-copy-style-stroked-bottom")),n.right=n.find(".".concat(o,"-copy-style-stroked-right")),n.hide(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ra(t,e)}(e,t),e}(R);function Ha(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ma=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.screen=e,this.lt=null,this.t=null,this.l=null,this.br=null}var e,n,r;return e=t,(n=[{key:"getLT",value:function(){return this.lt}},{key:"getT",value:function(){return this.t}},{key:"getL",value:function(){return this.l}},{key:"getBR",value:function(){return this.br}},{key:"onAppendScreen",value:function(){}}])&&Ha(e.prototype,n),r&&Ha(e,r),t}();function Na(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Da(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ia=function(){function t(e,n,r,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sri=e,this.sci=n,this.eri=r,this.eci=o,this.w=i,this.h=c}var e,n,r;return e=t,r=[{key:"valueOf",value:function(e){var n=e.split(":"),r=Na(S.expr2xy(n[0]),2),o=r[0],i=r[1],c=i,l=o;if(n.length>1){var a=Na(S.expr2xy(n[1]),2);l=a[0],c=a[1]}return new t(i,o,c,l)}}],(n=[{key:"set",value:function(t,e,n,r){this.sri=t,this.sci=e,this.eri=n,this.eci=r}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];if(1===r.length){var i=S.expr2xy(r[0]),c=Na(i,2);e=c[0],t=c[1]}else 2===r.length&&(t=r[0],e=r[1]);var l=this.sri,a=this.sci,s=this.eri,u=this.eci;return l<=t&&t<=s&&a<=e&&e<=u}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=this.sri,r=this.sci,o=this.eri,i=this.eci,c=n;c<=o;c+=1)if(e(c))for(var l=r;l<=i;l+=1)t(c,l)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var n=this.sri,r=this.sci,o=this.eri,i=this.eci;return new t(e.sri<n?e.sri:n,e.sci<r?e.sci:r,e.eri>o?e.eri:o,e.eci>i?e.eci:i)}},{key:"coincide",value:function(e){var n=this.sri,r=this.sci,o=this.eri,i=this.eci;return this.disjoint(e)?t.EMPTY:new t(e.sri>n?e.sri:n,e.sci>r?e.sci:r,e.eri<o?e.eri:o,e.eci<i?e.eci:i)}},{key:"coincideDifference",value:function(e){return this.coincide(e).equals(t.EMPTY)?[]:this.difference(e)}},{key:"difference",value:function(e){var n=[],r=function(e,r,o,i){n.push(new t(e,r,o,i))},o=this.sri,i=this.sci,c=this.eri,l=this.eci,a=e.sri-o,s=e.sci-i,u=c-e.eri,f=l-e.eci;return a>0?(r(o,i,e.sri-1,l),u>0?(r(e.eri+1,i,c,l),s>0&&r(e.sri,i,e.eri,e.sci-1),f>0&&r(e.sri,e.eci+1,e.eri,l)):(s>0&&r(e.sri,i,c,e.sci-1),f>0&&r(e.sri,e.eci+1,c,l))):u>0&&(r(e.eri+1,i,c,l),s>0&&r(o,i,e.eri,e.sci-1),f>0&&r(o,e.eci+1,e.eri,l)),s>0?(r(o,i,c,e.sci-1),f>0?(r(o,e.eri+1,c,l),a>0&&r(o,e.sci,e.sri-1,e.eci),u>0&&r(e.sri+1,e.sci,c,e.eci)):(a>0&&r(o,e.sci,e.sri-1,l),u>0&&r(e.sri+1,e.sci,c,l))):f>0&&(r(o,e.eci+1,c,l),a>0&&r(o,i,e.sri-1,e.eci),u>0&&r(e.eri+1,i,c,e.eci)),n}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"brink",value:function(){var e=this.sri,n=this.eri,r=this.sci,o=this.eci,i=new t(e,r,e,o),c=new t(n,r,n,o);return{top:i,right:new t(e,o,n,o),bottom:c,left:new t(e,r,n,r)}}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"toString",value:function(){var t=this.sri,e=this.sci,n=this.eri,r=this.eci,o=S.xy2expr(e,t);return this.multiple()&&(o="".concat(o,":").concat(S.xy2expr(r,n))),o}}])&&Da(e.prototype,n),r&&Da(e,r),t}();function Ba(t){return(Ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ya(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Fa(t,e){return!e||"object"!==Ba(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function za(t){return(za=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ua(t,e){return(Ua=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Ia.EMPTY=new Ia(-1,-1,-1,-1);var Xa=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Fa(this,za(e).call(this,t))).options=S.mergeDeep({},r),n.lt=new Va,n.t=new Va,n.l=new Va,n.br=new Va,n.selectorAttr=null,n.bind(),n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ua(t,e)}(e,t),n=e,(o=[{key:"setLTOffset",value:function(t){var e=this.screen.table,n=e.frozenLeftTop,r=e.cols,o=e.rows,i=e.grid,c=n.getScrollViewRange(),l=t.rect,a=new Ia(-1,-1,-1,-1),s=l.coincide(c);if(a.equals(s))this.lt.hide();else{var u=r.sectionSumWidth(s.sci,s.eci),f=o.sectionSumHeight(s.sri,s.eri),h=o.sectionSumHeight(c.sri,s.sri-1),p=r.sectionSumWidth(c.sci,s.sci-1);l.eci>c.eci?(this.lt.right.hide(),this.lt.mask.css("border-right","none")):(this.lt.right.show(),this.lt.mask.cssRemoveKeys("border-right")),l.eri>c.eri?(this.lt.bottom.hide(),this.lt.mask.css("border-bottom","none")):(this.lt.bottom.show(),this.lt.mask.cssRemoveKeys("border-bottom"));var y=new Vc({x:p,y:h,width:u,height:f});y.expandSize(i.lineWidth()),this.lt.offset({width:y.width,height:y.height,left:y.x,top:y.y}).show()}}},{key:"setTOffset",value:function(t){var e=this.screen.table,n=e.fixedTop,r=e.cols,o=e.rows,i=e.grid,c=n.getScrollViewRange(),l=t.rect,a=new Ia(-1,-1,-1,-1),s=l.coincide(c);if(a.equals(s))this.t.hide();else{var u=r.sectionSumWidth(s.sci,s.eci),f=o.sectionSumHeight(s.sri,s.eri),h=o.sectionSumHeight(c.sri,s.sri-1),p=r.sectionSumWidth(c.sci,s.sci-1);l.sci<c.sci?(this.t.left.hide(),this.t.mask.css("border-left","none")):(this.t.left.show(),this.t.mask.cssRemoveKeys("border-left")),l.eri>c.eri?(this.t.bottom.hide(),this.t.mask.css("border-bottom","none")):(this.t.bottom.show(),this.t.mask.cssRemoveKeys("border-bottom")),l.eci>c.eci?(this.t.right.hide(),this.t.mask.css("border-right","none")):(this.t.right.show(),this.t.mask.cssRemoveKeys("border-right"));var y=new Vc({x:p,y:h,width:u,height:f});y.expandSize(i.lineWidth()),this.t.offset({width:y.width,height:y.height,left:y.x,top:y.y}).show()}}},{key:"setLOffset",value:function(t){var e=this.screen.table,n=e.fixedLeft,r=e.cols,o=e.rows,i=e.grid,c=n.getScrollViewRange(),l=t.rect,a=new Ia(-1,-1,-1,-1),s=l.coincide(c);if(a.equals(s))this.l.hide();else{var u=r.sectionSumWidth(s.sci,s.eci),f=o.sectionSumHeight(s.sri,s.eri),h=o.sectionSumHeight(c.sri,s.sri-1),p=r.sectionSumWidth(c.sci,s.sci-1);l.sri<c.sri?(this.l.top.hide(),this.l.mask.css("border-top","none")):(this.l.top.show(),this.l.mask.cssRemoveKeys("border-top")),l.eci>c.eci?(this.l.right.hide(),this.l.mask.css("border-right","none")):(this.l.right.show(),this.l.mask.cssRemoveKeys("border-right")),l.eri>c.eri?(this.l.bottom.hide(),this.l.mask.css("border-bottom","none")):(this.l.bottom.show(),this.l.mask.cssRemoveKeys("border-bottom"));var y=new Vc({x:p,y:h,width:u,height:f});y.expandSize(i.lineWidth()),this.l.offset({width:y.width,height:y.height,left:y.x,top:y.y}).show()}}},{key:"setBROffset",value:function(t){var e=this.screen.table,n=e.cols,r=e.rows,o=e.grid,i=e.getScrollViewRange(),c=t.rect,l=new Ia(-1,-1,-1,-1),a=c.coincide(i);if(l.equals(a))this.br.hide();else{var s=n.sectionSumWidth(a.sci,a.eci),u=r.sectionSumHeight(a.sri,a.eri),f=r.sectionSumHeight(i.sri,a.sri-1),h=n.sectionSumWidth(i.sci,a.sci-1);c.sci<i.sci?(this.br.left.hide(),this.br.mask.css("border-left","none")):(this.br.left.show(),this.br.mask.cssRemoveKeys("border-left")),c.sri<i.sri?(this.br.top.hide(),this.br.mask.css("border-top","none")):(this.br.top.show(),this.br.mask.cssRemoveKeys("border-top")),c.eri>i.eri?(this.br.bottom.hide(),this.br.mask.css("border-bottom","none")):(this.br.bottom.show(),this.br.mask.cssRemoveKeys("border-bottom")),c.eci>i.eci?(this.br.right.hide(),this.br.mask.css("border-right","none")):(this.br.right.show(),this.br.mask.cssRemoveKeys("border-right"));var p=new Vc({x:h,y:f,width:s,height:u});p.expandSize(o.lineWidth()),this.br.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setOffset",value:function(t){this.setLTOffset(t),this.setTOffset(t),this.setLOffset(t),this.setBROffset(t)}},{key:"bind",value:function(){var t=this,e=this.screen.table;Wt.bind(e,r.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.selectorAttr&&t.setOffset(t.selectorAttr)})),Wt.bind(e,r.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(e){t.selectorAttr&&t.setOffset(t.selectorAttr)})),Wt.bind(e,r.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(e){t.selectorAttr&&t.setOffset(t.selectorAttr)}))}},{key:"setShow",value:function(t){this.selectorAttr=t,this.setOffset(t)}},{key:"setHide",value:function(){this.selectorAttr=null,this.lt.hide(),this.t.hide(),this.l.hide(),this.br.hide()}}])&&Ya(n.prototype,o),i&&Ya(n,i),e}(Ma);function Ga(t){return(Ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ka(t,e){return!e||"object"!==Ga(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qa(t){return(qa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $a(t,e){return($a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Za=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ka(this,qa(e).call(this,"".concat(o,"-selector")))).cornerEl=T("div","".concat(o,"-selector-corner")),t.areaEl=T("div","".concat(o,"-selector-area")),t.areaEl.children(t.cornerEl),t.children(t.areaEl),t.hide(),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$a(t,e)}(e,t),e}(R);function Ja(t){return(Ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ts(t,e){return!e||"object"!==Ja(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function es(t){return(es=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ns(t,e){return(ns=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rs={DOWN_SELECT:Symbol("选择单元格时触发"),CHANGE:Symbol("选择区域大小发生变化时触发"),SELECT_CHANGE:Symbol("选择区域发生变化时触发"),SELECT_CHANGE_OVER:Symbol("选择区域结束时触发")},os=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ts(this,es(e).call(this,t))).options=r,n.selectorAttr=null,n.downSelectorAttr=null,n.onChangeStack=[],n.onSelectChangeStack=[],n.onSelectChangeOver=[],n.onDownSelectStack=[],n.lt=new Za,n.t=new Za,n.l=new Za,n.br=new Za,n.bind(),n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ns(t,e)}(e,t),n=e,(o=[{key:"bind",value:function(){var t=this,e=this.screen.table,n=e.mousePointer,o=e.focus;Wt.bind(e,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(i){if(0===i.button&&o.activate.el===e){var c,l=e.computeEventXy(i),a=l.x,s=l.y,u=t.getDownXYSelectorAttr(a,s);switch(t.setSelectAttr(u),t.setDownSelectAttr(u),t.setOffset(u),t.onDownSelectStack.forEach((function(t){return t()})),t.onChangeStack.forEach((function(t){return t()})),t.onSelectChangeStack.forEach((function(t){return t()})),u.edgeType){case"left":c=r.MOUSE_POINTER_TYPE.SELECT_ONE_ROW;break;case"top":c=r.MOUSE_POINTER_TYPE.SELECT_ONE_COLUMN;break;default:c=r.MOUSE_POINTER_TYPE.SELECT_CELL}n.on(c),Wt.mouseMoveUp(document,(function(n){var r=e.computeEventXy(n),o=r.x,i=r.y,c=t.getMoveXySelectorAttr(u,o,i);t.setSelectAttr(c),t.setOffset(c),t.onChangeStack.forEach((function(t){return t()})),t.onSelectChangeStack.forEach((function(t){return t()}))}),(function(){n.off(c),t.onSelectChangeOver.forEach((function(t){return t()}))}))}})),Wt.bind(e,r.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.selectorAttr&&t.setOffset(t.selectorAttr)})),Wt.bind(e,r.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.selectorAttr&&(t.setOffset(t.selectorAttr),t.onChangeStack.forEach((function(t){return t()})))})),Wt.bind(e,r.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.selectorAttr&&(t.setOffset(t.selectorAttr),t.onChangeStack.forEach((function(t){return t()})))}))}},{key:"setLTOffset",value:function(t){var e=this.screen.table,n=e.frozenLeftTop,r=e.cols,o=e.rows,i=e.grid,c=n.getScrollViewRange(),l=t.rect,a=new Ia(-1,-1,-1,-1),s=l.coincide(c);if(a.equals(s))this.lt.hide();else{var u=r.sectionSumWidth(s.sci,s.eci),f=o.sectionSumHeight(s.sri,s.eri),h=o.sectionSumHeight(c.sri,s.sri-1),p=r.sectionSumWidth(c.sci,s.sci-1);l.eci>c.eci?this.lt.areaEl.css("border-right","none"):this.lt.areaEl.cssRemoveKeys("border-right"),l.eri>c.eri?this.lt.areaEl.css("border-bottom","none"):this.lt.areaEl.cssRemoveKeys("border-bottom");var y=new Vc({x:p,y:h,width:u,height:f});y.expandSize(i.lineWidth()),this.lt.offset({width:y.width,height:y.height,left:y.x,top:y.y}).show()}}},{key:"setTOffset",value:function(t){var e=this.screen.table,n=e.fixedTop,r=e.cols,o=e.rows,i=e.grid,c=n.getScrollViewRange(),l=t.rect,a=new Ia(-1,-1,-1,-1),s=l.coincide(c);if(a.equals(s))this.t.hide();else{var u=r.sectionSumWidth(s.sci,s.eci),f=o.sectionSumHeight(s.sri,s.eri),h=o.sectionSumHeight(c.sri,s.sri-1),p=r.sectionSumWidth(c.sci,s.sci-1);l.sci<c.sci?this.t.areaEl.css("border-left","none"):this.t.areaEl.cssRemoveKeys("border-left"),l.eri>c.eri?this.t.areaEl.css("border-bottom","none"):this.t.areaEl.cssRemoveKeys("border-bottom"),l.eci>c.eci?this.t.areaEl.css("border-right","none"):this.t.areaEl.cssRemoveKeys("border-right");var y=new Vc({x:p,y:h,width:u,height:f});y.expandSize(i.lineWidth()),this.t.offset({width:y.width,height:y.height,left:y.x,top:y.y}).show()}}},{key:"setLOffset",value:function(t){var e=this.screen.table,n=e.fixedLeft,r=e.cols,o=e.rows,i=e.grid,c=n.getScrollViewRange(),l=t.rect,a=new Ia(-1,-1,-1,-1),s=l.coincide(c);if(a.equals(s))this.l.hide();else{var u=r.sectionSumWidth(s.sci,s.eci),f=o.sectionSumHeight(s.sri,s.eri),h=o.sectionSumHeight(c.sri,s.sri-1),p=r.sectionSumWidth(c.sci,s.sci-1);l.sri<c.sri?this.l.areaEl.css("border-top","none"):this.l.areaEl.cssRemoveKeys("border-top"),l.eci>c.eci?this.l.areaEl.css("border-right","none"):this.l.areaEl.cssRemoveKeys("border-right"),l.eri>c.eri?this.l.areaEl.css("border-bottom","none"):this.l.areaEl.cssRemoveKeys("border-bottom");var y=new Vc({x:p,y:h,width:u,height:f});y.expandSize(i.lineWidth()),this.l.offset({width:y.width,height:y.height,left:y.x,top:y.y}).show()}}},{key:"setBROffset",value:function(t){var e=this.screen.table,n=e.cols,r=e.rows,o=e.grid,i=e.getScrollViewRange(),c=t.rect,l=new Ia(-1,-1,-1,-1),a=c.coincide(i);if(l.equals(a))this.br.hide();else{var s=n.sectionSumWidth(a.sci,a.eci),u=r.sectionSumHeight(a.sri,a.eri),f=r.sectionSumHeight(i.sri,a.sri-1),h=n.sectionSumWidth(i.sci,a.sci-1);c.sci<i.sci?this.br.areaEl.css("border-left","none"):this.br.areaEl.cssRemoveKeys("border-left"),c.sri<i.sri?this.br.areaEl.css("border-top","none"):this.br.areaEl.cssRemoveKeys("border-top"),c.eri>i.eri?this.br.areaEl.css("border-bottom","none"):this.br.areaEl.cssRemoveKeys("border-bottom"),c.eci>i.eci?this.br.areaEl.css("border-right","none"):this.br.areaEl.cssRemoveKeys("border-right");var p=new Vc({x:h,y:f,width:s,height:u});p.expandSize(o.lineWidth()),this.br.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setLTCorner",value:function(t,e){var n=this.screen.table.frozenLeftTop.getScrollViewRange(),r=t.rect,o=t.edge,i=t.edgeType,c=new Ia(-1,-1,-1,-1),l=r.coincide(n);if(!c.equals(l))if(this.lt.cornerEl.cssRemoveKeys("left"),this.lt.cornerEl.cssRemoveKeys("top"),this.lt.cornerEl.cssRemoveKeys("right"),this.lt.cornerEl.cssRemoveKeys("bottom"),this.lt.cornerEl.hide(),o){var a="ltl"===e;"left"===i&&"ltt"===e&&(this.lt.cornerEl.show(),this.lt.cornerEl.css("left","0px"),this.lt.cornerEl.css("bottom","0px")),"top"===i&&a&&(this.lt.cornerEl.show(),this.lt.cornerEl.css("right","0px"),this.lt.cornerEl.css("top","0px"))}else"lt"===e&&(this.lt.cornerEl.show(),this.lt.cornerEl.css("right","0px"),this.lt.cornerEl.css("bottom","0px")),r.eci>n.eci&&this.lt.cornerEl.hide(),r.eri>n.eri&&this.lt.cornerEl.hide()}},{key:"setTCorner",value:function(t,e){var n=this.screen.table.fixedTop.getScrollViewRange(),r=t.rect,o=t.edge,i=t.edgeType,c=new Ia(-1,-1,-1,-1),l=r.coincide(n);if(!c.equals(l))if(this.t.cornerEl.cssRemoveKeys("left"),this.t.cornerEl.cssRemoveKeys("top"),this.t.cornerEl.cssRemoveKeys("right"),this.t.cornerEl.cssRemoveKeys("bottom"),this.t.cornerEl.hide(),o){var a="lttlbr"===e;"top"===i&&"tbr"===e&&(this.t.cornerEl.show(),this.t.cornerEl.css("right","0px"),this.t.cornerEl.css("top","0px")),"top"===i&&a&&(this.t.cornerEl.show(),this.t.cornerEl.css("right","0px"),this.t.cornerEl.css("top","0px")),"top"===i&&r.eci>n.eci&&this.t.cornerEl.hide()}else("t"===e||"ltt"===e)&&(this.t.cornerEl.show(),this.t.cornerEl.css("right","0px"),this.t.cornerEl.css("bottom","0px")),r.eci>n.eci&&this.t.cornerEl.hide(),r.eri>n.eri&&this.t.cornerEl.hide()}},{key:"setLCorner",value:function(t,e){var n=this.screen.table.fixedLeft.getScrollViewRange(),r=t.rect,o=t.edge,i=t.edgeType,c=new Ia(-1,-1,-1,-1),l=r.coincide(n);if(!c.equals(l))if(this.l.cornerEl.cssRemoveKeys("left"),this.l.cornerEl.cssRemoveKeys("top"),this.l.cornerEl.cssRemoveKeys("right"),this.l.cornerEl.cssRemoveKeys("bottom"),this.l.cornerEl.hide(),o){var a="lttlbr"===e;"left"===i&&"lbr"===e&&(this.l.cornerEl.show(),this.l.cornerEl.css("left","0"),this.l.cornerEl.css("bottom","0")),"left"===i&&a&&(this.l.cornerEl.show(),this.l.cornerEl.css("left","0"),this.l.cornerEl.css("bottom","0")),"left"===i&&r.eri>n.eri&&this.l.cornerEl.hide()}else("l"===e||"ltl"===e)&&(this.l.cornerEl.show(),this.l.cornerEl.css("right","0px"),this.l.cornerEl.css("bottom","0px")),r.eci>n.eci&&this.l.cornerEl.hide(),r.eri>n.eri&&this.l.cornerEl.hide()}},{key:"setBrCorner",value:function(t,e){var n=this.screen.table.getScrollViewRange(),r=t.rect,o=t.edge,i=t.edgeType,c=new Ia(-1,-1,-1,-1),l=r.coincide(n);if(!c.equals(l))if(this.br.cornerEl.cssRemoveKeys("left"),this.br.cornerEl.cssRemoveKeys("top"),this.br.cornerEl.cssRemoveKeys("right"),this.br.cornerEl.cssRemoveKeys("bottom"),this.br.cornerEl.hide(),o){var a="br"===e,s="lttlbr"===e;"left"===i&&a&&(this.br.cornerEl.show(),this.br.cornerEl.css("left","0"),this.br.cornerEl.css("bottom","0")),"top"===i&&a&&(this.br.cornerEl.show(),this.br.cornerEl.css("right","0"),this.br.cornerEl.css("top","0")),"left-top"===i&&s&&(this.br.cornerEl.show(),this.br.cornerEl.css("right","0"),this.br.cornerEl.css("bottom","0")),"left-top"===i&&a&&(this.br.cornerEl.show(),this.br.cornerEl.css("right","0"),this.br.cornerEl.css("bottom","0")),"left"===i&&r.eri>n.eri&&this.br.cornerEl.hide(),"top"===i&&r.eci>n.eci&&this.br.cornerEl.hide()}else{var u="lbr"===e;("br"===e||"tbr"===e||u||u||"lttlbr"===e)&&(this.br.cornerEl.show(),this.br.cornerEl.css("right","0px"),this.br.cornerEl.css("bottom","0px")),r.eri>n.eri&&this.br.cornerEl.hide(),r.eci>n.eci&&this.br.cornerEl.hide()}}},{key:"setSelectAttr",value:function(t){this.selectorAttr=t,this.selectorAttr.id=Date.now()}},{key:"setDownSelectAttr",value:function(t){this.downSelectorAttr=t}},{key:"getIntersectsArea",value:function(t){var e=this.screen.table,n=e.fixed,r=e.cols,o=e.rows,i=t.rect,c="",l=new Ia(0,0,n.fxTop,n.fxLeft),a=new Ia(0,n.fxLeft+1,n.fxTop,r.len),s=new Ia(n.fxTop+1,0,o.len,n.fxLeft),u=new Ia(n.fxTop+1,n.fxLeft+1,o.len,r.len);return i.intersects(l)&&(c+="lt"),i.intersects(a)&&(c+="t"),i.intersects(s)&&(c+="l"),i.intersects(u)&&(c+="br"),c}},{key:"setOffset",value:function(t){var e=this.getIntersectsArea(t);this.setLTOffset(t),this.setTOffset(t),this.setLOffset(t),this.setBROffset(t),this.setLTCorner(t,e),this.setTCorner(t,e),this.setLCorner(t,e),this.setBrCorner(t,e)}},{key:"getViewRange",value:function(){var t=this.screen.table,e=t.cols,n=t.rows,r=t.getScrollViewRange(),o=r.sri,i=r.sci,c=r.eri,l=r.eci;t.getFixedWidth()>0&&(o=0),t.getFixedHeight()>0&&(i=0);var a=e.sectionSumWidth(i,l),s=n.sectionSumHeight(o,c);return new Ia(o,i,c,l,a,s)}},{key:"getDownXYSelectorAttr",value:function(t,e){var n=this.screen.table,r=n.merges,o=n.rows,i=n.cols,c=n.getRiCiByXy(t,e),l=c.ri,a=c.ci;if(-1===l&&-1===a)return{rect:new Ia(0,0,o.len-1,i.len-1),edge:!0,edgeType:"left-top"};if(-1===l)return{rect:new Ia(0,a,o.len-1,a),edge:!0,edgeType:"top"};if(-1===a)return{rect:new Ia(l,0,l,i.len-1),edge:!0,edgeType:"left"};var s=r.getFirstIncludes(l,a),u=new Ia(l,a,l,a);return s&&(u=s),{rect:u}}},{key:"getMoveXySelectorAttr",value:function(t,e,n){var r=this.screen.table,o=r.merges,i=r.rows,c=r.cols,l=t.rect,a=t.edgeType,s=this.getViewRange(),u=r.getRiCiByXy(e,n),f=u.ri,h=u.ci;switch(-1===f&&(f=s.sri),-1===h&&(h=s.sci),a){case"left-top":var p=l.union(new Ia(0,0,i.len-1,c.len-1));return{rect:p=l.union(p),edge:!0,edgeType:"left-top"};case"top":var y=l.union(new Ia(0,h,0,h));return{rect:y=l.union(y),edge:!0,edgeType:"top"};case"left":var b=l.union(new Ia(f,0,f,0));return{rect:b=l.union(b),edge:!0,edgeType:"left"}}var d=l.union(new Ia(f,h,f,h));return{rect:d=o.union(d)}}},{key:"getSelectRange",value:function(){return this.selectorAttr.rect}},{key:"on",value:function(t,e){var n;switch(t){case rs.CHANGE:n=this.onChangeStack;break;case rs.SELECT_CHANGE_OVER:n=this.onSelectChangeOver;break;case rs.DOWN_SELECT:n=this.onDownSelectStack;break;case rs.SELECT_CHANGE:n=this.onSelectChangeStack}n&&n.push(e)}},{key:"remove",value:function(t,e){var n;switch(t){case rs.CHANGE:n=this.onChangeStack;break;case rs.SELECT_CHANGE_OVER:n=this.onSelectChangeOver;break;case rs.DOWN_SELECT:n=this.onDownSelectStack;break;case rs.SELECT_CHANGE:n=this.onSelectChangeStack}if(n)for(var r=0;r<n.length;r+=1)if(n[r]===e)return void n.splice(r,1)}}])&&Qa(n.prototype,o),i&&Qa(n,i),e}(Ma);function is(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var cs=function(){function t(e){var n=e.align,r=void 0===n?Uc.left:n,o=e.verticalAlign,i=void 0===o?Xc.center:o,c=e.textWrap,l=void 0===c?Gc.OVER_FLOW:c,a=e.strikethrough,s=void 0!==a&&a,u=e.underline,f=void 0!==u&&u,h=e.color,p=void 0===h?"rgb(0,0,0)":h,y=e.name,b=void 0===y?"Arial":y,d=e.size,g=void 0===d?14:d,v=e.bold,w=void 0!==v&&v,m=e.italic,O=void 0!==m&&m,E=e.angle,S=void 0===E?0:E,x=e.direction,_=void 0===x?Kc.HORIZONTAL:x;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.align=r,this.verticalAlign=i,this.textWrap=l,this.strikethrough=s,this.underline=f,this.color=p,this.name=b,this.size=g,this.bold=w,this.italic=O,this.direction=_,this.angle=S}var e,n,r;return e=t,(n=[{key:"clone",value:function(){return new t({align:this.align,verticalAlign:this.verticalAlign,textWrap:this.textWrap,strikethrough:this.strikethrough,underline:this.underline,color:this.color,name:this.name,size:this.size,bold:this.bold,italic:this.italic,angle:this.angle,direction:this.direction})}}])&&is(e.prototype,n),r&&is(e,r),t}();function ls(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var as=function(){function t(e){var n=e.time,r=void 0===n?S.now():n,o=e.display,i=void 0!==o&&o,c=e.width,l=void 0===c?1:c,a=e.color,s=void 0===a?"#000000":a,u=e.type,f=void 0===u?Ii.SOLID_LINE:u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$time=r,this.$display=i,this.$width=l,this.$color=s,this.$type=f}var e,n,r;return e=t,(n=[{key:"equal",value:function(t){var e=this.color===t.color,n=this.width===t.width,r=this.type===t.type;return e&&n&&r}},{key:"compareTime",value:function(t){if(S.isUnDef(t))return-2;var e=this.time,n=t.time;return e>n?1:n>e?-1:0}},{key:"time",get:function(){return this.$time}},{key:"display",get:function(){return this.$display},set:function(t){this.$time=S.now(),this.$display=t}},{key:"width",get:function(){return this.$width},set:function(t){this.$time=S.now(),this.$width=t}},{key:"color",get:function(){return this.$color},set:function(t){this.$time=S.now(),this.$color=t}},{key:"type",get:function(){return this.$type},set:function(t){this.$time=S.now(),this.$type=t}}])&&ls(e.prototype,n),r&&ls(e,r),t}();function ss(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var us=function(){function t(e){var n=e.left,r=void 0===n?{}:n,o=e.top,i=void 0===o?{}:o,c=e.right,l=void 0===c?{}:c,a=e.bottom,s=void 0===a?{}:a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.left=new as(r),this.top=new as(i),this.right=new as(l),this.bottom=new as(s)}var e,n,r;return e=t,(n=[{key:"clone",value:function(){return new t({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}}])&&ss(e.prototype,n),r&&ss(e,r),t}();function fs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var hs=function(){function t(e){var n=e.text,r=void 0===n?S.EMPTY:n,o=e.background,i=void 0===o?S.Nul:o,c=e.format,l=void 0===c?"default":c,a=e.fontAttr,s=void 0===a?{}:a,u=e.borderAttr,f=void 0===u?{}:u,h=e.contentWidth,p=void 0===h?0:h;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.background=i,this.format=l,this.text=r,this.fontAttr=new cs(s),this.borderAttr=new us(f),this.contentWidth=p}var e,n,r;return e=t,(n=[{key:"setContentWidth",value:function(t){this.contentWidth=t}},{key:"clone",value:function(){var e=this.background,n=this.format,r=this.text,o=this.fontAttr,i=this.borderAttr;return new t({background:e,format:n,text:r,fontAttr:o.clone(),borderAttr:i.clone()})}}])&&fs(e.prototype,n),r&&fs(e,r),t}();function ps(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ys(t){return(ys="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ds(t,e){return!e||"object"!==ys(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gs(t){return(gs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vs(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ws(t,e)}function ws(t,e){return(ws=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ms=function(t){function e(){return bs(this,e),ds(this,gs(e).call(this,"".concat(o,"-tools-divider")))}return vs(e,t),e}(R),Os=function(t){function e(t){var n;bs(this,e),(n=ds(this,gs(e).call(this,"".concat(o,"-tools-menu")))).workTop=t;var r=n.workTop.work.body.sheetView;return n.undo=new ut,n.redo=new bt,n.paintFormat=new Ot,n.clearFormat=new kt,n.format=new Ue({contextMenu:{onUpdate:function(t,e){var o=r.getActiveSheet().table,i=o.screen,c=o.cellsHelper,l=o.tableDataSnapshot,a=i.findByClass(os).selectorAttr;if(n.format.setTitle(e),a){l.begin();var s=l.cellDataProxy;c.getCellOrNewCellByViewRange({rectRange:a.rect,callback:function(e,n,r){var o=r.clone();o.format=t,s.setCell(e,n,o)}}),l.end(),o.render()}}}}),n.font=new un({contextMenu:{onUpdate:function(t){var e=r.getActiveSheet().table,o=e.screen,i=e.cellsHelper,c=e.tableDataSnapshot,l=o.findByClass(os).selectorAttr;if(n.font.setTitle(t),l){c.begin();var a=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(e,n,r){var o=r.clone();o.fontAttr.name=t,a.setCell(e,n,o)}}),c.end(),e.render()}}}}),n.fontSize=new kn({contextMenu:{onUpdate:function(t){var e=r.getActiveSheet().table,o=e.screen,i=e.cellsHelper,c=e.tableDataSnapshot,l=o.findByClass(os).selectorAttr;if(n.fontSize.setTitle(t),l){c.begin();var a=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(e,n,r){var o=r.clone();o.fontAttr.size=t,a.setCell(e,n,o)}}),c.end(),e.render()}}}}),n.fontColor=new Hr({contextMenu:{onUpdate:function(t){var e=r.getActiveSheet().table,o=e.screen,i=e.cellsHelper,c=e.tableDataSnapshot,l=o.findByClass(os).selectorAttr;if(n.fontColor.setColor(t),l){c.begin();var a=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(e,n,r){var o=r.clone();o.fontAttr.color=t,a.setCell(e,n,o)}}),c.end(),e.render()}}}}),n.fillColor=new Qr({contextMenu:{onUpdate:function(t){var e=r.getActiveSheet().table,o=e.screen,i=e.cellsHelper,c=e.tableDataSnapshot,l=o.findByClass(os).selectorAttr;if(n.fillColor.setColor(t),l){c.begin();var a=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(e,n,r){var o=r.clone();o.background=t,a.setCell(e,n,o)}}),c.end(),e.render()}}}}),n.border=new tc({contextMenu:{onUpdate:function(t,e,n){var o=r.getActiveSheet().table,i=o.screen,c=o.cellsHelper,l=o.cells,a=o.tableDataSnapshot,s=i.findByClass(os).selectorAttr;if(s){a.begin();var u=a.cellDataProxy,f=1,h=Ii.SOLID_LINE;switch(n){case"line1":f=1,h=Ii.SOLID_LINE;break;case"line2":f=2,h=Ii.SOLID_LINE;break;case"line3":f=3,h=Ii.SOLID_LINE;break;case"line4":h=Ii.DOTTED_LINE;break;case"line5":h=Ii.POINT_LINE;break;case"line6":h=Ii.DOUBLE_LINE}switch(t){case"border1":c.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,n,r){var o=r.clone();o.borderAttr.left.display=!0,o.borderAttr.top.display=!0,o.borderAttr.right.display=!0,o.borderAttr.bottom.display=!0,o.borderAttr.left.color=e,o.borderAttr.top.color=e,o.borderAttr.right.color=e,o.borderAttr.bottom.color=e,o.borderAttr.left.width=f,o.borderAttr.top.width=f,o.borderAttr.right.width=f,o.borderAttr.bottom.width=f,o.borderAttr.left.type=h,o.borderAttr.top.type=h,o.borderAttr.right.type=h,o.borderAttr.bottom.type=h,u.setCell(t,n,o)}});break;case"border2":c.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,n,r){var o=r.clone();s.rect.sri===t?o.borderAttr.bottom.display=!0:s.rect.eri===t?o.borderAttr.top.display=!0:(o.borderAttr.bottom.display=!0,o.borderAttr.top.display=!0),s.rect.sci===n?o.borderAttr.right.display=!0:s.rect.eci===n?o.borderAttr.left.display=!0:(o.borderAttr.right.display=!0,o.borderAttr.left.display=!0),s.rect.sri===t?o.borderAttr.bottom.color=e:s.rect.eri===t?o.borderAttr.top.color=e:(o.borderAttr.bottom.color=e,o.borderAttr.top.color=e),s.rect.sci===n?o.borderAttr.right.color=e:s.rect.eci===n?o.borderAttr.left.color=e:(o.borderAttr.right.color=e,o.borderAttr.left.color=e),s.rect.sri===t?o.borderAttr.bottom.width=f:s.rect.eri===t?o.borderAttr.top.width=f:(o.borderAttr.bottom.width=f,o.borderAttr.top.width=f),s.rect.sci===n?o.borderAttr.right.width=f:s.rect.eci===n?o.borderAttr.left.width=f:(o.borderAttr.right.width=f,o.borderAttr.left.width=f),s.rect.sri===t?o.borderAttr.bottom.type=h:s.rect.eri===t?o.borderAttr.top.type=h:(o.borderAttr.bottom.type=h,o.borderAttr.top.type=h),s.rect.sci===n?o.borderAttr.right.type=h:s.rect.eci===n?o.borderAttr.left.type=h:(o.borderAttr.right.type=h,o.borderAttr.left.type=h),u.setCell(t,n,o)}});break;case"border3":c.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,n,r){var o=r.clone();s.rect.sri===t?o.borderAttr.bottom.display=!0:s.rect.eri===t?o.borderAttr.top.display=!0:(o.borderAttr.bottom.display=!0,o.borderAttr.top.display=!0),s.rect.sri===t?o.borderAttr.bottom.color=e:s.rect.eri===t?o.borderAttr.top.color=e:(o.borderAttr.bottom.color=e,o.borderAttr.top.color=e),s.rect.sri===t?o.borderAttr.bottom.width=f:s.rect.eri===t?o.borderAttr.top.width=f:(o.borderAttr.bottom.width=f,o.borderAttr.top.width=f),s.rect.sri===t?o.borderAttr.bottom.type=h:s.rect.eri===t?o.borderAttr.top.type=h:(o.borderAttr.bottom.type=h,o.borderAttr.top.type=h),u.setCell(t,n,o)}});break;case"border4":c.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,n,r){var o=r.clone();s.rect.sci===n?o.borderAttr.right.display=!0:s.rect.eci===n?o.borderAttr.left.display=!0:(o.borderAttr.right.display=!0,o.borderAttr.left.display=!0),s.rect.sci===n?o.borderAttr.right.color=e:s.rect.eci===n?o.borderAttr.left.color=e:(o.borderAttr.right.color=e,o.borderAttr.left.color=e),s.rect.sci===n?o.borderAttr.right.width=f:s.rect.eci===n?o.borderAttr.left.width=f:(o.borderAttr.right.width=f,o.borderAttr.left.width=f),s.rect.sci===n?o.borderAttr.right.type=h:s.rect.eci===n?o.borderAttr.left.type=h:(o.borderAttr.right.type=h,o.borderAttr.left.type=h),u.setCell(t,n,o)}});break;case"border5":c.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,n,r){var o=r.clone();s.rect.sci===n?o.borderAttr.left.display=!0:s.rect.eci===n&&(o.borderAttr.right.display=!0),s.rect.sri===t?o.borderAttr.top.display=!0:s.rect.eri===t&&(o.borderAttr.bottom.display=!0),s.rect.sci===n?o.borderAttr.left.color=e:s.rect.eci===n&&(o.borderAttr.right.color=e),s.rect.sri===t?o.borderAttr.top.color=e:s.rect.eri===t&&(o.borderAttr.bottom.color=e),s.rect.sci===n?o.borderAttr.left.width=f:s.rect.eci===n&&(o.borderAttr.right.width=f),s.rect.sri===t?o.borderAttr.top.width=f:s.rect.eri===t&&(o.borderAttr.bottom.width=f),s.rect.sci===n?o.borderAttr.left.type=h:s.rect.eci===n&&(o.borderAttr.right.type=h),s.rect.sri===t?o.borderAttr.top.type=h:s.rect.eri===t&&(o.borderAttr.bottom.type=h),u.setCell(t,n,o)}});break;case"border6":c.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,n,r){var o=r.clone();n===s.rect.sci&&(o.borderAttr.left.display=!0),o.borderAttr.left.color=e,o.borderAttr.left.width=f,o.borderAttr.left.type=h,u.setCell(t,n,o)}});break;case"border7":c.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,n,r){var o=r.clone();t===s.rect.sri&&(o.borderAttr.top.display=!0),o.borderAttr.top.color=e,o.borderAttr.top.width=f,o.borderAttr.top.type=h,u.setCell(t,n,o)}});break;case"border8":c.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,n,r){var o=r.clone();n===s.rect.eci&&(o.borderAttr.right.display=!0),o.borderAttr.right.color=e,o.borderAttr.right.width=f,o.borderAttr.right.type=h,u.setCell(t,n,o)}});break;case"border9":c.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,n,r){var o=r.clone();t===s.rect.eri&&(o.borderAttr.bottom.display=!0),o.borderAttr.bottom.color=e,o.borderAttr.bottom.width=f,o.borderAttr.bottom.type=h,u.setCell(t,n,o)}});break;case"border10":c.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(t,e,n){var r=n.clone();s.rect.sri===t&&(l.getCellOrNew(t-1,e).borderAttr.bottom.display=!1);s.rect.eri===t&&(l.getCellOrNew(t+1,e).borderAttr.top.display=!1);s.rect.sci===e&&(l.getCellOrNew(t,e-1).borderAttr.right.display=!1);s.rect.eci===e&&(l.getCellOrNew(t,e+1).borderAttr.left.display=!1);r.borderAttr.left.display=!1,r.borderAttr.top.display=!1,r.borderAttr.right.display=!1,r.borderAttr.bottom.display=!1,r.borderAttr.left.color=!1,r.borderAttr.top.color=!1,r.borderAttr.right.color=!1,r.borderAttr.bottom.color=!1,r.borderAttr.left.width=!1,r.borderAttr.top.width=!1,r.borderAttr.right.width=!1,r.borderAttr.bottom.width=!1,r.borderAttr.left.type=!1,r.borderAttr.top.type=!1,r.borderAttr.right.type=!1,r.borderAttr.bottom.type=!1,u.setCell(t,e,r)}})}a.end(),o.render()}}}}),n.fontBold=new jn,n.fontItalic=new Hn,n.underLine=new Bn,n.fontStrike=new Xn,n.merge=new ic,n.horizontalAlign=new al({contextMenu:{onUpdate:function(t){var e=r.getActiveSheet().table,o=e.screen,i=e.cellsHelper,c=e.tableDataSnapshot,l=o.findByClass(os).selectorAttr;switch(t){case Uc.left:n.horizontalAlign.setIcon(new tt("align-left"));break;case Uc.center:n.horizontalAlign.setIcon(new tt("align-center"));break;case Uc.right:n.horizontalAlign.setIcon(new tt("align-right"))}if(l){c.begin();var a=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(e,n,r){var o=r.clone();o.fontAttr.align=t,a.setCell(e,n,o)}}),c.end(),e.render()}}}}),n.verticalAlign=new Nl({contextMenu:{onUpdate:function(t){var e=r.getActiveSheet().table,o=e.screen,i=e.cellsHelper,c=e.tableDataSnapshot,l=o.findByClass(os).selectorAttr;switch(t){case Xc.top:n.verticalAlign.setIcon(new tt("align-top"));break;case Xc.center:n.verticalAlign.setIcon(new tt("align-middle"));break;case Xc.bottom:n.verticalAlign.setIcon(new tt("align-bottom"))}if(l){c.begin();var a=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(e,n,r){var o=r.clone();o.fontAttr.verticalAlign=t,a.setCell(e,n,o)}}),c.end(),e.render()}}}}),n.textWrapping=new ya({contextMenu:{onUpdate:function(t){var e,o=r.getActiveSheet().table,i=o.screen,c=o.cellsHelper,l=o.tableDataSnapshot,a=i.findByClass(os).selectorAttr;switch(t){case Gc.TRUNCATE:e=new tt("truncate");break;case Gc.WORD_WRAP:e=new tt("text-wrap");break;case Gc.OVER_FLOW:default:e=new tt("overflow")}if(n.textWrapping.setIcon(e),a){l.begin();var s=l.cellDataProxy;c.getCellOrNewCellByViewRange({rectRange:a.rect,callback:function(e,n,r){var o=r.clone();o.fontAttr.textWrap=t,s.setCell(e,n,o)}}),l.end(),o.render()}}}}),n.fixed=new wa,n.filter=new xa,n.functions=new Pa,n.children(n.undo),n.children(n.redo),n.children(n.paintFormat),n.children(n.clearFormat),n.children(new ms),n.children(n.format),n.children(new ms),n.children(n.font),n.children(n.fontSize),n.children(new ms),n.children(n.fontBold),n.children(n.fontItalic),n.children(n.underLine),n.children(n.fontStrike),n.children(n.fontColor),n.children(new ms),n.children(n.fillColor),n.children(n.border),n.children(n.merge),n.children(n.horizontalAlign),n.children(n.verticalAlign),n.children(n.textWrapping),n.children(n.fixed),n.children(n.filter),n.children(n.functions),n}var n,i,c;return vs(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"bind",value:function(){var t=this,e=this.workTop.work.body,n=e.sheetView;Wt.bind(e,r.WORK_BODY_EVENT_TYPE.CHANGE_ACTIVE,(function(){t.setStatus()})),Wt.bind(e,r.TABLE_EVENT_TYPE.DATA_CHANGE,(function(){t.setStatus()})),Wt.bind(e,r.TABLE_EVENT_TYPE.SELECT_DOWN,(function(){t.setFormatStatus(),t.setFontStatus(),t.setFontSizeStatus(),t.setFontBoldStatus(),t.setFontItalicStatus(),t.setUnderLineStatus(),t.setFontStrikeStatus(),t.setFontColorStatus(),t.setFillColorStatus(),t.setHorizontalAlignStatus(),t.setVerticalAlignStatus(),t.setTextWrappingStatus()})),Wt.bind(this.undo,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table.tableDataSnapshot;t.canBack()&&t.back()})),Wt.bind(this.redo,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table.tableDataSnapshot;t.canGo()&&t.go()})),Wt.bind(this.paintFormat,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var e=n.getActiveSheet(),r=e.table,o=r.screen,i=r.cells,c=r.tableDataSnapshot,l=o.findByClass(Xa),a=o.findByClass(os),s=a.selectorAttr;s&&(l.setShow(s),t.paintFormat.active(!0),t.paintFormat.addSheet(e),a.on(rs.SELECT_CHANGE_OVER,(function n(){l.setHide(),t.paintFormat.active(!1),t.paintFormat.removeSheet(e),a.remove(rs.SELECT_CHANGE_OVER,n);var o=s.rect,u=a.selectorAttr.rect;c.begin();for(var f=c.cellDataProxy,h=o.sri,p=u.sri;h<=o.eri;h+=1,p+=1)for(var y=o.sci,b=u.sci;y<=o.eci;y+=1,b+=1){var d=i.getCellOrNew(h,y),g=i.getCellOrNew(p,b).text,v=d.clone();v.text=g,f.setCell(p,b,v)}c.end(),r.render()})))})),Wt.bind(this.clearFormat,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.screen,r=t.cellsHelper,o=t.tableDataSnapshot,i=e.findByClass(os).selectorAttr;if(i){o.begin();var c=o.cellDataProxy;r.getCellOrNewCellByViewRange({rectRange:i.rect,callback:function(t,e,n){var r=n.text;c.setCell(t,e,new hs({text:r}))}}),o.end(),t.render()}})),Wt.bind(this.format,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.format.formatContextMenu,r=n.elPopUp;fe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Wt.bind(this.font,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.font.fontContextMenu,r=n.elPopUp;fe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Wt.bind(this.fontSize,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.fontSize.fontSizeContextMenu,r=n.elPopUp;fe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Wt.bind(this.fontBold,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.screen,r=t.cells,o=t.cellsHelper,i=t.tableDataSnapshot,c=e.findByClass(os).selectorAttr;if(c){var l=!r.getCellOrNew(c.rect.sri,c.rect.sci).fontAttr.bold;i.begin();var a=i.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:c.rect,callback:function(t,e,n){var r=n.clone();r.fontAttr.bold=l,a.setCell(t,e,r)}}),i.end(),t.render()}})),Wt.bind(this.fontItalic,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.screen,r=t.cells,o=t.cellsHelper,i=t.tableDataSnapshot,c=e.findByClass(os).selectorAttr;if(c){var l=!r.getCellOrNew(c.rect.sri,c.rect.sci).fontAttr.italic;i.begin();var a=i.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:c.rect,callback:function(t,e,n){var r=n.clone();r.fontAttr.italic=l,a.setCell(t,e,r)}}),i.end(),t.render()}})),Wt.bind(this.underLine,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.screen,r=t.cells,o=t.cellsHelper,i=t.tableDataSnapshot,c=e.findByClass(os).selectorAttr;if(c){var l=!r.getCellOrNew(c.rect.sri,c.rect.sci).fontAttr.underline;i.begin();var a=i.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:c.rect,callback:function(t,e,n){var r=n.clone();r.fontAttr.underline=l,a.setCell(t,e,r)}}),i.end(),t.render()}})),Wt.bind(this.fontStrike,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.screen,r=t.cells,o=t.cellsHelper,i=t.tableDataSnapshot,c=e.findByClass(os).selectorAttr;if(c){var l=!r.getCellOrNew(c.rect.sri,c.rect.sci).fontAttr.strikethrough;i.begin();var a=i.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:c.rect,callback:function(t,e,n){var r=n.clone();r.fontAttr.strikethrough=l,a.setCell(t,e,r)}}),i.end(),t.render()}})),Wt.bind(this.fontColor,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.fontColor.fontColorContextMenu,r=n.elPopUp;fe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Wt.bind(this.fillColor,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.fillColor.fillColorContextMenu,r=n.elPopUp;fe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Wt.bind(this.border,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.border.borderTypeContextMenu,r=n.elPopUp;fe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Wt.bind(this.merge,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){var e=n.getActiveSheet().table,r=e.screen,o=e.merges,i=e.tableDataSnapshot,c=r.findByClass(os).selectorAttr;if(c){var l=c.rect.clone(),a=o.getFirstIncludes(l.sri,l.sci);i.begin();var s=i.mergeDataProxy;null!==a?s.deleteMerge(a):l.multiple()&&s.addMerge(l),i.end(),e.render()}t.stopPropagation(),t.preventDefault()})),Wt.bind(this.horizontalAlign,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.horizontalAlign.horizontalContextMenu,r=n.elPopUp;fe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Wt.bind(this.verticalAlign,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.verticalAlign.verticalContextMenu,r=n.elPopUp;fe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Wt.bind(this.textWrapping,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.textWrapping.textWrappingContextMenu,r=n.elPopUp;fe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()}))}},{key:"setUndoStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table.tableDataSnapshot;this.undo.active(t.canBack())}},{key:"setRedoStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table.tableDataSnapshot;this.redo.active(t.canGo())}},{key:"setPaintFormatStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet();this.paintFormat.active(this.paintFormat.includeSheet(t))}},{key:"setFormatStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.cells,r=e.findByClass(os).selectorAttr,o="常规",i="default";if(r)switch(i=n.getCellOrNew(r.rect.sri,r.rect.sci).format){case"default":o="常规";break;case"text":o="文本";break;case"number":o="数字";break;case"percentage":o="百分比";break;case"fraction":o="分数";break;case"ENotation":o="科学计数";break;case"rmb":o="人民币";break;case"hk":o="港币";break;case"dollar":o="美元";break;case"date1":case"date2":case"date3":case"date4":case"date5":o="日期";break;case"time":o="时间"}this.format.setTitle(o),this.format.formatContextMenu.setActiveByType(i)}},{key:"setFontStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.cells,r=e.findByClass(os).selectorAttr,o="Arial";r&&(o=n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.name),this.font.setTitle(o),this.font.fontContextMenu.setActiveByType(o)}},{key:"setFontSizeStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.cells,r=e.findByClass(os).selectorAttr,o="12";r&&(o=n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.size),this.fontSize.setTitle(o)}},{key:"setFontBoldStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.cells,r=e.findByClass(os).selectorAttr,o=!1;r&&(o=n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.bold),this.fontBold.active(o)}},{key:"setFontItalicStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.cells,r=e.findByClass(os).selectorAttr,o=!1;r&&(o=n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.italic),this.fontItalic.active(o)}},{key:"setUnderLineStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.cells,r=e.findByClass(os).selectorAttr,o=!1;r&&(o=n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.underline),this.underLine.active(o)}},{key:"setFontStrikeStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.cells,r=e.findByClass(os).selectorAttr,o=!1;r&&(o=n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.strikethrough),this.fontStrike.active(o)}},{key:"setFontColorStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.cells,r=e.findByClass(os).selectorAttr,o="rgb(0, 0, 0)";r&&(o=n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.color),this.fontColor.setColor(o),this.fontColor.fontColorContextMenu.setActiveByColor(o)}},{key:"setFillColorStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.cells,r=e.findByClass(os).selectorAttr,o="rgb(255, 255, 255)";if(r){var i=n.getCellOrNew(r.rect.sri,r.rect.sci);i.background&&(o=i.background)}this.fillColor.setColor(o),this.fillColor.fillColorContextMenu.setActiveByColor(o)}},{key:"setHorizontalAlignStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.cells,r=e.findByClass(os).selectorAttr,o=new tt("align-left");if(r)switch(n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.align){case Uc.left:o=new tt("align-left");break;case Uc.center:o=new tt("align-center");break;case Uc.right:o=new tt("align-right")}this.horizontalAlign.setIcon(o)}},{key:"setVerticalAlignStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.cells,r=e.findByClass(os).selectorAttr,o=new tt("align-middle");if(r)switch(n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.verticalAlign){case Xc.top:o=new tt("align-top");break;case Xc.center:o=new tt("align-middle");break;case Xc.bottom:o=new tt("align-bottom")}this.verticalAlign.setIcon(o)}},{key:"setTextWrappingStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.cells,r=e.findByClass(os).selectorAttr,o=new tt("text-wrap");if(r)switch(n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.textWrap){case Gc.TRUNCATE:o=new tt("truncate");break;case Gc.WORD_WRAP:o=new tt("text-wrap");break;case Gc.OVER_FLOW:default:o=new tt("overflow")}this.textWrapping.setIcon(o)}},{key:"setStatus",value:function(){this.setUndoStatus(),this.setRedoStatus(),this.setPaintFormatStatus(),this.setFormatStatus(),this.setFontStatus(),this.setFontSizeStatus(),this.setFontBoldStatus(),this.setFontItalicStatus(),this.setUnderLineStatus(),this.setFontStrikeStatus(),this.setFontColorStatus(),this.setFillColorStatus(),this.setHorizontalAlignStatus(),this.setVerticalAlignStatus(),this.setTextWrappingStatus()}}])&&ps(n.prototype,i),c&&ps(n,c),e}(R);function Es(t){return(Es="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ss(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xs(t,e){return!e||"object"!==Es(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _s(t){return(_s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ks(t,e){return(ks=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ts=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=xs(this,_s(e).call(this,"".concat(o,"-option-item ").concat(t)))).title="",n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ks(t,e)}(e,t),n=e,(r=[{key:"setTitle",value:function(t){this.title=t,this.text(this.title)}}])&&Ss(n.prototype,r),i&&Ss(n,i),e}(R);function Cs(t){return(Cs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ps(t,e){return!e||"object"!==Cs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function As(t){return(As=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function js(t,e){return(js=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ls=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ps(this,As(e).call(this,"".concat(o,"-tools-file")))).setTitle("文件"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&js(t,e)}(e,t),e}(Ts);function Rs(t){return(Rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ws(t,e){return!e||"object"!==Rs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vs(t){return(Vs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hs(t,e){return(Hs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ms=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ws(this,Vs(e).call(this,"".concat(o,"-tools-format")))).setTitle("格式"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hs(t,e)}(e,t),e}(Ts);function Ns(t){return(Ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ds(t,e){return!e||"object"!==Ns(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Is(t){return(Is=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bs(t,e){return(Bs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ys=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ds(this,Is(e).call(this,"".concat(o,"-tools-insert")))).setTitle("插入"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bs(t,e)}(e,t),e}(Ts);function Fs(t){return(Fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zs(t,e){return!e||"object"!==Fs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Us(t){return(Us=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xs(t,e){return(Xs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gs=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=zs(this,Us(e).call(this,"".concat(o,"-tools-look")))).setTitle("查看"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xs(t,e)}(e,t),e}(Ts);function Ks(t){return(Ks="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qs(t,e){return!e||"object"!==Ks(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $s(t){return($s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zs(t,e){return(Zs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Js=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=qs(this,$s(e).call(this,"".concat(o,"-tools-update")))).setTitle("修改"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zs(t,e)}(e,t),e}(Ts);function Qs(t){return(Qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function eu(t,e){return!e||"object"!==Qs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nu(t){return(nu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ru(t,e){return(ru=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ou=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=eu(this,nu(e).call(this,"".concat(o,"-option")))).workTop=t,n.title=" X-Sheet 工作簿",n.logoEle=T("div","".concat(o,"-option-logo")),n.titleEle=T("div","".concat(o,"-option-title")),n.optionsEle=T("div","".concat(o,"-option-box")),n.leftEle=T("div","".concat(o,"-option-left")),n.rightEle=T("div","".concat(o,"-option-right")),n.leftEle.children(n.logoEle),n.rightEle.children(n.titleEle,n.optionsEle),n.children(n.leftEle),n.children(n.rightEle),n.setTitle(n.title),n.file=new Ls,n.format=new Ms,n.insert=new Ys,n.look=new Gs,n.update=new Js,n.optionsEle.children(n.file),n.optionsEle.children(n.format),n.optionsEle.children(n.insert),n.optionsEle.children(n.look),n.optionsEle.children(n.update),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ru(t,e)}(e,t),n=e,(r=[{key:"setTitle",value:function(t){this.title=t,this.titleEle.text(t)}}])&&tu(n.prototype,r),i&&tu(n,i),e}(R);function iu(t){return(iu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function lu(t,e){return!e||"object"!==iu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function au(t){return(au=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function su(t,e){return(su=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var uu=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=lu(this,au(e).call(this,"".concat(o,"-work-top")))).work=t,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&su(t,e)}(e,t),n=e,(r=[{key:"onAttach",value:function(){this.toolsMenu=new Os(this),this.option=new ou(this),this.attach(this.option),this.attach(this.toolsMenu)}}])&&cu(n.prototype,r),i&&cu(n,i),e}(R);function fu(t){return(fu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hu(t,e){return!e||"object"!==fu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pu(t){return(pu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yu(t,e){return(yu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bu=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=hu(this,pu(e).call(this,"".concat(o,"-vertical-center-element")))).options=S.mergeDeep({style:{}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yu(t,e)}(e,t),e}(N);function du(t){return(du="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gu(t,e){return!e||"object"!==du(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vu(t){return(vu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wu(t,e){return(wu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mu=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=gu(this,vu(e).call(this,"div","".concat(o,"-vertical-center")))).options=S.mergeDeep({style:{}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wu(t,e)}(e,t),e}(N);function Ou(t){return(Ou="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Eu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Su(t,e){return!e||"object"!==Ou(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xu(t,e,n){return(xu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_u(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function _u(t){return(_u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ku(t,e){return(ku=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tu=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Su(this,_u(e).call(this,"".concat(o,"-sheet-view")))).sheetList=[],t.activeIndex=-1,t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ku(t,e)}(e,t),n=e,(i=[{key:"attach",value:function(t){var n=this;this.sheetList.push(t),xu(_u(e.prototype),"attach",this).call(this,t),t.hide(),Wt.bind(t,r.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){n.trigger(r.TABLE_EVENT_TYPE.CHANGE_WIDTH)})),Wt.bind(t,r.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){n.trigger(r.TABLE_EVENT_TYPE.CHANGE_HEIGHT)})),Wt.bind(t,r.TABLE_EVENT_TYPE.DATA_CHANGE,(function(){n.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE)})),Wt.bind(t,r.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(){n.trigger(r.TABLE_EVENT_TYPE.SELECT_CHANGE)})),Wt.bind(t,r.TABLE_EVENT_TYPE.SELECT_DOWN,(function(){n.trigger(r.TABLE_EVENT_TYPE.SELECT_DOWN,n)}))}},{key:"setActiveSheet",value:function(t){var e=this.sheetList;return e[t]?(this.activeIndex=t,this.setActive(e[t])):null}},{key:"setActive",value:function(t){return t.show(),t.sibling().forEach((function(t){t.hide()})),t}},{key:"getActiveSheet",value:function(){return this.sheetList[this.activeIndex]}},{key:"getLastIndex",value:function(){return this.sheetList.length-1}}])&&Eu(n.prototype,i),c&&Eu(n,c),e}(R);function Cu(t){return(Cu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Au(t,e){return!e||"object"!==Cu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ju(t){return(ju=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Lu(t,e){return(Lu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ru=0,Wu=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Sheet".concat(Ru+=1);return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Au(this,ju(e).call(this,"".concat(o,"-sheet-tab")))).setName(n),t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lu(t,e)}(e,t),n=e,(r=[{key:"setName",value:function(t){this.name=t,this.text(this.name)}}])&&Pu(n.prototype,r),i&&Pu(n,i),e}(R);function Vu(t){return(Vu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mu(t,e){return!e||"object"!==Vu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Nu(t){return(Nu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Du(t,e){return(Du=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Iu=function(t){function e(t){var n,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Mu(this,Nu(e).call(this,"".concat(o,"-sheet-switch-tab")))).last=T("div","".concat(o,"-switch-tab-last-btn")),r.next=T("div","".concat(o,"-switch-tab-next-btn")),r.content=T("div","".concat(o,"-sheet-tab-content")),r.tabs=T("div","".concat(o,"-sheet-tab-tabs")),r.plus=T("div","".concat(o,"-sheet-tab-plus")),r.content.children(r.tabs),(n=r).children.apply(n,[r.last,r.next,r.content,r.plus]),r.optiions=S.mergeDeep({onAdd:function(t){return t},onSwitch:function(t){return t}},t),r.left=null,r.tabList=[],r}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Du(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"offsetSizeLeft",value:function(){var t=this.content.offset().width,e=this.tabs.offset().width;e>t&&(this.left=-(e-t),this.tabs.css("marginLeft","".concat(this.left,"px")))}},{key:"bind",value:function(){var t=this,e=this.next,n=this.last,o=this.plus;Wt.bind(e,r.SYSTEM_EVENT_TYPE.CLICK,(function(){var e=t.content.offset().width,n=-(t.tabs.offset().width-e),r=t.left||0;(r-=30)<n&&(r=n),t.left=r,t.tabs.css("marginLeft","".concat(t.left,"px"))})),Wt.bind(n,r.SYSTEM_EVENT_TYPE.CLICK,(function(){var e=t.left||0;(e+=30)>0&&(e=0),t.left=e,t.tabs.css("marginLeft","".concat(t.left,"px"))})),Wt.bind(o,r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.optiions.onAdd()}))}},{key:"attach",value:function(t){var e=this;this.tabList.push(t),this.tabs.children(t),t.onAttach(),this.offsetSizeLeft(),Wt.bind(t,r.SYSTEM_EVENT_TYPE.CLICK,(function(){e.setActive(t),e.optiions.onSwitch(t)}))}},{key:"setActiveTab",value:function(t){var e=this.tabList;return e[t]?(this.setActive(e[t]),e[t]):null}},{key:"setActive",value:function(t){t.addClass("active"),t.sibling().forEach((function(t){t.removeClass("active")}))}},{key:"getLastIndex",value:function(){return this.tabList.length-1}}])&&Hu(n.prototype,i),c&&Hu(n,c),e}(R);function Bu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Yu=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"dateFormat",value:function(t,e){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()},r=/(y+)/.exec(t);if(r){var o=r[0],i=e.getFullYear().toString().substr(4-o.length);t=t.replace(o,i)}for(var c in n){var l=new RegExp("(".concat(c,")")).exec(t);if(l){var a=n[c].toString(),s=l[0],u=1===s.length?a:"00".concat(a).substr(a.length);t=t.replace(s,u)}}return t}},{key:"parserToDate",value:function(t,e){if(!t)return null;for(var n=new Date("1970/01/01 00:00:00"),r=[{reg:"y+"},{reg:"M+"},{reg:"d+"},{reg:"h+"},{reg:"m+"},{reg:"s+"},{reg:"S"}],o=n.getFullYear(),i=n.getMonth()+1,c=n.getDate(),l=n.getHours(),a=n.getMinutes(),s=n.getSeconds(),u=n.getMilliseconds(),f=1,h=0;h<e.length;h+=1)for(var p=e[h],y=0;y<r.length;y+=1){var b=r[y];if(b.reg[0]===p){b.index||(b.index=f,f+=1);break}}for(var d=0;d<r.length;d+=1){var g=r[d].reg,v=new RegExp("(".concat(g,")")).exec(e);if(v){var w=v[0],m="([0-9]{1,".concat(w.length,"})");e=e.replace(w,m)}}var O={},E=new RegExp(e).exec(t);if(!E)return null;for(var S=1;S<E.length;S+=1)O[S]=E[S];return r[0].index&&(o=O[r[0].index]),r[1].index&&(i=O[r[1].index]),r[2].index&&(c=O[r[2].index]),r[3].index&&(l=O[r[3].index]),r[4].index&&(a=O[r[4].index]),r[5].index&&(s=O[r[5].index]),r[6].index&&(u=O[r[6].index]),new Date(o,i-1,c,l,a,s,u)}}],(n=null)&&Bu(e.prototype,n),r&&Bu(e,r),t}();function Fu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zu(t){var e=Yu.parserToDate(t,"yyyy/MM/dd hh:mm:ss");return e||((e=Yu.parserToDate(t,"yyyy/MM/dd"))?e:(e=Yu.parserToDate(t,"hh:mm:ss"))?e:(e=Yu.parserToDate(t,"MM月dd日"))?e:(e=Yu.parserToDate(t,"yyyy年MM月"))?e:(e=Yu.parserToDate(t,"yyyy年MM月dd日"))||null)}var Uu=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"default",value:function(t){return t}},{key:"text",value:function(t){return t}},{key:"number",value:function(t){if(S.isNumber(t)){if(-1!==t.toString().indexOf(".")){var e=t.toString().lastIndexOf(".")+1;return t.toString().substring(0,e+2)}return"".concat(t,".00")}return t}},{key:"percentage",value:function(t){return S.isNumber(t)?"".concat(t,"%"):t}},{key:"fraction",value:function(t){if(S.isFraction(t)){var e=t.split("/")[0],n=t.split("/")[1];return S.parseInt(e)/S.parseInt(n)}return t}},{key:"ENotation",value:function(t){return S.isNumber(t)?S.parseFloat(t).toExponential(2):t}},{key:"rmb",value:function(t){return S.isNumber(t)?"￥".concat(t):t}},{key:"hk",value:function(t){return S.isNumber(t)?"HK".concat(t):t}},{key:"dollar",value:function(t){return S.isNumber(t)?"$".concat(t):t}},{key:"date1",value:function(t){var e=zu(t);return e?Yu.dateFormat("yyyy/MM/dd",e):t}},{key:"date2",value:function(t){var e=zu(t);return e?Yu.dateFormat("MM月dd日",e):t}},{key:"date3",value:function(t){var e=zu(t);return e?Yu.dateFormat("yyyy年MM月",e):t}},{key:"date4",value:function(t){var e=zu(t);return e?Yu.dateFormat("yyyy年MM月dd日",e):t}},{key:"date5",value:function(t){var e=zu(t);return e?Yu.dateFormat("yyyy/MM/dd hh:mm:ss",e):t}},{key:"time",value:function(t){var e=zu(t);return e?Yu.dateFormat("hh:mm:ss",e):t}}])&&Fu(e.prototype,n),r&&Fu(e,r),t}()),Xu=function(t,e){return Uu[t](e)};function Gu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ku=function(){function t(e){var n=e.data,r=void 0===n?[]:n,o=e.len,i=void 0===o?10:o,c=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._=[],this.minHeight=5,this.height=S.minIf(c,this.minHeight),this.len=i,this.cacheTotalHeight=-1,this.setData(r)}var e,n,r;return e=t,(n=[{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"getHeight",value:function(t){var e=this.get(t);return e&&e.height?e.height:this.height}},{key:"setHeight",value:function(t,e){this.getOrNew(t).height=S.minIf(e,this.minHeight),this.cacheTotalHeight=-1}},{key:"eachHeight",value:function(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=r,i=t;i<=e;i+=1){var c=this.getHeight(i);n(i,c,o),o+=c}}},{key:"sectionSumHeight",value:function(t,e){var n=this;return S.rangeSum(t,e+1,(function(t){return n.getHeight(t)}))}},{key:"rectRangeSumHeight",value:function(t){return this.sectionSumHeight(t.sri,t.eri)}},{key:"totalHeight",value:function(){var t=this;return-1===this.cacheTotalHeight&&(this.cacheTotalHeight=S.rangeSum(0,this.len,(function(e){return t.getHeight(e)}))),this.cacheTotalHeight}},{key:"getData",value:function(){return this._}},{key:"setData",value:function(t){this._=t}}])&&Gu(e.prototype,n),r&&Gu(e,r),t}();function qu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $u=function(){function t(e){var n=e.data,r=void 0===n?[]:n,o=e.len,i=void 0===o?10:o,c=e.width;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._=[],this.minWidth=5,this.width=S.minIf(c,this.minWidth),this.len=i,this.cacheTotalWidth=-1,this.setData(r)}var e,n,r;return e=t,(n=[{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"getWidth",value:function(t){var e=this._[t];return e&&e.width?e.width:this.width}},{key:"setWidth",value:function(t,e){this.getOrNew(t).width=S.minIf(e,this.minWidth),this.cacheTotalWidth=-1}},{key:"eachWidth",value:function(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=r,i=t;i<=e;i+=1){var c=this.getWidth(i);n(i,c,o),o+=c}}},{key:"sectionSumWidth",value:function(t,e){var n=this;return S.rangeSum(t,e+1,(function(t){return n.getWidth(t)}))}},{key:"rectRangeSumWidth",value:function(t){return this.sectionSumWidth(t.sci,t.eci)}},{key:"totalWidth",value:function(){var t=this;return-1===this.cacheTotalWidth&&(this.cacheTotalWidth=S.rangeSum(0,this.len,(function(e){return t.getWidth(e)}))),this.cacheTotalWidth}},{key:"getData",value:function(){return this._}},{key:"setData",value:function(t){this._=t}}])&&qu(e.prototype,n),r&&qu(e,r),t}();var Zu={H_LEFT:Symbol("水平方向左边滚动条"),H_RIGHT:Symbol("水平方向向右边滚动"),V_TOP:Symbol("垂直方向向上滚动"),V_BOTTOM:Symbol("垂直方向下滚动"),UN:Symbol("未知")},Ju=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.x=0,this.y=0,this.ri=e.fixed.fxTop+1,this.ci=e.fixed.fxLeft+1,this.type=Zu.UN};function Qu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var tf=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{fxTop:-1,fxLeft:-1};Qu(this,t),this.fxTop=e.fxTop,this.fxLeft=e.fxLeft};function ef(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var nf=function(){function t(e){var n=e.data,r=void 0===n?[]:n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._=[],this.setData(r)}var e,n,r;return e=t,(n=[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(t){this._=this._.filter((function(e){return!e.within(t)}))}},{key:"getFirstIncludes",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"filterIntersects",value:function(e){return new t(this._.filter((function(t){return t.intersects(e)})))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1)if(this._[e].intersects(t))return!0;return!1}},{key:"deleteIntersects",value:function(t){for(var e=0;e<this._.length;e+=1)this._[e].intersects(t)&&this._.splice(e,1)}},{key:"union",value:function(t){for(var e=this,n=t,r=[],o=function(t){var o=e._[t];if(r.find((function(t){return t===o})))return i=t,"continue";o.intersects(n)&&(r.push(o),n=o.union(n),t=-1),i=t},i=0;i<this._.length;i+=1)o(i);return n}},{key:"add",value:function(t){t&&(this.deleteWithin(t),this._.push(t))}},{key:"move",value:function(t,e,n){this._.forEach((function(r){var o=r;o.within(t)&&(o.eri+=e,o.sri+=e,o.sci+=n,o.eci+=n)}))}},{key:"shift",value:function(t,e,n,r){this._.forEach((function(o){var i=o.sri,c=o.sci,l=o.eri,a=o.eci,s=o;"row"===t?i>=e?(s.sri+=n,s.eri+=n):i<e&&e<=l&&(s.eri+=n,r(i,c,n,0)):"column"===t&&(c>=e?(s.sci+=n,s.eci+=n):c<e&&e<=a&&(s.eci+=n,r(i,c,0,n)))}))}},{key:"setData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this._=t.map((function(t){return Ia.valueOf(t)})),this}},{key:"getData",value:function(){return this._.map((function(t){return t.toString()}))}}])&&ef(e.prototype,n),r&&ef(e,r),t}();function rf(t){return(rf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function of(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function cf(t,e){return!e||"object"!==rf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function lf(t){return(lf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function af(t,e){return(af=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sf=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=cf(this,lf(e).call(this,"".concat(o,"-screen-element ").concat(t)))).widgets=[],n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&af(t,e)}(e,t),n=e,(r=[{key:"addWidget",value:function(t){this.widgets.push(t),this.children(t)}}])&&of(n.prototype,r),i&&of(n,i),e}(R);function uf(t){return(uf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ff(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hf(t,e){return!e||"object"!==uf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pf(t){return(pf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yf(t,e){return(yf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bf=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=hf(this,pf(e).call(this,"".concat(o,"-screen")))).table=t,n.widgets=[],n.lt=new sf("".concat(o,"-screen-element-lt")),n.t=new sf("".concat(o,"-screen-element-t")),n.l=new sf("".concat(o,"-screen-element-l")),n.br=new sf("".concat(o,"-screen-element-br")),n.children(n.lt,n.t,n.l,n.br),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yf(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind(),this.setDivideLayer()}},{key:"init",value:function(){}},{key:"bind",value:function(){var t=this,e=this.table;Wt.bind(window,r.SYSTEM_EVENT_TYPE.RESIZE,(function(){t.setDivideLayer()})),Wt.bind(e,r.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.setDivideLayer()})),Wt.bind(e,r.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.setDivideLayer()}))}},{key:"addWidget",value:function(t){this.widgets.push(t),this.lt.addWidget(t.getLT(this)),this.t.addWidget(t.getT(this)),this.l.addWidget(t.getL(this)),this.br.addWidget(t.getBR(this))}},{key:"setDivideLayer",value:function(){var t=this.table,e=t.settings,n=t.grid,r=e.index,o=t.getFixedWidth(),i=t.getFixedHeight(),c=r.width+o,l=r.height+i;this.br.offset({left:c,top:l}),o>0&&i>0?(this.lt.offset({left:r.width,top:r.height,width:o,height:i}).show(),this.lt.css("border-width","".concat(n.lineWidth(),"px"))):this.lt.hide(),o>0?(this.l.offset({left:r.width,top:l,width:o}).show(),this.l.css("border-width","".concat(n.lineWidth(),"px"))):this.l.hide(),i>0?(this.t.offset({left:c,top:r.height,height:i}).show(),this.t.css("border-width","".concat(n.lineWidth(),"px"))):this.t.hide()}},{key:"findByClass",value:function(t){var e=null;return this.widgets.forEach((function(n){return!(n instanceof t&&(e=n,1))})),e}}])&&ff(n.prototype,i),c&&ff(n,c),e}(R);function df(t){return(df="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vf(t,e){return!e||"object"!==df(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wf(t){return(wf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mf(t,e){return(mf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Of=function(t){function e(t){var n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:5};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=vf(this,wf(e).call(this,"".concat(o,"-re-sizer-horizontal")))).table=t,r.options=i,r.width=i.width,r.hoverEl=T("div","".concat(o,"-re-sizer-hover")),r.lineEl=T("div","".concat(o,"-re-sizer-line")),(n=r).children.apply(n,[r.hoverEl,r.lineEl]),r}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mf(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind(),this.table.focus.register({el:this})}},{key:"getEventLeft",value:function(t){var e=this.table,n=e.settings,r=e.cols,o=e.fixed,i=e.scroll,c=n.index,l=e.computeEventXy(t),a=l.x,s=l.y,u=e.getRiCiByXy(a,s),f=u.ri,h=u.ci;if(-1!==f)return{left:-1,x:a,y:s,ri:f,ci:h};var p=c.width+r.sectionSumWidth(0,h);return h>o.fxLeft&&(p-=i.x),{left:p,x:a,y:s,ri:f,ci:h}}},{key:"bind",value:function(){var t=this,e=this.table,n=e.settings,o=e.cols,i=e.mousePointer,c=e.tableDataSnapshot,l=c.colsDataProxy,a=n.index,s=r.MOUSE_POINTER_TYPE.COL_RESIZE,u=s.key,f=s.type,h=!1;Wt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){h||(i.on(u),i.set(f,u))})),Wt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){h||i.off(u)})),Wt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(n){h=!0,i.on(u),i.set(f,u);var r=t.getEventLeft(n),a=r.left,s=r.ci,p=a-o.getWidth(s)+o.minWidth,y=e.computeEventXy(n).x;Wt.mouseMoveUp(document,(function(n){var r=e.computeEventXy(n);y=r.x,y-=t.width/2,y=Math.ceil(S.minIf(y,p)),t.css("left","".concat(y,"px")),t.lineEl.css("height","".concat(e.visualHeight(),"px")),t.lineEl.show()}),(function(n){h=!1,i.off(u),t.lineEl.hide(),t.css("left","".concat(y,"px")),e.computeEventXy(n).y<=0&&t.hide();var r=y-(a-o.getWidth(s))+t.width;c.begin(),l.setWidth(s,r),c.end(),e.resize()}))})),Wt.bind(e,r.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(n){if(!h){var r=t.getEventLeft(n),i=r.left,c=r.ci,l=i-o.getWidth(c)+o.minWidth,s=e.visualWidth();i>s&&(i=s),-1===i||l>s||-1===c?t.hide():(t.show(),t.css("left","".concat(i-t.width,"px")),t.hoverEl.css("width","".concat(t.width,"px")),t.hoverEl.css("height","".concat(a.height,"px")))}})),Wt.bind(e,r.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){h||t.hide()}))}}])&&gf(n.prototype,i),c&&gf(n,c),e}(R);function Ef(t){return(Ef="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xf(t,e){return!e||"object"!==Ef(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _f(t){return(_f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kf(t,e){return(kf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tf=function(t){function e(t){var n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{height:5};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=xf(this,_f(e).call(this,"".concat(o,"-re-sizer-vertical")))).table=t,r.options=i,r.height=i.height,r.hoverEl=T("div","".concat(o,"-re-sizer-hover")),r.lineEl=T("div","".concat(o,"-re-sizer-line")),(n=r).children.apply(n,[r.hoverEl,r.lineEl]),r}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kf(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind(),this.table.focus.register({el:this})}},{key:"getEventTop",value:function(t){var e=this.table,n=e.settings,r=e.rows,o=e.fixed,i=e.scroll,c=n.index,l=e.computeEventXy(t),a=l.x,s=l.y,u=e.getRiCiByXy(a,s),f=u.ri,h=u.ci;if(-1!==h)return{top:-1,x:a,y:s,ri:f,ci:h};var p=c.height+r.sectionSumHeight(0,f);return f>o.fxTop&&(p-=i.y),{top:p,x:a,y:s,ri:f,ci:h}}},{key:"bind",value:function(){var t=this,e=this.table,n=e.settings,o=e.rows,i=e.mousePointer,c=e.tableDataSnapshot,l=c.rowsDataProxy,a=n.index,s=r.MOUSE_POINTER_TYPE.ROW_RESIZE,u=s.key,f=s.type,h=!1;Wt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){h||(i.on(u),i.set(f,u))})),Wt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){h||i.off(u)})),Wt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(n){h=!0,i.on(u),i.set(f,u);var r=t.getEventTop(n),a=r.top,s=r.ri,p=a-o.getHeight(s)+o.minHeight,y=e.computeEventXy(n).y;Wt.mouseMoveUp(document,(function(n){var r=e.computeEventXy(n);y=r.y,y-=t.height/2,y=Math.ceil(S.minIf(y,p)),t.css("top","".concat(y,"px")),t.lineEl.css("width","".concat(e.visualWidth(),"px")),t.lineEl.show()}),(function(n){h=!1,i.off(u),t.lineEl.hide(),t.css("top","".concat(y,"px")),e.computeEventXy(n).x<=0&&t.hide();var r=y-(a-o.getHeight(s))+t.height;c.begin(),l.setHeight(s,r),c.end(),e.resize()}))})),Wt.bind(e,r.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(n){if(!h){var r=t.getEventTop(n),i=r.top,c=r.ri,l=i-o.getHeight(c)+o.minHeight,s=e.visualHeight();i>s&&(i=s),-1===i||l>s||-1===c?t.hide():(t.show(),t.css("top","".concat(i-t.height,"px")),t.hoverEl.css("width","".concat(a.width,"px")),t.hoverEl.css("height","".concat(t.height,"px")))}})),Wt.bind(e,r.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){h||t.hide()}))}}])&&Sf(n.prototype,i),c&&Sf(n,c),e}(R);function Cf(t){return(Cf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pf(t,e){return!e||"object"!==Cf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Af(t){return(Af=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jf(t,e){return(jf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Lf=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Pf(this,Af(e).call(this,"".concat(o,"-autofill")))).areaEl=T("div","".concat(o,"-autofill-area")),t.children(t.areaEl),t.hide(),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jf(t,e)}(e,t),e}(R);function Rf(t){return(Rf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wf(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Vf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Hf(t,e){return!e||"object"!==Rf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mf(t){return(Mf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nf(t,e){return(Nf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Df=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Hf(this,Mf(e).call(this,t))).options=S.mergeDeep({mergeForceSplit:!1,onBeforeAutoFill:function(){},onAfterAutoFill:function(){}},r),n.lt=new Lf,n.t=new Lf,n.l=new Lf,n.br=new Lf,n.autoFillAttr=null,n.bind(),n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nf(t,e)}(e,t),n=e,(o=[{key:"bind",value:function(){var t=this,e=this.screen.table,n=e.mousePointer,o=e.screenSelector,i=r.MOUSE_POINTER_TYPE.AUTO_FILL,c=i.key,l=i.type;Wt.bind([o.lt.cornerEl,o.t.cornerEl,o.l.cornerEl,o.br.cornerEl],r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){n.on(c),n.set(l,c),Wt.mouseMoveUp(document,(function(n){var r=e.computeEventXy(n),o=r.x,i=r.y,c=t.getMoveAutoFillAttr(o,i);c?t.setOffset(c):(t.lt.hide(),t.t.hide(),t.l.hide(),t.br.hide()),t.autoFillAttr=c}),(function(){n.off(c),t.lt.hide(),t.t.hide(),t.l.hide(),t.br.hide(),t.autoFillAttr&&(t.autoFillTo(),e.render())}))})),Wt.bind([o.lt.cornerEl,o.t.cornerEl,o.l.cornerEl,o.br.cornerEl],r.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){n.set(l,c)}))}},{key:"setLTOffset",value:function(t){var e=this.screen.table,n=e.frozenLeftTop,r=e.cols,o=e.rows,i=n.getScrollViewRange(),c=t.rect,l=new Ia(-1,-1,-1,-1),a=c.coincide(i);if(l.equals(a))this.lt.hide();else{var s=r.sectionSumWidth(a.sci,a.eci),u=o.sectionSumHeight(a.sri,a.eri),f=o.sectionSumHeight(i.sri,a.sri-1),h=r.sectionSumWidth(i.sci,a.sci-1);c.eci>i.eci?this.lt.areaEl.css("border-right","none"):this.lt.areaEl.cssRemoveKeys("border-right"),c.eri>i.eri?this.lt.areaEl.css("border-bottom","none"):this.lt.areaEl.cssRemoveKeys("border-bottom"),this.lt.offset({width:s,height:u,left:h,top:f}).show()}}},{key:"setTOffset",value:function(t){var e=this.screen.table,n=e.fixedTop,r=e.cols,o=e.rows,i=n.getScrollViewRange(),c=t.rect,l=new Ia(-1,-1,-1,-1),a=c.coincide(i);if(l.equals(a))this.t.hide();else{var s=r.sectionSumWidth(a.sci,a.eci),u=o.sectionSumHeight(a.sri,a.eri),f=o.sectionSumHeight(i.sri,a.sri-1),h=r.sectionSumWidth(i.sci,a.sci-1);c.sci<i.sci?this.t.areaEl.css("border-left","none"):this.t.areaEl.cssRemoveKeys("border-left"),c.eri>i.eri?this.t.areaEl.css("border-bottom","none"):this.t.areaEl.cssRemoveKeys("border-bottom"),c.eci>i.eci?this.t.areaEl.css("border-right","none"):this.t.areaEl.cssRemoveKeys("border-right"),this.t.offset({width:s,height:u,left:h,top:f}).show()}}},{key:"setLOffset",value:function(t){var e=this.screen.table,n=e.fixedLeft,r=e.cols,o=e.rows,i=n.getScrollViewRange(),c=t.rect,l=new Ia(-1,-1,-1,-1),a=c.coincide(i);if(l.equals(a))this.l.hide();else{var s=r.sectionSumWidth(a.sci,a.eci),u=o.sectionSumHeight(a.sri,a.eri),f=o.sectionSumHeight(i.sri,a.sri-1),h=r.sectionSumWidth(i.sci,a.sci-1);c.sri<i.sri?this.l.areaEl.css("border-top","none"):this.l.areaEl.cssRemoveKeys("border-top"),c.eci>i.eci?this.l.areaEl.css("border-right","none"):this.l.areaEl.cssRemoveKeys("border-right"),c.eri>i.eri?this.l.areaEl.css("border-bottom","none"):this.l.areaEl.cssRemoveKeys("border-bottom"),this.l.offset({width:s,height:u,left:h,top:f}).show()}}},{key:"setBROffset",value:function(t){var e=this.screen.table,n=e.cols,r=e.rows,o=e.getScrollViewRange(),i=t.rect,c=new Ia(-1,-1,-1,-1),l=i.coincide(o);if(c.equals(l))this.br.hide();else{var a=n.sectionSumWidth(l.sci,l.eci),s=r.sectionSumHeight(l.sri,l.eri),u=r.sectionSumHeight(o.sri,l.sri-1),f=n.sectionSumWidth(o.sci,l.sci-1);i.sci<o.sci?this.br.areaEl.css("border-left","none"):this.br.areaEl.cssRemoveKeys("border-left"),i.sri<o.sri?this.br.areaEl.css("border-top","none"):this.br.areaEl.cssRemoveKeys("border-top"),i.eri>o.eri?this.br.areaEl.css("border-bottom","none"):this.br.areaEl.cssRemoveKeys("border-bottom"),i.eci>o.eci?this.br.areaEl.css("border-right","none"):this.br.areaEl.cssRemoveKeys("border-right"),this.br.offset({width:a,height:s,left:f,top:u}).show()}}},{key:"setOffset",value:function(t){this.setLTOffset(t),this.setTOffset(t),this.setLOffset(t),this.setBROffset(t)}},{key:"getMoveAutoFillAttr",value:function(t,e){var n=this.screen,r=this.screenSelector,o=n.table,i=r.selectorAttr,c=o.cols,l=o.rows,a=o.merges,s=i.rect,u=i.edge,f=i.edgeType,h=u||a.intersects(s),p=Wf(s.size(),2),y=p[0],b=p[1],d=o.getRiCiByXy(t,e),g=d.ri,v=d.ci;g<0?g=0:g>l.len&&(g=l.len-1),v<0?v=0:v>c.len&&(v=c.len-1);var w=s.sri,m=s.sci,O=s.eri,E=s.eci;"left"===f&&(E=c.len-1),"top"===f&&(O=l.len-1);var S=null,x="un";if(g<w||g>O){if(g<w)if(x="top",h){var _=w-y;if(_>=0){for(var k=w-1-g,T=1;T<=k;T+=1)T%y==0&&_-y>=0&&(_-=y);S=new Ia(_,m,w-1,E)}}else S=new Ia(g,m,w-1,E);if(g>O)if(x="bottom",h){var C=O+y;if(C<=l.len-1){for(var P=g-(O+1),A=1;A<=P;A+=1)A%y==0&&C+y<=l.len-1&&(C+=y);S=new Ia(O+1,m,C,E)}}else S=new Ia(O+1,m,g,E)}else if(v<m||v>E){if(v<m)if(x="left",h){var j=m-b;if(j>=0){for(var L=m-1-v,R=1;R<=L;R+=1)R%b==0&&j-b>=0&&(j-=b);S=new Ia(w,j,O,m-1)}}else S=new Ia(w,v,O,m-1);if(v>E)if(x="right",h){var W=E+b;if(W<=c.len-1){for(var V=v-(E+1),H=1;H<=V;H+=1)H%b==0&&W+b<=c.len-1&&(W+=b);S=new Ia(w,E+1,O,W)}}else S=new Ia(w,E+1,O,v)}if(null!==S){var M=c.sectionSumWidth(S.sci,S.eci),N=l.sectionSumHeight(S.sri,S.eri);return S.w=M,S.h=N,{rect:S,direction:x}}return null}},{key:"mergeCellForceSplit",value:function(){for(var t=this.screen,e=this.screenSelector,n=t.table.merges,r=this.autoFillAttr,o=e.selectorAttr,i=r.rect,c=o.rect,l=c.sri,a=i.sri;a<=i.eri;){for(var s=c.sci,u=i.sci;u<=i.eci;){var f=new Ia(a,u,a,u),h=n.getFirstIncludes(a,u);h&&c.intersects(h)||n.deleteIntersects(f),u+=1,(s+=1)>c.eci&&(s=c.sci)}a+=1,(l+=1)>c.eri&&(l=c.sri)}}},{key:"copyContent",value:function(){for(var t=0,e=this.screen,n=this.screenSelector,r=e.table,o=r.cells,i=r.tableDataSnapshot.cellDataProxy,c=this.autoFillAttr,l=n.selectorAttr,a=c.rect,s=l.rect,u=s.sri,f=a.sri;f<=a.eri;){for(var h=s.sci,p=a.sci;p<=a.eci;){var y=o.getCell(u,h);if(y){var b=y.clone();i.setCell(f,p,b),S.isBlank(y.text)||(t+=1)}p+=1,(h+=1)>s.eci&&(h=s.sci)}f+=1,(u+=1)>s.eri&&(u=s.sri)}return t}},{key:"copyMerge",value:function(){var t=this.screen,e=this.screenSelector,n=t.table,r=n.merges,o=n.tableDataSnapshot.mergeDataProxy,i=this.autoFillAttr,c=e.selectorAttr,l=i.rect,a=i.direction,s=c.rect,u=c.edge,f=s.sri,h=l.sri;if(!u||"top"!==a&&"left"!==a)for(;h<=l.eri;){for(var p=s.sci,y=l.sci;y<=l.eci;){var b=r.getFirstIncludes(f,p);if(b&&b.sri===f&&b.sci===p){var d=Wf(b.size(),2),g=d[0],v=d[1],w=new Ia(h,y,h+(g-=1),y+(v-=1));r.intersects(w)||o.addMerge(w)}y+=1,(p+=1)>s.eci&&(p=s.sci)}h+=1,(f+=1)>s.eri&&(f=s.sri)}}},{key:"autoFillTo",value:function(){var t=this.screen,e=this.options.mergeForceSplit,n=t.table.merges,r=this.autoFillAttr.rect,o=n.getFirstIncludes(r.sri,r.sci);if(o&&o.equals(r)){this.options.onBeforeAutoFill(),this.mergeCellForceSplit();var i=this.copyContent();this.copyMerge(),this.options.onAfterAutoFill(i)}else{if(n.intersects(r)&&!1===e)return void alert("此操作要求合并单元格都具有相同大小");this.options.onBeforeAutoFill(),this.mergeCellForceSplit();var c=this.copyContent();this.copyMerge(),this.options.onAfterAutoFill(c)}}}])&&Vf(n.prototype,o),i&&Vf(n,i),e}(Ma);function If(t){return(If="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yf(t,e){return!e||"object"!==If(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ff(t){return(Ff=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zf(t,e){return(zf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Uf=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Yf(this,Ff(e).call(this,"".concat(o,"-table-x-height-light")))).table=t;var r=t.settings.index;return n.css("height","".concat(r.height,"px")),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zf(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind(),this.hide()}},{key:"disjoint",value:function(t,e){return t.sci>e.eci||e.sci>t.eci}},{key:"coincide",value:function(t,e){return this.disjoint(t,e)?new Ia(0,-1,0,-1):new Ia(0,e.sci>t.sci?e.sci:t.sci,0,e.eci<t.eci?e.eci:t.eci)}},{key:"offsetHeightLight",value:function(t,e){var n=this.table,r=n.settings.index,o=new Ia(0,-1,0,-1);switch(this.hide(),e){case"lt":var i=t.rect,c=n.frozenLeftTop,l=n.cols,a=c.getScrollViewRange(),s=this.coincide(i,a);if(!o.equals(s)){var u=l.sectionSumWidth(s.sci,s.eci),f=l.sectionSumWidth(a.sci,s.sci-1)+r.width;"".concat(u,"px")!==this.css("width")&&this.css("width","".concat(u,"px")),"".concat(f,"px")!==this.css("left")&&this.css("left","".concat(f,"px")),this.show()}break;case"t":var h=t.rect,p=n.fixedTop,y=n.cols,b=p.getScrollViewRange(),d=this.coincide(h,b);if(!o.equals(d)){var g=y.sectionSumWidth(d.sci,d.eci),v=y.sectionSumWidth(b.sci,d.sci-1)+n.getFixedWidth()+r.width;"".concat(g,"px")!==this.css("width")&&this.css("width","".concat(g,"px")),"".concat(v,"px")!==this.css("left")&&this.css("left","".concat(v,"px")),this.show()}break;case"br":var w=t.rect,m=n.cols,O=n.getScrollViewRange(),E=this.coincide(w,O);if(!o.equals(E)){var S=m.sectionSumWidth(E.sci,E.eci),x=m.sectionSumWidth(O.sci,E.sci-1)+n.getFixedWidth()+r.width;"".concat(S,"px")!==this.css("width")&&this.css("width","".concat(S,"px")),"".concat(x,"px")!==this.css("left")&&this.css("left","".concat(x,"px")),this.show()}break;case"l":var _=t.rect,k=n.fixedLeft,T=n.cols,C=k.getScrollViewRange(),P=this.coincide(_,C);if(!o.equals(P)){var A=T.sectionSumWidth(P.sci,P.eci),j=T.sectionSumWidth(C.sci,P.sci-1)+r.width;"".concat(A,"px")!==this.css("width")&&this.css("width","".concat(A,"px")),"".concat(j,"px")!==this.css("left")&&this.css("left","".concat(j,"px")),this.show()}break;case"ltt":var L=t.rect,R=n.frozenLeftTop,W=n.fixedTop,V=n.cols,H=R.getScrollViewRange(),M=W.getScrollViewRange(),N=this.coincide(L,H),D=this.coincide(L,M),I=0,B=V.sectionSumWidth(H.sci,N.sci-1)+r.width;o.equals(N)||(I+=V.sectionSumWidth(N.sci,N.eci)),o.equals(D)||(I+=V.sectionSumWidth(D.sci,D.eci)),"".concat(I,"px")!==this.css("width")&&this.css("width","".concat(I,"px")),"".concat(B,"px")!==this.css("left")&&this.css("left","".concat(B,"px")),this.show();break;case"ltl":var Y=t.rect,F=n.frozenLeftTop,z=n.cols,U=F.getScrollViewRange(),X=this.coincide(Y,U);if(!o.equals(X)){var G=z.sectionSumWidth(X.sci,X.eci),K=z.sectionSumWidth(U.sci,X.sci-1)+r.width;"".concat(G,"px")!==this.css("width")&&this.css("width","".concat(G,"px")),"".concat(K,"px")!==this.css("left")&&this.css("left","".concat(K,"px")),this.show()}break;case"tbr":var q=t.rect,$=n.fixedTop,Z=n.cols,J=$.getScrollViewRange(),Q=this.coincide(q,J);if(!o.equals(Q)){var tt=Z.sectionSumWidth(Q.sci,Q.eci),et=Z.sectionSumWidth(J.sci,Q.sci-1)+n.getFixedWidth()+r.width;"".concat(tt,"px")!==this.css("width")&&this.css("width","".concat(tt,"px")),"".concat(et,"px")!==this.css("left")&&this.css("left","".concat(et,"px")),this.show()}break;case"lbr":var nt=t.rect,rt=n.fixedLeft,ot=n.cols,it=rt.getScrollViewRange(),ct=n.getScrollViewRange(),lt=this.coincide(nt,it),at=this.coincide(nt,ct),st=0,ut=ot.sectionSumWidth(it.sci,lt.sci-1)+r.width;o.equals(lt)||(st+=ot.sectionSumWidth(lt.sci,lt.eci)),o.equals(at)||(st+=ot.sectionSumWidth(at.sci,at.eci)),"".concat(st,"px")!==this.css("width")&&this.css("width","".concat(st,"px")),"".concat(ut,"px")!==this.css("left")&&this.css("left","".concat(ut,"px")),this.show();break;case"lttlbr":var ft=t.rect,ht=n.frozenLeftTop,pt=n.fixedTop,yt=n.cols,bt=ht.getScrollViewRange(),dt=pt.getScrollViewRange(),gt=this.coincide(ft,bt),vt=this.coincide(ft,dt),wt=0,mt=yt.sectionSumWidth(bt.sci,gt.sci-1)+r.width;o.equals(gt)||(wt+=yt.sectionSumWidth(gt.sci,gt.eci)),o.equals(vt)||(wt+=yt.sectionSumWidth(vt.sci,vt.eci)),"".concat(wt,"px")!==this.css("width")&&this.css("width","".concat(wt,"px")),"".concat(mt,"px")!==this.css("left")&&this.css("left","".concat(mt,"px")),this.show()}}},{key:"bind",value:function(){var t=this,e=this.table,n=e.screenSelector;n.on(rs.CHANGE,(function(){var e=n.selectorAttr;if(e){var r=n.getIntersectsArea(e);t.offsetHeightLight(e,r)}})),Wt.bind(e,r.SYSTEM_EVENT_TYPE.SCROLL,(function(){var e=n.selectorAttr;if(e){var r=n.getIntersectsArea(e);t.offsetHeightLight(e,r)}}))}}])&&Bf(n.prototype,i),c&&Bf(n,c),e}(R);function Xf(t){return(Xf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Kf(t,e){return!e||"object"!==Xf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qf(t){return(qf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $f(t,e){return($f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zf=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Kf(this,qf(e).call(this,"".concat(o,"-table-y-height-light")))).table=t;var r=t.settings.index;return n.css("width","".concat(r.width,"px")),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$f(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind(),this.hide()}},{key:"disjoint",value:function(t,e){return t.sri>e.eri||e.sri>t.eri}},{key:"coincide",value:function(t,e){return this.disjoint(t,e)?new Ia(-1,0,-1,0):new Ia(e.sri>t.sri?e.sri:t.sri,0,e.eri<t.eri?e.eri:t.eri,0)}},{key:"offsetHeightLight",value:function(t,e){var n=this.table,r=n.settings.index,o=new Ia(-1,0,-1,0);switch(this.hide(),e){case"lt":var i=t.rect,c=n.frozenLeftTop,l=n.rows,a=c.getScrollViewRange(),s=this.coincide(i,a);if(!o.equals(s)){var u=l.sectionSumHeight(s.sri,s.eri),f=l.sectionSumHeight(a.sri,s.sri-1)+r.height;"".concat(u,"px")!==this.css("height")&&this.css("height","".concat(u,"px")),"".concat(f,"px")!==this.css("top")&&this.css("top","".concat(f,"px")),this.show()}break;case"t":var h=t.rect,p=n.fixedTop,y=n.rows,b=p.getScrollViewRange(),d=this.coincide(h,b);if(!o.equals(d)){var g=y.sectionSumHeight(d.sri,d.eri),v=y.sectionSumHeight(b.sri,d.sri-1)+r.height;"".concat(g,"px")!==this.css("height")&&this.css("height","".concat(g,"px")),"".concat(v,"px")!==this.css("top")&&this.css("top","".concat(v,"px")),this.show()}break;case"l":var w=t.rect,m=n.fixedLeft,O=n.rows,E=m.getScrollViewRange(),S=this.coincide(w,E);if(!o.equals(S)){var x=O.sectionSumHeight(S.sri,S.eri),_=O.sectionSumHeight(E.sri,S.sri-1)+n.getFixedHeight()+r.height;"".concat(x,"px")!==this.css("height")&&this.css("height","".concat(x,"px")),"".concat(_,"px")!==this.css("top")&&this.css("top","".concat(_,"px")),this.show()}break;case"br":var k=t.rect,T=n.rows,C=n.getScrollViewRange(),P=this.coincide(k,C);if(!o.equals(P)){var A=T.sectionSumHeight(P.sri,P.eri),j=T.sectionSumHeight(C.sri,P.sri-1)+n.getFixedHeight()+r.height;"".concat(A,"px")!==this.css("height")&&this.css("height","".concat(A,"px")),"".concat(j,"px")!==this.css("top")&&this.css("top","".concat(j,"px")),this.show()}break;case"ltt":var L=t.rect,R=n.frozenLeftTop,W=n.rows,V=R.getScrollViewRange(),H=this.coincide(L,V);if(!o.equals(H)){var M=W.sectionSumHeight(V.sri,H.sri-1)+r.height,N=W.sectionSumHeight(H.sri,H.eri);"".concat(N,"px")!==this.css("height")&&this.css("height","".concat(N,"px")),"".concat(M,"px")!==this.css("top")&&this.css("top","".concat(M,"px")),this.show()}break;case"ltl":var D=t.rect,I=n.frozenLeftTop,B=n.fixedLeft,Y=n.rows,F=I.getScrollViewRange(),z=B.getScrollViewRange(),U=this.coincide(D,F),X=this.coincide(D,z),G=Y.sectionSumHeight(F.sri,U.sri-1)+r.height,K=0;o.equals(U)||(K+=Y.sectionSumHeight(U.sri,U.eri)),o.equals(X)||(K+=Y.sectionSumHeight(X.sri,X.eri)),"".concat(K,"px")!==this.css("height")&&this.css("height","".concat(K,"px")),"".concat(G,"px")!==this.css("top")&&this.css("top","".concat(G,"px")),this.show();break;case"tbr":var q=t.rect,$=n.fixedTop,Z=n.rows,J=$.getScrollViewRange(),Q=n.getScrollViewRange(),tt=this.coincide(q,J),et=this.coincide(q,Q),nt=Z.sectionSumHeight(J.sri,tt.sri-1)+r.height,rt=0;o.equals(tt)||(rt+=Z.sectionSumHeight(tt.sri,tt.eri)),o.equals(et)||(rt+=Z.sectionSumHeight(et.sri,et.eri)),"".concat(rt,"px")!==this.css("height")&&this.css("height","".concat(rt,"px")),"".concat(nt,"px")!==this.css("top")&&this.css("top","".concat(nt,"px")),this.show();break;case"lbr":var ot=t.rect,it=n.fixedLeft,ct=n.rows,lt=it.getScrollViewRange(),at=this.coincide(ot,lt);if(!o.equals(at)){var st=ct.sectionSumHeight(at.sri,at.eri),ut=ct.sectionSumHeight(lt.sri,at.sri-1)+n.getFixedHeight()+r.height;"".concat(st,"px")!==this.css("height")&&this.css("height","".concat(st,"px")),"".concat(ut,"px")!==this.css("top")&&this.css("top","".concat(ut,"px")),this.show()}break;case"lttlbr":var ft=t.rect,ht=n.frozenLeftTop,pt=n.fixedLeft,yt=n.rows,bt=ht.getScrollViewRange(),dt=pt.getScrollViewRange(),gt=this.coincide(ft,bt),vt=this.coincide(ft,dt),wt=0,mt=yt.sectionSumHeight(bt.sri,gt.sri-1)+r.height;o.equals(gt)||(wt+=yt.sectionSumHeight(gt.sri,gt.eri)),o.equals(vt)||(wt+=yt.sectionSumHeight(vt.sri,vt.eri)),"".concat(wt,"px")!==this.css("height")&&this.css("height","".concat(wt,"px")),"".concat(mt,"px")!==this.css("top")&&this.css("top","".concat(mt,"px")),this.show()}}},{key:"bind",value:function(){var t=this,e=this.table,n=e.screenSelector;n.on(rs.CHANGE,(function(){var e=n.selectorAttr;if(e){var r=n.getIntersectsArea(e);t.offsetHeightLight(e,r)}})),Wt.bind(e,r.SYSTEM_EVENT_TYPE.SCROLL,(function(){var e=n.selectorAttr;if(e){var r=n.getIntersectsArea(e);t.offsetHeightLight(e,r)}}))}}])&&Gf(n.prototype,i),c&&Gf(n,c),e}(R);function Jf(t){return(Jf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function th(t,e){return!e||"object"!==Jf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function eh(t){return(eh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nh(t,e){return(nh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rh=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=th(this,eh(e).call(this,"".concat(o,"-table-edit")))).input=T("div","".concat(o,"-table-edit-input")),n.input.attr("contenteditable",!0),n.input.html("<p>&nbsp;</p>"),n.table=t,n.text="",n.select=null,n.children(n.input),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nh(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind(),this.hide()}},{key:"bind",value:function(){var t=this,e=this.table,n=e.screenSelector;Wt.bind(this.input,r.SYSTEM_EVENT_TYPE.INPUT,(function(){var e=t.input;S.isBlank(t.input.text())&&e.html("<p>&nbsp;</p>"),t.text=e.text()})),Wt.bind(e,r.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.hideEdit()})),Wt.bind(e,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.hideEdit()})),Wt.dbClick([n.lt,n.t,n.l,n.br],(function(){t.showEdit()}))}},{key:"showEdit",value:function(){var t=this.table,e=this.input,n=t.screen,r=t.cells,o=n.findByClass(os).selectorAttr;if(o){var i=o.rect,c=r.getCellOrNew(i.sri,i.sci);this.select=i,this.editOffset(i),this.text=c.text,S.isBlank(this.text)?e.html("<p>&nbsp;</p>"):e.text(this.text),S.keepLastIndex(this.input.el)}}},{key:"hideEdit",value:function(){var t=this.select,e=this.table,n=e.cells,r=e.tableDataSnapshot,o=r.cellDataProxy;if(t){var i=n.getCellOrNew(t.sri,t.sci).clone(),c=S.trim(this.text);i.text!==c&&(r.begin(),i.text=c,o.setCell(t.sri,t.sci,i),r.end(),e.render()),this.select=null}this.hide()}},{key:"editOffset",value:function(){var t=this.table,e=t.screen.findByClass(os),n=e.selectorAttr,r=n.rect,o=t.cols,i=t.rows;switch(e.getIntersectsArea(n)){case"lt":var c=t.frozenLeftTop.getScrollViewRange(),l=r.coincide(c);if(new Ia(-1,-1,-1,-1).equals(l))return void this.hide();var a=o.sectionSumWidth(l.sci,l.eci)-6,s=i.sectionSumHeight(l.sri,l.eri)-6,u=i.sectionSumHeight(c.sri,l.sri-1),f=o.sectionSumWidth(c.sci,l.sci-1);u+=t.getIndexHeight()+3,f+=t.getIndexWidth()+3,this.offset({width:a,height:s,top:u,left:f}).show();break;case"t":var h=t.fixedTop.getScrollViewRange(),p=r.coincide(h);if(new Ia(-1,-1,-1,-1).equals(p))return void this.hide();var y=o.sectionSumWidth(p.sci,p.eci)-6,b=i.sectionSumHeight(p.sri,p.eri)-6,d=i.sectionSumHeight(h.sri,p.sri-1),g=o.sectionSumWidth(h.sci,p.sci-1);d+=t.getIndexHeight()+3,g+=t.getFixedWidth()+t.getIndexWidth()+3,this.offset({width:y,height:b,top:d,left:g}).show();break;case"br":var v=t.getScrollViewRange(),w=r.coincide(v);if(new Ia(-1,-1,-1,-1).equals(w))return void this.hide();var m=o.sectionSumWidth(w.sci,w.eci)-6,O=i.sectionSumHeight(w.sri,w.eri)-6,E=i.sectionSumHeight(v.sri,w.sri-1),S=o.sectionSumWidth(v.sci,w.sci-1);E+=t.getFixedHeight()+t.getIndexHeight()+3,S+=t.getFixedWidth()+t.getIndexWidth()+3,this.offset({width:m,height:O,top:E,left:S}).show();break;case"l":var x=t.fixedLeft.getScrollViewRange(),_=r.coincide(x);if(new Ia(-1,-1,-1,-1).equals(_))return void this.hide();var k=o.sectionSumWidth(_.sci,_.eci)-6,T=i.sectionSumHeight(_.sri,_.eri)-6,C=i.sectionSumHeight(x.sri,_.sri-1),P=o.sectionSumWidth(x.sci,_.sci-1);C+=t.getFixedHeight()+t.getIndexHeight()+3,P+=t.getIndexWidth()+3,this.offset({width:k,height:T,top:C,left:P}).show();break;case"ltt":var A=t.frozenLeftTop,j=t.fixedTop,L=A.getScrollViewRange(),R=r.coincide(L),W=j.getScrollViewRange(),V=r.coincide(W),H=new Ia(-1,-1,-1,-1);if(H.equals(V)&&H.equals(R))return void this.hide();var M=o.sectionSumWidth(R.sci,R.eci),N=i.sectionSumHeight(R.sri,R.eri),D=i.sectionSumHeight(L.sri,R.sri-1),I=o.sectionSumWidth(L.sci,R.sci-1),B=o.sectionSumWidth(V.sci,V.eci);this.offset({width:M+B-6,height:N-6,top:D+t.getIndexHeight()+3,left:I+t.getIndexWidth()+3}).show();break;case"ltl":var Y=t.frozenLeftTop,F=t.fixedLeft,z=Y.getScrollViewRange(),U=r.coincide(z),X=F.getScrollViewRange(),G=r.coincide(X),K=new Ia(-1,-1,-1,-1);if(K.equals(U)&&K.equals(G))return void this.hide();var q=o.sectionSumWidth(U.sci,U.eci),$=i.sectionSumHeight(U.sri,U.eri),Z=i.sectionSumHeight(G.sri,G.eri),J=i.sectionSumHeight(z.sri,U.sri-1),Q=o.sectionSumWidth(z.sci,U.sci-1);J+=t.getIndexHeight()+3,Q+=t.getIndexWidth()+3,this.offset({width:q-6,height:$+Z-6,top:J,left:Q}).show();break;case"tbr":var tt=t.fixedTop,et=t.getScrollViewRange(),nt=r.coincide(et),rt=tt.getScrollViewRange(),ot=r.coincide(rt),it=new Ia(-1,-1,-1,-1);if(it.equals(nt)&&it.equals(ot))return void this.hide();var ct=o.sectionSumWidth(ot.sci,ot.eci),lt=i.sectionSumHeight(ot.sri,ot.eri),at=i.sectionSumHeight(rt.sri,ot.sri-1),st=o.sectionSumWidth(rt.sci,ot.sci-1),ut=i.sectionSumHeight(nt.sri,nt.eri);this.offset({width:ct-6,height:ut+lt-6,top:at+t.getIndexHeight()+3,left:st+t.getFixedWidth()+t.getIndexWidth()+3}).show();break;case"lbr":var ft=t.fixedLeft,ht=t.getScrollViewRange(),pt=r.coincide(ht),yt=ft.getScrollViewRange(),bt=r.coincide(yt),dt=new Ia(-1,-1,-1,-1);if(dt.equals(pt)&&dt.equals(bt))return void this.hide();var gt=o.sectionSumWidth(bt.sci,bt.eci),vt=i.sectionSumHeight(bt.sri,bt.eri),wt=i.sectionSumHeight(yt.sri,bt.sri-1),mt=o.sectionSumWidth(yt.sci,bt.sci-1),Ot=o.sectionSumWidth(pt.sci,pt.eci);this.offset({width:gt+Ot-6,height:vt-6,top:wt+t.getFixedHeight()+t.getIndexHeight()+3,left:mt+t.getIndexWidth()+3}).show();break;case"lttlbr":var Et=t.frozenLeftTop.getScrollViewRange(),St=r.coincide(Et),xt=t.fixedTop.getScrollViewRange(),_t=r.coincide(xt),kt=t.fixedLeft.getScrollViewRange(),Tt=r.coincide(kt),Ct=new Ia(-1,-1,-1,-1);if(Ct.equals(St)&&Ct.equals(_t)&&Ct.equals(Tt))return void this.hide();var Pt=o.sectionSumWidth(St.sci,St.eci),At=i.sectionSumHeight(St.sri,St.eri),jt=o.sectionSumWidth(_t.sci,_t.eci),Lt=i.sectionSumHeight(Tt.sri,Tt.eri),Rt=i.sectionSumHeight(Et.sri,St.sri-1),Wt=o.sectionSumWidth(Et.sci,St.sci-1);this.offset({width:Pt+jt-6,height:At+Lt-6,top:Rt+t.getIndexHeight()+3,left:Wt+t.getIndexWidth()+3}).show()}}}])&&Qf(n.prototype,i),c&&Qf(n,c),e}(R);function oh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ih=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.draw=e,this.color="#000000",S.mergeDeep(this,n)}var e,n,r;return e=t,(n=[{key:"lineWidth",value:function(){var t=Math.floor(Ac());return t>2?t:1}},{key:"verticalLine",value:function(t,e,n,r){if(t!==n)throw new Error("coordinate errors sx should be equal to ex !!!");var o=this.draw,i=this.color,c=this.lineWidth();o.attr({fillStyle:i});var l=r-e;o.fillRect(t,e,c,l)}},{key:"horizontalLine",value:function(t,e,n,r){if(e!==r)throw new Error("coordinate errors sy should be equal to ey !!!");var o=this.draw,i=this.color,c=this.lineWidth();o.attr({fillStyle:i});var l=n-t;o.fillRect(t,e,l,c)}}])&&oh(e.prototype,n),r&&oh(e,r),t}();function ch(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var lh=function(){function t(e){var n=e.rect,r=e.draw;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.draw=r,this.rect=n,this.backgroundColor=null}var e,n,r;return e=t,(n=[{key:"drawBackgroundColor",value:function(t){if(t){this.backgroundColor=t;var e=this.draw,n=this.rect;e.attr({fillStyle:t}),e.fillRect(n.x,n.y,n.width,n.height)}}}])&&ch(e.prototype,n),r&&ch(e,r),t}();function ah(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var sh=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e}var e,n,r;return e=t,(n=[{key:"vLineRightOverFlowChecked",value:function(t,e){var n=this.table,r=n.cells,o=n.cols,i=n.merges,c=o.len,l=r.getMergeCellOrCell(e,t),a=r.getMergeCellOrCell(e,t+1);if(i.getFirstIncludes(e,t+1))return!0;var s=!0,u=!0;if(l&&!S.isBlank(l.text)){var f=l.fontAttr,h=!0;if(f.direction===Kc.ANGLE){var p=f.angle;90!==p&&-90!==p||(h=!1),f.textWrap===Gc.TRUNCATE&&(h=!1)}else f.textWrap!==Gc.OVER_FLOW&&(h=!1);var y=f.align,b=o.getWidth(t);y!==Uc.left&&y!==Uc.center&&(h=!1),h&&this.getCellContentWidth(l,t)>b&&(null===a||S.isBlank(a.text))&&(u=!1)}for(var d=o.getWidth(t-1)+o.getWidth(t),g=t-1;g>=0;g-=1,d+=o.getWidth(g)){var v=r.getCell(e,g);if(null!==v){var w=v.text;if(!S.isBlank(w)){var m=v.fontAttr;if(m.direction===Kc.ANGLE){var O=m.angle,E=m.textWrap;if(90===O||-90===O)break;if(E===Gc.TRUNCATE)break}else{if(m.textWrap!==Gc.OVER_FLOW)break;var x=m.align;if(x!==Uc.left&&x!==Uc.center)break}if(this.getCellContentWidth(v,g)>d){var _=null===l||S.isBlank(l.text),k=null===a||S.isBlank(a.text);_&&k&&(u=!1)}break}}}for(var T=o.getWidth(t+1),C=t+1;C<=c;C+=1,T+=o.getWidth(C)){var P=r.getCell(e,C);if(null!==P){var A=P.text;if(!S.isBlank(A)){var j=P.fontAttr;if(j.direction===Kc.ANGLE){var L=j.angle,R=j.textWrap;if(90===L||-90===L)break;if(R===Gc.TRUNCATE)break}else{if(j.textWrap!==Gc.OVER_FLOW)break;var W=j.align;if(W!==Uc.right&&W!==Uc.center)break}this.getCellContentWidth(P,C)>T&&(null===l||S.isBlank(l.text))&&(s=!1);break}}}return u&&s}},{key:"vLineLeftOverFlowChecked",value:function(t,e){var n=this.table,r=n.cells,o=n.cols,i=n.merges,c=o.len,l=r.getMergeCellOrCell(e,t),a=r.getMergeCellOrCell(e,t-1);if(i.getFirstIncludes(e,t-1))return!0;var s=!0,u=!0;if(l&&!S.isBlank(l.text)){var f=l.fontAttr,h=!0;if(f.direction===Kc.ANGLE){var p=f.angle;90!==p&&-90!==p||(h=!1),f.textWrap===Gc.TRUNCATE&&(h=!1)}else f.textWrap!==Gc.OVER_FLOW&&(h=!1);var y=f.align,b=o.getWidth(t);y!==Uc.right&&y!==Uc.center&&(h=!1),h&&this.getCellContentWidth(l,t)>b&&(null===a||S.isBlank(a.text))&&(u=!1)}for(var d=o.getWidth(t-1),g=t-1;g>=0;g-=1,d+=o.getWidth(g)){var v=r.getCell(e,g);if(null!==v){var w=v.text;if(!S.isBlank(w)){var m=v.fontAttr;if(m.direction===Kc.ANGLE){var O=m.angle,E=m.textWrap;if(90===O||-90===O)break;if(E===Gc.TRUNCATE)break}else{if(m.textWrap!==Gc.OVER_FLOW)break;var x=m.align;if(x!==Uc.left&&x!==Uc.center)break}this.getCellContentWidth(v,g)>d&&(null===l||S.isBlank(l.text))&&(u=!1);break}}}for(var _=o.getWidth(t+1)+o.getWidth(t),k=t+1;k<=c;k+=1,_+=o.getWidth(k)){var T=r.getCell(e,k);if(null!==T){var C=T.text;if(!S.isBlank(C)){var P=T.fontAttr;if(P.direction===Kc.ANGLE){var A=P.angle,j=P.textWrap;if(90===A||-90===A)break;if(j===Gc.TRUNCATE)break}else{if(P.textWrap!==Gc.OVER_FLOW)break;var L=P.align;if(L!==Uc.right&&L!==Uc.center)break}if(this.getCellContentWidth(T,k)>_){var R=null===l||S.isBlank(l.text),W=null===a||S.isBlank(a.text);R&&W&&(s=!1)}break}}}return u&&s}},{key:"getCellContentWidth",value:function(t,e){var n=this.table.cols.getWidth(e),r=t.contentWidth;switch(t.fontAttr.align){case Uc.right:case Uc.left:return r;case Uc.center:return n+(r-n)/2;default:return 0}}},{key:"hEach",value:function(t){for(var e=t.viewRange,n=void 0===e?new Ia(0,0,0,0):e,r=t.newRow,o=void 0===r?function(){return!0}:r,i=t.filter,c=void 0===i?function(){return!0}:i,l=t.jump,a=void 0===l?function(){return!0}:l,s=t.handle,u=void 0===s?function(){return!0}:s,f=t.endRow,h=void 0===f?function(){return!0}:f,p=t.bx,y=void 0===p?0:p,b=t.by,d=void 0===b?0:b,g=this.table,v=g.cols,w=g.rows,m=n.sri,O=n.eri,E=n.sci,S=n.eci,x=d,_=m;_<=O;_+=1){var k=w.getHeight(_),T=y;o(_,x);for(var C=E;C<=S;C+=1){var P=v.getWidth(C);c(_,C,T,x)?u(_,C,T,x):a(_,C,T,x),T+=P}h(),x+=k}}},{key:"vEach",value:function(t){for(var e=t.viewRange,n=void 0===e?new Ia(0,0,0,0):e,r=t.newCol,o=void 0===r?function(){return!0}:r,i=t.filter,c=void 0===i?function(){return!0}:i,l=t.jump,a=void 0===l?function(){return!0}:l,s=t.handle,u=void 0===s?function(){return!0}:s,f=t.endCol,h=void 0===f?function(){return!0}:f,p=t.bx,y=void 0===p?0:p,b=t.by,d=void 0===b?0:b,g=this.table,v=g.cols,w=g.rows,m=n.sri,O=n.eri,E=n.sci,S=n.eci,x=y,_=E;_<=S;_+=1){var k=v.getWidth(_),T=d;o(_,x);for(var C=m;C<=O;C+=1){var P=w.getHeight(C);c(_,C,x,T)?u(_,C,x,T):a(_,C,x,T),T+=P}h(),x+=k}}},{key:"viewRangeAndMergeCoincideView",value:function(t){var e=t.viewRange,n=void 0===e?new Ia(0,0,0,0):e,r=this.table,o=r.merges,i=r.cols,c=r.rows,l=[],a=[];return this.hEach({viewRange:n,handle:function(t,e,r,s){var u=o.getFirstIncludes(t,e);if(u&&-1===l.indexOf(u)){l.push(u);var f=n.coincide(u),h=i.sectionSumWidth(f.sci,f.eci),p=c.sectionSumHeight(f.sri,f.eri),y=new Vc({x:r,y:s,width:h,height:p});a.push({rect:y,view:f,merge:u})}}}),a}},{key:"coincideViewBrink",value:function(t){for(var e=t.coincideView,n=this.table,r=n.cols,o=n.rows,i=[],c=0;c<e.length;c+=1){var l=e[c],a=l.view,s=l.rect,u=l.merge,f=a.brink(),h={view:f.top,x:s.x,y:s.y},p={view:f.left,x:s.x,y:s.y},y={view:f.bottom,x:s.x,y:s.y+s.height-o.rectRangeSumHeight(f.bottom)},b={view:f.right,x:s.x+s.width-r.rectRangeSumWidth(f.right),y:s.y},d={};u.sri===a.sri&&(d.top=h),u.sci===a.sci&&(d.left=p),u.eri===a.eri&&(d.bottom=y),u.eci===a.eci&&(d.right=b),i.push(d)}return i}}])&&ah(e.prototype,n),r&&ah(e,r),t}();function uh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var fh=function(){function t(e){var n=e.table,r=e.cols,o=e.rows,i=e.data,c=void 0===i?[]:i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=n,this.cols=r,this.rows=o,this.data=c}var e,n,r;return e=t,(n=[{key:"getCell",value:function(t,e){var n=this.data[t];if(n&&n[e]){var r=n[e];return r instanceof hs?n[e]:(S.isString(r)&&(r={text:r}),n[e]=new hs(r),n[e])}return null}},{key:"getMergeCellOrCell",value:function(t,e){var n=this.table.merges.getFirstIncludes(t,e);return n?this.getCell(n.sri,n.sci):this.getCell(t,e)}},{key:"getCellOrNew",value:function(t,e){return S.isUnDef(this.data[t])&&(this.data[t]=[]),S.isUnDef(this.data[t][e])&&(this.data[t][e]={text:""}),this.getCell(t,e)}},{key:"setCell",value:function(t,e,n){var r=this.data[t];r&&r[e]&&(r[e]=n)}},{key:"setCellOrNew",value:function(t,e,n){S.isUnDef(this.data[t])&&(this.data[t]=[]),this.data[t][e]=n}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.data=t,this}}])&&uh(e.prototype,n),r&&uh(e,r),t}();function hh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ph=function(){function t(e){var n=e.cells,r=e.merges,o=e.rows,i=e.cols;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cells=n,this.merges=r,this.rows=o,this.cols=i}var e,n,r;return e=t,(n=[{key:"getCellTextMaxHeight",value:function(t,e){var n=this.cells,r=this.rows,o=n.getCell(t,e).fontAttr.verticalAlign,i=0,c=0;if(o===Xc.top)for(var l=t,a=r.len;l<=a;l+=1){var s=n.getCell(l,e);if(l===e)i+=r.getHeight(l);else{if(!S.isUnDef(s)&&!S.isBlank(s.text))break;i+=r.getHeight(l)}}if(o===Xc.center){for(var u=t,f=r.len;u<=f;u+=1){var h=n.getCell(u,e);if(u===e)i+=r.getHeight(u);else{if(!S.isUnDef(h)&&!S.isBlank(h.text))break;i+=r.getHeight(u)}}for(var p=t-1;p>=0;p-=1){var y=n.getCell(t,p);if(!S.isUnDef(y)&&!S.isBlank(y.text))break;var b=r.getHeight(p);i+=b,c-=b}}if(o===Xc.bottom)for(var d=t;d>=0;d-=1){var g=n.getCell(t,d);if(d===e)i+=r.getHeight(d);else{if(!S.isUnDef(g)&&!S.isBlank(g.text))break;var v=r.getHeight(d);i+=v,c-=v}}return{height:i,offset:c}}},{key:"getCellTextMaxWidth",value:function(t,e){var n=this.cells,r=this.cols,o=this.merges,i=n.getCell(t,e).fontAttr.align,c=0,l=0;if(i===Uc.left)for(var a=e,s=r.len;a<=s;a+=1){var u=n.getCell(t,a),f=o.getFirstIncludes(t,a);if(a===e)c+=r.getWidth(a);else{if(!S.isUnDef(u)&&!S.isBlank(u.text)||!S.isUnDef(f))break;c+=r.getWidth(a)}}if(i===Uc.center){for(var h=0,p=0,y=e+1,b=r.len;y<=b;y+=1){var d=n.getCell(t,y),g=o.getFirstIncludes(t,y);if(!S.isUnDef(d)&&!S.isBlank(d.text)||!S.isUnDef(g))break;h+=r.getWidth(y)}for(var v=e-1;v>=0;v-=1){var w=n.getCell(t,v),m=o.getFirstIncludes(t,v);if(!S.isUnDef(w)&&!S.isBlank(w.text)||!S.isUnDef(m))break;var O=r.getWidth(v);p+=O,l-=O}c=r.getWidth(e)+p+h}if(i===Uc.right)for(var E=e;E>=0;E-=1){var x=n.getCell(t,E),_=o.getFirstIncludes(t,E);if(E===e)c+=r.getWidth(E);else{if(!S.isUnDef(x)&&!S.isBlank(x.text)||!S.isUnDef(_))break;var k=r.getWidth(E);c+=k,l-=k}}return{width:c,offset:l}}},{key:"getCellOverFlow",value:function(t,e,n,r){var o=r.fontAttr,i=o.direction,c=o.textWrap,l=n.x,a=n.y,s=n.width,u=n.height;if(c===Gc.OVER_FLOW){if(i===Kc.VERTICAL){var f=this.getCellTextMaxHeight(t,e);return new Vc({x:l,y:a+f.offset,width:s,height:f.height})}var h=this.getCellTextMaxWidth(t,e);return new Vc({x:l+h.offset,y:a,width:h.width,height:u})}return null}},{key:"getCellByViewRange",value:function(t){for(var e=t.rectRange,n=t.callback,r=t.startX,o=void 0===r?0:r,i=t.startY,c=void 0===i?0:i,l=this.rows,a=this.cols,s=this.cells,u=e.sri,f=e.eri,h=e.sci,p=e.eci,y=c,b=u;b<=f;b+=1){for(var d=l.getHeight(b),g=o,v=h;v<=p;v+=1){var w=a.getWidth(v),m=s.getCell(b,v);if(m){var O=new Vc({x:g,y:y,width:w,height:d});if(!1===n(b,v,m,O,this.getCellOverFlow(b,v,O,m)))return}g+=w}y+=d}}},{key:"getCellOrNewCellByViewRange",value:function(t){for(var e=t.rectRange,n=t.callback,r=t.startX,o=void 0===r?0:r,i=t.startY,c=void 0===i?0:i,l=this.rows,a=this.cols,s=this.cells,u=e.sri,f=e.eri,h=e.sci,p=e.eci,y=c,b=u;b<=f;b+=1){for(var d=l.getHeight(b),g=o,v=h;v<=p;v+=1){var w=a.getWidth(v),m=s.getCellOrNew(b,v),O=new Vc({x:g,y:y,width:w,height:d});if(!1===n(b,v,m,O,this.getCellOverFlow(b,v,O,m)))return;g+=w}y+=d}}},{key:"getMergeCellByViewRange",value:function(t){for(var e=t.rectRange,n=t.callback,r=t.startX,o=void 0===r?0:r,i=t.startY,c=void 0===i?0:i,l=this.rows,a=this.cols,s=this.cells,u=this.merges,f=e.sri,h=e.eri,p=e.sci,y=e.eci,b=[],d=f;d<=h;d+=1)for(var g=function(t){var r=u.getFirstIncludes(d,t);if(r&&!b.find((function(t){return t===r}))){b.push(r);var i=s.getCellOrNew(r.sri,r.sci),f=a.sectionSumWidth(r.sci,r.eci),h=l.sectionSumHeight(r.sri,r.eri),p=Math.min(e.sri,r.sri),y=Math.min(e.sci,r.sci),g=Math.max(e.sri,r.sri),v=Math.max(e.sci,r.sci);g-=1,v-=1;var w=a.sectionSumWidth(y,v),m=l.sectionSumHeight(p,g);w=e.sci>r.sci?-1*w:w,m=e.sri>r.sri?-1*m:m;var O=new Vc({x:w+=o,y:m+=c,width:f,height:h});n(O,i)}},v=p;v<=y;v+=1)g(v)}},{key:"getCellSkipMergeCellByViewRange",value:function(t){var e=t.rectRange,n=t.callback,r=t.startX,o=void 0===r?0:r,i=t.startY,c=void 0===i?0:i,l=this.merges;this.getCellByViewRange({rectRange:e,callback:function(t,e,r,o,i){null===l.getFirstIncludes(t,e)&&n(t,e,r,o,i)},startX:o,startY:c})}}])&&hh(e.prototype,n),r&&hh(e,r),t}();function yh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var bh=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e}var e,n,r;return e=t,(n=[{key:"vLineBorderChecked",value:function(t,e){var n=this.table.cells,r=n.getMergeCellOrCell(e,t),o=n.getMergeCellOrCell(e,t+1);return r&&o?!(r.borderAttr.right.display||o.borderAttr.left.display):r?!r.borderAttr.right.display:!o||!o.borderAttr.left.display}},{key:"hLineBorderChecked",value:function(t,e){var n=this.table.cells,r=n.getMergeCellOrCell(t,e),o=n.getMergeCellOrCell(t+1,e);return r&&o?!(r.borderAttr.bottom.display||o.borderAttr.top.display):r?!r.borderAttr.bottom.display:!o||!o.borderAttr.top.display}},{key:"gridHLine",value:function(t){var e,n,r,o,i,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},s=this.table,u=s.lineHandle,f=s.cols,h=s.rows,p=[];return u.hEach({viewRange:t,newRow:function(t,a){var s=h.getHeight(t);r=e=c,o=n=l+a+s,i=!1},filter:a,jump:function(t,c){i&&(i=!1,p.push({sx:e,sy:n,ex:r,ey:o}));var l=f.getWidth(c);r=e=r+l},handle:function(t,e){i=!0;var n=f.getWidth(e);r+=n},endRow:function(){i&&p.push({sx:e,sy:n,ex:r,ey:o})}}),p}},{key:"gridVLine",value:function(t){var e,n,r,o,i,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},s=this.table,u=s.lineHandle,f=s.cols,h=s.rows,p=[];return u.vEach({viewRange:t,newCol:function(t,a){var s=f.getWidth(t);r=e=c+a+s,o=n=l,i=!1},filter:a,jump:function(t,c){i&&(i=!1,p.push({sx:e,sy:n,ex:r,ey:o}));var l=h.getHeight(c);o=n=o+l},handle:function(t,e){i=!0;var n=h.getHeight(e);o+=n},endCol:function(){i&&p.push({sx:e,sy:n,ex:r,ey:o})}}),p}},{key:"hLine",value:function(t){var e=this,n=this.table.merges;return this.gridHLine(t,0,0,(function(t,r){return!n.getFirstIncludes(t,r)&&e.hLineBorderChecked(t,r)}))}},{key:"vLine",value:function(t){var e=this,n=this.table,r=n.merges,o=n.lineHandle;return this.gridVLine(t,0,0,(function(t,n){return!r.getFirstIncludes(n,t)&&!1!==e.vLineBorderChecked(t,n)&&o.vLineRightOverFlowChecked(t,n)}))}},{key:"hMergeLine",value:function(t){for(var e=this,n=[],r=0;r<t.length;r+=1){var o=t[r].bottom;if(o){var i=o.view,c=o.x,l=o.y,a=this.gridHLine(i,c,l,(function(t,n){return e.hLineBorderChecked(t,n)}));n=n.concat(a)}}return n}},{key:"vMergeLine",value:function(t){for(var e=this,n=[],r=0;r<t.length;r+=1){var o=t[r].right;if(o){var i=o.view,c=o.x,l=o.y,a=this.gridVLine(i,c,l,(function(t,n){return e.vLineBorderChecked(t,n)}));n=n.concat(a)}}return n}}])&&yh(e.prototype,n),r&&yh(e,r),t}();function dh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var gh=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.drawOptimization=!0,this.borderOptimization=!0}var e,n,r;return e=t,(n=[{key:"borderHTLine",value:function(t){var e,n,r,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},a=this.table,s=this.drawOptimization,u=a.lineHandle,f=a.cols,h=a.cells,p=[];if(u.hEach({viewRange:t,newRow:function(t,l){r=e=i,o=n=c+l},filter:l,jump:function(t,n){var o=f.getWidth(n);r=e=r+o},handle:function(t,i){var c=f.getWidth(i),l=h.getCell(t,i).borderAttr;r+=c,p.push({sx:e,sy:n,ex:r,ey:o,row:t,col:i,borderAttr:l}),e=r}}),s)for(var y=1;y<p.length;){var b=p[y],d=p[y-1],g=b.borderAttr.top.equal(d.borderAttr.top),v=b.col-d.col==1,w=b.row===d.row;g&&v&&w?(d.ex=b.ex,d.col=b.col,p.splice(y,1)):y+=1}return p}},{key:"borderHBLine",value:function(t){var e,n,r,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},a=this.table,s=this.drawOptimization,u=a.lineHandle,f=a.cols,h=a.rows,p=a.cells,y=[];if(u.hEach({viewRange:t,newRow:function(t,l){var a=h.getHeight(t);r=e=i,o=n=c+l+a},filter:l,jump:function(t,n){var o=f.getWidth(n);r=e=r+o},handle:function(t,i){var c=f.getWidth(i),l=p.getCell(t,i).borderAttr;r+=c,y.push({sx:e,sy:n,ex:r,ey:o,row:t,col:i,borderAttr:l}),e=r}}),s)for(var b=1;b<y.length;){var d=y[b],g=y[b-1],v=d.borderAttr.bottom.equal(g.borderAttr.bottom),w=d.col-g.col==1,m=d.row===g.row;v&&w&&m?(g.ex=d.ex,g.col=d.col,y.splice(b,1)):b+=1}return y}},{key:"borderVLLine",value:function(t){var e,n,r,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},a=this.table,s=this.drawOptimization,u=a.lineHandle,f=a.rows,h=a.cells,p=[];if(u.vEach({viewRange:t,newCol:function(t,l){r=e=i+l,o=n=c},filter:l,jump:function(t,e){var r=f.getHeight(e);o=n=o+r},handle:function(t,i){var c=f.getHeight(i),l=h.getCell(i,t).borderAttr;o+=c,p.push({sx:e,sy:n,ex:r,ey:o,row:i,col:t,borderAttr:l}),n=o}}),s)for(var y=1;y<p.length;){var b=p[y],d=p[y-1],g=b.borderAttr.left.equal(d.borderAttr.left),v=b.row-d.row==1,w=b.col===d.col;g&&v&&w?(d.ey=b.ey,d.row=b.row,p.splice(y,1)):y+=1}return p}},{key:"borderVRLine",value:function(t){var e,n,r,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},a=this.table,s=this.drawOptimization,u=a.lineHandle,f=a.rows,h=a.cols,p=a.cells,y=[];if(u.vEach({viewRange:t,newCol:function(t,l){var a=h.getWidth(t);r=e=i+l+a,o=n=c},filter:l,jump:function(t,e){var r=f.getHeight(e);o=n=o+r},handle:function(t,i){var c=f.getHeight(i),l=p.getCell(i,t).borderAttr;o+=c,y.push({sx:e,sy:n,ex:r,ey:o,row:i,col:t,borderAttr:l}),n=o}}),s)for(var b=1;b<y.length;){var d=y[b],g=y[b-1],v=d.borderAttr.right.equal(g.borderAttr.right),w=d.row-g.row==1,m=d.col===g.col;v&&w&&m?(g.ey=d.ey,g.row=d.row,y.splice(b,1)):b+=1}return y}},{key:"htLine",value:function(t){var e=this.table,n=this.borderOptimization,r=e.merges,o=e.cells;return this.borderHTLine(t,0,0,(function(t,e){var i=r.getFirstIncludes(t,e),c=o.getMergeCellOrCell(t,e),l=o.getMergeCellOrCell(t-1,e);if(!c||i)return!1;if(l&&n){var a=c.borderAttr.top.display&&l.borderAttr.bottom.display,s=c.borderAttr.top.compareTime(l.borderAttr.bottom);if(a)return 1===s}return c.borderAttr.top.display}))}},{key:"hbLine",value:function(t){var e=this.table,n=this.borderOptimization,r=e.merges,o=e.cells;return this.borderHBLine(t,0,0,(function(t,e){var i=r.getFirstIncludes(t,e),c=o.getMergeCellOrCell(t,e),l=o.getMergeCellOrCell(t+1,e);if(!c||i)return!1;if(l&&n){var a=c.borderAttr.bottom.display&&l.borderAttr.top.display,s=c.borderAttr.bottom.compareTime(l.borderAttr.top);if(a)return 1===s||0===s}return c.borderAttr.bottom.display}))}},{key:"vlLine",value:function(t){var e=this.table,n=this.borderOptimization,r=e.merges,o=e.cells,i=e.lineHandle;return this.borderVLLine(t,0,0,(function(t,e){var c=r.getFirstIncludes(e,t),l=o.getMergeCellOrCell(e,t),a=o.getMergeCellOrCell(e,t-1);return!(!l||c)&&(a&&n&&l.borderAttr.left.display&&a.borderAttr.right.display?!(1!==l.borderAttr.left.compareTime(a.borderAttr.right))&&i.vLineLeftOverFlowChecked(t,e):l.borderAttr.left.display?i.vLineLeftOverFlowChecked(t,e):l.borderAttr.left.display)}))}},{key:"vrLine",value:function(t){var e=this.table,n=this.borderOptimization,r=e.merges,o=e.cells,i=e.lineHandle;return this.borderVRLine(t,0,0,(function(t,e){var c=r.getFirstIncludes(e,t),l=o.getMergeCellOrCell(e,t),a=o.getMergeCellOrCell(e,t+1);if(!l||c)return!1;if(a&&n&&l.borderAttr.right.display&&a.borderAttr.left.display){var s=l.borderAttr.right.compareTime(a.borderAttr.left);return!(1!==s&&0!==s)&&i.vLineRightOverFlowChecked(t,e)}return l.borderAttr.right.display?i.vLineRightOverFlowChecked(t,e):l.borderAttr.right.display}))}},{key:"htMergeLine",value:function(t){for(var e=this.table,n=this.borderOptimization,r=e.cells,o=[],i=0;i<t.length;i+=1){var c=t[i].top;if(c){var l=this.borderHTLine(c.view,c.x,c.y,(function(t,e){var o=r.getCell(t,e),i=r.getCell(t-1,e);if(!o)return!1;if(i&&n){var c=o.borderAttr.top.display&&i.borderAttr.bottom.display,l=o.borderAttr.top.compareTime(i.borderAttr.bottom);if(c)return 1===l}return o.borderAttr.top.display}));o=o.concat(l)}}return o}},{key:"hbMergeLine",value:function(t){for(var e=this.table,n=this.borderOptimization,r=e.cells,o=[],i=0;i<t.length;i+=1){var c=t[i].bottom;if(c){var l=this.borderHBLine(c.view,c.x,c.y,(function(t,e){var o=r.getCell(t,e),i=r.getCell(t+1,e);if(!o)return!1;if(i&&n){var c=o.borderAttr.bottom.display&&i.borderAttr.top.display,l=o.borderAttr.bottom.compareTime(i.borderAttr.top);if(c)return 1===l||0===l}return o.borderAttr.bottom.display}));o=o.concat(l)}}return o}},{key:"vlMergeLine",value:function(t){for(var e=this.table,n=this.borderOptimization,r=e.cells,o=[],i=0;i<t.length;i+=1){var c=t[i].left;if(c){var l=this.borderVLLine(c.view,c.x,c.y,(function(t,e){var o=r.getCell(e,t),i=r.getCell(e,t-1);if(!o)return!1;if(i&&n){var c=o.borderAttr.left.display&&i.borderAttr.right.display,l=o.borderAttr.left.compareTime(i.borderAttr.right);if(c)return 1===l}return o.borderAttr.left.display}));o=o.concat(l)}}return o}},{key:"vrMergeLine",value:function(t){for(var e=this.table,n=this.borderOptimization,r=e.cells,o=[],i=0;i<t.length;i+=1){var c=t[i].right;if(c){var l=this.borderVRLine(c.view,c.x,c.y,(function(t,e){var o=r.getCell(e,t),i=r.getCell(e,t+1);if(!o)return!1;if(i&&n){var c=o.borderAttr.right.display&&i.borderAttr.left.display,l=o.borderAttr.right.compareTime(i.borderAttr.left);if(c)return 1===l||0===l}return o.borderAttr.right.display}));o=o.concat(l)}}return o}},{key:"openDrawOptimization",value:function(){this.drawOptimization=!0}},{key:"closeDrawOptimization",value:function(){this.drawOptimization=!1}},{key:"openBorderOptimization",value:function(){this.borderOptimization=!0}},{key:"closeBorderOptimization",value:function(){this.borderOptimization=!1}}])&&dh(e.prototype,n),r&&dh(e,r),t}();function vh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var wh=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.change=!1}var e,n,r;return e=t,(n=[{key:"endNotice",value:function(){this.change&&(this.change=!1)}},{key:"backNotice",value:function(){this.change&&(this.change=!1)}},{key:"goNotice",value:function(){this.change&&(this.change=!1)}}])&&vh(e.prototype,n),r&&vh(e,r),t}();function mh(t){return(mh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Eh(t,e){return!e||"object"!==mh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sh(t,e,n){return(Sh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=xh(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function xh(t){return(xh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _h(t,e){return(_h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kh=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{setCell:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Eh(this,xh(e).call(this))).table=t,n.option=r,n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_h(t,e)}(e,t),n=e,(o=[{key:"$setCell",value:function(t,e,n){this.change=!0,this.table.cells.setCellOrNew(t,e,n)}},{key:"setCell",value:function(t,e,n){var r=this.option,o=this.table,i=r.on.setCell;i(t,e,o.cells.getCell(t,e),n),this.$setCell(t,e,n)}},{key:"endNotice",value:function(){var t=this.table;this.change&&t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),Sh(xh(e.prototype),"endNotice",this).call(this)}},{key:"goNotice",value:function(){var t=this.table;this.change&&t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),Sh(xh(e.prototype),"goNotice",this).call(this)}},{key:"backNotice",value:function(){var t=this.table;this.change&&t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),Sh(xh(e.prototype),"backNotice",this).call(this)}}])&&Oh(n.prototype,o),i&&Oh(n,i),e}(wh);var Th=function t(e){var n=e.ri,r=e.ci,o=e.oldCell,i=e.newCell;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ri=n,this.ci=r,this.oldCell=o,this.newCell=i};var Ch={ADD:Symbol("添加一个合并单元格"),DELETE:Symbol("删除一个合并单元格")},Ph=function t(e){var n=e.merge,r=e.recordType;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.merge=n,this.recordType=r};function Ah(t){return(Ah="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Lh(t,e){return!e||"object"!==Ah(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rh(t){return(Rh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wh(t,e){return(Wh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vh=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{addMerge:function(){},deleteMerge:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Lh(this,Rh(e).call(this))).table=t,n.option=r,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wh(t,e)}(e,t),n=e,(r=[{key:"$addMerge",value:function(t){this.change=!0,this.table.merges.add(t)}},{key:"$deleteMerge",value:function(t){this.change=!0,this.table.merges.deleteIntersects(t)}},{key:"deleteMerge",value:function(t){var e=this.option.on.deleteMerge;e(t),this.$deleteMerge(t)}},{key:"addMerge",value:function(t){var e=this.option.on.addMerge;e(t),this.$addMerge(t)}}])&&jh(n.prototype,r),o&&jh(n,o),e}(wh);function Hh(t){return(Hh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Nh(t,e){return!e||"object"!==Hh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dh(t,e,n){return(Dh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ih(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Ih(t){return(Ih=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bh(t,e){return(Bh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yh=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{setWidth:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Nh(this,Ih(e).call(this))).table=t,n.option=r,n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bh(t,e)}(e,t),n=e,(o=[{key:"$setWidth",value:function(t,e){this.change=!0,this.table.cols.setWidth(t,e)}},{key:"setWidth",value:function(t,e){var n=this.option,r=this.table,o=n.on.setWidth;o(t,r.cols.getWidth(t),e),this.$setWidth(t,e)}},{key:"endNotice",value:function(){var t=this.table;this.change&&(t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(r.TABLE_EVENT_TYPE.CHANGE_WIDTH)),Dh(Ih(e.prototype),"endNotice",this).call(this)}},{key:"backNotice",value:function(){var t=this.table;this.change&&(t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(r.TABLE_EVENT_TYPE.CHANGE_WIDTH)),Dh(Ih(e.prototype),"backNotice",this).call(this)}},{key:"goNotice",value:function(){var t=this.table;this.change&&(t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(r.TABLE_EVENT_TYPE.CHANGE_WIDTH)),Dh(Ih(e.prototype),"goNotice",this).call(this)}}])&&Mh(n.prototype,o),i&&Mh(n,i),e}(wh);var Fh=function t(e){var n=e.ci,r=e.oldWidth,o=e.newWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ci=n,this.oldWidth=r,this.newWidth=o};function zh(t){return(zh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xh(t,e){return!e||"object"!==zh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gh(t,e,n){return(Gh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Kh(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Kh(t){return(Kh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qh(t,e){return(qh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $h=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{setHeight:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Xh(this,Kh(e).call(this))).table=t,n.option=r,n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qh(t,e)}(e,t),n=e,(o=[{key:"$setHeight",value:function(t,e){this.change=!0,this.table.rows.setHeight(t,e)}},{key:"setHeight",value:function(t,e){var n=this.option,r=this.table,o=n.on.setHeight;o(t,r.rows.getHeight(t),e),this.$setHeight(t,e)}},{key:"endNotice",value:function(){var t=this.table;this.change&&(t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(r.TABLE_EVENT_TYPE.CHANGE_HEIGHT)),Gh(Kh(e.prototype),"endNotice",this).call(this)}},{key:"backNotice",value:function(){var t=this.table;this.change&&(t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(r.TABLE_EVENT_TYPE.CHANGE_HEIGHT)),Gh(Kh(e.prototype),"backNotice",this).call(this)}},{key:"goNotice",value:function(){var t=this.table;this.change&&(t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(r.TABLE_EVENT_TYPE.CHANGE_HEIGHT)),Gh(Kh(e.prototype),"goNotice",this).call(this)}}])&&Uh(n.prototype,o),i&&Uh(n,i),e}(wh);var Zh=function t(e){var n=e.ri,r=e.oldHeight,o=e.newHeight;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ri=n,this.oldHeight=r,this.newHeight=o};function Jh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Qh=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.record=!1,this.backLayerStack=[],this.goLayerStack=[],this.recordLayer=[],this.table=e,this.mergeDataProxy=new Vh(e,{on:{addMerge:function(t){!1!==n.record&&n.recordLayer.push(new Ph({merge:t,recordType:Ch.ADD}))},deleteMerge:function(t){!1!==n.record&&n.recordLayer.push(new Ph({merge:t,recordType:Ch.DELETE}))}}}),this.cellDataProxy=new kh(e,{on:{setCell:function(t,e,r,o){!1!==n.record&&n.recordLayer.push(new Th({ri:t,ci:e,oldCell:r,newCell:o}))}}}),this.colsDataProxy=new Yh(e,{on:{setWidth:function(t,e,r){!1!==n.record&&n.recordLayer.push(new Fh({ci:t,oldWidth:e,newWidth:r}))}}}),this.rowsDataProxy=new $h(e,{on:{setHeight:function(t,e,r){!1!==n.record&&n.recordLayer.push(new Zh({ri:t,oldHeight:e,newHeight:r}))}}})}var e,n,r;return e=t,(n=[{key:"back",value:function(){for(var t=this.backLayerStack,e=this.goLayerStack,n=this.table,r=t.pop(),o=0,i=r.length;o<i;o+=1){var c=r[o];if(c instanceof Th){var l=c.ri,a=c.ci,s=c.oldCell;this.cellDataProxy.$setCell(l,a,s)}else if(c instanceof Ph){var u=c.merge;switch(c.recordType){case Ch.ADD:this.mergeDataProxy.$addMerge(u);break;case Ch.DELETE:this.mergeDataProxy.$deleteMerge(u)}}else if(c instanceof Fh){var f=c.ci,h=c.oldWidth;this.colsDataProxy.$setWidth(f,h)}else if(c instanceof Zh){var p=c.ri,y=c.oldHeight;this.rowsDataProxy.$setHeight(p,y)}}e.push(r),this.mergeDataProxy.backNotice(),this.cellDataProxy.backNotice(),this.colsDataProxy.backNotice(),this.rowsDataProxy.backNotice(),n.render()}},{key:"go",value:function(){for(var t=this.backLayerStack,e=this.goLayerStack,n=this.table,r=e.pop(),o=0,i=r.length;o<i;o+=1){var c=r[o];if(c instanceof Th){var l=c.ri,a=c.ci,s=c.newCell;this.cellDataProxy.$setCell(l,a,s)}else if(c instanceof Ph){var u=c.merge;switch(c.recordType){case Ch.ADD:this.mergeDataProxy.$addMerge(u);break;case Ch.DELETE:this.mergeDataProxy.$deleteMerge(u)}}else if(c instanceof Fh){var f=c.ci,h=c.newWidth;this.colsDataProxy.$setWidth(f,h)}else if(c instanceof Zh){var p=c.ri,y=c.newHeight;this.rowsDataProxy.$setHeight(p,y)}}t.push(r),this.mergeDataProxy.goNotice(),this.cellDataProxy.goNotice(),this.colsDataProxy.goNotice(),this.rowsDataProxy.goNotice(),n.render()}},{key:"end",value:function(){var t=this.recordLayer,e=this.backLayerStack;this.record=!1,t.length&&e.push(t),this.recordLayer=[],this.mergeDataProxy.endNotice(),this.cellDataProxy.endNotice(),this.colsDataProxy.endNotice(),this.rowsDataProxy.endNotice()}},{key:"begin",value:function(){this.record=!0,this.goLayerStack=[]}},{key:"canBack",value:function(){return 0!==this.backLayerStack.length}},{key:"canGo",value:function(){return 0!==this.goLayerStack.length}}])&&Jh(e.prototype,n),r&&Jh(e,r),t}(),tp=n(0),ep=n.n(tp),np=n(1),rp=n.n(np),op=n(2),ip=n.n(op);function cp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var lp=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.lock=null}var e,n,r;return e=t,(n=[{key:"on",value:function(t){null===this.lock&&(this.lock=t)}},{key:"set",value:function(t,e){if(!this.lock||e===this.lock){var n=this.table;switch(t){case"cell":n.css("cursor","url(".concat(ep.a,") 7.5 7.5,auto"));break;case"s-resize":n.css("cursor","url(".concat(rp.a,") 2.5 7.5,auto"));break;case"e-resize":n.css("cursor","url(".concat(ip.a,") 7.5 2.5,auto"));break;default:n.css("cursor",t)}}}},{key:"off",value:function(t){this.lock===t&&(this.lock=null)}}])&&cp(e.prototype,n),r&&cp(e,r),t}();function ap(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var sp=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.bind()}var e,n,o;return e=t,(n=[{key:"register",value:function(t){var e=t.el,n=t.attr,r=void 0===n?{}:n,o=t.stop,i=void 0===o||o,c=t.focus,l=void 0!==c&&c;this.table.focus.register({el:e,attr:r,stop:i,focus:l})}},{key:"bind",value:function(){var t=this.table.focus;Wt.bind(document,r.SYSTEM_EVENT_TYPE.KEY_DOWN,(function(e){var n=t.activate,r=e.keyCode;if(n){var o=n.attr,i=o.key,c=o.code,l=o.callback;i?e[i]&&r===c&&l(e):r===c&&l(e)}9===r&&e.preventDefault()}))}}])&&ap(e.prototype,n),o&&ap(e,o),t}();function up(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var fp=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.pool=[],this.activate=null}var e,n,o;return e=t,(n=[{key:"findByEl",value:function(t){for(var e=0;e<this.pool.length;e+=1){var n=this.pool[e];if(n.el===t)return n}return null}},{key:"register",value:function(t){var e=this,n=t.el,o=t.attr,i=void 0===o?{}:o,c=t.stop,l=void 0===c||c,a=t.focus,s=void 0!==a&&a,u=this.findByEl(n);if(u)Object.assign(u.attr,i);else{var f={el:n,attr:i};this.pool.push(f),s&&(this.activate=f),Wt.bind(n,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){e.activate=f,l&&t.stopPropagation()}))}}}])&&up(e.prototype,n),o&&up(e,o),t}();function hp(t){return(hp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pp(t){return(pp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bp(t,e){return(bp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function dp(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function gp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wp(t,e,n){return e&&vp(t.prototype,e),n&&vp(t,n),t}var mp={SCROLL:1,RENDER:2},Op=function(){function t(e){gp(this,t),this.table=e}return wp(t,[{key:"getFixedXOffset",value:function(){return 0}},{key:"getFixedYOffset",value:function(){return this.table.settings.index.height}},{key:"getFixedWidth",value:function(){return this.table.settings.index.width}},{key:"getFixedHeight",value:function(){var t=this.table,e=t.fixed.fxTop;return t.rows.sectionSumHeight(0,e)}},{key:"getScrollView",value:function(){var t=this.table.fixed.fxTop,e=this.getFixedWidth(),n=this.getFixedHeight();return new Ia(0,0,t,0,e,n)}}]),t}(),Ep=function(){function t(e){gp(this,t),this.table=e}return wp(t,[{key:"getFixedXOffset",value:function(){return this.table.settings.index.width}},{key:"getFixedYOffset",value:function(){return 0}},{key:"getFixedWidth",value:function(){var t=this.table,e=t.fixed.fxLeft;return t.cols.sectionSumWidth(0,e)}},{key:"getFixedHeight",value:function(){return this.table.settings.index.height}},{key:"getScrollView",value:function(){var t=this.table.fixed.fxLeft,e=this.getFixedWidth(),n=this.getFixedHeight();return new Ia(0,0,0,t,e,n)}}]),t}(),Sp=function(){function t(e){gp(this,t),this.table=e}return wp(t,[{key:"getFixedXOffset",value:function(){return this.table.settings.index.width}},{key:"getFixedYOffset",value:function(){return this.table.settings.index.height}},{key:"getFixedWidth",value:function(){var t=this.table,e=t.fixed.fxLeft;return t.cols.sectionSumWidth(0,e)}},{key:"getFixedHeight",value:function(){var t=this.table,e=t.fixed.fxTop;return t.rows.sectionSumHeight(0,e)}},{key:"getScrollViewChange",value:function(){return this.table.mode!==mp.SCROLL}},{key:"getScrollView",value:function(){var t=this.table.fixed,e=t.fxTop,n=t.fxLeft,r=this.getFixedWidth(),o=this.getFixedHeight();return new Ia(0,0,e,n,r,o)}}]),t}(),xp=function(){function t(e){gp(this,t),this.table=e}return wp(t,[{key:"getScrollViewRange",value:function(){var t=this.table,e=t.dynamicView,n=t.fixed,r=n.fxLeft,o=n.fxTop,i=e.getOriginScrollView();return i.sci=0,i.eci=r,i.sri=0,i.eri=o,i}},{key:"drawGrid",value:function(t,e,n){var r=this.table,o=r.draw,i=r.grid,c=r.lineHandle,l=r.gridLineHandle;o.save(),o.offset(e,n);var a=c.viewRangeAndMergeCoincideView({viewRange:t}),s=c.coincideViewBrink({coincideView:a}),u=l.hLine(t),f=l.vLine(t);u.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),f.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)}));var h=l.hMergeLine(s),p=l.vMergeLine(s);h.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),p.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)})),o.offset(0,0),o.restore()}},{key:"drawBorder",value:function(t,e,n){var r=this.table,o=r.draw,i=r.line,c=r.lineHandle,l=r.borderLineHandle;o.save(),o.offset(e,n);var a=c.viewRangeAndMergeCoincideView({viewRange:t}),s=c.coincideViewBrink({coincideView:a}),u=l.htLine(t),f=l.hbLine(t),h=l.vlLine(t),p=l.vrLine(t);u.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.top,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"top")})),f.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.bottom,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"bottom")})),h.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.left,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"left")})),p.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.right,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"right")}));var y=l.htMergeLine(s),b=l.hbMergeLine(s),d=l.vlMergeLine(s),g=l.vrMergeLine(s);y.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.top,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"top")})),b.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.bottom,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"bottom")})),d.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.left,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"left")})),g.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.right,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"right")})),o.offset(0,0),o.restore()}},{key:"drawBackGround",value:function(t,e,n){var r=this.table,o=r.draw,i=r.grid,c=r.cellsHelper;o.save(),o.offset(e,n),c.getCellByViewRange({rectRange:t,callback:function(t,e,n,r){r.expandSize(i.lineWidth()),new lh({draw:o,rect:r}).drawBackgroundColor(n.background)}}),c.getMergeCellByViewRange({rectRange:t,callback:function(t,e){t.expandSize(i.lineWidth()),new lh({draw:o,rect:t}).drawBackgroundColor(e.background)}}),o.offset(0,0),o.restore()}},{key:"drawCells",value:function(t,e,n){var r=this.table,o=r.draw,i=r.cellsHelper,c=r.grid;o.save(),o.offset(e,n),i.getCellSkipMergeCellByViewRange({rectRange:t,callback:function(t,e,n,r,i){var l=n.fontAttr,a=l.align,s=new Jc({text:Xu(n.format,n.text),rect:r.expandSize(c.lineWidth()),dw:o,overflow:i,attr:l});s.setOverflowCrop(a===Uc.center),n.setContentWidth(s.draw())}}),i.getMergeCellByViewRange({rectRange:t,callback:function(t,e){var n=e.fontAttr,r=new Jc({text:Xu(e.format,e.text),rect:t.expandSize(c.lineWidth()),dw:o,overflow:null,attr:n});r.setTextWrap(Gc.WORD_WRAP),e.setContentWidth(r.draw())}}),o.offset(0,0),o.restore()}},{key:"renderClear",value:function(){var t=this.table,e=t.draw,n=t.settings,r=t.frozenLeftTopOffset,o=r.getFixedWidth(),i=r.getFixedHeight(),c=r.getFixedXOffset(),l=r.getFixedYOffset();e.attr({fillStyle:n.table.background}),e.fillRect(c,l,o,i)}},{key:"render",value:function(){var t=this.table,e=t.draw,n=t.grid,r=t.settings,o=t.frozenLeftTopOffset;if(o.getScrollViewChange()){var i=o.getScrollView(),c=o.getFixedXOffset(),l=o.getFixedYOffset(),a=o.getFixedWidth(),s=o.getFixedHeight(),u=new Vc({x:c+n.lineWidth(),y:l+n.lineWidth(),width:a,height:s}),f=new Tc({draw:e,rect:u,offset:n.lineWidth()});f.open(),this.renderClear(),f.close();var h=new Vc({x:c+n.lineWidth(),y:l+n.lineWidth(),width:a,height:s}),p=new Tc({draw:e,rect:h,offset:n.lineWidth()});p.open(),this.drawBackGround(i,c,l),this.drawCells(i,c,l),r.table.showGrid&&this.drawGrid(i,c,l),this.drawBorder(i,c,l),p.close()}}}]),t}(),_p=function(){function t(e){gp(this,t),this.table=e}return wp(t,[{key:"draw",value:function(t,e,n,r,o){var i=this.table,c=i.draw,l=i.grid,a=i.rows,s=i.settings,u=t.sri,f=t.eri;c.save(),c.offset(e,n),c.attr({fillStyle:"#f6f7fa"}),c.fillRect(0,0,r,o),c.attr({textAlign:"center",textBaseline:"middle",font:"".concat(jc(11),"px Arial"),fillStyle:"#585757"}),a.eachHeight(u,f,(function(t,e,n){c.fillText(t+1,r/2,n+e/2)}));var h=0;c.attr({strokeStyle:s.table.borderColor}),a.eachHeight(u,f,(function(t,e,n){h+=e,l.horizontalLine(0,n,r,n),t===f&&l.horizontalLine(0,n+e,r,n+e)})),l.verticalLine(r,0,r,h),c.offset(0,0),c.restore()}},{key:"render",value:function(){var t=this.table.frozenLeftIndexOffset,e=t.getFixedXOffset(),n=t.getFixedYOffset(),r=t.getFixedWidth(),o=t.getFixedHeight(),i=t.getScrollView();this.draw(i,e,n,r,o)}}]),t}(),kp=function(){function t(e){gp(this,t),this.table=e}return wp(t,[{key:"draw",value:function(t,e,n,r,o){var i=this.table,c=i.draw,l=i.grid,a=i.cols,s=i.settings,u=t.sci,f=t.eci;c.save(),c.offset(e,n),c.attr({fillStyle:"#f6f7fa"}),c.fillRect(0,0,r,o),c.attr({textAlign:"center",textBaseline:"middle",font:"".concat(jc(11),"px Arial"),fillStyle:"#585757"}),a.eachWidth(u,f,(function(t,e,n){c.fillText(S.stringAt(t),n+e/2,o/2)})),c.attr({strokeStyle:s.table.borderColor});var h=0;c.attr({strokeStyle:s.table.borderColor}),a.eachWidth(u,f,(function(t,e,n){h+=e,l.verticalLine(n,0,n,o),t===f&&l.verticalLine(n+e,0,n+e,o)})),l.horizontalLine(0,o,h,o),c.offset(0,0),c.restore()}},{key:"render",value:function(){var t=this.table.frozenTopIndexOffset,e=t.getFixedXOffset(),n=t.getFixedYOffset(),r=t.getFixedWidth(),o=t.getFixedHeight(),i=t.getScrollView();this.draw(i,e,n,r,o)}}]),t}(),Tp=function(){function t(e){gp(this,t),this.table=e}return wp(t,[{key:"draw",value:function(t,e,n,r){var o=this.table,i=o.draw,c=o.grid,l=o.settings;i.save(),i.offset(t,e),i.attr({fillStyle:"#f4f5f8"}),i.fillRect(0,0,n,r),i.offset(0,0),i.restore(),i.attr({strokeStyle:l.table.borderColor}),c.verticalLine(n,e,n,r),c.horizontalLine(0,r,n,r)}},{key:"render",value:function(){var t=this.table.settings.index;this.draw(0,0,t.width,t.height)}}]),t}(),Cp=function(){function t(e){gp(this,t),this.dynamicView=e,this.subtractRange=null,this.addRange=null,this.captureX=0,this.captureY=0,this.dwAddRange=null,this.dwContentRange=null,this.dwXOffset=0,this.dwYOffset=0}return wp(t,[{key:"cpSubtractRange",value:function(){var t=this.dynamicView,e=t.table,n=t.lastScrollRange,r=t.scrollRange,o=e.cols,i=e.rows;if(n){var c=dp(n.coincideDifference(r),1)[0];c&&(c.w=o.rectRangeSumWidth(c),c.h=i.rectRangeSumHeight(c),this.subtractRange=c)}}},{key:"cpAddRange",value:function(){var t=this.dynamicView,e=t.table,n=t.lastScrollRange,r=t.scrollRange,o=e.cols,i=e.rows;if(n){var c=dp(r.coincideDifference(n),1)[0];c&&(c.w=o.rectRangeSumWidth(c),c.h=i.rectRangeSumHeight(c),this.addRange=c)}}},{key:"cpCaptureXY",value:function(){var t=this.dynamicView,e=this.addRange,n=this.subtractRange,r=t.table.scroll;if(e||n){var o=0,i=0;switch(r.type){case Zu.V_TOP:i=e.h;break;case Zu.V_BOTTOM:i=-n.h;break;case Zu.H_LEFT:o=e.w;break;case Zu.H_RIGHT:o=-n.w}this.captureX=o,this.captureY=i}}},{key:"cpRange",value:function(){this.subtractRange=null,this.addRange=null,this.captureX=0,this.captureY=0,this.dwAddRange=null,this.dwContentRange=null,this.dwXOffset=0,this.dwYOffset=0,this.cpSubtractRange(),this.cpAddRange(),this.cpDwAddRange(),this.cpDwContentRange(),this.cpCaptureXY(),this.cpDwOffsetXY()}},{key:"cpDwAddRange",value:function(){var t=this.dynamicView,e=this.addRange,n=t.table,r=n.scroll;if(e){this.dwAddRange=e.clone();var o=n.rows,i=n.cols;switch(r.type){case Zu.H_RIGHT:this.dwAddRange.sci-=1,this.dwAddRange.w=i.rectRangeSumWidth(this.dwAddRange);break;case Zu.V_BOTTOM:this.dwAddRange.sri-=1,this.dwAddRange.h=o.rectRangeSumHeight(this.dwAddRange);break;case Zu.H_LEFT:this.dwAddRange.eci+=1,this.dwAddRange.w=i.rectRangeSumWidth(this.dwAddRange);break;case Zu.V_TOP:this.dwAddRange.eri+=1,this.dwAddRange.h=o.rectRangeSumHeight(this.dwAddRange)}}}},{key:"cpDwContentRange",value:function(){var t=this.dynamicView.table,e=this.dwAddRange;if(e){var n=e.sri,r=e.eri,o=t.cols;this.dwContentRange=e.clone(),this.dwContentRange.set(n,0,r,o.len),this.dwContentRange.w=o.rectRangeSumWidth(this.dwContentRange)}}},{key:"cpDwOffsetXY",value:function(){var t=this.dynamicView,e=this.dwAddRange,n=t.table;if(e){var r=e.w,o=e.h,i=0,c=0;switch(n.scroll.type){case Zu.V_TOP:c=0;break;case Zu.V_BOTTOM:var l=n.rows,a=t.scrollRange;c=l.rectRangeSumHeight(a)-o;break;case Zu.H_LEFT:i=0;break;case Zu.H_RIGHT:var s=n.cols,u=t.scrollRange;i=s.rectRangeSumWidth(u)-r}this.dwXOffset=i,this.dwYOffset=c}}},{key:"getCaptureX",value:function(){return this.dynamicView.table.mode===mp.SCROLL?this.captureX:0}},{key:"getCaptureY",value:function(){return this.dynamicView.table.mode===mp.SCROLL?this.captureY:0}},{key:"getDwXOffset",value:function(){return this.dynamicView.table.mode===mp.SCROLL?this.dwXOffset:0}},{key:"getDwYOffset",value:function(){return this.dynamicView.table.mode===mp.SCROLL?this.dwYOffset:0}}]),t}(),Pp=function(){function t(e){gp(this,t),this.difference=new Cp(this),this.table=e,this.lastScrollRange=null,this.scrollRange=null,this.contentRange=null,this.scrollXOffset=0}return wp(t,[{key:"cpScrollRange",value:function(){for(var t=this.table,e=t.rows,n=t.cols,r=t.scroll,o=t.contentOffset,i=0,c=0,l=r.ri,a=r.ci,s=[e.len,n.len],u=s[0],f=s[1],h=l;h<e.len&&(u=h,!((c+=e.getHeight(h))>o.getFixedHeight()));h+=1);for(var p=a;p<n.len&&(f=p,!((i+=n.getWidth(p))>o.getFixedWidth()));p+=1);this.scrollRange=new Ia(l,a,u,f,i,c)}},{key:"cpContentRange",value:function(){var t=this.table,e=this.scrollRange,n=e.sri,r=e.eri,o=t.cols;this.contentRange=e.clone(),this.contentRange.set(n,0,r,o.len),this.contentRange.w=o.rectRangeSumWidth(e)}},{key:"cpScrollXOffset",value:function(){var t=this.table,e=t.scroll,n=t.cols,r=e.ci;this.scrollXOffset=-n.sectionSumWidth(0,r-1)}},{key:"cpRange",value:function(){this.lastScrollRange=this.scrollRange,this.scrollRange=null,this.contentRange=null,this.scrollXOffset=0,this.cpScrollRange(),this.cpContentRange(),this.cpScrollXOffset(),this.difference.cpRange()}},{key:"getOriginScrollView",value:function(){return this.scrollRange.clone()}},{key:"getOriginContentView",value:function(){return this.contentRange.clone()}},{key:"getOriginLastScrollView",value:function(){var t=this.lastScrollRange;return t?t.clone():null}},{key:"getScrollXOffset",value:function(){return this.scrollXOffset}},{key:"getScrollView",value:function(){var t=this.table,e=this.scrollRange;if(t.mode===mp.SCROLL){var n=this.difference.dwAddRange;if(n)return n.clone()}return e.clone()}},{key:"getContentView",value:function(){var t=this.contentRange,e=this.table;if(e.mode===mp.SCROLL){var n=e.scroll,r=this.difference;switch(n.type){case Zu.V_TOP:case Zu.V_BOTTOM:var o=r.dwContentRange;if(o)return o.clone()}}return t.clone()}}]),t}(),Ap=function(){function t(e){gp(this,t),this.table=e}return wp(t,[{key:"getFixedXOffset",value:function(){var t=this.table,e=t.fixed,n=t.settings.index,r=e.fxLeft,o=t.cols.sectionSumWidth(0,r);return n.width+o}},{key:"getFixedYOffset",value:function(){return this.table.settings.index.height}},{key:"getFixedWidth",value:function(){var t=this.table,e=t.fixed,n=t.settings.index,r=e.fxLeft,o=t.cols.sectionSumWidth(0,r);return t.visualWidth()-(n.width+o)}},{key:"getFixedHeight",value:function(){var t=this.table,e=t.fixed.fxTop;return t.rows.sectionSumHeight(0,e)}},{key:"getCaptureX",value:function(){var t=this.table.dynamicView.difference.getCaptureX();return this.getFixedXOffset()+t}},{key:"getCaptureY",value:function(){var t=this.table.dynamicView.difference.getCaptureY();return this.getFixedYOffset()+t}},{key:"getDwXOffset",value:function(){var t=this.table.dynamicView.difference.getDwXOffset();return this.getFixedXOffset()+t}},{key:"getDwYOffset",value:function(){var t=this.table.dynamicView.difference.getDwYOffset();return this.getFixedYOffset()+t}},{key:"getScrollViewChange",value:function(){var t=this.table,e=t.fixed.fxTop;if(t.mode===mp.SCROLL){var n=t.dynamicView,r=n.getOriginLastScrollView(),o=n.getOriginScrollView();return null===r||(r.sri=0,r.eri=e,o.sri=0,o.eri=e,!1===o.equals(r))}return!0}},{key:"getContentView",value:function(){var t=this.table,e=t.dynamicView,n=t.fixed.fxTop,r=e.getContentView();return r.sri=0,r.eri=n,r}},{key:"getScrollView",value:function(){var t=this.table,e=t.dynamicView,n=t.fixed.fxTop,r=e.getScrollView();return r.sri=0,r.eri=n,r}},{key:"getScrollXOffset",value:function(){return this.table.dynamicView.getScrollXOffset()}}]),t}(),jp=function(){function t(e){gp(this,t),this.table=e}return wp(t,[{key:"getFixedXOffset",value:function(){return this.table.settings.index.width}},{key:"getFixedYOffset",value:function(){var t=this.table,e=t.fixed,n=t.settings.index,r=e.fxTop,o=t.rows.sectionSumHeight(0,r);return n.height+o}},{key:"getFixedWidth",value:function(){var t=this.table,e=t.fixed.fxLeft;return t.cols.sectionSumWidth(0,e)}},{key:"getFixedHeight",value:function(){var t=this.table,e=t.fixed,n=t.settings.index,r=e.fxTop,o=t.rows.sectionSumHeight(0,r);return t.visualHeight()-(n.height+o)}},{key:"getCaptureX",value:function(){var t=this.table.dynamicView.difference.getCaptureX();return this.getFixedXOffset()+t}},{key:"getCaptureY",value:function(){var t=this.table.dynamicView.difference.getCaptureY();return this.getFixedYOffset()+t}},{key:"getDwXOffset",value:function(){var t=this.table.dynamicView.difference.getDwXOffset();return this.getFixedXOffset()+t}},{key:"getDwYOffset",value:function(){var t=this.table.dynamicView.difference.getDwYOffset();return this.getFixedYOffset()+t}},{key:"getScrollViewChange",value:function(){var t=this.table,e=t.fixed.fxLeft;if(t.mode===mp.SCROLL){var n=t.dynamicView,r=n.getOriginLastScrollView(),o=n.getOriginScrollView();return null===r||(r.sci=0,r.eci=e,o.sci=0,o.eci=e,!1===o.equals(r))}return!0}},{key:"getContentView",value:function(){var t=this.table,e=t.dynamicView,n=t.fixed.fxLeft,r=e.getContentView();return r.sci=0,r.eci=n,r}},{key:"getScrollView",value:function(){var t=this.table,e=t.dynamicView,n=t.fixed.fxLeft,r=e.getScrollView();return r.sci=0,r.eci=n,r}}]),t}(),Lp=function(){function t(e){gp(this,t),this.table=e}return wp(t,[{key:"getFixedXOffset",value:function(){var t=this.table,e=t.fixed,n=t.settings.index,r=e.fxLeft;return t.cols.sectionSumWidth(0,r)+n.width}},{key:"getFixedYOffset",value:function(){var t=this.table,e=t.fixed,n=t.settings.index,r=e.fxTop,o=t.rows.sectionSumHeight(0,r);return n.height+o}},{key:"getFixedWidth",value:function(){var t=this.table,e=t.fixed,n=t.settings.index,r=e.fxLeft,o=t.cols.sectionSumWidth(0,r);return t.visualWidth()-(o+n.width)}},{key:"getFixedHeight",value:function(){var t=this.table,e=t.fixed,n=t.settings.index,r=e.fxTop,o=t.rows.sectionSumHeight(0,r);return t.visualHeight()-(n.height+o)}},{key:"getCaptureX",value:function(){var t=this.table.dynamicView.difference.getCaptureX();return this.getFixedXOffset()+t}},{key:"getCaptureY",value:function(){var t=this.table.dynamicView.difference.getCaptureY();return this.getFixedYOffset()+t}},{key:"getDwXOffset",value:function(){var t=this.table.dynamicView.difference.getDwXOffset();return this.getFixedXOffset()+t}},{key:"getDwYOffset",value:function(){var t=this.table.dynamicView.difference.getDwYOffset();return this.getFixedYOffset()+t}},{key:"getScrollViewChange",value:function(){var t=this.table;if(t.mode===mp.SCROLL){var e=t.dynamicView,n=e.getOriginLastScrollView(),r=e.getOriginScrollView();return null===n||!1===r.equals(n)}return!0}},{key:"getContentView",value:function(){return this.table.dynamicView.getContentView()}},{key:"getScrollView",value:function(){return this.table.dynamicView.getScrollView()}},{key:"getScrollXOffset",value:function(){return this.table.dynamicView.getScrollXOffset()}}]),t}(),Rp=function(){function t(e){gp(this,t),this.table=e}return wp(t,[{key:"getFixedXOffset",value:function(){var t=this.table,e=t.fixed,n=t.settings.index,r=e.fxLeft,o=t.cols.sectionSumWidth(0,r);return n.width+o}},{key:"getFixedYOffset",value:function(){return 0}},{key:"getFixedWidth",value:function(){var t=this.table,e=t.fixed,n=t.settings.index,r=e.fxLeft,o=t.cols.sectionSumWidth(0,r);return t.visualWidth()-(n.width+o)}},{key:"getFixedHeight",value:function(){return this.table.settings.index.height}},{key:"getCaptureX",value:function(){var t=this.table.dynamicView.difference.getCaptureX();return this.getFixedXOffset()+t}},{key:"getCaptureY",value:function(){var t=this.table.dynamicView.difference.getCaptureY();return this.getFixedYOffset()+t}},{key:"getDwXOffset",value:function(){var t=this.table.dynamicView.difference.getDwXOffset();return this.getFixedXOffset()+t}},{key:"getDwYOffset",value:function(){var t=this.table.dynamicView.difference.getDwYOffset();return this.getFixedYOffset()+t}},{key:"getScrollViewChange",value:function(){var t=this.table;if(t.mode===mp.SCROLL){var e=t.dynamicView,n=e.getOriginLastScrollView(),r=e.getOriginScrollView();return null===n||(n.sri=0,n.eri=0,r.sri=0,r.eri=0,!1===r.equals(n))}return!0}},{key:"getContentView",value:function(){var t=this.table.dynamicView.getContentView();return t.sri=0,t.eri=0,t}},{key:"getScrollView",value:function(){var t=this.table.dynamicView.getScrollView();return t.sri=0,t.eri=0,t}}]),t}(),Wp=function(){function t(e){gp(this,t),this.table=e}return wp(t,[{key:"getFixedXOffset",value:function(){return 0}},{key:"getFixedYOffset",value:function(){var t=this.table,e=t.fixed,n=t.settings.index,r=e.fxTop,o=t.rows.sectionSumHeight(0,r);return n.height+o}},{key:"getFixedWidth",value:function(){return this.table.settings.index.width}},{key:"getFixedHeight",value:function(){var t=this.table,e=t.fixed,n=t.settings.index,r=e.fxTop,o=t.rows.sectionSumHeight(0,r);return t.visualHeight()-(n.height+o)}},{key:"getCaptureX",value:function(){var t=this.table.dynamicView.difference.getCaptureX();return this.getFixedXOffset()+t}},{key:"getCaptureY",value:function(){var t=this.table.dynamicView.difference.getCaptureY();return this.getFixedYOffset()+t}},{key:"getDwXOffset",value:function(){var t=this.table.dynamicView.difference.getDwXOffset();return this.getFixedXOffset()+t}},{key:"getDwYOffset",value:function(){var t=this.table.dynamicView.difference.getDwYOffset();return this.getFixedYOffset()+t}},{key:"getScrollViewChange",value:function(){var t=this.table;if(t.mode===mp.SCROLL){var e=t.dynamicView,n=e.getOriginLastScrollView(),r=e.getOriginScrollView();return null===n||(n.sci=0,n.eci=0,r.sci=0,r.eci=0,!1===r.equals(n))}return!0}},{key:"getContentView",value:function(){var t=this.table.dynamicView.getContentView();return t.sci=0,t.eci=0,t}},{key:"getScrollView",value:function(){var t=this.table.dynamicView.getScrollView();return t.sci=0,t.eci=0,t}}]),t}(),Vp=function(){function t(e){gp(this,t),this.table=e}return wp(t,[{key:"getScrollViewRange",value:function(){var t=this.table,e=t.dynamicView,n=t.fixed.fxTop,r=e.getOriginScrollView();return r.sri=0,r.eri=n,r}},{key:"getContentViewRange",value:function(){var t=this.table,e=t.dynamicView,n=t.fixed.fxTop,r=e.getOriginContentView();return r.sri=0,r.eri=n,r}},{key:"drawCells",value:function(t,e,n,r){var o=this.table,i=o.draw,c=o.cellsHelper,l=o.grid;i.save(),i.offset(n,r),c.getCellSkipMergeCellByViewRange({rectRange:t,callback:function(t,e,n,r,o){var c=n.fontAttr,a=c.align,s=new Jc({text:Xu(n.format,n.text),rect:r.expandSize(l.lineWidth()),dw:i,overflow:o,attr:c});s.setOverflowCrop(a===Uc.center),n.setContentWidth(s.draw())},startX:e}),c.getMergeCellByViewRange({rectRange:t,callback:function(t,e){var n=e.fontAttr,r=new Jc({text:Xu(e.format,e.text),rect:t.expandSize(l.lineWidth()),dw:i,overflow:null,attr:n});r.setTextWrap(Gc.WORD_WRAP),e.setContentWidth(r.draw())},startX:e}),i.offset(0,0),i.restore()}},{key:"drawGrid",value:function(t,e,n){var r=this.table,o=r.draw,i=r.grid,c=r.lineHandle,l=r.gridLineHandle;o.save(),o.offset(e,n);var a=c.viewRangeAndMergeCoincideView({viewRange:t}),s=c.coincideViewBrink({coincideView:a}),u=l.hLine(t),f=l.vLine(t);u.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),f.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)}));var h=l.hMergeLine(s),p=l.vMergeLine(s);h.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),p.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)})),o.offset(0,0),o.restore()}},{key:"drawBorder",value:function(t,e,n){var r=this.table,o=r.draw,i=r.line,c=r.lineHandle,l=r.borderLineHandle;o.save(),o.offset(e,n);var a=c.viewRangeAndMergeCoincideView({viewRange:t}),s=c.coincideViewBrink({coincideView:a}),u=l.htLine(t),f=l.hbLine(t),h=l.vlLine(t),p=l.vrLine(t);u.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.top,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"top")})),f.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.bottom,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"bottom")})),h.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.left,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"left")})),p.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.right,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"right")}));var y=l.htMergeLine(s),b=l.hbMergeLine(s),d=l.vlMergeLine(s),g=l.vrMergeLine(s);y.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.top,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"top")})),b.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.bottom,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"bottom")})),d.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.left,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"left")})),g.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.right,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"right")})),o.offset(0,0),o.restore()}},{key:"drawBackGround",value:function(t,e,n){var r=this.table,o=r.draw,i=r.grid,c=r.cellsHelper;o.save(),o.offset(e,n),c.getCellByViewRange({rectRange:t,callback:function(t,e,n,r){r.expandSize(i.lineWidth()),new lh({draw:o,rect:r}).drawBackgroundColor(n.background)}}),c.getMergeCellByViewRange({rectRange:t,callback:function(t,e){t.expandSize(i.lineWidth()),new lh({draw:o,rect:t}).drawBackgroundColor(e.background)}}),o.offset(0,0),o.restore()}},{key:"renderClear",value:function(){var t=this.table,e=t.draw,n=t.settings,r=t.cols,o=t.dynamicView,i=t.fixedTopOffset,c=i.getFixedWidth(),l=i.getFixedHeight(),a=i.getFixedXOffset(),s=i.getFixedYOffset(),u=i.getDwXOffset(),f=i.getDwYOffset(),h=i.getCaptureX(),p=t.scroll,y=t.canvas.el,b=i.getScrollView();switch(p.type){case Zu.H_RIGHT:var d=a,g=s,v=s;if(e.drawImage(y,d,g,c,l,h,v,c,l),e.attr({fillStyle:n.table.background}),r.len-1===b.eci){var w=o.getOriginScrollView();e.fillRect(u+4,f,b.w+(c-w.w),l)}else e.fillRect(u+4,f,b.w,l);break;case Zu.H_LEFT:var m=a,O=s,E=s;e.drawImage(y,m,O,c,l,h,E,c,l),e.attr({fillStyle:n.table.background}),e.fillRect(u,f,b.w-4,l);break;default:e.attr({fillStyle:n.table.background}),e.fillRect(a,s,c,l)}}},{key:"render",value:function(){var t=this.table,e=t.draw,n=t.grid,r=t.settings,o=t.fixedTopOffset;if(o.getScrollViewChange()){var i=o.getScrollXOffset(),c=o.getScrollView(),l=o.getContentView(),a=o.getDwXOffset(),s=o.getDwYOffset(),u=o.getFixedXOffset(),f=o.getFixedYOffset(),h=o.getFixedWidth(),p=o.getFixedHeight(),y=new Vc({x:u+n.lineWidth(),y:f+n.lineWidth(),width:h,height:p}),b=new Tc({draw:e,rect:y,offset:n.lineWidth()});b.open(),this.renderClear(),b.close();var d=new Vc({x:a+n.lineWidth(),y:s+n.lineWidth(),width:c.w,height:p-n.lineWidth()}),g=new Tc({draw:e,rect:d,offset:n.lineWidth()});g.open(),this.drawBackGround(c,a,s),this.drawCells(l,i,u,s),r.table.showGrid&&this.drawGrid(c,a,s),this.drawBorder(c,a,s),g.close()}}}]),t}(),Hp=function(){function t(e){gp(this,t),this.table=e}return wp(t,[{key:"getScrollViewRange",value:function(){var t=this.table,e=t.dynamicView,n=t.fixed.fxLeft,r=e.getOriginScrollView();return r.sci=0,r.eci=n,r}},{key:"drawGrid",value:function(t,e,n){var r=this.table,o=r.draw,i=r.grid,c=r.lineHandle,l=r.gridLineHandle;o.save(),o.offset(e,n);var a=c.viewRangeAndMergeCoincideView({viewRange:t}),s=c.coincideViewBrink({coincideView:a}),u=l.hLine(t),f=l.vLine(t);u.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),f.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)}));var h=l.hMergeLine(s),p=l.vMergeLine(s);h.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),p.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)})),o.offset(0,0),o.restore()}},{key:"drawBorder",value:function(t,e,n){var r=this.table,o=r.draw,i=r.line,c=r.lineHandle,l=r.borderLineHandle;o.save(),o.offset(e,n);var a=c.viewRangeAndMergeCoincideView({viewRange:t}),s=c.coincideViewBrink({coincideView:a}),u=l.htLine(t),f=l.hbLine(t),h=l.vlLine(t),p=l.vrLine(t);u.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.top,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"top")})),f.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.bottom,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"bottom")})),h.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.left,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"left")})),p.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.right,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"right")}));var y=l.htMergeLine(s),b=l.hbMergeLine(s),d=l.vlMergeLine(s),g=l.vrMergeLine(s);y.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.top,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"top")})),b.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.bottom,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"bottom")})),d.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.left,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"left")})),g.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.right,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"right")})),o.offset(0,0),o.restore()}},{key:"drawBackGround",value:function(t,e,n){var r=this.table,o=r.draw,i=r.grid,c=r.cellsHelper;o.save(),o.offset(e,n),c.getCellByViewRange({rectRange:t,callback:function(t,e,n,r){r.expandSize(i.lineWidth()),new lh({draw:o,rect:r}).drawBackgroundColor(n.background)}}),c.getMergeCellByViewRange({rectRange:t,callback:function(t,e){t.expandSize(i.lineWidth()),new lh({draw:o,rect:t}).drawBackgroundColor(e.background)}}),o.offset(0,0),o.restore()}},{key:"drawCells",value:function(t,e,n){var r=this.table,o=r.draw,i=r.cellsHelper,c=r.grid;o.save(),o.offset(e,n),i.getCellSkipMergeCellByViewRange({rectRange:t,callback:function(t,e,n,r,i){var l=n.fontAttr,a=l.align,s=new Jc({text:Xu(n.format,n.text),rect:r.expandSize(c.lineWidth()),dw:o,overflow:i,attr:l});s.setOverflowCrop(a===Uc.center),n.setContentWidth(s.draw())}}),i.getMergeCellByViewRange({rectRange:t,callback:function(t,e){var n=e.fontAttr,r=new Jc({text:Xu(e.format,e.text),rect:t.expandSize(c.lineWidth()),dw:o,overflow:null,attr:n});r.setTextWrap(Gc.WORD_WRAP),e.setContentWidth(r.draw())}}),o.offset(0,0),o.restore()}},{key:"renderClear",value:function(){var t=this.table,e=t.draw,n=t.settings,r=t.dynamicView,o=t.rows,i=t.fixedLeftOffset,c=i.getFixedWidth(),l=i.getFixedHeight(),a=i.getFixedXOffset(),s=i.getFixedYOffset(),u=i.getDwXOffset(),f=i.getDwYOffset(),h=i.getCaptureY(),p=t.scroll,y=t.canvas.el,b=i.getScrollView();switch(p.type){case Zu.V_BOTTOM:var d=a,g=a,v=s;if(e.drawImage(y,d,v,c,l,g,h,c,l),e.attr({fillStyle:n.table.background}),o.len-1===b.eri){var w=r.getOriginScrollView();e.fillRect(u,f+4,c,b.h+(l-w.h))}else e.fillRect(u,f+4,c,b.h);break;case Zu.V_TOP:var m=a,O=a,E=s;e.drawImage(y,m,E,c,l,O,h,c,l),e.attr({fillStyle:n.table.background}),e.fillRect(u,f,c,b.h-4);break;default:e.attr({fillStyle:n.table.background}),e.fillRect(a,s,c,l)}}},{key:"render",value:function(){var t=this.table,e=t.draw,n=t.grid,r=t.settings,o=t.fixedLeftOffset;if(o.getScrollViewChange()){var i=o.getScrollView(),c=o.getContentView(),l=o.getDwXOffset(),a=o.getDwYOffset(),s=o.getFixedXOffset(),u=o.getFixedYOffset(),f=o.getFixedWidth(),h=o.getFixedHeight(),p=new Vc({x:s+n.lineWidth(),y:u+n.lineWidth(),width:f,height:h}),y=new Tc({draw:e,rect:p,offset:n.lineWidth()});y.open(),this.renderClear(),y.close();var b=new Vc({x:l+n.lineWidth(),y:a+n.lineWidth(),width:f-n.lineWidth(),height:i.h}),d=new Tc({draw:e,rect:b,offset:n.lineWidth()});d.open(),this.drawBackGround(i,l,a),this.drawCells(c,s,a),r.table.showGrid&&this.drawGrid(i,l,a),this.drawBorder(i,l,a),d.close()}}}]),t}(),Mp=function(){function t(e){gp(this,t),this.table=e}return wp(t,[{key:"getContentWidth",value:function(){var t=this.table,e=t.cols,n=t.fixed;return e.totalWidth()-e.sectionSumWidth(0,n.fxLeft)}},{key:"getContentHeight",value:function(){var t=this.table,e=t.rows,n=t.fixed;return e.totalHeight()-e.sectionSumHeight(0,n.fxTop)}},{key:"drawCells",value:function(t,e,n,r){var o=this.table,i=o.draw,c=o.cellsHelper,l=o.grid;i.save(),i.offset(n,r),c.getCellSkipMergeCellByViewRange({rectRange:t,callback:function(t,e,n,r,o){var c=n.fontAttr,a=c.align,s=new Jc({text:Xu(n.format,n.text),rect:r.expandSize(l.lineWidth()),dw:i,overflow:o,attr:c});s.setOverflowCrop(a===Uc.center),n.setContentWidth(s.draw())},startX:e}),c.getMergeCellByViewRange({rectRange:t,callback:function(t,e){var n=e.fontAttr,r=new Jc({text:Xu(e.format,e.text),rect:t.expandSize(l.lineWidth()),dw:i,overflow:null,attr:n});r.setTextWrap(Gc.WORD_WRAP),e.setContentWidth(r.draw())},startX:e}),i.offset(0,0),i.restore()}},{key:"drawGrid",value:function(t,e,n){var r=this.table,o=r.draw,i=r.grid,c=r.lineHandle,l=r.gridLineHandle;o.save(),o.offset(e,n);var a=c.viewRangeAndMergeCoincideView({viewRange:t}),s=c.coincideViewBrink({coincideView:a}),u=l.hLine(t),f=l.vLine(t);u.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),f.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)}));var h=l.hMergeLine(s),p=l.vMergeLine(s);h.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),p.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)})),o.offset(0,0),o.restore()}},{key:"drawBorder",value:function(t,e,n){var r=this.table,o=r.draw,i=r.line,c=r.lineHandle,l=r.borderLineHandle;o.save(),o.offset(e,n);var a=c.viewRangeAndMergeCoincideView({viewRange:t}),s=c.coincideViewBrink({coincideView:a}),u=l.htLine(t),f=l.hbLine(t),h=l.vlLine(t),p=l.vrLine(t);u.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.top,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"top")})),f.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.bottom,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"bottom")})),h.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.left,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"left")})),p.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.right,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"right")}));var y=l.htMergeLine(s),b=l.hbMergeLine(s),d=l.vlMergeLine(s),g=l.vrMergeLine(s);y.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.top,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"top")})),b.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.bottom,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"bottom")})),d.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.left,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"left")})),g.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.right,c=o.color,l=o.width,a=o.type;i.setType(a),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"right")})),o.offset(0,0),o.restore()}},{key:"drawBackGround",value:function(t,e,n){var r=this.table,o=r.draw,i=r.grid,c=r.cellsHelper;o.save(),o.offset(e,n),c.getCellByViewRange({rectRange:t,callback:function(t,e,n,r){r.expandSize(i.lineWidth()),new lh({draw:o,rect:r}).drawBackgroundColor(n.background)}}),c.getMergeCellByViewRange({rectRange:t,callback:function(t,e){t.expandSize(i.lineWidth()),new lh({draw:o,rect:t}).drawBackgroundColor(e.background)}}),o.offset(0,0),o.restore()}},{key:"renderClear",value:function(){var t=this.table,e=t.draw,n=t.settings,r=t.dynamicView,o=t.rows,i=t.cols,c=t.contentOffset,l=c.getFixedWidth(),a=c.getFixedHeight(),s=c.getFixedXOffset(),u=c.getFixedYOffset(),f=c.getDwXOffset(),h=c.getDwYOffset(),p=c.getCaptureX(),y=c.getCaptureY(),b=t.scroll,d=t.canvas.el,g=r.getScrollView();switch(b.type){case Zu.V_BOTTOM:var v=s,w=s,m=u;if(e.drawImage(d,v,m,l,a,w,y,l,a),e.attr({fillStyle:n.table.background}),o.len-1===g.eri){var O=r.getOriginScrollView();e.fillRect(f,h+4,l,g.h+(a-O.h))}else e.fillRect(f,h+4,l,g.h);break;case Zu.V_TOP:var E=s,S=s,x=u;e.drawImage(d,E,x,l,a,S,y,l,a),e.attr({fillStyle:n.table.background}),e.fillRect(f,h,l,g.h-4);break;case Zu.H_RIGHT:var _=s,k=u,T=u;if(e.drawImage(d,_,k,l,a,p,T,l,a),e.attr({fillStyle:n.table.background}),i.len-1===g.eci){var C=r.getOriginScrollView();e.fillRect(f+4,h,g.w+(l-C.w),a)}else e.fillRect(f+4,h,g.w,a);break;case Zu.H_LEFT:var P=s,A=u,j=u;e.drawImage(d,P,A,l,a,p,j,l,a),e.attr({fillStyle:n.table.background}),e.fillRect(f,h,g.w-4,a);break;default:e.attr({fillStyle:n.table.background}),e.fillRect(s,u,l,a)}}},{key:"render",value:function(){var t=this.table,e=t.draw,n=t.grid,r=t.settings,o=t.contentOffset;if(o.getScrollViewChange()){var i=o.getScrollXOffset(),c=o.getScrollView(),l=o.getContentView(),a=o.getDwXOffset(),s=o.getDwYOffset(),u=o.getFixedXOffset(),f=o.getFixedYOffset(),h=o.getFixedWidth(),p=o.getFixedHeight(),y=new Vc({x:u+n.lineWidth(),y:f+n.lineWidth(),width:h,height:p}),b=new Tc({draw:e,rect:y,offset:n.lineWidth()});b.open(),this.renderClear(),b.close();var d=new Vc({x:a+n.lineWidth(),y:s+n.lineWidth(),width:c.w,height:c.h}),g=new Tc({draw:e,rect:d,offset:n.lineWidth()});g.open(),this.drawBackGround(c,a,s),this.drawCells(l,i,u,s),r.table.showGrid&&this.drawGrid(c,a,s),this.drawBorder(c,a,s),g.close()}}}]),t}(),Np=function(){function t(e){gp(this,t),this.table=e}return wp(t,[{key:"draw",value:function(t,e,n,r,o){var i=this.table,c=i.draw,l=i.grid,a=i.cols,s=i.settings,u=t.sci,f=t.eci;c.save(),c.offset(e,n),c.attr({fillStyle:"#f6f7fa"}),c.fillRect(0,0,r,o),c.attr({textAlign:"center",textBaseline:"middle",font:"".concat(jc(11),"px Arial"),fillStyle:"#585757"}),a.eachWidth(u,f,(function(t,e,n){c.fillText(S.stringAt(t),n+e/2,o/2)})),c.attr({strokeStyle:s.table.borderColor});var h=0;c.attr({strokeStyle:s.table.borderColor}),a.eachWidth(u,f,(function(t,e,n){h+=e,l.verticalLine(n,0,n,o),t===f&&l.verticalLine(n+e,0,n+e,o)})),l.horizontalLine(0,o,h,o),c.offset(0,0),c.restore()}},{key:"renderClear",value:function(){var t=this.table,e=t.draw,n=t.settings,r=t.cols,o=t.grid,i=t.dynamicView,c=t.fixedTopIndexOffset,l=c.getFixedWidth(),a=c.getFixedHeight(),s=c.getFixedXOffset(),u=c.getFixedYOffset(),f=c.getDwXOffset(),h=c.getDwYOffset(),p=c.getCaptureX(),y=t.scroll,b=t.canvas.el,d=c.getScrollView();switch(y.type){case Zu.H_RIGHT:case Zu.H_LEFT:var g=s,v=u,w=u;if(e.drawImage(b,g,v,l,a+o.lineWidth(),p,w,l,a+o.lineWidth()),e.attr({fillStyle:n.table.background}),r.len-1===d.eci){var m=i.getOriginScrollView();e.fillRect(f,h,d.w+(l-m.w),a+o.lineWidth())}else e.fillRect(f,h,d.w,a+o.lineWidth());break;default:e.attr({fillStyle:n.table.background}),e.fillRect(s,u,l,a)}}},{key:"render",value:function(){var t=this.table,e=t.fixedTopIndexOffset,n=t.grid,r=t.draw;if(e.getScrollViewChange()){var o=e.getScrollView(),i=e.getDwXOffset(),c=e.getDwYOffset(),l=e.getFixedXOffset(),a=e.getFixedYOffset(),s=e.getFixedWidth(),u=e.getFixedHeight(),f=new Vc({x:l,y:a,width:s,height:u+n.lineWidth()}),h=new Tc({draw:r,rect:f,offset:n.lineWidth()});h.open(),this.renderClear(),this.draw(o,i,c,o.w,u),h.close()}}}]),t}(),Dp=function(){function t(e){gp(this,t),this.table=e}return wp(t,[{key:"draw",value:function(t,e,n,r,o){var i=this.table,c=i.draw,l=i.grid,a=i.rows,s=i.settings,u=t.sri,f=t.eri;c.save(),c.offset(e,n),c.attr({fillStyle:"#f6f7fa"}),c.fillRect(0,0,r,o),c.attr({textAlign:"center",textBaseline:"middle",font:"".concat(jc(11),"px Arial"),fillStyle:"#585757"}),a.eachHeight(u,f,(function(t,e,n){c.fillText(t+1,r/2,n+e/2)}));var h=0;c.attr({strokeStyle:s.table.borderColor}),a.eachHeight(u,f,(function(t,e,n){h+=e,l.horizontalLine(0,n,r,n),t===f&&l.horizontalLine(0,n+e,r,n+e)})),l.verticalLine(r,0,r,h),c.offset(0,0),c.restore()}},{key:"renderClear",value:function(){var t=this.table,e=t.draw,n=t.settings,r=t.rows,o=t.grid,i=t.dynamicView,c=t.fixedLeftIndexOffset,l=c.getFixedWidth(),a=c.getFixedHeight(),s=c.getFixedXOffset(),u=c.getFixedYOffset(),f=c.getDwXOffset(),h=c.getDwYOffset(),p=c.getCaptureY(),y=t.scroll,b=t.canvas.el,d=c.getScrollView();switch(y.type){case Zu.V_BOTTOM:case Zu.V_TOP:var g=s,v=s,w=u;if(e.drawImage(b,g,w,l+o.lineWidth(),a,v,p,l+o.lineWidth(),a),e.attr({fillStyle:n.table.background}),r.len-1===d.eri){var m=i.getOriginScrollView();e.fillRect(f,h,l+o.lineWidth(),d.h+(a-m.h))}else e.fillRect(f,h,l+o.lineWidth(),d.h);break;default:e.attr({fillStyle:n.table.background}),e.fillRect(s,u,l,a)}}},{key:"render",value:function(){var t=this.table,e=t.fixedLeftIndexOffset,n=t.grid,r=t.draw;if(e.getScrollViewChange()){var o=e.getScrollView(),i=e.getDwXOffset(),c=e.getDwYOffset(),l=e.getFixedXOffset(),a=e.getFixedYOffset(),s=e.getFixedWidth(),u=e.getFixedHeight(),f=new Vc({x:l,y:a,width:s,height:u}),h=new Tc({draw:r,rect:f,offset:n.lineWidth()});h.open(),this.renderClear(),this.draw(o,i,c,s,o.h),h.close()}}}]),t}(),Ip=function t(e){gp(this,t);var n=e.keyboard,r=e.cols,o=e.rows,i=e.edit,c=e.merges,l=e.screenSelector,a=0,s=null;n.register({el:e,focus:!0,stop:!1,attr:{code:9,callback:function(){i.hideEdit();var t=l.selectorAttr,e=t,n=t.rect.clone();if(a!==e){var u=n.sri,f=n.sci;a=e,s={sri:u,sci:f}}var h=r.len-1,p=o.len-1,y=s,b=y.sri,d=y.sci,g=c.getFirstIncludes(b,d);if(g&&(d=g.eci),!(d>=h&&b>=p)){d>=h?(b+=1,d=0):d+=1,s.sri=b,s.sci=d;var v=b,w=d,m=c.getFirstIncludes(b,d);m&&(b=m.sri,d=m.sci,v=m.eri,w=m.eci),n.sri=b,n.sci=d,n.eri=v,n.eci=w,l.selectorAttr.rect=n,l.setOffset(l.selectorAttr),l.onChangeStack.forEach((function(t){return t()})),l.onSelectChangeStack.forEach((function(t){return t()})),i.showEdit()}}}})},Bp={tipsRenderTime:!1,tipsScrollTime:!1,index:{height:30,width:50,bgColor:"#f4f5f8",color:"#000000"},table:{background:"#ffffff",borderColor:"#e5e5e5",gridColor:"#000000",showGrid:!0},data:[],rows:{len:1e4,height:30},cols:{len:26,width:137},merges:[],fixed:{fxTop:-1,fxLeft:-1}},Yp=function(t){function e(t){var n,r,i;return gp(this,e),r=this,i=pp(e).call(this,"".concat(o,"-table")),(n=!i||"object"!==hp(i)&&"function"!=typeof i?yp(r):i).mode=mp.RENDER,n.settings=S.mergeDeep({},Bp,t),n.canvas=new R("".concat(o,"-table-canvas"),"canvas"),n.dynamicView=new Pp(yp(n)),n.cells=new fh({table:yp(n),rows:n.rows,cols:n.cols,data:n.settings.data}),n.fixed=new tf(n.settings.fixed),n.rows=new Ku(n.settings.rows),n.cols=new $u(n.settings.cols),n.merges=new nf(n.settings.merges),n.scroll=new Ju(yp(n)),n.cellsHelper=new ph({cells:n.cells,merges:n.merges,rows:n.rows,cols:n.cols}),n.focus=new fp(yp(n)),n.tableDataSnapshot=new Qh(yp(n)),n.mousePointer=new lp(yp(n)),n.keyboard=new sp(yp(n)),n.draw=new Rc(n.canvas.el),n.line=new zi(n.draw,{leftShow:function(t,e){var r=n.cells.getCell(t,e);if(null===r)return!1;var o=n.merges.getFirstIncludes(t,e);return o?n.cells.getCell(o.sri,o.sci).borderAttr.left.display:!!r.borderAttr.left.display&&n.lineHandle.vLineLeftOverFlowChecked(e,t)},topShow:function(t,e){var r=n.cells.getMergeCellOrCell(t,e);return r&&r.borderAttr.top.display},rightShow:function(t,e){var r=n.cells.getCell(t,e);if(null===r)return!1;var o=n.merges.getFirstIncludes(t,e);return o?n.cells.getCell(o.sri,o.sci).borderAttr.right.display:!!r.borderAttr.right.display&&n.lineHandle.vLineRightOverFlowChecked(e,t)},bottomShow:function(t,e){var r=n.cells.getMergeCellOrCell(t,e);return r&&r.borderAttr.bottom.display},iFMerge:function(t,e){return null!==n.merges.getFirstIncludes(t,e)},iFMergeFirstRow:function(t,e){return n.merges.getFirstIncludes(t,e).sri===t},iFMergeLastRow:function(t,e){return n.merges.getFirstIncludes(t,e).eri===t},iFMergeFirstCol:function(t,e){return n.merges.getFirstIncludes(t,e).sci===e},iFMergeLastCol:function(t,e){return n.merges.getFirstIncludes(t,e).eci===e}}),n.grid=new ih(n.draw,{color:n.settings.table.borderColor}),n.lineHandle=new sh(yp(n)),n.borderLineHandle=new gh(yp(n)),n.gridLineHandle=new bh(yp(n)),n.fixedTopOffset=new Ap(yp(n)),n.fixedLeftOffset=new jp(yp(n)),n.contentOffset=new Lp(yp(n)),n.fixedTopIndexOffset=new Rp(yp(n)),n.fixedLeftIndexOffset=new Wp(yp(n)),n.frozenLeftIndexOffset=new Op(yp(n)),n.frozenTopIndexOffset=new Ep(yp(n)),n.frozenLeftTopOffset=new Sp(yp(n)),n.content=new Mp(yp(n)),n.fixedLeft=new Hp(yp(n)),n.fixedTop=new Vp(yp(n)),n.fixedTopIndex=new Np(yp(n)),n.fixedLeftIndex=new Dp(yp(n)),n.frozenLeftTop=new xp(yp(n)),n.frozenLeftIndex=new _p(yp(n)),n.frozenTopIndex=new kp(yp(n)),n.frozenRect=new Tp(yp(n)),n.screen=new bf(yp(n)),n.xReSizer=new Of(yp(n)),n.yReSizer=new Tf(yp(n)),n.xHeightLight=new Uf(yp(n)),n.yHeightLight=new Zf(yp(n)),n.edit=new rh(yp(n)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bp(t,e)}(e,t),wp(e,[{key:"onAttach",value:function(){var t=this;this.bind(),this.screenSelector=new os(this.screen),this.screenAutoFill=new Df(this.screen,{onBeforeAutoFill:function(){t.tableDataSnapshot.begin()},onAfterAutoFill:function(){t.tableDataSnapshot.end()}}),this.copyStyle=new Xa(this.screen,{}),this.screen.addWidget(this.screenSelector),this.screen.addWidget(this.screenAutoFill),this.screen.addWidget(this.copyStyle),this.screenSelector.on(rs.SELECT_CHANGE,(function(){t.trigger(r.TABLE_EVENT_TYPE.SELECT_CHANGE)})),this.screenSelector.on(rs.DOWN_SELECT,(function(){t.trigger(r.TABLE_EVENT_TYPE.SELECT_DOWN)})),this.attach(this.canvas),this.attach(this.screen),this.attach(this.xReSizer),this.attach(this.yReSizer),this.attach(this.xHeightLight),this.attach(this.yHeightLight),this.attach(this.edit),this.keyBoardTab=new Ip(this)}},{key:"bind",value:function(){var t=this,e=this.mousePointer,n=this.dynamicView;Wt.bind(this,r.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){n.cpRange(),t.render()})),Wt.bind(this,r.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){n.cpRange(),t.render()})),Wt.bind(this,r.SYSTEM_EVENT_TYPE.SCROLL,(function(){n.cpRange(),t.render()})),Wt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(n){var o=t.computeEventXy(n),i=o.x,c=o.y,l=t.getRiCiByXy(i,c),a=l.ri,s=l.ci;if(-1!==a)if(-1!==s){var u=r.MOUSE_POINTER_TYPE.SELECT_CELL,f=u.type,h=u.key;e.set(f,h)}else{var p=r.MOUSE_POINTER_TYPE.SELECT_ONE_ROW,y=p.type,b=p.key;e.set(y,b)}else{var d=r.MOUSE_POINTER_TYPE.SELECT_ONE_COLUMN,g=d.type,v=d.key;e.set(g,v)}}))}},{key:"drawOptimization",value:function(){var t=this.cellsHelper,e=this.dynamicView.getOriginScrollView(),n=!0;t.getCellByViewRange({rectRange:e,callback:function(t,e,r){var o=r.borderAttr,i=o.top,c=o.left,l=o.right,a=o.bottom;return i.type===Ii.DOUBLE_LINE?n=!1:c.type===Ii.DOUBLE_LINE?n=!1:l.type===Ii.DOUBLE_LINE?n=!1:a.type!==Ii.DOUBLE_LINE||(n=!1)}}),n?this.borderLineHandle.openDrawOptimization():this.borderLineHandle.closeDrawOptimization()}},{key:"scrollX",value:function(t){var e=this.cols,n=this.fixed,o=this.settings,i=this.scroll;o.tipsScrollTime&&console.time();var c=n.fxLeft;c+=1;var l,a=dp(S.rangeReduceIf(c,e.len,0,0,t,(function(t){return e.getWidth(t)})),3),s=a[0],u=a[1],f=a[2],h=u;t>0&&(h+=f),i.x>h?l=Zu.H_LEFT:i.x<h&&(l=Zu.H_RIGHT),i.type=l,i.ci=s,i.x=h,o.tipsScrollTime&&(console.log("滚动条计算耗时:"),console.timeEnd()),this.mode=mp.SCROLL,this.trigger(r.SYSTEM_EVENT_TYPE.SCROLL),this.mode=mp.RENDER,i.type=Zu.UN}},{key:"scrollY",value:function(t){var e=this.rows,n=this.fixed,o=this.settings,i=this.scroll;o.tipsScrollTime&&console.time();var c=n.fxTop;c+=1;var l,a=dp(S.rangeReduceIf(c,e.len,0,0,t,(function(t){return e.getHeight(t)})),3),s=a[0],u=a[1],f=a[2],h=u;t>0&&(h+=f),i.y>h?l=Zu.V_TOP:i.y<h&&(l=Zu.V_BOTTOM),i.type=l,i.ri=s,i.y=h,o.tipsScrollTime&&(console.log("滚动条计算耗时:"),console.timeEnd()),this.mode=mp.SCROLL,this.trigger(r.SYSTEM_EVENT_TYPE.SCROLL),this.mode=mp.RENDER,i.type=Zu.UN}},{key:"visualHeight",value:function(){return this.box().height}},{key:"visualWidth",value:function(){return this.box().width}},{key:"resize",value:function(){var t=this.draw,e=this.dynamicView,n=[this.visualWidth(),this.visualHeight()],r=n[0],o=n[1];t.resize(r,o),e.cpRange(),this.render()}},{key:"render",value:function(){var t=this.settings,e=this.fixed;t.tipsRenderTime&&console.time(),this.drawOptimization(),this.frozenRect.render(),e.fxLeft>-1&&e.fxTop>-1&&this.frozenLeftTop.render(),e.fxTop>-1&&(this.frozenLeftIndex.render(),this.fixedTop.render()),e.fxLeft>-1&&(this.frozenTopIndex.render(),this.fixedLeft.render()),this.content.render(),this.fixedLeftIndex.render(),this.fixedTopIndex.render(),t.tipsRenderTime&&(console.log("渲染界面耗时:"),console.timeEnd())}},{key:"getContentWidth",value:function(){return this.content.getContentWidth()}},{key:"getContentHeight",value:function(){return this.content.getContentHeight()}},{key:"getFixedWidth",value:function(){return this.fixedLeftOffset.getFixedWidth()}},{key:"getFixedHeight",value:function(){return this.fixedTopOffset.getFixedHeight()}},{key:"getContentViewRange",value:function(){return this.dynamicView.getOriginContentView()}},{key:"getScrollViewRange",value:function(){return this.dynamicView.getOriginScrollView()}},{key:"getScrollViewXOffset",value:function(){return this.dynamicView.getScrollXOffset()}},{key:"getRiCiByXy",value:function(t,e){var n=this.settings,r=this.fixed,o=this.rows,i=this.cols,c=n.index,l=this.getFixedHeight(),a=this.getFixedWidth(),s=t,u=e,f=-1,h=-1;if(s-=c.width,u-=c.height,s<=a&&t>c.width)for(var p=0,y=0;y<=r.fxLeft;y+=1){if(f=y,(p+=i.getWidth(y))>s)break}else if(t>c.width)for(var b=a,d=this.getScrollViewRange(),g=d.sci;g<=d.eci;g+=1){if(f=g,(b+=i.getWidth(g))>s)break}if(u<l&&e>c.height)for(var v=0,w=0;w<=r.fxTop;w+=1){if(h=w,(v+=o.getHeight(w))>u)break}else if(e>c.height)for(var m=l,O=this.getScrollViewRange(),E=O.sri;E<=O.eri;E+=1){if(h=E,(m+=o.getHeight(E))>u)break}return{ri:h,ci:f}}},{key:"getIndexWidth",value:function(){return this.settings.index.width}},{key:"getIndexHeight",value:function(){return this.settings.index.height}},{key:"toString",value:function(){var t={rows:{data:this.rows.getData()},cols:{data:this.cols.getData()},merges:{data:this.merges.getData()}};return JSON.stringify(t)}}]),e}(R);function Fp(t){return(Fp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Up(t,e){return!e||"object"!==Fp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xp(t){return(Xp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gp(t,e){return(Gp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Kp=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{tableConfig:{data:[]}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Up(this,Xp(e).call(this,"".concat(o,"-sheet")))).options=n,t.table=new Yp(t.options.tableConfig),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gp(t,e)}(e,t),n=e,(i=[{key:"bind",value:function(){var t=this;Wt.bind(this.table,r.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(e){t.trigger(r.TABLE_EVENT_TYPE.CHANGE_WIDTH,t),e.stopPropagation()})),Wt.bind(this.table,r.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(e){t.trigger(r.TABLE_EVENT_TYPE.CHANGE_HEIGHT,t),e.stopPropagation()})),Wt.bind(this.table,r.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(e){t.trigger(r.TABLE_EVENT_TYPE.SELECT_CHANGE,t),e.stopPropagation()})),Wt.bind(this.table,r.TABLE_EVENT_TYPE.SELECT_DOWN,(function(e){t.trigger(r.TABLE_EVENT_TYPE.SELECT_DOWN,t),e.stopPropagation()}))}},{key:"onAttach",value:function(){this.attach(this.table),this.bind()}}])&&zp(n.prototype,i),c&&zp(n,c),e}(R);function qp(t){return(qp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zp(t,e){return!e||"object"!==qp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jp(t){return(Jp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qp(t,e){return(Qp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ty=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{sheets:[]};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Zp(this,Jp(e).call(this,"".concat(o,"-work-body")))).work=t,n.workConfig=r,n.sheets=n.workConfig.sheets,n.tabSheet=[],n.poweredBy=T("div","".concat(o,"-powered-by-tips")),n.poweredBy.text(" X-Sheet 1.0.0-development "),n.children(n.poweredBy),n.sheetViewLayer=new Zt({style:{flexGrow:1}}),n.scrollBarYLayer=new Zt({style:{overflow:"inherit"}}),n.scrollBarXLayer=new bu,n.scrollBarXVerticalCenter=new mu,n.scrollBarXHorizontalLayer=new Zt({style:{flexGrow:2}}),n.scrollBarXVerticalCenter.children(n.scrollBarXLayer),n.scrollBarXHorizontalLayer.children(n.scrollBarXVerticalCenter),n.sheetSwitchTabLayer=new Zt({style:{flexGrow:3}}),n.horizontalLayer1=new ne,n.horizontalLayer2=new ne,n.horizontalLayer1.children(n.sheetViewLayer),n.horizontalLayer1.children(n.scrollBarYLayer),n.horizontalLayer2.children(n.sheetSwitchTabLayer),n.horizontalLayer2.children(n.scrollBarXHorizontalLayer),n.horizontalLayer1Layer=new K({style:{flexGrow:1}}),n.horizontalLayer2Layer=new K,n.layerVerticalLayer=new F,n.horizontalLayer1Layer.children(n.horizontalLayer1),n.horizontalLayer2Layer.children(n.horizontalLayer2),n.layerVerticalLayer.children(n.horizontalLayer1Layer),n.layerVerticalLayer.children(n.horizontalLayer2Layer),n.children(n.layerVerticalLayer),n.sheetView=new Tu,n.scrollBarY=new Xt({scroll:function(t){n.sheetView.getActiveSheet().table.scrollY(t)}}),n.tabView=new Iu({onAdd:function(){var t=new Kp,e=new Wu;n.addTabSheet({tab:e,sheet:t})},onSwitch:function(t){n.setActiveTab(t)}}),n.scrollBarX=new It({scroll:function(t){n.sheetView.getActiveSheet().table.scrollX(t)}}),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qp(t,e)}(e,t),n=e,(i=[{key:"updateScroll",value:function(){var t=this.sheetView.getActiveSheet();if(!S.isUnDef(t)){var e=this.scrollBarXHorizontalLayer,n=t.table,r=n.content,o=n.contentOffset,i=n.scroll;e.display(o.getFixedWidth()<r.getContentWidth()),this.scrollBarY.setSize(o.getFixedHeight(),r.getContentHeight()),this.scrollBarX.setSize(o.getFixedWidth(),r.getContentWidth()),this.scrollBarY.scrollMove(i.y),this.scrollBarX.scrollMove(i.x)}}},{key:"createSheet",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,o=this.sheets[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value,c=i.name,l=new Kp(i),a=new Wu(c);this.addTabSheet({tab:a,sheet:l})}}catch(t){e=!0,n=t}finally{try{t||null==o.return||o.return()}finally{if(e)throw n}}this.tabSheet.length&&this.setActiveIndex(0)}},{key:"bind",value:function(){var t=this;this.on(r.SYSTEM_EVENT_TYPE.MOUSE_WHEEL,(function(e){var n=t.sheetView.getActiveSheet();if(!S.isUnDef(n)){var r=n.table,o=r.rows,i=r.scroll,c=t.scrollBarY.scrollTo,l=e.deltaY;e.detail&&(l=40*e.detail),l>0?t.scrollBarY.scrollMove(c+o.getHeight(i.ri)):t.scrollBarY.scrollMove(c-o.getHeight(i.ri-1)),i.blockTop<i.maxBlockTop&&i.blockTop>0&&(e.preventDefault(),e.stopPropagation())}})),Wt.bind(window,r.SYSTEM_EVENT_TYPE.RESIZE,(function(){t.sheetView.getActiveSheet().table.resize(),t.updateScroll()})),Wt.bind(this.sheetView,r.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.updateScroll()})),Wt.bind(this.sheetView,r.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.updateScroll()})),Wt.bind(this.sheetView,r.TABLE_EVENT_TYPE.DATA_CHANGE,(function(e){t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),e.stopPropagation()})),Wt.bind(this.sheetView,r.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(e){t.trigger(r.TABLE_EVENT_TYPE.SELECT_CHANGE),e.stopPropagation()})),Wt.bind(this.sheetView,r.TABLE_EVENT_TYPE.SELECT_DOWN,(function(e){t.trigger(r.TABLE_EVENT_TYPE.SELECT_DOWN,t),e.stopPropagation()}))}},{key:"onAttach",value:function(){var t=this.sheetViewLayer,e=this.scrollBarYLayer,n=this.sheetSwitchTabLayer,r=this.scrollBarXLayer;t.attach(this.sheetView),e.attach(this.scrollBarY),n.attach(this.tabView),r.attach(this.scrollBarX),this.bind(),this.createSheet(),this.updateScroll()}},{key:"addTabSheet",value:function(t){var e=t.tab,n=t.sheet,r=this.tabSheet,o=this.sheetView,i=this.tabView;o.attach(n),i.attach(e),r.push({tab:e,sheet:n})}},{key:"setActiveIndex",value:function(t){var e=this.sheetView,n=this.tabView,o=e.setActiveSheet(t),i=n.setActiveTab(t);if(o&&i){var c=o.table;this.updateScroll(),c.resize(),this.trigger(r.WORK_BODY_EVENT_TYPE.CHANGE_ACTIVE)}}},{key:"setActiveTab",value:function(t){var e=this;this.tabSheet.forEach((function(n,r){n.tab===t&&e.setActiveIndex(r)}))}}])&&$p(n.prototype,i),c&&$p(n,c),e}(R);function ey(t){return(ey="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ny(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ry(t,e){return!e||"object"!==ey(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function oy(t){return(oy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function iy(t,e){return(iy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var cy=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ry(this,oy(e).call(this,"".concat(o,"-bottom-menu")))).sum=T("div","".concat(o,"-bottom-sum")),t.avg=T("div","".concat(o,"-bottom-avg")),t.number=T("div","".concat(o,"-bottom-number")),t.children(t.sum),t.children(t.avg),t.children(t.number),t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&iy(t,e)}(e,t),n=e,(r=[{key:"setSum",value:function(t){this.sum.text("求和: ".concat(t))}},{key:"setAvg",value:function(t){this.avg.text("平均数: ".concat(t))}},{key:"setNumber",value:function(t){this.number.text("数量: ".concat(t))}}])&&ny(n.prototype,r),i&&ny(n,i),e}(R);function ly(t){return(ly="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ay(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function sy(t,e){return!e||"object"!==ly(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function uy(t){return(uy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fy(t,e){return(fy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hy=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=sy(this,uy(e).call(this,"".concat(o,"-work-bottom")))).work=t,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fy(t,e)}(e,t),n=e,(r=[{key:"onAttach",value:function(){this.bottomMenu=new cy,this.attach(this.bottomMenu)}}])&&ay(n.prototype,r),i&&ay(n,i),e}(R);function py(t){return(py="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function by(t){return(by=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dy(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gy(t,e){return(gy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vy=function(t){function e(){var t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{body:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(r=by(e).call(this,"".concat(o,"-work")))||"object"!==py(r)&&"function"!=typeof r?dy(n):r).options=i.workConfig,t.topLayer=new K,t.bodyLayer=new K({style:{flexGrow:1}}),t.bottomLayer=new K,t.verticalLayer=new F,t.verticalLayer.children(t.topLayer),t.verticalLayer.children(t.bodyLayer),t.verticalLayer.children(t.bottomLayer),t.children(t.verticalLayer),t.top=new uu(dy(t)),t.body=new ty(dy(t),t.options.body),t.bottom=new hy(dy(t)),t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gy(t,e)}(e,t),n=e,(r=[{key:"onAttach",value:function(){var t=this.bodyLayer,e=this.topLayer,n=this.bottomLayer;e.attach(this.top),n.attach(this.bottom),t.attach(this.body),this.bottom.bottomMenu.setSum(0),this.bottom.bottomMenu.setAvg(0),this.bottom.bottomMenu.setNumber(0)}}])&&yy(n.prototype,r),i&&yy(n,i),e}(R);n(3),n(4);function wy(t){return(wy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function my(t){return(my=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oy(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ey(t,e){return(Ey=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.d(e,"XSheet",(function(){return Sy}));var Sy=function(t){function e(t){var n,r,i,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{workConfig:{body:{sheets:[{tableConfig:{}}]}}};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,n=!(i=my(e).call(this,"".concat(o)))||"object"!==wy(i)&&"function"!=typeof i?Oy(r):i;var l=t;return"string"==typeof t&&(l=document.querySelector(t)),(l=T(l)).children(Oy(n)),n.work=new vy(c),n.attach(n.work),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ey(t,e)}(e,t),e}(R);Sy.version="1.0.1-alpha",window&&(window.XSheet=Sy)}]);
//# sourceMappingURL=XSheet.js.map