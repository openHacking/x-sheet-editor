!function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=7)}([function(t,e,n){t.exports=n.p+"c4ab8001e109540f7ae6a34181d695d3.png"},function(t,e,n){t.exports=n.p+"42b436e7c64603182355d52d31ea49f1.png"},function(t,e,n){t.exports=n.p+"9dfd8685ea7e1e5c025514eec46a4547.png"},function(t,e,n){t.exports=n.p+"51859b5219dccb48ef2a5659717d0a1b.svg"},function(t,e,n){var o,r,i;r=[],void 0===(i="function"==typeof(o=function(){return function t(e,n,o){var r,i,c=window,l="application/octet-stream",u=o||l,a=e,s=!n&&!o&&a,f=document.createElement("a"),h=function(t){return String(t)},p=c.Blob||c.MozBlob||c.WebKitBlob||h,y=n||"download";if(p=p.call?p.bind(c):Blob,"true"===String(this)&&(u=(a=[a,u])[0],a=a[1]),s&&s.length<2048&&(y=s.split("/").pop().split("?")[0],f.href=s,-1!==f.href.indexOf(s))){var b=new XMLHttpRequest;return b.open("GET",s,!0),b.responseType="blob",b.onload=function(e){t(e.target.response,y,l)},setTimeout((function(){b.send()}),0),b}if(/^data\:[\w+\-]+\/[\w+\-]+[,;]/.test(a)){if(!(a.length>2096103.424&&p!==h))return navigator.msSaveBlob?navigator.msSaveBlob(d(a),y):v(a);u=(a=d(a)).type||l}function d(t){for(var e=t.split(/[:;,]/),n=e[1],o=("base64"==e[2]?atob:decodeURIComponent)(e.pop()),r=o.length,i=0,c=new Uint8Array(r);i<r;++i)c[i]=o.charCodeAt(i);return new p([c],{type:n})}function v(t,e){if("download"in f)return f.href=t,f.setAttribute("download",y),f.className="download-js-link",f.innerHTML="downloading...",f.style.display="none",document.body.appendChild(f),setTimeout((function(){f.click(),document.body.removeChild(f),!0===e&&setTimeout((function(){c.URL.revokeObjectURL(f.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return t=t.replace(/^data:([\w\/\-\+]+)/,l),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var n=document.createElement("iframe");document.body.appendChild(n),e||(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,l)),n.src=t,setTimeout((function(){document.body.removeChild(n)}),333)}if(r=a instanceof p?a:new p([a],{type:u}),navigator.msSaveBlob)return navigator.msSaveBlob(r,y);if(c.URL)v(c.URL.createObjectURL(r),!0);else{if("string"==typeof r||r.constructor===h)try{return v("data:"+u+";base64,"+c.btoa(r))}catch(t){return v("data:"+u+","+encodeURIComponent(r))}(i=new FileReader).onload=function(t){v(this.result)},i.readAsDataURL(r)}return!0}})?o.apply(e,r):o)||(t.exports=i)},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var o={},r="x-sheet",i="".concat(r," 1.0.0-develop");function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function l(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(){return(65536*(1+Math.random())|0).toString(16).substring(1)}o.WORK_BODY_EVENT_TYPE={CHANGE_ACTIVE:"changeactive"},o.SYSTEM_EVENT_TYPE={MOUSE_MOVE:"mousemove",MOUSE_DOWN:"mousedown",SCROLL:"scroll",RESIZE:"resize",MOUSE_UP:"mouseup",KEY_UP:"keyup",INPUT:"input",KEY_DOWN:"keydown",MOUSE_OVER:"mouseover",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",MOUSE_ENTER:"mouseenter",CLICK:"click",DRAG_START:"dragstart",CHANGE:"change",VISIBILITY_CHANGE:"visibilitychange"},o.TABLE_EVENT_TYPE={CHANGE_HEIGHT:"changeheight",SELECT_OVER:"selectover",SCALE_CHANGE:"scalechange",FIXED_CHANGE:"fixedchange",SELECT_DOWN:"selectdown",SELECT_CHANGE:"selectchange",DATA_CHANGE:"datachange",CHANGE_WIDTH:"changewidth",RESIZE_CHANGE:"resizechange",RENDER:"render"},o.FORM_EVENT_TYPE={SEARCH_INPUT_CHANGE:"searchinputchange",PLAIN_INPUT_CHANGE:"plaininputchange",FORM_SELECT_CHANGE:"formselectchange"};var a=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],s=1,f=2,h=3,p=5,y=6,b=7,d=8,v=9,g=10,w=11,m=12,O=13,E=14,S=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,n=null,o=[{key:"isWindows",value:function(){return/windows|win32/i.test(navigator.userAgent)}},{key:"isMac",value:function(){return/macintosh|mac os x/i.test(navigator.userAgent)}},{key:"isNotEmptyObject",value:function(e){return!t.isEmptyObject(e)}},{key:"isEmptyObject",value:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}},{key:"isUnDef",value:function(t){return null==t}},{key:"isNotUnDef",value:function(t){return!this.isUnDef(t)}},{key:"isNumber",value:function(t){return/^(-?\d+.\d+)$|^(-?\d+)$/.test(t)}},{key:"isFraction",value:function(t){return/^\d+\/\d+$/.test(t)}},{key:"isFunction",value:function(e){return t.type(e)===y}},{key:"isArray",value:function(e){return t.type(e)===p}},{key:"isBlank",value:function(e){return!!t.isUnDef(e)||""===e.toString().trim()}},{key:"isPlainObject",value:function(e){return!t.isUnDef(e)&&Object.getPrototypeOf(e)===Object.getPrototypeOf({})}},{key:"isString",value:function(e){return t.type(e)===s}},{key:"mergeDeep",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.isUnDef(e))return{};for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return t.isUnDef(o)||0===o.length?e:(o.forEach((function(n){t.isUnDef(n)||Object.keys(n).forEach((function(o){var r=n[o];"string"==typeof r||"number"==typeof r||"boolean"==typeof r?e[o]=r:"function"!=typeof r&&!Array.isArray(r)&&t.isPlainObject(r)?(e[o]=e[o]||{},t.mergeDeep(e[o],r)):e[o]=r}))})),e)}},{key:"toLowCase",value:function(t){return t.toLowerCase()}},{key:"type",value:function(t){var e=Object.prototype.toString.call(t);switch(e){case"[object Null]":return b;case"[object Undefined]":return d;case"[object String]":return s;case"[object Boolean]":return f;case"[object Number]":return h;case"[object Function]":return y;case"[object Array]":return p;case"[object Promise]":return v;case"[object GeneratorFunction]":return g;case"[object AsyncFunction]":return w;case"[object BigInt]":return m;case"[object Symbol]":return O;default:return E}}},{key:"cloneDeep",value:function(t){var e=JSON.stringify(t);return JSON.parse(e)}},{key:"copyProp",value:function(t,e){return Object.assign(t,e)}},{key:"sum",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},n=0,o=0;return Object.keys(t).forEach((function(r){n+=e(t[r],r),o+=1})),[n,o]}},{key:"parseFloat",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(e){return t.isNumber(e)?parseFloat(e):0}))},{key:"parseInt",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(e){return t.isNumber(e)?parseInt(e,10):0}))},{key:"stringAt",value:function(t){for(var e="",n=t;n>=a.length;)n/=a.length,n-=1,e+=a[parseInt(n,10)%a.length];return e+=a[t%a.length]}},{key:"indexAt",value:function(t){for(var e=0,n=0;n<t.length-1;n+=1){var o=t.charCodeAt(n)-65,r=t.length-1-n;e+=Math.pow(a.length,r)+a.length*o}return e+=t.charCodeAt(t.length-1)-65}},{key:"expr2xy",value:function(e){for(var n="",o="",r=0;r<e.length;r+=1)e.charAt(r)>="0"&&e.charAt(r)<="9"?o+=e.charAt(r):n+=e.charAt(r);return[t.indexAt(n),parseInt(o,10)-1]}},{key:"xy2expr",value:function(e,n){return"".concat(t.stringAt(e)).concat(n+1)}},{key:"expr2expr",value:function(e,n,o){var r=c(t.expr2xy(e),2),i=r[0],l=r[1];return t.xy2expr(i+n,l+o)}},{key:"minIf",value:function(t,e){return t<e?e:t}},{key:"keepLastIndex",value:function(t){if(window.getSelection){t.focus();var e=window.getSelection();e.selectAllChildren(t),e.collapseToEnd()}else if(document.selection){var n=document.selection.createRange();n.moveToElementText(t),n.collapse(!1),n.select()}}},{key:"trim",value:function(t){return this.isBlank(t)?"":t.trim()}},{key:"now",value:function(){return Date.now().toString()}},{key:"viewPort",value:function(){return{width:window.innerWidth,height:window.innerHeight}}},{key:"exitFullscreen",value:function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}},{key:"fullScreen",value:function(t){t.el&&(t=t.el),t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}},{key:"isFull",value:function(){return!!(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)}},{key:"uuid",value:function(){return"".concat(u()+u()).concat(u()).concat(u()).concat(u()).concat(u()).concat(u()).concat(u())}},{key:"getExplorerInfo",value:function(){var t=window.navigator.userAgent.toLowerCase();return t.indexOf("firefox")>=0?{type:"Firefox",version:t.match(/firefox\/([\d.]+)/)[1]}:t.indexOf("chrome")>=0?{type:"Chrome",version:t.match(/chrome\/([\d.]+)/)[1]}:t.indexOf("opera")>=0?{type:"Opera",version:t.match(/opera.([\d.]+)/)[1]}:t.indexOf("Safari")>=0?{type:"Safari",version:t.match(/version\/([\d.]+)/)[1]}:t.indexOf("msie")>=0?{type:"IE",version:t.match(/msie ([\d.]+)/)[1]}:void 0}}],n&&l(e.prototype,n),o&&l(e,o),t}();function _(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function T(t,e,n){return e&&_(t.prototype,e),n&&_(t,n),t}S.EMPTY="",S.Nul=null,S.Undef=void 0;var x=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=n):this.el=e,this.el.data=[]}return T(t,null,[{key:"wrap",value:function(e){if(S.isArray(e)){var n=[];return e.forEach((function(e){e instanceof t?n.push(e):n.push(new t(e))})),n}return new t(e)}}]),T(t,[{key:"children",value:function(){for(var e=this,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return 0===arguments.length?t.wrap(this.el.childNodes):(o.forEach((function(t){return e.append(t)})),this)}},{key:"append",value:function(t){this.el.appendChild(t.el)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"data",value:function(t,e){return void 0!==e?(this.el.data[t]=e,this):this.el.data[t]}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach((function(n){e.css(n,"".concat(t[n],"px"))})),this;var n=this.el;return{top:n.offsetTop,left:n.offsetLeft,height:n.offsetHeight,width:n.offsetWidth}}},{key:"parent",value:function(){return t.wrap(this.el.parentNode)}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"first",value:function(){return t.wrap(this.el.firstChild)}},{key:"last",value:function(){return t.wrap(this.el.lastChild)}},{key:"remove",value:function(t){return this.el.removeChild(t.el||t),this}},{key:"contains",value:function(t){return this.el.contains(t.el)}},{key:"prev",value:function(){return t.wrap(this.el.previousSibling)}},{key:"next",value:function(){return t.wrap(this.el.nextSibling)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"text",value:function(t){return void 0!==t?(this.el.innerText=t,this):this.el.innerText}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"focus",value:function(){this.el.focus()}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"attr",value:function(t,e){var n=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach((function(e){n.el.setAttribute(e,t[e])}))}return this}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return n.forEach((function(e){return t.el.style.removeProperty(e)})),this}},{key:"css",value:function(t,e){var n=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach((function(e){n.el.style[e]=t[e]})),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){var t=this.computedStyle();return t&&"block"!==t.display&&this.css("display","block"),this}},{key:"hide",value:function(){var t=this.computedStyle();return t&&"none"!==t.display&&this.css("display","none"),this}},{key:"trigger",value:function(t,e){var n=new CustomEvent(t,{detail:e,bubbles:!0,cancelable:!1});this.el.dispatchEvent(n)}},{key:"find",value:function(e){var n=this.el.querySelectorAll(e);if(n&&1===n.length)return new t(n[0]);var o=[];if(n){var r=!0,i=!1,c=void 0;try{for(var l,u=n[Symbol.iterator]();!(r=(l=u.next()).done);r=!0){var a=l.value;o.push(new t(a))}}catch(t){i=!0,c=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw c}}}return o}},{key:"sibling",value:function(){for(var e=this.el,n=[];null!==(e=e.previousElementSibling);)n.push(new t(e));for(e=this.el;null!==(e=e.nextElementSibling);)n.push(new t(e));return n}},{key:"is",value:function(t){return this.el===t.el}},{key:"after",value:function(t){this.el.after(t.el)}},{key:"before",value:function(t){this.el.before(t.el)}},{key:"empty",value:function(){this.html("")}}]),t}(),k=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new x(t,e)};function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function C(t,e,n){return e&&j(t.prototype,e),n&&j(t,n),t}var R=new(function(){function t(){P(this,t),this.pool=[]}return C(t,[{key:"unbind",value:function(t,e,n,o){t instanceof x&&(t=t.el);var r=this.remove(t,e,n,o);r.length?r.forEach((function(e){t.removeEventListener(e.type,e.callback,e.option)})):t.removeEventListener(e,n,o)}},{key:"bind",value:function(t,e,n,o){t instanceof x&&(t=t.el),this.pool.push({ele:t,type:e,callback:n,option:o}),t.addEventListener(e,n,o)}},{key:"remove",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=[],i=[];return this.pool.forEach((function(c){var l=t===c.ele,u=null===o||o===c.option,a="*"===e||e===c.type,s=null===n||n===c.callback;l&&a&&s&&u?i.push(c):r.push(c)})),this.pool=r,i}},{key:"multipleUnbind",value:function(t,e,n,o){var r=this;t.forEach((function(t){r.unbind(t,e,n,o)}))}},{key:"multipleBind",value:function(t,e,n,o){var r=this;t.forEach((function(t){r.bind(t,e,n,o)}))}}]),t}()),L=function(){function t(){P(this,t)}return C(t,null,[{key:"unbind",value:function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Array.isArray(t)?R.multipleUnbind(t,e,n,o):R.unbind(t,e,n,o)}},{key:"bind",value:function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Array.isArray(t)?R.multipleBind(t,e,n,o):R.bind(t,e,n,o)}},{key:"mouseDoubleClick",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=0,i=0,c=0;t.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){var e=Date.now(),o=t.pageX,l=t.pageY;e-r<=300&&o===i&&l===c?(n(t),r=0,i=0,c=0):(i=o,c=l,r=e)}))}},{key:"mouseMoveUp",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=function(t){n(t),t.stopPropagation()},c=function n(c){t.unbind(e,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,i,!0),t.unbind(e,o.SYSTEM_EVENT_TYPE.MOUSE_UP,n,!0),r(c),c.stopPropagation()};t.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,i,!0),t.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_UP,c,!0)}}]),t}();function A(t){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function N(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function V(t,e,n){return e&&I(t.prototype,e),n&&I(t,n),t}function D(t,e){return!e||"object"!==A(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function M(t){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function H(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&F(t,e)}function F(t,e){return(F=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}window.XEventPool=R;var B=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div";return N(this,e),t=D(this,"string"==typeof n?M(e).call(this,o,"".concat(r,"-widget ").concat(n)):M(e).call(this,n)),D(t)}return H(e,t),V(e,[{key:"eventXy",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=e.box(),o=n.top,r=n.left;return{x:t.pageX-r,y:t.pageY-o}}},{key:"attach",value:function(t){this.children(t),t.onAttach(this)}},{key:"closestClass",value:function(t){for(var e=this;!k(document.body).is(e);){if(e.hasClass(t))return e;e=e.parent()}return null}},{key:"destroy",value:function(){L.unbind(this)}}]),e}(function(t){function e(){return N(this,e),D(this,M(e).apply(this,arguments))}return H(e,t),V(e,[{key:"onAttach",value:function(){}}]),e}(x));function W(t){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Y(t,e){return!e||"object"!==W(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function U(t){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function z(t,e){return(z=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var G=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Y(this,U(e).call(this,"".concat(r,"-layer ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&z(t,e)}(e,t),e}(B);function X(t){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Z(t,e){return!e||"object"!==X(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function K(t){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $(t,e){return($=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var q=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Z(this,K(e).call(this,"".concat(r,"-vertical-layer")))).options=S.mergeDeep({style:{}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$(t,e)}(e,t),e}(G);function Q(t){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function J(t,e){return!e||"object"!==Q(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tt(t){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function et(t,e){return(et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=J(this,tt(e).call(this,"".concat(r,"-vertical-layer-element")))).options=S.mergeDeep({style:{flexGrow:"0"}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&et(t,e)}(e,t),e}(G);function ot(t){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function it(t,e){return!e||"object"!==ot(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ct(t){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lt(t,e){return(lt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ut=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=it(this,ct(e).call(this,"".concat(r,"-icon")))).iconNameEl=k("div","".concat(r,"-icon-img ").concat(n)),t.children(t.iconNameEl),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lt(t,e)}(e,t),n=e,(o=[{key:"setWidth",value:function(t){this.iconNameEl.css("width","".concat(t,"px"))}},{key:"setHeight",value:function(t){this.iconNameEl.css("height","".concat(t,"px"))}}])&&rt(n.prototype,o),i&&rt(n,i),e}(B);function at(t){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function st(t,e){return!e||"object"!==at(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ft(t){return(ft=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ht(t,e){return(ht=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pt=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),st(this,ft(e).call(this,"".concat(r,"-tools-item ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ht(t,e)}(e,t),e}(B);function yt(t){return(yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bt(t,e){return!e||"object"!==yt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dt(t){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vt(t,e){return(vt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=bt(this,dt(e).call(this,"".concat(r,"-tools-undo")))).icon=new ut("undo"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vt(t,e)}(e,t),e}(pt);function wt(t){return(wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mt(t,e){return!e||"object"!==wt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ot(t){return(Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Et(t,e){return(Et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var St=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=mt(this,Ot(e).call(this,"".concat(r,"-tools-redo")))).icon=new ut("redo"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Et(t,e)}(e,t),e}(pt);function _t(t){return(_t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function xt(t,e){return!e||"object"!==_t(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kt(t){return(kt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pt(t,e){return(Pt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=xt(this,kt(e).call(this,"".concat(r,"-tools-point-format")))).icon=new ut("point-format"),t.sheets=[],t.children(t.icon),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pt(t,e)}(e,t),n=e,(o=[{key:"addSheet",value:function(t){this.sheets.push(t)}},{key:"removeSheet",value:function(t){for(var e=0;e<this.sheets.length;e+=1)if(this.sheets[e]===t)return void this.sheets.splice(e,1)}},{key:"includeSheet",value:function(t){for(var e=0;e<this.sheets.length;e+=1)if(this.sheets[e]===t)return!0;return!1}}])&&Tt(n.prototype,o),i&&Tt(n,i),e}(pt);function Ct(t){return(Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rt(t,e){return!e||"object"!==Ct(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lt(t){return(Lt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function At(t,e){return(At=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Rt(this,Lt(e).call(this,"".concat(r,"-tools-clear-format")))).icon=new ut("clear-format"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&At(t,e)}(e,t),e}(pt);function It(t){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Dt(t,e){return!e||"object"!==It(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mt(t){return(Mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ht(t,e){return(Ht=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ft=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Dt(this,Mt(e).call(this,"".concat(r,"-tools-drop-down-item ").concat(t)))).drop=k("div","".concat(r,"-tools-drop-down-item-mark")),n.title=k("div","".concat(r,"-tools-drop-down-item-title")),n.drop.children(new ut("arrow-down")),n.children(n.title),n.children(n.drop),n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ht(t,e)}(e,t),n=e,(o=[{key:"setTitle",value:function(t){this.title.text(t)}},{key:"setIcon",value:function(t){this.title.html(""),this.title.children(t)}},{key:"setWidth",value:function(t){this.title.css("width","".concat(t,"px"))}},{key:"setEllipsis",value:function(){this.title.css("overflow","hidden"),this.title.css("text-overflow","ellipsis"),this.title.css("white-space","nowrap")}},{key:"removeEllipsis",value:function(){this.title.cssRemoveKeys("overflow"),this.title.cssRemoveKeys("text-overflow"),this.title.cssRemoveKeys("white-space")}}])&&Vt(n.prototype,o),i&&Vt(n,i),e}(pt);function Bt(t){return(Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Yt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ut(t,e,n){return(Ut="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=zt(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function zt(t){return(zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gt(t,e){return(Gt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xt=S.Nul,Zt=[],Kt=function(t){function e(t){var n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,i=zt(e).call(this,"".concat(r,"-el-pop-up")),(n=!i||"object"!==Bt(i)&&"function"!=typeof i?Yt(o):i).options=S.mergeDeep({el:S.Nul,autoWidth:!1,autoHeight:!1,position:e.POPUP_POSTION.TB},t),n.direction=S.Undef,n.status=!1,n.location=0,n.spaces=0,n.elPopUpDownHandle=function(){n.close()},Zt.push(Yt(n)),n.bind(),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gt(t,e)}(e,t),n=e,c=[{key:"removeInstance",value:function(t){var e=[];Zt.forEach((function(n){n!==t&&e.push(n)})),Zt=e}},{key:"closeAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Zt.forEach((function(e){-1===t.indexOf(e)&&e.close()}))}},{key:"setRoot",value:function(t){t=t.el?k(t.el):k(t),Xt=t}}],(i=[{key:"open",value:function(){!1===this.status&&Xt&&(Xt.children(this),this.status=!0),this.elPopUpPosition(),this.elPopUpAutosize(),this.elPopUpLocation()}},{key:"close",value:function(){!0===this.status&&Xt&&(Xt.remove(this),this.status=!1)}},{key:"unbind",value:function(){L.unbind(this),L.unbind(document,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,this.elPopUpDownHandle)}},{key:"bind",value:function(){L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){t.stopPropagation()})),L.bind(document,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,this.elPopUpDownHandle)}},{key:"elPopUpAutosize",value:function(){var t=this.options,e=this.direction,n=this.spaces,o=t.autoWidth,r=t.autoHeight;if(o){this.css("width","initial"),this.css("overflow-x","initial");var i=this.box().width;switch(e){case"left":case"right":i>n&&(this.css("overflow-x","auto"),this.css("width","".concat(n,"px")))}}if(r){this.css("height","initial"),this.css("overflow-y","initial");var c=this.box().height;switch(e){case"top":case"bottom":c>n&&(this.css("overflow-y","auto"),this.css("height","".concat(n,"px")))}}}},{key:"elPopUpPosition",value:function(){var t=this.options,n=t.position,o=t.el.box(),r=window.innerWidth,i=window.innerHeight;switch(this.direction=S.Undef,this.spaces=0,this.location=0,n){case e.POPUP_POSTION.LR:var c=o.width,l=o.left,u=l,a=r-(l+c);u>a?(this.direction="left",this.spaces=u,this.location=l):(this.direction="right",this.spaces=a,this.location=l+c);break;case e.POPUP_POSTION.TB:var s=o.height,f=o.top,h=f,p=i-(f+s);h>p?(this.direction="top",this.spaces=h,this.location=f):(this.direction="bottom",this.spaces=p,this.location=f+s)}}},{key:"elPopUpLocation",value:function(){var t=this.direction,e=this.location,n=this.options.el,o=this.box(),r=n.box(),i=r.left,c=r.top,l=o.width,u=o.height;switch(t){case"left":this.css("top","".concat(c,"px")),this.css("left","".concat(e-l,"px"));break;case"right":this.css("top","".concat(c,"px")),this.css("left","".concat(e,"px"));break;case"top":this.css("left","".concat(i,"px")),this.css("top","".concat(e-u,"px"));break;case"bottom":this.css("left","".concat(i,"px")),this.css("top","".concat(e,"px"))}}},{key:"setEL",value:function(t){this.options.el=t}},{key:"destroy",value:function(){Ut(zt(e.prototype),"destroy",this).call(this),this.unbind()}}])&&Wt(n.prototype,i),c&&Wt(n,c),e}(B);function $t(t){return($t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Qt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jt(t,e,n){return(Jt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=te(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function te(t){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ee(t,e){return(ee=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Kt.POPUP_POSTION={TB:Symbol("上下位置"),LR:Symbol("左右位置")};var ne=function(t){function e(){var t,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=te(e).call(this,"".concat(r,"-el-context-menu ").concat(i)))||"object"!==$t(o)&&"function"!=typeof o?Qt(n):o).options=S.mergeDeep({},c),t.menus=[],t.elPopUp=new Kt(t.options),t.elPopUp.children(Qt(t)),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ee(t,e)}(e,t),n=e,(o=[{key:"isClose",value:function(){return!1===this.elPopUp.status}},{key:"addItem",value:function(t){return this.menus.push(t),this.children(t),this}},{key:"open",value:function(){return this.elPopUp.open(),this}},{key:"close",value:function(){return this.elPopUp.close(),this}},{key:"setEL",value:function(t){this.elPopUp.setEL(t)}},{key:"destroy",value:function(){Jt(te(e.prototype),"destroy",this).call(this),this.elPopUp.destroy()}}])&&qt(n.prototype,o),i&&qt(n,i),e}(B);function oe(t){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function re(t,e){return!e||"object"!==oe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ie(t){return(ie=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ce(t,e){return(ce=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var le=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),re(this,ie(e).call(this,"".concat(r,"-el-context-menu-item hover ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ce(t,e)}(e,t),e}(B);function ue(t){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ae(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function se(t){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fe(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function he(t,e){return(he=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pe=[],ye=function(t){function e(t,n){var o,i,c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i=this,(o=!(c=se(e).call(this,"".concat(r,"-format-context-menu-item")))||"object"!==ue(c)&&"function"!=typeof c?fe(i):c).title=t,o.desc=n,o.icon=new ut("checked"),o.iconElement=k("div","".concat(r,"-format-context-menu-item-icon")),o.iconElement.children(o.icon),o.titleElement=k("div","".concat(r,"-format-context-menu-item-title")),o.descElement=k("div","".concat(r,"-format-context-menu-item-desc")),o.titleElement.text(t),o.descElement.text(n),o.children(o.iconElement),o.children(o.titleElement),o.children(o.descElement),pe.push(fe(o)),o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&he(t,e)}(e,t),n=e,(o=[{key:"setTitle",value:function(t){this.titleElement.text(t)}},{key:"setDesc",value:function(t){this.descElement.text(t)}},{key:"setActive",value:function(){pe.forEach((function(t){t.removeClass("active")})),this.addClass("active")}}])&&ae(n.prototype,o),i&&ae(n,i),e}(le);function be(t){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function de(t,e){return!e||"object"!==be(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ve(t){return(ve=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ge(t,e){return(ge=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var we=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),de(this,ve(e).call(this,"".concat(r,"-el-context-menu-item-divider")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ge(t,e)}(e,t),e}(B);function me(t){return(me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oe(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ee(t,e){return!e||"object"!==me(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Se(t,e,n){return(Se="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_e(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function _e(t){return(_e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Te(t,e){return(Te=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xe=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ee(this,_e(e).call(this,"".concat(r,"-format-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).items=[new ye("常规","").data("type","default"),new ye("文本","").data("type","text"),new we,new ye("数值","0.59").data("type","number"),new ye("百分比","90.00%").data("type","percentage"),new ye("分数","1/2").data("type","fraction"),new ye("科学计数","9.50e-01").data("type","ENotation"),new we,new ye("人民币","￥5.00").data("type","rmb"),new ye("港币","HK5.00").data("type","hk"),new ye("美元","$5.00").data("type","dollar"),new we,new ye("日期","2018/4/18").data("type","date1"),new ye("日期","4月18日").data("type","date2"),new ye("日期","2018年4月").data("type","date3"),new ye("日期","2018年4月18日").data("type","date4"),new ye("日期","2018/4/18 14:30:30").data("type","date5"),new ye("时间","14:30:30").data("type","time")],t.items.forEach((function(e){t.addItem(e)})),t.init(),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Te(t,e)}(e,t),n=e,(i=[{key:"init",value:function(){var t=this.options,e=this.items,n=t.el,o=e[0];n.setTitle(o.title),o.setActive()}},{key:"update",value:function(t,e){this.options.onUpdate(t,e),this.close()}},{key:"unbind",value:function(){this.items.forEach((function(t){t instanceof ye&&t.data("type")&&L.unbind(t,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN)}))}},{key:"bind",value:function(){var t=this;this.items.forEach((function(e){e instanceof ye&&e.data("type")&&L.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.update(e.data("type"),e.title),e.setActive()}))}))}},{key:"setActiveByType",value:function(t){this.items.forEach((function(e){e.data("type")===t&&e.setActive()}))}},{key:"destroy",value:function(){Se(_e(e.prototype),"destroy",this).call(this),this.unbind()}}])&&Oe(n.prototype,i),c&&Oe(n,c),e}(ne);function ke(t){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function je(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ce(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Re(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Le(t,e,n){return(Le="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ae(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Ae(t){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ne(t,e){return(Ne=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ie=function(t){function e(){var t,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=Ae(e).call(this,"".concat(r,"-tools-format")))||"object"!==ke(o)&&"function"!=typeof o?Re(n):o).options=i,t.setTitle("常规"),t.setWidth(50),t.setEllipsis(),t.formatContextMenu=new xe(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Pe(Object(n),!0).forEach((function(e){je(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({el:Re(t)},t.options.contextMenu)),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ne(t,e)}(e,t),n=e,(o=[{key:"destroy",value:function(){Le(Ae(e.prototype),"destroy",this).call(this),this.formatContextMenu.destroy()}}])&&Ce(n.prototype,o),i&&Ce(n,i),e}(Ft);function Ve(t){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function De(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Me(t){return(Me=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function He(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fe(t,e){return(Fe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Be=[],We=function(t){function e(t){var n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(i=Me(e).call(this,"".concat(r,"-font-context-menu-item")))||"object"!==Ve(i)&&"function"!=typeof i?He(o):i).title=t,n.icon=new ut("checked"),n.iconElement=k("div","".concat(r,"-font-context-menu-item-icon")),n.iconElement.children(n.icon),n.titleElement=k("div","".concat(r,"-font-context-menu-item-title")),n.titleElement.text(t),n.titleElement.css("font-family",t),n.children(n.iconElement),n.children(n.titleElement),Be.push(He(n)),n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fe(t,e)}(e,t),n=e,(o=[{key:"setActive",value:function(){Be.forEach((function(t){t.removeClass("active")})),this.addClass("active")}},{key:"setTitle",value:function(t){this.title=t,this.titleElement.text(t)}}])&&De(n.prototype,o),i&&De(n,i),e}(le);function Ye(t){return(Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ue(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ze(t,e){return!e||"object"!==Ye(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ge(t,e,n){return(Ge="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xe(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Xe(t){return(Xe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ze(t,e){return(Ze=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ke=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ze(this,Xe(e).call(this,"".concat(r,"-font-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).items=[new We("Arial"),new We("Helvetica"),new We("Source Sans Pro"),new We("Comic Sans Ms"),new We("Courier New"),new We("Verdana"),new We("Lalo")],t.items.forEach((function(e){t.addItem(e)})),t.setActiveByType(t.items[0].title),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ze(t,e)}(e,t),n=e,(i=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}},{key:"unbind",value:function(){this.items.forEach((function(t){L.unbind(t)}))}},{key:"bind",value:function(){var t=this;this.items.forEach((function(e){L.bind(e,o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.title),e.setActive()}))}))}},{key:"setActiveByType",value:function(t){this.items.forEach((function(e){e.title===t&&e.setActive()}))}},{key:"destroy",value:function(){Ge(Xe(e.prototype),"destroy",this).call(this),this.unbind()}}])&&Ue(n.prototype,i),c&&Ue(n,c),e}(ne);function $e(t){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Qe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Je(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function tn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function en(t,e,n){return(en="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=nn(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function nn(t){return(nn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function on(t,e){return(on=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rn=function(t){function e(){var t,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=nn(e).call(this,"".concat(r,"-tools-font")))||"object"!==$e(o)&&"function"!=typeof o?tn(n):o).options=i,t.setTitle("Arial"),t.setWidth(50),t.setEllipsis(),t.fontContextMenu=new Ke(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qe(Object(n),!0).forEach((function(e){Qe(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({el:tn(t)},t.options.contextMenu)),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&on(t,e)}(e,t),n=e,(o=[{key:"destroy",value:function(){en(nn(e.prototype),"destroy",this).call(this),this.fontContextMenu.destroy()}}])&&Je(n.prototype,o),i&&Je(n,i),e}(Ft);function cn(t){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ln(t,e){return!e||"object"!==cn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function un(t){return(un=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function an(t,e){return(an=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sn=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ln(this,un(e).call(this,"".concat(r,"-font-size-context-menu-item")))).size=t,n.titleElement=k("div","".concat(r,"-font-size-context-menu-item-title")),n.titleElement.text(t),n.titleElement.css("text-align","center"),n.children(n.titleElement),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&an(t,e)}(e,t),e}(le);function fn(t){return(fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function pn(t,e){return!e||"object"!==fn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function yn(t,e,n){return(yn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=bn(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function bn(t){return(bn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dn(t,e){return(dn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vn=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=pn(this,bn(e).call(this,"".concat(r,"-font-size-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).items=[new sn(6),new sn(7),new sn(8),new sn(9),new sn(10),new sn(11),new sn(12),new sn(14),new sn(15),new sn(18),new sn(24),new sn(36)],t.items.forEach((function(e){t.addItem(e)})),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dn(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){this.items.forEach((function(t){L.unbind(t,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN)}))}},{key:"bind",value:function(){var t=this;this.items.forEach((function(e){L.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.update(e.size)}))}))}},{key:"update",value:function(t){this.options.onUpdate(t),this.close()}},{key:"destroy",value:function(){yn(bn(e.prototype),"destroy",this).call(this),this.unbind()}}])&&hn(n.prototype,i),c&&hn(n,c),e}(ne);function gn(t){return(gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function mn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function On(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function En(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Sn(t,e,n){return(Sn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_n(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function _n(t){return(_n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tn(t,e){return(Tn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xn=function(t){function e(){var t,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=_n(e).call(this,"".concat(r,"-tools-font-size")))||"object"!==gn(o)&&"function"!=typeof o?En(n):o).options=i,t.setTitle("10"),t.setWidth(30),t.setEllipsis(),t.fontSizeContextMenu=new vn(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?wn(Object(n),!0).forEach((function(e){mn(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({el:En(t)},t.options.contextMenu)),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tn(t,e)}(e,t),n=e,(o=[{key:"destroy",value:function(){Sn(_n(e.prototype),"destroy",this).call(this),this.fontSizeContextMenu.destroy()}}])&&On(n.prototype,o),i&&On(n,i),e}(Ft);function kn(t){return(kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pn(t,e){return!e||"object"!==kn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jn(t){return(jn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cn(t,e){return(Cn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Pn(this,jn(e).call(this,"".concat(r,"-tools-font-bold")))).icon=new ut("font-bold"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cn(t,e)}(e,t),e}(pt);function Ln(t){return(Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function An(t,e){return!e||"object"!==Ln(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Nn(t){return(Nn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function In(t,e){return(In=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=An(this,Nn(e).call(this,"".concat(r,"-tools-font-italic")))).icon=new ut("font-italic"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&In(t,e)}(e,t),e}(pt);function Dn(t){return(Dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mn(t,e){return!e||"object"!==Dn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hn(t){return(Hn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fn(t,e){return(Fn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Mn(this,Hn(e).call(this,"".concat(r,"-tools-under-line")))).icon=new ut("under-line"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fn(t,e)}(e,t),e}(pt);function Wn(t){return(Wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yn(t,e){return!e||"object"!==Wn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Un(t){return(Un=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zn(t,e){return(zn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Yn(this,Un(e).call(this,"".concat(r,"-tools-font-strike")))).icon=new ut("font-strike"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zn(t,e)}(e,t),e}(pt);function Xn(t){return(Xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zn(t,e){return!e||"object"!==Xn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Kn(t){return(Kn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $n(t,e){return($n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qn=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Zn(this,Kn(e).call(this,"".concat(r,"-font-color-context-menu-item")))).title=t,o.icon=n,n&&(o.iconElement=k("div","".concat(r,"-font-color-context-menu-item-icon")),o.iconElement.children(o.icon),o.children(o.iconElement)),t&&(o.titleElement=k("div","".concat(r,"-font-color-context-menu-item-title")),o.titleElement.text(t),o.children(o.titleElement)),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$n(t,e)}(e,t),e}(le);function Qn(t){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function to(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function eo(t,e){return(eo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function no(t,e,n){return(no="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=oo(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function oo(t){return(oo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ro=S.Undef,io=[],co=function(t){function e(t){var n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,n=!(i=oo(e).call(this,"".concat(r,"-drag-panel")))||"object"!==Qn(i)&&"function"!=typeof i?to(o):i,io.push(to(n)),n.options=S.mergeDeep({position:e.DRAG_PANEL_POSITION.CENTER},t),n.status=!1,n.mask=k("div","".concat(r,"-drag-panel-mask")),n.content=k("div","".concat(r,"-drag-panel-content")),no(oo(e.prototype),"children",to(n)).call(to(n),n.content),n.bind(),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&eo(t,e)}(e,t),n=e,c=[{key:"removeInstance",value:function(t){var e=[];io.forEach((function(n){n!==t&&e.push(n)})),io=e}},{key:"closeAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];io.forEach((function(e){-1===t.indexOf(e)&&e.close()}))}},{key:"setRoot",value:function(t){t=t.el?k(t.el):k(t),ro=t}}],(i=[{key:"open",value:function(){if(!1===this.status&&ro){var t=this.mask;ro.children(t),ro.children(this),this.dragPanelLocation(),this.status=!0}return this}},{key:"close",value:function(){if(!0===this.status&&ro){var t=this.mask;ro.remove(this),ro.remove(t),this.status=!1}return this}},{key:"unbind",value:function(){var t=this.mask;L.unbind(t)}},{key:"bind",value:function(){var t=this,e=this.mask;L.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.close(),e.stopPropagation()})),L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(0===e.button){var n=t.eventXy(e,t);L.mouseMoveUp(k(document),(function(e){var o=e.pageY-n.y,r=e.pageX-n.x;t.offset({top:o,left:r}),e.stopPropagation()})),e.stopPropagation()}}))}},{key:"dragPanelLocation",value:function(){var t=this.options.position,n=S.viewPort(),o=n.width,r=n.height,i=this.box();switch(t){case e.DRAG_PANEL_POSITION.LEFT:case e.DRAG_PANEL_POSITION.RIGHT:case e.DRAG_PANEL_POSITION.TOP:break;case e.DRAG_PANEL_POSITION.CENTER:this.offset({left:o/2-i.width/2,top:r/2-i.height/2})}return this}},{key:"children",value:function(){var t;return(t=this.content).children.apply(t,arguments),this}},{key:"destroy",value:function(){no(oo(e.prototype),"destroy",this).call(this),this.unbind(),e.removeInstance(this)}}])&&Jn(n.prototype,i),c&&Jn(n,c),e}(B);function lo(t){return(lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uo(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ao(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function so(t,e,n){return(so="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=fo(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function fo(t){return(fo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ho(t,e){return(ho=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}co.DRAG_PANEL_POSITION={LEFT:1,TOP:2,RIGHT:3,CENTER:4};var po=function(t){function e(t){var n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(i=fo(e).call(this,"".concat(r,"-color-picker")))||"object"!==lo(i)&&"function"!=typeof i?ao(o):i).options=S.mergeDeep({selectCb:function(){}},t),n.dragPanel=new co,n.color=[360,0,100],n.preViewColorPoint=k("div","".concat(r,"-color-picker-pre-view-color-point")),n.colorValueTips=k("div","".concat(r,"-color-picker-color-value-tips")),n.colorValueTips.text("十六进制颜色值"),n.colorInput=k("input","".concat(r,"-color-picker-color-input")),n.top=k("div","".concat(r,"-color-picker-top")),n.top.children(n.preViewColorPoint),n.top.children(n.colorValueTips),n.top.children(n.colorInput),n.selectColorPoint=k("div","".concat(r,"-color-picker-select-color-point")),n.selectColorArea1=k("div","".concat(r,"-color-picker-select-color-area area1")),n.selectColorArea2=k("div","".concat(r,"-color-picker-select-color-area area2")),n.selectColorArea3=k("div","".concat(r,"-color-picker-select-color-area area3")),n.center=k("div","".concat(r,"-color-picker-center")),n.center.children(n.selectColorArea1),n.center.children(n.selectColorArea2),n.center.children(n.selectColorArea3),n.center.children(n.selectColorPoint),n.colorHuxTips=k("div","".concat(r,"-color-picker-color-hux-tips")),n.colorBar=k("div","".concat(r,"-color-picker-color-bar")),n.colorBarPoint=k("div","".concat(r,"-color-picker-bar-point")),n.bottom=k("div","".concat(r,"-color-picker-bottom")),n.colorHuxTips.text("HUE"),n.colorBar.children(n.colorBarPoint),n.bottom.children(n.colorHuxTips),n.bottom.children(n.colorBar),n.cancelButton=k("div","".concat(r,"-color-picker-button cancel")),n.selectButton=k("div","".concat(r,"-color-picker-button select")),n.buttons=k("div","".concat(r,"-color-picker-buttons")),n.cancelButton.text("取消"),n.selectButton.text("确定"),n.buttons.children(n.selectButton),n.buttons.children(n.cancelButton),n.children(n.top),n.children(n.center),n.children(n.bottom),n.children(n.buttons),n.dragPanel.children(ao(n)),n.dragPanel.css("background","#ffffff"),n.bind(),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ho(t,e)}(e,t),n=e,c=[{key:"fixHex",value:function(t){var e=6-t.length;if(e>0){for(var n=[],o=0;o<e;o+=1)n.push("0");n.push(t),t=n.join("")}return t}},{key:"fixHsx",value:function(t){return{h:Math.min(360,Math.max(0,t.h)),s:Math.min(100,Math.max(0,t.s)),x:Math.min(100,Math.max(0,t.x))}}},{key:"hexToRgb",value:function(t){return{r:(t=parseInt(t.indexOf("#")>-1?t.substring(1):t,16))>>16,g:(65280&t)>>8,b:255&t}}},{key:"hexToHsb",value:function(t){return this.rgbToHsb(this.hexToRgb(t))}},{key:"rgbToHsb",value:function(t){var e={h:0,s:0,x:0},n=Math.min(t.r,t.g,t.b),o=Math.max(t.r,t.g,t.b),r=o-n;return e.x=o,e.s=0!==o?255*r/o:0,0!==e.s?t.r===o?e.h=(t.g-t.b)/r:t.g===o?e.h=2+(t.b-t.r)/r:e.h=4+(t.r-t.g)/r:e.h=-1,e.h*=60,e.h<0&&(e.h+=360),e.s*=100/255,e.x*=100/255,e}},{key:"hsbToRgb",value:function(t){var e={},n=t.h,o=255*t.s/100,r=255*t.x/100;if(0===o)e.r=r,e.g=r,e.b=r;else{var i=r,c=(255-o)*r/255,l=n%60*(i-c)/60;360===n&&(n=0),n<60?(e.r=i,e.b=c,e.g=c+l):n<120?(e.g=i,e.b=c,e.r=i-l):n<180?(e.g=i,e.r=c,e.b=c+l):n<240?(e.b=i,e.r=c,e.g=i-l):n<300?(e.b=i,e.g=c,e.r=c+l):n<360?(e.r=i,e.g=c,e.b=i-l):(e.r=0,e.g=0,e.b=0)}return{r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)}}},{key:"rgbToHex",value:function(t){var e=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return e.forEach((function(t,n){1===t.length&&(e[n]="0".concat(t))})),e.join("")}},{key:"hsbToHex",value:function(t){return this.rgbToHex(this.hsbToRgb(t))}},{key:"isRgb",value:function(t){return t.startsWith("rgb")}},{key:"isHex",value:function(t){return t.startsWith("#")}},{key:"parseRgb",value:function(t){var e=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return{r:e[1],g:e[2],b:e[3]}}},{key:"isDark",value:function(t){if(S.isBlank(t))return!1;if(this.isHex(t)){var n=e.hexToRgb(t);t="rgb(".concat(n.r,", ").concat(n.g,", ").concat(n.b,")")}var o=e.parseRgb(t);return.299*parseInt(o.r,10)+.578*parseInt(o.g,10)+.114*parseInt(o.b,10)>=192}}],(i=[{key:"unbind",value:function(){var t=this.selectColorPoint,e=this.colorBarPoint,n=this.colorInput,o=this.cancelButton,r=this.selectButton;L.unbind(n),L.unbind(n),L.unbind(e),L.unbind(t),L.unbind(o),L.unbind(r)}},{key:"bind",value:function(){var t=this,n=this.selectColorPoint,r=this.center,i=this.colorBarPoint,c=this.colorBar,l=this.colorInput,u=this.cancelButton,a=this.selectButton;L.bind(l,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){t.stopPropagation()})),L.bind(l,o.SYSTEM_EVENT_TYPE.CHANGE,(function(){var e=l.val();e&&t.hexColor(e)})),L.bind(i,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.eventXy(e,c),o=c.box();n.x<0&&(n.x=0),n.x>o.width&&(n.x=o.width),t.downHue(n.x,o.width),L.mouseMoveUp(k(document),(function(e){var n=t.eventXy(e,c),o=c.box();n.x<0&&(n.x=0),n.x>o.width&&(n.x=o.width),t.moveHue(n.x,o.width)})),e.stopPropagation()})),L.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.eventXy(e,r),o=r.box();n.x<0&&(n.x=0),n.x>o.width&&(n.x=o.width),n.y<0&&(n.y=0),n.y>o.height&&(n.y=o.height),t.downSelect(n.x,n.y,o.width,o.height),L.mouseMoveUp(k(document),(function(e){var n=t.eventXy(e,r);n.x<0&&(n.x=0),n.x>o.width&&(n.x=o.width),n.y<0&&(n.y=0),n.y>o.height&&(n.y=o.height),t.moveSelect(n.x,n.y,o.width,o.height)})),e.stopPropagation()})),L.bind(u,o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.close()})),L.bind(a,o.SYSTEM_EVENT_TYPE.CLICK,(function(){var n=t.color,o=e.fixHsx({h:parseInt(n[0],10),s:parseInt(n[1],10),x:parseInt(n[2],10)}),r=e.hsbToHex(o);t.options.selectCb("#".concat(r)),t.close()}))}},{key:"open",value:function(t){if(this.dragPanel.open(),t){if(e.isRgb(t)){var n=e.parseRgb(t);t=e.rgbToHex(n)}this.hexColor(t)}else this.change();return this}},{key:"close",value:function(){return this.dragPanel.close(),this}},{key:"sliderPosition",value:function(t){var e=this.colorBar,n=this.colorBarPoint,o=n.box(),r=e.box(),i=parseInt(r.width-r.width*t.h/360,10);i-=o.width/2,n.offset({left:i});var c=this.center,l=this.selectColorPoint,u=l.box(),a=c.box(),s=parseInt(a.width*t.s/100,10),f=parseInt(a.height*(100-t.x)/100,10);s-=u.width/2,f-=u.height/2,l.offset({left:s,top:f})}},{key:"hueChange",value:function(){var t=this.color,n=e.fixHsx({h:parseInt(t[0],10),s:parseInt(t[1],10),x:parseInt(t[2],10)}),o=this.colorBarPoint,r=this.selectColorPoint,i=this.preViewColorPoint,c=this.selectColorArea1,l=this.colorInput,u=e.hsbToHex(n),a=e.hsbToHex({h:n.h,s:100,x:100});r.css("backgroundColor","#".concat(u)),i.css("backgroundColor","#".concat(u)),o.css("backgroundColor","#".concat(a)),c.css("backgroundColor","#".concat(a)),l.val("#".concat(u)),this.sliderPosition(n)}},{key:"selectChange",value:function(){var t=this.color,n=e.fixHsx({h:parseInt(t[0],10),s:parseInt(t[1],10),x:parseInt(t[2],10)}),o=this.preViewColorPoint,r=this.selectColorPoint,i=this.colorInput,c=e.hsbToHex(n);r.css("backgroundColor","#".concat(c)),o.css("backgroundColor","#".concat(c)),i.val("#".concat(c)),this.sliderPosition(n)}},{key:"change",value:function(){this.hueChange(),this.selectChange()}},{key:"downSelect",value:function(t,e,n,o){var r=this.color;r[1]=parseInt(100*t/n,10),r[2]=parseInt(100*(o-e)/o,10),this.selectChange()}},{key:"moveSelect",value:function(t,e,n,o){var r=this.color;r[1]=parseInt(100*Math.max(0,Math.min(n,t))/n,10),r[2]=parseInt(100*(o-Math.max(0,Math.min(o,e)))/o,10),this.selectChange()}},{key:"downHue",value:function(t,e){this.color[0]=parseInt(360*(e-t)/e,10),this.hueChange()}},{key:"moveHue",value:function(t,e){this.color[0]=parseInt(360*(e-Math.max(0,Math.min(e,t)))/e,10),this.hueChange()}},{key:"hexColor",value:function(t){var n=this.color,o=e.hexToHsb(e.fixHex(t));n[0]=o.h,n[1]=o.s,n[2]=o.x,this.change()}},{key:"destroy",value:function(){so(fo(e.prototype),"destroy",this).call(this),this.unbind(),this.dragPanel.destroy()}}])&&uo(n.prototype,i),c&&uo(n,c),e}(B);function yo(t){return(yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bo(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function vo(t,e){return!e||"object"!==yo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function go(t){return(go=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wo(t,e){return(wo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mo=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=vo(this,go(e).call(this,"".concat(r,"-color-array-item")))).options=S.mergeDeep({color:null,icon:null},t),n.color=n.options.color,n.icon=n.options.icon,n.color&&(n.css("backgroundColor",n.color),po.isDark(n.options.color)?(n.checkedIcon=new ut("checked-dark"),n.children(n.checkedIcon)):(n.checkedIcon=new ut("checked-light"),n.children(n.checkedIcon)),n.checkedIcon.hide()),n.icon&&n.children(n.options.icon),n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wo(t,e)}(e,t),n=e,(o=[{key:"setActive",value:function(t){this.checkedIcon&&(t?this.checkedIcon.show():this.checkedIcon.hide())}}])&&bo(n.prototype,o),i&&bo(n,i),e}(B);function Oo(t){return(Oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Eo(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function So(t,e){return!e||"object"!==Oo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _o(t,e,n){return(_o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=To(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function To(t){return(To=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xo(t,e){return(xo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ko=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=So(this,To(e).call(this,"".concat(r,"-color-array")))).options=S.mergeDeep({colors:[new mo({color:"rgb(0,0,0)"}),new mo({color:"rgb(67, 67, 67)"}),new mo({color:"rgb(102, 102, 102)"}),new mo({color:"rgb(153, 153, 153)"}),new mo({color:"rgb(183, 183, 183)"}),new mo({color:"rgb(204, 204, 204)"}),new mo({color:"rgb(217, 217, 217)"}),new mo({color:"rgb(239, 239, 239)"}),new mo({color:"rgb(255, 255, 255)"}),new mo({color:"rgb(152, 0, 0)"}),new mo({color:"rgb(255, 0, 0)"}),new mo({color:"rgb(255, 153, 0)"}),new mo({color:"rgb(255, 255, 0)"}),new mo({color:"rgb(0, 255, 0)"}),new mo({color:"rgb(0, 255, 255)"}),new mo({color:"rgb(74, 134, 232)"}),new mo({color:"rgb(0, 0, 255)"}),new mo({color:"rgb(153, 0, 255)"}),new mo({color:"rgb(255, 0, 255)"}),new mo({color:"rgb(230, 184, 175)"}),new mo({color:"rgb(244, 204, 204)"}),new mo({color:"rgb(252, 229, 205)"}),new mo({color:"rgb(255, 242, 204)"}),new mo({color:"rgb(217, 234, 211)"}),new mo({color:"rgb(208, 224, 227)"}),new mo({color:"rgb(201, 218, 248)"}),new mo({color:"rgb(207, 226, 243)"}),new mo({color:"rgb(217, 210, 233)"}),new mo({color:"rgb(234, 209, 220)"}),new mo({color:"rgb(221, 126, 107)"}),new mo({color:"rgb(234, 153, 153)"}),new mo({color:"rgb(249, 203, 156)"}),new mo({color:"rgb(255, 229, 153)"}),new mo({color:"rgb(182, 215, 168)"}),new mo({color:"rgb(162, 196, 201)"}),new mo({color:"rgb(164, 194, 244)"}),new mo({color:"rgb(159, 197, 232)"}),new mo({color:"rgb(180, 167, 214)"}),new mo({color:"rgb(213, 166, 189)"}),new mo({color:"rgb(204, 65, 37)"}),new mo({color:"rgb(224, 102, 102)"}),new mo({color:"rgb(246, 178, 107)"}),new mo({color:"rgb(255, 217, 102)"}),new mo({color:"rgb(147, 196, 125)"}),new mo({color:"rgb(118, 165, 175)"}),new mo({color:"rgb(109, 158, 235)"}),new mo({color:"rgb(111, 168, 220)"}),new mo({color:"rgb(142, 124, 195)"}),new mo({color:"rgb(194, 123, 160)"}),new mo({color:"rgb(166, 28, 0)"}),new mo({color:"rgb(204, 0, 0)"}),new mo({color:"rgb(230, 145, 56)"}),new mo({color:"rgb(241, 194, 50)"}),new mo({color:"rgb(106, 168, 79)"}),new mo({color:"rgb(69, 129, 142)"}),new mo({color:"rgb(60, 120, 216)"}),new mo({color:"rgb(61, 133, 198)"}),new mo({color:"rgb(103, 78, 167)"}),new mo({color:"rgb(166, 77, 121)"}),new mo({color:"rgb(133, 32, 12)"}),new mo({color:"rgb(153, 0, 0)"}),new mo({color:"rgb(180, 95, 6)"}),new mo({color:"rgb(191, 144, 0)"}),new mo({color:"rgb(56, 118, 29)"}),new mo({color:"rgb(19, 79, 92)"}),new mo({color:"rgb(17, 85, 204)"}),new mo({color:"rgb(11, 83, 148)"}),new mo({color:"rgb(53, 28, 117)"}),new mo({color:"rgb(116, 27, 71)"}),new mo({color:"rgb(91, 15, 0)"}),new mo({color:"rgb(102, 0, 0)"}),new mo({color:"rgb(120, 63, 4)"}),new mo({color:"rgb(127, 96, 0)"}),new mo({color:"rgb(39, 78, 19)"}),new mo({color:"rgb(12, 52, 61)"}),new mo({color:"rgb(28, 69, 135)"}),new mo({color:"rgb(7, 55, 99)"}),new mo({color:"rgb(32, 18, 77)"}),new mo({color:"rgb(76, 17, 48)"})],selectCb:function(){}},t),n.colors=[],n.activeColor=null,n.options.colors.forEach((function(t){n.add(t)})),n.colors.length>0&&n.setActiveByColor(n.colors[0].options.color),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xo(t,e)}(e,t),n=e,(i=[{key:"add",value:function(t){this.colors.push(t),this.children(t),this.bind(t)}},{key:"unbind",value:function(){this.colors.forEach((function(t){L.unbind(t)}))}},{key:"bind",value:function(t){var e=this;L.bind(t,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){e.options.selectCb(t),t.options.color&&e.setActiveByColor(t.options.color)}))}},{key:"setActiveByColor",value:function(t){var e=this;this.colors.forEach((function(n){var o=n.options;o.color===t?(n.setActive(!0),e.activeColor=o.color):n.setActive(!1)}))}},{key:"destroy",value:function(){_o(To(e.prototype),"destroy",this).call(this),this.unbind()}}])&&Eo(n.prototype,i),c&&Eo(n,c),e}(B);function Po(t){return(Po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jo(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Co(t,e){return!e||"object"!==Po(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ro(t,e,n){return(Ro="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Lo(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Lo(t){return(Lo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ao(t,e){return(Ao=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var No=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Co(this,Lo(e).call(this,"".concat(r,"-font-color-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).colorPicker=new po({selectCb:function(e){var n=new mo({color:e});t.customizeColorArray.add(n),t.customizeColorArray.setActiveByColor(e),t.colorArray.setActiveByColor(null),t.options.onUpdate(e),t.close()}}),t.reset=new qn("重置",new ut("clear-color")),t.array=new qn,t.array.removeClass("hover"),t.colorArray=new ko({selectCb:function(e){var n=e.options.color;n&&t.options.onUpdate(n),t.customizeColorArray.setActiveByColor(null),t.close()}}),t.array.children(t.colorArray),t.title=k("div","".concat(r,"-font-color-context-menu-color-title")),t.title.text("自定义"),t.plus=new ut("plus"),t.customizeColorArray=new ko({colors:[new mo({icon:t.plus})],selectCb:function(e){var n=e.options.color;n?(t.options.onUpdate(n),t.colorArray.setActiveByColor(null),t.close()):t.colorPicker.open(t.customizeColorArray.activeColor)}}),t.customize=new qn,t.customize.removeClass("hover"),t.customize.children(t.title),t.customize.children(t.customizeColorArray),t.addItem(t.reset),t.addItem(t.array),t.addItem(new we),t.addItem(t.customize),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ao(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){L.unbind(this.reset)}},{key:"bind",value:function(){var t=this;L.bind(this.reset,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.options.onUpdate("rgb(0,0,0)"),t.customizeColorArray.setActiveByColor(null),t.colorArray.setActiveByColor(null)}))}},{key:"setActiveByColor",value:function(t){this.customizeColorArray.setActiveByColor(t),this.colorArray.setActiveByColor(t)}},{key:"destroy",value:function(){Ro(Lo(e.prototype),"destroy",this).call(this),this.unbind()}}])&&jo(n.prototype,i),c&&jo(n,c),e}(ne);function Io(t){return(Io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Do(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mo(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ho(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fo(t,e,n){return(Fo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Bo(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Bo(t){return(Bo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wo(t,e){return(Wo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yo=function(t){function e(){var t,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=Bo(e).call(this,"".concat(r,"-tools-font-color")))||"object"!==Io(o)&&"function"!=typeof o?Ho(n):o).options=i,t.icon=new ut("color"),t.setIcon(t.icon),t.setColor("rgb(0,0,0)"),t.fontColorContextMenu=new No(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Vo(Object(n),!0).forEach((function(e){Do(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Vo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({el:Ho(t)},t.options.contextMenu)),t.fontColorContextMenu.setActiveByColor("rgb(0,0,0)"),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wo(t,e)}(e,t),n=e,(o=[{key:"setColor",value:function(t){this.icon.css("border-bottom","3px solid ".concat(t))}},{key:"destroy",value:function(){Fo(Bo(e.prototype),"destroy",this).call(this),this.fontColorContextMenu.destroy()}}])&&Mo(n.prototype,o),i&&Mo(n,i),e}(Ft);function Uo(t){return(Uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zo(t,e){return!e||"object"!==Uo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Go(t){return(Go=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xo(t,e){return(Xo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zo=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=zo(this,Go(e).call(this,"".concat(r,"-fill-color-context-menu-item")))).title=t,o.icon=n,n&&(o.iconElement=k("div","".concat(r,"-fill-color-context-menu-item-icon")),o.iconElement.children(o.icon),o.children(o.iconElement)),t&&(o.titleElement=k("div","".concat(r,"-fill-color-context-menu-item-title")),o.titleElement.text(t),o.children(o.titleElement)),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xo(t,e)}(e,t),e}(le);function Ko(t){return(Ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function qo(t,e){return!e||"object"!==Ko(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qo(t,e,n){return(Qo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Jo(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Jo(t){return(Jo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tr(t,e){return(tr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var er=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=qo(this,Jo(e).call(this,"".concat(r,"-font-color-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).colorPicker=new po({selectCb:function(e){var n=new mo({color:e});t.customizeColorArray.add(n),t.customizeColorArray.setActiveByColor(e),t.colorArray.setActiveByColor(null),t.options.onUpdate(e),t.close()}}),t.reset=new Zo("重置",new ut("clear-color")),t.array=new Zo,t.array.removeClass("hover"),t.colorArray=new ko({selectCb:function(e){var n=e.options.color;n&&t.options.onUpdate(n),t.customizeColorArray.setActiveByColor(null),t.close()}}),t.array.children(t.colorArray),t.title=k("div","".concat(r,"-font-color-context-menu-color-title")),t.title.text("自定义"),t.plus=new ut("plus"),t.customizeColorArray=new ko({colors:[new mo({icon:t.plus})],selectCb:function(e){var n=e.options.color;n?(t.options.onUpdate(n),t.colorArray.setActiveByColor(null),t.close()):t.colorPicker.open(t.customizeColorArray.activeColor)}}),t.customize=new Zo,t.customize.removeClass("hover"),t.customize.children(t.title),t.customize.children(t.customizeColorArray),t.addItem(t.reset),t.addItem(t.array),t.addItem(new we),t.addItem(t.customize),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tr(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){L.bind(this.reset)}},{key:"bind",value:function(){var t=this;L.bind(this.reset,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.options.onUpdate(null),t.customizeColorArray.setActiveByColor(null),t.colorArray.setActiveByColor(null)}))}},{key:"setActiveByColor",value:function(t){this.customizeColorArray.setActiveByColor(t),this.colorArray.setActiveByColor(t)}},{key:"destroy",value:function(){Qo(Jo(e.prototype),"destroy",this).call(this),this.unbind()}}])&&$o(n.prototype,i),c&&$o(n,c),e}(ne);function nr(t){return(nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function or(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function rr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ir(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function cr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lr(t,e,n){return(lr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ur(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function ur(t){return(ur=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ar(t,e){return(ar=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sr=function(t){function e(){var t,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=ur(e).call(this,"".concat(r,"-tools-fill-color")))||"object"!==nr(o)&&"function"!=typeof o?cr(n):o).options=i,t.icon=new ut("fill-color"),t.setIcon(t.icon),t.setColor("rgb(255, 255, 255)"),t.fillColorContextMenu=new er(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?or(Object(n),!0).forEach((function(e){rr(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):or(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({el:cr(t)},t.options.contextMenu)),t.fillColorContextMenu.setActiveByColor("rgb(255, 255, 255)"),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ar(t,e)}(e,t),n=e,(o=[{key:"setColor",value:function(t){this.icon.css("border-bottom","3px solid ".concat(t))}},{key:"destroy",value:function(){lr(ur(e.prototype),"destroy",this).call(this),this.fillColorContextMenu.destroy()}}])&&ir(n.prototype,o),i&&ir(n,i),e}(Ft);function fr(t){return(fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hr(t,e){return!e||"object"!==fr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pr(t){return(pr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yr(t,e){return(yr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var br=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),hr(this,pr(e).call(this,"".concat(r,"-border-type-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yr(t,e)}(e,t),e}(le);function dr(t){return(dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vr(t,e){return!e||"object"!==dr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gr(t){return(gr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wr(t,e){return(wr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=vr(this,gr(e).call(this,"".concat(r,"-tools-border1")))).icon=new ut("border1"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wr(t,e)}(e,t),e}(pt);function Or(t){return(Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Er(t,e){return!e||"object"!==Or(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sr(t){return(Sr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _r(t,e){return(_r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Er(this,Sr(e).call(this,"".concat(r,"-tools-border2")))).icon=new ut("border2"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_r(t,e)}(e,t),e}(pt);function xr(t){return(xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kr(t,e){return!e||"object"!==xr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pr(t){return(Pr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jr(t,e){return(jr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Cr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=kr(this,Pr(e).call(this,"".concat(r,"-tools-border3")))).icon=new ut("border3"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jr(t,e)}(e,t),e}(pt);function Rr(t){return(Rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lr(t,e){return!e||"object"!==Rr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ar(t){return(Ar=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nr(t,e){return(Nr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ir=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Lr(this,Ar(e).call(this,"".concat(r,"-tools-border4")))).icon=new ut("border4"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nr(t,e)}(e,t),e}(pt);function Vr(t){return(Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dr(t,e){return!e||"object"!==Vr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mr(t){return(Mr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hr(t,e){return(Hr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Dr(this,Mr(e).call(this,"".concat(r,"-tools-border5")))).icon=new ut("border5"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hr(t,e)}(e,t),e}(pt);function Br(t){return(Br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wr(t,e){return!e||"object"!==Br(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yr(t){return(Yr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ur(t,e){return(Ur=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Wr(this,Yr(e).call(this,"".concat(r,"-tools-border6")))).icon=new ut("border6"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ur(t,e)}(e,t),e}(pt);function Gr(t){return(Gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xr(t,e){return!e||"object"!==Gr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zr(t){return(Zr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kr(t,e){return(Kr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $r=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Xr(this,Zr(e).call(this,"".concat(r,"-tools-border7")))).icon=new ut("border7"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kr(t,e)}(e,t),e}(pt);function qr(t){return(qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qr(t,e){return!e||"object"!==qr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jr(t){return(Jr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ti(t,e){return(ti=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ei=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Qr(this,Jr(e).call(this,"".concat(r,"-tools-border8")))).icon=new ut("border8"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ti(t,e)}(e,t),e}(pt);function ni(t){return(ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oi(t,e){return!e||"object"!==ni(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ri(t){return(ri=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ii(t,e){return(ii=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ci=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=oi(this,ri(e).call(this,"".concat(r,"-tools-border9")))).icon=new ut("border9"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ii(t,e)}(e,t),e}(pt);function li(t){return(li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ui(t,e){return!e||"object"!==li(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ai(t){return(ai=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function si(t,e){return(si=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fi=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ui(this,ai(e).call(this,"".concat(r,"-tools-border10")))).icon=new ut("border10"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&si(t,e)}(e,t),e}(pt);function hi(t){return(hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pi(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function yi(t,e){return!e||"object"!==hi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bi(t){return(bi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function di(t,e){return(di=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vi=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=yi(this,bi(e).call(this,"".concat(r,"-tools-border-color")))).icon=new ut("border-color"),t.setIcon(t.icon),t.setColor("#000000"),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&di(t,e)}(e,t),n=e,(o=[{key:"setColor",value:function(t){this.icon.css("border-bottom","3px solid ".concat(t))}}])&&pi(n.prototype,o),i&&pi(n,i),e}(Ft);function gi(t){return(gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wi(t,e){return!e||"object"!==gi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mi(t){return(mi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oi(t,e){return(Oi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ei=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=wi(this,mi(e).call(this,"".concat(r,"-tools-border-type")))).icon=new ut("border-type"),t.setIcon(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oi(t,e)}(e,t),e}(Ft);function Si(t){return(Si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _i(t,e){return!e||"object"!==Si(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ti(t){return(Ti=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xi(t,e){return(xi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ki=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=_i(this,Ti(e).call(this,"".concat(r,"-border-color-context-menu-item")))).title=t,o.icon=n,n&&(o.iconElement=k("div","".concat(r,"-border-color-context-menu-item-icon")),o.iconElement.children(o.icon),o.children(o.iconElement)),t&&(o.titleElement=k("div","".concat(r,"-border-color-context-menu-item-title")),o.titleElement.text(t),o.children(o.titleElement)),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xi(t,e)}(e,t),e}(le);function Pi(t){return(Pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ji(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ci(t,e){return!e||"object"!==Pi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ri(t,e,n){return(Ri="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Li(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Li(t){return(Li=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ai(t,e){return(Ai=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ni=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ci(this,Li(e).call(this,"".concat(r,"-border-color-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).colorPicker=new po({selectCb:function(e){var n=new mo({color:e});t.customizeColorArray.add(n),t.customizeColorArray.setActiveByColor(e),t.colorArray.setActiveByColor(null),t.options.onUpdate(e),t.close()}}),t.reset=new ki("重置",new ut("clear-color")),t.array=new ki,t.array.removeClass("hover"),t.colorArray=new ko({selectCb:function(e){var n=e.options.color;n&&t.options.onUpdate(n),t.customizeColorArray.setActiveByColor(null),t.close()}}),t.array.children(t.colorArray),t.title=k("div","".concat(r,"-border-color-context-menu-color-title")),t.title.text("自定义"),t.plus=new ut("plus"),t.customizeColorArray=new ko({colors:[new mo({icon:t.plus})],selectCb:function(e){var n=e.options.color;n?(t.options.onUpdate(n),t.colorArray.setActiveByColor(null),t.close()):t.colorPicker.open(t.customizeColorArray.activeColor)}}),t.customize=new ki,t.customize.removeClass("hover"),t.customize.children(t.title),t.customize.children(t.customizeColorArray),t.addItem(t.reset),t.addItem(t.array),t.addItem(new we),t.addItem(t.customize),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ai(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){L.unbind(this.reset)}},{key:"bind",value:function(){var t=this;L.bind(this.reset,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.options.onUpdate("rgb(0,0,0)"),t.customizeColorArray.setActiveByColor(null),t.colorArray.setActiveByColor(null)}))}},{key:"setActiveByColor",value:function(t){this.customizeColorArray.setActiveByColor(t),this.colorArray.setActiveByColor(t)}},{key:"destroy",value:function(){Ri(Li(e.prototype),"destroy",this).call(this),this.unbind()}}])&&ji(n.prototype,i),c&&ji(n,c),e}(ne);function Ii(t){return(Ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vi(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Di(t){return(Di=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Hi(t,e){return(Hi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fi=[],Bi=function(t){function e(t){var n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(i=Di(e).call(this,"".concat(r,"-font-context-menu-item")))||"object"!==Ii(i)&&"function"!=typeof i?Mi(o):i).type=t,n.icon=new ut("checked"),n.typeIcon=new ut(t),n.typeIcon.setWidth(50),n.iconElement=k("div","".concat(r,"-font-context-menu-item-icon")),n.titleElement=k("div","".concat(r,"-font-context-menu-item-title")),n.iconElement.children(n.icon),n.titleElement.children(n.typeIcon),n.children(n.iconElement),n.children(n.titleElement),Fi.push(Mi(n)),n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hi(t,e)}(e,t),n=e,(o=[{key:"setTitle",value:function(t){this.title=t,this.titleElement.text(t)}},{key:"setActive",value:function(){Fi.forEach((function(t){t.removeClass("active")})),this.addClass("active")}}])&&Vi(n.prototype,o),i&&Vi(n,i),e}(le);function Wi(t){return(Wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yi(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ui(t,e){return!e||"object"!==Wi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zi(t,e,n){return(zi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Gi(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Gi(t){return(Gi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xi(t,e){return(Xi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zi=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ui(this,Gi(e).call(this,"".concat(r,"-line-type-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).items=[new Bi("line1"),new Bi("line2"),new Bi("line3"),new Bi("line4"),new Bi("line5"),new Bi("line6")],t.items.forEach((function(e){t.addItem(e)})),t.setActiveByType(t.items[0].type),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xi(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){this.items.forEach((function(t){L.unbind(t)}))}},{key:"bind",value:function(){var t=this;this.items.forEach((function(e){L.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.update(e.type),e.setActive()}))}))}},{key:"update",value:function(t){this.options.onUpdate(t),this.close()}},{key:"setActiveByType",value:function(t){this.items.forEach((function(e){e.type===t&&e.setActive()}))}},{key:"destroy",value:function(){zi(Gi(e.prototype),"destroy",this).call(this),this.unbind()}}])&&Yi(n.prototype,i),c&&Yi(n,c),e}(ne);function Ki(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function $i(t,e,n){return($i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ji(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function qi(t){return(qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qi(t,e){return!e||"object"!==qi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ji(t){return(Ji=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tc(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ec(t,e)}function ec(t,e){return(ec=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function nc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oc(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function rc(t,e,n){return e&&oc(t.prototype,e),n&&oc(t,n),t}var ic=window.devicePixelRatio||1,cc=Math.round(ic),lc=cc+2,uc=lc+2,ac=cc/2,sc=function(){function t(e){nc(this,t),this.canvas=e,this.ctx=e.getContext("2d")}return rc(t,null,[{key:"styleTransformCssPx",value:function(t){return t/this.dpr()}},{key:"srcTransformCssPx",value:function(t){return this.styleTransformCssPx(this.srcTransformStylePx(t))}},{key:"srcTransformStylePx",value:function(t){return this.rounding(t*this.dpr())}},{key:"rounding",value:function(t){return Math.round(t)}},{key:"radian",value:function(t){return-t*(Math.PI/180)}},{key:"dpr",value:function(){return ic}},{key:"dprUpdate",value:function(){ic=window.devicePixelRatio||1,cc=Math.round(ic),uc=(lc=cc+2)+2,ac=cc/2}}]),rc(t,[{key:"attr",value:function(t){for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];("string"==typeof n||n instanceof String)&&(n=n.trim()),this.ctx[e]!==n&&(this.ctx[e]=n)}return this}},{key:"resize",value:function(e,n){var o=this.canvas;return o.width=t.srcTransformStylePx(e),o.height=t.srcTransformStylePx(n),o.style.width="".concat(o.width/t.dpr(),"px"),o.style.height="".concat(o.height/t.dpr(),"px"),this}}]),t}(),fc=function(t){function e(t){var n;return nc(this,e),(n=Qi(this,Ji(e).call(this,t))).lineWidthType=e.LINE_WIDTH_TYPE.low,n.lineColor="#000000",n}return tc(e,t),rc(e,null,[{key:"offsetToLineInside",value:function(t){return cc>1?t-cc/2:t-1}}]),rc(e,[{key:"corsLine",value:function(t,n){var o=this,r=Ki(t,2),i=r[0],c=r[1],l=Ki(n,2),u=l[0],a=l[1],s=this.lineWidthType,f=this.lineColor,h=cc;switch(s){case e.LINE_WIDTH_TYPE.medium:h=lc;break;case e.LINE_WIDTH_TYPE.low:h=cc;break;case e.LINE_WIDTH_TYPE.high:h=uc}this.attr({strokeStyle:f,lineWidth:h}),this.polyline((function(t){var e=Ki(t,2),n=e[0],r=e[1];return[sc.rounding(n+o.getOffsetX())-ac,sc.rounding(r+o.getOffsetY())-ac]}),[i,c],[u,a])}},{key:"setLineColor",value:function(t){this.lineColor=t}},{key:"setLineWidthType",value:function(t){this.lineWidthType=t}},{key:"horizonLine",value:function(t,e){var n=Ki(t,2),o=n[0],r=n[1],i=Ki(e,2),c=i[0],l=i[1];if(r!==l)throw new TypeError("Error Horizon Line");this.corsLine([o,r],[c,l])}},{key:"verticalLine",value:function(t,e){var n=Ki(t,2),o=n[0],r=n[1],i=Ki(e,2),c=i[0],l=i[1];if(o!==c)throw new TypeError("Error Vertical Line");this.corsLine([o,r],[c,l])}}]),e}(function(t){function e(){return nc(this,e),Qi(this,Ji(e).apply(this,arguments))}return tc(e,t),rc(e,[{key:"line",value:function(){for(var t=this,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return this.polyline.apply(this,[function(e){var n=Ki(e,2),o=n[0],r=n[1];return[t.transformLinePx(sc.rounding(o+t.getOffsetX())),t.transformLinePx(sc.rounding(r+t.getOffsetY()))]}].concat(n)),this}},{key:"transformLinePx",value:function(t){return this.ctx.lineWidth%2==0?t:t-.5}}]),e}(function(t){function e(t){var n;return nc(this,e),(n=Qi(this,Ji(e).call(this,t))).offsetX=0,n.offsetY=0,n}return tc(e,t),rc(e,[{key:"offset",value:function(t,e){this.offsetX=t,this.offsetY=e}},{key:"getOffsetX",value:function(){return this.offsetX}},{key:"getOffsetY",value:function(){return this.offsetY}},{key:"fillText",value:function(){throw TypeError("child impl")}},{key:"fillRect",value:function(){throw TypeError("child impl")}},{key:"rect",value:function(){throw TypeError("child impl")}},{key:"drawImage",value:function(){throw TypeError("child impl")}}]),e}(function(t){function e(){return nc(this,e),Qi(this,Ji(e).apply(this,arguments))}return tc(e,t),rc(e,[{key:"fullRect",value:function(){var t=this.canvas,e=t.width,n=t.height;return this.ctx.fillRect(0,0,e,n),this}},{key:"polyline",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(t){return t},e=this.ctx;if((arguments.length<=1?0:arguments.length-1)>1){this.beginPath();var n=t(arguments.length<=1?void 0:arguments[1]),o=Ki(n,2),r=o[0],i=o[1];e.moveTo(r,i);for(var c=1,l=arguments.length<=1?0:arguments.length-1;c<l;c+=1){var u=t(c+1<1||arguments.length<=c+1?void 0:arguments[c+1]),a=Ki(u,2),s=a[0],f=a[1];e.lineTo(s,f)}e.stroke()}}},{key:"rotate",value:function(t){return $i(Ji(e.prototype),"rotate",this).call(this,sc.radian(t)),this}}]),e}(function(t){function e(t){var n;return nc(this,e),(n=Qi(this,Ji(e).call(this,t))).dash=[],n}return tc(e,t),rc(e,[{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"measureText",value:function(t){return this.ctx.measureText(t)}},{key:"save",value:function(){return this.ctx.save(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"fill",value:function(){return this.ctx.fill(),this}},{key:"clip",value:function(){return this.ctx.clip(),this}},{key:"setLineDash",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this.ctx;return this.dash=t,e.setLineDash(t),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"translate",value:function(t,e){return this.ctx.translate(t,e),this}},{key:"rotate",value:function(t){return this.ctx.rotate(t),this}}]),e}(sc)))));fc.LINE_WIDTH_TYPE={low:"low",medium:"medium",high:"high"};var hc=function(t){function e(){return nc(this,e),Qi(this,Ji(e).apply(this,arguments))}return tc(e,t),rc(e,[{key:"fillText",value:function(t,n,o){return n+=this.getOffsetX(),o+=this.getOffsetY(),this.ctx.fillText(t,e.rounding(n),e.rounding(o)),this}},{key:"fillRect",value:function(t,n,o,r){return t+=this.getOffsetX(),n+=this.getOffsetY(),this.ctx.fillRect(e.rounding(t),e.rounding(n),e.rounding(o),e.rounding(r)),this}},{key:"rect",value:function(t,n,o,r){return t+=this.getOffsetX(),n+=this.getOffsetY(),this.ctx.rect(e.rounding(t),e.rounding(n),e.rounding(o),e.rounding(r)),this}},{key:"copyImage",value:function(t,n,o,r,i,c,l,u){var a=this.ctx;return i+=this.getOffsetX(),t+=this.getOffsetX(),c+=this.getOffsetY(),n+=this.getOffsetY(),a.drawImage(this.canvas,e.rounding(t),e.rounding(n),e.rounding(o),e.rounding(r),e.rounding(i),e.rounding(c),e.rounding(l),e.rounding(u)),this}},{key:"drawImage",value:function(t,n,o,r,i,c,l,u,a){var s=this.ctx;return c+=this.getOffsetX(),l+=this.getOffsetY(),s.drawImage(t,e.rounding(n),e.rounding(o),e.rounding(r),e.rounding(i),e.rounding(c),e.rounding(l),e.rounding(u),e.rounding(a)),this}}]),e}(fc);function pc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yc(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function bc(t,e,n){return e&&yc(t.prototype,e),n&&yc(t,n),t}var dc={SOLID_LINE:0,DOTTED_LINE:1,POINT_LINE:2,DOUBLE_LINE:3},vc=function(){function t(e,n){pc(this,t),this.draw=e,S.mergeDeep(this,{color:"#000000",widthType:hc.LINE_WIDTH_TYPE.low},n)}return bc(t,[{key:"setWidthType",value:function(t){this.widthType=t}},{key:"setColor",value:function(t){this.color=t}},{key:"horizonLine",value:function(t,e,n,o){var r=this.draw,i=this.widthType,c=this.color;r.setLineColor(c),r.setLineWidthType(i),r.setLineDash([]),r.horizonLine([t,e],[n,o])}},{key:"verticalLine",value:function(t,e,n,o){var r=this.draw,i=this.widthType,c=this.color;r.setLineColor(c),r.setLineWidthType(i),r.setLineDash([]),r.verticalLine([t,e],[n,o])}}]),t}(),gc=function(){function t(e,n){pc(this,t),this.draw=e,S.mergeDeep(this,{color:"#000000",widthType:hc.LINE_WIDTH_TYPE.low,dash:[5]},n)}return bc(t,[{key:"setWidthType",value:function(t){this.widthType=t}},{key:"setColor",value:function(t){this.color=t}},{key:"horizonLine",value:function(t,e,n,o){var r=this.draw,i=this.dash,c=this.widthType,l=this.color;r.setLineColor(l),r.setLineWidthType(c),r.setLineDash(i),r.horizonLine([t,e],[n,o])}},{key:"verticalLine",value:function(t,e,n,o){var r=this.draw,i=this.dash,c=this.widthType,l=this.color;r.setLineColor(l),r.setLineWidthType(c),r.setLineDash(i),r.verticalLine([t,e],[n,o])}}]),t}(),wc=function(){function t(e,n){pc(this,t),this.draw=e,S.mergeDeep(this,{color:"#000000",widthType:hc.LINE_WIDTH_TYPE.low,padding:1,spacing:t.spacing,leftShow:function(){return!1},topShow:function(){return!1},rightShow:function(){return!1},bottomShow:function(){return!1},iFMerge:function(){return!1},iFMergeFirstRow:function(){return!1},iFMergeLastRow:function(){return!1},iFMergeFirstCol:function(){return!1},iFMergeLastCol:function(){return!1}},n)}return bc(t,[{key:"setWidthType",value:function(t){this.widthType=t}},{key:"setColor",value:function(t){this.color=t}},{key:"horizonLine",value:function(t,e,n,o,r,i,c){var l=this.draw,u=this.widthType,a=this.color;l.setLineColor(a),l.setLineWidthType(u),l.setLineDash([]);var s=this.handleExternal(t,e,n,o,r,i,c),f=this.handleInternal(t,e,n,o,r,i,c);S.isEmptyObject(f)||l.horizonLine([f.sx,f.sy],[f.ex,f.ey]),S.isEmptyObject(s)||l.horizonLine([s.sx,s.sy],[s.ex,s.ey])}},{key:"verticalLine",value:function(t,e,n,o,r,i,c){var l=this.draw,u=this.widthType,a=this.color;l.setLineColor(a),l.setLineWidthType(u),l.setLineDash([]);var s=this.handleExternal(t,e,n,o,r,i,c),f=this.handleInternal(t,e,n,o,r,i,c);S.isEmptyObject(f)||l.verticalLine([f.sx,f.sy],[f.ex,f.ey]),S.isEmptyObject(s)||l.verticalLine([s.sx,s.sy],[s.ex,s.ey])}},{key:"handleExternal",value:function(t,e,n,o,r,i,c){var l={},u=this.leftShow,a=this.topShow,s=this.rightShow,f=this.bottomShow,h=this.iFMerge,p=this.iFMergeFirstRow,y=this.iFMergeLastRow,b=this.iFMergeFirstCol,d=this.iFMergeLastCol,v=this.spacing,g=null,w=null,m=null,O=null,E=null;switch(c){case"left":(g=h(r,i-1))&&(w=p(r,i-1),m=y(r,i-1),O=b(r,i-1),E=d(r,i-1));break;case"top":(g=h(r-1,i))&&(w=p(r-1,i),m=y(r-1,i),O=b(r-1,i),E=d(r-1,i));break;case"right":(g=h(r,i+1))&&(w=p(r,i+1),m=y(r,i+1),O=b(r,i+1),E=d(r,i+1));break;case"bottom":(g=h(r+1,i))&&(w=p(r+1,i),m=y(r+1,i),O=b(r+1,i),E=d(r+1,i))}if(g){switch(c){case"left":l.sx=t-v,l.ex=n-v;var S=f(r-1,i-1)||a(r,i-1),_=a(r,i),T=f(r-1,i);l.sy=e,(_||T)&&(l.sy=e-v),S&&w&&(l.sy=e+v);var x=a(r+1,i-1)||f(r,i-1),k=f(r,i),P=a(r+1,i);l.ey=o,(k||P)&&(l.ey=o+v),x&&m&&(l.ey=o-v);break;case"top":l.sy=e-v,l.ey=o-v;var j=s(r-1,i-1)||u(r-1,i),C=u(r,i),R=s(r,i-1);l.sx=t,(C||R)&&(l.sx=t-v),j&&O&&(l.sx=t+v);var L=u(r-1,i+1)||s(r-1,i),A=s(r,i),N=u(r,i+1);l.ex=n,(A||N)&&(l.ex=n+v),L&&E&&(l.ex=n-v);break;case"right":l.sx=t+v,l.ex=n+v;var I=f(r-1,i+1)||a(r,i+1),V=a(r,i),D=f(r-1,i);l.sy=e,(V||D)&&(l.sy=e-v),I&&w&&(l.sy=e+v);var M=a(r+1,i+1)||f(r,i+1),H=f(r,i),F=a(r+1,i);l.ey=o,(H||F)&&(l.ey=o+v),M&&m&&(l.ey=o-v);break;case"bottom":l.sy=e+v,l.ey=o+v;var B=s(r+1,i-1)||u(r+1,i),W=u(r,i),Y=s(r,i-1);l.sx=t,(W||Y)&&(l.sx=t-v),B&&O&&(l.sx=t+v);var U=u(r+1,i+1)||s(r+1,i),z=s(r,i),G=u(r,i+1);l.ex=n,(z||G)&&(l.ex=n+v),U&&E&&(l.ex=n-v)}return l}switch(c){case"left":l.sx=t-v,l.ex=n-v;var X=f(r-1,i-1)||a(r,i-1),Z=a(r,i),K=f(r-1,i);l.sy=e,(Z||K)&&(l.sy=e-v),X&&(l.sy=e+v);var $=a(r+1,i-1)||f(r,i-1),q=f(r,i),Q=a(r+1,i);l.ey=o,(q||Q)&&(l.ey=o+v),$&&(l.ey=o-v);break;case"top":l.sy=e-v,l.ey=o-v;var J=s(r-1,i-1)||u(r-1,i),tt=u(r,i),et=s(r,i-1);l.sx=t,(tt||et)&&(l.sx=t-v),J&&(l.sx=t+v);var nt=u(r-1,i+1)||s(r-1,i),ot=s(r,i),rt=u(r,i+1);l.ex=n,(ot||rt)&&(l.ex=n+v),nt&&(l.ex=n-v);break;case"right":l.sx=t+v,l.ex=n+v;var it=f(r-1,i+1)||a(r,i+1),ct=a(r,i),lt=f(r-1,i);l.sy=e,(ct||lt)&&(l.sy=e-v),it&&(l.sy=e+v);var ut=a(r+1,i+1)||f(r,i+1),at=f(r,i),st=a(r+1,i);l.ey=o,(at||st)&&(l.ey=o+v),ut&&(l.ey=o-v);break;case"bottom":l.sy=e+v,l.ey=o+v;var ft=s(r+1,i-1)||u(r+1,i),ht=u(r,i),pt=s(r,i-1);l.sx=t,(ht||pt)&&(l.sx=t-v),ft&&(l.sx=t+v);var yt=u(r+1,i+1)||s(r+1,i),bt=s(r,i),dt=u(r,i+1);l.ex=n,(bt||dt)&&(l.ex=n+v),yt&&(l.ex=n-v)}return l}},{key:"handleInternal",value:function(t,e,n,o,r,i,c){var l={},u=this.leftShow,a=this.topShow,s=this.rightShow,f=this.bottomShow,h=this.iFMerge,p=this.iFMergeFirstRow,y=this.iFMergeLastRow,b=this.iFMergeFirstCol,d=this.iFMergeLastCol,v=this.spacing;if(h(r,i)){var g=p(r,i),w=y(r,i),m=b(r,i),O=d(r,i);switch(c){case"left":l.sx=t+v,l.ex=n+v;var E=f(r-1,i-1)||a(r,i-1),S=a(r,i),_=f(r-1,i);l.sy=e,E&&(l.sy=e-v),(S||_)&&g&&(l.sy=e+v);var T=a(r+1,i-1)||f(r,i-1),x=f(r,i),k=a(r+1,i);l.ey=o,T&&(l.ey=o+v),(x||k)&&w&&(l.ey=o-v);break;case"top":l.sy=e+v,l.ey=o+v;var P=s(r-1,i-1)||u(r-1,i),j=u(r,i),C=s(r,i-1);l.sx=t,P&&(l.sx=t-v),(j||C)&&m&&(l.sx=t+v);var R=u(r-1,i+1)||s(r-1,i),L=s(r,i),A=u(r,i+1);l.ex=n,R&&(l.ex=n+v),(L||A)&&O&&(l.ex=n-v);break;case"right":l.sx=t-v,l.ex=n-v;var N=f(r-1,i+1)||a(r,i+1),I=a(r,i),V=f(r-1,i);l.sy=e,N&&(l.sy=e-v),(I||V)&&g&&(l.sy=e+v);var D=a(r+1,i+1)||f(r,i+1),M=f(r,i),H=a(r+1,i);l.ey=o,D&&(l.ey=o+v),(M||H)&&w&&(l.ey=o-v);break;case"bottom":l.sy=e-v,l.ey=o-v;var F=s(r+1,i-1)||u(r+1,i),B=u(r,i),W=s(r,i-1);l.sx=t,F&&(l.sx=t-v),(B||W)&&m&&(l.sx=t+v);var Y=u(r+1,i+1)||s(r+1,i),U=s(r,i),z=u(r,i+1);l.ex=n,Y&&(l.ex=n+v),(U||z)&&O&&(l.ex=n-v)}return l}switch(c){case"left":l.sx=t+v,l.ex=n+v;var G=f(r-1,i-1)||a(r,i-1),X=a(r,i),Z=f(r-1,i);l.sy=e,G&&(l.sy=e-v),(X||Z)&&(l.sy=e+v);var K=a(r+1,i-1)||f(r,i-1),$=f(r,i),q=a(r+1,i);l.ey=o,K&&(l.ey=o+v),($||q)&&(l.ey=o-v);break;case"top":l.sy=e+v,l.ey=o+v;var Q=s(r-1,i-1)||u(r-1,i),J=u(r,i),tt=s(r,i-1);l.sx=t,Q&&(l.sx=t-v),(J||tt)&&(l.sx=t+v);var et=u(r-1,i+1)||s(r-1,i),nt=s(r,i),ot=u(r,i+1);l.ex=n,et&&(l.ex=n+v),(nt||ot)&&(l.ex=n-v);break;case"right":l.sx=t-v,l.ex=n-v;var rt=f(r-1,i+1)||a(r,i+1),it=a(r,i),ct=f(r-1,i);l.sy=e,rt&&(l.sy=e-v),(it||ct)&&(l.sy=e+v);var lt=a(r+1,i+1)||f(r,i+1),ut=f(r,i),at=a(r+1,i);l.ey=o,lt&&(l.ey=o+v),(ut||at)&&(l.ey=o-v);break;case"bottom":l.sy=e-v,l.ey=o-v;var st=s(r+1,i-1)||u(r+1,i),ft=u(r,i),ht=s(r,i-1);l.sx=t,st&&(l.sx=t-v),(ft||ht)&&(l.sx=t+v);var pt=u(r+1,i+1)||s(r+1,i),yt=s(r,i),bt=u(r,i+1);l.ex=n,pt&&(l.ex=n+v),(yt||bt)&&(l.ex=n-v)}return l}}]),t}();wc.spacing=hc.dpr()>=2?3:2;var mc=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};pc(this,t),this.widthType=hc.LINE_WIDTH_TYPE.low,this.type=dc.SOLID_LINE,this.solidLine=new vc(e,S.mergeDeep({},n)),this.dottedLine=new gc(e,S.mergeDeep({dash:[5]},n)),this.pointLine=new gc(e,S.mergeDeep({dash:[2,2]},n)),this.doubleLine=new wc(e,S.mergeDeep({},n))}return bc(t,[{key:"setWidthType",value:function(t){t&&this.type===dc.SOLID_LINE&&this.solidLine.setWidthType(t)}},{key:"setColor",value:function(t){t&&(this.solidLine.setColor(t),this.dottedLine.setColor(t),this.pointLine.setColor(t),this.doubleLine.setColor(t))}},{key:"setType",value:function(t){this.type=t}},{key:"horizonLine",value:function(t,e,n,o,r,i,c){var l=this.type,u=this.solidLine,a=this.dottedLine,s=this.pointLine,f=this.doubleLine;switch(l){case dc.SOLID_LINE:u.horizonLine(t,e,n,o);break;case dc.DOTTED_LINE:a.horizonLine(t,e,n,o);break;case dc.POINT_LINE:s.horizonLine(t,e,n,o);break;case dc.DOUBLE_LINE:f.horizonLine(t,e,n,o,r,i,c)}}},{key:"verticalLine",value:function(t,e,n,o,r,i,c){var l=this.type,u=this.solidLine,a=this.dottedLine,s=this.pointLine,f=this.doubleLine;switch(l){case dc.SOLID_LINE:u.verticalLine(t,e,n,o);break;case dc.DOTTED_LINE:a.verticalLine(t,e,n,o);break;case dc.POINT_LINE:s.verticalLine(t,e,n,o);break;case dc.DOUBLE_LINE:f.verticalLine(t,e,n,o,r,i,c)}}}]),t}();function Oc(t){return(Oc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ec(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Sc(t,e){return!e||"object"!==Oc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _c(t,e,n){return(_c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Tc(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Tc(t){return(Tc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xc(t,e){return(xc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kc=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Sc(this,Tc(e).call(this,"".concat(r,"-border-type-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).type=dc.SOLID_LINE,t.color="#000000",t.borderIcon1=new mr,t.borderIcon2=new Tr,t.borderIcon3=new Cr,t.borderIcon4=new Ir,t.borderIcon5=new Fr;var o=k("div","".concat(r,"-border-type-context-menu-type-icon-line"));o.children(t.borderIcon1),o.children(t.borderIcon2),o.children(t.borderIcon3),o.children(t.borderIcon4),o.children(t.borderIcon5),t.borderIcon6=new zr,t.borderIcon7=new $r,t.borderIcon8=new ei,t.borderIcon9=new ci,t.borderIcon10=new fi;var i=k("div","".concat(r,"-border-type-context-menu-type-icon-line"));i.children(t.borderIcon6),i.children(t.borderIcon7),i.children(t.borderIcon8),i.children(t.borderIcon9),i.children(t.borderIcon10),t.borderIcons=new br,t.borderIcons.removeClass("hover"),t.borderIcons.children(o),t.borderIcons.children(i),t.borderColor=new vi,t.borderType=new Ei;var c=k("div","".concat(r,"-border-type-context-menu-type-icon-line"));return c.children(t.borderColor),c.children(t.borderType),t.borderColorAndType=new br,t.borderColorAndType.removeClass("hover"),t.borderColorAndType.children(c),t.addItem(t.borderIcons),t.addItem(new we),t.addItem(t.borderColorAndType),t.borderColorContextMenu=new Ni(S.copyProp({el:t.borderColor},{onUpdate:function(e){t.color=e,t.borderColor.setColor(e)}})),t.lineTypeContextMenu=new Zi(S.copyProp({el:t.borderType},{onUpdate:function(e){t.type=e}})),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xc(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){L.unbind(this.borderColor,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.borderType,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.borderIcon1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.borderIcon2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.borderIcon3,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.borderIcon4,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.borderIcon5,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.borderIcon6,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.borderIcon7,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.borderIcon8,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.borderIcon9,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.borderIcon10,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN)}},{key:"bind",value:function(){var t=this;L.bind(this.borderColor,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.borderColorContextMenu,o=n.elPopUp;Kt.closeAll([o,t.elPopUp]),n.isClose()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),L.bind(this.borderType,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.lineTypeContextMenu,o=n.elPopUp;Kt.closeAll([o,t.elPopUp]),n.isClose()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),L.bind(this.borderIcon1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border1",t.color,t.type),e.stopPropagation(),e.preventDefault()})),L.bind(this.borderIcon2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border2",t.color,t.type),e.stopPropagation(),e.preventDefault()})),L.bind(this.borderIcon3,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border3",t.color,t.type),e.stopPropagation(),e.preventDefault()})),L.bind(this.borderIcon4,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border4",t.color,t.type),e.stopPropagation(),e.preventDefault()})),L.bind(this.borderIcon5,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border5",t.color,t.type),e.stopPropagation(),e.preventDefault()})),L.bind(this.borderIcon6,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border6",t.color,t.type),e.stopPropagation(),e.preventDefault()})),L.bind(this.borderIcon7,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border7",t.color,t.type),e.stopPropagation(),e.preventDefault()})),L.bind(this.borderIcon8,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border8",t.color,t.type),e.stopPropagation(),e.preventDefault()})),L.bind(this.borderIcon9,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border9",t.color,t.type),e.stopPropagation(),e.preventDefault()})),L.bind(this.borderIcon10,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border10",t.color,t.type),e.stopPropagation(),e.preventDefault()}))}},{key:"destroy",value:function(){_c(Tc(e.prototype),"destroy",this).call(this),this.unbind()}}])&&Ec(n.prototype,i),c&&Ec(n,c),e}(ne);function Pc(t){return(Pc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jc(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Cc(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rc(t){return(Rc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Lc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ac(t,e){return(Ac=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nc=function(t){function e(){var t,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=Rc(e).call(this,"".concat(r,"-tools-border")))||"object"!==Pc(o)&&"function"!=typeof o?Lc(n):o).options=i,t.icon=new ut("border"),t.setIcon(t.icon),t.borderTypeContextMenu=new kc(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?jc(Object(n),!0).forEach((function(e){Cc(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):jc(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({el:Lc(t)},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ac(t,e)}(e,t),e}(Ft);function Ic(t){return(Ic="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vc(t,e){return!e||"object"!==Ic(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dc(t){return(Dc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mc(t,e){return(Mc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Vc(this,Dc(e).call(this,"".concat(r,"-tools-merge")))).icon=new ut("merge"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mc(t,e)}(e,t),e}(pt);function Fc(t){return(Fc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bc(t,e){return!e||"object"!==Fc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wc(t){return(Wc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yc(t,e){return(Yc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Uc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Bc(this,Wc(e).call(this,"".concat(r,"-tools-horizontal1")))).icon=new ut("align-left"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yc(t,e)}(e,t),e}(pt);function zc(t){return(zc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gc(t,e){return!e||"object"!==zc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xc(t){return(Xc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zc(t,e){return(Zc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Kc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Gc(this,Xc(e).call(this,"".concat(r,"-tools-horizontal2")))).icon=new ut("align-center"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zc(t,e)}(e,t),e}(pt);function $c(t){return($c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qc(t,e){return!e||"object"!==$c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qc(t){return(Qc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jc(t,e){return(Jc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var tl=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=qc(this,Qc(e).call(this,"".concat(r,"-tools-horizontal3")))).icon=new ut("align-right"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jc(t,e)}(e,t),e}(pt);function el(t){return(el="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nl(t,e){return!e||"object"!==el(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ol(t){return(ol=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rl(t,e){return(rl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var il=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),nl(this,ol(e).call(this,"".concat(r,"-horizontal-type-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rl(t,e)}(e,t),e}(le);function cl(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var ll=function(){function t(e){var n=e.text,o=e.dw,r=e.attr,i=e.rect;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.text=n,this.dw=o,this.attr=r,this.rect=i}var e,n,o;return e=t,(n=[{key:"truncateFont",value:function(){throw new TypeError("child impl")}},{key:"overflowFont",value:function(){throw new TypeError("child impl")}},{key:"wrapTextFont",value:function(){throw new TypeError("child impl")}},{key:"draw",value:function(){throw new TypeError("child impl")}},{key:"textWidth",value:function(t){return this.dw.measureText(t).width}},{key:"textBreak",value:function(t){return t.split(/\n/)}},{key:"hasBreak",value:function(t){return t.indexOf("\n")>-1}},{key:"isBlank",value:function(t){return null==t||""===t.toString().trim()}},{key:"setTextWrap",value:function(t){this.attr.textWrap=t}},{key:"setSize",value:function(t){this.attr.size=t}},{key:"setPadding",value:function(t){this.attr.padding=t}},{key:"getAlignPadding",value:function(){return this.attr.align===t.ALIGN.center?0:this.attr.padding}},{key:"getVerticalAlignPadding",value:function(){return this.attr.verticalAlign===t.VERTICAL_ALIGN.center?0:this.attr.padding}}])&&cl(e.prototype,n),o&&cl(e,o),t}();function ul(t){return(ul="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function al(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function sl(t,e){return!e||"object"!==ul(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fl(t,e,n){return(fl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=hl(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function hl(t){return(hl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pl(t,e){return(pl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}ll.VERTICAL_ALIGN={top:"top",center:"middle",bottom:"bottom"},ll.ALIGN={left:"left",center:"center",right:"right"},ll.TEXT_WRAP={OVER_FLOW:1,WORD_WRAP:2,TRUNCATE:3},ll.TEXT_DIRECTION={HORIZONTAL:"horizontal",VERTICAL:"vertical",ANGLE:"angle"};var yl=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=sl(this,hl(e).call(this,"".concat(r,"-horizontal-type-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).horizontalIcon1=new Uc,t.horizontalIcon2=new Kc,t.horizontalIcon3=new tl;var o=k("div","".concat(r,"-horizontal-type-context-menu-type-icon-line"));return o.children(t.horizontalIcon1),o.children(t.horizontalIcon2),o.children(t.horizontalIcon3),t.horizontalIcons=new il,t.horizontalIcons.removeClass("hover"),t.horizontalIcons.children(o),t.addItem(t.horizontalIcons),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pl(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){L.unbind(this.horizontalIcon1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.horizontalIcon2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.horizontalIcon3,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN)}},{key:"bind",value:function(){var t=this;L.bind(this.horizontalIcon1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(ll.ALIGN.left),e.stopPropagation(),e.preventDefault()})),L.bind(this.horizontalIcon2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(ll.ALIGN.center),e.stopPropagation(),e.preventDefault()})),L.bind(this.horizontalIcon3,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(ll.ALIGN.right),e.stopPropagation(),e.preventDefault()}))}},{key:"destroy",value:function(){fl(hl(e.prototype),"destroy",this).call(this),this.unbind()}}])&&al(n.prototype,i),c&&al(n,c),e}(ne);function bl(t){return(bl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dl(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function vl(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gl(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function wl(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ml(t,e,n){return(ml="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ol(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Ol(t){return(Ol=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function El(t,e){return(El=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Sl=function(t){function e(){var t,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=Ol(e).call(this,"".concat(r,"-tools-horizontal-align")))||"object"!==bl(o)&&"function"!=typeof o?wl(n):o).options=i,t.icon=new ut("align-left"),t.setIcon(t.icon),t.horizontalContextMenu=new yl(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?dl(Object(n),!0).forEach((function(e){vl(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dl(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({el:wl(t)},t.options.contextMenu)),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&El(t,e)}(e,t),n=e,(o=[{key:"destroy",value:function(){ml(Ol(e.prototype),"destroy",this).call(this),this.horizontalContextMenu.destroy()}}])&&gl(n.prototype,o),i&&gl(n,i),e}(Ft);function _l(t){return(_l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tl(t,e){return!e||"object"!==_l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xl(t){return(xl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kl(t,e){return(kl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Tl(this,xl(e).call(this,"".concat(r,"-vertical-type-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kl(t,e)}(e,t),e}(le);function jl(t){return(jl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cl(t,e){return!e||"object"!==jl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rl(t){return(Rl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ll(t,e){return(Ll=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Al=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Cl(this,Rl(e).call(this,"".concat(r,"-tools-verticalIcon1")))).icon=new ut("align-top"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ll(t,e)}(e,t),e}(pt);function Nl(t){return(Nl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Il(t,e){return!e||"object"!==Nl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vl(t){return(Vl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dl(t,e){return(Dl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ml=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Il(this,Vl(e).call(this,"".concat(r,"-tools-verticalIcon2")))).icon=new ut("align-middle"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dl(t,e)}(e,t),e}(pt);function Hl(t){return(Hl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fl(t,e){return!e||"object"!==Hl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bl(t){return(Bl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wl(t,e){return(Wl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yl=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Fl(this,Bl(e).call(this,"".concat(r,"-tools-verticalIcon3")))).icon=new ut("align-bottom"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wl(t,e)}(e,t),e}(pt);function Ul(t){return(Ul="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zl(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Gl(t,e){return!e||"object"!==Ul(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xl(t,e,n){return(Xl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Zl(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Zl(t){return(Zl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kl(t,e){return(Kl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $l=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Gl(this,Zl(e).call(this,"".concat(r,"-vertical-type-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).verticalIcon1=new Al,t.verticalIcon2=new Ml,t.verticalIcon3=new Yl;var o=k("div","".concat(r,"-vertical-type-context-menu-type-icon-line"));return o.children(t.verticalIcon1),o.children(t.verticalIcon2),o.children(t.verticalIcon3),t.verticalIcons=new Pl,t.verticalIcons.removeClass("hover"),t.verticalIcons.children(o),t.addItem(t.verticalIcons),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kl(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){L.unbind(this.verticalIcon1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.verticalIcon2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.verticalIcon3,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN)}},{key:"bind",value:function(){var t=this;L.bind(this.verticalIcon1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(ll.VERTICAL_ALIGN.top),e.stopPropagation(),e.preventDefault()})),L.bind(this.verticalIcon2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(ll.VERTICAL_ALIGN.center),e.stopPropagation(),e.preventDefault()})),L.bind(this.verticalIcon3,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(ll.VERTICAL_ALIGN.bottom),e.stopPropagation(),e.preventDefault()}))}},{key:"destroy",value:function(){Xl(Zl(e.prototype),"destroy",this).call(this),this.unbind()}}])&&zl(n.prototype,i),c&&zl(n,c),e}(ne);function ql(t){return(ql="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ql(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Jl(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tu(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function eu(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nu(t,e,n){return(nu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ou(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function ou(t){return(ou=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ru(t,e){return(ru=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var iu=function(t){function e(){var t,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=ou(e).call(this,"".concat(r,"-tools-vertical-align")))||"object"!==ql(o)&&"function"!=typeof o?eu(n):o).options=i,t.icon=new ut("align-middle"),t.setIcon(t.icon),t.verticalContextMenu=new $l(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ql(Object(n),!0).forEach((function(e){Jl(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ql(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({el:eu(t)},t.options.contextMenu)),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ru(t,e)}(e,t),n=e,(o=[{key:"destroy",value:function(){nu(ou(e.prototype),"destroy",this).call(this),this.verticalContextMenu.destroy()}}])&&tu(n.prototype,o),i&&tu(n,i),e}(Ft);function cu(t){return(cu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lu(t,e){return!e||"object"!==cu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function uu(t){return(uu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function au(t,e){return(au=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var su=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=lu(this,uu(e).call(this,"".concat(r,"-tools-text-wrapping1")))).icon=new ut("truncate"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&au(t,e)}(e,t),e}(pt);function fu(t){return(fu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hu(t,e){return!e||"object"!==fu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pu(t){return(pu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yu(t,e){return(yu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bu=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=hu(this,pu(e).call(this,"".concat(r,"-tools-text-wrapping2")))).icon=new ut("overflow"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yu(t,e)}(e,t),e}(pt);function du(t){return(du="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vu(t,e){return!e||"object"!==du(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gu(t){return(gu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wu(t,e){return(wu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mu=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=vu(this,gu(e).call(this,"".concat(r,"-tools-text-wrapping3")))).icon=new ut("wrap"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wu(t,e)}(e,t),e}(pt);function Ou(t){return(Ou="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Eu(t,e){return!e||"object"!==Ou(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Su(t){return(Su=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _u(t,e){return(_u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tu=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Eu(this,Su(e).call(this,"".concat(r,"-text-wrapping-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_u(t,e)}(e,t),e}(le);function xu(t){return(xu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ku(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Pu(t,e){return!e||"object"!==xu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ju(t,e,n){return(ju="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Cu(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Cu(t){return(Cu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ru(t,e){return(Ru=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Lu=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Pu(this,Cu(e).call(this,"".concat(r,"-text-wrapping-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).textWrappingIcon1=new su,t.textWrappingIcon2=new bu,t.textWrappingIcon3=new mu;var o=k("div","".concat(r,"-text-wrapping-context-menu-type-icon-line"));return o.children(t.textWrappingIcon1),o.children(t.textWrappingIcon2),o.children(t.textWrappingIcon3),t.textWrappingIcons=new Tu,t.textWrappingIcons.removeClass("hover"),t.textWrappingIcons.children(o),t.addItem(t.textWrappingIcons),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ru(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){L.unbind(this.textWrappingIcon1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.textWrappingIcon2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.textWrappingIcon3,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN)}},{key:"bind",value:function(){var t=this;L.bind(this.textWrappingIcon1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(ll.TEXT_WRAP.TRUNCATE),e.stopPropagation(),e.preventDefault()})),L.bind(this.textWrappingIcon2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(ll.TEXT_WRAP.OVER_FLOW),e.stopPropagation(),e.preventDefault()})),L.bind(this.textWrappingIcon3,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(ll.TEXT_WRAP.WORD_WRAP),e.stopPropagation(),e.preventDefault()}))}},{key:"destroy",value:function(){ju(Cu(e.prototype),"destroy",this).call(this),this.unbind()}}])&&ku(n.prototype,i),c&&ku(n,c),e}(ne);function Au(t){return(Au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Iu(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vu(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Du(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Mu(t,e,n){return(Mu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Hu(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Hu(t){return(Hu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fu(t,e){return(Fu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bu=function(t){function e(){var t,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=Hu(e).call(this,"".concat(r,"-tools-text-wrapping")))||"object"!==Au(o)&&"function"!=typeof o?Du(n):o).options=i,t.icon=new ut("text-wrap"),t.setIcon(t.icon),t.textWrappingContextMenu=new Lu(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Nu(Object(n),!0).forEach((function(e){Iu(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Nu(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({el:Du(t)},t.options.contextMenu)),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fu(t,e)}(e,t),n=e,(o=[{key:"destroy",value:function(){Mu(Hu(e.prototype),"destroy",this).call(this),this.textWrappingContextMenu.destroy()}}])&&Vu(n.prototype,o),i&&Vu(n,i),e}(Ft);function Wu(t){return(Wu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yu(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Uu(t){return(Uu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zu(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gu(t,e){return(Gu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xu=[],Zu=function(t){function e(t){var n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(i=Uu(e).call(this,"".concat(r,"-fixed-context-menu-item")))||"object"!==Wu(i)&&"function"!=typeof i?zu(o):i).title=t,n.titleElement=k("div","".concat(r,"-fixed-context-menu-item-title")),n.titleElement.text(t),n.children(n.titleElement),Xu.push(zu(n)),n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gu(t,e)}(e,t),n=e,(o=[{key:"setTitle",value:function(t){this.title=t,this.titleElement.text(t)}}])&&Yu(n.prototype,o),i&&Yu(n,i),e}(le);function Ku(t){return(Ku="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $u(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function qu(t,e){return!e||"object"!==Ku(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qu(t,e,n){return(Qu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ju(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Ju(t){return(Ju=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ta(t,e){return(ta=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ea=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=qu(this,Ju(e).call(this,"".concat(r,"-fixed-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).row=new Zu("冻结至当前行"),t.row1=new Zu("冻结1行"),t.row2=new Zu("冻结2行"),t.col=new Zu("冻结至当前列"),t.col1=new Zu("冻结1列"),t.col2=new Zu("冻结2列"),t.addItem(t.row),t.addItem(t.row1),t.addItem(t.row2),t.addItem(new we),t.addItem(t.col),t.addItem(t.col1),t.addItem(t.col2),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ta(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){L.unbind(this.row,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.row1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.row2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.col,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.col1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN),L.unbind(this.col2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN)}},{key:"bind",value:function(){var t=this;L.bind(this.row,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.options.onUpdate("ROW"),t.close()})),L.bind(this.row1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.options.onUpdate("ROW1"),t.close()})),L.bind(this.row2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.options.onUpdate("ROW2"),t.close()})),L.bind(this.col,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.options.onUpdate("COL"),t.close()})),L.bind(this.col1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.options.onUpdate("COL1"),t.close()})),L.bind(this.col2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.options.onUpdate("COL2"),t.close()}))}},{key:"destroy",value:function(){Qu(Ju(e.prototype),"destroy",this).call(this),this.unbind()}}])&&$u(n.prototype,i),c&&$u(n,c),e}(ne);function na(t){return(na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oa(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ra(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ia(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ca(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function la(t,e,n){return(la="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ua(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function ua(t){return(ua=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function aa(t,e){return(aa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sa=function(t){function e(){var t,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=ua(e).call(this,"".concat(r,"-tools-fixed")))||"object"!==na(o)&&"function"!=typeof o?ca(n):o).options=i,t.icon=new ut("freeze"),t.rowStatus=!1,t.colStatus=!1,t.setIcon(t.icon),t.fixedContextMenu=new ea(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?oa(Object(n),!0).forEach((function(e){ra(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oa(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({el:ca(t)},t.options.contextMenu)),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&aa(t,e)}(e,t),n=e,(o=[{key:"setFixedColStatus",value:function(t){var e=this.fixedContextMenu;t?(this.colStatus=!0,e.col.setTitle("取消冻结列")):(this.colStatus=!1,e.col.setTitle("冻结至当前列"))}},{key:"setFixedRowStatus",value:function(t){var e=this.fixedContextMenu;t?(this.rowStatus=!0,e.row.setTitle("取消冻结行")):(this.rowStatus=!1,e.row.setTitle("冻结至当前行"))}},{key:"destroy",value:function(){la(ua(e.prototype),"destroy",this).call(this),this.fixedContextMenu.destroy()}}])&&ia(n.prototype,o),i&&ia(n,i),e}(Ft);function fa(t){return(fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ha(t,e){return!e||"object"!==fa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pa(t){return(pa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ya(t,e){return(ya=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ba=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ha(this,pa(e).call(this,"".concat(r,"-tools-filter")))).icon=new ut("filter"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ya(t,e)}(e,t),e}(pt);function da(t){return(da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function va(t,e){return!e||"object"!==da(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ga(t){return(ga=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wa(t,e){return(wa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ma=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=va(this,ga(e).call(this,"".concat(r,"-tools-format")))).icon=new ut("functions"),t.setIcon(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wa(t,e)}(e,t),e}(Ft);function Oa(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ea(t,e,n){return e&&Oa(t.prototype,e),n&&Oa(t,n),t}var Sa=function(){function t(e){var n=e.align,o=void 0===n?ll.ALIGN.left:n,r=e.verticalAlign,i=void 0===r?ll.VERTICAL_ALIGN.center:r,c=e.textWrap,l=void 0===c?ll.TEXT_WRAP.TRUNCATE:c,u=e.strikethrough,a=void 0!==u&&u,s=e.underline,f=void 0!==s&&s,h=e.color,p=void 0===h?"rgb(0,0,0)":h,y=e.name,b=void 0===y?"Arial":y,d=e.size,v=void 0===d?12:d,g=e.bold,w=void 0!==g&&g,m=e.italic,O=void 0!==m&&m,E=e.angle,S=void 0===E?0:E,_=e.direction,T=void 0===_?ll.TEXT_DIRECTION.HORIZONTAL:_,x=e.padding,k=void 0===x?5:x;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.align=o,this.verticalAlign=i,this.textWrap=l,this.strikethrough=a,this.underline=f,this.color=p,this.name=b,this.size=v,this.bold=w,this.italic=O,this.direction=T,this.angle=S,this.padding=k}return Ea(t,null,[{key:"setScaleAdapter",value:function(e){t.scaleAdapter=e}}]),Ea(t,[{key:"toCssStyle",value:function(){var e=t.scaleAdapter,n=this.align,o=this.size,r=this.color,i=this.bold,c=this.italic,l=this.name,u="left";switch(n){case ll.ALIGN.left:u="left";break;case ll.ALIGN.center:u="center";break;case ll.ALIGN.right:u="right"}var a=o;return a=e?e.goto(a):hc.srcTransformCssPx(a),"\n      text-align:".concat(u,";\n      font-size: ").concat(hc.srcTransformCssPx(a),"px;color: ").concat(r,";font-weight: ").concat(i?"bold":"initial",";\n      font-style: ").concat(c?"italic":"initial",";\n      font-family: ").concat(l,";\n    ").replace(/\s/g,"")}},{key:"clone",value:function(){return new t({align:this.align,verticalAlign:this.verticalAlign,textWrap:this.textWrap,strikethrough:this.strikethrough,underline:this.underline,color:this.color,name:this.name,size:this.size,bold:this.bold,italic:this.italic,angle:this.angle,direction:this.direction,padding:this.padding})}}]),t}();function _a(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ta(t,e,n){return e&&_a(t.prototype,e),n&&_a(t,n),t}Sa.scaleAdapter=null;var xa=0,ka=function(){function t(e){var n=e.widthType,o=void 0===n?hc.LINE_WIDTH_TYPE.low:n,r=e.width,i=void 0===r?-1:r,c=e.color,l=void 0===c?"#000000":c,u=e.zIndex,a=void 0===u?0:u,s=e.display,f=void 0!==s&&s,h=e.type,p=void 0===h?dc.SOLID_LINE:h;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$zIndex=a,this.$display=f,this.$color=l,this.$type=p,this.$widthType=1===i?hc.LINE_WIDTH_TYPE.low:2===i?hc.LINE_WIDTH_TYPE.medium:3===i?hc.LINE_WIDTH_TYPE.high:o,a>xa&&(xa=a)}return Ta(t,null,[{key:"getZIndex",value:function(){return xa+=1}}]),Ta(t,[{key:"equal",value:function(t){var e=this.widthType===t.widthType,n=this.color===t.color,o=this.type===t.type;return n&&e&&o}},{key:"toJSON",value:function(){return{zIndex:this.$zIndex,display:this.$display,widthType:this.$widthType,color:this.$color,type:this.$type}}},{key:"priority",value:function(t){if(S.isUnDef(t))return-2;var e=this.zIndex,n=t.zIndex;return e>n?1:n>e?-1:0}},{key:"zIndex",get:function(){return this.$zIndex}},{key:"display",get:function(){return this.$display},set:function(e){this.$zIndex=t.getZIndex(),this.$display=e}},{key:"widthType",get:function(){return this.$widthType},set:function(e){this.$zIndex=t.getZIndex(),this.$widthType=e}},{key:"color",get:function(){return this.$color},set:function(e){this.$zIndex=t.getZIndex(),this.$color=e}},{key:"type",get:function(){return this.$type},set:function(e){this.$zIndex=t.getZIndex(),this.$type=e}}]),t}();function Pa(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var ja=function(){function t(e){var n=e.left,o=void 0===n?{}:n,r=e.top,i=void 0===r?{}:r,c=e.right,l=void 0===c?{}:c,u=e.bottom,a=void 0===u?{}:u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.left=new ka(o),this.top=new ka(i),this.right=new ka(l),this.bottom=new ka(a)}var e,n,o;return e=t,(n=[{key:"setAllDisplay",value:function(t){this.setLDisplay(t),this.setTDisplay(t),this.setRDisplay(t),this.setBDisplay(t)}},{key:"setLDisplay",value:function(t){this.left.display=t}},{key:"setTDisplay",value:function(t){this.top.display=t}},{key:"setRDisplay",value:function(t){this.right.display=t}},{key:"setBDisplay",value:function(t){this.bottom.display=t}},{key:"setAllColor",value:function(t){this.setLColor(t),this.setTColor(t),this.setRColor(t),this.setBColor(t)}},{key:"setLColor",value:function(t){this.left.color=t}},{key:"setTColor",value:function(t){this.top.color=t}},{key:"setRColor",value:function(t){this.right.color=t}},{key:"setBColor",value:function(t){this.bottom.color=t}},{key:"setAllWidthType",value:function(t){this.setLWidthType(t),this.setTWidthType(t),this.setRWidthType(t),this.setBWidthType(t)}},{key:"setLWidthType",value:function(t){this.left.widthType=t}},{key:"setTWidthType",value:function(t){this.top.widthType=t}},{key:"setRWidthType",value:function(t){this.right.widthType=t}},{key:"setBWidthType",value:function(t){this.bottom.widthType=t}},{key:"setAllType",value:function(t){this.setLType(t),this.setTType(t),this.setRType(t),this.setBType(t)}},{key:"setLType",value:function(t){this.left.type=t}},{key:"setTType",value:function(t){this.top.type=t}},{key:"setRType",value:function(t){this.right.type=t}},{key:"setBType",value:function(t){this.bottom.type=t}},{key:"clone",value:function(){return new t({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}}])&&Pa(e.prototype,n),o&&Pa(e,o),t}();function Ca(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Ra=function(){function t(e){var n=e.x,o=e.y,r=e.width,i=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=n,this.y=o,this.width=r,this.height=i}var e,n,o;return e=t,(n=[{key:"inRectPosition",value:function(e){return new t({x:this.x-e.x,y:this.y-e.y,width:this.width,height:this.height})}},{key:"disjoint",value:function(t){return this.x>t.x+t.width||this.y>this.y+t.height||t.x>this.x+this.width||t.y>this.y+this.height}},{key:"expandSize",value:function(t){return this.width+=t,this.height+=t,this}},{key:"includePoint",value:function(t,e){return t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height}},{key:"includeRect",value:function(t){var e=t.x,n=t.y,o=t.width,r=t.height;return this.x<=e&&this.x+this.width>=e+o&&this.y<=n&&this.y+this.height>=n+r}},{key:"clone",value:function(){return new t({x:this.x,y:this.y,width:this.width,height:this.height})}}])&&Ca(e.prototype,n),o&&Ca(e,o),t}();function La(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Aa=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.x,o=void 0===n?0:n,r=e.y,i=void 0===r?0:r;La(this,t),this.x=o,this.y=i};function Na(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Ia=function(){function t(e){var n=e.rect,o=e.draw,r=e.offset,i=void 0===r?0:r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rect=n,this.draw=o,this.offset=i}var e,n,o;return e=t,(n=[{key:"open",value:function(){var t=this.rect,e=this.draw,n=this.offset,o=t.x,r=t.y,i=t.width,c=t.height;return e.save().rect(o,r,i+n,c+n).clip().beginPath(),this}},{key:"close",value:function(){return this.draw.restore(),this}}])&&Na(e.prototype,n),o&&Na(e,o),t}();function Va(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Da(t,e,n){return e&&Va(t.prototype,e),n&&Va(t,n),t}var Ma=function(){function t(e){var n=e.vertical,o=void 0===n?t.ICON_VERTICAL.CENTER:n,r=e.horizontal,i=void 0===r?t.ICON_HORIZONTAL.RIGHT:r,c=e.type,l=void 0===c?t.ICON_TYPE.image:c,u=e.image,a=void 0===u?S.Nul:u,s=e.focus,f=void 0===s?null:s,h=e.height,p=void 0===h?16:h,y=e.width,b=void 0===y?16:y,d=e.color,v=void 0===d?"#ffffff":d,g=e.offset,w=void 0===g?{x:0,y:0}:g,m=e.onDraw,O=void 0===m?function(){}:m,E=e.onLeave,_=void 0===E?function(){}:E,T=e.onMove,x=void 0===T?function(){}:T,k=e.onDown,P=void 0===k?function(){}:k,j=e.onEnter,C=void 0===j?function(){}:j;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertical=o,this.horizontal=i,this.width=b,this.height=p,this.type=l,this.image=a,this.color=v,this.focus=f,this.offset=new Aa(w),this.onLeave=_,this.onMove=x,this.onDraw=O,this.onDown=P,this.onEnter=C,this.rect=null}return Da(t,null,[{key:"newInstances",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[],o=0;o<e.length;o+=1){var r=e[o];n.push(new t(r))}return n}}]),Da(t,[{key:"position",value:function(e){var n=this.horizontal,o=this.vertical,r=hc.srcTransformStylePx(this.offset.x),i=hc.srcTransformStylePx(this.offset.y),c=hc.srcTransformStylePx(this.width),l=hc.srcTransformStylePx(this.height),u=e.x,a=e.y,s=e.width,f=e.height,h=0,p=0;switch(n){case t.ICON_HORIZONTAL.CENTER:h=u+s/2-c/2;break;case t.ICON_HORIZONTAL.LEFT:h=u;break;case t.ICON_HORIZONTAL.RIGHT:h=u+s-c}switch(o){case t.ICON_VERTICAL.CENTER:p=a+f/2-l/2;break;case t.ICON_VERTICAL.TOP:p=a;break;case t.ICON_VERTICAL.BOTTOM:p=a+f-l}return new Ra({x:h+=r,y:p+=i,width:c,height:l})}},{key:"loadImage",value:function(e){var n=this,o=e.load,r=e.sync,i=this.image;switch(this.type){case t.ICON_TYPE.image:if(i instanceof Image)r(i);else{var c=new Image;c.src=i,c.complete?(this.image=c,r(this.image)):(c.onload=function(){n.image=c,o(c)},c.onerror=function(){console.error("图片加载失败".concat(i))})}break;case t.ICON_TYPE.draw:r()}}},{key:"drawIcon",value:function(e){var n=e.rect,o=e.draw,r=this.type;switch(this.rect=n,r){case t.ICON_TYPE.image:this.drawImage({rect:n,draw:o});break;case t.ICON_TYPE.draw:this.drawCustom({rect:n,draw:o})}}},{key:"drawCustom",value:function(t){var e=t.rect,n=t.draw;this.onDraw({rect:e,draw:n})}},{key:"drawImage",value:function(t){var e=t.rect,n=t.draw,o=this.image,r=this.color,i=this.position(e),c=i.x,l=i.y,u=i.width,a=i.height,s=e.includeRect(i),f=new Ia({rect:e,draw:n});!1===s&&f.open(),r&&(n.attr({fillStyle:r}),n.fillRect(c,l,u,a)),n.drawImage(o,0,0,o.width,o.height,c,l,u,a),!1===s&&f.close()}},{key:"eventHandle",value:function(e){var n=e.type,o=e.x,r=e.y,i=e.native,c=this.rect,l=this.focus;if(c){var u=this.position(c),a=u.inRectPosition(c),s=l.activate;switch(n){case t.ICON_EVENT_TYPE.MOUSE_DOWN:a.includePoint(o,r)&&(l.setActivate(this),this.onDown({native:i,position:u}));break;case t.ICON_EVENT_TYPE.MOUSE_MOVE:a.includePoint(o,r)?(s!==this&&this.onEnter({native:i,position:u}),l.setActivate(this),this.onMove({native:i,position:u})):s&&(l.setActivate(null),this.onLeave({native:i,position:u}))}}}},{key:"setOnDraw",value:function(t){this.onDraw=t}},{key:"setOnDown",value:function(t){this.onDown=t}},{key:"setOnMove",value:function(t){this.onMove=t}},{key:"setOnEnter",value:function(t){this.onEnter=t}},{key:"setOnLeave",value:function(t){this.onLeave=t}},{key:"setFocus",value:function(t){this.focus=t}}]),t}();function Ha(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}Ma.ICON_HORIZONTAL={LEFT:0,RIGHT:1,CENTER:2},Ma.ICON_VERTICAL={TOP:3,BOTTOM:4,CENTER:5},Ma.ICON_TYPE={image:1,custom:2},Ma.ICON_EVENT_TYPE={MOUSE_DOWN:1,MOUSE_MOVE:2};var Fa=function(){function t(e){var n=e.text,o=void 0===n?S.EMPTY:n,r=e.background,i=void 0===r?S.Nul:r,c=e.format,l=void 0===c?"default":c,u=e.borderAttr,a=void 0===u?{}:u,s=e.icons,f=void 0===s?[]:s,h=e.fontAttr,p=void 0===h?{}:h,y=e.contentWidth,b=void 0===y?0:y;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.background=i,this.text=o,this.format=l,this.icons=Ma.newInstances(f),this.borderAttr=new ja(a),this.fontAttr=new Sa(p),this.contentWidth=b}var e,n,o;return e=t,(n=[{key:"setContentWidth",value:function(t){this.contentWidth=t}},{key:"setFontAttr",value:function(t){this.fontAttr=t}},{key:"setIcons",value:function(t){this.icons=t}},{key:"setBorderAttr",value:function(t){this.borderAttr=t}},{key:"toJSON",value:function(){return{background:this.background,format:this.format,text:this.text,fontAttr:this.fontAttr,borderAttr:this.borderAttr,contentWidth:this.contentWidth,icons:this.icons}}},{key:"toCssStyle",value:function(){var t=this.background,e=this.fontAttr,n="\n      background:".concat(t,";\n    ");return n=n.replace(/\s/g,""),e.toCssStyle()+n}},{key:"clone",value:function(){return new t({background:this.background,format:this.format,text:this.text,fontAttr:this.fontAttr,borderAttr:this.borderAttr,contentWidth:this.contentWidth,icons:this.icons})}}])&&Ha(e.prototype,n),o&&Ha(e,o),t}();function Ba(t){return(Ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wa(t,e){return!e||"object"!==Ba(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ya(t){return(Ya=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ua(t,e){return(Ua=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var za=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Wa(this,Ya(e).call(this,"".concat(r,"-scale-context-menu-item")))).scale=t,n.titleElement=k("div","".concat(r,"-scale-context-menu-item-title")),n.titleElement.text("".concat(t,"%")),n.children(n.titleElement),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ua(t,e)}(e,t),e}(le);function Ga(t){return(Ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xa(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Za(t,e){return!e||"object"!==Ga(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ka(t,e,n){return(Ka="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$a(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function $a(t){return($a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qa(t,e){return(qa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qa=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Za(this,$a(e).call(this,"".concat(r,"-scale-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).items=[new za(200),new za(150),new za(125),new za(100),new za(90),new za(75),new za(50)],t.items.forEach((function(e){t.addItem(e)})),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qa(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){this.items.forEach((function(t){L.unbind(t,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN)}))}},{key:"bind",value:function(){var t=this;this.items.forEach((function(e){L.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.update(e.scale)}))}))}},{key:"update",value:function(t){this.options.onUpdate(t),this.close()}},{key:"destroy",value:function(){Ka($a(e.prototype),"destroy",this).call(this),this.unbind()}}])&&Xa(n.prototype,i),c&&Xa(n,c),e}(ne);function Ja(t){return(Ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ts(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function es(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ns(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function os(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rs(t,e,n){return(rs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=is(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function is(t){return(is=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cs(t,e){return(cs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ls=function(t){function e(){var t,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=is(e).call(this,"".concat(r,"-tools-scale")))||"object"!==Ja(o)&&"function"!=typeof o?os(n):o).options=i,t.setTitle("100%"),t.setWidth(50),t.setEllipsis(),t.scaleContextMenu=new Qa(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ts(Object(n),!0).forEach((function(e){es(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ts(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({el:os(t)},t.options.contextMenu)),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cs(t,e)}(e,t),n=e,(o=[{key:"destroy",value:function(){rs(is(e.prototype),"destroy",this).call(this),this.scaleContextMenu.destroy()}}])&&ns(n.prototype,o),i&&ns(n,i),e}(Ft);function us(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var as=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.finishCallback=function(){},this.loopCallback=function(){},this.nextCallback=function(){},this.end=0,this.begin=0}var e,n,o;return e=t,(n=[{key:"execute",value:function(){var t,e=this.loopCallback,n=this.nextCallback,o=this.begin,r=this.end;if(o>r)for(t=o;t>=r&&!1!==e(t);n(t-=1));else for(t=o;t<=r&&!1!==e(t);n(t+=1));return this.finishCallback(t),this}},{key:"setLoop",value:function(t){return this.loopCallback=t,this}},{key:"setNext",value:function(t){return this.nextCallback=t,this}},{key:"setFinish",value:function(t){return this.finishCallback=t,this}},{key:"setEnd",value:function(t){return this.end=t,this}},{key:"setBegin",value:function(t){return this.begin=t,this}}])&&us(e.prototype,n),o&&us(e,o),t}();function ss(t){return(ss="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fs(t,e){return!e||"object"!==ss(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hs(t){return(hs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ps(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ys(t,e,n){return e&&ps(t.prototype,e),n&&ps(t,n),t}function bs(t,e){return(bs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ds=[],vs=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=fs(this,hs(e).call(this))).useFold=!0,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bs(t,e)}(e,t),ys(e,null,[{key:"getInstance",value:function(){return new e}},{key:"setFold",value:function(t){ds=t}}]),ys(e,[{key:"execute",value:function(){var t,e=this.loopCallback,n=this.nextCallback,o=this.begin,r=this.end,i=this.useFold;if(o>r)for(t=o;t>=r;n(t-=1)){if(!i||!ds[t])if(!1===e(t))break}else for(t=o;t<=r;n(t+=1)){if(!i||!ds[t])if(!1===e(t))break}return this.finishCallback(t),this}},{key:"nextRow",value:function(){var t=this.begin,e=-1;return this.setLoop((function(n){return n===t||(e=n,!1)})).execute(),e}},{key:"hasFold",value:function(){var t=!1;return this.setLoop((function(e){return!ds[e]||(t=!0,!1)})).foldOnOff(!1).execute(),t}},{key:"foldOnOff",value:function(t){return this.useFold=t,this}}]),e}(as);function gs(t){return(gs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ws(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ms(t,e){return!e||"object"!==gs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Os(t){return(Os=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Es(t,e){return(Es=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ss=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ms(this,Os(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Es(t,e)}(e,t),n=e,r=[{key:"getInstance",value:function(){return new e}}],(o=[{key:"nextRow",value:function(){var t=this.begin,e=-1;return this.setLoop((function(n){return n===t||(e=n,!1)})).execute(),e}}])&&ws(n.prototype,o),r&&ws(n,r),e}(as);function _s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ts(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var xs=function(){function t(e,n,o,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sri=e,this.sci=n,this.eri=o,this.eci=r,this.w=i,this.h=c}var e,n,o;return e=t,o=[{key:"valueOf",value:function(e){var n=e.split(":"),o=_s(S.expr2xy(n[0]),2),r=o[0],i=o[1],c=i,l=r;if(n.length>1){var u=_s(S.expr2xy(n[1]),2);l=u[0],c=u[1]}return new t(i,r,c,l)}}],(n=[{key:"set",value:function(t,e,n,o){this.sri=t,this.sci=e,this.eri=n,this.eci=o}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];if(1===o.length){var i=S.expr2xy(o[0]),c=_s(i,2);e=c[0],t=c[1]}else 2===o.length&&(t=o[0],e=o[1]);var l=this.sri,u=this.sci,a=this.eri,s=this.eci;return l<=t&&t<=a&&u<=e&&e<=s}},{key:"each",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=this.sri,o=this.sci,r=this.eri,i=this.eci,c=!1;vs.getInstance().setBegin(n).setEnd(r).setLoop((function(n){return e(n)&&Ss.getInstance().setBegin(o).setEnd(i).setLoop((function(e){return c=t(n,e)})).execute(),c})).execute()}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var n=this.sri,o=this.sci,r=this.eri,i=this.eci;return new t(e.sri<n?e.sri:n,e.sci<o?e.sci:o,e.eri>r?e.eri:r,e.eci>i?e.eci:i)}},{key:"coincide",value:function(e){var n=this.sri,o=this.sci,r=this.eri,i=this.eci;return this.disjoint(e)?t.EMPTY:new t(e.sri>n?e.sri:n,e.sci>o?e.sci:o,e.eri<r?e.eri:r,e.eci<i?e.eci:i)}},{key:"coincideDifference",value:function(e){return this.coincide(e).equals(t.EMPTY)?[]:this.difference(e)}},{key:"difference",value:function(e){var n=[],o=function(e,o,r,i){n.push(new t(e,o,r,i))},r=this.sri,i=this.sci,c=this.eri,l=this.eci,u=e.sri-r,a=e.sci-i,s=c-e.eri,f=l-e.eci;return u>0?(o(r,i,e.sri-1,l),s>0?(o(e.eri+1,i,c,l),a>0&&o(e.sri,i,e.eri,e.sci-1),f>0&&o(e.sri,e.eci+1,e.eri,l)):(a>0&&o(e.sri,i,c,e.sci-1),f>0&&o(e.sri,e.eci+1,c,l))):s>0&&(o(e.eri+1,i,c,l),a>0&&o(r,i,e.eri,e.sci-1),f>0&&o(r,e.eci+1,e.eri,l)),a>0?(o(r,i,c,e.sci-1),f>0?(o(r,e.eri+1,c,l),u>0&&o(r,e.sci,e.sri-1,e.eci),s>0&&o(e.sri+1,e.sci,c,e.eci)):(u>0&&o(r,e.sci,e.sri-1,l),s>0&&o(e.sri+1,e.sci,c,l))):f>0&&(o(r,e.eci+1,c,l),u>0&&o(r,i,e.sri-1,e.eci),s>0&&o(e.eri+1,i,c,e.eci)),n}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"brink",value:function(){var e=this.sri,n=this.eri,o=this.sci,r=this.eci,i=new t(e,o,e,r),c=new t(n,o,n,r);return{top:i,right:new t(e,r,n,r),bottom:c,left:new t(e,o,n,o)}}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"toString",value:function(){var t=this.sri,e=this.sci,n=this.eri,o=this.eci,r=S.xy2expr(e,t);return this.multiple()&&(r="".concat(r,":").concat(S.xy2expr(o,n))),r}}])&&Ts(e.prototype,n),o&&Ts(e,o),t}();function ks(t){return(ks="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ps(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function js(t,e){return!e||"object"!==ks(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Cs(t){return(Cs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rs(t,e){return(Rs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}xs.EMPTY=new xs(-1,-1,-1,-1);var Ls=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=js(this,Cs(e).call(this,"".concat(r,"-x-screen-part ").concat(t)))).xScreenZone=null,n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rs(t,e)}(e,t),n=e,(o=[{key:"onAttach",value:function(t){this.xScreenZone=t}}])&&Ps(n.prototype,o),i&&Ps(n,i),e}(B);function As(t){return(As="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ns(t,e){return!e||"object"!==As(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Is(t){return(Is=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vs(t,e){return(Vs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ds=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ns(this,Is(e).call(this,"".concat(r,"-x-screen-lt-part ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vs(t,e)}(e,t),e}(Ls);function Ms(t){return(Ms="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hs(t,e){return!e||"object"!==Ms(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fs(t){return(Fs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bs(t,e){return(Bs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ws=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Hs(this,Fs(e).call(this,"".concat(r,"-x-screen-br-part ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bs(t,e)}(e,t),e}(Ls);function Ys(t){return(Ys="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Us(t,e){return!e||"object"!==Ys(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zs(t){return(zs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gs(t,e){return(Gs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xs=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Us(this,zs(e).call(this,"".concat(r,"-x-screen-l-part ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gs(t,e)}(e,t),e}(Ls);function Zs(t){return(Zs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ks(t,e){return!e||"object"!==Zs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $s(t){return($s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qs(t,e){return(qs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qs=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ks(this,$s(e).call(this,"".concat(r,"-x-screen-br-part ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qs(t,e)}(e,t),e}(Ls);function Js(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var tf=function(){function t(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).table;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.lt=new Ds,this.t=new Ws,this.br=new Qs,this.l=new Xs,this.xScreen=null}var e,n,o;return e=t,(n=[{key:"onAdd",value:function(){}},{key:"hide",value:function(){this.lt.hide(),this.t.hide(),this.br.hide(),this.l.hide()}},{key:"show",value:function(){this.lt.show(),this.t.show(),this.br.show(),this.l.show()}},{key:"setXScreen",value:function(t){this.xScreen=t}},{key:"destroy",value:function(){}}])&&Js(e.prototype,n),o&&Js(e,o),t}();function ef(t){return(ef="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nf(t,e){return!e||"object"!==ef(e)&&"function"!=typeof e?of(t):e}function of(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rf(t,e,n){return(rf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=cf(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function cf(t){return(cf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lf(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&uf(t,e)}function uf(t,e){return(uf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function af(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sf(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ff(t,e,n){return e&&sf(t.prototype,e),n&&sf(t,n),t}var hf=function(){function t(e){af(this,t),this.viewEyes=e}return ff(t,[{key:"setDisplay",value:function(t){var e=this.getXScreenViewRange().coincide(t),n=this.getPart();return e!==xs.EMPTY?(n.show(),!0):(n.hide(),!1)}},{key:"getPart",value:function(){throw new TypeError("child impl")}},{key:"getXScreenViewRange",value:function(){throw new TypeError("child impl")}}]),t}(),pf=function(t){function e(){return af(this,e),nf(this,cf(e).apply(this,arguments))}return lf(e,t),ff(e,[{key:"setDisplay",value:function(t){var n=this.viewEyes.table.xFixedView;return!(!n.hasFixedTop()||!n.hasFixedLeft())&&rf(cf(e.prototype),"setDisplay",this).call(this,t)}},{key:"getPart",value:function(){return this.viewEyes.lt}},{key:"getXScreenViewRange",value:function(){var t=this.viewEyes.table.xFixedView;return t.hasFixedTop()&&t.hasFixedLeft()?t.getFixedView():xs.EMPTY}}]),e}(hf),yf=function(t){function e(){return af(this,e),nf(this,cf(e).apply(this,arguments))}return lf(e,t),ff(e,[{key:"setDisplay",value:function(t){return!!this.viewEyes.table.xFixedView.hasFixedTop()&&rf(cf(e.prototype),"setDisplay",this).call(this,t)}},{key:"getPart",value:function(){return this.viewEyes.t}},{key:"getXScreenViewRange",value:function(){var t=this.viewEyes.table,e=t.xFixedView;if(e.hasFixedTop()){var n=e.getFixedView(),o=t.getScrollView();return new xs(n.sri,o.sci,n.eri,o.eci)}return xs.EMPTY}}]),e}(hf),bf=function(t){function e(){return af(this,e),nf(this,cf(e).apply(this,arguments))}return lf(e,t),ff(e,[{key:"getPart",value:function(){return this.viewEyes.br}},{key:"getXScreenViewRange",value:function(){return this.viewEyes.table.getScrollView()}}]),e}(hf),df=function(t){function e(){return af(this,e),nf(this,cf(e).apply(this,arguments))}return lf(e,t),ff(e,[{key:"setDisplay",value:function(t){return!!this.viewEyes.table.xFixedView.hasFixedLeft()&&(rf(cf(e.prototype),"setDisplay",this).call(this,t),!0)}},{key:"getPart",value:function(){return this.viewEyes.l}},{key:"getXScreenViewRange",value:function(){var t=this.viewEyes.table,e=t.xFixedView;if(e.hasFixedLeft()){var n=e.getFixedView(),o=t.getScrollView();return new xs(o.sri,n.sci,o.eri,n.eci)}return xs.EMPTY}}]),e}(hf),vf=function(t){function e(){var t,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).table;return af(this,e),(t=nf(this,cf(e).call(this,{table:n}))).ltDisplay=new pf(of(t)),t.tDisplay=new yf(of(t)),t.brDisplay=new bf(of(t)),t.lDisplay=new df(of(t)),t}return lf(e,t),ff(e,[{key:"setDisplay",value:function(t){var e=this.ltDisplay.setDisplay(t),n=this.tDisplay.setDisplay(t),o=this.brDisplay.setDisplay(t),r=this.lDisplay.setDisplay(t);return e||n||o||r}},{key:"setLocal",value:function(){throw new TypeError("child impl")}},{key:"setSizer",value:function(){throw new TypeError("child impl")}}]),e}(tf);function gf(t){return(gf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wf(t,e){return!e||"object"!==gf(e)&&"function"!=typeof e?mf(t):e}function mf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Of(t,e,n){return(Of="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ef(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Ef(t){return(Ef=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sf(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_f(t,e)}function _f(t,e){return(_f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Tf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xf(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function kf(t,e,n){return e&&xf(t.prototype,e),n&&xf(t,n),t}var Pf=function(){function t(e){Tf(this,t),this.viewLocal=e}return kf(t,[{key:"setLeft",value:function(t){var e=this.viewLocal.table.cols,n=this.getXScreenViewRange(),o=n.coincide(t),r=o!==xs.EMPTY?e.sectionSumWidth(n.sci,o.sci-1):0;this.getPart().offset({left:r})}},{key:"setTop",value:function(t){var e=this.viewLocal.table.rows,n=this.getXScreenViewRange(),o=n.coincide(t),r=o!==xs.EMPTY?e.sectionSumHeight(n.sri,o.sri-1):0;this.getPart().offset({top:r})}},{key:"setLocal",value:function(t){this.setTop(t),this.setLeft(t)}},{key:"getPart",value:function(){throw new TypeError("child impl")}},{key:"getXScreenViewRange",value:function(){throw new TypeError("child impl")}}]),t}(),jf=function(t){function e(){return Tf(this,e),wf(this,Ef(e).apply(this,arguments))}return Sf(e,t),kf(e,[{key:"setLocal",value:function(t){var n=this.viewLocal.table.xFixedView;n.hasFixedTop()&&n.hasFixedLeft()&&Of(Ef(e.prototype),"setLocal",this).call(this,t)}},{key:"getPart",value:function(){return this.viewLocal.lt}},{key:"getXScreenViewRange",value:function(){var t=this.viewLocal.table.xFixedView;return t.hasFixedTop()&&t.hasFixedLeft()?t.getFixedView():xs.EMPTY}}]),e}(Pf),Cf=function(t){function e(){return Tf(this,e),wf(this,Ef(e).apply(this,arguments))}return Sf(e,t),kf(e,[{key:"setLocal",value:function(t){this.viewLocal.table.xFixedView.hasFixedTop()&&Of(Ef(e.prototype),"setLocal",this).call(this,t)}},{key:"getPart",value:function(){return this.viewLocal.t}},{key:"getXScreenViewRange",value:function(){var t=this.viewLocal.table,e=t.xFixedView;if(e.hasFixedTop()){var n=e.getFixedView(),o=t.getScrollView();return new xs(n.sri,o.sci,n.eri,o.eci)}return xs.EMPTY}}]),e}(Pf),Rf=function(t){function e(){return Tf(this,e),wf(this,Ef(e).apply(this,arguments))}return Sf(e,t),kf(e,[{key:"getPart",value:function(){return this.viewLocal.br}},{key:"getXScreenViewRange",value:function(){return this.viewLocal.table.getScrollView()}}]),e}(Pf),Lf=function(t){function e(){return Tf(this,e),wf(this,Ef(e).apply(this,arguments))}return Sf(e,t),kf(e,[{key:"setLocal",value:function(t){this.viewLocal.table.xFixedView.hasFixedLeft()&&Of(Ef(e.prototype),"setLocal",this).call(this,t)}},{key:"getPart",value:function(){return this.viewLocal.l}},{key:"getXScreenViewRange",value:function(){var t=this.viewLocal.table,e=t.xFixedView;if(e.hasFixedLeft()){var n=e.getFixedView(),o=t.getScrollView();return new xs(o.sri,n.sci,o.eri,n.eci)}return xs.EMPTY}}]),e}(Pf),Af=function(t){function e(){var t,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).table;return Tf(this,e),(t=wf(this,Ef(e).call(this,{table:n}))).tlLocal=new jf(mf(t)),t.tLocal=new Cf(mf(t)),t.brLocal=new Rf(mf(t)),t.lLocal=new Lf(mf(t)),t}return Sf(e,t),kf(e,[{key:"setLocal",value:function(t){this.tlLocal.setLocal(t),this.tLocal.setLocal(t),this.brLocal.setLocal(t),this.lLocal.setLocal(t)}}]),e}(vf);function Nf(t){return(Nf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function If(t,e){return!e||"object"!==Nf(e)&&"function"!=typeof e?Vf(t):e}function Vf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Df(t,e,n){return(Df="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Mf(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Mf(t){return(Mf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hf(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ff(t,e)}function Ff(t,e){return(Ff=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Bf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wf(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Yf(t,e,n){return e&&Wf(t.prototype,e),n&&Wf(t,n),t}var Uf=function(){function t(e){Bf(this,t),this.viewSizer=e}return Yf(t,[{key:"setSizer",value:function(t){var e=this.viewSizer.table,n=e.cols,o=e.rows,r=this.getXScreenViewRange().coincide(t),i=n.rectRangeSumWidth(r),c=o.rectRangeSumHeight(r);this.getPart().offset({width:hc.offsetToLineInside(i),height:hc.offsetToLineInside(c)})}},{key:"getPart",value:function(){throw new TypeError("child impl")}},{key:"getXScreenViewRange",value:function(){throw new TypeError("child impl")}}]),t}(),zf=function(t){function e(){return Bf(this,e),If(this,Mf(e).apply(this,arguments))}return Hf(e,t),Yf(e,[{key:"setSizer",value:function(t){var n=this.viewSizer.table.xFixedView;n.hasFixedTop()&&n.hasFixedLeft()&&Df(Mf(e.prototype),"setSizer",this).call(this,t)}},{key:"getPart",value:function(){return this.viewSizer.lt}},{key:"getXScreenViewRange",value:function(){var t=this.viewSizer.table.xFixedView;return t.hasFixedTop()&&t.hasFixedLeft()?t.getFixedView():xs.EMPTY}}]),e}(Uf),Gf=function(t){function e(){return Bf(this,e),If(this,Mf(e).apply(this,arguments))}return Hf(e,t),Yf(e,[{key:"setSizer",value:function(t){this.viewSizer.table.xFixedView.hasFixedTop()&&Df(Mf(e.prototype),"setSizer",this).call(this,t)}},{key:"getPart",value:function(){return this.viewSizer.t}},{key:"getXScreenViewRange",value:function(){var t=this.viewSizer.table,e=t.xFixedView;if(e.hasFixedTop()){var n=e.getFixedView(),o=t.getScrollView();return new xs(n.sri,o.sci,n.eri,o.eci)}return xs.EMPTY}}]),e}(Uf),Xf=function(t){function e(){return Bf(this,e),If(this,Mf(e).apply(this,arguments))}return Hf(e,t),Yf(e,[{key:"getPart",value:function(){return this.viewSizer.br}},{key:"getXScreenViewRange",value:function(){return this.viewSizer.table.getScrollView()}}]),e}(Uf),Zf=function(t){function e(){return Bf(this,e),If(this,Mf(e).apply(this,arguments))}return Hf(e,t),Yf(e,[{key:"setSizer",value:function(t){this.viewSizer.table.xFixedView.hasFixedLeft()&&Df(Mf(e.prototype),"setSizer",this).call(this,t)}},{key:"getPart",value:function(){return this.viewSizer.l}},{key:"getXScreenViewRange",value:function(){var t=this.viewSizer.table,e=t.xFixedView;if(e.hasFixedLeft()){var n=e.getFixedView(),o=t.getScrollView();return new xs(o.sri,n.sci,o.eri,n.eci)}return xs.EMPTY}}]),e}(Uf),Kf=function(t){function e(){var t,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).table;return Bf(this,e),(t=If(this,Mf(e).call(this,{table:n}))).ltSizer=new zf(Vf(t)),t.tSizer=new Gf(Vf(t)),t.brSizer=new Xf(Vf(t)),t.lSizer=new Zf(Vf(t)),t}return Hf(e,t),Yf(e,[{key:"setSizer",value:function(t){this.ltSizer.setSizer(t),this.tSizer.setSizer(t),this.brSizer.setSizer(t),this.lSizer.setSizer(t)}}]),e}(Af);function $f(t){return($f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qf(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Jf(t,e,n){return e&&Qf(t.prototype,e),n&&Qf(t,n),t}function th(t,e){return!e||"object"!==$f(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function eh(t){return(eh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nh(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oh(t,e)}function oh(t,e){return(oh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rh={LT:Symbol("lt"),T:Symbol("t"),BR:Symbol("br"),L:Symbol("l"),LTT:Symbol("ltt"),LTL:Symbol("ltl"),BRT:Symbol("brt"),BRL:Symbol("brl"),ALL:Symbol("all")},ih=function(t){function e(t){var n,o=t.table,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return qf(this,e),(n=th(this,eh(e).call(this,{table:o}))).blt=new Ds(r),n.bt=new Ws(r),n.bl=new Xs(r),n.bbr=new Qs(r),n.lt.children(n.blt),n.t.children(n.bt),n.l.children(n.bl),n.br.children(n.bbr),n}return nh(e,t),Jf(e,[{key:"hideBorder",value:function(){[this.bbr,this.bt,this.bl,this.blt].forEach((function(t){t.removeClass("show-bottom-border"),t.removeClass("show-top-border"),t.removeClass("show-right-border"),t.removeClass("show-left-border")}))}},{key:"showBorder",value:function(t){var e=this.getOverGo(t),n=this.getBorderDisplay(t);return this.showBBorder(e,n),this.showTBorder(e,n),this.showLBorder(e,n),this.showRBorder(e,n),n}}]),e}(function(t){function e(){return qf(this,e),th(this,eh(e).apply(this,arguments))}return nh(e,t),Jf(e,[{key:"getBorderDisplay",value:function(t){var e=this.table.getScrollView(),n={bottom:!1,left:!1,top:!1,right:!1};switch(this.getOverGo(t)){case rh.LT:n.bottom=!0,n.top=!0,n.left=!0,n.right=!0;break;case rh.T:n.bottom=!0,n.top=!0,n.left=t.sci>=e.sci&&t.sci<=e.eci,n.right=t.eci<=e.eci&&t.eci>=e.sci;break;case rh.BR:n.bottom=t.eri<=e.eri&&t.eri>=e.sri,n.top=t.sri>=e.sri&&t.sri<=e.eri,n.left=t.sci>=e.sci&&t.sci<=e.eci,n.right=t.eci<=e.eci&&t.eci>=e.sci;break;case rh.L:n.bottom=t.eri<=e.eri&&t.eri>=e.sri,n.top=t.sri>=e.sri&&t.sri<=e.eri,n.left=!0,n.right=!0;break;case rh.LTT:n.bottom=!0,n.top=!0,n.left=!0,n.right=t.eci<=e.eci&&t.eci>=e.sci;break;case rh.LTL:n.bottom=t.eri<=e.eri&&t.eri>=e.sri,n.top=!0,n.left=!0,n.right=!0;break;case rh.BRT:n.bottom=t.eri<=e.eri&&t.eri>=e.sri,n.top=!0,n.left=t.sci>=e.sci&&t.sci<=e.eci,n.right=t.eci<=e.eci&&t.eci>=e.sci;break;case rh.BRL:n.bottom=t.eri<=e.eri&&t.eri>=e.sri,n.top=t.sri>=e.sri&&t.sri<=e.eri,n.left=!0,n.right=t.eci<=e.eci&&t.eci>=e.sci;break;case rh.ALL:n.bottom=t.eri<=e.eri&&t.eri>=e.sri,n.top=!0,n.left=!0,n.right=t.eci<=e.eci&&t.eci>=e.sci}return n}},{key:"getOverGo",value:function(t){var e=this.table,n=e.cols,o=e.rows,r=e.xFixedView,i=o.len-1,c=n.len-1,l=r.getFixedView();if(r.hasFixedTop()&&r.hasFixedLeft()){var u=l,a=new xs(l.sri,l.eci+1,l.eri,c),s=new xs(l.eri+1,l.sci,i,l.eci),f=new xs(l.eri+1,l.eci+1,i,c);if(u.contains(t))return rh.LT;if(a.contains(t))return rh.T;if(f.contains(t))return rh.BR;if(s.contains(t))return rh.L;var h=new xs(l.sri,l.sci,l.eri,c),p=new xs(l.sri,l.sci,i,l.eci),y=new xs(l.sri,l.eci+1,i,c),b=new xs(l.eri+1,l.sci,i,c);return h.contains(t)?rh.LTT:p.contains(t)?rh.LTL:y.contains(t)?rh.BRT:b.contains(t)?rh.BRL:rh.ALL}if(r.hasFixedTop()){var d=new xs(l.sri,l.eci,l.eri,c),v=new xs(l.eri+1,l.eci+1,i,c);return d.contains(t)?rh.T:v.contains(t)?rh.BR:rh.BRT}if(r.hasFixedLeft()){var g=new xs(l.eri,l.sci,i,l.eci),w=new xs(l.eri+1,l.eci+1,i,c);return g.contains(t)?rh.L:w.contains(t)?rh.BR:rh.BRL}return rh.BR}},{key:"showBBorder",value:function(t,e){switch(t){case rh.LT:this.blt.addClass("show-bottom-border");break;case rh.L:this.bl.addClass("show-bottom-border");break;case rh.T:this.bt.addClass("show-bottom-border");break;case rh.BR:e.bottom&&this.bbr.addClass("show-bottom-border");break;case rh.LTT:this.blt.addClass("show-bottom-border"),this.bt.addClass("show-bottom-border");break;case rh.LTL:e.bottom&&this.bl.addClass("show-bottom-border");break;case rh.BRT:e.bottom&&this.bbr.addClass("show-bottom-border");break;case rh.ALL:case rh.BRL:e.bottom&&(this.bl.addClass("show-bottom-border"),this.bbr.addClass("show-bottom-border"))}}},{key:"showTBorder",value:function(t,e){switch(t){case rh.LT:this.blt.addClass("show-top-border");break;case rh.L:this.bl.addClass("show-top-border");break;case rh.T:this.bt.addClass("show-top-border");break;case rh.BR:e.top&&this.bbr.addClass("show-top-border");break;case rh.LTT:this.blt.addClass("show-top-border"),this.bt.addClass("show-top-border");break;case rh.LTL:this.blt.addClass("show-top-border");break;case rh.BRT:this.bt.addClass("show-top-border");break;case rh.BRL:e.top&&(this.bl.addClass("show-top-border"),this.bbr.addClass("show-top-border"));break;case rh.ALL:this.blt.addClass("show-top-border"),this.bt.addClass("show-top-border")}}},{key:"showLBorder",value:function(t,e){switch(t){case rh.LT:this.blt.addClass("show-left-border");break;case rh.L:this.bl.addClass("show-left-border");break;case rh.T:e.left&&this.bt.addClass("show-left-border");break;case rh.BR:e.left&&this.bbr.addClass("show-left-border");break;case rh.LTT:this.blt.addClass("show-left-border");break;case rh.LTL:this.blt.addClass("show-left-border"),this.bl.addClass("show-left-border");break;case rh.BRT:e.left&&(this.bt.addClass("show-left-border"),this.bbr.addClass("show-left-border"));break;case rh.BRL:this.bl.addClass("show-left-border");break;case rh.ALL:this.blt.addClass("show-left-border"),this.bl.addClass("show-left-border")}}},{key:"showRBorder",value:function(t,e){switch(t){case rh.LT:this.blt.addClass("show-right-border");break;case rh.L:this.bl.addClass("show-right-border");break;case rh.T:e.right&&this.bt.addClass("show-right-border");break;case rh.BR:e.right&&this.bbr.addClass("show-right-border");break;case rh.LTT:e.right&&this.bt.addClass("show-right-border");break;case rh.LTL:this.blt.addClass("show-right-border"),this.bl.addClass("show-right-border");break;case rh.BRT:e.right&&(this.bt.addClass("show-right-border"),this.bbr.addClass("show-right-border"));break;case rh.BRL:e.right&&this.bbr.addClass("show-right-border");break;case rh.ALL:e.right&&(this.bt.addClass("show-right-border"),this.bbr.addClass("show-right-border"))}}}]),e}(Kf));function ch(t){return(ch="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lh(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function uh(t,e){return!e||"object"!==ch(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ah(t){return(ah=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sh(t,e){return(sh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fh=function(t){function e(t){var n,o=t.table;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=uh(this,ah(e).call(this,{table:o},"".concat(r,"-part-border-css")))).type="solid",n.color="#42a642",n.setBorderType(n.type),n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sh(t,e)}(e,t),n=e,(o=[{key:"setBorderType",value:function(t){this.type=t,this.blt.addClass(t),this.bl.addClass(t),this.bt.addClass(t),this.bbr.addClass(t)}},{key:"setBorderColor",value:function(t){this.color=t,this.blt.css("border-color",t),this.bl.css("border-color",t),this.bt.css("border-color",t),this.bbr.css("border-color",t)}}])&&lh(n.prototype,o),i&&lh(n,i),e}(ih),hh=n(0),ph=n.n(hh),yh=n(1),bh=n.n(yh),dh=n(2),vh=n.n(dh);function gh(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var wh=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.flag=null,this.table=e}var e,n,o;return e=t,(n=[{key:"lock",value:function(t){return null===this.flag&&(this.flag=t),this}},{key:"set",value:function(t,e){if(null===this.flag||this.flag===e){var n=this.table;switch(t){case"s-resize":return void n.css("cursor","url(".concat(bh.a,") 2.5 7.5,auto"));case"cell":return void n.css("cursor","url(".concat(ph.a,") 7.5 7.5,auto"));case"e-resize":return void n.css("cursor","url(".concat(vh.a,") 7.5 2.5,auto"))}n.css("cursor",t)}}},{key:"free",value:function(t){return this.flag===t&&(this.flag=null,!0)}}])&&gh(e.prototype,n),o&&gh(e,o),t}();function mh(t){return(mh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oh(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Eh(t,e){return!e||"object"!==mh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sh(t,e,n){return(Sh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_h(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function _h(t){return(_h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Th(t,e){return(Th=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}wh.KEYS={cell:"cell",crosshair:"crosshair",eResize:"e-resize",sResize:"s-resize",grab:"-webkit-grab",default:"default",rowResize:"row-resize",colResize:"col-resize",pointer:"pointer"};var xh={LT:Symbol("LT"),L:Symbol("L"),T:Symbol("T"),BR:Symbol("BR")},kh=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Eh(this,_h(e).call(this,{table:t}))).selectLocal=xh.BR,n.display=!1,n.border={},n.activeCorner=null,n.selectRange=null,n.downRange=null,n.moveRange=null,n.ltElem=new B("".concat(r,"-x-select-area")),n.brElem=new B("".concat(r,"-x-select-area")),n.lElem=new B("".concat(r,"-x-select-area")),n.tElem=new B("".concat(r,"-x-select-area")),n.ltHighLight=new B("".concat(r,"-x-select-high-light")),n.lHighLight=new B("".concat(r,"-x-select-high-light")),n.tHighLight=new B("".concat(r,"-x-select-high-light")),n.brHighLight=new B("".concat(r,"-x-select-high-light")),n.ltCorner=new B("".concat(r,"-x-select-corner")),n.lCorner=new B("".concat(r,"-x-select-corner")),n.tCorner=new B("".concat(r,"-x-select-corner")),n.brCorner=new B("".concat(r,"-x-select-corner")),n.blt.before(n.ltElem),n.bl.before(n.lElem),n.bt.before(n.tElem),n.bbr.before(n.brElem),n.blt.before(n.ltHighLight),n.bl.before(n.lHighLight),n.bt.before(n.tHighLight),n.bbr.before(n.brHighLight),n.blt.after(n.ltCorner),n.bl.after(n.lCorner),n.bt.after(n.tCorner),n.bbr.after(n.brCorner),n.setBorderType("solid"),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Th(t,e)}(e,t),n=e,(i=[{key:"moveHandle",value:function(t,e){var n=this.table,o=n.rows,r=n.cols,i=this.downRange,c=this.selectLocal,l=n.getTableMerges(),u=n.getScrollView(),a=n.getRiCiByXy(t,e),s=a.ri,f=a.ci;if(-1===s&&(s=u.sri),-1===f&&(f=u.sci),c===xh.LT){var h=i.union(new xs(0,0,o.len-1,r.len-1));return this.moveRange=i.union(h),this.selectRange=this.moveRange,void(this.selectLocal=xh.LT)}if(c===xh.L){var p=i.union(new xs(s,0,s,0));return this.moveRange=i.union(p),this.selectRange=this.moveRange,void(this.selectLocal=xh.L)}if(c===xh.T){var y=i.union(new xs(0,f,0,f));return this.moveRange=i.union(y),this.selectRange=this.moveRange,void(this.selectLocal=xh.T)}var b=i.union(new xs(s,f,s,f));this.moveRange=l.union(b),this.selectRange=this.moveRange,this.selectLocal=xh.BR}},{key:"setRange",value:function(t){this.selectRange=t,this.selectLocal=xh.BR,this.offsetHandle(),this.borderHandle(),this.cornerHandle()}},{key:"downHandle",value:function(t,e){var n=this.table,o=n.rows,r=n.cols,i=n.getTableMerges(),c=n.getRiCiByXy(t,e),l=c.ri,u=c.ci;return-1===l&&-1===u?(this.downRange=new xs(0,0,o.len-1,r.len-1),this.selectRange=this.downRange,void(this.selectLocal=xh.LT)):-1===l?(this.downRange=new xs(0,u,o.len-1,u),this.selectRange=this.downRange,void(this.selectLocal=xh.T)):-1===u?(this.downRange=new xs(l,0,l,r.len-1),this.selectRange=this.downRange,void(this.selectLocal=xh.L)):(this.downRange=i.getFirstIncludes(l,u)||new xs(l,u,l,u),this.selectRange=this.downRange,void(this.selectLocal=xh.BR))}},{key:"onAdd",value:function(){var t=this.table;this.bind(),this.hide(),t.focus.register({target:this.ltCorner}),t.focus.register({target:this.lCorner}),t.focus.register({target:this.tCorner}),t.focus.register({target:this.brCorner})}},{key:"unbind",value:function(){var t=this.table;L.unbind(t)}},{key:"bind",value:function(){var t=this,n=this.table,r=n.mousePointer,i=n.focus;L.bind(n,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.offsetHandle(),t.borderHandle(),t.cornerHandle()})),L.bind(n,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.offsetHandle(),t.borderHandle(),t.cornerHandle()})),L.bind(n,o.TABLE_EVENT_TYPE.SCALE_CHANGE,(function(){t.offsetHandle(),t.borderHandle(),t.cornerHandle()})),L.bind(n,o.TABLE_EVENT_TYPE.FIXED_CHANGE,(function(){t.offsetHandle(),t.borderHandle(),t.cornerHandle()})),L.bind(n,o.TABLE_EVENT_TYPE.RESIZE_CHANGE,(function(){t.offsetHandle(),t.borderHandle(),t.cornerHandle()})),L.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(c){if(0===c.button&&i.activate.target===n){var l=n.eventXy(c),u=l.x,a=l.y;t.downHandle(u,a),t.offsetHandle(),t.borderHandle(),t.cornerHandle();var s=t.selectLocal;switch(s){case xh.L:r.lock(e),r.set(wh.KEYS.eResize,e);break;case xh.T:r.lock(e),r.set(wh.KEYS.sResize,e)}n.trigger(o.TABLE_EVENT_TYPE.SELECT_DOWN),n.trigger(o.TABLE_EVENT_TYPE.SELECT_CHANGE),L.mouseMoveUp(document,(function(e){var r=n.eventXy(e),i=r.x,c=r.y;t.moveHandle(i,c),t.offsetHandle(),t.borderHandle(),t.cornerHandle(),n.trigger(o.TABLE_EVENT_TYPE.SELECT_CHANGE)}),(function(){switch(s){case xh.L:case xh.T:r.free(e)}n.trigger(o.TABLE_EVENT_TYPE.SELECT_OVER)}))}})),L.bind(n,o.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.offsetHandle(),t.borderHandle(),t.cornerHandle()}))}},{key:"borderHandle",value:function(){var t=this.selectRange,e=this.display;t&&e&&(this.hideBorder(),this.border=this.showBorder(t))}},{key:"offsetHandle",value:function(){var t=this.selectRange;t&&this.setDisplay(t)?(this.display=!0,this.setSizer(t),this.setLocal(t)):this.display=!1}},{key:"cornerHandle",value:function(){var t=this.selectRange,e=this.selectLocal,n=this.display,o=this.border;if(t&&n){var r=this.getOverGo(t);switch(this.ltCorner.hide(),this.tCorner.hide(),this.lCorner.hide(),this.brCorner.hide(),e){case xh.LT:case xh.L:case xh.BR:if(!1===o.bottom)return}switch(this.brCorner.removeClass("br-pos"),this.lCorner.removeClass("br-pos"),this.tCorner.removeClass("br-pos"),this.ltCorner.removeClass("br-pos"),this.brCorner.removeClass("tr-pos"),this.lCorner.removeClass("tr-pos"),this.tCorner.removeClass("tr-pos"),this.ltCorner.removeClass("tr-pos"),this.brCorner.removeClass("bl-pos"),this.lCorner.removeClass("bl-pos"),this.tCorner.removeClass("bl-pos"),this.ltCorner.removeClass("bl-pos"),e){case xh.L:this.brCorner.addClass("bl-pos"),this.lCorner.addClass("bl-pos"),this.tCorner.addClass("bl-pos"),this.ltCorner.addClass("bl-pos");break;case xh.T:this.brCorner.addClass("tr-pos"),this.lCorner.addClass("tr-pos"),this.tCorner.addClass("tr-pos"),this.ltCorner.addClass("tr-pos");break;case xh.LT:case xh.BR:this.brCorner.addClass("br-pos"),this.lCorner.addClass("br-pos"),this.tCorner.addClass("br-pos"),this.ltCorner.addClass("br-pos")}switch(r){case rh.LT:this.ltCorner.show(),this.tCorner.hide(),this.brCorner.hide(),this.lCorner.hide(),this.activeCorner=this.ltCorner;break;case rh.LTT:case rh.T:this.ltCorner.hide(),this.tCorner.show(),this.brCorner.hide(),this.lCorner.hide(),this.activeCorner=this.tCorner;break;case rh.ALL:case rh.BRL:case rh.BRT:case rh.BR:this.ltCorner.hide(),this.tCorner.hide(),this.brCorner.show(),this.lCorner.hide(),this.activeCorner=this.brCorner;break;case rh.LTL:case rh.L:this.ltCorner.hide(),this.tCorner.hide(),this.brCorner.hide(),this.lCorner.show(),this.activeCorner=this.lCorner}}}},{key:"destroy",value:function(){Sh(_h(e.prototype),"destroy",this).call(this),this.unbind()}}])&&Oh(n.prototype,i),c&&Oh(n,c),e}(fh);function Ph(t){return(Ph="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jh(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ch(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Rh(t,e,n){return(Rh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Lh(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Lh(t){return(Lh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ah(t,e){return(Ah=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nh=function(t){function e(t){var n,o,i,c=t.title,l=void 0===c?"提示":c,u=t.message,a=void 0===u?"":u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(i=Lh(e).call(this,"".concat(r,"-alert")))||"object"!==Ph(i)&&"function"!=typeof i?Ch(o):i).closeEle=k("div","".concat(r,"-alert-close")),n.titleEle=k("div","".concat(r,"-alert-title")),n.contentEle=k("div","".concat(r,"-alert-content")),n.okEle=k("div","".concat(r,"-alert-ok")),n.buttonsEle=k("div","".concat(r,"-alert-buttons")),n.titleEle.html(l),n.contentEle.html(a),n.okEle.html("确定"),n.buttonsEle.children(n.okEle),n.children(n.closeEle),n.children(n.titleEle),n.children(n.contentEle),n.children(n.buttonsEle),n.dragPanel=(new co).children(Ch(n)),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ah(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){var t=this.okEle;L.unbind(t)}},{key:"bind",value:function(){var t=this,e=this.okEle;L.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.close()}))}},{key:"open",value:function(){this.dragPanel.open(),this.bind()}},{key:"close",value:function(){this.dragPanel.close(),this.destroy()}},{key:"destroy",value:function(){Rh(Lh(e.prototype),"destroy",this).call(this),this.unbind(),this.dragPanel.destroy()}}])&&jh(n.prototype,i),c&&jh(n,c),e}(B),Ih=n(3),Vh=n.n(Ih);function Dh(t){return(Dh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mh(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Hh(t,e){return!e||"object"!==Dh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fh(t){return(Fh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bh(t,e){return(Bh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wh=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Hh(this,Fh(e).call(this,"".concat(r,"-mask")))).root=k(document.body),t.status=!1,t.css("position","absolute"),t.css("background","rgba(0,0,0,0.3)"),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bh(t,e)}(e,t),n=e,(o=[{key:"setLeft",value:function(t){return this.offset({left:t}),this}},{key:"setTop",value:function(t){return this.offset({top:t}),this}},{key:"setHeight",value:function(t){return this.offset({height:t}),this}},{key:"setWidth",value:function(t){return this.offset({width:t}),this}},{key:"setOpacity",value:function(t){return this.css("opacity",t),this}},{key:"open",value:function(){return!1===this.status&&(this.root.children(this),this.status=!0),this}},{key:"close",value:function(){return!0===this.status&&(this.root.remove(this),this.status=!1),this}},{key:"setRoot",value:function(t){return t=t.el?k(t.el):k(t),this.root=t,this}}])&&Mh(n.prototype,o),i&&Mh(n,i),e}(B);function Yh(t){return(Yh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uh(t,e){return!e||"object"!==Yh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zh(t){return(zh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gh(t,e){return(Gh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xh=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Uh(this,zh(e).call(this,"".concat(r,"-filter-data-menu-item ").concat(r,"-order-az")))).titleElement=k("div","".concat(r,"-filter-data-menu-item-title")),t.titleElement.text("以A->Z的顺序排序"),t.children(t.titleElement),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gh(t,e)}(e,t),e}(le);function Zh(t){return(Zh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kh(t,e){return!e||"object"!==Zh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $h(t){return($h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qh(t,e){return(qh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qh=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Kh(this,$h(e).call(this,"".concat(r,"-filter-data-menu-item ").concat(r,"-order-za")))).titleElement=k("div","".concat(r,"-filter-data-menu-item-title")),t.titleElement.text("以Z->A的顺序排序"),t.children(t.titleElement),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qh(t,e)}(e,t),e}(le);function Jh(t){return(Jh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tp(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ep(t,e){return!e||"object"!==Jh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function np(t,e,n){return(np="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=op(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function op(t){return(op=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rp(t,e){return(rp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ip=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ep(this,op(e).call(this,"".concat(r,"-form-select-menu"),S.mergeDeep({autoHeight:!0,onUpdate:function(){}},t)))).items=[],n.elPopUp.offset({width:200}),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rp(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){this.items.forEach((function(t){L.unbind(t)}))}},{key:"bind",value:function(t){var e=this;L.bind(t,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){e.options.onUpdate(t),e.close()}))}},{key:"addItem",value:function(t){this.bind(t),this.items.push(t),this.children(t)}},{key:"destroy",value:function(){np(op(e.prototype),"destroy",this).call(this),this.unbind()}}])&&tp(n.prototype,i),c&&tp(n,c),e}(ne);function cp(t){return(cp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lp(t,e){return!e||"object"!==cp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function up(t){return(up=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ap(t,e){return(ap=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sp=function(t){function e(t){var n,o=t.text,i=void 0===o?"":o,c=t.value,l=void 0===c?"":c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=lp(this,up(e).call(this,"".concat(r,"-form-select-menu-item")))).value=l,n.text=i,n.textEle=k("div","".concat(r,"-form-select-menu-item-title")),n.textEle.text(i),n.children(n.textEle),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ap(t,e)}(e,t),e}(le);function fp(t){return(fp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hp(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function pp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yp(t,e,n){return(yp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=bp(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function bp(t){return(bp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dp(t,e){return(dp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vp=function(t){function e(){var t,n,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,o=bp(e).call(this,"".concat(r,"-form-select")),(t=!o||"object"!==fp(o)&&"function"!=typeof o?pp(n):o).selectValue=S.Nul,t.selectText=k("div","".concat(r,"-form-select-text")),t.selectIcon=k("div","".concat(r,"-form-select-icon")),t.children(t.selectText),t.children(t.selectIcon),t.contextMenu=new ip({el:pp(t),onUpdate:function(e){var n=e.value;t.setSelect(n)}}),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dp(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){L.unbind(this)}},{key:"bind",value:function(){var t=this;L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.contextMenu.isClose()?t.contextMenu.open():t.contextMenu.close(),e.stopPropagation()}))}},{key:"getValue",value:function(){return this.selectValue}},{key:"setSelect",value:function(t){var e=this.contextMenu,n=this.selectText,r=e.items.find((function(e){return e.value&&e.value===t}));r&&(n.html("&nbsp;".concat(r.text)),this.selectValue=r.value,this.trigger(o.FORM_EVENT_TYPE.FORM_SELECT_CHANGE,{item:r}))}},{key:"addValue",value:function(t){var e=t.text,n=t.value,o=new sp({text:e,value:n});this.contextMenu.addItem(o)}},{key:"addDivider",value:function(){var t=new we;this.contextMenu.addItem(t)}},{key:"destroy",value:function(){yp(bp(e.prototype),"destroy",this).call(this),this.unbind(),this.contextMenu.close(),this.contextMenu.destroy()}}])&&hp(n.prototype,i),c&&hp(n,c),e}(B);function gp(t){return(gp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wp(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function mp(t,e){return!e||"object"!==gp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Op(t,e,n){return(Op="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ep(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Ep(t){return(Ep=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sp(t,e){return(Sp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _p=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=mp(this,Ep(e).call(this,"".concat(r,"-form-plain-input")))).inputWrapEle=k("div","".concat(r,"-form-input-wrap")),t.inputInnerEle=k("div","".concat(r,"-form-input-inner")),t.inputEle=k("input","".concat(r,"-form-input-source")),t.inputInnerEle.children(t.inputEle),t.inputWrapEle.children(t.inputInnerEle),t.children(t.inputWrapEle),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sp(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){var t=this.inputEle;L.unbind(t)}},{key:"bind",value:function(){var t=this,e=this.inputEle;L.bind(e,o.SYSTEM_EVENT_TYPE.CHANGE,(function(){t.setValue(e.val())}))}},{key:"setValue",value:function(t){this.inputEle.val(t),this.trigger(o.FORM_EVENT_TYPE.PLAIN_INPUT_CHANGE,{value:this.inputEle.val()})}},{key:"getValue",value:function(){return this.inputEle.val()}},{key:"destroy",value:function(){Op(Ep(e.prototype),"destroy",this).call(this),this.unbind()}}])&&wp(n.prototype,i),c&&wp(n,c),e}(B);function Tp(t){return(Tp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xp(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function kp(t,e){return!e||"object"!==Tp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pp(t,e,n){return(Pp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=jp(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function jp(t){return(jp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cp(t,e){return(Cp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rp=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=kp(this,jp(e).call(this,"".concat(r,"-filter-data-menu-item ").concat(r,"-if-filter")))).status=!1,t.type=e.IF_TYPE.NOT,t.value=S.EMPTY,t.titleEle=k("div","".concat(r,"-if-filter-title")),t.titleTextEle=k("span","".concat(r,"-if-filter-title-text")),t.titleIconEle=k("span","".concat(r,"-if-filter-title-icon")),t.titleTextEle.text("条件过滤"),t.titleEle.children(t.titleIconEle),t.titleEle.children(t.titleTextEle),t.children(t.titleEle),t.selectEleBox=k("div","".concat(r,"-if-filter-select-box")),t.selectEle=new vp,t.selectEleBox.children(t.selectEle),t.children(t.selectEleBox),t.valueInputEleBox=k("div","".concat(r,"-if-filter-value-input-box")),t.valueInput=new _p,t.valueInputEleBox.children(t.valueInput),t.children(t.valueInputEleBox),t.selectEle.addValue({text:"无",value:e.IF_TYPE.NOT}),t.selectEle.addDivider(),t.selectEle.addValue({text:"为空",value:e.IF_TYPE.CT_EMPTY}),t.selectEle.addValue({text:"不为空",value:e.IF_TYPE.CT_NOT_EMPTY}),t.selectEle.addDivider(),t.selectEle.addValue({text:"文本包含",value:e.IF_TYPE.STR_INCLUDE}),t.selectEle.addValue({text:"文本不包含",value:e.IF_TYPE.STR_NOT_INCLUDE}),t.selectEle.addValue({text:"文本开头",value:e.IF_TYPE.STR_START}),t.selectEle.addValue({text:"文本结尾",value:e.IF_TYPE.STR_END}),t.selectEle.addValue({text:"文本相符",value:e.IF_TYPE.STR_EQ}),t.selectEle.addDivider(),t.selectEle.addValue({text:"日期为",value:e.IF_TYPE.DAT_EQ}),t.selectEle.addValue({text:"日期超前",value:e.IF_TYPE.DAT_BEFORE}),t.selectEle.addValue({text:"日期滞后",value:e.IF_TYPE.DAT_AFTER}),t.selectEle.addDivider(),t.selectEle.addValue({text:"数字大于",value:e.IF_TYPE.NUM_BEFORE}),t.selectEle.addValue({text:"数字大于等于",value:e.IF_TYPE.NUM_BEFORE_EQ}),t.selectEle.addValue({text:"数字小于",value:e.IF_TYPE.NUM_AFTER}),t.selectEle.addValue({text:"数字小于等于",value:e.IF_TYPE.NUM_AFTER_EQ}),t.selectEle.addValue({text:"数字等于",value:e.IF_TYPE.NUM_EQ}),t.selectEle.addValue({text:"数字不等于",value:e.IF_TYPE.NUM_NOT_EQ}),t.removeClass("hover"),t.bind(),t.hide(),t.selectEle.setSelect(e.IF_TYPE.NOT),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cp(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){var t=this.titleEle,e=this.selectEle;L.unbind(t),L.unbind(e)}},{key:"bind",value:function(){var t=this,e=this.titleEle,n=this.selectEle,r=this.valueInput;L.bind(n,o.FORM_EVENT_TYPE.FORM_SELECT_CHANGE,(function(e){var n=e.detail.item.value;t.type=n,t.switchInput()})),L.bind(r,o.FORM_EVENT_TYPE.PLAIN_INPUT_CHANGE,(function(e){var n=e.detail.value;t.value=n})),L.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.status?t.hide():t.show()}))}},{key:"setValue",value:function(t){S.isBlank(t)&&(t=S.EMPTY),this.valueInput.setValue(t)}},{key:"setType",value:function(t){S.isBlank(t)&&(t=e.IF_TYPE.NOT),this.selectEle.setSelect(t)}},{key:"switchInput",value:function(){var t=this.type,n=this.valueInputEleBox;switch(n.hide(),t){case e.IF_TYPE.STR_NOT_INCLUDE:case e.IF_TYPE.STR_INCLUDE:case e.IF_TYPE.STR_EQ:case e.IF_TYPE.STR_START:case e.IF_TYPE.STR_END:case e.IF_TYPE.DAT_EQ:case e.IF_TYPE.DAT_BEFORE:case e.IF_TYPE.DAT_AFTER:case e.IF_TYPE.NUM_BEFORE:case e.IF_TYPE.NUM_BEFORE_EQ:case e.IF_TYPE.NUM_AFTER:case e.IF_TYPE.NUM_AFTER_EQ:case e.IF_TYPE.NUM_EQ:case e.IF_TYPE.NUM_NOT_EQ:n.show();break;default:n.hide()}}},{key:"getType",value:function(){return this.type}},{key:"getValue",value:function(){return this.value}},{key:"show",value:function(){var t=this.type;return this.titleIconEle.addClass("active"),this.status=!0,this.selectEleBox.show(),this.setType(t),this}},{key:"hide",value:function(){return this.titleIconEle.removeClass("active"),this.status=!1,this.selectEleBox.hide(),this.valueInputEleBox.hide(),this}},{key:"destroy",value:function(){Pp(jp(e.prototype),"destroy",this).call(this),this.unbind(),this.selectEle.destroy()}}])&&xp(n.prototype,i),c&&xp(n,c),e}(le);function Lp(t){return(Lp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ap(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Np(t,e){return!e||"object"!==Lp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ip(t,e,n){return(Ip="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Vp(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Vp(t){return(Vp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dp(t,e){return(Dp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Rp.IF_TYPE={NOT:1,CT_NOT_EMPTY:2,CT_EMPTY:3,STR_NOT_INCLUDE:4,STR_INCLUDE:5,STR_EQ:6,STR_START:7,STR_END:8,DAT_EQ:9,DAT_BEFORE:10,DAT_AFTER:11,NUM_BEFORE:12,NUM_BEFORE_EQ:13,NUM_AFTER:14,NUM_AFTER_EQ:15,NUM_EQ:16,NUM_NOT_EQ:17};var Mp=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Np(this,Vp(e).call(this,"".concat(r,"-form-search-input")))).inputWrapEle=k("div","".concat(r,"-form-input-wrap")),t.inputInnerEle=k("div","".concat(r,"-form-input-inner")),t.inputEle=k("input","".concat(r,"-form-input-source")),t.searchEle=k("div","".concat(r,"-form-input-search")),t.inputInnerEle.children(t.inputEle),t.inputWrapEle.children(t.inputInnerEle),t.children(t.inputWrapEle),t.children(t.searchEle),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dp(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){var t=this.searchEle,e=this.inputEle;L.unbind(t),L.unbind(e)}},{key:"bind",value:function(){var t=this,e=this.searchEle,n=this.inputEle;L.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.setValue(n.val())})),L.bind(n,o.SYSTEM_EVENT_TYPE.INPUT,(function(){t.setValue(n.val())}))}},{key:"getValue",value:function(){return this.inputEle.val()}},{key:"setValue",value:function(t){var e=this.inputEle;e.val(t),this.trigger(o.FORM_EVENT_TYPE.SEARCH_INPUT_CHANGE,{value:e.val()})}},{key:"destroy",value:function(){Ip(Vp(e.prototype),"destroy",this).call(this),this.unbind()}}])&&Ap(n.prototype,i),c&&Ap(n,c),e}(B);function Hp(t){return(Hp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fp(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Bp(t,e){return!e||"object"!==Hp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wp(t,e,n){return(Wp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Yp(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Yp(t){return(Yp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Up(t,e){return(Up=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zp=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Bp(this,Yp(e).call(this,"".concat(r,"-filter-data-menu-item ").concat(r,"-value-filter")))).filterExp=null,t.items=[],t.filters=[],t.status=!0,t.value=S.EMPTY,t.titleEle=k("div","".concat(r,"-value-filter-title")),t.titleTextEle=k("span","".concat(r,"-value-filter-title-text")),t.titleIconEle=k("span","".concat(r,"-value-filter-title-icon")),t.titleTextEle.text("按值过滤"),t.titleEle.children(t.titleIconEle),t.titleEle.children(t.titleTextEle),t.children(t.titleEle),t.optionBoxEle=k("div","".concat(r,"-value-filter-option-box")),t.selectEle=k("div","".concat(r,"-value-filter-option-select")),t.flagEle=k("div","".concat(r,"-value-filter-option-flag")),t.clearEle=k("div","".concat(r,"-value-filter-option-clear")),t.clearEle.text("清空"),t.flagEle.html("&nbsp;-&nbsp;"),t.selectEle.text("全选"),t.optionBoxEle.children(t.selectEle),t.optionBoxEle.children(t.flagEle),t.optionBoxEle.children(t.clearEle),t.children(t.optionBoxEle),t.searchBoxEle=k("div","".concat(r,"-value-filter-input-box")),t.searchInput=new Mp,t.searchBoxEle.children(t.searchInput),t.children(t.searchBoxEle),t.itemsBox=k("div","".concat(r,"-value-filter-items-box")),t.children(t.itemsBox),t.hide(),t.bind(),t.removeClass("hover"),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Up(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){var t=this.titleEle,e=this.selectEle,n=this.clearEle,o=this.searchInput;L.unbind(n),L.unbind(t),L.unbind(e),L.unbind(o)}},{key:"bind",value:function(){var t=this,e=this.titleEle,n=this.itemsBox,i=this.selectEle,c=this.clearEle,l=this.searchInput,u="".concat(r,"-value-filter-item");L.bind(i,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.selectAll()})),L.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.status?t.hide():t.show()})),L.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.items,o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div";return new B(t,e)}(e.target).closestClass(u);if(o){var i=n[o.attr("".concat(r,"-value-filter-item-index"))];i.setStatus(!i.status)}})),L.bind(c,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.clearAll()})),L.bind(l,o.FORM_EVENT_TYPE.SEARCH_INPUT_CHANGE,(function(e){var n=e.detail.value;S.isBlank(n)?t.filterExp=null:t.filterExp=new RegExp(".?".concat(n,".?")),t.value=n,t.filterItems()}))}},{key:"addItem",value:function(t){t.setIndex(this.items.length),this.items.push(t),this.itemsBox.children(t)}},{key:"filterItems",value:function(){var t=this.filterExp,e=this.items,n=this.itemsBox,o=[];n.empty(),t?(e.forEach((function(e){var n=e.text;t.test(n)&&o.push(e)})),o.forEach((function(t){n.children(t)}))):e.forEach((function(t){n.children(t)})),this.filters=o}},{key:"setValue",value:function(t){var e=this.searchInput;S.isBlank(t)&&(t=S.EMPTY),e.setValue(t)}},{key:"getValue",value:function(){return this.value}},{key:"getSelectItems",value:function(){var t=this.items,e=this.filters,n=[];return e.length>0?e.forEach((function(t){t.status&&n.push(t)})):t.forEach((function(t){t.status&&n.push(t)})),n}},{key:"show",value:function(){return this.titleIconEle.addClass("active"),this.status=!0,this.optionBoxEle.show(),this.searchBoxEle.show(),this.itemsBox.show(),this}},{key:"hide",value:function(){return this.titleIconEle.removeClass("active"),this.status=!1,this.optionBoxEle.hide(),this.searchBoxEle.hide(),this.itemsBox.hide(),this}},{key:"selectAll",value:function(){this.items.forEach((function(t){t.setStatus(!0)}))}},{key:"clearAll",value:function(){this.items.forEach((function(t){t.setStatus(!1)}))}},{key:"emptyAll",value:function(){this.itemsBox.empty(),this.items=[]}},{key:"destroy",value:function(){Wp(Yp(e.prototype),"destroy",this).call(this),this.unbind(),this.searchInput.destroy()}}])&&Fp(n.prototype,i),c&&Fp(n,c),e}(le);function Gp(t){return(Gp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xp(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Zp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Kp(t,e,n){return(Kp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$p(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function $p(t){return($p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qp(t,e){return(qp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qp=function(t){function e(t){var n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,i=$p(e).call(this,"".concat(r,"-filter-data-menu"),S.mergeDeep({ok:function(){},no:function(){}},t)),(n=!i||"object"!==Gp(i)&&"function"!=typeof i?Zp(o):i).valueFilter=new zp,n.ifFilter=new Rp,n.orderAz=new Xh,n.orderZa=new Qh,n.okEle=k("div","".concat(r,"-filter-data-menu-button ").concat(r,"-filter-data-menu-ok")),n.noEle=k("div","".concat(r,"-filter-data-menu-button ").concat(r,"-filter-data-menu-no")),n.children(n.orderAz),n.children(n.orderZa),n.children(new we),n.children(n.ifFilter),n.children(n.valueFilter),n.children(new we),n.children(n.noEle),n.children(n.okEle),n.okEle.html("确定"),n.noEle.html("取消"),n.okHandle=function(){var t=Zp(n),e=t.ifFilter,o=t.valueFilter,r=o.getSelectItems(),i=o.getValue(),c=e.getType(),l=e.getValue();n.options.ok({valueFilterItems:r,valueFilterValue:i,ifFilterType:c,ifFilterValue:l}),n.close()},n.noHandle=function(){n.options.no(),n.close()},n.filterDataHandle=function(){Kt.closeAll([n.elPopUp])},n.bind(),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qp(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){L.unbind(this.okEle),L.unbind(this.noEle)}},{key:"bind",value:function(){L.bind(this.okEle,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,this.okHandle),L.bind(this.noEle,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,this.noHandle),L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,this.filterDataHandle)}},{key:"open",value:function(){Kp($p(e.prototype),"open",this).call(this)}},{key:"destroy",value:function(){Kp($p(e.prototype),"destroy",this).call(this),this.unbind(),this.valueFilter.destroy(),this.ifFilter.destroy()}}])&&Xp(n.prototype,i),c&&Xp(n,c),e}(ne);function Jp(t){return(Jp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ty(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ey(t,e){return!e||"object"!==Jp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ny(t){return(ny=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oy(t,e){return(oy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ry=function(t){function e(t){var n,o=t.text,i=void 0===o?S.EMPTY:o,c=t.index,l=void 0===c?-1:c,u=t.status,a=void 0!==u&&u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ey(this,ny(e).call(this,"".concat(r,"-value-filter-item")))).text=i,n.status=a,n.index=l,n.iconEle=k("div","".concat(r,"-value-filter-item-icon")),n.textEle=k("div","".concat(r,"-value-filter-item-text")),n.textEle.text(i),n.attr("title",i),n.children(n.iconEle),n.children(n.textEle),n.setIndex(l),n.setStatus(a),n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oy(t,e)}(e,t),n=e,(o=[{key:"setStatus",value:function(t){this.status=t,this.status?this.iconEle.css("opacity",1):this.iconEle.css("opacity",0)}},{key:"setIndex",value:function(t){this.index=t,this.attr("".concat(r,"-value-filter-item-index"),"".concat(this.index))}},{key:"equals",value:function(t){return this.text===t.text}}])&&ty(n.prototype,o),i&&ty(n,i),e}(B);function iy(t){return(iy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cy(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ly(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function uy(t,e,n){return(uy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ay(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function ay(t){return(ay=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sy(t,e){return(sy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fy=function(t){function e(t){var n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,i=ay(e).call(this,{table:t}),(n=!i||"object"!==iy(i)&&"function"!=typeof i?ly(o):i).selectRange=null,n.activeIcon=null,n.icons=[],n.display=!1,n.mask=(new Wh).setRoot(t),n.filter=new Qp({el:n.mask,ok:function(t){var e=t.valueFilterItems,o=t.valueFilterValue,r=t.ifFilterType,i=t.ifFilterValue,c=ly(n).activeIcon;c.valueFilterItems=e,c.valueFilterValue=o,c.ifFilterType=r,c.ifFilterValue=i}}),n.flt=new B("".concat(r,"-x-filter ").concat(r,"-x-filter-lt")),n.ft=new B("".concat(r,"-x-filter ").concat(r,"-x-filter-t")),n.fbr=new B("".concat(r,"-x-filter ").concat(r,"-x-filter-br")),n.fl=new B("".concat(r,"-x-filter ").concat(r,"-x-filter-l")),n.blt.children(n.flt),n.bl.children(n.fl),n.bt.children(n.ft),n.bbr.children(n.fbr),n.setBorderColor("#0071cf"),n.bind(),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sy(t,e)}(e,t),n=e,(i=[{key:"onAdd",value:function(){uy(ay(e.prototype),"onAdd",this).call(this)}},{key:"unbind",value:function(){var t=this.table;L.unbind(t)}},{key:"bind",value:function(){var t=this,e=this.table;L.bind(e,o.TABLE_EVENT_TYPE.RESIZE_CHANGE,(function(){t.display&&t.xFilterOffset()})),L.bind(e,o.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.display&&(Kt.closeAll(),t.xFilterOffset())})),L.bind(e,o.TABLE_EVENT_TYPE.RENDER,(function(){t.display&&t.xFilterOffset()}))}},{key:"createFilterIcon",value:function(){var t=this,n=this.table,o=this.selectRange,r=this.icons;if(o){var i=o.brink().top,c=n.xIconBuilder,l=n.getXTableStyle().fixedCellIcon,u=n.mousePointer;i.each((function(n,o){var i=c.build({image:Vh.a,offset:{x:-2,y:-2},height:18,width:18,vertical:Ma.ICON_VERTICAL.BOTTOM}),a={ri:n,ci:o,icon:i};i.setOnDown((function(e){var n=e.native;t.activeIcon=a,t.filterOpen(),n.stopPropagation()})),i.setOnEnter((function(e){var n=e.position,o=hc.styleTransformCssPx(n.height),r=hc.styleTransformCssPx(n.width),i=hc.styleTransformCssPx(n.x),c=hc.styleTransformCssPx(n.y);t.mask.setLeft(i).setTop(c).setWidth(r).setHeight(o).open()})),i.setOnMove((function(){u.set(wh.KEYS.pointer,e)})),i.setOnLeave((function(){t.mask.close(),u.free(e)})),l.addOrNewCell(n,o,i),r.push(a)})),n.render()}}},{key:"clearFilterIcon",value:function(){var t=this.table;if(this.selectRange){var e=t.getXTableStyle().fixedCellIcon;this.icons.forEach((function(t){var n=t.ri,o=t.ci,r=t.icon;e.remove(n,o,r)})),this.icons=[],t.render()}}},{key:"offsetHandle",value:function(){var t=this.selectRange;t&&(this.setDisplay(t),this.setSizer(t),this.setLocal(t))}},{key:"borderHandle",value:function(){var t=this.selectRange,e=this.display;t&&e&&(this.hideBorder(),this.showBorder(t))}},{key:"xFilterHandle",value:function(){var t=this.table,e=t.xScreen,n=t.cols,o=t.rows,r=e.findType(kh).selectRange,i=t.getTableCells(),c=t.getTableMerges();if(r){var l=r.clone(),u=l,a=u.sri,s=u.sci,f=u.eri,h=u.eci,p=o.len-1,y=n.len-1,b=c.getFirstIncludes(a,s)||xs.EMPTY;if(l.multiple()&&!b.equals(l))return void(this.selectRange=l);Ss.getInstance().setBegin(h+1).setEnd(y).setLoop((function(t){var e=i.getCellOrMergeCell(a,t);return!S.isUnDef(e)&&!S.isBlank(e.text)&&(l=l.union(new xs(a,t,a,t)),!0)})).execute(),Ss.getInstance().setBegin(s-1).setEnd(0).setLoop((function(t){var e=i.getCellOrMergeCell(a,t);return!S.isUnDef(e)&&!S.isBlank(e.text)&&(l=l.union(new xs(a,t,a,t)),!0)})).execute(),vs.getInstance().setBegin(f+1).setEnd(p).setLoop((function(t){var e=i.getCellOrMergeCell(t,s);return!S.isUnDef(e)&&!S.isBlank(e.text)&&(l=l.union(new xs(t,s,t,s)),!0)})).execute(),vs.getInstance().setBegin(a-1).setEnd(0).setLoop((function(t){var e=i.getCellOrMergeCell(t,s);return!S.isUnDef(e)&&!S.isBlank(e.text)&&(l=l.union(new xs(t,s,t,s)),!0)})).execute(),Ss.getInstance().setBegin(l.eci+1).setEnd(y).setLoop((function(t){var e=l,n=e.sri,o=e.eri,r=!0;return vs.getInstance().setBegin(n).setEnd(o).setLoop((function(e){var n=i.getCellOrMergeCell(e,t);S.isUnDef(n)||S.isBlank(n.text)||(l=l.union(new xs(e,t,e,t)),r=!1)})).execute(),!r})).execute(),Ss.getInstance().setBegin(l.sci-1).setEnd(0).setLoop((function(t){var e=l,n=e.sri,o=e.eri,r=!0;return vs.getInstance().setBegin(n).setEnd(o).setLoop((function(e){var n=i.getCellOrMergeCell(e,t);S.isUnDef(n)||S.isBlank(n.text)||(l=l.union(new xs(e,t,e,t)),r=!1)})).execute(),!r})).execute(),vs.getInstance().setBegin(l.eri+1).setEnd(p).setLoop((function(t){var e=l,n=e.sci,o=e.eci,r=!0;return Ss.getInstance().setBegin(n).setEnd(o).setLoop((function(e){var n=i.getCellOrMergeCell(t,e);S.isUnDef(n)||S.isBlank(n.text)||(l=l.union(new xs(t,e,t,e)),r=!1)})).execute(),!r})).execute(),vs.getInstance().setBegin(l.sri-1).setEnd(0).setLoop((function(t){var e=l,n=e.sci,o=e.eci,r=!0;return Ss.getInstance().setBegin(n).setEnd(o).setLoop((function(e){var n=i.getCellOrMergeCell(t,e);S.isUnDef(n)||S.isBlank(n.text)||(l=l.union(new xs(t,e,t,e)),r=!1)})).execute(),!r})).execute(),this.selectRange=l}else this.selectRange=null}},{key:"xFilterOffset",value:function(){this.offsetHandle(),this.borderHandle()}},{key:"filterOpen",value:function(){var t=this.selectRange,e=this.table,n=this.filter,o=this.activeIcon,r=n.valueFilter,i=n.ifFilter,c=e.getTableCells(),l=o.valueFilterValue,u=o.ifFilterType,a=o.ifFilterValue,s=o.valueFilterItems,f=o.ri,h=o.ci,p=t.eri,y=h,b=new Set;new xs(f,h,p,y).each((function(t,e){var n=c.getCellOrMergeCell(t,e);n&&!S.isBlank(n.text)&&b.add(n.text.trim())})),r.emptyAll(),s?b.forEach((function(t){var e=new ry({text:t});s.find((function(t){return e.equals(t)}))?e.setStatus(!0):e.setStatus(!1),r.addItem(e)})):b.forEach((function(t){var e=new ry({text:t});e.setStatus(!0),r.addItem(e)})),r.setValue(l),i.setType(u),i.setValue(a),Kt.closeAll(),n.open()}},{key:"hideFilter",value:function(){this.display=!1,this.clearFilterIcon(),this.hide()}},{key:"openFilter",value:function(){var t=this.table.getTableCells();this.xFilterHandle();var e=this.selectRange;e&&(t.emptyRectRange(e)?new Nh({message:"不能为空数据区创建过滤器, 请选择非空区域"}).open():(this.display=!0,this.createFilterIcon(),this.show(),this.xFilterOffset()))}},{key:"destroy",value:function(){uy(ay(e.prototype),"destroy",this).call(this),this.unbind()}}])&&cy(n.prototype,i),c&&cy(n,c),e}(fh);function hy(t){return(hy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function py(t,e){return!e||"object"!==hy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function yy(t){return(yy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function by(t,e){return(by=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dy='\n  <svg class="'.concat(r,'-copy-style-svg" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">\n    <line class="').concat(r,"-copy-style-stroked ").concat(r,'-copy-style-stroked-top" x1="0" y1="0" x2="100%" y2="0"/>\n    <line class="').concat(r,"-copy-style-stroked ").concat(r,'-copy-style-stroked-left" x1="0" y1="0" x2="0" y2="100%"/>\n    <line class="').concat(r,"-copy-style-stroked ").concat(r,'-copy-style-stroked-bottom" x1="0" y1="100%" x2="100%" y2="100%"/>\n    <line class="').concat(r,"-copy-style-stroked ").concat(r,'-copy-style-stroked-right" x1="100%" y1="0" x2="100%" y2="100%"/>\n  </svg>\n');function vy(t){return(vy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gy(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function wy(t,e){return!e||"object"!==vy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function my(t,e,n){return(my="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Oy(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Oy(t){return(Oy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ey(t,e){return(Ey=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Sy=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=wy(this,Oy(e).call(this,{table:t}))).display=!1,n.selectRange=xs.EMPTY,n.ltElem=new B("".concat(r,"-x-copy-style-area")),n.brElem=new B("".concat(r,"-x-copy-style-area")),n.lElem=new B("".concat(r,"-x-copy-style-area")),n.tElem=new B("".concat(r,"-x-copy-style-area")),n.blt.children(n.ltElem),n.bl.children(n.lElem),n.bt.children(n.tElem),n.bbr.children(n.brElem),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ey(t,e)}(e,t),n=e,(i=[{key:"onAdd",value:function(){this.hideCopyStyle(),this.bind()}},{key:"unbind",value:function(){var t=this.table;L.unbind(t)}},{key:"bind",value:function(){var t=this,e=this.table;L.bind(e,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.display&&(t.offsetHandle(),t.borderHandle())})),L.bind(e,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.display&&(t.offsetHandle(),t.borderHandle())})),L.bind(e,o.TABLE_EVENT_TYPE.SCALE_CHANGE,(function(){t.display&&(t.offsetHandle(),t.borderHandle())})),L.bind(e,o.TABLE_EVENT_TYPE.FIXED_CHANGE,(function(){t.display&&(t.offsetHandle(),t.borderHandle())})),L.bind(e,o.TABLE_EVENT_TYPE.RESIZE_CHANGE,(function(){t.display&&(t.offsetHandle(),t.borderHandle())})),L.bind(e,o.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.display&&(t.offsetHandle(),t.borderHandle())}))}},{key:"borderHandle",value:function(){var t=this.selectRange;t.equals(xs.EMPTY)||(this.hideBorder(),this.showBorder(t))}},{key:"offsetHandle",value:function(){var t=this.selectRange;t.equals(xs.EMPTY)?this.hide():(this.show(),this.setDisplay(t),this.setSizer(t),this.setLocal(t))}},{key:"hideCopyStyle",value:function(){this.display=!1,this.hide()}},{key:"showCopyStyle",value:function(){this.display=!0,this.show();var t=this.xScreen.findType(kh).selectRange;this.selectRange=t,this.offsetHandle(),this.borderHandle()}},{key:"destroy",value:function(){my(Oy(e.prototype),"destroy",this).call(this),this.unbind()}}])&&gy(n.prototype,i),c&&gy(n,c),e}(function(t){function e(t){var n,o=t.table;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=py(this,yy(e).call(this,{table:o},"".concat(r,"-part-border-svg")))).blt.html(dy),n.bl.html(dy),n.bt.html(dy),n.bbr.html(dy),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&by(t,e)}(e,t),e}(ih));function _y(t){return(_y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ty(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function xy(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ky(t,e,n){return(ky="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Py(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Py(t){return(Py=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jy(t,e){return(jy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Cy=function(t){function e(t){var n,o,i,c=t.title,l=void 0===c?"提示":c,u=t.message,a=void 0===u?"":u,s=t.ok,f=void 0===s?function(){}:s,h=t.no,p=void 0===h?function(){}:h;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(i=Py(e).call(this,"".concat(r,"-confirm")))||"object"!==_y(i)&&"function"!=typeof i?xy(o):i).title=l,n.message=a,n.ok=f,n.no=p,n.closeEle=k("div","".concat(r,"-confirm-close")),n.titleEle=k("div","".concat(r,"-confirm-title")),n.contentEle=k("div","".concat(r,"-confirm-content")),n.okEle=k("div","".concat(r,"-confirm-button ").concat(r,"-confirm-ok")),n.noEle=k("div","".concat(r,"-confirm-button ").concat(r,"-confirm-no")),n.buttonsEle=k("div","".concat(r,"-confirm-buttons")),n.titleEle.html(l),n.contentEle.html(a),n.okEle.html("确定"),n.noEle.html("取消"),n.buttonsEle.children(n.noEle),n.buttonsEle.children(n.okEle),n.children(n.closeEle),n.children(n.titleEle),n.children(n.contentEle),n.children(n.buttonsEle),n.dragPanel=(new co).children(xy(n)),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jy(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){var t=this.okEle,e=this.noEle;L.unbind(t),L.unbind(e)}},{key:"bind",value:function(){var t=this,e=this.okEle,n=this.noEle;L.bind(e,o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.ok(),t.close()})),L.bind(n,o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.no(),t.close()}))}},{key:"open",value:function(){this.dragPanel.open(),this.bind()}},{key:"close",value:function(){this.dragPanel.close(),this.destroy()}},{key:"destroy",value:function(){ky(Py(e.prototype),"destroy",this).call(this),this.unbind(),this.dragPanel.destroy()}}])&&Ty(n.prototype,i),c&&Ty(n,c),e}(B);function Ry(t){return(Ry="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ly(t,e){return!e||"object"!==Ry(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ay(t){return(Ay=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ny(t,e){return(Ny=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Iy=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ly(this,Ay(e).call(this,"".concat(r,"-font-angle-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ny(t,e)}(e,t),e}(le);function Vy(t){return(Vy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dy(t,e){return!e||"object"!==Vy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function My(t){return(My=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hy(t,e){return(Hy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fy=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Dy(this,My(e).call(this,"".concat(r,"-tools-divider")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hy(t,e)}(e,t),e}(B);function By(t){return(By="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wy(t,e){return!e||"object"!==By(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yy(t){return(Yy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Uy(t,e){return(Uy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zy=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Wy(this,Yy(e).call(this,"".concat(r,"-tools-font-angle-divider")))).children(new Fy),t.css("padding-left","0"),t.css("padding-right","0"),t.css("margin-left","0"),t.css("margin-right","0"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Uy(t,e)}(e,t),e}(pt);function Gy(t){return(Gy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xy(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Zy(t,e){return!e||"object"!==Gy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ky(t){return(Ky=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $y(t,e){return($y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qy=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Zy(this,Ky(e).call(this,"".concat(r,"-tools-drop-input-item ").concat(t)))).drop=k("div","".concat(r,"-tools-drop-input-item-mark")),n.title=k("div","".concat(r,"-tools-drop-input-item-title")),n.icon=new ut("arrow-down"),n.input=k("input","".concat(r,"-tools-drop-input")),n.drop.children(n.icon),n.title.children(n.input),n.children(n.title),n.children(n.drop),n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$y(t,e)}(e,t),n=e,(o=[{key:"setValue",value:function(t){return this.input.val(t),this}}])&&Xy(n.prototype,o),i&&Xy(n,i),e}(pt);function Qy(t){return(Qy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jy(t,e){return!e||"object"!==Qy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tb(t){return(tb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function eb(t,e){return(eb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nb=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Jy(this,tb(e).call(this,"".concat(r,"-font-angle-value-context-menu-item")))).angleValue=t,n.titleElement=k("div","".concat(r,"-font-angle-value-context-menu-item-title")),n.titleElement.text(t),n.titleElement.css("text-align","center"),n.children(n.titleElement),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&eb(t,e)}(e,t),e}(le);function ob(t){return(ob="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rb(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ib(t,e){return!e||"object"!==ob(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cb(t,e,n){return(cb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=lb(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function lb(t){return(lb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ub(t,e){return(ub=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ab=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ib(this,lb(e).call(this,"".concat(r,"-font-angle-value-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).items=[new nb(-90),new nb(-75),new nb(-60),new nb(-45),new nb(-30),new nb(-15),new nb(0),new nb(15),new nb(30),new nb(45),new nb(60),new nb(75),new nb(90)],t.items.forEach((function(e){t.addItem(e)})),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ub(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){this.items.forEach((function(t){L.unbind(t)}))}},{key:"bind",value:function(){var t=this;this.items.forEach((function(e){L.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.options.onUpdate(e),t.close()}))}))}},{key:"destroy",value:function(){cb(lb(e.prototype),"destroy",this).call(this),this.unbind()}}])&&rb(n.prototype,i),c&&rb(n,c),e}(ne);function sb(t){return(sb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fb(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function hb(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pb(t,e,n){return(pb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=yb(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function yb(t){return(yb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bb(t,e){return(bb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var db=function(t){function e(t){var n,o,i,c=t.onChange,l=void 0===c?function(){}:c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,i=yb(e).call(this,"".concat(r,"-tools-angle-value")),(n=!i||"object"!==sb(i)&&"function"!=typeof i?hb(o):i).onChange=l,n.value=0,n.fontAngleValueContextMenu=new ab({onUpdate:function(t){var e=t.angleValue;n.setValue(e),n.onChange(e)},el:hb(n)}),n.input.val(n.value),n.input.attr("type","number"),n.bind(),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bb(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){var t=this.icon;L.unbind(t)}},{key:"bind",value:function(){var t=this,e=this.fontAngleValueContextMenu,n=this.icon,r=this.input;L.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){e.isClose()?e.open():e.close()})),L.bind(r,o.SYSTEM_EVENT_TYPE.CHANGE,(function(){var e=S.parseInt(r.val());t.value=e,t.onChange(e)}))}},{key:"setValue",value:function(t){return this.value=t,pb(yb(e.prototype),"setValue",this).call(this,t)}},{key:"destroy",value:function(){pb(yb(e.prototype),"destroy",this).call(this),this.unbind(),this.fontAngleValueContextMenu.destroy()}}])&&fb(n.prototype,i),c&&fb(n,c),e}(qy);function vb(t){return(vb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gb(t,e){return!e||"object"!==vb(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wb(t){return(wb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mb(t,e){return(mb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ob=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=gb(this,wb(e).call(this,"".concat(r,"-tools-font-angle1")))).icon=new ut("font-angle1"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mb(t,e)}(e,t),e}(pt);function Eb(t){return(Eb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sb(t,e){return!e||"object"!==Eb(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _b(t){return(_b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tb(t,e){return(Tb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xb=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Sb(this,_b(e).call(this,"".concat(r,"-tools-font-angle2")))).icon=new ut("font-angle2"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tb(t,e)}(e,t),e}(pt);function kb(t){return(kb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pb(t,e){return!e||"object"!==kb(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jb(t){return(jb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cb(t,e){return(Cb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rb=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Pb(this,jb(e).call(this,"".concat(r,"-tools-font-angle3")))).icon=new ut("font-angle3"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cb(t,e)}(e,t),e}(pt);function Lb(t){return(Lb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ab(t,e){return!e||"object"!==Lb(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Nb(t){return(Nb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ib(t,e){return(Ib=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vb=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ab(this,Nb(e).call(this,"".concat(r,"-tools-font-angle4")))).icon=new ut("font-angle4"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ib(t,e)}(e,t),e}(pt);function Db(t){return(Db="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mb(t,e){return!e||"object"!==Db(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hb(t){return(Hb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fb(t,e){return(Fb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bb=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Mb(this,Hb(e).call(this,"".concat(r,"-tools-font-angle5")))).icon=new ut("font-angle5"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fb(t,e)}(e,t),e}(pt);function Wb(t){return(Wb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yb(t,e){return!e||"object"!==Wb(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ub(t){return(Ub=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zb(t,e){return(zb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gb=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Yb(this,Ub(e).call(this,"".concat(r,"-tools-font-angle6")))).icon=new ut("font-angle6"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zb(t,e)}(e,t),e}(pt);function Xb(t){return(Xb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zb(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Kb(t,e){return!e||"object"!==Xb(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $b(t,e,n){return($b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=qb(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function qb(t){return(qb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qb(t,e){return(Qb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jb=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=Kb(this,qb(e).call(this,"".concat(r,"-font-angle-context-menu"),S.mergeDeep({onUpdateAngle:function(){},onUpdateType:function(){}},n)));var o=k("div","".concat(r,"-font-angle-context-menu-type-icon-line"));return t.angle1=new Ob,t.angle2=new xb,t.angle3=new Rb,t.angle4=new Vb,t.angle5=new Bb,t.angle6=new Gb,t.input=new db({onChange:function(e){t.options.onUpdateAngle(e)}}),o.children(t.angle1),o.children(t.angle2),o.children(new zy),o.children(t.angle4),o.children(t.angle3),o.children(t.angle6),o.children(t.angle5),o.children(new zy),o.children(t.input),t.item=new Iy,t.item.children(o),t.item.removeClass("hover"),t.addItem(t.item),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qb(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){var t=this.angle1,e=this.angle2,n=this.angle3,o=this.angle4,r=this.angle5,i=this.angle6;L.unbind(t),L.unbind(e),L.unbind(n),L.unbind(o),L.unbind(r),L.unbind(i)}},{key:"bind",value:function(){var t=this,e=this.angle1,n=this.angle2,r=this.angle3,i=this.angle4,c=this.angle5,l=this.angle6;L.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.options.onUpdateType(ll.TEXT_DIRECTION.HORIZONTAL)})),L.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.options.onUpdateType(ll.TEXT_DIRECTION.VERTICAL)})),L.bind(r,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.options.onUpdateAngle(-45)})),L.bind(i,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.options.onUpdateAngle(45)})),L.bind(c,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.options.onUpdateAngle(-90)})),L.bind(l,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.options.onUpdateAngle(90)}))}},{key:"setValue",value:function(t){S.isNumber(t)||(t=0),this.input.setValue(t)}},{key:"destroy",value:function(){$b(qb(e.prototype),"destroy",this).call(this),this.unbind(),this.input.destroy()}}])&&Zb(n.prototype,i),c&&Zb(n,c),e}(ne);function td(t){return(td="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ed(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function nd(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function od(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function rd(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function id(t,e,n){return(id="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=cd(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function cd(t){return(cd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ld(t,e){return(ld=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ud=function(t){function e(){var t,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=cd(e).call(this,"".concat(r,"-tools-angle")))||"object"!==td(o)&&"function"!=typeof o?rd(n):o).options=i,t.icon=new ut("angle"),t.setIcon(t.icon),t.fontAngleContextMenu=new Jb(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ed(Object(n),!0).forEach((function(e){nd(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ed(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({el:rd(t)},t.options.contextMenu)),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ld(t,e)}(e,t),n=e,(o=[{key:"setValue",value:function(t){this.fontAngleContextMenu.setValue(t)}},{key:"destroy",value:function(){id(cd(e.prototype),"destroy",this).call(this),this.fontAngleContextMenu.destroy()}}])&&od(n.prototype,o),i&&od(n,i),e}(Ft);function ad(t){return(ad="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sd(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function fd(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function hd(t,e){return!e||"object"!==ad(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pd(t,e,n){return(pd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=yd(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function yd(t){return(yd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bd(t,e){return(bd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dd=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=hd(this,yd(e).call(this,"".concat(r,"-tools-menu")))).workTop=t;var o=n.workTop.work.body.sheetView;return n.undo=new gt,n.redo=new St,n.scale=new ls({contextMenu:{onUpdate:function(t){n.scale.setTitle("".concat(t,"%")),n.workTop.work.body.setScale(t/100)}}}),n.paintFormat=new jt,n.clearFormat=new Nt,n.format=new Ie({contextMenu:{onUpdate:function(t,e){var r=o.getActiveSheet().table,i=r.xScreen,c=r.getStyleCellsHelper(),l=r.tableDataSnapshot,u=i.findType(kh).selectRange;if(n.format.setTitle(e),u){l.begin();var a=l.cellDataProxy;c.getCellOrNewCellByViewRange({rectRange:u,callback:function(e,n,o){var r=o.clone();r.format=t,a.setCell(e,n,r)}}),l.end(),r.render()}}}}),n.font=new rn({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,r=e.xScreen,i=e.getStyleCellsHelper(),c=e.tableDataSnapshot,l=r.findType(kh).selectRange;if(n.font.setTitle(t),l){c.begin();var u=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l,callback:function(e,n,o){var r=o.clone();r.fontAttr.name=t,u.setCell(e,n,r)}}),c.end(),e.render()}}}}),n.dprFontSize=new xn({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,r=e.xScreen,i=e.getStyleCellsHelper(),c=e.tableDataSnapshot,l=r.findType(kh).selectRange;if(n.dprFontSize.setTitle(t),l){c.begin();var u=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l,callback:function(e,n,o){var r=o.clone();r.fontAttr.size=t,u.setCell(e,n,r)}}),c.end(),e.render()}}}}),n.fontColor=new Yo({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,r=e.xScreen,i=e.getStyleCellsHelper(),c=e.tableDataSnapshot,l=r.findType(kh).selectRange;if(n.fontColor.setColor(t),l){c.begin();var u=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l,callback:function(e,n,o){var r=o.clone();r.fontAttr.color=t,u.setCell(e,n,r)}}),c.end(),e.render()}}}}),n.fillColor=new sr({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,r=e.xScreen,i=e.getStyleCellsHelper(),c=e.tableDataSnapshot,l=r.findType(kh).selectRange;if(n.fillColor.setColor(t),l){c.begin();var u=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l,callback:function(e,n,o){var r=o.clone();r.background=t,u.setCell(e,n,r)}}),c.end(),e.render()}}}}),n.border=new Nc({contextMenu:{onUpdate:function(t,e,n){var r=o.getActiveSheet().table,i=r.xScreen,c=r.getOperateCellsHelper(),l=r.tableDataSnapshot,u=i.findType(kh).selectRange;if(u){l.begin();var a=l.cellDataProxy,s=u,f=hc.LINE_WIDTH_TYPE.low,h=dc.SOLID_LINE;switch(n){case"line1":f=hc.LINE_WIDTH_TYPE.low,h=dc.SOLID_LINE;break;case"line2":f=hc.LINE_WIDTH_TYPE.medium,h=dc.SOLID_LINE;break;case"line3":f=hc.LINE_WIDTH_TYPE.high,h=dc.SOLID_LINE;break;case"line4":h=dc.DOTTED_LINE;break;case"line5":h=dc.POINT_LINE;break;case"line6":h=dc.DOUBLE_LINE}switch(t){case"border1":c.getCellOrNewCellByViewRange({rectRange:s,callback:function(t,n,o){var r=o.clone(),i=r.borderAttr;i.setAllDisplay(!0),i.setAllColor(e),i.setAllWidthType(f),i.setAllType(h),a.setCell(t,n,r)}});break;case"border2":c.getCellOrNewCellByViewRange({rectRange:s,callback:function(t,n,o){var r=o.clone(),i=r.borderAttr;t!==s.sri&&(i.setTDisplay(!0),i.setTColor(e),i.setTWidthType(f),i.setTType(h)),t!==s.eri&&(i.setBDisplay(!0),i.setBColor(e),i.setBWidthType(f),i.setBType(h)),n!==s.sci&&(i.setLDisplay(!0),i.setLColor(e),i.setLWidthType(f),i.setLType(h)),n!==s.eci&&(i.setRDisplay(!0),i.setRColor(e),i.setRWidthType(f),i.setRType(h)),a.setCell(t,n,r)}});break;case"border3":c.getCellOrNewCellByViewRange({rectRange:s,callback:function(t,n,o){var r=o.clone().borderAttr;t!==s.sri&&(r.setTDisplay(!0),r.setTColor(e),r.setTWidthType(f),r.setTType(h)),t!==s.eri&&(r.setBDisplay(!0),r.setBColor(e),r.setBWidthType(f),r.setBType(h))}});break;case"border4":c.getCellOrNewCellByViewRange({rectRange:s,callback:function(t,n,o){var r=o.clone(),i=r.borderAttr;n!==s.sci&&(i.setLDisplay(!0),i.setLColor(e),i.setLWidthType(f),i.setLType(h)),n!==s.eci&&(i.setRDisplay(!0),i.setRColor(e),i.setRWidthType(f),i.setRType(h)),a.setCell(t,n,r)}});break;case"border5":c.getCellOrNewCellByViewRange({rectRange:s,callback:function(t,n,o){var r=o.clone(),i=r.borderAttr;t===s.sri&&(i.setTDisplay(!0),i.setTColor(e),i.setTWidthType(f),i.setTType(h)),t===s.eri&&(i.setBDisplay(!0),i.setBColor(e),i.setBWidthType(f),i.setBType(h)),n===s.sci&&(i.setLDisplay(!0),i.setLColor(e),i.setLWidthType(f),i.setLType(h)),n===s.eci&&(i.setRDisplay(!0),i.setRColor(e),i.setRWidthType(f),i.setRType(h)),a.setCell(t,n,r)}});break;case"border6":c.getCellOrNewCellByViewRange({rectRange:s,callback:function(t,n,o){var r=o.clone(),i=r.borderAttr;n===s.sci&&(i.setLDisplay(!0),i.setLColor(e),i.setLWidthType(f),i.setLType(h)),a.setCell(t,n,r)}});break;case"border7":c.getCellOrNewCellByViewRange({rectRange:s,callback:function(t,n,o){var r=o.clone(),i=r.borderAttr;t===s.sri&&(i.setTDisplay(!0),i.setTColor(e),i.setTWidthType(f),i.setTType(h)),a.setCell(t,n,r)}});break;case"border8":c.getCellOrNewCellByViewRange({rectRange:s,callback:function(t,n,o){var r=o.clone(),i=r.borderAttr;n===s.eci&&(i.setRDisplay(!0),i.setRColor(e),i.setRWidthType(f),i.setRType(h)),a.setCell(t,n,r)}});break;case"border9":c.getCellOrNewCellByViewRange({rectRange:s,callback:function(t,n,o){var r=o.clone(),i=r.borderAttr;t===s.eri&&(i.setBDisplay(!0),i.setBColor(e),i.setBWidthType(f),i.setBType(h)),a.setCell(t,n,r)}});break;case"border10":c.getCellOrNewCellByViewRange({rectRange:s,callback:function(t,e,n){var o=n.clone();o.borderAttr.setAllDisplay(!1),a.setCell(t,e,o)}})}l.end(),r.render()}}}}),n.fontBold=new Rn,n.fontItalic=new Vn,n.underLine=new Bn,n.fontStrike=new Gn,n.merge=new Hc,n.horizontalAlign=new Sl({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,r=e.xScreen,i=e.getStyleCellsHelper(),c=e.tableDataSnapshot,l=r.findType(kh).selectRange;switch(t){case ll.ALIGN.left:n.horizontalAlign.setIcon(new ut("align-left"));break;case ll.ALIGN.center:n.horizontalAlign.setIcon(new ut("align-center"));break;case ll.ALIGN.right:n.horizontalAlign.setIcon(new ut("align-right"))}if(l){c.begin();var u=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l,callback:function(e,n,o){var r=o.clone();r.fontAttr.align=t,u.setCell(e,n,r)}}),c.end(),e.render()}}}}),n.verticalAlign=new iu({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,r=e.xScreen,i=e.getStyleCellsHelper(),c=e.tableDataSnapshot,l=r.findType(kh).selectRange;switch(t){case ll.VERTICAL_ALIGN.top:n.verticalAlign.setIcon(new ut("align-top"));break;case ll.VERTICAL_ALIGN.center:n.verticalAlign.setIcon(new ut("align-middle"));break;case ll.VERTICAL_ALIGN.bottom:n.verticalAlign.setIcon(new ut("align-bottom"))}if(l){c.begin();var u=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l,callback:function(e,n,o){var r=o.clone();r.fontAttr.verticalAlign=t,u.setCell(e,n,r)}}),c.end(),e.render()}}}}),n.textWrapping=new Bu({contextMenu:{onUpdate:function(t){var e,r=o.getActiveSheet().table,i=r.xScreen,c=r.getStyleCellsHelper(),l=r.tableDataSnapshot,u=i.findType(kh).selectRange;switch(t){case ll.TEXT_WRAP.TRUNCATE:e=new ut("truncate");break;case ll.TEXT_WRAP.WORD_WRAP:e=new ut("text-wrap");break;case ll.TEXT_WRAP.OVER_FLOW:e=new ut("overflow")}if(n.textWrapping.setIcon(e),u){l.begin();var a=l.cellDataProxy;c.getCellOrNewCellByViewRange({rectRange:u,callback:function(e,n,o){var r=o.clone();r.fontAttr.textWrap=t,a.setCell(e,n,r)}}),l.end(),r.render()}}}}),n.fixed=new sa({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,r=e.xScreen.findType(kh).selectRange;switch(t){case"ROW":if(n.fixed.rowStatus)e.setFixedRow(-1);else if(r){var i=e.getScrollView(),c=r.sri;c<i.eri-2&&c>=i.sri?e.setFixedRow(c):new Nh({message:"无法在当前区域内冻结单元格, 请重新选择冻结区域"}).open()}break;case"COL":if(n.fixed.colStatus)e.setFixedCol(-1);else if(r){var l=e.getScrollView(),u=r.sci;u<l.eci-2&&u>=l.sci?e.setFixedCol(u):new Nh({message:"无法在当前区域内冻结单元格, 请重新选择冻结区域"}).open()}break;case"ROW1":e.setFixedRow(0,0);break;case"ROW2":e.setFixedRow(1,0);break;case"COL1":e.setFixedCol(0,0);break;case"COL2":e.setFixedCol(1,0)}}}}),n.filter=new ba,n.functions=new ma,n.fontAngle=new ud({contextMenu:{onUpdateAngle:function(t){var e=o.getActiveSheet().table,n=e.xScreen,r=e.getStyleCellsHelper(),i=e.tableDataSnapshot,c=n.findType(kh).selectRange;if(c){i.begin();var l=i.cellDataProxy;r.getCellOrNewCellByViewRange({rectRange:c,callback:function(e,n,o){var r=o.clone();0===t?(r.fontAttr.angle=t,r.fontAttr.direction=ll.TEXT_DIRECTION.HORIZONTAL):(r.fontAttr.angle=t,r.fontAttr.direction=ll.TEXT_DIRECTION.ANGLE),l.setCell(e,n,r)}}),i.end(),e.render()}},onUpdateType:function(t){var e=o.getActiveSheet().table,n=e.xScreen,r=e.getStyleCellsHelper(),i=e.tableDataSnapshot,c=n.findType(kh).selectRange;if(c){i.begin();var l=i.cellDataProxy;r.getCellOrNewCellByViewRange({rectRange:c,callback:function(e,n,o){var r=o.clone();r.fontAttr.angle=0,r.fontAttr.direction=t,l.setCell(e,n,r)}}),i.end(),e.render()}}}}),n.children(n.undo),n.children(n.redo),n.children(new Fy),n.children(n.scale),n.children(n.paintFormat),n.children(n.clearFormat),n.children(n.format),n.children(new Fy),n.children(n.font),n.children(n.dprFontSize),n.children(new Fy),n.children(n.fontBold),n.children(n.fontItalic),n.children(n.underLine),n.children(n.fontStrike),n.children(n.fontColor),n.children(new Fy),n.children(n.fillColor),n.children(n.border),n.children(n.merge),n.children(new Fy),n.children(n.horizontalAlign),n.children(n.verticalAlign),n.children(n.textWrapping),n.children(n.fontAngle),n.children(new Fy),n.children(n.fixed),n.children(n.filter),n.children(n.functions),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bd(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"unbind",value:function(){var t=this.workTop.work.body;L.bind(t),L.bind(this.scale),L.bind(this.undo),L.bind(this.redo),L.bind(this.paintFormat),L.bind(this.clearFormat),L.bind(this.format),L.bind(this.font),L.bind(this.dprFontSize),L.bind(this.fontBold),L.bind(this.fontItalic),L.bind(this.underLine),L.bind(this.fontStrike),L.bind(this.fontColor),L.bind(this.fillColor),L.bind(this.border),L.bind(this.merge),L.bind(this.horizontalAlign),L.bind(this.verticalAlign),L.bind(this.textWrapping),L.bind(this.fixed),L.bind(this.filter)}},{key:"bind",value:function(){var t=this,e=this.workTop.work.body,n=e.sheetView;L.bind(e,o.WORK_BODY_EVENT_TYPE.CHANGE_ACTIVE,(function(){t.setStatus()})),L.bind(e,o.TABLE_EVENT_TYPE.SELECT_DOWN,(function(){t.setFormatStatus(),t.setFontStatus(),t.setFontSizeStatus(),t.setFontBoldStatus(),t.setFontItalicStatus(),t.setUnderLineStatus(),t.setFontStrikeStatus(),t.setFontColorStatus(),t.setFillColorStatus(),t.setHorizontalAlignStatus(),t.setVerticalAlignStatus(),t.setTextWrappingStatus(),t.setFontAngleStatus()})),L.bind(e,o.TABLE_EVENT_TYPE.DATA_CHANGE,(function(){t.setStatus()})),L.bind(e,o.TABLE_EVENT_TYPE.FIXED_CHANGE,(function(){t.setFixedStatus()})),L.bind(this.scale,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.scale.scaleContextMenu,o=n.elPopUp;Kt.closeAll([o]),n.isClose()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),L.bind(this.undo,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table.tableDataSnapshot;t.canBack()&&t.back()})),L.bind(this.redo,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table.tableDataSnapshot;t.canGo()&&t.go()})),L.bind(this.paintFormat,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var e=n.getActiveSheet(),r=e.table,i=r.xScreen,c=i.findType(kh),l=c.selectRange;if(!S.isUnDef(l)){var u=r.cellMergeCopyHelper,a=r.tableDataSnapshot,s=i.findType(Sy),f=function n(){s.hideCopyStyle(),t.paintFormat.active(!1),t.paintFormat.removeSheet(e);var i=s.selectRange.clone(),l=c.selectRange.clone(),f=sd(i.size(),2),h=f[0],p=f[1],y=sd(l.size(),2),b=y[0],d=y[1],v=h>b?h:b,g=p>d?p:d;l.eri=l.sri+(v-1),l.eci=l.sci+(g-1),a.begin(),u.copyMergeContent({originViewRange:i,targetViewRange:l}),u.copyStylesContent({originViewRange:i,targetViewRange:l}),a.end(),r.render(),L.unbind(r,o.TABLE_EVENT_TYPE.SELECT_OVER,n)};t.paintFormat.includeSheet(e)?(s.hideCopyStyle(),t.paintFormat.active(!1),t.paintFormat.removeSheet(e),L.unbind(r,o.TABLE_EVENT_TYPE.SELECT_OVER,f)):(s.showCopyStyle(),t.paintFormat.active(!0),t.paintFormat.addSheet(e),L.bind(r,o.TABLE_EVENT_TYPE.SELECT_OVER,f))}})),L.bind(this.clearFormat,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.xScreen,o=t.getStyleCellsHelper(),r=t.tableDataSnapshot,i=e.findType(kh).selectRange;if(i){r.begin();var c=r.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:i,callback:function(t,e,n){var o=n.text;c.setCell(t,e,new Fa({text:o}))}}),r.end(),t.render()}})),L.bind(this.format,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.format.formatContextMenu,o=n.elPopUp;Kt.closeAll([o]),n.isClose()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),L.bind(this.font,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.font.fontContextMenu,o=n.elPopUp;Kt.closeAll([o]),n.isClose()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),L.bind(this.dprFontSize,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.dprFontSize.fontSizeContextMenu,o=n.elPopUp;Kt.closeAll([o]),n.isClose()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),L.bind(this.fontBold,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.xScreen,o=t.getStyleCellsHelper(),r=t.getTableCells(),i=t.tableDataSnapshot,c=e.findType(kh).selectRange;if(c){var l=!r.getCellOrNew(c.sri,c.sci).fontAttr.bold;i.begin();var u=i.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:c,callback:function(t,e,n){var o=n.clone();o.fontAttr.bold=l,u.setCell(t,e,o)}}),i.end(),t.render()}})),L.bind(this.fontItalic,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.xScreen,o=t.getStyleCellsHelper(),r=t.getTableCells(),i=t.tableDataSnapshot,c=e.findType(kh).selectRange;if(c){var l=!r.getCellOrNew(c.sri,c.sci).fontAttr.italic;i.begin();var u=i.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:c,callback:function(t,e,n){var o=n.clone();o.fontAttr.italic=l,u.setCell(t,e,o)}}),i.end(),t.render()}})),L.bind(this.underLine,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.xScreen,o=t.getStyleCellsHelper(),r=t.getTableCells(),i=t.tableDataSnapshot,c=e.findType(kh).selectRange;if(c){var l=!r.getCellOrNew(c.sri,c.sci).fontAttr.underline;i.begin();var u=i.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:c,callback:function(t,e,n){var o=n.clone();o.fontAttr.underline=l,u.setCell(t,e,o)}}),i.end(),t.render()}})),L.bind(this.fontStrike,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.xScreen,o=t.getStyleCellsHelper(),r=t.getTableCells(),i=t.tableDataSnapshot,c=e.findType(kh).selectRange;if(c){var l=!r.getCellOrNew(c.sri,c.sci).fontAttr.strikethrough;i.begin();var u=i.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:c,callback:function(t,e,n){var o=n.clone();o.fontAttr.strikethrough=l,u.setCell(t,e,o)}}),i.end(),t.render()}})),L.bind(this.fontColor,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.fontColor.fontColorContextMenu,o=n.elPopUp;Kt.closeAll([o]),n.isClose()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),L.bind(this.fillColor,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.fillColor.fillColorContextMenu,o=n.elPopUp;Kt.closeAll([o]),n.isClose()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),L.bind(this.border,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.border.borderTypeContextMenu,o=n.elPopUp;Kt.closeAll([o]),n.isClose()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),L.bind(this.merge,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){var e=n.getActiveSheet().table,o=e.xScreen,r=e.getTableMerges(),i=e.getTableCells(),c=e.tableDataSnapshot,l=o.findType(kh).selectRange;if(l){var u=l.clone(),a=r.getFirstIncludes(u.sri,u.sci),s=c.mergeDataProxy;S.isNotUnDef(a)&&u.equals(a)?(c.begin(),s.deleteMerge(a),c.end(),e.render()):u.multiple()&&(i.emptyRectRange(u)?(c.begin(),s.addMerge(u),c.end(),e.render()):new Cy({message:"非空单元格合并将使用左上角单元格内容",ok:function(){c.begin(),s.addMerge(u),c.end(),e.render()}}).open())}t.stopPropagation(),t.preventDefault()})),L.bind(this.horizontalAlign,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.horizontalAlign.horizontalContextMenu,o=n.elPopUp;Kt.closeAll([o]),n.isClose()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),L.bind(this.verticalAlign,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.verticalAlign.verticalContextMenu,o=n.elPopUp;Kt.closeAll([o]),n.isClose()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),L.bind(this.textWrapping,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.textWrapping.textWrappingContextMenu,o=n.elPopUp;Kt.closeAll([o]),n.isClose()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),L.bind(this.fixed,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.fixed.fixedContextMenu,o=n.elPopUp;Kt.closeAll([o]),n.isClose()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),L.bind(this.filter,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var e=n.getActiveSheet().table.xScreen.findType(fy);e.display?(e.hideFilter(),t.filter.active(e.display)):(e.openFilter(),t.filter.active(e.display))})),L.bind(this.fontAngle,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.fontAngle.fontAngleContextMenu,o=n.elPopUp;Kt.closeAll([o]),n.isClose()?n.open():n.close(),e.stopPropagation(),e.preventDefault()}))}},{key:"setHorizontalAlignStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(kh).selectRange,r=new ut("align-left");if(o)switch(n.getCellOrNew(o.sri,o.sci).fontAttr.align){case ll.ALIGN.left:r=new ut("align-left");break;case ll.ALIGN.center:r=new ut("align-center");break;case ll.ALIGN.right:r=new ut("align-right")}this.horizontalAlign.setIcon(r)}},{key:"setVerticalAlignStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(kh).selectRange,r=new ut("align-middle");if(o)switch(n.getCellOrNew(o.sri,o.sci).fontAttr.verticalAlign){case ll.VERTICAL_ALIGN.top:r=new ut("align-top");break;case ll.VERTICAL_ALIGN.center:r=new ut("align-middle");break;case ll.VERTICAL_ALIGN.bottom:r=new ut("align-bottom")}this.verticalAlign.setIcon(r)}},{key:"setTextWrappingStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(kh).selectRange,r=new ut("text-wrap");if(o)switch(n.getCellOrNew(o.sri,o.sci).fontAttr.textWrap){case ll.TEXT_WRAP.TRUNCATE:r=new ut("truncate");break;case ll.TEXT_WRAP.WORD_WRAP:r=new ut("text-wrap");break;case ll.TEXT_WRAP.OVER_FLOW:r=new ut("overflow")}this.textWrapping.setIcon(r)}},{key:"setUndoStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table.tableDataSnapshot;this.undo.active(t.canBack())}},{key:"setRedoStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table.tableDataSnapshot;this.redo.active(t.canGo())}},{key:"setScaleStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table.scale.goto(100);this.scale.setTitle("".concat(t,"%"))}},{key:"setPaintFormatStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet();this.paintFormat.active(this.paintFormat.includeSheet(t))}},{key:"setFormatStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(kh).selectRange,r="常规",i="default";if(o)switch(i=n.getCellOrNew(o.sri,o.sci).format){case"default":r="常规";break;case"text":r="文本";break;case"number":r="数字";break;case"percentage":r="百分比";break;case"fraction":r="分数";break;case"ENotation":r="科学计数";break;case"rmb":r="人民币";break;case"hk":r="港币";break;case"dollar":r="美元";break;case"date1":case"date2":case"date3":case"date4":case"date5":r="日期";break;case"time":r="时间"}this.format.setTitle(r),this.format.formatContextMenu.setActiveByType(i)}},{key:"setFontStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(kh).selectRange,r="Arial";o&&(r=n.getCellOrNew(o.sri,o.sci).fontAttr.name),this.font.setTitle(r),this.font.fontContextMenu.setActiveByType(r)}},{key:"setStatus",value:function(){this.setUndoStatus(),this.setRedoStatus(),this.setScaleStatus(),this.setPaintFormatStatus(),this.setFormatStatus(),this.setFontStatus(),this.setFontSizeStatus(),this.setFontBoldStatus(),this.setFontItalicStatus(),this.setUnderLineStatus(),this.setFontStrikeStatus(),this.setFontColorStatus(),this.setFillColorStatus(),this.setHorizontalAlignStatus(),this.setVerticalAlignStatus(),this.setTextWrappingStatus(),this.setFixedStatus(),this.setFilterStatus(),this.setFontAngleStatus()}},{key:"setFixedStatus",value:function(){var t=this.workTop.work.body,e=this.fixed,n=t.sheetView.getActiveSheet().table;e.setFixedRowStatus(n.xFixedView.hasFixedTop()),e.setFixedColStatus(n.xFixedView.hasFixedLeft())}},{key:"setFilterStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table.xScreen.findType(fy);this.filter.active(t.display)}},{key:"setUnderLineStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(kh).selectRange,r=!1;o&&(r=n.getCellOrNew(o.sri,o.sci).fontAttr.underline),this.underLine.active(r)}},{key:"setFontSizeStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(kh).selectRange,r="12";o&&(r=n.getCellOrNew(o.sri,o.sci).fontAttr.size),this.dprFontSize.setTitle(r)}},{key:"setFontBoldStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(kh).selectRange,r=!1;o&&(r=n.getCellOrNew(o.sri,o.sci).fontAttr.bold),this.fontBold.active(r)}},{key:"setFontStrikeStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(kh).selectRange,r=!1;o&&(r=n.getCellOrNew(o.sri,o.sci).fontAttr.strikethrough),this.fontStrike.active(r)}},{key:"setFontColorStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(kh).selectRange,r="rgb(0, 0, 0)";o&&(r=n.getCellOrNew(o.sri,o.sci).fontAttr.color),this.fontColor.setColor(r),this.fontColor.fontColorContextMenu.setActiveByColor(r)}},{key:"setFillColorStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(kh).selectRange,r="rgb(255, 255, 255)";if(o){var i=n.getCellOrNew(o.sri,o.sci);i.background&&(r=i.background)}this.fillColor.setColor(r),this.fillColor.fillColorContextMenu.setActiveByColor(r)}},{key:"setFontItalicStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(kh).selectRange,r=!1;o&&(r=n.getCellOrNew(o.sri,o.sci).fontAttr.italic),this.fontItalic.active(r)}},{key:"setFontAngleStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(kh).selectRange,r=0;o&&(r=n.getCellOrNew(o.sri,o.sci).fontAttr.angle),this.fontAngle.setValue(r)}},{key:"destroy",value:function(){pd(yd(e.prototype),"destroy",this).call(this),this.unbind()}}])&&fd(n.prototype,i),c&&fd(n,c),e}(B);function vd(t){return(vd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gd(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function wd(t,e){return!e||"object"!==vd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function md(t){return(md=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Od(t,e){return(Od=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ed=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=wd(this,md(e).call(this,"".concat(r,"-option-item ").concat(t)))).title="",n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Od(t,e)}(e,t),n=e,(o=[{key:"setTitle",value:function(t){this.title=t,this.text(this.title)}}])&&gd(n.prototype,o),i&&gd(n,i),e}(B);function Sd(t){return(Sd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _d(t,e){return!e||"object"!==Sd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Td(t){return(Td=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xd(t,e){return(xd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kd=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=_d(this,Td(e).call(this,"".concat(r,"-tools-file")))).setTitle("文件"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xd(t,e)}(e,t),e}(Ed);function Pd(t){return(Pd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jd(t,e){return!e||"object"!==Pd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Cd(t){return(Cd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rd(t,e){return(Rd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ld=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=jd(this,Cd(e).call(this,"".concat(r,"-tools-format")))).setTitle("格式"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rd(t,e)}(e,t),e}(Ed);function Ad(t){return(Ad="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nd(t,e){return!e||"object"!==Ad(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Id(t){return(Id=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vd(t,e){return(Vd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Dd=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Nd(this,Id(e).call(this,"".concat(r,"-tools-insert")))).setTitle("插入"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vd(t,e)}(e,t),e}(Ed);function Md(t){return(Md="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hd(t,e){return!e||"object"!==Md(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fd(t){return(Fd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bd(t,e){return(Bd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wd=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Hd(this,Fd(e).call(this,"".concat(r,"-tools-look")))).setTitle("查看"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bd(t,e)}(e,t),e}(Ed);function Yd(t){return(Yd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ud(t,e){return!e||"object"!==Yd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zd(t){return(zd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gd(t,e){return(Gd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xd=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ud(this,zd(e).call(this,"".concat(r,"-tools-update")))).setTitle("修改"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gd(t,e)}(e,t),e}(Ed);function Zd(t){return(Zd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kd(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function $d(t,e){return!e||"object"!==Zd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qd(t){return(qd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qd(t,e){return(Qd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jd=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=$d(this,qd(e).call(this,"".concat(r,"-option")))).workTop=t,n.title=" X-Sheet 工作簿",n.logoEle=k("div","".concat(r,"-option-logo")),n.titleEle=k("div","".concat(r,"-option-title")),n.optionsEle=k("div","".concat(r,"-option-box")),n.leftEle=k("div","".concat(r,"-option-left")),n.rightEle=k("div","".concat(r,"-option-right")),n.leftEle.children(n.logoEle),n.rightEle.children(n.titleEle,n.optionsEle),n.children(n.leftEle),n.children(n.rightEle),n.setTitle(n.title),n.file=new kd,n.format=new Ld,n.insert=new Dd,n.look=new Wd,n.update=new Xd,n.optionsEle.children(n.file),n.optionsEle.children(n.format),n.optionsEle.children(n.insert),n.optionsEle.children(n.look),n.optionsEle.children(n.update),n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qd(t,e)}(e,t),n=e,(o=[{key:"setTitle",value:function(t){this.title=t,this.titleEle.text(t)}}])&&Kd(n.prototype,o),i&&Kd(n,i),e}(B);function tv(t){return(tv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ev(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function nv(t,e){return!e||"object"!==tv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ov(t){return(ov=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rv(t,e){return(rv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var iv=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=nv(this,ov(e).call(this,"".concat(r,"-work-top")))).work=t,n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rv(t,e)}(e,t),n=e,(o=[{key:"onAttach",value:function(){this.toolsMenu=new dd(this),this.option=new Jd(this),this.attach(this.option),this.attach(this.toolsMenu)}}])&&ev(n.prototype,o),i&&ev(n,i),e}(B);function cv(t){return(cv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lv(t,e){return!e||"object"!==cv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function uv(t){return(uv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function av(t,e){return(av=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sv=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=lv(this,uv(e).call(this,"".concat(r,"-horizontal-layer")))).options=S.mergeDeep({style:{}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&av(t,e)}(e,t),e}(G);function fv(t){return(fv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hv(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function pv(t,e){return!e||"object"!==fv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function yv(t,e,n){return(yv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=bv(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function bv(t){return(bv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dv(t,e){return(dv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vv=function(t){function e(t){var n,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=pv(this,bv(e).call(this,"".concat(r,"-scroll-bar-x")))).option=S.mergeDeep({style:{},scroll:function(t){return t}},t),o.lastBut=k("div","".concat(r,"-scroll-bar-x-last-but")),o.nextBut=k("div","".concat(r,"-scroll-bar-x-next-but")),o.content=k("div","".concat(r,"-scroll-bar-x-content")),o.block=k("div","".concat(r,"-scroll-bar-x-block")),o.content.children(o.block),(n=o).children.apply(n,[o.lastBut,o.nextBut,o.content]),o.blockLeft=0,o.maxBlockLeft=0,o.blockWidth=0,o.minBlockWidth=20,o.scrollTo=0,o.contentWidth=0,o.viewPortWidth=0,o.isHide=!0,o.css(o.option.style),o}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dv(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"setSize",value:function(t,e){if(t<e){this.isHide=!1,this.show();var n=this.content.box(),o=t/e*n.width;this.blockWidth=o<this.minBlockWidth?this.minBlockWidth:o,this.viewPortWidth=t,this.contentWidth=e,this.maxBlockLeft=n.width-this.blockWidth,this.block.css("width","".concat(this.blockWidth,"px"));var r=this.scrollTo/(e-t)*this.maxBlockLeft;this.blockLeft=r>this.maxBlockLeft?this.maxBlockLeft:r,this.scrollTo=this.computeScrollTo(this.blockLeft),this.block.css("left","".concat(this.blockLeft,"px"))}else this.isHide=!0,this.hide(),this.option.scroll(0)}},{key:"unbind",value:function(){L.unbind(this.block)}},{key:"bind",value:function(){var t=this;L.bind(this.block,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(0===e.button){var n=t.eventXy(e,t.block);L.mouseMoveUp(k(document),(function(e){var o=t.eventXy(e,t.content).x-n.x;o<0&&(o=0),o>t.maxBlockLeft&&(o=t.maxBlockLeft),t.blockLeft=o,t.scrollTo=t.computeScrollTo(t.blockLeft),t.block.css("left","".concat(o,"px")),t.option.scroll(t.scrollTo),e.stopPropagation(),e.preventDefault()})),e.stopPropagation(),e.preventDefault()}}))}},{key:"scrollMove",value:function(t){this.setLocal(t),this.option.scroll(this.scrollTo)}},{key:"setLocal",value:function(t){var e=t,n=this.contentWidth-this.viewPortWidth;e>n?e=n:e<0&&(e=0);var o=e/(this.contentWidth-this.viewPortWidth)*this.maxBlockLeft;this.blockLeft=o>this.maxBlockLeft?this.maxBlockLeft:o,!1===this.isHide&&(this.scrollTo=e,this.block.css("left","".concat(this.blockLeft,"px")))}},{key:"computeScrollTo",value:function(t){return t/this.maxBlockLeft*(this.contentWidth-this.viewPortWidth)}},{key:"destroy",value:function(){yv(bv(e.prototype),"destroy",this).call(this),this.unbind()}}])&&hv(n.prototype,i),c&&hv(n,c),e}(B);function gv(t){return(gv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wv(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function mv(t,e){return!e||"object"!==gv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ov(t,e,n){return(Ov="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ev(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Ev(t){return(Ev=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sv(t,e){return(Sv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _v=function(t){function e(t){var n,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=mv(this,Ev(e).call(this,"".concat(r,"-scroll-bar-y")))).option=S.mergeDeep({style:{},scroll:function(t){return t}},t),o.lastBut=k("div","".concat(r,"-scroll-bar-y-last-but")),o.nextBut=k("div","".concat(r,"-scroll-bar-y-next-but")),o.content=k("div","".concat(r,"-scroll-bar-y-content")),o.block=k("div","".concat(r,"-scroll-bar-y-block")),o.content.children(o.block),(n=o).children.apply(n,[o.lastBut,o.nextBut,o.content]),o.blockTop=0,o.maxBlockTop=0,o.blockHeight=0,o.minBlockHeight=20,o.scrollTo=0,o.contentHeight=0,o.viewPortHeight=0,o.isHide=!0,o.css(o.option.style),o}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sv(t,e)}(e,t),n=e,(i=[{key:"setSize",value:function(t,e){if(t<e){this.isHide=!1,this.show();var n=this.content.box(),o=t/e*n.height;this.blockHeight=o<this.minBlockHeight?this.minBlockHeight:o,this.viewPortHeight=t,this.contentHeight=e,this.maxBlockTop=n.height-this.blockHeight,this.block.css("height","".concat(this.blockHeight,"px"));var r=this.scrollTo/(e-t)*this.maxBlockTop;this.blockTop=r>this.maxBlockTop?this.maxBlockTop:r,this.scrollTo=this.computeScrollTo(this.blockTop),this.block.css("top","".concat(this.blockTop,"px"))}else this.isHide=!0,this.hide(),this.option.scroll(0)}},{key:"onAttach",value:function(){this.bind()}},{key:"unbind",value:function(){L.unbind(this.block)}},{key:"bind",value:function(){var t=this;L.bind(this.block,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(0===e.button){var n=t.eventXy(e,t.block);L.mouseMoveUp(k(document),(function(e){var o=t.eventXy(e,t.content).y-n.y;o<0&&(o=0),o>t.maxBlockTop&&(o=t.maxBlockTop),t.blockTop=o,t.scrollTo=t.computeScrollTo(t.blockTop),t.block.css("top","".concat(o,"px")),t.option.scroll(t.scrollTo),e.stopPropagation(),e.preventDefault()}))}}))}},{key:"setLocal",value:function(t){var e=t,n=this.contentHeight-this.viewPortHeight;e>n?e=n:e<0&&(e=0);var o=e/(this.contentHeight-this.viewPortHeight)*this.maxBlockTop;this.blockTop=o>this.maxBlockTop?this.maxBlockTop:o,!1===this.isHide&&(this.scrollTo=e,this.block.css("top","".concat(this.blockTop,"px")))}},{key:"scrollMove",value:function(t){this.setLocal(t),this.option.scroll(this.scrollTo)}},{key:"computeScrollTo",value:function(t){return t/this.maxBlockTop*(this.contentHeight-this.viewPortHeight)}},{key:"destroy",value:function(){Ov(Ev(e.prototype),"destroy",this).call(this),this.unbind()}}])&&wv(n.prototype,i),c&&wv(n,c),e}(B);function Tv(t){return(Tv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xv(t,e){return!e||"object"!==Tv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kv(t){return(kv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pv(t,e){return(Pv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jv=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=xv(this,kv(e).call(this,"".concat(r,"-horizontal-layer-element")))).options=S.mergeDeep({style:{flexGrow:"0"}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pv(t,e)}(e,t),e}(G);function Cv(t){return(Cv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rv(t,e){return!e||"object"!==Cv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lv(t){return(Lv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Av(t,e){return(Av=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nv=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Rv(this,Lv(e).call(this,"".concat(r,"-vertical-center-element")))).options=S.mergeDeep({style:{}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Av(t,e)}(e,t),e}(G);function Iv(t){return(Iv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vv(t,e){return!e||"object"!==Iv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dv(t){return(Dv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mv(t,e){return(Mv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hv=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Vv(this,Dv(e).call(this,"".concat(r,"-vertical-center")))).options=S.mergeDeep({style:{}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mv(t,e)}(e,t),e}(G);function Fv(t){return(Fv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bv(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Wv(t,e){return!e||"object"!==Fv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yv(t,e,n){return(Yv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Uv(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Uv(t){return(Uv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zv(t,e){return(zv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gv=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Wv(this,Uv(e).call(this,"".concat(r,"-sheet-view")))).sheetList=[],t.activeIndex=-1,t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zv(t,e)}(e,t),n=e,(o=[{key:"setActiveSheet",value:function(t){var e=this.sheetList;return e[t]?(this.activeIndex=t,this.setActive(e[t])):null}},{key:"attach",value:function(t){this.sheetList.push(t),Yv(Uv(e.prototype),"attach",this).call(this,t),t.hide()}},{key:"getActiveSheet",value:function(){return this.sheetList[this.activeIndex]}},{key:"setActive",value:function(t){return t.show(),t.sibling().forEach((function(t){t.hide()})),t}},{key:"getLastIndex",value:function(){return this.sheetList.length-1}}])&&Bv(n.prototype,o),i&&Bv(n,i),e}(B);function Xv(t){return(Xv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zv(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Kv(t,e){return!e||"object"!==Xv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $v(t,e,n){return($v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=qv(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function qv(t){return(qv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qv(t,e){return(Qv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jv=function(t){function e(t){var n,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Kv(this,qv(e).call(this,"".concat(r,"-sheet-switch-tab")))).last=k("div","".concat(r,"-switch-tab-last-btn")),o.next=k("div","".concat(r,"-switch-tab-next-btn")),o.content=k("div","".concat(r,"-sheet-tab-content")),o.tabs=k("div","".concat(r,"-sheet-tab-tabs")),o.plus=k("div","".concat(r,"-sheet-tab-plus")),o.content.children(o.tabs),(n=o).children.apply(n,[o.last,o.next,o.content,o.plus]),o.optiions=S.mergeDeep({onAdd:function(t){return t},onSwitch:function(t){return t}},t),o.left=null,o.tabList=[],o}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qv(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"offsetSizeLeft",value:function(){var t=this.content.offset().width,e=this.tabs.offset().width;e>t&&(this.left=-(e-t),this.tabs.css("marginLeft","".concat(this.left,"px")))}},{key:"unbind",value:function(){var t=this.next,e=this.last,n=this.plus;L.unbind(t),L.unbind(e),L.unbind(n)}},{key:"bind",value:function(){var t=this,e=this.next,n=this.last,r=this.plus;L.bind(e,o.SYSTEM_EVENT_TYPE.CLICK,(function(){var e=t.content.offset().width,n=-(t.tabs.offset().width-e),o=t.left||0;(o-=30)<n&&(o=n),t.left=o,t.tabs.css("marginLeft","".concat(t.left,"px"))})),L.bind(n,o.SYSTEM_EVENT_TYPE.CLICK,(function(){var e=t.left||0;(e+=30)>0&&(e=0),t.left=e,t.tabs.css("marginLeft","".concat(t.left,"px"))})),L.bind(r,o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.optiions.onAdd(),t.offsetSizeLeft()}))}},{key:"attach",value:function(t){var e=this;this.tabList.push(t),this.tabs.children(t),t.onAttach(),L.bind(t,o.SYSTEM_EVENT_TYPE.CLICK,(function(){e.setActive(t),e.optiions.onSwitch(t)}))}},{key:"setActiveTab",value:function(t){var e=this.tabList;return e[t]?(this.setActive(e[t]),e[t]):null}},{key:"setActive",value:function(t){t.addClass("active"),t.sibling().forEach((function(t){t.removeClass("active")}))}},{key:"getLastIndex",value:function(){return this.tabList.length-1}},{key:"destroy",value:function(){$v(qv(e.prototype),"destroy",this).call(this),this.unbind()}}])&&Zv(n.prototype,i),c&&Zv(n,c),e}(B);function tg(t){return(tg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eg(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ng(t,e){return!e||"object"!==tg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function og(t){return(og=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rg(t,e){return(rg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ig=1,cg=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Sheet".concat(ig);return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=ng(this,og(e).call(this,"".concat(r,"-sheet-tab"))),ig+=1,t.setName(n),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rg(t,e)}(e,t),n=e,(o=[{key:"setName",value:function(t){this.name=t,this.text(this.name)}}])&&eg(n.prototype,o),i&&eg(n,i),e}(B);function lg(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ug(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var ag=function(){function t(){lg(this,t),this.value=1}var e,n,o;return e=t,(n=[{key:"back",value:function(t){return t/this.value}},{key:"goto",value:function(t){return this.value*t}},{key:"setValue",value:function(t){this.value=t}}])&&ug(e.prototype,n),o&&ug(e,o),t}(),sg=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.goto,o=void 0===n?function(t){return t}:n,r=e.back,i=void 0===r?function(t){return t}:r;lg(this,t),this.goto=o,this.back=i};function fg(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var hg=function(){function t(e){var n=e.scaleAdapter,o=void 0===n?new sg:n,r=e.height,i=void 0===r?33:r,c=e.width,l=void 0===c?50:c,u=e.background,a=void 0===u?"#f6f7fa":u,s=e.color,f=void 0===s?"#585757":s,h=e.size,p=void 0===h?11:h,y=e.gridColor,b=void 0===y?"#e8e8e8":y;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scaleAdapter=o,this.height=i,this.width=l,this.background=a,this.color=f,this.size=p,this.gridColor=b}var e,n,o;return e=t,(n=[{key:"getGridColor",value:function(){return this.gridColor}},{key:"getColor",value:function(){return this.color}},{key:"getSize",value:function(){var t=this.scaleAdapter,e=this.size;return t.goto(e)}},{key:"getBackground",value:function(){return this.background}},{key:"getHeight",value:function(){var t=this.scaleAdapter,e=this.height;return t.goto(e)}},{key:"getWidth",value:function(){var t=this.scaleAdapter,e=this.width;return t.goto(e)}}])&&fg(e.prototype,n),o&&fg(e,o),t}();function pg(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var yg=function(){function t(e){var n=e.scaleAdapter,o=void 0===n?new sg:n,r=e.len,i=void 0===r?10:r,c=e.data,l=void 0===c?[]:c,u=e.height,a=void 0===u?30:u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scaleAdapter=o,this.len=i,this.data=l,this.min=5,this.height=S.minIf(a,this.min)}var e,n,o;return e=t,(n=[{key:"rectRangeSumHeight",value:function(t){return t.equals(xs.EMPTY)?0:this.sectionSumHeight(t.sri,t.eri)}},{key:"sectionSumHeight",value:function(t,e){var n=this,o=0;return t>e?o:(vs.getInstance().setBegin(t).setEnd(e).setLoop((function(t){o+=n.getHeight(t)})).execute(),o)}},{key:"getOrNew",value:function(t){return this.data[t]=this.data[t]||{},this.data[t]}},{key:"getHeight",value:function(t){var e=this.scaleAdapter,n=this.get(t);return n&&n.height?e.goto(n.height):e.goto(this.height)}},{key:"get",value:function(t){return this.data[t]}},{key:"eachHeight",value:function(t,e,n){var o=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=r;vs.getInstance().setBegin(t).setEnd(e).setLoop((function(t){var e=o.getHeight(t);n(t,e,i),i+=e})).execute()}},{key:"setHeight",value:function(t,e){var n=this.getOrNew(t),o=this.scaleAdapter;n.height=o.back(S.minIf(e,this.min))}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(t){this.data=t}}])&&pg(e.prototype,n),o&&pg(e,o),t}();function bg(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var dg=function(){function t(e){var n=e.scaleAdapter,o=void 0===n?new sg:n,r=e.len,i=void 0===r?10:r,c=e.data,l=void 0===c?[]:c,u=e.width,a=void 0===u?110:u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scaleAdapter=o,this.len=i,this.data=l,this.min=5,this.width=S.minIf(a,this.min)}var e,n,o;return e=t,(n=[{key:"rectRangeSumWidth",value:function(t){return t.equals(xs.EMPTY)?0:this.sectionSumWidth(t.sci,t.eci)}},{key:"sectionSumWidth",value:function(t,e){var n=this,o=0;return t>e?o:(Ss.getInstance().setBegin(t).setEnd(e).setLoop((function(t){o+=n.getWidth(t)})).execute(),o)}},{key:"getOrNew",value:function(t){return this.data[t]=this.data[t]||{},this.data[t]}},{key:"getWidth",value:function(t){var e=this.scaleAdapter,n=this.data[t];return n&&n.width?e.goto(n.width):e.goto(this.width)}},{key:"get",value:function(t){return this.data[t]}},{key:"eachWidth",value:function(t,e,n){var o=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=r;Ss.getInstance().setBegin(t).setEnd(e).setLoop((function(t){var e=o.getWidth(t);n(t,e,i),i+=e})).execute()}},{key:"setWidth",value:function(t,e){var n=this.getOrNew(t),o=this.scaleAdapter;n.width=o.back(S.minIf(e,this.min))}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(t){this.data=t}}])&&bg(e.prototype,n),o&&bg(e,o),t}();var vg={H_LEFT:Symbol("水平方向左边滚动条"),H_RIGHT:Symbol("水平方向向右边滚动"),V_TOP:Symbol("垂直方向向上滚动"),V_BOTTOM:Symbol("垂直方向下滚动"),UN:Symbol("未知")},gg=function t(e){var n=e.xFixedView;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var o=n.getFixedView();this.ri=o.eri+1,this.ci=o.eci+1,this.x=0,this.y=0,this.type=vg.UN};function wg(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var mg=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var o=e.focus;this.table=e,this.pool=[],this.xTableKeyBoardDownHandle=function(t){var e=o.activate,r=t.keyCode;if(e){var i=e.target,c=n.find(i);c&&c.keyCode===r&&c.callback()}9===r&&t.preventDefault()},this.bind()}var e,n,r;return e=t,(n=[{key:"unbind",value:function(){L.unbind(document,o.SYSTEM_EVENT_TYPE.KEY_DOWN,this.xTableKeyBoardDownHandle)}},{key:"bind",value:function(){L.bind(document,o.SYSTEM_EVENT_TYPE.KEY_DOWN,this.xTableKeyBoardDownHandle)}},{key:"find",value:function(t){for(var e=this.pool,n=0;n<e.length;n+=1){var o=e[n];if(o.target===t)return o}return null}},{key:"register",value:function(t){var e=t.target,n=t.keyCode,o=t.callback;this.pool.push({target:e,keyCode:n,callback:o})}}])&&wg(e.prototype,n),r&&wg(e,r),t}();function Og(t){return(Og="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Eg(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Sg(t,e){return!e||"object"!==Og(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _g(t,e,n){return(_g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Tg(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Tg(t){return(Tg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xg(t,e){return(xg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kg=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=Sg(this,Tg(e).call(this,"".concat(r,"-table-col-fixed-bar")));var o=t.xFixedView.getFixedView(),i=k("div","".concat(r,"-table-col-fixed-block"));return n.table=t,n.fxSci=o.sci,n.fxEci=o.eci,n.block=i,n.children(i),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xg(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){var t=this.table;L.unbind(t)}},{key:"bind",value:function(){var t=this,n=this.table,r=n.mousePointer,i=n.dropColFixed,c=n.xFixedView,l=!0;L.bind(n,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.setSize()})),L.bind(n,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.setSize()})),L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){t.setActive(!0),r.lock(e),r.set(wh.KEYS.grab,e)})),L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){l&&(t.setActive(!1),r.free(e))})),L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(o){i.show(),t.setActive(!0);var u=n.getScrollView(),a=c.getFixedView();t.fxSci=a.sci,t.fxEci=a.eci,r.lock(e),r.set(wh.KEYS.grab,e);var s=n.eventXy(o,n).x;i.offset({left:s}),l=!1,c.hasFixedLeft()&&(n.scroll.x=0,n.scroll.ci=t.fxEci+1,n.resize()),L.mouseMoveUp(document,(function(e){var o=n.eventXy(e,n),r=o.x,c=o.y;i.offset({left:r});var l=n.getRiCiByXy(r,c).ci;l<u.eci-2&&(t.fxEci=l,t.setSize())}),(function(){t.setActive(!1),r.free(e),i.hide(),n.setFixedCol(t.fxEci),l=!0}))}))}},{key:"setActive",value:function(t){t?(this.block.addClass("active"),this.addClass("active")):(this.block.removeClass("active"),this.removeClass("active"))}},{key:"onAttach",value:function(){var t=this.table;this.setSize(),this.bind(),t.focus.register({target:this,stop:!1})}},{key:"setSize",value:function(){var t=this.table,n=this.block,o=this.fxSci,r=this.fxEci,i=t.cols,c=e.WIDTH,l=r>-1?t.visualHeight():t.getIndexHeight(),u=r>-1?c/2:c,a=i.sectionSumWidth(o,r)+t.getIndexWidth()-u;n.offset({height:t.getIndexHeight(),width:c}),this.offset({width:c,height:l,left:a,top:0})}},{key:"destroy",value:function(){_g(Tg(e.prototype),"destroy",this).call(this),this.unbind()}}])&&Eg(n.prototype,i),c&&Eg(n,c),e}(B);function Pg(t){return(Pg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jg(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Cg(t,e){return!e||"object"!==Pg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rg(t,e,n){return(Rg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Lg(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Lg(t){return(Lg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ag(t,e){return(Ag=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}kg.WIDTH=6;var Ng=function(t){function e(t){var n,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:5};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Cg(this,Lg(e).call(this,"".concat(r,"-re-sizer-horizontal")))).table=t,o.options=i,o.width=i.width,o.hoverEl=k("div","".concat(r,"-re-sizer-hover")),o.lineEl=k("div","".concat(r,"-re-sizer-line")),(n=o).children.apply(n,[o.hoverEl,o.lineEl]),o}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ag(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind(),this.table.focus.register({target:this})}},{key:"unbind",value:function(){var t=this.table;L.unbind(t)}},{key:"bind",value:function(){var t=this,n=this.table,r=n.cols,i=n.mousePointer,c=n.focus,l=n.xFixedView,u=n.tableDataSnapshot,a=u.colsDataProxy,s=n.index;L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(o){i.lock(e),i.set(wh.KEYS.colResize,e);var c=t.getEventLeft(o),l=c.left,s=c.ci,f=l-r.getWidth(s)+r.min,h=n.eventXy(o).x;L.mouseMoveUp(document,(function(e){var o=n.eventXy(e);h=o.x,h-=t.width/2,h=Math.ceil(S.minIf(h,f)),t.css("left","".concat(h,"px")),t.lineEl.css("height","".concat(n.visualHeight(),"px")),t.lineEl.show()}),(function(o){i.free(e),t.lineEl.hide(),t.css("left","".concat(h,"px")),n.eventXy(o).y<=0&&t.hide();var c=h-(l-r.getWidth(s))+t.width;u.begin(),a.setWidth(s,c),u.end(),n.resize()}))})),L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){i.free(e)})),L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){i.lock(e),i.set(wh.KEYS.colResize,e)})),L.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(e){var o=t.getEventLeft(e),i=o.left,c=o.ci,u=i-r.getWidth(c)+r.min,a=n.visualWidth(),f=l.getFixedView();i>a&&(i=a),-1===i||u>a||-1===c?t.hide():(t.show(),c===f.eci?t.css("left","".concat(i-t.width-kg.WIDTH/2,"px")):t.css("left","".concat(i-t.width,"px")),t.hoverEl.css("width","".concat(t.width,"px")),t.hoverEl.css("height","".concat(s.getHeight(),"px")))})),L.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){t.hide()})),L.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var e=c.activate.target;e!==n&&e!==t&&t.hide()}))}},{key:"getEventLeft",value:function(t){var e=this.table,n=e.cols,o=e.xFixedView,r=e.xFixedMeasure,i=e.index,c=e.eventXy(t),l=c.x,u=c.y,a=e.getRiCiByXy(l,u),s=a.ri,f=a.ci,h={ci:f,left:-1};if(-1!==s)return h;var p=r.getWidth(),y=i.getWidth(),b=o.getFixedView(),d=e.getScrollView();return o.hasFixedLeft()?f>b.eci?h.left=y+p+n.sectionSumWidth(d.sci,f):h.left=y+n.sectionSumWidth(b.sci,f):h.left=y+n.sectionSumWidth(d.sci,f),h}},{key:"destroy",value:function(){Rg(Lg(e.prototype),"destroy",this).call(this),this.unbind()}}])&&jg(n.prototype,i),c&&jg(n,c),e}(B);function Ig(t){return(Ig="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vg(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Dg(t,e){return!e||"object"!==Ig(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mg(t,e,n){return(Mg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Hg(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Hg(t){return(Hg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fg(t,e){return(Fg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bg=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=Dg(this,Hg(e).call(this,"".concat(r,"-table-row-fixed-bar")));var o=t.xFixedView.getFixedView(),i=k("div","".concat(r,"-table-row-fixed-block"));return n.table=t,n.fxSri=o.sri,n.fxEri=o.eri,n.block=i,n.children(n.block),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fg(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){var t=this.table;L.unbind(t)}},{key:"bind",value:function(){var t=this,n=this.table,r=n.mousePointer,i=n.dropRowFixed,c=n.xFixedView,l=!0;L.bind(n,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.setSize()})),L.bind(n,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.setSize()})),L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){t.setActive(!0),r.lock(e),r.set(wh.KEYS.grab,e)})),L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){l&&(t.setActive(!1),r.free(e))})),L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(o){i.show(),t.setActive(!0);var u=n.getScrollView(),a=c.getFixedView();t.fxSri=a.sri,t.fxEri=a.eri,r.lock(e),r.set(wh.KEYS.grab,e);var s=n.eventXy(o,n).y;i.offset({top:s}),l=!1,c.hasFixedTop()&&(n.scroll.y=0,n.scroll.ri=t.fxEri+1,n.resize()),L.mouseMoveUp(document,(function(e){var o=n.eventXy(e,n),r=o.x,c=o.y;i.offset({top:c});var l=n.getRiCiByXy(r,c).ri;l<u.eri-2&&(t.fxEri=l,t.setSize())}),(function(){t.setActive(!1),r.free(e),i.hide(),n.setFixedRow(t.fxEri),l=!0}))}))}},{key:"setActive",value:function(t){t?(this.addClass("active"),this.block.addClass("active")):(this.removeClass("active"),this.block.removeClass("active"))}},{key:"onAttach",value:function(){var t=this.table;this.setSize(),this.bind(),t.focus.register({target:this,stop:!1})}},{key:"setSize",value:function(){var t=this.table,n=this.block,o=this.fxSri,r=this.fxEri,i=t.rows,c=e.HEIGHT,l=r>-1?t.visualWidth():t.getIndexWidth(),u=r>-1?c/2:c,a=i.sectionSumHeight(o,r)+t.getIndexHeight()-u;n.offset({width:t.getIndexWidth(),height:c}),this.offset({height:c,width:l,left:0,top:a})}},{key:"destroy",value:function(){Mg(Hg(e.prototype),"destroy",this).call(this),this.unbind()}}])&&Vg(n.prototype,i),c&&Vg(n,c),e}(B);function Wg(t){return(Wg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yg(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ug(t,e){return!e||"object"!==Wg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zg(t,e,n){return(zg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Gg(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Gg(t){return(Gg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xg(t,e){return(Xg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Bg.HEIGHT=6;var Zg=function(t){function e(t){var n,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{height:5};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Ug(this,Gg(e).call(this,"".concat(r,"-re-sizer-vertical")))).table=t,o.options=i,o.height=i.height,o.hoverEl=k("div","".concat(r,"-re-sizer-hover")),o.lineEl=k("div","".concat(r,"-re-sizer-line")),(n=o).children.apply(n,[o.hoverEl,o.lineEl]),o}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xg(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind(),this.table.focus.register({target:this})}},{key:"unbind",value:function(){var t=this.table;L.unbind(t)}},{key:"bind",value:function(){var t=this,n=this.table,r=n.rows,i=n.mousePointer,c=n.focus,l=n.xFixedView,u=n.tableDataSnapshot,a=u.rowsDataProxy,s=n.index;L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(o){i.lock(e),i.set(wh.KEYS.rowResize,e);var c=t.getEventTop(o),l=c.top,s=c.ri,f=l-r.getHeight(s)+r.min,h=n.eventXy(o).y;L.mouseMoveUp(document,(function(e){var o=n.eventXy(e);h=o.y,h-=t.height/2,h=Math.ceil(S.minIf(h,f)),t.css("top","".concat(h,"px")),t.lineEl.css("width","".concat(n.visualWidth(),"px")),t.lineEl.show()}),(function(o){i.free(e),t.lineEl.hide(),t.css("top","".concat(h,"px")),n.eventXy(o).x<=0&&t.hide();var c=h-(l-r.getHeight(s))+t.height;u.begin(),a.setHeight(s,c),u.end(),n.resize()}))})),L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){i.free(e)})),L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){i.lock(e),i.set(wh.KEYS.rowResize,e)})),L.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(e){var o=t.getEventTop(e),i=o.top,c=o.ri,u=i-r.getHeight(c)+r.min,a=n.visualHeight(),f=l.getFixedView();i>a&&(i=a),-1===i||u>a||-1===c?t.hide():(t.show(),c===f.eri?t.css("top","".concat(i-t.height-Bg.HEIGHT/2,"px")):t.css("top","".concat(i-t.height,"px")),t.hoverEl.css("width","".concat(s.getWidth(),"px")),t.hoverEl.css("height","".concat(t.height,"px")))})),L.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){t.hide()})),L.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var e=c.activate.target;e!==n&&e!==t&&t.hide()}))}},{key:"getEventTop",value:function(t){var e=this.table,n=e.rows,o=e.xFixedView,r=e.xFixedMeasure,i=e.index,c=e.eventXy(t),l=c.x,u=c.y,a=e.getRiCiByXy(l,u),s=a.ri,f={ri:s,top:-1};if(-1!==a.ci)return f;var h=r.getHeight(),p=i.getHeight(),y=o.getFixedView(),b=e.getScrollView();return o.hasFixedTop()?s>y.eri?f.top=p+h+n.sectionSumHeight(b.sri,s):f.top=p+n.sectionSumHeight(y.sri,s):f.top=p+n.sectionSumHeight(b.sri,s),f}},{key:"destroy",value:function(){zg(Gg(e.prototype),"destroy",this).call(this),this.unbind()}}])&&Yg(n.prototype,i),c&&Yg(n,c),e}(B);function Kg(t){return(Kg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $g(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function qg(t,e){return!e||"object"!==Kg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qg(t,e,n){return(Qg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Jg(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Jg(t){return(Jg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tw(t,e){return(tw=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ew=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=qg(this,Jg(e).call(this,"".concat(r,"-table-x-height-light")))).table=t,n.width=-1,n.left=-1,n.setSize(),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tw(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind(),this.hide()}},{key:"unbind",value:function(){var t=this.table;L.unbind(t)}},{key:"bind",value:function(){var t=this,e=this.table;L.bind(e,o.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(){t.offsetHandle()})),L.bind(e,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.offsetHandle()})),L.bind(e,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.offsetHandle()})),L.bind(e,o.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.offsetHandle()})),L.bind(e,o.TABLE_EVENT_TYPE.FIXED_CHANGE,(function(){t.offsetHandle()}))}},{key:"offsetHandle",value:function(){var t=this.table;if(t.xScreen.findType(kh).selectRange){var e=this.getLeft()+t.getIndexWidth(),n=this.getWidth();e===this.left&&n===this.width||(this.show(),this.offset({top:0,left:e,width:n,height:t.getIndexHeight()})),this.left=e,this.width=n}}},{key:"setSize",value:function(){var t=this.table;this.css("height","".concat(t.getIndexHeight(),"px"))}},{key:"getLeft",value:function(){var t=this.table,e=t.xScreen,n=t.rows,o=t.xFixedView,r=t.cols,i=e.findType(kh),c=i.selectRange,l=i.getOverGo(c),u=o.getFixedView(),a=t.getScrollView();switch(a.sri=0,a.eri=n.length-1,u.sri=0,u.eri=n.length-1,l){case rh.BRL:case rh.LTL:case rh.ALL:case rh.LT:case rh.LTT:case rh.L:return r.sectionSumWidth(u.sci,c.sci-1);case rh.BR:case rh.T:case rh.BRT:var s=a.coincide(c),f=r.sectionSumWidth(a.sci,s.sci-1);return r.sectionSumWidth(u.sci,u.eci)+f}return 0}},{key:"getWidth",value:function(){var t=this.table,e=t.xScreen,n=t.rows,o=t.xFixedView,r=t.cols,i=e.findType(kh),c=i.selectRange,l=o.getFixedView(),u=t.getScrollView(),a=i.getOverGo(c);switch(u.sri=0,u.eri=n.length-1,l.sri=0,l.eri=n.length-1,a){case rh.LT:case rh.L:case rh.LTL:return r.rectRangeSumWidth(c);case rh.BR:case rh.T:case rh.BRT:return r.rectRangeSumWidth(u.coincide(c));case rh.BRL:case rh.LTT:case rh.ALL:return r.rectRangeSumWidth(u.coincide(c))+r.rectRangeSumWidth(l.coincide(c))}return 0}},{key:"destroy",value:function(){Qg(Jg(e.prototype),"destroy",this).call(this),this.unbind()}}])&&$g(n.prototype,i),c&&$g(n,c),e}(B);function nw(t){return(nw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ow(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function rw(t,e){return!e||"object"!==nw(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function iw(t,e,n){return(iw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=cw(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function cw(t){return(cw=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lw(t,e){return(lw=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var uw=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=rw(this,cw(e).call(this,"".concat(r,"-table-y-height-light")))).table=t,n.height=-1,n.top=-1,n.setSize(),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lw(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind(),this.hide()}},{key:"unbind",value:function(){var t=this.table;L.unbind(t)}},{key:"bind",value:function(){var t=this,e=this.table;L.bind(e,o.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(){t.offsetHandle()})),L.bind(e,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.offsetHandle()})),L.bind(e,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.offsetHandle()})),L.bind(e,o.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.offsetHandle()})),L.bind(e,o.TABLE_EVENT_TYPE.FIXED_CHANGE,(function(){t.offsetHandle()}))}},{key:"offsetHandle",value:function(){var t=this.table;if(t.xScreen.findType(kh).selectRange){var e=this.getTop()+t.getIndexHeight(),n=this.getHeight();e===this.top&&n===this.height||(this.show(),this.offset({left:0,top:e,height:n,width:t.getIndexWidth()})),this.top=e,this.height=n}}},{key:"setSize",value:function(){var t=this.table;this.css("width","".concat(t.getIndexWidth(),"px"))}},{key:"getTop",value:function(){var t=this.table,e=t.xScreen,n=t.rows,o=t.xFixedView,r=t.cols,i=e.findType(kh),c=i.selectRange,l=i.getOverGo(c),u=o.getFixedView(),a=t.getScrollView();switch(a.sci=0,a.eci=r.length-1,u.sci=0,u.eci=r.length-1,l){case rh.BRT:case rh.LTL:case rh.ALL:case rh.LT:case rh.LTT:case rh.T:return n.sectionSumHeight(u.sri,c.sri-1);case rh.BR:case rh.L:case rh.BRL:var s=a.coincide(c),f=n.sectionSumHeight(a.sri,s.sri-1);return n.sectionSumHeight(u.sri,u.eri)+f}return 0}},{key:"getHeight",value:function(){var t=this.table,e=t.xScreen,n=t.rows,o=t.xFixedView,r=t.cols,i=e.findType(kh),c=i.selectRange,l=o.getFixedView(),u=t.getScrollView(),a=i.getOverGo(c);switch(u.sci=0,u.eci=r.length-1,l.sci=0,l.eci=r.length-1,a){case rh.LT:case rh.T:case rh.LTT:return n.rectRangeSumHeight(c);case rh.BR:case rh.L:case rh.BRL:return n.rectRangeSumHeight(u.coincide(c));case rh.BRT:case rh.LTL:case rh.ALL:return n.rectRangeSumHeight(u.coincide(c))+n.rectRangeSumHeight(l.coincide(c))}return 0}},{key:"destroy",value:function(){iw(cw(e.prototype),"destroy",this).call(this),this.unbind()}}])&&ow(n.prototype,i),c&&ow(n,c),e}(B);function aw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var sw=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.pool=[],this.activate={},this.xTableFocusDownHandle=function(){n.activate={}},this.bind()}var e,n,r;return e=t,(n=[{key:"remove",value:function(t){if(!(t instanceof x))throw new TypeError(" error type not Element ");for(var e=[],n=0;n<this.pool.length;n+=1){var o=this.pool[n];o.target.el!==t.el&&e.push(o)}this.pool=e}},{key:"unbind",value:function(){L.unbind(document,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,this.xTableFocusDownHandle,!0)}},{key:"bind",value:function(){L.bind(document,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,this.xTableFocusDownHandle,!0)}},{key:"add",value:function(t){return t.target instanceof x&&!this.findByNode(t.target)&&(this.pool.push(t),t.focus&&(this.activate=this.pool[this.pool.length-1]),!0)}},{key:"register",value:function(t){var e=this,n=t.attr,r=void 0===n?{}:n,i=t.target,c=t.stop,l=void 0!==c&&c,u=t.focus,a=void 0!==u&&u;this.add({attr:r,target:i,focus:a,stop:l})&&L.bind(i,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){var n=e.findByChild(t.target);n?(e.activate=n,l&&t.stopPropagation()):e.activate=null}))}},{key:"findByNode",value:function(t){for(var e=0;e<this.pool.length;e+=1){var n=this.pool[e];if(n.target.el===t)return n}return null}},{key:"findByChild",value:function(t){for(var e=this.table.el.parentNode;t!==e;){var n=this.findByNode(t);if(n)return n;t=t.parentNode}return null}}])&&aw(e.prototype,n),r&&aw(e,r),t}();function fw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function hw(t,e,n){return e&&fw(t.prototype,e),n&&fw(t,n),t}var pw={CHANGE_ADD:Symbol("change_add"),CHANGE_NOT:Symbol("change_not"),STATIC:Symbol("static"),BOUND_OUT:Symbol("bound_out")},yw=function(){function t(e){var n=e.scroll,o=e.rows,r=e.cols,i=e.getHeight,c=void 0===i?function(){return 0}:i,l=e.getWidth,u=void 0===l?function(){return 0}:l;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scroll=n,this.rows=o,this.cols=r,this.getHeight=c,this.getWidth=u}return hw(t,null,[{key:"viewMode",value:function(t,e){return S.isUnDef(t)?pw.CHANGE_NOT:e.equals(t)?pw.STATIC:e.coincide(t).equals(xs.EMPTY)?pw.BOUND_OUT:e.within(t)?pw.CHANGE_NOT:pw.CHANGE_ADD}}]),hw(t,[{key:"getScrollView",value:function(){var t=this.rows,e=this.cols,n=this.scroll,o=this.getHeight,r=this.getWidth,i=n.ri,c=n.ci,l=0,u=0,a=[t.len,e.len],s=a[0],f=a[1];return vs.getInstance().setBegin(i).setEnd(t.len-1).setLoop((function(e){return u+=t.getHeight(e),s=e,u<o()})).execute(),Ss.getInstance().setBegin(c).setEnd(e.len-1).setLoop((function(t){return l+=e.getWidth(t),f=t,l<r()})).execute(),new xs(i,c,s,f)}}]),t}();function bw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var dw=function(){function t(e){var n=e.xTableScrollView,o=e.rows,r=e.cols,i=e.scroll;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.xTableScrollView=n,this.scroll=i,this.rows=o,this.cols=r,this.scrollView=null}var e,n,o;return e=t,(n=[{key:"reset",value:function(){this.scrollView=null}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.xTableScrollView,e=this.cols,n=this.rows,o=t.getScrollView();return o.w=e.rectRangeSumWidth(o),o.h=n.rectRangeSumHeight(o),this.scrollView=o,o.clone()}}])&&bw(e.prototype,n),o&&bw(e,o),t}();function vw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var gw=function(){function t(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).time,n=void 0===e?500:e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.handle=null,this.time=n}var e,n,o;return e=t,(n=[{key:"setTime",value:function(t){this.time=t}},{key:"action",value:function(t){clearTimeout(this.handle),this.handle=setTimeout((function(){t()}),this.time)}}])&&vw(e.prototype,n),o&&vw(e,o),t}();function ww(t){return(ww="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ow(t,e){return!e||"object"!==ww(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ew(t,e,n){return(Ew="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Sw(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Sw(t){return(Sw=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _w(t,e){return(_w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tw=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ow(this,Sw(e).call(this,"".concat(r,"-table-edit")))).table=t,n.cell=null,n.merge=null,n.select=null,n.throttle=new gw({time:100}),n.attr("contenteditable",!0),n.html(S.EMPTY),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_w(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind(),this.hide()}},{key:"editOffset",value:function(){var t=this.table,e=this.cell,n=t.xHeightLight,o=t.yHeightLight,r=e.fontAttr.align,i=n.getLeft()+t.getIndexWidth(),c=o.getTop()+t.getIndexHeight(),l=o.getHeight(),u=n.getWidth();switch(r){case ll.ALIGN.left:this.cssRemoveKeys("right");var a=t.visualHeight()-c,s=t.visualWidth()-i;this.css({left:"".concat(i,"px"),top:"".concat(c,"px"),"min-width":"".concat(hc.offsetToLineInside(Math.min(u,s)),"px"),"min-height":"".concat(hc.offsetToLineInside(Math.min(l,a)),"px"),"max-width":"".concat(hc.offsetToLineInside(s),"px"),"max-height":"".concat(hc.offsetToLineInside(a),"px")});break;case ll.ALIGN.center:this.cssRemoveKeys("right");var f=this.box(),h=t.visualHeight()-c;if(f.width>u){var p=2*(t.visualWidth()-(i+u))+u,y=i-(Math.min(f.width,p)/2-u/2);this.css({left:"".concat(y,"px"),top:"".concat(c,"px"),"min-width":"".concat(hc.offsetToLineInside(Math.min(u,p)),"px"),"min-height":"".concat(hc.offsetToLineInside(Math.min(l,h)),"px"),"max-width":"".concat(hc.offsetToLineInside(p),"px"),"max-height":"".concat(hc.offsetToLineInside(h),"px")})}else{var b=t.visualWidth()-i;this.css({left:"".concat(i,"px"),top:"".concat(c,"px"),"min-width":"".concat(hc.offsetToLineInside(Math.min(u,b)),"px"),"min-height":"".concat(hc.offsetToLineInside(Math.min(l,h)),"px"),"max-width":"".concat(hc.offsetToLineInside(b),"px"),"max-height":"".concat(hc.offsetToLineInside(h),"px")})}break;case ll.ALIGN.right:this.cssRemoveKeys("left");var d=i+u-t.getIndexWidth(),v=t.visualWidth()-(i+u),g=t.visualHeight()-c;this.css({right:"".concat(v,"px"),top:"".concat(c,"px"),"min-width":"".concat(hc.offsetToLineInside(Math.min(u,d)),"px"),"min-height":"".concat(hc.offsetToLineInside(Math.min(l,g)),"px"),"max-width":"".concat(hc.offsetToLineInside(d),"px"),"max-height":"".concat(hc.offsetToLineInside(g),"px")})}}},{key:"unbind",value:function(){var t=this.table,e=t.xScreen.findType(kh);L.bind(t),L.unbind([e.lt,e.t,e.l,e.br])}},{key:"bind",value:function(){var t=this,e=this.table,n=e.xScreen.findType(kh),r=e.getTableMerges();L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_WHEEL,(function(t){t.stopPropagation()})),L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){t.stopPropagation()})),L.bind(this,o.SYSTEM_EVENT_TYPE.INPUT,(function(){t.cell.fontAttr.align===ll.ALIGN.center&&t.editOffset()})),L.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.hideEdit()})),L.bind(e,o.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.hideEdit()})),L.mouseDoubleClick(e,(function(){var e=n.selectRange,o=e.sri,i=e.sci;e.multiple()&&!r.getFirstIncludes(o,i)||t.showEdit()}))}},{key:"showEdit",value:function(){var t=this,e=this.table,n=e.getTableMerges(),o=e.getTableCells(),r=e.getScrollView(),i=e.xScreen.findType(kh).selectRange;if(i&&r.intersects(i)){var c=i.sri,l=i.sci,u=n.getFirstIncludes(c,l),a=o.getCellOrNew(c,l);this.merge=u,this.cell=a,this.select=i,this.show(),S.isBlank(a.text)?this.html(S.EMPTY):this.html(a.text),this.attr("style",a.toCssStyle()),this.editOffset(),this.throttle.action((function(){S.keepLastIndex(t.el)}))}}},{key:"hideEdit",value:function(){var t=this.select,e=this.table,n=e.getTableCells(),o=e.tableDataSnapshot,r=o.cellDataProxy;if(t){var i=n.getCellOrNew(t.sri,t.sci).clone(),c=S.trim(this.text());this.hide(),i.text!==c&&(o.begin(),i.text=c,r.setCell(t.sri,t.sci,i),o.end(),e.render()),this.select=null}}},{key:"show",value:function(){return this.css({"min-width":"0px","min-height":"0px","max-width":"0px","max-height":"0px"}),Ew(Sw(e.prototype),"show",this).call(this)}},{key:"destroy",value:function(){Ew(Sw(e.prototype),"destroy",this).call(this),this.unbind()}}])&&mw(n.prototype,i),c&&mw(n,c),e}(B);function xw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var kw=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.solidLine=new vc(e,n)}var e,n,o;return e=t,(n=[{key:"horizonLine",value:function(t,e,n,o){this.solidLine.horizonLine(t,e,n,o)}},{key:"verticalLine",value:function(t,e,n,o){this.solidLine.verticalLine(t,e,n,o)}}])&&xw(e.prototype,n),o&&xw(e,o),t}();function Pw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var jw=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,o=[{key:"parserToDate",value:function(t,e){if(!t)return null;for(var n=new Date("1970/01/01 00:00:00"),o=[{reg:"y+"},{reg:"M+"},{reg:"d+"},{reg:"h+"},{reg:"m+"},{reg:"s+"},{reg:"S"}],r=n.getFullYear(),i=n.getMonth()+1,c=n.getDate(),l=n.getHours(),u=n.getMinutes(),a=n.getSeconds(),s=n.getMilliseconds(),f=1,h=0;h<e.length;h+=1)for(var p=e[h],y=0;y<o.length;y+=1){var b=o[y];if(b.reg[0]===p){b.index||(b.index=f,f+=1);break}}for(var d=0;d<o.length;d+=1){var v=o[d].reg,g=new RegExp("(".concat(v,")")).exec(e);if(g){var w=g[0],m="([0-9]{1,".concat(w.length,"})");e=e.replace(w,m)}}var O={},E=new RegExp(e).exec(t);if(!E)return null;for(var S=1;S<E.length;S+=1)O[S]=E[S];return o[0].index&&(r=O[o[0].index]),o[1].index&&(i=O[o[1].index]),o[2].index&&(c=O[o[2].index]),o[3].index&&(l=O[o[3].index]),o[4].index&&(u=O[o[4].index]),o[5].index&&(a=O[o[5].index]),o[6].index&&(s=O[o[6].index]),new Date(r,i-1,c,l,u,a,s)}},{key:"dateFormat",value:function(t,e){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()},o=/(y+)/.exec(t);if(o){var r=o[0],i=e.getFullYear().toString().substr(4-r.length);t=t.replace(r,i)}for(var c in n){var l=new RegExp("(".concat(c,")")).exec(t);if(l){var u=n[c].toString(),a=l[0],s=1===a.length?u:"00".concat(u).substr(u.length);t=t.replace(a,s)}}return t}}],(n=null)&&Pw(e.prototype,n),o&&Pw(e,o),t}();function Cw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Rw(t){var e=jw.parserToDate(t,"yyyy/MM/dd hh:mm:ss");return e||((e=jw.parserToDate(t,"yyyy/MM/dd"))?e:(e=jw.parserToDate(t,"hh:mm:ss"))?e:(e=jw.parserToDate(t,"MM月dd日"))?e:(e=jw.parserToDate(t,"yyyy年MM月"))?e:(e=jw.parserToDate(t,"yyyy年MM月dd日"))||null)}var Lw=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,(n=[{key:"default",value:function(t){return t}},{key:"text",value:function(t){return t}},{key:"number",value:function(t){if(S.isNumber(t)){if(-1!==t.toString().indexOf(".")){var e=t.toString().lastIndexOf(".")+1;return t.toString().substring(0,e+2)}return"".concat(t,".00")}return t}},{key:"percentage",value:function(t){return S.isNumber(t)?"".concat(t,"%"):t}},{key:"fraction",value:function(t){if(S.isFraction(t)){var e=t.split("/")[0],n=t.split("/")[1];return S.parseInt(e)/S.parseInt(n)}return t}},{key:"ENotation",value:function(t){return S.isNumber(t)?S.parseFloat(t).toExponential(2):t}},{key:"rmb",value:function(t){return S.isNumber(t)?"￥".concat(t):t}},{key:"hk",value:function(t){return S.isNumber(t)?"HK".concat(t):t}},{key:"dollar",value:function(t){return S.isNumber(t)?"$".concat(t):t}},{key:"date1",value:function(t){var e=Rw(t);return e?jw.dateFormat("yyyy/MM/dd",e):t}},{key:"date2",value:function(t){var e=Rw(t);return e?jw.dateFormat("MM月dd日",e):t}},{key:"date3",value:function(t){var e=Rw(t);return e?jw.dateFormat("yyyy年MM月",e):t}},{key:"date4",value:function(t){var e=Rw(t);return e?jw.dateFormat("yyyy年MM月dd日",e):t}},{key:"date5",value:function(t){var e=Rw(t);return e?jw.dateFormat("yyyy/MM/dd hh:mm:ss",e):t}},{key:"time",value:function(t){var e=Rw(t);return e?jw.dateFormat("hh:mm:ss",e):t}}])&&Cw(e.prototype,n),o&&Cw(e,o),t}()),Aw=function(t,e){return Lw[t](e)};function Nw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Iw=function(){function t(e){var n=e.rect,o=e.draw;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.draw=o,this.rect=n,this.backgroundColor=null}var e,n,o;return e=t,(n=[{key:"drawBackgroundColor",value:function(t){if(t&&(this.backgroundColor=t,t)){var e=this.draw,n=this.rect;e.attr({fillStyle:t}),e.fillRect(n.x,n.y,n.width,n.height)}}}])&&Nw(e.prototype,n),o&&Nw(e,o),t}();function Vw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Dw=function(){function t(e){var n=e.merges,o=e.cols,r=e.rows,i=e.data,c=void 0===i?[]:i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.merges=n,this.rows=r,this.cols=o,this.data=c}var e,n,o;return e=t,(n=[{key:"emptyRectRange",value:function(t){var e=this,n=!0;return t.each((function(t,o){var r=e.getCell(t,o);return!(S.isNotEmptyObject(r)&&!S.isBlank(r.text)&&(n=!1,1))})),n}},{key:"setCellOrNew",value:function(t,e,n){S.isUnDef(this.data[t])&&(this.data[t]=[]),this.data[t][e]=n}},{key:"setCell",value:function(t,e,n){var o=this.data[t];o&&o[e]&&(o[e]=n)}},{key:"getCellOrNew",value:function(t,e){return S.isUnDef(this.data[t])&&(this.data[t]=[]),S.isUnDef(this.data[t][e])&&(this.data[t][e]={text:""}),this.getCell(t,e)}},{key:"getCellOrMergeCell",value:function(t,e){var n=this.merges.getFirstIncludes(t,e);return n?this.getCell(n.sri,n.sci):this.getCell(t,e)}},{key:"getCell",value:function(t,e){var n=this.data[t];if(n&&n[e]){var o=n[e];return o instanceof Fa?n[e]:(S.isString(o)&&(o={text:o}),n[e]=new Fa(o),n[e])}return null}},{key:"getCellBoundOutSize",value:function(t,e){var n=this.cols,o=this.getCell(t,e);if(o){var r=n.getWidth(e),i=o.contentWidth;switch(o.fontAttr.align){case ll.ALIGN.right:case ll.ALIGN.left:return i;case ll.ALIGN.center:return r+(i-r)/2;default:return 0}}return 0}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.data=t,this}}])&&Vw(e.prototype,n),o&&Vw(e,o),t}();function Mw(t){return(Mw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Fw(t,e){return!e||"object"!==Mw(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bw(t){return(Bw=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ww(t,e){return(Ww=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yw=function(t){function e(t){var n,o=t.text,r=t.rect,i=t.dw,c=t.attr;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Fw(this,Bw(e).call(this,{text:o,rect:r,dw:i,attr:c}))).attr=S.mergeDeep({lineHeight:8,spacing:2},n.attr),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ww(t,e)}(e,t),n=e,(o=[{key:"drawLine",value:function(t,e,n,o,r,i){var c=this.dw,l=this.attr.size,u=[0,0],a=[0,0];if("strike"===t){switch(r){case ll.ALIGN.center:case ll.ALIGN.left:case ll.ALIGN.right:u[0]=e,a[0]=e+o}switch(i){case ll.VERTICAL_ALIGN.center:case ll.VERTICAL_ALIGN.top:case ll.VERTICAL_ALIGN.bottom:u[1]=n+l/2,a[1]=n+l/2}}if("underline"===t){switch(r){case ll.ALIGN.center:case ll.ALIGN.left:case ll.ALIGN.right:u[0]=e,a[0]=e+o}switch(i){case ll.VERTICAL_ALIGN.center:case ll.VERTICAL_ALIGN.top:case ll.VERTICAL_ALIGN.bottom:u[1]=n+l,a[1]=n+l}}c.line(u,a)}},{key:"draw",value:function(){var t=this.text;if(this.isBlank(t))return 0;var e=this.dw,n=this.attr,o=n.textWrap;if(e.attr({textAlign:ll.ALIGN.left,textBaseline:ll.VERTICAL_ALIGN.top,font:"".concat(n.italic?"italic":""," ").concat(n.bold?"bold":""," ").concat(n.size,"px ").concat(n.name),fillStyle:n.color,strokeStyle:n.color}),this.hasBreak(t))return this.wrapTextFont();switch(o){case ll.TEXT_WRAP.OVER_FLOW:return this.overflowFont();case ll.TEXT_WRAP.TRUNCATE:return this.truncateFont();case ll.TEXT_WRAP.WORD_WRAP:return this.wrapTextFont()}return 0}},{key:"truncateFont",value:function(){for(var t=this.text,e=this.dw,n=this.attr,o=this.rect,r=o.width,i=o.height,c=n.underline,l=n.strikethrough,u=n.align,a=n.verticalAlign,s=n.size,f=n.spacing,h=this.getVerticalAlignPadding(),p=this.getAlignPadding(),y=[],b=t.length,d=0,v=0,g=0;g<b;){var w=t.charAt(g),m=this.textWidth(w);y.push({len:m,text:w,tx:s/2-m/2,ty:v}),v+=s+f,g+=1}v>0&&(v-=f),v>d&&(d=v);var O=o.x,E=o.y;switch(u){case ll.ALIGN.left:O+=p;break;case ll.ALIGN.center:O+=r/2-s/2;break;case ll.ALIGN.right:O+=r-s-p}switch(a){case ll.VERTICAL_ALIGN.top:E+=h;break;case ll.VERTICAL_ALIGN.center:E+=i/2-d/2;break;case ll.VERTICAL_ALIGN.bottom:E+=i-d-h}if(d+h>i||s+p>r){var S=new Ia({draw:e,rect:o});S.open();for(var _=y.length,T=0;T<_;){var x=y[T];x.tx+=O,x.ty+=E,e.fillText(x.text,x.tx,x.ty),c&&this.drawLine("underline",x.tx,x.ty,x.len,u,a),l&&this.drawLine("strike",x.tx,x.ty,x.len,u,a),T+=1}S.close()}else for(var k=y.length,P=0;P<k;){var j=y[P];j.tx+=O,j.ty+=E,e.fillText(j.text,j.tx,j.ty),c&&this.drawLine("underline",j.tx,j.ty,j.len,u,a),l&&this.drawLine("strike",j.tx,j.ty,j.len,u,a),P+=1}return 0}},{key:"overflowFont",value:function(){return this.truncateFont()}},{key:"wrapTextFont",value:function(){for(var t=this.text,e=this.dw,n=this.attr,o=this.rect,r=o.width,i=o.height,c=n.size,l=n.spacing,u=n.verticalAlign,a=n.underline,s=n.strikethrough,f=n.align,h=n.lineHeight,p=this.getVerticalAlignPadding(),y=this.getAlignPadding(),b=this.textBreak(t),d=[],v=i-2*p,g=b.length,w=0,m=0,O=0;O<g;){for(var E=b[O],S=E.length,_=0,T=0;T<S;){var x=E.charAt(T),k=this.textWidth(x),P={len:k,text:x,tx:m+(c/2-k/2),ty:_};d.push(P),_+c>v&&(_>w&&(w=_-l),m+=c+h,_=0,P.tx=m+(c/2-k/2),P.ty=_),_+=c+l,T+=1}_>w&&(w=_-l),m+=c,O+=1}var j=o.x,C=o.y;switch(f){case ll.ALIGN.left:j+=y;break;case ll.ALIGN.center:j+=r/2-m/2;break;case ll.ALIGN.right:j+=r-m-y}switch(u){case ll.VERTICAL_ALIGN.top:C+=p;break;case ll.VERTICAL_ALIGN.center:C+=i/2-w/2;break;case ll.VERTICAL_ALIGN.bottom:C+=i-w-p}if(d.length*c+y>r){var R=d.length,L=new Ia({draw:e,rect:o});L.open();for(var A=0;A<R;){var N=d[A];N.tx+=j,N.ty+=C,e.fillText(N.text,N.tx,N.ty),a&&this.drawLine("underline",N.tx,N.ty,N.len,f,u),s&&this.drawLine("strike",N.tx,N.ty,N.len,f,u),A+=1}L.close()}else for(var I=d.length,V=0;V<I;){var D=d[V];D.tx+=j,D.ty+=C,e.fillText(D.text,D.tx,D.ty),a&&this.drawLine("underline",D.tx,D.ty,D.len,f,u),s&&this.drawLine("strike",D.tx,D.ty,D.len,f,u),V+=1}return 0}}])&&Hw(n.prototype,o),r&&Hw(n,r),e}(ll);function Uw(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Gw(t,e,n){return e&&zw(t.prototype,e),n&&zw(t,n),t}var Xw=function(){function t(){Uw(this,t)}return Gw(t,null,[{key:"inverse",value:function(t){var e=t.tilt,n=t.angle;return Math.abs(e*Math.sin(hc.radian(n)))}},{key:"tilt",value:function(t){var e=t.inverse,n=t.angle;return Math.abs(e/Math.sin(hc.radian(n)))}}]),t}(),Zw=function(){function t(){Uw(this,t)}return Gw(t,null,[{key:"nearby",value:function(t){var e=t.tilt,n=t.angle;return Math.abs(e*Math.cos(hc.radian(n)))}},{key:"tilt",value:function(t){var e=t.nearby,n=t.angle;return Math.abs(e/Math.cos(hc.radian(n)))}}]),t}();function Kw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var $w={TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right",MIDDLE_LEFT:"middle-left",MIDDLE_CENTER:"middle-center",MIDDLE_RIGHT:"middle-right",BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right"},qw=function(){function t(e){var n=e.angle,o=e.dw,r=e.origin,i=void 0===r?$w.MIDDLE_CENTER:r,c=e.rect,l=void 0===c?new Ra({x:0,y:0,width:0,height:0}):c;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dw=o,this.origin=i,this.rect=l,this.angle=n}var e,n,o;return e=t,(n=[{key:"rotate",value:function(){var t=this.origin,e=this.dw,n=this.rect,o=this.angle,r=n.x,i=n.y,c=n.width,l=n.height;e.save();var u=0,a=0;switch(t){case $w.TOP_LEFT:u=r,a=i;break;case $w.TOP_CENTER:u=r+c/2,a=i;break;case $w.TOP_RIGHT:u=r+c,a=i;break;case $w.MIDDLE_LEFT:u=r,a=i+l/2;break;case $w.MIDDLE_CENTER:u=r+c/2,a=i+l/2;break;case $w.MIDDLE_RIGHT:u=r+c,a=i+l/2;break;case $w.BOTTOM_LEFT:u=r,a=i+l;break;case $w.BOTTOM_CENTER:u=r+c/2,a=i+l;break;case $w.BOTTOM_RIGHT:u=r+c,a=i+l}var s=e.getOffsetX(),f=e.getOffsetY();return e.translate(u+s,a+f).rotate(o).translate(-(u+s),-(a+f)),this}},{key:"revert",value:function(){return this.dw.restore(),this}}])&&Kw(e.prototype,n),o&&Kw(e,o),t}();function Qw(t){return(Qw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function tm(t,e){return!e||"object"!==Qw(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function em(t){return(em=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nm(t,e){return(nm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var om=function(t){function e(t){var n,o=t.text,r=t.rect,i=t.dw,c=t.attr,l=t.overflow;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=tm(this,em(e).call(this,{text:o,rect:r,dw:i,attr:c}))).attr=S.mergeDeep({lineHeight:4},n.attr),n.overflow=l,n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nm(t,e)}(e,t),n=e,(o=[{key:"drawLine",value:function(t,e,n,o){var r=this.dw,i=this.attr.size,c=[0,0],l=[0,0];"strike"===t&&(c[0]=e,l[0]=e+o,c[1]=n+i/2,l[1]=n+i/2),"underline"===t&&(c[0]=e,l[0]=e+o,c[1]=n+i,l[1]=n+i),r.line(c,l)}},{key:"draw",value:function(){var t=this.text;if(this.isBlank(t))return 0;var e=this.dw,n=this.attr,o=n.textWrap;if(e.attr({textAlign:ll.ALIGN.left,textBaseline:ll.VERTICAL_ALIGN.top,font:"".concat(n.italic?"italic":""," ").concat(n.bold?"bold":""," ").concat(n.size,"px ").concat(n.name),fillStyle:n.color,strokeStyle:n.color}),this.hasBreak(t))return this.wrapTextFont();switch(o){case ll.TEXT_WRAP.OVER_FLOW:return this.overflowFont();case ll.TEXT_WRAP.TRUNCATE:return this.truncateFont();case ll.TEXT_WRAP.WORD_WRAP:return this.wrapTextFont()}return 0}},{key:"truncateFont",value:function(){return this.overflowFont()}},{key:"overflowFont",value:function(){var t=this.text,e=this.dw,n=this.attr,o=this.rect,r=this.overflow,i=o.x,c=o.y,l=o.width,u=o.height,a=n.underline,s=n.strikethrough,f=n.align,h=n.verticalAlign,p=n.size,y=this.getVerticalAlignPadding(),b=this.getAlignPadding(),d=n.angle;if(d<-90&&(d=-90),d>90&&(d=90),0===d)throw new TypeError("文字的角度必须是在90<0或者0>90之间!");var v=this.textWidth(t),g=Math.max(Zw.nearby({tilt:v,angle:d}),p),w=Xw.inverse({tilt:v,angle:d}),m=w-u,O=i,E=c;switch(f){case ll.ALIGN.left:O+=b;break;case ll.ALIGN.center:O+=l/2-g/2;break;case ll.ALIGN.right:O+=l-g-b}switch(h){case ll.VERTICAL_ALIGN.top:E+=y;break;case ll.VERTICAL_ALIGN.center:E+=u/2-w/2;break;case ll.VERTICAL_ALIGN.bottom:E+=u-w-y}var S=w+y>r.height,_=g+b>r.width;if(S||_){var T=new Ia({draw:e,rect:r}),x=new qw({dw:e,angle:d,rect:new Ra({x:O,y:E,width:g,height:w})});T.open(),x.rotate();var k=O+(g/2-v/2),P=E+(w/2-p/2);e.fillText(t,k,P),a&&this.drawLine("underline",k,P,v),s&&this.drawLine("strike",k,P,v),x.revert(),T.close()}else{var j=new qw({dw:e,angle:d,rect:new Ra({x:O,y:E,width:g,height:w})});j.rotate();var C=O+(g/2-v/2),R=E+(w/2-p/2);e.fillText(t,C,R),a&&this.drawLine("underline",C,R,v),s&&this.drawLine("strike",C,R,v),j.revert()}var L=g;if(m>0){var A=Xw.tilt({inverse:u,angle:d});L=Zw.nearby({tilt:A,angle:d})}return L+b}},{key:"wrapTextFont",value:function(){var t=this.text,e=this.dw,n=this.attr,o=this.rect,r=o.width,i=o.height,c=n.underline,l=n.strikethrough,u=n.align,a=n.verticalAlign,s=n.size,f=n.lineHeight,h=n.padding,p=this.getVerticalAlignPadding(),y=this.getAlignPadding(),b=n.angle;if(b<-90&&(b=-90),b>90&&(b=90),0===b)throw new TypeError("文字的角度必须是在90<0或者0>90之间!");if(b>0){for(var d=Xw.tilt({inverse:i-2*h,angle:b}),v=this.textBreak(t),g=[],w=v.length,m=0,O=0;m<w;){for(var E=v[m],S=E.length,_={str:"",len:0,start:0},T=0;T<S;){var x=_.str+E.charAt(T),k=this.textWidth(x);k>d?(0===_.len?(g.push({text:x,len:k,tx:0,ty:0}),k>O&&(O=k),T+=1):(g.push({text:_.str,len:_.len,tx:0,ty:0}),_.len>O&&(O=_.len)),_.str="",_.len=0,_.start=T):(_.str=x,_.len=k,T+=1)}_.len>0&&g.push({text:_.str,len:_.len,tx:0,ty:0}),_.len>O&&(O=_.len),m+=1}var P=g.length;if(P>1){for(var j=Xw.tilt({inverse:s+f,angle:b}),C=Math.max(Zw.nearby({tilt:O,angle:b}),s),R=Xw.inverse({tilt:O,angle:b}),L=C+(P-1)*j,A=0,N=0;N<P;)g[N].tx=A,A+=j,N+=1;var I=o.x,V=o.y;switch(u){case ll.ALIGN.left:I+=y;break;case ll.ALIGN.center:I+=r/2-L/2;break;case ll.ALIGN.right:I+=r-L-y}switch(a){case ll.VERTICAL_ALIGN.top:V+=p;break;case ll.VERTICAL_ALIGN.center:V+=i/2-R/2;break;case ll.VERTICAL_ALIGN.bottom:V+=i-R-p}for(var D=0;D<P;){var M=g[D],H=M.tx+I,F=M.ty+V,B=0,W=0;switch(u){case ll.ALIGN.center:B=H+C/2,W=F+R/2;break;case ll.ALIGN.left:var Y=M.len/2;B+=H+Math.max(Zw.nearby({tilt:Y,angle:b}),s),W+=F+R-Xw.inverse({tilt:Y,angle:b});break;case ll.ALIGN.right:var U=M.len/2;B+=H+C-Math.max(Zw.nearby({tilt:U,angle:b}),s),W+=F+Xw.inverse({tilt:U,angle:b})}var z=B-M.len/2,G=W-s/2,X=new qw({dw:e,angle:b,rect:new Ra({x:z,y:G,width:M.len,height:s})});X.rotate(),e.fillText(M.text,z,G),c&&this.drawLine("underline",z,G,M.len),l&&this.drawLine("strike",z,G,M.len),X.revert(),D+=1}return L+y}var Z=this.textWidth(t),K=Math.max(Zw.nearby({tilt:Z,angle:b}),s),$=Xw.inverse({tilt:Z,angle:b}),q=o.x,Q=o.y;switch(u){case ll.ALIGN.left:q+=y;break;case ll.ALIGN.center:q+=r/2-K/2;break;case ll.ALIGN.right:q+=r-K-y}switch(a){case ll.VERTICAL_ALIGN.top:Q+=p;break;case ll.VERTICAL_ALIGN.center:Q+=i/2-$/2;break;case ll.VERTICAL_ALIGN.bottom:Q+=i-$-p}var J=new qw({dw:e,angle:b,rect:new Ra({x:q,y:Q,width:K,height:$})});J.rotate();var tt=q+(K/2-Z/2),et=Q+($/2-s/2);return e.fillText(t,tt,et),c&&this.drawLine("underline",tt,et,Z),l&&this.drawLine("strike",tt,et,Z),J.revert(),K+y}for(var nt=Xw.tilt({inverse:i-2*h,angle:b}),ot=this.textBreak(t),rt=[],it=ot.length,ct=0,lt=0;ct<it;){for(var ut=ot[ct],at=ut.length,st={str:"",len:0,start:0},ft=0;ft<at;){var ht=st.str+ut.charAt(ft),pt=this.textWidth(ht);pt>nt?(0===st.len?(rt.push({text:ht,len:pt,tx:0,ty:0}),pt>lt&&(lt=pt),ft+=1):(rt.push({text:st.str,len:st.len,tx:0,ty:0}),st.len>lt&&(lt=st.len)),st.str="",st.len=0,st.start=ft):(st.str=ht,st.len=pt,ft+=1)}st.len>0&&rt.push({text:st.str,len:st.len,tx:0,ty:0}),st.len>lt&&(lt=st.len),ct+=1}var yt=rt.length;if(yt>1){for(var bt=Xw.tilt({inverse:s+f,angle:b}),dt=Math.max(Zw.nearby({tilt:lt,angle:b}),s),vt=Xw.inverse({tilt:lt,angle:b}),gt=dt+(yt-1)*bt,wt=0,mt=yt-1;mt>=0;)rt[mt].tx=wt,wt+=bt,mt-=1;var Ot=o.x,Et=o.y;switch(u){case ll.ALIGN.left:Ot+=y;break;case ll.ALIGN.center:Ot+=r/2-gt/2;break;case ll.ALIGN.right:Ot+=r-gt-y}switch(a){case ll.VERTICAL_ALIGN.top:Et+=p;break;case ll.VERTICAL_ALIGN.center:Et+=i/2-vt/2;break;case ll.VERTICAL_ALIGN.bottom:Et+=i-vt-p}for(var St=0;St<yt;){var _t=rt[St],Tt=_t.tx+Ot,xt=_t.ty+Et,kt=0,Pt=0;switch(u){case ll.ALIGN.center:kt=Tt+dt/2,Pt=xt+vt/2;break;case ll.ALIGN.left:var jt=_t.len/2;kt+=Tt+Math.max(Zw.nearby({tilt:jt,angle:b}),s),Pt+=xt+Xw.inverse({tilt:jt,angle:b});break;case ll.ALIGN.right:var Ct=_t.len/2;kt+=Tt+dt-Math.max(Zw.nearby({tilt:Ct,angle:b}),s),Pt+=xt+vt-Xw.inverse({tilt:Ct,angle:b})}var Rt=kt-_t.len/2,Lt=Pt-s/2,At=new qw({dw:e,angle:b,rect:new Ra({x:Rt,y:Lt,width:_t.len,height:s})});At.rotate(),e.fillText(_t.text,Rt,Lt),c&&this.drawLine("underline",Rt,Lt,_t.len),l&&this.drawLine("strike",Rt,Lt,_t.len),At.revert(),St+=1}return gt+y}var Nt=this.textWidth(t),It=Math.max(Zw.nearby({tilt:Nt,angle:b}),s),Vt=Xw.inverse({tilt:Nt,angle:b}),Dt=o.x,Mt=o.y;switch(u){case ll.ALIGN.left:Dt+=y;break;case ll.ALIGN.center:Dt+=r/2-It/2;break;case ll.ALIGN.right:Dt+=r-It-y}switch(a){case ll.VERTICAL_ALIGN.top:Mt+=p;break;case ll.VERTICAL_ALIGN.center:Mt+=i/2-Vt/2;break;case ll.VERTICAL_ALIGN.bottom:Mt+=i-Vt-p}var Ht=new qw({dw:e,angle:b,rect:new Ra({x:Dt,y:Mt,width:It,height:Vt})});Ht.rotate();var Ft=Dt+(It/2-Nt/2),Bt=Mt+(Vt/2-s/2);return e.fillText(t,Ft,Bt),c&&this.drawLine("underline",Ft,Bt,Nt),l&&this.drawLine("strike",Ft,Bt,Nt),Ht.revert(),It+y}}])&&Jw(n.prototype,o),r&&Jw(n,r),e}(ll);function rm(t){return(rm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function im(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function cm(t,e){return!e||"object"!==rm(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function lm(t){return(lm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function um(t,e){return(um=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function am(t){return(am="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sm(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function fm(t,e){return!e||"object"!==am(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hm(t){return(hm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pm(t,e){return(pm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ym=function(t){function e(t){var n,o=t.text,r=t.overflow,i=t.rect,c=t.dw,l=t.attr;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=fm(this,hm(e).call(this,{text:o,rect:i,dw:c,attr:l}))).overflow=r,n.attr=S.mergeDeep({lineHeight:4},n.attr),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pm(t,e)}(e,t),n=e,(o=[{key:"drawLine",value:function(t,e,n,o){var r=this.dw,i=this.attr,c=i.size,l=i.verticalAlign,u=i.align,a=[0,0],s=[0,0];if("strike"===t){switch(u){case ll.ALIGN.right:a[0]=e-o,s[0]=e;break;case ll.ALIGN.center:a[0]=e-o/2,s[0]=e+o/2;break;case ll.ALIGN.left:a[0]=e,s[0]=e+o}switch(l){case ll.VERTICAL_ALIGN.top:a[1]=n+c/2,s[1]=n+c/2;break;case ll.VERTICAL_ALIGN.center:a[1]=n,s[1]=n;break;case ll.VERTICAL_ALIGN.bottom:a[1]=n-c/2,s[1]=n-c/2}}if("underline"===t){switch(u){case ll.ALIGN.right:a[0]=e-o,s[0]=e;break;case ll.ALIGN.center:a[0]=e-o/2,s[0]=e+o/2;break;case ll.ALIGN.left:a[0]=e,s[0]=e+o}switch(l){case ll.VERTICAL_ALIGN.top:a[1]=n+c,s[1]=n+c;break;case ll.VERTICAL_ALIGN.center:a[1]=n+c/2,s[1]=n+c/2;break;case ll.VERTICAL_ALIGN.bottom:a[1]=n,s[1]=n}}r.line(a,s)}},{key:"draw",value:function(){var t=this.text;if(this.isBlank(t))return 0;var e=this.dw,n=this.attr,o=n.textWrap,r="".concat(n.italic?"italic":""," ").concat(n.bold?"bold":""," ").concat(n.size,"px ").concat(n.name).trim();if(e.attr({textAlign:n.align,textBaseline:n.verticalAlign,font:r,fillStyle:n.color,strokeStyle:n.color}),this.hasBreak(t))return this.wrapTextFont();switch(o){case ll.TEXT_WRAP.OVER_FLOW:return this.overflowFont();case ll.TEXT_WRAP.TRUNCATE:return this.truncateFont();case ll.TEXT_WRAP.WORD_WRAP:return this.wrapTextFont()}return 0}},{key:"truncateFont",value:function(){var t=this.dw,e=this.attr,n=this.rect,o=n.width,r=n.height,i=e.underline,c=e.strikethrough,l=e.align,u=e.verticalAlign,a=e.size,s=this.displayFont(),f=s.text,h=s.textWidth,p=this.getVerticalAlignPadding(),y=this.getAlignPadding(),b=n.x,d=n.y;switch(l){case ll.ALIGN.center:b+=o/2;break;case ll.ALIGN.left:b+=y;break;case ll.ALIGN.right:b+=o-y}switch(u){case ll.VERTICAL_ALIGN.top:d+=p;break;case ll.VERTICAL_ALIGN.center:d+=r/2;break;case ll.VERTICAL_ALIGN.bottom:d+=r-p}if(a+p>r||h+y>o){var v=new Ia({draw:t,rect:n});v.open(),t.fillText(f,b,d),i&&this.drawLine("underline",b,d,h),c&&this.drawLine("strike",b,d,h),v.close()}else t.fillText(f,b,d),i&&this.drawLine("underline",b,d,h),c&&this.drawLine("strike",b,d,h);return 0}},{key:"overflowFont",value:function(){var t=this.dw,e=this.attr,n=this.rect,o=this.overflow,r=this.text,i=n.width,c=n.height,l=e.underline,u=e.strikethrough,a=e.align,s=e.verticalAlign,f=e.size,h=this.textWidth(r),p=this.getVerticalAlignPadding(),y=this.getAlignPadding(),b=n.x,d=n.y;switch(a){case ll.ALIGN.left:b+=y;break;case ll.ALIGN.center:b+=i/2;break;case ll.ALIGN.right:b+=i-y}switch(s){case ll.VERTICAL_ALIGN.top:d+=p;break;case ll.VERTICAL_ALIGN.center:d+=c/2;break;case ll.VERTICAL_ALIGN.bottom:d+=c-p}var v=f+p>o.height,g=h+y>o.width,w=!1;if(a===ll.ALIGN.center){var m=h/2-i/2;m>0&&(o.x>n.x-m?w=!0:o.x+o.width<n.x+n.width+m&&(w=!0))}if(v||g||w){var O=new Ia({draw:t,rect:o});O.open(),t.fillText(r,b,d),l&&this.drawLine("underline",b,d,h),u&&this.drawLine("strike",b,d,h),O.close()}else t.fillText(r,b,d),l&&this.drawLine("underline",b,d,h),u&&this.drawLine("strike",b,d,h);return h+y}},{key:"wrapTextFont",value:function(){for(var t=this.text,e=this.dw,n=this.attr,o=this.rect,r=o.width,i=o.height,c=n.underline,l=n.strikethrough,u=n.align,a=n.verticalAlign,s=n.size,f=n.lineHeight,h=this.getVerticalAlignPadding(),p=this.getAlignPadding(),y=this.textBreak(t),b=[],d=r-2*p,v=y.length,g=0,w=0;g<v;){g>0&&(w+=s+f);for(var m=y[g],O=m.length,E=0,S={str:"",len:0,start:0};E<O;){var _=S.str+m.charAt(E),T=this.textWidth(_);T>d?(0===S.len?(b.push({text:_,len:T,tx:0,ty:w}),E+=1):b.push({text:S.str,len:S.len,tx:0,ty:w}),w+=s+f,S.str="",S.len=0,S.start=E):(S.str=_,S.len=T,E+=1)}S.len>0&&b.push({text:S.str,len:S.len,tx:0,ty:w}),g+=1}w>0&&(w-=f);var x=o.x,k=o.y;switch(u){case ll.ALIGN.left:x+=p;break;case ll.ALIGN.center:x+=r/2;break;case ll.ALIGN.right:x+=r-p}switch(a){case ll.VERTICAL_ALIGN.center:k+=i/2-w/2;break;case ll.VERTICAL_ALIGN.top:k+=h;break;case ll.VERTICAL_ALIGN.bottom:k+=i-w-h}if(b.length*(s+f)-f+h>i){var P=new Ia({draw:e,rect:o});P.open();for(var j=b.length,C=0;C<j;){var R=b[C];R.tx+=x,R.ty+=k,e.fillText(R.text,R.tx,R.ty),c&&this.drawLine("underline",R.tx,R.ty,R.len),l&&this.drawLine("strike",R.tx,R.ty,R.len),C+=1}P.close()}else for(var L=0,A=b.length;L<A;L+=1){var N=b[L];N.tx+=x,N.ty+=k,e.fillText(N.text,N.tx,N.ty),c&&this.drawLine("underline",N.tx,N.ty,N.len),l&&this.drawLine("strike",N.tx,N.ty,N.len)}return 0}}])&&sm(n.prototype,o),r&&sm(n,r),e}(function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),cm(this,lm(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&um(t,e)}(e,t),n=e,(o=[{key:"displayFont",value:function(){var t=this.attr,e=this.rect,n=t.align,o=e.width,r=this.text,i=r.length;switch(n){case ll.ALIGN.left:for(var c=S.EMPTY,l=0,u=0;u<i;){var a=c+r.charAt(u),s=this.textWidth(a);if(s>=o)break;c=a,l=s,u+=1}return{text:c,textWidth:l};case ll.ALIGN.center:var f=this.textWidth(r),h=o/2-f/2;if(h<0){for(var p=0,y=S.EMPTY;p<i;){var b=y+r.charAt(p);if(h+this.textWidth(b)>=0)break;y=b,p+=1}for(var d=p,v=S.EMPTY,g=0;d<i;){var w=v+r.charAt(d),m=this.textWidth(w);if(m>=o)break;v=w,g=m,d+=1}return{text:v,textWidth:g}}return{text:r,textWidth:f};case ll.ALIGN.right:for(var O=i-1,E=S.EMPTY,_=0;O>=0;){var T=r.charAt(O)+E,x=this.textWidth(T);if(x>=o)break;E=T,_=x,O-=1}return{text:E,textWidth:_}}return{text:S.EMPTY,textWidth:0}}}])&&im(n.prototype,o),r&&im(n,r),e}(ll));function bm(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var dm=function(){function t(e){var n=e.text,o=e.dw,r=e.rect,i=e.attr,c=e.overflow;switch(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.attr=S.mergeDeep({},{verticalAlign:ll.VERTICAL_ALIGN.center,direction:ll.TEXT_DIRECTION.HORIZONTAL,name:"Arial",size:14,color:"#000000",underline:!1,strikethrough:!1,bold:!1,italic:!1,textWrap:ll.TEXT_WRAP.TRUNCATE,align:ll.ALIGN.left,angle:0,padding:8},i),this.font=null,i.direction){case ll.TEXT_DIRECTION.ANGLE:this.font=new om({text:n,rect:r,dw:o,attr:this.attr,overflow:c});break;case ll.TEXT_DIRECTION.HORIZONTAL:this.font=new ym({text:n,rect:r,dw:o,attr:this.attr,overflow:c});break;case ll.TEXT_DIRECTION.VERTICAL:this.font=new Yw({text:n,rect:r,dw:o,attr:this.attr})}}var e,n,o;return e=t,(n=[{key:"draw",value:function(){return this.font.draw()}},{key:"setTextWrap",value:function(t){this.font.setTextWrap(t)}},{key:"setSize",value:function(t){this.font.setSize(t)}},{key:"setPadding",value:function(t){this.font.setPadding(t)}}])&&bm(e.prototype,n),o&&bm(e,o),t}();function vm(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gm(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function wm(t,e,n){return e&&gm(t.prototype,e),n&&gm(t,n),t}var mm=function(){function t(e){var n=e.scaleAdapter;vm(this,t),this.scaleAdapter=n,this.text=null,this.rect=null,this.attr=null,this.dw=null,this.overflow=null}return wm(t,[{key:"setText",value:function(t){this.text=t}},{key:"setRect",value:function(t){this.rect=t}},{key:"setAttr",value:function(t){this.attr=t}},{key:"setDraw",value:function(t){this.dw=t}},{key:"setOverFlow",value:function(t){this.overflow=t}},{key:"build",value:function(){var t=this.text,e=this.rect,n=this.attr,o=this.overflow,r=this.dw,i=this.scaleAdapter,c=new dm({text:t,dw:r,overflow:o,rect:e,attr:n}),l=hc.srcTransformStylePx(i.goto(n.size)),u=hc.srcTransformStylePx(i.goto(n.padding));return c.setSize(l),c.setPadding(u),c}}]),t}(),Om=function(){function t(e){var n=e.scaleAdapter,o=void 0===n?new sg:n;vm(this,t),this.scaleAdapter=o}return wm(t,[{key:"getBuilder",value:function(){var t=this.scaleAdapter;return new mm({scaleAdapter:t})}}]),t}();function Em(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Sm=function(){function t(e){var n=e.cells,o=e.merges,r=e.rows,i=e.cols,c=e.tableDataSnapshot,l=e.xTableAreaView;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tableDataSnapshot=c,this.xTableAreaView=l,this.cells=n,this.merges=o,this.rows=r,this.cols=i}var e,n,o;return e=t,(n=[{key:"getCellOverFlow",value:function(t,e,n,o){var r=n.x,i=n.y,c=n.height,l=o.fontAttr,u=l.direction;if(u===ll.TEXT_DIRECTION.HORIZONTAL){if(l.textWrap===ll.TEXT_WRAP.OVER_FLOW){var a=this.getHorizontalMaxWidth(t,e);return new Ra({x:r+a.offset,y:i,width:a.width,height:c})}}else if(u===ll.TEXT_DIRECTION.ANGLE)switch(l.textWrap){case ll.TEXT_WRAP.OVER_FLOW:case ll.TEXT_WRAP.TRUNCATE:var s=this.getAngleMaxWidth(t,e,n);return new Ra({x:r+s.offset,y:i,width:s.width,height:c})}return null}},{key:"getHorizontalMaxWidth",value:function(t,e){var n=this.cells,o=this.cols,r=this.merges,i=n.getCell(t,e).fontAttr.align,c=0,l=0;if(i===ll.ALIGN.left)Ss.getInstance().setBegin(e).setEnd(o.len).setLoop((function(i){var l=r.getFirstIncludes(t,i),u=n.getCell(t,i),a=S.isUnDef(u)||S.isBlank(u.text);return i===e?(c+=o.getWidth(i),!0):!(!a||!S.isUnDef(l)||(c+=o.getWidth(i),0))})).execute();else if(i===ll.ALIGN.center){var u=0,a=0;Ss.getInstance().setBegin(e+1).setEnd(o.len).setLoop((function(e){var i=r.getFirstIncludes(t,e),c=n.getCell(t,e);return!(!S.isUnDef(c)&&!S.isBlank(c.text)||!S.isUnDef(i)||(u+=o.getWidth(e),0))})).execute(),Ss.getInstance().setBegin(e-1).setEnd(0).setLoop((function(e){var i=r.getFirstIncludes(t,e),c=n.getCell(t,e);if((S.isUnDef(c)||S.isBlank(c.text))&&S.isUnDef(i)){var u=o.getWidth(e);return a+=u,l-=u,!0}return!1})).execute(),c=o.getWidth(e)+a+u}else i===ll.ALIGN.right&&Ss.getInstance().setBegin(e).setEnd(0).setLoop((function(i){var u=r.getFirstIncludes(t,i),a=n.getCell(t,i),s=S.isUnDef(a)||S.isBlank(a.text);if(i===e)return c+=o.getWidth(i),!0;if(s&&S.isUnDef(u)){var f=o.getWidth(i);return c+=f,l-=f,!0}return!1})).execute();return{width:c,offset:l}}},{key:"getAngleMaxWidth",value:function(t,e,n){var o=this.cells,r=this.cols,i=this.rows,c=this.merges.getFirstIncludes(t,e);if(c)return c;var l=o.getCell(t,e).fontAttr,u=l.angle,a=l.align,s=l.padding,f=i.getHeight(t),h=Xw.tilt({inverse:f,angle:u}),p=Zw.nearby({tilt:h,angle:u}),y=0,b=0;switch(a){case ll.ALIGN.left:p+=s,Ss.getInstance().setBegin(e).setEnd(r.len).setLoop((function(t){var e=r.getWidth(t);return p>(y+=e)})).execute();break;case ll.ALIGN.center:var d=(p-n.width)/2,v=0;Ss.getInstance().setBegin(e).setEnd(r.len).setLoop((function(t){var e=r.getWidth(t);return v+=e,d+n.width>v})).execute();var g=0;Ss.getInstance().setBegin(e).setEnd(0).setLoop((function(t){var e=r.getWidth(t);return g+=e,d+n.width>g})).execute(),b=-((y=v+g-n.width)/2-n.width/2);break;case ll.ALIGN.right:p+=s,Ss.getInstance().setBegin(e).setEnd(0).setLoop((function(t){var e=r.getWidth(t);return p>(y+=e)})).execute(),b=-(y-n.width)}return{width:y,offset:b}}}])&&Em(e.prototype,n),o&&Em(e,o),t}();function _m(t){return(_m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tm(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function xm(t,e){return!e||"object"!==_m(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function km(t){return(km=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pm(t,e){return(Pm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jm=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),xm(this,km(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pm(t,e)}(e,t),n=e,(o=[{key:"getCellByViewRange",value:function(t){var e=t.rectRange,n=t.callback,o=t.startX,r=void 0===o?0:o,i=t.startY,c=void 0===i?0:i,l=this.rows,u=this.cols,a=this.cells,s=e.sri,f=e.eri,h=e.sci,p=e.eci,y=c;vs.getInstance().setBegin(s).setEnd(f).setLoop((function(t){var e=l.getHeight(t),o=r;Ss.getInstance().setBegin(h).setEnd(p).setLoop((function(r){var i=a.getCell(t,r),c=u.getWidth(r);if(i){var l=new Ra({x:o,y:y,width:c,height:e});if(!1===n(t,r,i,l))return}o+=c})).execute(),y+=e})).execute()}},{key:"getCellOrNewCellByViewRange",value:function(t){var e=t.rectRange,n=t.callback,o=t.startX,r=void 0===o?0:o,i=t.startY,c=void 0===i?0:i,l=this.rows,u=this.cols,a=this.cells,s=e.sri,f=e.eri,h=e.sci,p=e.eci,y=c;vs.getInstance().setBegin(s).setEnd(f).setLoop((function(t){var e=l.getHeight(t),o=r;Ss.getInstance().setBegin(h).setEnd(p).setLoop((function(r){var i=a.getCellOrNew(t,r),c=u.getWidth(r),l=new Ra({x:o,y:y,width:c,height:e});!1!==n(t,r,i,l)&&(o+=c)})).execute(),y+=e})).execute()}},{key:"getMergeCellByViewRange",value:function(t){var e=t.rectRange,n=t.callback,o=t.startX,r=void 0===o?0:o,i=t.startY,c=void 0===i?0:i,l=this.rows,u=this.cols,a=this.cells,s=this.merges,f=e.sri,h=e.eri,p=e.sci,y=e.eci,b=[];vs.getInstance().setBegin(f).setEnd(h).setLoop((function(t){Ss.getInstance().setBegin(p).setEnd(y).setLoop((function(o){var i=s.getFirstIncludes(t,o);if(!S.isUnDef(i)&&!b.find((function(t){return t===i}))){var f=Math.min(e.sri,i.sri),h=Math.min(e.sci,i.sci),p=Math.max(e.sri,i.sri),y=Math.max(e.sci,i.sci);p-=1,y-=1;var d=u.sectionSumWidth(h,y),v=l.sectionSumHeight(f,p);d=e.sci>i.sci?-1*d:d,v=e.sri>i.sri?-1*v:v,d+=r,v+=c;var g=l.sectionSumHeight(i.sri,i.eri),w=u.sectionSumWidth(i.sci,i.eci),m=a.getCellOrNew(i.sri,i.sci),O=new Ra({x:d,y:v,width:w,height:g});n(O,m,i),b.push(i)}})).execute()})).execute()}},{key:"getCellSkipMergeCellByViewRange",value:function(t){var e=t.rectRange,n=t.callback,o=t.startX,r=void 0===o?0:o,i=t.startY,c=void 0===i?0:i,l=this.merges;this.getCellByViewRange({rectRange:e,callback:function(t,e,o,r,i){null===l.getFirstIncludes(t,e)&&n(t,e,o,r,i)},startX:r,startY:c})}}])&&Tm(n.prototype,o),r&&Tm(n,r),e}(Sm);function Cm(t){return(Cm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rm(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Lm(t,e){return!e||"object"!==Cm(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Am(t){return(Am=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nm(t,e){return(Nm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Im=3,Vm=1,Dm=2,Mm=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Lm(this,Am(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nm(t,e)}(e,t),n=e,(o=[{key:"getCellByViewRange",value:function(t){var e=this,n=t.reverseRows,o=void 0!==n&&n,r=t.reverseCols,i=void 0!==r&&r,c=t.rectRange,l=void 0===c?new xs(0,0,0,0,0,0):c,u=t.newRow,a=void 0===u?function(){}:u,s=t.newCol,f=void 0===s?function(){}:s,h=t.callback,p=void 0===h?function(){}:h,y=t.startX,b=void 0===y?0:y,d=t.startY,v=void 0===d?0:d,g=this.rows,w=this.cols,m=this.cells,O=l.sri,E=l.eri,S=l.sci,_=l.eci;if(o&&i){var T=v;vs.getInstance().setBegin(E).setEnd(O).setLoop((function(t){var n=g.getHeight(t),o=null,r=b;return a(t),T-=n,Ss.getInstance().setBegin(_).setEnd(S).setLoop((function(i){var c=w.getWidth(i),l=m.getCell(t,i);if(f(i),r-=c,l){var u=new Ra({x:r,y:T,width:c,height:n}),a=e.getCellOverFlow(t,i,u,l);if((o=p(t,i,l,u,a))===Vm)return!1}return!0})).execute(),o!==Dm})).execute()}else if(o){var x=v;vs.getInstance().setBegin(E).setEnd(O).setLoop((function(t){var n=g.getHeight(t),o=null,r=b;return a(t),x-=n,Ss.getInstance().setBegin(S).setEnd(_).setLoop((function(i){var c=w.getWidth(i),l=m.getCell(t,i);if(f(i),l){var u=new Ra({x:r,y:x,width:c,height:n}),a=e.getCellOverFlow(t,i,u,l);if((o=p(t,i,l,u,a))===Vm)return!1}return r+=c,!0})).execute(),o!==Dm})).execute()}else if(i){var k=v;vs.getInstance().setBegin(O).setEnd(E).setLoop((function(t){var n=g.getHeight(t),o=null,r=b;return a(t),Ss.getInstance().setBegin(_).setEnd(S).setLoop((function(i){var c=w.getWidth(i),l=m.getCell(t,i);if(f(i),r-=c,l){var u=new Ra({x:r,y:k,width:c,height:n}),a=e.getCellOverFlow(t,i,u,l);if((o=p(t,i,l,u,a))===Vm)return!1}return!0})).execute(),k+=n,o!==Dm})).execute()}else{var P=v;vs.getInstance().setBegin(O).setEnd(E).setLoop((function(t){var n=g.getHeight(t),o=null,r=b;return a(t),Ss.getInstance().setBegin(S).setEnd(_).setLoop((function(i){var c=w.getWidth(i),l=m.getCell(t,i);if(f(i),l){var u=new Ra({x:r,y:P,width:c,height:n}),a=e.getCellOverFlow(t,i,u,l);if((o=p(t,i,l,u,a))===Vm)return!1}return r+=c,!0})).execute(),P+=n,o!==Dm})).execute()}}},{key:"getMergeCellByViewRange",value:function(t){var e=t.rectRange,n=t.callback,o=t.startX,r=void 0===o?0:o,i=t.startY,c=void 0===i?0:i,l=this.rows,u=this.cols,a=this.cells,s=this.merges,f=e.sri,h=e.eri,p=e.sci,y=e.eci,b=[];vs.getInstance().setBegin(f).setEnd(h).setLoop((function(t){Ss.getInstance().setBegin(p).setEnd(y).setLoop((function(o){var i=s.getFirstIncludes(t,o);if(!S.isUnDef(i)&&!b.find((function(t){return t===i}))){var f=Math.min(e.sri,i.sri),h=Math.min(e.sci,i.sci),p=Math.max(e.sri,i.sri),y=Math.max(e.sci,i.sci);p-=1,y-=1;var d=u.sectionSumWidth(h,y),v=l.sectionSumHeight(f,p);d=e.sci>i.sci?-1*d:d,v=e.sri>i.sri?-1*v:v,d+=r,v+=c;var g=l.sectionSumHeight(i.sri,i.eri),w=u.sectionSumWidth(i.sci,i.eci),m=a.getCellOrNew(i.sri,i.sci),O=new Ra({x:d,y:v,width:w,height:g});n(O,m,i),b.push(i)}})).execute()})).execute()}},{key:"getCellSkipMergeCellByViewRange",value:function(t){var e=t.reverseRows,n=t.reverseCols,o=t.rectRange,r=t.newRow,i=t.newCol,c=t.callback,l=t.startX,u=t.startY,a=this.merges;this.getCellByViewRange({reverseRows:e,reverseCols:n,rectRange:o,newRow:r,newCol:i,callback:function(t,e,n,o,r){null===a.getFirstIncludes(t,e)&&c(t,e,n,o,r)},startX:l,startY:u})}}])&&Rm(n.prototype,o),r&&Rm(n,r),e}(Sm);function Hm(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Fm=function(){function t(e){var n=e.merges,o=void 0===n?[]:n,r=e.cols,i=e.rows;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rows=i,this.cols=r,this.data=o.map((function(t){return xs.valueOf(t)})),this.index=new Array(i.len*r.len)}var e,n,o;return e=t,(n=[{key:"getIncludes",value:function(t,e){var n=this,o=this.index,r=this.data;t.each((function(t,i){var c=n.getOffset(t,i),l=o[c];S.isNotUnDef(l)&&e(r[l])}))}},{key:"getOffset",value:function(t,e){return t*this.cols.len+e}},{key:"getFirstIncludes",value:function(t,e){var n=this.index,o=this.data,r=n[this.getOffset(t,e)];if(S.isUnDef(r))return null;var i=o[r];return S.isUnDef(i)?null:i}},{key:"add",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=this.index,r=this.data;n&&this.deleteIntersects(t);var i=r.length;r.push(t),t.each((function(t,n){var r=e.getOffset(t,n);o[r]=i}))}},{key:"delete",value:function(t){var e=this,n=this.index,o=this.data,r=t.sri,i=t.sci,c=this.getOffset(r,i),l=n[c];S.isUnDef(l)||(o.splice(l,1),t.each((function(t,o){var r=e.getOffset(t,o);n[r]=void 0})),this.sync(l))}},{key:"deleteIntersects",value:function(t){var e=this;this.getIncludes(t,(function(t){return e.delete(t)}))}},{key:"union",value:function(t){for(var e=this,n=t,o=[],r=function(t){var r=e.data[t];if(o.find((function(t){return t===r})))return i=t,"continue";r.intersects(n)&&(o.push(r),n=r.union(n),t=-1),i=t},i=0;i<this.data.length;i+=1)r(i);return n}},{key:"sync",value:function(){for(var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.index,o=this.data,r=function(e){o[e].each((function(o,r){var i=t.getOffset(o,r);n[i]=e}))},i=e;i<o.length;i+=1)r(i)}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(t){this.data=t}}])&&Hm(e.prototype,n),o&&Hm(e,o),t}();function Bm(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Wm=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.callback=e}var e,n,o;return e=t,(n=[{key:"execute",value:function(){return this.callback.apply(this,arguments)}}])&&Bm(e.prototype,n),o&&Bm(e,o),t}();function Ym(t){return(Ym="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Um(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function zm(t,e){return!e||"object"!==Ym(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gm(t){return(Gm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xm(t,e){return(Xm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zm=function(t){function e(t){var n,o=t.cells,r=t.cols,i=t.merges;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=zm(this,Gm(e).call(this,(function(t,e){return!!i.getFirstIncludes(e,t-1)||n.master(e,t)&&n.right(e,t)&&n.left(e,t)})))).cells=o,n.cols=r,n.merges=i,n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xm(t,e)}(e,t),n=e,(o=[{key:"master",value:function(t,e){var n=this.cells,o=this.cols,r=n.getCell(t,e-1),i=n.getCell(t,e);if(S.isUnDef(i)||S.isBlank(i.text))return!0;var c=i.fontAttr,l=c.direction,u=!0;if(l===ll.TEXT_DIRECTION.ANGLE){var a=c.angle;90!==a&&-90!==a||(u=!1)}else c.textWrap!==ll.TEXT_WRAP.OVER_FLOW&&(u=!1);var s=c.align,f=o.getWidth(e);return s!==ll.ALIGN.right&&s!==ll.ALIGN.center&&(u=!1),!u||!(n.getCellBoundOutSize(t,e)>f&&(l===ll.TEXT_DIRECTION.ANGLE||S.isUnDef(r)||S.isBlank(r.text)))}},{key:"left",value:function(t,e){var n=this.cells,o=this.cols,r=this.merges,i=n.getCell(t,e),c=!0,l=o.getWidth(e-1);return Ss.getInstance().setBegin(e-1).setEnd(0).setLoop((function(e){var o=n.getCell(t,e);if(S.isUnDef(o))return!0;var u=r.getFirstIncludes(t,e);if(S.isNotUnDef(u))return!0;var a=o.text;if(S.isBlank(a))return!0;var s=o.fontAttr,f=s.direction;if(f===ll.TEXT_DIRECTION.ANGLE){var h=s.angle;if(90===h||-90===h)return!1;var p=s.align;if(p!==ll.ALIGN.left&&p!==ll.ALIGN.center)return!1}else{if(s.textWrap!==ll.TEXT_WRAP.OVER_FLOW)return!1;var y=s.align;if(y!==ll.ALIGN.left&&y!==ll.ALIGN.center)return!1}return n.getCellBoundOutSize(t,e)>l&&(f===ll.TEXT_DIRECTION.ANGLE||S.isUnDef(i)||S.isBlank(i.text))&&(c=!1),!1})).setNext((function(t){l+=o.getWidth(t)})).execute(),c}},{key:"right",value:function(t,e){var n=this.cells,o=this.cols,r=this.merges,i=n.getCell(t,e-1),c=n.getCell(t,e),l=o.len,u=!0,a=o.getWidth(e+1)+o.getWidth(e);return Ss.getInstance().setBegin(e+1).setEnd(l).setLoop((function(e){var o=n.getCell(t,e);if(S.isUnDef(o))return!0;var l=r.getFirstIncludes(t,e);if(S.isNotUnDef(l))return!0;var s=o.text;if(S.isBlank(s))return!0;var f=o.fontAttr,h=f.direction;if(h===ll.TEXT_DIRECTION.ANGLE){var p=f.angle;if(90===p||-90===p)return!1;var y=f.align;if(y!==ll.ALIGN.right&&y!==ll.ALIGN.center)return!1}else{if(f.textWrap!==ll.TEXT_WRAP.OVER_FLOW)return!1;var b=f.align;if(b!==ll.ALIGN.right&&b!==ll.ALIGN.center)return!1}if(n.getCellBoundOutSize(t,e)>a){var d=S.isUnDef(c)||S.isBlank(c.text),v=S.isUnDef(i)||S.isBlank(i.text);(h===ll.TEXT_DIRECTION.ANGLE||d&&v)&&(u=!1)}return!1})).setNext((function(t){a+=o.getWidth(t)})).execute(),u}}])&&Um(n.prototype,o),r&&Um(n,r),e}(Wm);function Km(t){return(Km="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $m(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function qm(t,e){return!e||"object"!==Km(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qm(t){return(Qm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jm(t,e){return(Jm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var tO=function(t){function e(t){var n,o=t.cells,r=t.cols,i=t.merges;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=qm(this,Qm(e).call(this,(function(t,e){return!!i.getFirstIncludes(e,t+1)||n.master(e,t)&&n.right(e,t)&&n.left(e,t)})))).cells=o,n.cols=r,n.merges=i,n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jm(t,e)}(e,t),n=e,(o=[{key:"master",value:function(t,e){var n=this.cells,o=this.cols,r=n.getCell(t,e+1),i=n.getCell(t,e);if(S.isUnDef(i)||S.isBlank(i.text))return!0;var c=i.fontAttr,l=c.direction,u=!0;if(l===ll.TEXT_DIRECTION.ANGLE){var a=c.angle;90!==a&&-90!==a||(u=!1)}else c.textWrap!==ll.TEXT_WRAP.OVER_FLOW&&(u=!1);var s=c.align,f=o.getWidth(e);return s!==ll.ALIGN.left&&s!==ll.ALIGN.center&&(u=!1),!u||!(n.getCellBoundOutSize(t,e)>f&&(l===ll.TEXT_DIRECTION.ANGLE||S.isUnDef(r)||S.isBlank(r.text)))}},{key:"left",value:function(t,e){var n=this.cells,o=this.cols,r=this.merges,i=n.getCell(t,e+1),c=n.getCell(t,e),l=!0,u=o.getWidth(e-1)+o.getWidth(e);return Ss.getInstance().setBegin(e-1).setEnd(0).setLoop((function(e){var o=n.getCell(t,e);if(S.isUnDef(o))return!0;var a=r.getFirstIncludes(t,e);if(S.isNotUnDef(a))return!0;var s=o.text;if(S.isBlank(s))return!0;var f=o.fontAttr,h=f.direction;if(h===ll.TEXT_DIRECTION.ANGLE){var p=f.angle;if(90===p||-90===p)return!1;var y=f.align;if(y!==ll.ALIGN.left&&y!==ll.ALIGN.center)return!1}else{if(f.textWrap!==ll.TEXT_WRAP.OVER_FLOW)return!1;var b=f.align;if(b!==ll.ALIGN.left&&b!==ll.ALIGN.center)return!1}if(n.getCellBoundOutSize(t,e)>u){var d=S.isUnDef(c)||S.isBlank(c.text),v=S.isUnDef(i)||S.isBlank(i.text);(h===ll.TEXT_DIRECTION.ANGLE||d&&v)&&(l=!1)}return!1})).setNext((function(t){u+=o.getWidth(t)})).execute(),l}},{key:"right",value:function(t,e){var n=this.cells,o=this.cols,r=this.merges,i=n.getCell(t,e),c=o.len,l=!0,u=o.getWidth(e+1);return Ss.getInstance().setBegin(e+1).setEnd(c).setLoop((function(e){var o=n.getCell(t,e);if(S.isUnDef(o))return!0;var c=r.getFirstIncludes(t,e);if(S.isNotUnDef(c))return!0;var a=o.text;if(S.isBlank(a))return!0;var s=o.fontAttr,f=s.direction;if(f===ll.TEXT_DIRECTION.ANGLE){var h=s.angle;if(90===h||-90===h)return!1;var p=s.align;if(p!==ll.ALIGN.right&&p!==ll.ALIGN.center)return!1}else{if(s.textWrap!==ll.TEXT_WRAP.OVER_FLOW)return!1;var y=s.align;if(y!==ll.ALIGN.right&&y!==ll.ALIGN.center)return!1}return n.getCellBoundOutSize(t,e)>u&&(f===ll.TEXT_DIRECTION.ANGLE||S.isUnDef(i)||S.isBlank(i.text))&&(l=!1),!1})).setNext((function(t){u+=o.getWidth(t)})).execute(),l}}])&&$m(n.prototype,o),r&&$m(n,r),e}(Wm);function eO(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var nO=function(){function t(e){var n=e.merges,o=e.rows,r=e.cols,i=e.cells,c=e.foldOnOff,l=void 0===c||c;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.merges=n,this.cells=i,this.rows=o,this.cols=r,this.foldOnOff=l,this.rightOutRangeFilter=new tO({cells:i,cols:r,merges:n}),this.leftOutRangeFilter=new Zm({cells:i,cols:r,merges:n})}var e,n,o;return e=t,(n=[{key:"getMergeCoincideRange",value:function(t){var e=t.viewRange,n=void 0===e?new xs(0,0,0,0):e,o=this.merges,r=this.cols,i=this.rows,c=[],l=[];return this.horizontalIterate({viewRange:n,filter:new Wm((function(t,e){var n=o.getFirstIncludes(t,e);return S.isNotUnDef(n)&&-1===c.indexOf(n)})),handle:function(t,e,u,a){var s=o.getFirstIncludes(t,e);c.push(s);var f=n.coincide(s),h=r.sectionSumWidth(f.sci,f.eci),p=i.sectionSumHeight(f.sri,f.eri),y=new Ra({x:u,y:a,width:h,height:p});l.push({rect:y,view:f,merge:s})}}),l}},{key:"getCoincideRangeBrink",value:function(t){for(var e=t.coincide,n=void 0===e?new xs(0,0,0,0):e,o=this.cols,r=this.rows,i=[],c=0;c<n.length;c+=1){var l=n[c],u=l.view,a=l.rect,s=l.merge,f=u.brink(),h={view:f.top,x:a.x,y:a.y},p={view:f.left,x:a.x,y:a.y},y={view:f.bottom,x:a.x,y:a.y+a.height-r.rectRangeSumHeight(f.bottom)},b={view:f.right,x:a.x+a.width-o.rectRangeSumWidth(f.right),y:a.y},d={};s.sri===u.sri&&(d.top=h),s.sci===u.sci&&(d.left=p),s.eri===u.eri&&(d.bottom=y),s.eci===u.eci&&(d.right=b),i.push(d)}return i}},{key:"horizontalIterate",value:function(t){var e=t.viewRange,n=void 0===e?new xs(0,0,0,0):e,o=t.newRow,r=void 0===o?function(){return!0}:o,i=t.filter,c=void 0===i?new Wm((function(){return!0})):i,l=t.jump,u=void 0===l?function(){return!0}:l,a=t.handle,s=void 0===a?function(){return!0}:a,f=t.endRow,h=void 0===f?function(){return!0}:f,p=t.bx,y=void 0===p?0:p,b=t.by,d=void 0===b?0:b,v=this.cols,g=this.rows,w=this.foldOnOff,m=n.sri,O=n.eri,E=n.sci,S=n.eci,_=d;vs.getInstance().setBegin(m).setEnd(O).setLoop((function(t){var e=g.getHeight(t),n=y;r(t,_),Ss.getInstance().setBegin(E).setEnd(S).setLoop((function(e){var o=c.execute(t,e,n,_),r=v.getWidth(e);o?s(t,e,n,_):u(t,e,n,_),n+=r})).execute(),h(),_+=e})).foldOnOff(w).execute()}},{key:"verticalIterate",value:function(t){var e=t.viewRange,n=void 0===e?new xs(0,0,0,0):e,o=t.newCol,r=void 0===o?function(){return!0}:o,i=t.filter,c=void 0===i?new Wm((function(){return!0})):i,l=t.jump,u=void 0===l?function(){return!0}:l,a=t.handle,s=void 0===a?function(){return!0}:a,f=t.endCol,h=void 0===f?function(){return!0}:f,p=t.bx,y=void 0===p?0:p,b=t.by,d=void 0===b?0:b,v=this.cols,g=this.rows,w=this.foldOnOff,m=n.sri,O=n.eri,E=n.sci,S=n.eci,_=y;Ss.getInstance().setBegin(E).setEnd(S).setLoop((function(t){var e=v.getWidth(t),n=d;r(t,_),vs.getInstance().setBegin(m).setEnd(O).setLoop((function(e){var o=g.getHeight(e);c.execute(t,e,_,n)?s(t,e,_,n):u(t,e,_,n),n+=o})).foldOnOff(w).execute(),h(),_+=e})).execute()}}])&&eO(e.prototype,n),o&&eO(e,o),t}();function oO(t){return(oO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rO(t,e){return!e||"object"!==oO(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function iO(t){return(iO=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cO(t,e){return(cO=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var lO=function(t){function e(t){var n=t.merges;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),rO(this,iO(e).call(this,(function(t,e){return null===n.getFirstIncludes(t,e)})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cO(t,e)}(e,t),e}(Wm);function uO(t){return(uO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function aO(t,e){return!e||"object"!==uO(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function sO(t){return(sO=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fO(t,e){return(fO=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hO=function(t){function e(t){var n=t.merges;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),aO(this,sO(e).call(this,(function(t,e){return null===n.getFirstIncludes(e,t)})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fO(t,e)}(e,t),e}(Wm);function pO(t){return(pO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yO(t,e){return!e||"object"!==pO(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bO(t){return(bO=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dO(t,e){return(dO=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vO=function(t){function e(t){var n=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),yO(this,bO(e).call(this,(function(t,e){var o=n.getCell(t+1,e),r=n.getCell(t,e),i=!1;return r&&!i&&(i=r.borderAttr.bottom.display),o&&!i&&(i=o.borderAttr.top.display),!i})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dO(t,e)}(e,t),e}(Wm);function gO(t){return(gO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wO(t,e){return!e||"object"!==gO(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mO(t){return(mO=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function OO(t,e){return(OO=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var EO=function(t){function e(t){var n=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),wO(this,mO(e).call(this,(function(t,e){var o=n.getCell(e,t+1),r=n.getCell(e,t),i=!1;return r&&!i&&(i=r.borderAttr.right.display),o&&!i&&(i=o.borderAttr.left.display),!i})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&OO(t,e)}(e,t),e}(Wm);function SO(t){return(SO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _O(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function TO(t,e){return!e||"object"!==SO(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xO(t){return(xO=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kO(t,e){return(kO=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var PO=function(t){function e(t){var n,o=t.merges,r=t.rows,i=t.cols,c=t.cells,l=t.drawCheck,u=void 0!==l&&l,a=t.foldOnOff,s=void 0===a||a,f=t.getHeight,h=void 0===f?function(t){return r.getHeight(t)}:f,p=t.getWidth,y=void 0===p?function(t){return i.getWidth(t)}:p;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=TO(this,xO(e).call(this,{merges:o,rows:r,cols:i,cells:c,foldOnOff:s}))).drawCheck=u,n.getHeight=h,n.getWidth=y,n.horizontalBorderDisplayFilter=new vO({cells:c}),n.verticalBorderDisplayFilter=new EO({cells:c}),n.horizontalMergeFilter=new lO({merges:o}),n.verticalMergeFilter=new hO({merges:o}),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kO(t,e)}(e,t),n=e,(o=[{key:"computerHorizontalLine",value:function(t){var e,n,o,r,i,c=t.viewRange,l=t.bx,u=void 0===l?0:l,a=t.by,s=void 0===a?0:a,f=t.filter,h=this.getWidth,p=this.getHeight,y=[];return this.horizontalIterate({viewRange:c,newRow:function(t,c){var l=p(t);o=e=u,r=n=s+c+l,i=!1},filter:f,jump:function(t,c){i&&(i=!1,y.push({sx:e,sy:n,ex:o,ey:r}));var l=h(c);o=e=o+l},handle:function(t,e){i=!0;var n=h(e);o+=n},endRow:function(){i&&y.push({sx:e,sy:n,ex:o,ey:r})}}),y}},{key:"computerVerticalLine",value:function(t){var e,n,o,r,i,c=t.viewRange,l=t.bx,u=void 0===l?0:l,a=t.by,s=void 0===a?0:a,f=t.filter,h=this.getWidth,p=this.getHeight,y=[];return this.verticalIterate({viewRange:c,newCol:function(t,c){var l=h(t);o=e=u+c+l,r=n=s,i=!1},filter:f,jump:function(t,c){i&&(i=!1,y.push({sx:e,sy:n,ex:o,ey:r}));var l=p(c);r=n=r+l},handle:function(t,e){i=!0;var n=p(e);r+=n},endCol:function(){i&&y.push({sx:e,sy:n,ex:o,ey:r})}}),y}}])&&_O(n.prototype,o),r&&_O(n,r),e}(nO);function jO(t){return(jO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function CO(t,e){return!e||"object"!==jO(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function RO(t){return(RO=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function LO(t,e){return(LO=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var AO={AND:Symbol("and"),OR:Symbol("or")},NO=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),CO(this,RO(e).call(this,(function(){var e;if(t===AO.AND){e=!0;var o=!0,r=!1,i=void 0;try{for(var c,l=n[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var u=c.value;if(!1===u.execute.apply(u,arguments)){e=!1;break}}}catch(t){r=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}}else{e=!1;var a=!0,s=!1,f=void 0;try{for(var h,p=n[Symbol.iterator]();!(a=(h=p.next()).done);a=!0){var y=h.value;if(!0===y.execute.apply(y,arguments)){e=!0;break}}}catch(t){s=!0,f=t}finally{try{a||null==p.return||p.return()}finally{if(s)throw f}}}return e})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&LO(t,e)}(e,t),e}(Wm);function IO(t){return(IO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function VO(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function DO(t,e){return!e||"object"!==IO(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function MO(t){return(MO=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function HO(t,e){return(HO=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var FO=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),DO(this,MO(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&HO(t,e)}(e,t),n=e,(o=[{key:"getHorizontalLine",value:function(t){var e=t.viewRange,n=this.horizontalMergeFilter,o=this.horizontalBorderDisplayFilter;return this.drawCheck?this.computerHorizontalLine({viewRange:e,filter:new NO(AO.AND,[n,o])}):this.computerHorizontalLine({viewRange:e})}},{key:"getMergeHorizontalLine",value:function(t){var e=t.brink,n=[],o=this.horizontalBorderDisplayFilter;if(this.drawCheck)for(var r=0;r<e.length;r+=1){var i=e[r].bottom;if(i){var c=i.view,l=i.x,u=i.y,a=this.computerHorizontalLine({viewRange:c,bx:l,by:u,filter:o});n=n.concat(a)}}else for(var s=0;s<e.length;s+=1){var f=e[s].bottom;if(f){var h=f.view,p=f.x,y=f.y,b=this.computerHorizontalLine({viewRange:h,bx:p,by:y});n=n.concat(b)}}return n}}])&&VO(n.prototype,o),r&&VO(n,r),e}(PO);function BO(t){return(BO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function WO(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function YO(t,e){return!e||"object"!==BO(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function UO(t){return(UO=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zO(t,e){return(zO=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var GO=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),YO(this,UO(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zO(t,e)}(e,t),n=e,(o=[{key:"getVerticalLine",value:function(t){var e=t.viewRange,n=this.verticalMergeFilter,o=this.verticalBorderDisplayFilter,r=this.rightOutRangeFilter;return this.drawCheck?this.computerVerticalLine({viewRange:e,filter:new NO(AO.AND,[n,o,r])}):this.computerVerticalLine({viewRange:e})}},{key:"getMergeVerticalLine",value:function(t){var e=t.brink,n=[],o=this.verticalBorderDisplayFilter;if(this.drawCheck)for(var r=0;r<e.length;r+=1){var i=e[r].right;if(i){var c=i.view,l=i.x,u=i.y,a=this.computerVerticalLine({viewRange:c,bx:l,by:u,filter:o});n=n.concat(a)}}else for(var s=0;s<e.length;s+=1){var f=e[s].right;if(f){var h=f.view,p=f.x,y=f.y,b=this.computerVerticalLine({viewRange:h,bx:p,by:y});n=n.concat(b)}}return n}}])&&WO(n.prototype,o),r&&WO(n,r),e}(PO);function XO(t){return(XO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ZO(t,e){return!e||"object"!==XO(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function KO(t){return(KO=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $O(t,e){return($O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qO=function(t){function e(t){var n=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ZO(this,KO(e).call(this,(function(t,e){var o=n.getCell(t+1,e),r=n.getCell(t,e);if(S.isUnDef(r))return!1;var i=r.borderAttr.bottom;if(S.isUnDef(o))return i.display;var c=o.borderAttr.top;if(!c.display)return i.display;var l=i.priority(c);return 1===l||0===l})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$O(t,e)}(e,t),e}(Wm);function QO(t){return(QO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function JO(t,e){return!e||"object"!==QO(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tE(t){return(tE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function eE(t,e){return(eE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nE=function(t){function e(t){var n=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),JO(this,tE(e).call(this,(function(t,e){var o=n.getCell(e,t-1),r=n.getCell(e,t);if(S.isUnDef(r))return!1;var i=r.borderAttr.left;if(S.isUnDef(o))return i.display;var c=o.borderAttr.right;return c.display?1===i.priority(c):i.display})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&eE(t,e)}(e,t),e}(Wm);function oE(t){return(oE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rE(t,e){return!e||"object"!==oE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function iE(t){return(iE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cE(t,e){return(cE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var lE=function(t){function e(t){var n=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),rE(this,iE(e).call(this,(function(t,e){var o=n.getCell(e,t+1),r=n.getCell(e,t);if(S.isUnDef(r))return!1;var i=r.borderAttr.right;if(S.isUnDef(o))return i.display;var c=o.borderAttr.left;if(!c.display)return i.display;var l=i.priority(c);return 1===l||0===l})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cE(t,e)}(e,t),e}(Wm);function uE(t){return(uE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function aE(t,e){return!e||"object"!==uE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function sE(t){return(sE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fE(t,e){return(fE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hE=function(t){function e(t){var n=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),aE(this,sE(e).call(this,(function(t,e){var o=n.getCell(t-1,e),r=n.getCell(t,e);if(S.isUnDef(r))return!1;var i=r.borderAttr.top;if(S.isUnDef(o))return i.display;var c=o.borderAttr.bottom;return c.display?1===i.priority(c):i.display})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fE(t,e)}(e,t),e}(Wm);function pE(t){return(pE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yE(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function bE(t,e){return!e||"object"!==pE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dE(t){return(dE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vE(t,e){return(vE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gE=function(t){function e(t){var n,o=t.drawOptimization,r=void 0!==o&&o,i=t.merges,c=t.rows,l=t.cols,u=t.cells,a=t.foldOnOff,s=void 0===a||a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=bE(this,dE(e).call(this,{merges:i,rows:c,cols:l,cells:u,foldOnOff:s}))).drawOptimization=r,n.horizontalMergeFilter=new lO({merges:i}),n.verticalMergeFilter=new hO({merges:i}),n.bottomBorderDiffFilter=new qO({cells:u}),n.leftBorderDiffFilter=new nE({cells:u}),n.rightBorderDiffFilter=new lE({cells:u}),n.topBorderDiffFilter=new hE({cells:u}),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vE(t,e)}(e,t),n=e,(o=[{key:"computerTopHorizontalLine",value:function(t){var e,n,o,r,i=t.viewRange,c=void 0===i?null:i,l=t.bx,u=void 0===l?0:l,a=t.by,s=void 0===a?0:a,f=t.filter,h=void 0===f?null:f,p=this.drawOptimization,y=this.cols,b=this.cells,d=[];if(this.horizontalIterate({viewRange:c,newRow:function(t,i){o=e=u,r=n=s+i},filter:h,jump:function(t,n){var r=y.getWidth(n);o=e=o+r},handle:function(t,i){var c=y.getWidth(i),l=b.getCell(t,i).borderAttr;o+=c,d.push({sx:e,sy:n,ex:o,ey:r,row:t,col:i,borderAttr:l}),e=o}}),p)for(var v=1;v<d.length;){var g=d[v],w=d[v-1],m=g.borderAttr.top.equal(w.borderAttr.top),O=g.col-w.col==1,E=g.row===w.row;m&&O&&E?(w.ex=g.ex,w.col=g.col,d.splice(v,1)):v+=1}return d}},{key:"computerBottomHorizontalLine",value:function(t){var e,n,o,r,i=t.viewRange,c=void 0===i?null:i,l=t.bx,u=void 0===l?0:l,a=t.by,s=void 0===a?0:a,f=t.filter,h=void 0===f?null:f,p=this.drawOptimization,y=this.cols,b=this.rows,d=this.cells,v=[];if(this.horizontalIterate({viewRange:c,newRow:function(t,i){var c=b.getHeight(t);o=e=u,r=n=s+i+c},filter:h,jump:function(t,n){var r=y.getWidth(n);o=e=o+r},handle:function(t,i){var c=y.getWidth(i),l=d.getCell(t,i).borderAttr;o+=c,v.push({sx:e,sy:n,ex:o,ey:r,row:t,col:i,borderAttr:l}),e=o}}),p)for(var g=1;g<v.length;){var w=v[g],m=v[g-1],O=w.borderAttr.bottom.equal(m.borderAttr.bottom),E=w.col-m.col==1,S=w.row===m.row;O&&E&&S?(m.ex=w.ex,m.col=w.col,v.splice(g,1)):g+=1}return v}},{key:"computerLeftVerticalLine",value:function(t){var e,n,o,r,i=t.viewRange,c=void 0===i?null:i,l=t.bx,u=void 0===l?0:l,a=t.by,s=void 0===a?0:a,f=t.filter,h=void 0===f?null:f,p=this.drawOptimization,y=this.rows,b=this.cells,d=[];if(this.verticalIterate({viewRange:c,newCol:function(t,i){o=e=u+i,r=n=s},filter:h,jump:function(t,e){var o=y.getHeight(e);r=n=r+o},handle:function(t,i){var c=y.getHeight(i),l=b.getCell(i,t).borderAttr;r+=c,d.push({sx:e,sy:n,ex:o,ey:r,row:i,col:t,borderAttr:l}),n=r}}),p)for(var v=1;v<d.length;){var g=d[v],w=d[v-1],m=vs.getInstance().setBegin(w.row).setEnd(g.row).nextRow(),O=g.borderAttr.left.equal(w.borderAttr.left),E=g.row===m,S=g.col===w.col;O&&E&&S?(w.ey=g.ey,w.row=g.row,d.splice(v,1)):v+=1}return d}},{key:"computerRightVerticalLine",value:function(t){var e,n,o,r,i=t.viewRange,c=void 0===i?null:i,l=t.bx,u=void 0===l?0:l,a=t.by,s=void 0===a?0:a,f=t.filter,h=void 0===f?null:f,p=this.drawOptimization,y=this.rows,b=this.cols,d=this.cells,v=[];if(this.verticalIterate({viewRange:c,newCol:function(t,i){var c=b.getWidth(t);o=e=u+i+c,r=n=s},filter:h,jump:function(t,e){var o=y.getHeight(e);r=n=r+o},handle:function(t,i){var c=y.getHeight(i),l=d.getCell(i,t).borderAttr;r+=c,v.push({sx:e,sy:n,ex:o,ey:r,row:i,col:t,borderAttr:l}),n=r}}),p)for(var g=1;g<v.length;){var w=v[g],m=v[g-1],O=vs.getInstance().setBegin(m.row).setEnd(w.row).nextRow(),E=w.borderAttr.right.equal(m.borderAttr.right),S=w.row===O,_=w.col===m.col;E&&S&&_?(m.ey=w.ey,m.row=w.row,v.splice(g,1)):g+=1}return v}},{key:"disableOptimization",value:function(){this.drawOptimization=!1}},{key:"enableOptimization",value:function(){this.drawOptimization=!0}}])&&yE(n.prototype,o),r&&yE(n,r),e}(nO);function wE(t){return(wE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mE(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function OE(t,e){return!e||"object"!==wE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function EE(t){return(EE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function SE(t,e){return(SE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _E=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),OE(this,EE(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&SE(t,e)}(e,t),n=e,(o=[{key:"getBottomHorizontalLine",value:function(t){var e=t.viewRange,n=this.horizontalMergeFilter,o=this.bottomBorderDiffFilter;return this.computerBottomHorizontalLine({viewRange:e,filter:new NO(AO.AND,[n,o])})}},{key:"getTopHorizontalLine",value:function(t){var e=t.viewRange,n=this.horizontalMergeFilter,o=this.topBorderDiffFilter;return this.computerTopHorizontalLine({viewRange:e,filter:new NO(AO.AND,[n,o])})}},{key:"getBottomMergeHorizontalLine",value:function(t){for(var e=t.brink,n=this.bottomBorderDiffFilter,o=[],r=0;r<e.length;r+=1){var i=e[r].bottom;if(i){var c=this.computerBottomHorizontalLine({viewRange:i.view,bx:i.x,by:i.y,filter:n});o=o.concat(c)}}return o}},{key:"getTopMergeHorizontalLine",value:function(t){for(var e=t.brink,n=this.topBorderDiffFilter,o=[],r=0;r<e.length;r+=1){var i=e[r].top;if(i){var c=this.computerTopHorizontalLine({viewRange:i.view,bx:i.x,by:i.y,filter:n});o=o.concat(c)}}return o}}])&&mE(n.prototype,o),r&&mE(n,r),e}(gE);function TE(t){return(TE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xE(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function kE(t,e){return!e||"object"!==TE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function PE(t){return(PE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jE(t,e){return(jE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var CE=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),kE(this,PE(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jE(t,e)}(e,t),n=e,(o=[{key:"getRightVerticalLine",value:function(t){var e=t.viewRange,n=this.verticalMergeFilter,o=this.rightBorderDiffFilter,r=this.rightOutRangeFilter;return this.computerRightVerticalLine({viewRange:e,filter:new NO(AO.AND,[n,o,r])})}},{key:"getLeftVerticalLine",value:function(t){var e=t.viewRange,n=this.verticalMergeFilter,o=this.leftBorderDiffFilter,r=this.leftOutRangeFilter;return this.computerLeftVerticalLine({viewRange:e,filter:new NO(AO.AND,[n,o,r])})}},{key:"getRightMergeVerticalLine",value:function(t){for(var e=t.brink,n=this.rightBorderDiffFilter,o=[],r=0;r<e.length;r+=1){var i=e[r].right;if(i){var c=this.computerRightVerticalLine({viewRange:i.view,bx:i.x,by:i.y,filter:n});o=o.concat(c)}}return o}},{key:"getLeftMergeVerticalLine",value:function(t){for(var e=t.brink,n=this.leftBorderDiffFilter,o=[],r=0;r<e.length;r+=1){var i=e[r].left;if(i){var c=this.computerLeftVerticalLine({viewRange:i.view,bx:i.x,by:i.y,filter:n});o=o.concat(c)}}return o}}])&&xE(n.prototype,o),r&&xE(n,r),e}(gE);function RE(t){return(RE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function LE(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function AE(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function NE(t,e){return!e||"object"!==RE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function IE(t,e,n){return(IE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=VE(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function VE(t){return(VE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function DE(t,e){return(DE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ME=function(t){function e(t){var n,o=t.xTableScrollView,r=t.rows,i=t.cols,c=t.scroll;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=NE(this,VE(e).call(this,{xTableScrollView:o,rows:r,cols:i,scroll:c}))).lastScrollView=null,n.enterView=null,n.scrollEnterView=null,n.leaveView=null,n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&DE(t,e)}(e,t),n=e,(o=[{key:"reset",value:function(){IE(VE(e.prototype),"reset",this).call(this),this.scrollEnterView=null,this.enterView=null,this.leaveView=null}},{key:"getLastScrollView",value:function(){return S.isNotUnDef(this.lastScrollView)?this.lastScrollView.clone():null}},{key:"getLeaveView",value:function(){if(S.isNotUnDef(this.leaveView))return this.leaveView.clone();var t=this.getLastScrollView(),e=this.getScrollView(),n=this.cols,o=this.rows;if(t){var r=LE(t.coincideDifference(e),1)[0];if(r)return r.w=n.rectRangeSumWidth(r),r.h=o.rectRangeSumHeight(r),this.leaveView=r,r.clone()}return null}},{key:"getEnterView",value:function(){if(S.isNotUnDef(this.enterView))return this.enterView.clone();var t=this.getLastScrollView(),e=this.getScrollView(),n=this.cols,o=this.rows;if(t){var r=LE(e.coincideDifference(t),1)[0];if(r)return r.w=n.rectRangeSumWidth(r),r.h=o.rectRangeSumHeight(r),this.enterView=r,r.clone()}return null}},{key:"getScrollEnterView",value:function(){if(S.isNotUnDef(this.scrollEnterView))return this.scrollEnterView.clone();var t=this.cols,e=this.rows,n=this.scroll,o=this.getEnterView();if(o){switch(n.type){case vg.H_RIGHT:o.sci-=1;break;case vg.V_BOTTOM:o.sri-=1;break;case vg.H_LEFT:o.eci+=1;break;case vg.V_TOP:o.eri+=1}return o.w=t.rectRangeSumWidth(o),o.h=e.rectRangeSumHeight(o),this.scrollEnterView=o,o.clone()}return null}},{key:"undo",value:function(){this.lastScrollView=null}},{key:"record",value:function(){this.lastScrollView=this.scrollView}}])&&AE(n.prototype,o),r&&AE(n,r),e}(dw);function HE(t){return(HE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function FE(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function BE(t,e){return!e||"object"!==HE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function WE(t){return(WE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function YE(t,e){return(YE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var UE=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),BE(this,WE(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&YE(t,e)}(e,t),n=e,(o=[{key:"getCellOrNewCellByViewRange",value:function(t){var e=t.rectRange,n=void 0===e?new xs(-1,-1,-1,-1):e,o=t.callback,r=void 0===o?function(){}:o,i=this.cells,c=n.sri,l=n.eri,u=n.sci,a=n.eci;vs.getInstance().setBegin(c).setEnd(l).setLoop((function(t){Ss.getInstance().setBegin(u).setEnd(a).setLoop((function(e){var n=i.getCellOrNew(t,e);r(t,e,n)})).execute()})).execute()}}])&&FE(n.prototype,o),r&&FE(n,r),e}(Sm);function zE(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var GE=function(){function t(e){var n=e.rows,o=e.cols,r=e.fixedView;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fixedView=r,this.cols=o,this.rows=n}var e,n,o;return e=t,(n=[{key:"getHeight",value:function(){return this.rows.rectRangeSumHeight(this.fixedView.getFixedView())}},{key:"getWidth",value:function(){return this.cols.rectRangeSumWidth(this.fixedView.getFixedView())}}])&&zE(e.prototype,n),o&&zE(e,o),t}();function XE(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var ZE=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.rows,o=e.cols,r=e.cells;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cells=r,this.cols=o,this.data=new Array(n.len*o.len)}var e,n,o;return e=t,(n=[{key:"addOrNewCell",value:function(t,e,n){this.cells.getCellOrNew(t,e),this.add(t,e,n)}},{key:"add",value:function(t,e,n){var o=this.data;if(this.cells.getCell(t,e)){var r=this.getIcon(t,e);r?r.push(n):o[this.getOffset(t,e)]=[n]}}},{key:"getIcon",value:function(t,e){return this.data[this.getOffset(t,e)]}},{key:"getOffset",value:function(t,e){return t*this.cols.len+e}},{key:"remove",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=this.data,r=this.getIcon(t,e);if(r){var i=this.getOffset(t,e);n?(r=r.filter((function(t){return t!==n})),o[i]=r):o[i]=S.Undef}}}])&&XE(e.prototype,n),o&&XE(e,o),t}();function KE(t){return(KE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $E(t,e){return!e||"object"!==KE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qE(t){return(qE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function QE(t,e){return(QE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var JE=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),$E(this,qE(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&QE(t,e)}(e,t),e}(ZE);function tS(t){return(tS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eS(t,e){return!e||"object"!==tS(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nS(t){return(nS=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oS(t,e){return(oS=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rS=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),eS(this,nS(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oS(t,e)}(e,t),e}(ZE);function iS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function cS(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?iS(Object(n),!0).forEach((function(e){lS(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):iS(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function lS(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uS(t,e,n){return(uS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=hS(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function aS(t){return(aS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sS(t,e){return!e||"object"!==aS(e)&&"function"!=typeof e?fS(t):e}function fS(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hS(t){return(hS=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pS(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yS(t,e)}function yS(t,e){return(yS=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bS(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dS(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function vS(t,e,n){return e&&dS(t.prototype,e),n&&dS(t,n),t}var gS={SCROLL:Symbol("scroll"),RENDER:Symbol("render"),SCALE:Symbol("scale")},wS=function(){function t(e){bS(this,t),this.table=e}return vS(t,[{key:"draw",value:function(){var t=this.table,e=t.draw,n=t.indexGrid,o=t.index,r=o.getHeight(),i=o.getWidth();e.save(),e.offset(0,0),e.attr({fillStyle:"#f4f5f8"}),e.fillRect(0,0,o.getWidth(),r),e.offset(0,0),n.horizonLine(0,r,i,r),n.verticalLine(i,0,i,r),e.restore()}},{key:"render",value:function(){var t=this.table.getRenderMode();t!==gS.RENDER&&t!==gS.SCALE||this.draw()}}]),t}(),mS=function(){function t(e,n){var o=n.width,r=n.height,i=n.background,c=n.buttonColor;bS(this,t),this.table=e,this.height=r,this.width=o,this.background=i,this.buttonColor=c}return vS(t,[{key:"drawBar",value:function(){var t=this.table,e=this.height,n=this.width,o=this.background,r=t.xFixedView,i=t.draw,c=t.index,l=t.xFixedMeasure;if(r.hasFixedTop()){var u=hc.srcTransformStylePx(e),a=t.visualWidth(),s=c.getWidth(),f=l.getHeight()+c.getHeight()-u/2;i.attr({fillStyle:o}),i.fillRect(s,f,a,u)}if(r.hasFixedLeft()){var h=t.visualHeight(),p=hc.srcTransformStylePx(n),y=l.getWidth()+c.getWidth()-p/2,b=c.getHeight();i.attr({fillStyle:o}),i.fillRect(y,b,p,h)}}},{key:"drawButton",value:function(){var t=this.table,e=this.height,n=this.width,o=this.buttonColor,r=t.xFixedView,i=t.draw,c=t.index,l=t.xFixedMeasure;if(r.hasFixedTop()){var u=hc.srcTransformStylePx(e),a=c.getWidth(),s=l.getHeight()+c.getHeight()-u/2;i.attr({fillStyle:o}),i.fillRect(0,s,a,u)}if(r.hasFixedLeft()){var f=c.getHeight(),h=hc.srcTransformStylePx(n),p=l.getWidth()+c.getWidth()-h/2;i.attr({fillStyle:o}),i.fillRect(p,0,h,f)}}},{key:"render",value:function(){this.drawBar(),this.drawButton()}}]),t}(),OS=function(){function t(e){bS(this,t),this.table=e,this.width=null,this.height=null,this.x=null,this.y=null,this.drawX=null,this.drawY=null,this.mapOriginX=null,this.mapOriginY=null,this.mapTargetX=null,this.mapTargetY=null,this.mapWidth=null,this.mapHeight=null,this.fullScrollView=null,this.scrollView=null,this.borderView=null,this.borderX=null,this.borderY=null,this.viewMode=null}return vS(t,[{key:"reset",value:function(){this.width=null,this.height=null,this.x=null,this.y=null,this.drawX=null,this.drawY=null,this.mapOriginX=null,this.mapOriginY=null,this.mapTargetX=null,this.mapTargetY=null,this.mapWidth=null,this.mapHeight=null,this.fullScrollView=null,this.scrollView=null,this.borderView=null,this.borderX=null,this.borderY=null,this.viewMode=null}},{key:"getWidth",value:function(){throw new TypeError("getWidth child impl")}},{key:"getHeight",value:function(){throw new TypeError("getHeight child impl")}},{key:"getX",value:function(){throw new TypeError("getX child impl")}},{key:"getY",value:function(){throw new TypeError("getY child impl")}},{key:"getDrawX",value:function(){if(S.isNumber(this.drawX))return this.drawX;var t=this.table,e=this.getX();if(t.getRenderMode()===gS.RENDER)return this.drawX=e,e;if(t.getRenderMode()===gS.SCALE)return this.drawX=e,e;if(this.getViewMode()===pw.BOUND_OUT)return this.drawX=e,e;if(this.getViewMode()===pw.CHANGE_NOT)return this.drawX=e,e;var n=t.scroll,o=this.getScrollView(),r=this.getFullScrollView(),i=0;switch(n.type){case vg.H_RIGHT:i=r.w-o.w;break;case vg.H_LEFT:i=0}return i=e+i,this.drawX=i,i}},{key:"getDrawY",value:function(){if(S.isNumber(this.drawY))return this.drawY;var t=this.table,e=this.getY();if(t.getRenderMode()===gS.RENDER)return this.drawY=e,e;if(t.getRenderMode()===gS.SCALE)return this.drawY=e,e;if(this.getViewMode()===pw.BOUND_OUT)return this.drawY=e,e;if(this.getViewMode()===pw.CHANGE_NOT)return this.drawY=e,e;var n=t.scroll,o=this.getScrollView(),r=this.getFullScrollView(),i=0;switch(n.type){case vg.V_BOTTOM:i=r.h-o.h;break;case vg.V_TOP:i=0}return i=e+i,this.drawY=i,i}},{key:"getLineX",value:function(){if(S.isNumber(this.borderX))return this.borderX;var t=this.table,e=this.getX();if(t.getRenderMode()===gS.RENDER)return this.borderX=e,e;if(t.getRenderMode()===gS.SCALE)return this.borderX=e,e;if(this.getViewMode()===pw.BOUND_OUT)return this.borderX=e,e;if(this.getViewMode()===pw.CHANGE_NOT)return this.borderX=e,e;var n=0;switch(t.scroll.type){case vg.H_RIGHT:var o=this.getLineView();n=this.getFullScrollView().w-o.w;break;case vg.H_LEFT:n=0}return n=e+n,this.borderX=n,n}},{key:"getLineY",value:function(){if(S.isNumber(this.borderY))return this.borderY;var t=this.table,e=this.getY();if(t.getRenderMode()===gS.RENDER)return this.borderY=e,e;if(t.getRenderMode()===gS.SCALE)return this.borderY=e,e;if(this.getViewMode()===pw.BOUND_OUT)return this.borderY=e,e;if(this.getViewMode()===pw.CHANGE_NOT)return this.borderY=e,e;var n=0;switch(t.scroll.type){case vg.V_BOTTOM:var o=this.getLineView();n=this.getFullScrollView().h-o.h;break;case vg.V_TOP:n=0}return n=e+n,this.borderY=n,n}},{key:"getMapOriginX",value:function(){if(S.isNumber(this.mapOriginX))return this.mapOriginX;var t=this.table,e=t.xTableAreaView,n=t.scroll,o=this.getX(),r=0;switch(n.type){case vg.H_LEFT:r=0;break;case vg.H_RIGHT:r=e.getLeaveView().w}return r=o+r,this.mapOriginX=r,r}},{key:"getMapOriginY",value:function(){if(S.isNumber(this.mapOriginY))return this.mapOriginY;var t=this.table,e=t.xTableAreaView,n=t.scroll,o=this.getY(),r=0;switch(n.type){case vg.V_TOP:r=0;break;case vg.V_BOTTOM:r=e.getLeaveView().h}return r=o+r,this.mapOriginY=r,r}},{key:"getMapTargetX",value:function(){if(S.isNumber(this.mapTargetX))return this.mapTargetX;var t=this.table,e=t.xTableAreaView,n=t.scroll,o=this.getX(),r=0;switch(n.type){case vg.H_LEFT:r=e.getEnterView().w;break;case vg.H_RIGHT:r=0}return r=o+r,this.mapTargetX=r,r}},{key:"getMapTargetY",value:function(){if(S.isNumber(this.mapTargetY))return this.mapTargetY;var t=this.table,e=t.xTableAreaView,n=t.scroll,o=this.getY(),r=0;switch(n.type){case vg.V_TOP:r=e.getEnterView().h;break;case vg.V_BOTTOM:r=0}return r=o+r,this.mapTargetY=r,r}},{key:"getMapWidth",value:function(){if(S.isNumber(this.mapWidth))return this.mapWidth;var t=this.table,e=t.xTableAreaView,n=t.scroll,o=this.getWidth();switch(n.type){case vg.H_RIGHT:o-=e.getLeaveView().w;break;case vg.H_LEFT:o-=e.getEnterView().w}return this.mapWidth=o,o}},{key:"getMapHeight",value:function(){if(S.isNumber(this.mapHeight))return this.mapHeight;var t=this.table,e=t.xTableAreaView,n=t.scroll,o=this.getHeight();switch(n.type){case vg.V_BOTTOM:o-=e.getLeaveView().h;break;case vg.V_TOP:o-=e.getEnterView().h}return this.mapHeight=o,o}},{key:"getScrollView",value:function(){throw new TypeError("getScrollView child impl")}},{key:"getFullScrollView",value:function(){throw new TypeError("getFullScrollView child impl")}},{key:"getLineView",value:function(){if(S.isNotUnDef(this.borderView))return this.borderView.clone();var t=this.table,e=t.cols,n=t.rows,o=t.getRenderMode(),r=this.getViewMode(),i=this.getScrollView();if(r===pw.CHANGE_ADD&&o===gS.SCROLL)switch(t.scroll.type){case vg.V_TOP:i.eri+=1,i.h=n.rectRangeSumHeight(i);break;case vg.V_BOTTOM:i.sri-=1,i.h=n.rectRangeSumHeight(i);break;case vg.H_RIGHT:i.sci-=1,i.w=e.rectRangeSumWidth(i);break;case vg.H_LEFT:i.eci+=1,i.w=e.rectRangeSumWidth(i)}return this.borderView=i,i.clone()}},{key:"getViewMode",value:function(){throw new TypeError("getViewMode child impl")}},{key:"drawMap",value:function(){var t=this.table,e=t.getRenderMode();if(this.getViewMode()===pw.CHANGE_ADD&&e===gS.SCROLL){var n=t.draw,o=this.getMapWidth(),r=this.getMapHeight(),i=this.getMapOriginX(),c=this.getMapOriginY(),l=this.getMapTargetX(),u=this.getMapTargetY();n.copyImage(i,c,o,r,l,u,o,r)}}},{key:"drawClear",value:function(){var t=this.table,e=t.scroll,n=t.draw,o=t.settings,r=this.getViewMode(),i=t.getRenderMode(),c=this.getDrawX(),l=this.getDrawY();if(n.attr({fillStyle:o.table.background}),i===gS.SCROLL)switch(r){case pw.CHANGE_NOT:case pw.STATIC:case pw.BOUND_OUT:var u=this.getHeight(),a=this.getWidth();n.fillRect(c,l,a,u);break;case pw.CHANGE_ADD:switch(e.type){case vg.V_BOTTOM:var s=this.getFullScrollView(),f=this.getScrollView(),h=t.visualHeight()-(s.h-f.h),p=this.getWidth();n.fillRect(c,l,p,h);break;case vg.V_TOP:var y=this.getScrollView().h,b=this.getWidth();n.fillRect(c,l,b,y);break;case vg.H_LEFT:var d=this.getScrollView(),v=this.getHeight(),g=d.w;n.fillRect(c,l,g,v);break;case vg.H_RIGHT:var w=this.getFullScrollView(),m=this.getScrollView(),O=this.getHeight(),E=t.visualWidth()-(w.w-m.w);n.fillRect(c,l,E,O)}}else if(gS.RENDER){var S=this.getHeight(),_=this.getWidth();n.fillRect(c,l,_,S)}}}]),t}(),ES=function(t){function e(){return bS(this,e),sS(this,hS(e).apply(this,arguments))}return pS(e,t),vS(e,[{key:"drawFixedXIcon",value:function(t,e,n,o){var r=this,i=this.table,c=i.draw,l=i.fixedCellIcon.getIcon(e,n);if(l){var u=this.getX(),a=this.getY();t.x+=u,t.y+=a;for(var s=function(e){var n=l[e];n.loadImage({load:function(){o.equals(r.getFullScrollView())&&n.drawIcon({rect:t,draw:c})},sync:function(){n.drawIcon({rect:t,draw:c})}})},f=0;f<l.length;f+=1)s(f)}}},{key:"drawStaticXIcon",value:function(t,e,n,o){var r=this,i=this.table,c=i.draw,l=i.staticCellIcon.getIcon(e,n);if(l){var u=this.getX(),a=this.getY();t.x+=u,t.y+=a;for(var s=function(e){var n=l[e];n.loadImage({load:function(){o.equals(r.getFullScrollView())&&n.drawIcon({rect:t,draw:c})},sync:function(){n.drawIcon({rect:t,draw:c})}})},f=0;f<l.length;f+=1)s(f)}}},{key:"drawCellXIcon",value:function(t,e,n){var o=this,r=this.table,i=e.icons,c=r.draw,l=this.getX(),u=this.getY();t.x+=l,t.y+=u;for(var a=function(e){var r=i[e];r.loadImage({load:function(){n.equals(o.getFullScrollView())&&r.drawIcon({rect:t,draw:c})},sync:function(){r.drawIcon({rect:t,draw:c})}})},s=0;s<i.length;s+=1)a(s)}},{key:"drawXIcon",value:function(){var t=this,e=this.table,n=e.styleCellsHelper,o=e.merges,r=this.getFullScrollView();n.getMergeCellByViewRange({rectRange:r,callback:function(e,n,o){var i=o.sri,c=o.sci,l=e.clone(),u=e.clone();t.drawStaticXIcon(l,i,c,r),t.drawCellXIcon(u,n,r)}}),n.getCellByViewRange({rectRange:r,callback:function(e,n,i,c){var l=c.clone();if(t.drawFixedXIcon(l,e,n,r),!o.getFirstIncludes(e,n)){var u=c.clone(),a=c.clone();t.drawStaticXIcon(u,e,n,r),t.drawCellXIcon(a,i,r)}}})}},{key:"drawBoundOutFont",value:function(){var t=this.getScrollView(),e=this.table,n=e.draw,o=e.cols,r=e.textCellsHelper,i=e.cells,c=e.textFont,l=e.merges,u=this.getDrawX(),a=this.getDrawY();n.offset(u,a);var s,f=t.clone();(f.sci=0,f.eci=t.sci-1,f.eci>-1)&&r.getCellByViewRange({reverseCols:!0,rectRange:f,newCol:function(t){s+=o.getWidth(t)},newRow:function(){s=0},callback:function(t,e,o,r,u){if(l.getFirstIncludes(t,e))return Vm;var a=o.text;if(S.isBlank(a))return Im;var f=o.fontAttr,h=f.align,p=f.textWrap;if((h===ll.ALIGN.left||h===ll.ALIGN.center)&&p===ll.TEXT_WRAP.OVER_FLOW){var y=i.getCellBoundOutSize(t,e);if(0===y||y>s){var b=o.format,d=o.text,v=o.fontAttr,g=c.getBuilder();g.setDraw(n),g.setText(Aw(b,d)),g.setAttr(v),g.setRect(r),g.setOverFlow(u);var w=g.build();o.setContentWidth(w.draw())}}return Vm}});var h,p=t.clone();(p.sci=t.eci+1,p.eci=o.len-1,p.sci<o.len)&&r.getCellSkipMergeCellByViewRange({rectRange:p,startX:t.w,newCol:function(t){h+=o.getWidth(t)},newRow:function(){h=0},callback:function(t,e,o,r,u){if(l.getFirstIncludes(t,e))return Vm;var a=o.text;if(S.isBlank(a))return Im;var s=o.fontAttr,f=s.align,p=s.textWrap;if((f===ll.ALIGN.right||f===ll.ALIGN.center)&&p===ll.TEXT_WRAP.OVER_FLOW){var y=i.getCellBoundOutSize(t,e);if(0===y||y>h){var b=o.format,d=o.text,v=o.fontAttr,g=c.getBuilder();g.setDraw(n),g.setText(Aw(b,d)),g.setAttr(v),g.setRect(r),g.setOverFlow(u);var w=g.build();o.setContentWidth(w.draw())}}return Vm}});n.offset(0,0)}},{key:"drawFont",value:function(){var t=this.getScrollView(),e=this.getDrawX(),n=this.getDrawY(),o=this.table,r=o.draw,i=o.textCellsHelper,c=o.textFont;r.offset(e,n),i.getCellSkipMergeCellByViewRange({rectRange:t,callback:function(t,e,n,o,i){var l=n.format,u=n.text,a=n.fontAttr,s=c.getBuilder();s.setDraw(r),s.setText(Aw(l,u)),s.setAttr(a),s.setRect(o),s.setOverFlow(i);var f=s.build();n.setContentWidth(f.draw())}}),i.getMergeCellByViewRange({rectRange:t,callback:function(t,e){var n=e.format,o=e.text,i=e.fontAttr,l=c.getBuilder();l.setDraw(r),l.setText(Aw(n,o)),l.setAttr(i),l.setRect(t),l.setOverFlow(t);var u=l.build();e.setContentWidth(u.draw())}}),r.offset(0,0)}},{key:"drawColor",value:function(){var t=this.getScrollView(),e=this.table,n=this.getDrawX(),o=this.getDrawY(),r=e.draw,i=e.styleCellsHelper,c=e.merges;r.offset(n,o),i.getMergeCellByViewRange({rectRange:t,callback:function(t,e){var n=e.background;new Iw({draw:r,rect:t}).drawBackgroundColor(n)}}),i.getCellByViewRange({rectRange:t,callback:function(t,e,n,o){var i=c.getFirstIncludes(t,e);if(!i||i.sri===t&&i.sci===t){var l=n.background;new Iw({draw:r,rect:o}).drawBackgroundColor(l)}}}),r.offset(0,0)}},{key:"drawGrid",value:function(){var t=this.getLineView(),e=this.getLineX(),n=this.getLineY(),o=this.table,r=o.draw,i=o.grid,c=o.cellHorizontalGrid,l=o.cellVerticalGrid;r.offset(e,n);var u=c.getMergeCoincideRange({viewRange:t}),a=c.getCoincideRangeBrink({coincide:u}),s=c.getHorizontalLine({viewRange:t}),f=l.getVerticalLine({viewRange:t});s.forEach((function(t){i.horizonLine(t.sx,t.sy,t.ex,t.ey)})),f.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)}));var h=c.getMergeHorizontalLine({brink:a}),p=l.getMergeVerticalLine({brink:a});h.forEach((function(t){i.horizonLine(t.sx,t.sy,t.ex,t.ey)})),p.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)})),r.offset(0,0)}},{key:"drawBorder",value:function(){var t=this.getLineView(),e=this.getLineX(),n=this.getLineY(),o=this.table,r=o.draw,i=o.line,c=o.cellHorizontalBorder,l=o.cellVerticalBorder;r.offset(e,n);var u=c.getMergeCoincideRange({viewRange:t}),a=c.getCoincideRangeBrink({coincide:u}),s=c.getBottomHorizontalLine({viewRange:t}),f=c.getTopHorizontalLine({viewRange:t}),h=l.getLeftVerticalLine({viewRange:t}),p=l.getRightVerticalLine({viewRange:t});f.forEach((function(t){var e=t.borderAttr,n=t.row,o=t.col,r=e.top,c=r.color,l=r.widthType,u=r.type;i.setType(u),i.setWidthType(l),i.setColor(c),i.horizonLine(t.sx,t.sy,t.ex,t.ey,n,o,"top")})),s.forEach((function(t){var e=t.borderAttr,n=t.row,o=t.col,r=e.bottom,c=r.color,l=r.widthType,u=r.type;i.setType(u),i.setWidthType(l),i.setColor(c),i.horizonLine(t.sx,t.sy,t.ex,t.ey,n,o,"bottom")})),h.forEach((function(t){var e=t.borderAttr,n=t.row,o=t.col,r=e.left,c=r.color,l=r.widthType,u=r.type;i.setType(u),i.setWidthType(l),i.setColor(c),i.verticalLine(t.sx,t.sy,t.ex,t.ey,n,o,"left")})),p.forEach((function(t){var e=t.borderAttr,n=t.row,o=t.col,r=e.right,c=r.color,l=r.widthType,u=r.type;i.setType(u),i.setWidthType(l),i.setColor(c),i.verticalLine(t.sx,t.sy,t.ex,t.ey,n,o,"right")}));var y=c.getTopMergeHorizontalLine({brink:a}),b=c.getBottomMergeHorizontalLine({brink:a}),d=l.getLeftMergeVerticalLine({brink:a}),v=l.getRightMergeVerticalLine({brink:a});y.forEach((function(t){var e=t.borderAttr,n=t.row,o=t.col,r=e.top,c=r.color,l=r.widthType,u=r.type;i.setType(u),i.setWidthType(l),i.setColor(c),i.horizonLine(t.sx,t.sy,t.ex,t.ey,n,o,"top")})),b.forEach((function(t){var e=t.borderAttr,n=t.row,o=t.col,r=e.bottom,c=r.color,l=r.widthType,u=r.type;i.setType(u),i.setWidthType(l),i.setColor(c),i.horizonLine(t.sx,t.sy,t.ex,t.ey,n,o,"bottom")})),d.forEach((function(t){var e=t.borderAttr,n=t.row,o=t.col,r=e.left,c=r.color,l=r.widthType,u=r.type;i.setType(u),i.setWidthType(l),i.setColor(c),i.verticalLine(t.sx,t.sy,t.ex,t.ey,n,o,"left")})),v.forEach((function(t){var e=t.borderAttr,n=t.row,o=t.col,r=e.right,c=r.color,l=r.widthType,u=r.type;i.setType(u),i.setWidthType(l),i.setColor(c),i.verticalLine(t.sx,t.sy,t.ex,t.ey,n,o,"right")})),r.offset(0,0)}},{key:"render",value:function(){var t=this.table,e=t.getRenderMode();if(this.getViewMode()!==pw.STATIC||e!==gS.SCROLL){this.drawMap(),this.drawClear();var n=this.getScrollView(),o=this.getDrawX(),r=this.getDrawY(),i=n.w,c=n.h,l=t.draw,u=new Ia({rect:new Ra({x:o,y:r,width:i,height:c}),draw:l});u.open(),this.drawColor(),this.drawFont(),this.drawBoundOutFont(),this.table.settings.table.showGrid&&this.drawGrid(),this.drawBorder(),this.drawXIcon(),u.close()}}}]),e}(OS),SS=function(t){function e(){return bS(this,e),sS(this,hS(e).apply(this,arguments))}return pS(e,t),vS(e,[{key:"drawFont",value:function(){throw new TypeError("drawFont child impl")}},{key:"drawColor",value:function(){throw new TypeError("drawColor child impl")}},{key:"drawGrid",value:function(){throw new TypeError("drawGrid child impl")}},{key:"render",value:function(){var t=this.table.getRenderMode();this.getViewMode()===pw.STATIC&&t===gS.SCROLL||(this.drawMap(),this.drawClear(),this.drawColor(),this.drawGrid(),this.drawFont())}}]),e}(OS),_S=function(t){function e(){return bS(this,e),sS(this,hS(e).apply(this,arguments))}return pS(e,t),vS(e,[{key:"drawFont",value:function(){var t=this.getDrawX(),e=this.getDrawY(),n=this.getScrollView(),o=this.getWidth(),r=this.table,i=r.draw,c=r.rows,l=r.index,u=n.sri,a=n.eri;i.offset(t,e),i.attr({textAlign:"center",textBaseline:"middle",font:"".concat(l.getSize(),"px Arial"),fillStyle:l.getColor()}),c.eachHeight(u,a,(function(t,e,n){i.fillText(t+1,o/2,n+e/2)})),i.offset(0,0)}},{key:"drawGrid",value:function(){var t=this.getLineView(),e=this.getLineX(),n=this.getLineY(),o=this.table,r=o.draw,i=o.indexGrid,c=o.leftIndexHorizontalGrid,l=o.leftIndexVerticalGrid;r.offset(e,n);var u=c.getHorizontalLine({viewRange:t}),a=l.getVerticalLine({viewRange:t});u.forEach((function(t){i.horizonLine(t.sx,t.sy,t.ex,t.ey)})),a.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)})),r.offset(0,0)}},{key:"drawColor",value:function(){var t=this.getDrawX(),e=this.getDrawY(),n=this.getScrollView().h,o=this.getWidth(),r=this.table,i=r.draw,c=r.index;i.offset(t,e),i.attr({fillStyle:c.getBackground()}),i.fillRect(0,0,o,n),i.offset(0,0)}}]),e}(SS),TS=function(t){function e(){return bS(this,e),sS(this,hS(e).apply(this,arguments))}return pS(e,t),vS(e,[{key:"drawFont",value:function(){var t=this.getDrawX(),e=this.getDrawY(),n=this.getScrollView(),o=this.getHeight(),r=this.table,i=r.draw,c=r.cols,l=r.index,u=n.sci,a=n.eci;i.offset(t,e),i.attr({textAlign:"center",textBaseline:"middle",font:"".concat(l.getSize(),"px Arial"),fillStyle:l.getColor()}),c.eachWidth(u,a,(function(t,e,n){i.fillText(S.stringAt(t),n+e/2,o/2)})),i.offset(0,0)}},{key:"drawGrid",value:function(){var t=this.getLineView(),e=this.getLineX(),n=this.getLineY(),o=this.table,r=o.draw,i=o.indexGrid,c=o.topIndexVerticalGrid,l=o.topIndexHorizontalGrid;r.offset(e,n);var u=l.getHorizontalLine({viewRange:t}),a=c.getVerticalLine({viewRange:t});u.forEach((function(t){i.horizonLine(t.sx,t.sy,t.ex,t.ey)})),a.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)})),r.offset(0,0)}},{key:"drawColor",value:function(){var t=this.table,e=t.draw,n=t.index,o=this.getScrollView(),r=this.getDrawX(),i=this.getDrawY(),c=this.getHeight(),l=o.w;e.offset(r,i),e.attr({fillStyle:n.getBackground()}),e.fillRect(0,0,l,c),e.offset(0,0)}}]),e}(SS),xS=function(t){function e(){return bS(this,e),sS(this,hS(e).apply(this,arguments))}return pS(e,t),vS(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table.xFixedMeasure.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table.index.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;return this.y=0,0}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.rows,n=t.cols,o=t.xFixedView.getFixedView(),r=new xs(0,o.sci,0,o.eci);return r.w=n.rectRangeSumWidth(r),r.h=e.rectRangeSumHeight(r),this.scrollView=r,r.clone()}},{key:"getFullScrollView",value:function(){if(S.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.getScrollView();return this.fullScrollView=t,t.clone()}},{key:"getViewMode",value:function(){return this.viewMode=pw.STATIC,pw.STATIC}},{key:"render",value:function(){var t=this.table.getRenderMode();t!==gS.RENDER&&t!==gS.SCALE||uS(hS(e.prototype),"render",this).call(this)}}]),e}(TS),kS=function(t){function e(){return bS(this,e),sS(this,hS(e).apply(this,arguments))}return pS(e,t),vS(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table.index.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table.xFixedMeasure.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;return this.x=0,0}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.rows,n=t.cols,o=t.xFixedView.getFixedView(),r=new xs(o.sri,0,o.eri,0);return r.w=n.rectRangeSumWidth(r),r.h=e.rectRangeSumHeight(r),this.scrollView=r,r.clone()}},{key:"getFullScrollView",value:function(){if(S.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.getScrollView();return this.fullScrollView=t,t.clone()}},{key:"getViewMode",value:function(){return this.viewMode=pw.STATIC,pw.STATIC}},{key:"render",value:function(){var t=this.table.getRenderMode();t!==gS.RENDER&&t!==gS.SCALE||uS(hS(e.prototype),"render",this).call(this)}}]),e}(_S),PS=function(t){function e(){return bS(this,e),sS(this,hS(e).apply(this,arguments))}return pS(e,t),vS(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table.xFixedMeasure.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table.xFixedMeasure.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.rows,n=t.cols,o=t.xFixedView.getFixedView();return o.w=n.rectRangeSumWidth(o),o.h=e.rectRangeSumHeight(o),this.scrollView=o,o.clone()}},{key:"getFullScrollView",value:function(){if(S.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.getScrollView();return this.fullScrollView=t,t.clone()}},{key:"getViewMode",value:function(){return this.viewMode=pw.STATIC,pw.STATIC}},{key:"render",value:function(){var t=this.table.getRenderMode();t!==gS.RENDER&&t!==gS.SCALE||uS(hS(e.prototype),"render",this).call(this)}}]),e}(ES),jS=function(t){function e(){return bS(this,e),sS(this,hS(e).apply(this,arguments))}return pS(e,t),vS(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table,e=t.xLeft,n=t.index,o=t.visualWidth()-(n.getWidth()+e.getWidth());return this.width=o,o}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table.index.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,n=t.index.getWidth()+e.getWidth();return this.x=n,n}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;return this.y=0,0}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.index,n=t.xTableAreaView,o=t.getRenderMode(),r=n.getScrollView(),i=n.getScrollEnterView(),c=S.isNotUnDef(i)&&o===gS.SCROLL?i:r;return c.sri=0,c.eri=0,c.h=e.getHeight(),this.scrollView=c,c.clone()}},{key:"getFullScrollView",value:function(){if(S.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table,e=t.index,n=t.xTableAreaView.getScrollView();return n.sri=0,n.eri=0,n.h=e.getHeight(),this.fullScrollView=n,n.clone()}},{key:"getViewMode",value:function(){if(S.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table,e=t.xTableAreaView,n=t.rows,o=e.getLastScrollView(),r=e.getScrollView();S.isNotUnDef(o)&&(o.sri=0,o.eri=0,o.h=n.sectionSumHeight(o.sri,o.eri)),r.sri=0,r.eri=0,r.h=n.sectionSumHeight(r.sri,r.eri);var i=yw.viewMode(o,r);return this.viewMode=i,i}}]),e}(TS),CS=function(t){function e(){return bS(this,e),sS(this,hS(e).apply(this,arguments))}return pS(e,t),vS(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table.index.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,n=t.index,o=t.visualHeight()-(n.getHeight()+e.getHeight());return this.height=o,o}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;return this.x=0,0}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,n=t.index.getHeight()+e.getHeight();return this.y=n,n}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.xTableAreaView,n=t.index,o=t.getRenderMode(),r=e.getScrollView(),i=e.getScrollEnterView(),c=S.isNotUnDef(i)&&o===gS.SCROLL?i:r;return c.sci=0,c.eci=0,c.w=n.getWidth(),this.scrollView=c,c.clone()}},{key:"getFullScrollView",value:function(){if(S.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table,e=t.index,n=t.xTableAreaView.getScrollView();return n.sci=0,n.eci=0,n.w=e.getWidth(),this.fullScrollView=n,n.clone()}},{key:"getViewMode",value:function(){if(S.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table,e=t.xTableAreaView,n=t.cols,o=e.getLastScrollView(),r=e.getScrollView();S.isNotUnDef(o)&&(o.sci=0,o.eci=0,o.w=n.sectionSumWidth(o.sci,o.eci)),r.sci=0,r.eci=0,r.w=n.sectionSumWidth(r.sci,r.eci);var i=yw.viewMode(o,r);return this.viewMode=i,i}}]),e}(_S),RS=function(t){function e(){return bS(this,e),sS(this,hS(e).apply(this,arguments))}return pS(e,t),vS(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table.xFixedMeasure.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,n=t.index,o=t.visualHeight()-(n.getHeight()+e.getHeight());return this.height=o,o}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,n=t.index.getHeight()+e.getHeight();return this.y=n,n}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.xFixedView,n=t.cols,o=t.xTableAreaView,r=t.getRenderMode(),i=e.getFixedView(),c=o.getScrollView(),l=o.getScrollEnterView(),u=S.isNotUnDef(l)&&r===gS.SCROLL?l:c;return u.sci=i.sci,u.eci=i.eci,u.w=n.sectionSumWidth(u.sci,u.eci),this.scrollView=u,u.clone()}},{key:"getFullScrollView",value:function(){if(S.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table,e=t.xFixedView,n=t.cols,o=t.xTableAreaView,r=e.getFixedView(),i=o.getScrollView();return i.sci=r.sci,i.eci=r.eci,i.w=n.sectionSumWidth(i.sci,i.eci),this.fullScrollView=i,i.clone()}},{key:"getViewMode",value:function(){if(S.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table,e=t.xTableAreaView,n=t.cols,o=t.xFixedView.getFixedView(),r=e.getLastScrollView(),i=e.getScrollView();S.isNotUnDef(r)&&(r.sci=o.sci,r.eci=o.eci,r.w=n.sectionSumWidth(r.sci,r.eci)),i.sci=o.sci,i.eci=o.eci,i.w=n.sectionSumWidth(i.sci,i.eci);var c=yw.viewMode(r,i);return this.viewMode=c,c}}]),e}(ES),LS=function(t){function e(){return bS(this,e),sS(this,hS(e).apply(this,arguments))}return pS(e,t),vS(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table,e=t.xLeft,n=t.index,o=t.visualWidth()-(n.getWidth()+e.getWidth());return this.width=o,o}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table.xFixedMeasure.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,n=t.index.getWidth()+e.getWidth();return this.x=n,n}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.xFixedView,n=t.rows,o=t.xTableAreaView,r=t.getRenderMode(),i=e.getFixedView(),c=o.getScrollView(),l=o.getScrollEnterView(),u=S.isNotUnDef(l)&&r===gS.SCROLL?l:c;return u.sri=i.sri,u.eri=i.eri,u.h=n.sectionSumHeight(u.sri,u.eri),this.scrollView=u,u.clone()}},{key:"getFullScrollView",value:function(){if(S.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table,e=t.xFixedView,n=t.rows,o=t.xTableAreaView,r=e.getFixedView(),i=o.getScrollView();return i.sri=r.sri,i.eri=r.eri,i.h=n.sectionSumHeight(i.sri,i.eri),this.fullScrollView=i,i.clone()}},{key:"getViewMode",value:function(){if(S.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table,e=t.xTableAreaView,n=t.rows,o=t.xFixedView.getFixedView(),r=e.getLastScrollView(),i=e.getScrollView();S.isNotUnDef(r)&&(r.sri=o.sri,r.eri=o.eri,r.h=n.sectionSumHeight(r.sci,r.eci)),i.sri=o.sri,i.eri=o.eri,i.h=n.sectionSumHeight(i.sci,i.eci);var c=yw.viewMode(r,i);return this.viewMode=c,c}}]),e}(ES),AS=function(t){function e(){return bS(this,e),sS(this,hS(e).apply(this,arguments))}return pS(e,t),vS(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table,e=t.index,n=t.xLeft,o=t.visualWidth()-(e.getWidth()+n.getWidth());return this.width=o,o}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,n=t.index,o=t.visualHeight()-(n.getHeight()+e.getHeight());return this.height=o,o}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,n=t.index.getWidth()+e.getWidth();return this.x=n,n}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,n=t.index.getHeight()+e.getHeight();return this.y=n,n}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.xTableAreaView,n=t.getRenderMode(),o=e.getScrollView(),r=e.getScrollEnterView(),i=S.isNotUnDef(r)&&n===gS.SCROLL?r:o;return this.scrollView=i,i.clone()}},{key:"getFullScrollView",value:function(){if(S.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table.xTableAreaView.getScrollView();return this.fullScrollView=t,t.clone()}},{key:"getViewMode",value:function(){if(S.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table.xTableAreaView,e=t.getLastScrollView(),n=t.getScrollView(),o=yw.viewMode(e,n);return this.viewMode=o,o}}]),e}(ES),NS=function(t){function e(t){var n,o=t.xTableScrollView,i=t.settings,c=t.xFixedView,l=t.scroll;bS(this,e),(n=sS(this,hS(e).call(this,"".concat(r,"-table-canvas"),"canvas"))).settings=i,n.scroll=l,n.xFixedView=c,n.renderMode=gS.RENDER,n.scale=new ag,n.index=new hg(cS({scaleAdapter:new sg({goto:function(t){return hc.srcTransformStylePx(n.scale.goto(t))}})},n.settings.index)),n.rows=new yg(cS({scaleAdapter:new sg({goto:function(t){return hc.srcTransformStylePx(n.scale.goto(t))}})},n.settings.rows)),n.cols=new dg(cS({scaleAdapter:new sg({goto:function(t){return hc.srcTransformStylePx(n.scale.goto(t))},back:function(t){return n.scale.back(t)}})},n.settings.cols)),n.merges=new Fm(cS({},n.settings.merge,{rows:n.rows,cols:n.cols})),n.cells=new Dw({rows:n.rows,cols:n.cols,data:n.settings.data,merges:n.merges}),n.xFixedMeasure=new GE({fixedView:n.xFixedView,cols:n.cols,rows:n.rows}),n.staticCellIcon=new rS({data:[],cells:n.cells,rows:n.rows,cols:n.cols}),n.fixedCellIcon=new JE({data:[],cells:n.cells,rows:n.rows,cols:n.cols}),n.xTableAreaView=new ME({xTableScrollView:o,scroll:n.scroll,rows:n.rows,cols:n.cols}),n.operateCellsHelper=new UE({xTableAreaView:n.xTableAreaView,cells:n.cells,merges:n.merges,rows:n.rows,cols:n.cols}),n.styleCellsHelper=new jm({xTableAreaView:n.xTableAreaView,cells:n.cells,merges:n.merges,rows:n.rows,cols:n.cols}),n.textCellsHelper=new Mm({xTableAreaView:n.xTableAreaView,cells:n.cells,merges:n.merges,rows:n.rows,cols:n.cols});var u=new tO({merges:n.merges,cols:n.cols,cells:n.cells}),a=new Zm({merges:n.merges,cols:n.cols,cells:n.cells}),s=new NO(AO.AND,[new Wm((function(t,e){var o=n.cells.getCell(t,e);return!S.isUnDef(o)&&o.borderAttr.right.display})),new Wm((function(t,e){return u.execute(t,e)}))]),f=new NO(AO.AND,[new Wm((function(t,e){var o=n.cells.getCell(t,e);return!S.isUnDef(o)&&o.borderAttr.left.display})),new Wm((function(t,e){return a.execute(t,e)}))]),h=new Wm((function(t,e){var o=n.cells.getCell(t,e);return!S.isUnDef(o)&&o.borderAttr.top.display})),p=new Wm((function(t,e){var o=n.cells.getCell(t,e);return!S.isUnDef(o)&&o.borderAttr.bottom.display}));return n.draw=new hc(n.el),n.line=new mc(n.draw,{leftShow:function(t,e){return f.execute(t,e)},topShow:function(t,e){return h.execute(t,e)},rightShow:function(t,e){return s.execute(t,e)},bottomShow:function(t,e){return p.execute(t,e)},iFMerge:function(t,e){return null!==n.merges.getFirstIncludes(t,e)},iFMergeFirstRow:function(t,e){return n.merges.getFirstIncludes(t,e).sri===t},iFMergeLastRow:function(t,e){return n.merges.getFirstIncludes(t,e).eri===t},iFMergeFirstCol:function(t,e){return n.merges.getFirstIncludes(t,e).sci===e},iFMergeLastCol:function(t,e){return n.merges.getFirstIncludes(t,e).eci===e}}),n.indexGrid=new kw(n.draw,{color:n.index.getGridColor()}),n.grid=new kw(n.draw,{color:n.settings.table.gridColor}),n.textFont=new Om({scaleAdapter:new sg({goto:function(t){return n.scale.goto(t)}})}),n.cellHorizontalGrid=new FO({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,drawCheck:!0}),n.cellVerticalGrid=new GO({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,drawCheck:!0}),n.topIndexHorizontalGrid=new FO({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,foldOnOff:!1,getHeight:function(){return n.index.getHeight()}}),n.topIndexVerticalGrid=new GO({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,foldOnOff:!1,getHeight:function(){return n.index.getHeight()}}),n.leftIndexHorizontalGrid=new FO({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,foldOnOff:!1,getWidth:function(){return n.index.getWidth()}}),n.leftIndexVerticalGrid=new GO({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,foldOnOff:!1,getWidth:function(){return n.index.getWidth()}}),n.cellHorizontalBorder=new _E({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,drawOptimization:!0}),n.cellVerticalBorder=new CE({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,drawOptimization:!0}),n.xLeftFrozenIndex=new kS(fS(n)),n.xTopFrozenIndex=new xS(fS(n)),n.xTableFrozenContent=new PS(fS(n)),n.xLeftIndex=new CS(fS(n)),n.xTopIndex=new jS(fS(n)),n.xLeft=new RS(fS(n)),n.xTop=new LS(fS(n)),n.xContent=new AS(fS(n)),n.xTableFrozenFullRect=new wS(fS(n)),n.xTableFixedBar=new mS(fS(n),i.xFixedBar),n.merges.sync(),n}return pS(e,t),vS(e,[{key:"drawBorderOptimize",value:function(){var t=this.styleCellsHelper,e=this.xTableAreaView,n=this.cellHorizontalBorder,o=this.cellVerticalBorder,r=e.getScrollView(),i=!0;t.getCellByViewRange({rectRange:r,callback:function(t,e,n){var o=n.borderAttr,r=o.top,c=o.left,l=o.right,u=o.bottom;return r.type===dc.DOUBLE_LINE?i=!1:c.type===dc.DOUBLE_LINE?i=!1:l.type===dc.DOUBLE_LINE?i=!1:u.type!==dc.DOUBLE_LINE||(i=!1)}}),i?(n.enableOptimization(),o.enableOptimization()):(n.disableOptimization(),o.disableOptimization())}},{key:"getRenderMode",value:function(){return this.renderMode}},{key:"visualWidth",value:function(){return this.el.width}},{key:"visualHeight",value:function(){return this.el.height}},{key:"reset",value:function(){var t=this.xTableAreaView,e=this.xLeftFrozenIndex,n=this.xTopFrozenIndex,o=this.xTableFrozenContent,r=this.xLeftIndex,i=this.xTopIndex,c=this.xLeft,l=this.xTop,u=this.xContent;t.reset(),e.reset(),n.reset(),o.reset(),r.reset(),i.reset(),c.reset(),l.reset(),u.reset()}},{key:"setScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.draw.attr({fillStyle:this.settings.table.background}),this.draw.fullRect(),this.scale.setValue(t),this.renderMode=gS.SCALE,this.resize(),this.renderMode=gS.RENDER}},{key:"resize",value:function(){var t=this.draw,e=this.xTableAreaView,n=this.parent().box();t.resize(n.width,n.height),e.undo(),this.reset(),this.render()}},{key:"render",value:function(){var t=this.xFixedView,e=this.xTableFrozenFullRect,n=this.xTableFixedBar,o=this.xLeftFrozenIndex,r=this.xTopFrozenIndex,i=this.xTableFrozenContent,c=this.xLeftIndex,l=this.xTopIndex,u=this.xLeft,a=this.xTop,s=this.xContent;this.drawBorderOptimize(),e.render(),t.hasFixedLeft()&&t.hasFixedTop()&&i.render(),t.hasFixedTop()&&(o.render(),a.render()),t.hasFixedLeft()&&(r.render(),u.render()),c.render(),l.render(),s.render(),n.render()}},{key:"scrolling",value:function(){var t=this.xTableAreaView;this.reset(),this.renderMode=gS.SCROLL,this.render(),t.record(),this.renderMode=gS.RENDER,this.reset()}}]),e}(B);function IS(t){return(IS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function VS(t,e){return!e||"object"!==IS(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function DS(t){return(DS=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function MS(t,e){return(MS=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var HS=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),VS(this,DS(e).call(this,"".concat(r,"-x-screen-zone ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&MS(t,e)}(e,t),e}(B);function FS(t){return(FS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function BS(t,e){return!e||"object"!==FS(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function WS(t){return(WS=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function YS(t,e){return(YS=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var US=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),BS(this,WS(e).call(this,"".concat(r,"-x-screen-br-zone")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&YS(t,e)}(e,t),e}(HS);function zS(t){return(zS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function GS(t,e){return!e||"object"!==zS(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function XS(t){return(XS=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ZS(t,e){return(ZS=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var KS=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=GS(this,XS(e).call(this,"".concat(r,"-x-screen-lt-zone")))).xScreen=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ZS(t,e)}(e,t),e}(HS);function $S(t){return($S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qS(t,e){return!e||"object"!==$S(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function QS(t){return(QS=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function JS(t,e){return(JS=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var t_=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),qS(this,QS(e).call(this,"".concat(r,"-x-screen-l-zone")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&JS(t,e)}(e,t),e}(HS);function e_(t){return(e_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n_(t,e){return!e||"object"!==e_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o_(t){return(o_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r_(t,e){return(r_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var i_=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n_(this,o_(e).call(this,"".concat(r,"-x-screen-t-zone")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r_(t,e)}(e,t),e}(HS);function c_(t){return(c_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l_(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u_(t,e){return!e||"object"!==c_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a_(t,e,n){return(a_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s_(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function s_(t){return(s_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f_(t,e){return(f_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h_={BRT:Symbol("BRT"),BRL:Symbol("BRL"),BR:Symbol("br"),ALL:Symbol("ALL")},p_=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=u_(this,s_(e).call(this,"".concat(r,"-x-screen")))).pool=[],n.table=t,n.displayArea=h_.BR,n.ltZone=new KS,n.tZone=new i_,n.brZone=new US,n.lZone=new t_,n.children(n.ltZone),n.children(n.tZone),n.children(n.brZone),n.children(n.lZone),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f_(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind(),this.setZone()}},{key:"unbind",value:function(){var t=this.table;L.unbind(t)}},{key:"bind",value:function(){var t=this,e=this.table;L.bind(e,o.TABLE_EVENT_TYPE.SCALE_CHANGE,(function(){t.setZone()})),L.bind(e,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.setZone()})),L.bind(e,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.setZone()}))}},{key:"addItem",value:function(t){this.pool.push(t),this.ltZone.attach(t.lt),this.tZone.attach(t.t),this.lZone.attach(t.l),this.brZone.attach(t.br),t.setXScreen(this),t.onAdd(this)}},{key:"setZone",value:function(){var t=this.table,e=t.index,n=t.getFixedHeight(),o=t.getFixedWidth(),r=e.getHeight()+n,i=e.getWidth()+o;this.brZone.offset({left:i,top:r});var c=o>0&&n>0,l=n>0,u=o>0;this.ltZone.hide(),this.lZone.hide(),this.tZone.hide();var a=hc.dpr();c?(this.displayArea=h_.ALL,this.ltZone.offset({left:e.getWidth(),top:e.getHeight(),width:o,height:n}).show(),this.ltZone.css("border-width","".concat(a,"px")),this.lZone.offset({left:e.getWidth(),top:r,width:o,height:t.visualHeight()-e.getHeight()-n}).show(),this.lZone.css("border-width","".concat(a,"px")),this.tZone.offset({left:i,top:e.getHeight(),width:t.visualWidth()-e.getWidth()-o,height:n}).show(),this.tZone.css("border-width","".concat(a,"px"))):u?(this.displayArea=h_.BRL,this.lZone.offset({left:e.getWidth(),top:r,width:o,height:t.visualHeight()-e.getHeight()-n}).show(),this.lZone.css("border-width","".concat(a,"px"))):l?(this.displayArea=h_.BRL,this.tZone.offset({left:i,top:e.getHeight(),width:t.visualWidth()-e.getWidth()-o,height:n}).show(),this.tZone.css("border-width","".concat(a,"px"))):this.displayArea=h_.BR}},{key:"findType",value:function(t){var e=!0,n=!1,o=void 0;try{for(var r,i=this.pool[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var c=r.value;if(c instanceof t)return c}}catch(t){n=!0,o=t}finally{try{e||null==i.return||i.return()}finally{if(n)throw o}}return null}},{key:"destroy",value:function(){a_(s_(e.prototype),"destroy",this).call(this),this.unbind(),this.pool.forEach((function(t){t.destroy()}))}}])&&l_(n.prototype,i),c&&l_(n,c),e}(B);function y_(t){return(y_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b_(t,e){return!e||"object"!==y_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d_(t){return(d_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v_(t,e){return(v_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var g_=function(t){function e(t){var n,o=t.text,i=t.value;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=b_(this,d_(e).call(this,"".concat(r,"-auto-fill-menu-item")))).text=o,n.value=i,n.textEle=k("div","".concat(r,"-auto-fill-menu-item-title")),n.textEle.text(o),n.children(n.textEle),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v_(t,e)}(e,t),e}(le);function w_(t){return(w_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m_(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function O_(t,e){return!e||"object"!==w_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function E_(t,e,n){return(E_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=S_(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function S_(t){return(S_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function __(t,e){return(__=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var T_=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{onUpdate:function(){}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=O_(this,S_(e).call(this,"".concat(r,"-auto-fill-menu"),n))).addItem(new g_({text:"以序列的方式填充",value:e.FILL_TYPE.SERIALIZE}).attr("title","只有在起始单元格内容为数字时才生效")),t.addItem(new g_({text:"填充单元格内容",value:e.FILL_TYPE.FILLING}).attr("title","默认使用内容填充")),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&__(t,e)}(e,t),n=e,(i=[{key:"unbind",value:function(){this.menus.forEach((function(t){L.unbind(t)}))}},{key:"bind",value:function(){var t=this;this.menus.forEach((function(e){L.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.options.onUpdate(e)}))}))}},{key:"destroy",value:function(){E_(S_(e.prototype),"destroy",this).call(this),this.unbind()}}])&&m_(n.prototype,i),c&&m_(n,c),e}(ne);function x_(t){return(x_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function k_(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function P_(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j_(t,e,n){return(j_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=C_(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function C_(t){return(C_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function R_(t,e){return(R_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}T_.FILL_TYPE={SERIALIZE:1,FILLING:2};var L_=function(t){function e(){var t,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{onUpdate:function(){}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,o=C_(e).call(this,"".concat(r,"-auto-fill-type"),i),(t=!o||"object"!==x_(o)&&"function"!=typeof o?P_(n):o).autoFillTypeMenu=new T_({el:P_(t),onUpdate:function(e){t.options.onUpdate(e),t.autoFillTypeMenu.close(),t.close()}}),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&R_(t,e)}(e,t),n=e,(i=[{key:"bind",value:function(){var t=this;L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.autoFillTypeMenu.open()}))}},{key:"destroy",value:function(){j_(C_(e.prototype),"destroy",this).call(this),this.autoFillTypeMenu.destroy()}}])&&k_(n.prototype,i),c&&k_(n,c),e}(ne);function A_(t){return(A_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function N_(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function I_(t,e){return!e||"object"!==A_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function V_(t){return(V_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function D_(t,e){return(D_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function M_(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function H_(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function F_(t,e,n){return e&&H_(t.prototype,e),n&&H_(t,n),t}var B_=function(){function t(e){var n=e.targetViewRange,o=e.originViewRange,r=e.merge,i=void 0===r?function(){}:r,c=e.master,l=void 0===c?function(){}:c,u=e.onCopy,a=void 0===u?function(){}:u;M_(this,t),this.targetViewRange=n,this.originViewRange=o,this.master=l,this.merge=i,this.onCopy=a}return F_(t,[{key:"copyStartRow",value:function(){return this.originViewRange.sri}},{key:"copyEndRow",value:function(){return this.originViewRange.eri}},{key:"nextCopyRow",value:function(t){return t>=this.copyEndRow()?this.copyStartRow():t+1}},{key:"copyStartCol",value:function(){return this.originViewRange.sci}},{key:"copyEndCol",value:function(){return this.originViewRange.eci}},{key:"nextCopyCol",value:function(t){return t>=this.copyEndCol()?this.copyStartCol():t+1}},{key:"pasteStartRow",value:function(){return this.targetViewRange.sri}},{key:"pasteEndRow",value:function(){return this.targetViewRange.eri}},{key:"pasteStartCol",value:function(){return this.targetViewRange.sci}},{key:"pasteEndCol",value:function(){return this.targetViewRange.eci}},{key:"executeCopy",value:function(){var t=this,e=this.copyStartRow();vs.getInstance().setBegin(this.pasteStartRow()).setEnd(this.pasteEndRow()).setLoop((function(n){var o=t.copyStartCol();Ss.getInstance().setBegin(t.pasteStartCol()).setEnd(t.pasteEndCol()).setLoop((function(r){var i=t.merge(e,o);i&&t.master(e,o,i)&&t.onCopy(n,r,i)})).setNext((function(){o=t.nextCopyCol(o)})).execute()})).setNext((function(){e=t.nextCopyRow(e)})).foldOnOff(!1).execute()}}]),t}(),W_=function(){function t(e){var n=e.targetViewRange,o=e.originViewRange,r=e.onCopy,i=void 0===r?function(){}:r;M_(this,t),this.targetViewRange=n,this.originViewRange=o,this.onCopy=i}return F_(t,[{key:"copyStartRow",value:function(){var t=this.originViewRange,e=t.sri,n=t.eri;return vs.getInstance().setBegin(e-1).setEnd(n).nextRow()}},{key:"copyEndRow",value:function(){var t=this.originViewRange,e=t.sri,n=t.eri;return vs.getInstance().setBegin(n+1).setEnd(e).nextRow()}},{key:"nextCopyRow",value:function(t){var e=this.copyEndRow();return t>=e?this.copyStartRow():vs.getInstance().setBegin(t).setEnd(e).nextRow()}},{key:"copyStartCol",value:function(){return this.originViewRange.sci}},{key:"copyEndCol",value:function(){return this.originViewRange.eci}},{key:"nextCopyCol",value:function(t){return t>=this.copyEndCol()?this.copyStartCol():t+1}},{key:"pasteStartRow",value:function(){return this.targetViewRange.sri}},{key:"pasteEndRow",value:function(){return this.targetViewRange.eri}},{key:"pasteStartCol",value:function(){return this.targetViewRange.sci}},{key:"pasteEndCol",value:function(){return this.targetViewRange.eci}},{key:"executeCopy",value:function(){var t=this,e=this.copyStartRow();vs.getInstance().setBegin(this.pasteStartRow()).setEnd(this.pasteEndRow()).setLoop((function(n){var o=t.copyStartCol();Ss.getInstance().setBegin(t.pasteStartCol()).setEnd(t.pasteEndCol()).setLoop((function(r){t.onCopy(n,r,e,o)})).setNext((function(){o=t.nextCopyCol(o)})).execute()})).setNext((function(){e=t.nextCopyRow(e)})).execute()}}]),t}(),Y_=function(){function t(e){var n=e.originViewRange,o=e.direction,r=e.getStartIndex,i=e.onSerialize;M_(this,t),this.originViewRange=n,this.direction=o,this.getStartIndex=r,this.onSerialize=i}return F_(t,[{key:"serializeRight",value:function(){var t=this.originViewRange,e=this.onSerialize,n=this.getStartIndex,o=t.sri,r=t.sci,i=t.eri,c=t.eci,l=!0;vs.getInstance().setBegin(o).setEnd(i).setLoop((function(t){var o=S.Nul;return Ss.getInstance().setBegin(r).setEnd(c).setLoop((function(r){if(o===S.Nul){var i=n(t,r);S.isNumber(i)?o=parseInt(i,10):l=!1}else e(t,r,o+=1);return l})).execute(),l})).execute()}},{key:"serializeBottom",value:function(){var t=this.originViewRange,e=this.onSerialize,n=this.getStartIndex,o=t.sri,r=t.sci,i=t.eri,c=t.eci,l=!0;Ss.getInstance().setBegin(r).setEnd(c).setLoop((function(t){var r=S.Nul;return vs.getInstance().setBegin(o).setEnd(i).setLoop((function(o){if(r===S.Nul){var i=n(o,t);S.isNumber(i)?r=parseInt(i,10):l=!1}else e(o,t,r+=1);return l})).execute(),l})).execute()}},{key:"serializeTop",value:function(){var t=this.originViewRange,e=this.onSerialize,n=this.getStartIndex,o=t.sri,r=t.sci,i=t.eri,c=t.eci,l=!0;Ss.getInstance().setBegin(r).setEnd(c).setLoop((function(t){var r=S.Nul;return vs.getInstance().setBegin(i).setEnd(o).setLoop((function(o){if(r===S.Nul){var i=n(o,t);S.isNumber(i)?r=parseInt(i,10):l=!1}else e(o,t,r-=1);return l})).execute(),l})).execute()}},{key:"serializeLeft",value:function(){var t=this.originViewRange,e=this.onSerialize,n=this.getStartIndex,o=t.sri,r=t.sci,i=t.eri,c=t.eci,l=!0;vs.getInstance().setBegin(o).setEnd(i).setLoop((function(t){var o=S.Nul;return Ss.getInstance().setBegin(c).setEnd(r).setLoop((function(r){if(o===S.Nul){var i=n(t,r);S.isNumber(i)?o=parseInt(i,10):l=!1}else e(t,r,o-=1)})).execute(),l})).execute()}},{key:"executeSerialize",value:function(){switch(this.direction){case t.SERIALIZE_DIRECTION.LEFT:this.serializeLeft();break;case t.SERIALIZE_DIRECTION.TOP:this.serializeTop();break;case t.SERIALIZE_DIRECTION.RIGHT:this.serializeRight();break;case t.SERIALIZE_DIRECTION.BOTTOM:this.serializeBottom()}}}]),t}();Y_.SERIALIZE_DIRECTION={RIGHT:3,BOTTOM:4,TOP:1,LEFT:2};var U_=function(t){function e(){return M_(this,e),I_(this,V_(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&D_(t,e)}(e,t),F_(e,[{key:"copyCellINContent",value:function(t){var e=t.originViewRange,n=t.targetViewRange,o=this.cells,r=this.tableDataSnapshot.cellDataProxy;new W_({originViewRange:e,targetViewRange:n,onCopy:function(t,e,n,i){var c=o.getCell(n,i);if(c){var l=c.clone();r.setCell(t,e,l)}}}).executeCopy()}},{key:"copyMergeContent",value:function(t){var e=t.originViewRange,n=t.targetViewRange,o=this.merges,r=this.tableDataSnapshot.mergeDataProxy;new B_({originViewRange:e,targetViewRange:n,merge:function(t,e){return o.getFirstIncludes(t,e)},master:function(t,e,n){return n.sri===t&&n.sci===e},onCopy:function(t,e,n){var i=N_(n.size(),2),c=i[0],l=i[1],u=new xs(t,e,t+(c-=1),e+(l-=1));vs.getInstance().setBegin(u.sri).setEnd(u.eri).hasFold()||(u.each((function(t,e){var n=o.getFirstIncludes(t,e);n&&r.deleteMerge(n)})),r.addMerge(u))}}).executeCopy()}},{key:"copyStylesContent",value:function(t){var e=t.originViewRange,n=t.targetViewRange,o=this.cells,r=this.tableDataSnapshot.cellDataProxy;new W_({originViewRange:e,targetViewRange:n,onCopy:function(t,e,n,i){var c=o.getCell(n,i);if(c){var l=o.getCellOrNew(t,e),u=c.clone();u.text=l.text,r.setCell(t,e,u)}}}).executeCopy()}},{key:"serializeContent",value:function(t){var e=t.originViewRange,n=t.direction,o=this.tableDataSnapshot,r=this.cells,i=o.cellDataProxy;new Y_({originViewRange:e,direction:n,getStartIndex:function(t,e){var n=r.getCell(t,e);return n?n.text:S.Nul},onSerialize:function(t,e,n){var o=r.getCellOrNew(t,e).clone();o.text="".concat(n),i.setCell(t,e,o)}}).executeSerialize()}}]),e}(Sm);function z_(t){return(z_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function G_(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function X_(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Z_(t,e){return!e||"object"!==z_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function K_(t,e,n){return(K_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$_(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function $_(t){return($_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function q_(t,e){return(q_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Q_=function(t){function e(t){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Z_(this,$_(e).call(this,{table:t}))).options=S.mergeDeep({mergeForceSplit:!1,onBeforeAutoFill:function(){},onAfterAutoFill:function(){}},o),n.moveDirection=null,n.autoFillRange=xs.EMPTY,n.display=!1,n.ltElem=new B("".concat(r,"-x-autofill-area")),n.brElem=new B("".concat(r,"-x-autofill-area")),n.lElem=new B("".concat(r,"-x-autofill-area")),n.tElem=new B("".concat(r,"-x-autofill-area")),n.blt.children(n.ltElem),n.bl.children(n.lElem),n.bt.children(n.tElem),n.bbr.children(n.brElem),n.setBorderType("dashed"),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&q_(t,e)}(e,t),n=e,(i=[{key:"onAdd",value:function(){this.bind(),this.hide()}},{key:"unbind",value:function(){var t=this.xScreen.findType(kh);L.bind([t.ltCorner,t.tCorner,t.lCorner,t.brCorner]),L.bind([t.ltCorner,t.tCorner,t.lCorner,t.brCorner]),L.bind([t.ltCorner,t.tCorner,t.lCorner,t.brCorner])}},{key:"bind",value:function(){var t=this,n=this.table,r=this.xScreen,i=n.mousePointer,c=r.findType(kh),l=new L_({onUpdate:function(e){switch(e.value){case T_.FILL_TYPE.SERIALIZE:t.serialize();break;case T_.FILL_TYPE.FILLING:}}});L.bind([c.ltCorner,c.tCorner,c.lCorner,c.brCorner],o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){i.free(e)})),L.bind([c.ltCorner,c.tCorner,c.lCorner,c.brCorner],o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){i.lock(e),i.set(wh.KEYS.crosshair,e)})),L.bind([c.ltCorner,c.tCorner,c.lCorner,c.brCorner],o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(o){t.display=!0,i.lock(e),i.set(wh.KEYS.crosshair,e);var r=n.eventXy(o),u=r.x,a=r.y;t.rangeHandle(u,a),t.offsetHandle(),t.borderHandle(),L.mouseMoveUp(document,(function(e){var o=n.eventXy(e),r=o.x,i=o.y;t.rangeHandle(r,i),t.offsetHandle(),t.borderHandle()}),(function(){t.display=!1,i.free(e),t.autoFill(),t.hide();var n=t.autoFillRange;if(!n.equals(xs.EMPTY)){var o=c.selectRange;c.setRange(o.union(n));var r=c.activeCorner;l.setEL(r),l.open()}}))}))}},{key:"rangeHandle",value:function(t,e){var n=this.table,o=n.xScreen.findType(kh),r=n.getTableMerges(),i=o.selectRange,c=o.selectLocal,l=n.cols,u=n.rows,a=i.sri,s=i.sci,f=i.eri,h=i.eci,p=n.getRiCiByXy(t,e),y=p.ri,b=p.ci,d=r.getFirstIncludes(a,s),v=xh.BR!==c||S.isNotUnDef(d),g=G_(i.size(),2),w=g[0],m=g[1],O=y,E=b;O<0?O=0:O>u.len&&(O=u.len-1),E<0?E=0:E>l.len&&(E=l.len-1);var _=xs.EMPTY,T=S.Undef;if(O<a||y>f){if(O<a)if(T=Y_.SERIALIZE_DIRECTION.TOP,v){var x=y,k=0;vs.getInstance().setBegin(a-1).setEnd(0).setLoop((function(t){if(t<y)return!1;if(k%w==0){var e=x-w;e>=0&&(x=e)}return k+=1,!0})).foldOnOff(!1).execute(),x!==a&&(_=new xs(x,s,a-1,h))}else{var P=vs.getInstance().setBegin(a).setEnd(0).nextRow();_=new xs(y,s,P,h)}if(O>f)if(T=Y_.SERIALIZE_DIRECTION.BOTTOM,v){var j=f,C=0;vs.getInstance().setBegin(f+1).setEnd(u.len-1).setLoop((function(t){if(t>y)return!1;if(C%w==0){var e=j+w;e>=0&&(j=e)}return C+=1,!0})).foldOnOff(!1).execute(),j!==f&&(_=new xs(f+1,s,j,h))}else{var R=vs.getInstance().setBegin(f).setEnd(u.len-1).nextRow();_=new xs(R,s,y,h)}}else if(b<s||b>h){if(b<s)if(T=Y_.SERIALIZE_DIRECTION.LEFT,v){var L=s,A=0;Ss.getInstance().setBegin(s-1).setEnd(0).setLoop((function(t){if(t<b)return!1;if(A%m==0){var e=L-m;e>=0&&(L=e)}return A+=1,!0})).execute(),L!==s&&(_=new xs(a,L,f,s-1))}else{var N=Ss.getInstance().setBegin(s).setEnd(0).nextRow();_=new xs(a,b,f,N)}if(b>h)if(T=Y_.SERIALIZE_DIRECTION.RIGHT,v){var I=h,V=0;Ss.getInstance().setBegin(h+1).setEnd(l.len-1).setLoop((function(t){if(t>b)return!1;if(V%m==0){var e=I+m;e>=0&&(I=e)}return V+=1,!0})).execute(),I!==h&&(_=new xs(a,h+1,f,I))}else{var D=Ss.getInstance().setBegin(h).setEnd(l.len-1).nextRow();_=new xs(a,D,f,b)}}if(_){var M=l.sectionSumWidth(_.sci,_.eci),H=u.sectionSumHeight(_.sri,_.eri);_.w=M,_.h=H}this.autoFillRange=_,this.moveDirection=T}},{key:"borderHandle",value:function(){var t=this.xScreen,e=this.autoFillRange;if(!1===this.display||e.equals(xs.EMPTY))this.hideBorder();else{var n=t.findType(kh).selectRange.union(e);this.showBorder(n)}}},{key:"offsetHandle",value:function(){var t=this.xScreen,e=this.autoFillRange;if(!1===this.display||e.equals(xs.EMPTY))this.hide();else{var n=t.findType(kh).selectRange.union(e);this.show(),this.setDisplay(n),this.setSizer(n),this.setLocal(n)}}},{key:"serialize",value:function(){var t=this.table,e=this.xScreen,n=this.autoFillRange,o=this.moveDirection,r=t.cellMergeCopyHelper,i=t.tableDataSnapshot,c=e.findType(kh);i.begin(),r.serializeContent({originViewRange:n.union(c.selectRange),direction:o}),i.end(),t.render()}},{key:"autoFill",value:function(){if(!this.autoFillRange.equals(xs.EMPTY)){var t=this.table,e=this.options,n=t.tableDataSnapshot;e.onBeforeAutoFill(),n.begin(),this.splitMerge(),this.fillMerge(),this.fillCellIN(),n.end(),e.onAfterAutoFill(),t.render()}}},{key:"fillMerge",value:function(){var t=this.table,e=this.xScreen,n=this.autoFillRange,o=t.cellMergeCopyHelper,r=e.findType(kh);o.copyMergeContent({targetViewRange:n,originViewRange:r.selectRange})}},{key:"fillCellIN",value:function(){var t=this.table,e=this.xScreen,n=this.autoFillRange,o=t.cellMergeCopyHelper,r=e.findType(kh);o.copyCellINContent({targetViewRange:n,originViewRange:r.selectRange})}},{key:"splitMerge",value:function(){var t=this.table,e=this.autoFillRange,n=t.getTableMerges(),o=t.tableDataSnapshot.mergeDataProxy;n.getIncludes(e,(function(t){o.deleteMerge(t)}))}},{key:"destroy",value:function(){K_($_(e.prototype),"destroy",this).call(this),this.unbind()}}])&&X_(n.prototype,i),c&&X_(n,c),e}(fh);function J_(t){return(J_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tT(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function eT(t,e){return!e||"object"!==J_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nT(t){return(nT=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oT(t,e){return(oT=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rT=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=eT(this,nT(e).call(this,"".concat(r,"-table-drop-row-fixed-bar")))).block=k("div","".concat(r,"-table-drop-row-fixed-block")),n.children(n.block),n.table=t,n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oT(t,e)}(e,t),n=e,(o=[{key:"onAttach",value:function(){this.setSize(),this.hide()}},{key:"setSize",value:function(){var t=this.table,e=this.block,n=t.visualWidth();e.offset({width:t.getIndexWidth(),height:6}),this.offset({height:6,width:n,left:0})}}])&&tT(n.prototype,o),i&&tT(n,i),e}(B);function iT(t){return(iT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cT(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function lT(t,e){return!e||"object"!==iT(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function uT(t){return(uT=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function aT(t,e){return(aT=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sT=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=lT(this,uT(e).call(this,"".concat(r,"-table-drop-col-fixed-bar")))).block=k("div","".concat(r,"-table-drop-col-fixed-block")),n.children(n.block),n.table=t,n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&aT(t,e)}(e,t),n=e,(o=[{key:"onAttach",value:function(){this.setSize(),this.hide()}},{key:"setSize",value:function(){var t=this.table,e=this.block,n=t.visualHeight();e.offset({height:t.getIndexHeight(),width:6}),this.offset({height:n,width:6,top:0})}}])&&cT(n.prototype,o),i&&cT(n,i),e}(B);function fT(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var hT=function(){function t(e){var n=e.fixedView,o=void 0===n?new xs(0,0,-1,-1):n,r=e.fxLeft,i=void 0===r?-1:r,c=e.fxTop,l=void 0===c?-1:c;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fixedView=o,i>-1&&(this.fixedView.eci=i),l>-1&&(this.fixedView.eri=l)}var e,n,o;return e=t,(n=[{key:"setFixedView",value:function(t){this.fixedView=t.clone()}},{key:"getFixedView",value:function(){return this.fixedView.clone()}},{key:"hasFixedLeft",value:function(){return this.fixedView.eci>-1}},{key:"hasFixedTop",value:function(){return this.fixedView.eri>-1}}])&&fT(e.prototype,n),o&&fT(e,o),t}();function pT(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var yT=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.change=!1}var e,n,o;return e=t,(n=[{key:"endNotice",value:function(){this.change&&(this.change=!1)}},{key:"backNotice",value:function(){this.change&&(this.change=!1)}},{key:"goNotice",value:function(){this.change&&(this.change=!1)}}])&&pT(e.prototype,n),o&&pT(e,o),t}();function bT(t){return(bT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dT(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function vT(t,e){return!e||"object"!==bT(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gT(t,e,n){return(gT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=wT(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function wT(t){return(wT=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mT(t,e){return(mT=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var OT=function(t){function e(t){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{setCell:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=vT(this,wT(e).call(this))).snapshot=t,n.option=o,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mT(t,e)}(e,t),n=e,(r=[{key:"$setCell",value:function(t,e,n){this.change=!0,this.snapshot.cells.setCellOrNew(t,e,n)}},{key:"setCell",value:function(t,e,n){var o=this.option,r=this.snapshot,i=o.on.setCell,c=r.cells.getCell(t,e);this.$setCell(t,e,n),i(t,e,c,n)}},{key:"endNotice",value:function(){var t=this.snapshot.table;this.change&&t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),gT(wT(e.prototype),"endNotice",this).call(this)}},{key:"goNotice",value:function(){var t=this.snapshot.table;this.change&&t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),gT(wT(e.prototype),"goNotice",this).call(this)}},{key:"backNotice",value:function(){var t=this.snapshot.table;this.change&&t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),gT(wT(e.prototype),"backNotice",this).call(this)}}])&&dT(n.prototype,r),i&&dT(n,i),e}(yT);var ET=function t(e){var n=e.ri,o=e.ci,r=e.oldCell,i=e.newCell;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ri=n,this.ci=o,this.oldCell=r,this.newCell=i};var ST={ADD:Symbol("添加一个合并单元格"),DELETE:Symbol("删除一个合并单元格")},_T=function t(e){var n=e.merge,o=e.recordType;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.merge=n,this.recordType=o};function TT(t){return(TT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xT(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function kT(t,e){return!e||"object"!==TT(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function PT(t,e,n){return(PT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=jT(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function jT(t){return(jT=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function CT(t,e){return(CT=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var RT=function(t){function e(t){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{addMerge:function(){},deleteMerge:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=kT(this,jT(e).call(this))).snapshot=t,n.option=o,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&CT(t,e)}(e,t),n=e,(r=[{key:"$addMerge",value:function(t){var e=this;this.change=!0;var n=this.snapshot.merges;n.getIncludes(t,(function(t){return e.deleteMerge(t)})),n.add(t,!1)}},{key:"$deleteMerge",value:function(t){this.change=!0,this.snapshot.merges.delete(t)}},{key:"deleteMerge",value:function(t){var e=this.option.on.deleteMerge;this.$deleteMerge(t),e(t)}},{key:"addMerge",value:function(t){var e=this.option.on.addMerge;this.$addMerge(t),e(t)}},{key:"endNotice",value:function(){var t=this.snapshot.table;this.change&&t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),PT(jT(e.prototype),"endNotice",this).call(this)}},{key:"goNotice",value:function(){var t=this.snapshot.table;this.change&&t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),PT(jT(e.prototype),"goNotice",this).call(this)}},{key:"backNotice",value:function(){var t=this.snapshot.table;this.change&&t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),PT(jT(e.prototype),"backNotice",this).call(this)}}])&&xT(n.prototype,r),i&&xT(n,i),e}(yT);function LT(t){return(LT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function AT(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function NT(t,e){return!e||"object"!==LT(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function IT(t,e,n){return(IT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=VT(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function VT(t){return(VT=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function DT(t,e){return(DT=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var MT=function(t){function e(t){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{setWidth:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=NT(this,VT(e).call(this))).snapshot=t,n.option=o,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&DT(t,e)}(e,t),n=e,(r=[{key:"$setWidth",value:function(t,e){this.change=!0,this.snapshot.cols.setWidth(t,e)}},{key:"setWidth",value:function(t,e){var n=this.option,o=this.snapshot,r=n.on.setWidth,i=o.cols.getWidth(t);this.$setWidth(t,e),r(t,i,e)}},{key:"endNotice",value:function(){var t=this.snapshot.table;this.change&&(t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(o.TABLE_EVENT_TYPE.CHANGE_WIDTH)),IT(VT(e.prototype),"endNotice",this).call(this)}},{key:"backNotice",value:function(){var t=this.snapshot.table;this.change&&(t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(o.TABLE_EVENT_TYPE.CHANGE_WIDTH)),IT(VT(e.prototype),"backNotice",this).call(this)}},{key:"goNotice",value:function(){var t=this.snapshot.table;this.change&&(t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(o.TABLE_EVENT_TYPE.CHANGE_WIDTH)),IT(VT(e.prototype),"goNotice",this).call(this)}}])&&AT(n.prototype,r),i&&AT(n,i),e}(yT);var HT=function t(e){var n=e.ci,o=e.oldWidth,r=e.newWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ci=n,this.oldWidth=o,this.newWidth=r};function FT(t){return(FT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function BT(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function WT(t,e){return!e||"object"!==FT(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function YT(t,e,n){return(YT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=UT(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function UT(t){return(UT=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zT(t,e){return(zT=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var GT=function(t){function e(t){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{setHeight:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=WT(this,UT(e).call(this))).snapshot=t,n.option=o,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zT(t,e)}(e,t),n=e,(r=[{key:"$setHeight",value:function(t,e){this.change=!0,this.snapshot.rows.setHeight(t,e)}},{key:"setHeight",value:function(t,e){var n=this.option,o=this.snapshot,r=n.on.setHeight,i=o.rows.getHeight(t);this.$setHeight(t,e),r(t,i,e)}},{key:"endNotice",value:function(){var t=this.snapshot.table;this.change&&(t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(o.TABLE_EVENT_TYPE.CHANGE_HEIGHT)),YT(UT(e.prototype),"endNotice",this).call(this)}},{key:"backNotice",value:function(){var t=this.snapshot.table;this.change&&(t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(o.TABLE_EVENT_TYPE.CHANGE_HEIGHT)),YT(UT(e.prototype),"backNotice",this).call(this)}},{key:"goNotice",value:function(){var t=this.snapshot.table;this.change&&(t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(o.TABLE_EVENT_TYPE.CHANGE_HEIGHT)),YT(UT(e.prototype),"goNotice",this).call(this)}}])&&BT(n.prototype,r),i&&BT(n,i),e}(yT);var XT=function t(e){var n=e.ri,o=e.oldHeight,r=e.newHeight;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ri=n,this.oldHeight=o,this.newHeight=r};function ZT(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var KT=function(){function t(e){var n=this,o=e.table,r=e.cells,i=e.merges,c=e.cols,l=e.rows;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.record=!1,this.backLayerStack=[],this.recordLayer=[],this.goLayerStack=[],this.table=o,this.cells=r,this.merges=i,this.cols=c,this.rows=l,this.mergeDataProxy=new RT(this,{on:{deleteMerge:function(t){!1!==n.record&&n.recordLayer.push(new _T({merge:t,recordType:ST.DELETE}))},addMerge:function(t){!1!==n.record&&n.recordLayer.push(new _T({merge:t,recordType:ST.ADD}))}}}),this.cellDataProxy=new OT(this,{on:{setCell:function(t,e,o,r){!1!==n.record&&n.recordLayer.push(new ET({ri:t,ci:e,oldCell:o,newCell:r}))}}}),this.colsDataProxy=new MT(this,{on:{setWidth:function(t,e,o){!1!==n.record&&n.recordLayer.push(new HT({ci:t,oldWidth:e,newWidth:o}))}}}),this.rowsDataProxy=new GT(this,{on:{setHeight:function(t,e,o){!1!==n.record&&n.recordLayer.push(new XT({ri:t,oldHeight:e,newHeight:o}))}}})}var e,n,o;return e=t,(n=[{key:"back",value:function(){for(var t=this.backLayerStack,e=this.goLayerStack,n=this.table,o=t.pop(),r=o.length-1;r>=0;r-=1){var i=o[r];if(i instanceof ET){var c=i.ri,l=i.ci,u=i.oldCell;this.cellDataProxy.$setCell(c,l,u)}else if(i instanceof _T)switch(i.recordType){case ST.DELETE:var a=i.merge;this.mergeDataProxy.$addMerge(a);break;case ST.ADD:var s=i.merge;this.mergeDataProxy.$deleteMerge(s)}else if(i instanceof HT){var f=i.ci,h=i.oldWidth;this.colsDataProxy.$setWidth(f,h)}else if(i instanceof XT){var p=i.ri,y=i.oldHeight;this.rowsDataProxy.$setHeight(p,y)}}e.push(o),this.mergeDataProxy.backNotice(),this.cellDataProxy.backNotice(),this.colsDataProxy.backNotice(),this.rowsDataProxy.backNotice(),n.render()}},{key:"go",value:function(){for(var t=this.backLayerStack,e=this.goLayerStack,n=this.table,o=e.pop(),r=0,i=o.length;r<i;r+=1){var c=o[r];if(c instanceof ET){var l=c.ri,u=c.ci,a=c.newCell;this.cellDataProxy.$setCell(l,u,a)}else if(c instanceof _T)switch(c.recordType){case ST.DELETE:var s=c.merge;this.mergeDataProxy.$deleteMerge(s);break;case ST.ADD:var f=c.merge;this.mergeDataProxy.$addMerge(f)}else if(c instanceof HT){var h=c.ci,p=c.newWidth;this.colsDataProxy.$setWidth(h,p)}else if(c instanceof XT){var y=c.ri,b=c.newHeight;this.rowsDataProxy.$setHeight(y,b)}}t.push(o),this.mergeDataProxy.goNotice(),this.cellDataProxy.goNotice(),this.colsDataProxy.goNotice(),this.rowsDataProxy.goNotice(),n.render()}},{key:"end",value:function(){var t=this.recordLayer,e=this.backLayerStack;this.record=!1,t.length&&e.push(t),this.recordLayer=[],this.mergeDataProxy.endNotice(),this.cellDataProxy.endNotice(),this.colsDataProxy.endNotice(),this.rowsDataProxy.endNotice()}},{key:"begin",value:function(){this.record=!0,this.goLayerStack=[]}},{key:"canBack",value:function(){return 0!==this.backLayerStack.length}},{key:"canGo",value:function(){return 0!==this.goLayerStack.length}}])&&ZT(e.prototype,n),o&&ZT(e,o),t}();function $T(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var qT=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.target,o=void 0===n?document.body:n,r=e.filter,i=void 0===r?function(){return!1}:r,c=e.paste,l=void 0===c?function(){}:c;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.target=o,this.filter=i,this.paste=l,this.bind()}var e,n,o;return e=t,(n=[{key:"bind",value:function(){var t=this.target,e=this.paste,n=this.filter;L.bind(t,"paste",(function(t){n()&&e(t)}))}}])&&$T(e.prototype,n),o&&$T(e,o),t}();function QT(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var JT=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.activate=e}var e,n,o;return e=t,(n=[{key:"setActivate",value:function(t){this.activate=t}}])&&QT(e.prototype,n),o&&QT(e,o),t}();function tx(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ex(t,e,n){return e&&tx(t.prototype,e),n&&tx(t,n),t}var nx=function(){function t(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).focus,n=void 0===e?new JT:e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.focus=n}return ex(t,[{key:"xIconsEvent",value:function(t){var e=t.type,n=t.native,o=t.sx,r=t.sy,i=t.fx,c=t.fy,l=t.staticIcons,u=void 0===l?[]:l,a=t.fixedIcons,s=void 0===a?[]:a;u.length+s.length===0?this.clearFocus():(u.forEach((function(t){t.eventHandle({type:e,x:o,y:r,native:n})})),s.forEach((function(t){t.eventHandle({type:e,x:i,y:c,native:n})})))}},{key:"clearFocus",value:function(){var t=this.focus,e=t.activate;e&&(t.setActivate(null),e.onLeave())}}]),ex(t,[{key:"build",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.focus,n=new Ma(t);return n.setFocus(e),n}}]),t}();function ox(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function rx(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ix(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rx(Object(n),!0).forEach((function(e){cx(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rx(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function cx(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lx(t,e,n){return(lx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=fx(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function ux(t){return(ux="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ax(t,e){return!e||"object"!==ux(e)&&"function"!=typeof e?sx(t):e}function sx(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fx(t){return(fx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hx(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&px(t,e)}function px(t,e){return(px=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function yx(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bx(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function dx(t,e,n){return e&&bx(t.prototype,e),n&&bx(t,n),t}var vx=function(){function t(e){yx(this,t),this.table=e,this.scrollView=null,this.width=null,this.height=null,this.x=null,this.y=null}return dx(t,[{key:"reset",value:function(){this.scrollView=null,this.width=null,this.height=null,this.x=null,this.y=null}},{key:"getX",value:function(){throw new TypeError("child impl")}},{key:"getY",value:function(){throw new TypeError("child impl")}},{key:"getHeight",value:function(){throw new TypeError("child impl")}},{key:"getWidth",value:function(){throw new TypeError("child impl")}}]),t}(),gx=function(t){function e(){return yx(this,e),ax(this,fx(e).apply(this,arguments))}return hx(e,t),dx(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table.xFixedMeasure.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table.xFixedMeasure.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.rows,n=t.cols,o=t.xFixedView.getFixedView();return o.w=n.rectRangeSumWidth(o),o.h=e.rectRangeSumHeight(o),this.scrollView=o,o.clone()}}]),e}(vx),wx=function(t){function e(){return yx(this,e),ax(this,fx(e).apply(this,arguments))}return hx(e,t),dx(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table,e=t.xLeft,n=t.index,o=t.visualWidth()-(n.getWidth()+e.getWidth());return this.width=o,o}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table.index.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,n=t.index.getWidth()+e.getWidth();return this.x=n,n}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;return this.y=0,0}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.index,n=t.xTableAreaView.getScrollView();return n.sri=0,n.eri=0,n.h=e.getHeight(),this.scrollView=n,n.clone()}}]),e}(vx),mx=function(t){function e(){return yx(this,e),ax(this,fx(e).apply(this,arguments))}return hx(e,t),dx(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table.index.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,n=t.index,o=t.visualHeight()-(n.getHeight()+e.getHeight());return this.height=o,o}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;return this.x=0,0}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,n=t.index.getHeight()+e.getHeight();return this.y=n,n}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.xTableAreaView,n=t.index,o=e.getScrollView();return o.sci=0,o.eci=0,o.w=n.getWidth(),this.scrollView=o,o.clone()}}]),e}(vx),Ox=function(t){function e(){return yx(this,e),ax(this,fx(e).apply(this,arguments))}return hx(e,t),dx(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table.xFixedMeasure.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,n=t.index,o=t.visualHeight()-(n.getHeight()+e.getHeight());return this.height=o,o}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,n=t.index.getHeight()+e.getHeight();return this.y=n,n}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.xFixedView,n=t.cols,o=t.xTableAreaView.getScrollView(),r=e.getFixedView();return o.sci=r.sci,o.eci=r.eci,o.w=n.sectionSumWidth(o.sci,o.eci),this.scrollView=o,o.clone()}}]),e}(vx),Ex=function(t){function e(){return yx(this,e),ax(this,fx(e).apply(this,arguments))}return hx(e,t),dx(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table,e=t.xLeft,n=t.index,o=t.visualWidth()-(n.getWidth()+e.getWidth());return this.width=o,o}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table.xFixedMeasure.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,n=t.index.getWidth()+e.getWidth();return this.x=n,n}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.xFixedView,n=t.rows,o=t.xTableAreaView.getScrollView(),r=e.getFixedView();return o.sri=r.sri,o.eri=r.eri,o.h=n.sectionSumHeight(o.sri,o.eri),this.scrollView=o,o.clone()}}]),e}(vx),Sx=function(t){function e(){return yx(this,e),ax(this,fx(e).apply(this,arguments))}return hx(e,t),dx(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table,e=t.index,n=t.xLeft,o=t.visualWidth()-(e.getWidth()+n.getWidth());return this.width=o,o}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,n=t.index,o=t.visualHeight()-(n.getHeight()+e.getHeight());return this.height=o,o}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,n=t.index.getWidth()+e.getWidth();return this.x=n,n}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,n=t.index.getHeight()+e.getHeight();return this.y=n,n}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table.xTableAreaView.getScrollView();return this.scrollView=t,t.clone()}}]),e}(vx),_x=function(){function t(){yx(this,t)}return dx(t,null,[{key:"register",value:function(t){var e=t.keyboard,n=t.cols,o=t.rows,r=t.xScreen,i=t.edit,c=r.findType(kh),l=t.getTableMerges(),u=null;e.register({target:t,keyCode:9,callback:function(){i.hideEdit();var t=c.selectRange,e=t.tabNext,r=t.clone();if(!e){var a=r.sri,s=r.sci;u={sri:a,sci:s}}var f=n.len-1,h=o.len-1,p=u,y=p.sri,b=p.sci,d=l.getFirstIncludes(y,b);if(d&&(b=d.eci),!(b>=f&&y>=h)){b>=f?(y+=1,b=0):b+=1,u.sri=y,u.sci=b;var v=y,g=b,w=l.getFirstIncludes(y,b);w&&(y=w.sri,b=w.sci,v=w.eri,g=w.eci),r.tabNext=!0,r.sri=y,r.sci=b,r.eri=v,r.eci=g,c.setRange(r),i.showEdit()}}})}}]),t}(),Tx=function(t){function e(t){var n,o=t.settings;return yx(this,e),(n=ax(this,fx(e).call(this,"".concat(r,"-table")))).settings=S.mergeDeep({index:{height:30,width:50,gridColor:"#c1c1c1",size:11,color:"#000000"},table:{showGrid:!0,background:"#ffffff",borderColor:"#000000",gridColor:"#e1e1e1"},rows:{len:1e3,height:30,data:[]},cols:{len:36,width:110,data:[]},xFixedView:{fixedView:new xs(0,0,-1,-1),fxLeft:-1,fxTop:-1},xFixedBar:{height:Bg.HEIGHT,width:kg.WIDTH,background:"#eaeaea",buttonColor:"#c1c1c1"},data:[],merge:{}},o),n.visualHeightCache=null,n.visualWidthCache=null,n.scale=new ag,n.index=new hg(ix({scaleAdapter:new sg({goto:function(t){return hc.srcTransformCssPx(n.scale.goto(t))}})},n.settings.index)),n.rows=new yg(ix({scaleAdapter:new sg({goto:function(t){return hc.srcTransformCssPx(n.scale.goto(t))}})},n.settings.rows)),n.cols=new dg(ix({scaleAdapter:new sg({goto:function(t){return hc.srcTransformCssPx(n.scale.goto(t))}})},n.settings.cols)),n.xFixedView=new hT(n.settings.xFixedView),n.xFixedMeasure=new GE({fixedView:n.xFixedView,cols:n.cols,rows:n.rows}),n.scroll=new gg({xFixedView:n.xFixedView}),n.xTableScrollView=new yw({scroll:n.scroll,rows:n.rows,cols:n.cols,getHeight:function(){return n.xContent.getHeight()},getWidth:function(){return n.xContent.getWidth()}}),n.xTableAreaView=new dw({xTableScrollView:n.xTableScrollView,rows:n.rows,cols:n.cols,scroll:n.scroll}),n.xTableStyle=new NS({xTableScrollView:n.xTableScrollView,scroll:n.scroll,settings:n.settings,xFixedView:n.xFixedView}),n.tableDataSnapshot=new KT({merges:n.getTableMerges(),cells:n.getTableCells(),table:sx(n),cols:n.cols,rows:n.rows}),n.xTableFrozenContent=new gx(sx(n)),n.xLeftIndex=new mx(sx(n)),n.xTopIndex=new wx(sx(n)),n.xLeft=new Ox(sx(n)),n.xTop=new Ex(sx(n)),n.xContent=new Sx(sx(n)),n.xIconBuilder=new nx,n.focus=new sw(sx(n)),n.mousePointer=new wh(sx(n)),n.keyboard=new mg(sx(n)),n.xScreen=new p_(sx(n)),n.xReSizer=new Ng(sx(n)),n.yReSizer=new Zg(sx(n)),n.xHeightLight=new ew(sx(n)),n.yHeightLight=new uw(sx(n)),n.edit=new Tw(sx(n)),n.rowFixed=new Bg(sx(n)),n.colFixed=new kg(sx(n)),n.dropColFixed=new sT(sx(n)),n.dropRowFixed=new rT(sx(n)),n.cellMergeCopyHelper=new U_({merges:n.getTableMerges(),cells:n.getTableCells(),cols:n.cols,rows:n.rows,tableDataSnapshot:n.tableDataSnapshot}),n.clipboard=new qT({filter:function(){return sx(n).focus.activate.target===sx(n)},paste:function(){}}),Sa.setScaleAdapter(new sg({goto:function(t){return hc.srcTransformCssPx(n.scale.goto(t))}})),n}return hx(e,t),dx(e,null,[{key:"rowsReduceIf",value:function(t,e,n,o,r,i){var c=n,l=o,u=t;return vs.getInstance().setBegin(u).setEnd(e-1).setLoop((function(t){return!(c>=r)&&(l=i(t),c+=l,!0)})).setFinish((function(t){u=t})).execute(),[u,c-l,l]}},{key:"colsReduceIf",value:function(t,e,n,o,r,i){var c=n,l=o,u=t;return Ss.getInstance().setBegin(u).setEnd(e-1).setLoop((function(t){return!(c>=r)&&(l=i(t),c+=l,!0)})).setFinish((function(t){u=t})).execute(),[u,c-l,l]}}]),dx(e,[{key:"getOperateCellsHelper",value:function(){return this.xTableStyle.operateCellsHelper}},{key:"getTableMerges",value:function(){return this.xTableStyle.merges}},{key:"getStyleCellsHelper",value:function(){return this.xTableStyle.styleCellsHelper}},{key:"getTableCells",value:function(){return this.xTableStyle.cells}},{key:"getXTableStyle",value:function(){return this.xTableStyle}},{key:"getScrollTotalHeight",value:function(){var t,e=this.xFixedView,n=this.rows;if(e.hasFixedTop()){var o=e.getFixedView();t=n.sectionSumHeight(o.eri,n.len-1)}else t=n.sectionSumHeight(0,n.len-1);return t}},{key:"getScrollTotalWidth",value:function(){var t,e=this.xFixedView,n=this.cols;if(e.hasFixedLeft()){var o=e.getFixedView();t=n.sectionSumWidth(o.eci,n.len-1)}else t=n.sectionSumWidth(0,n.len-1);return t}},{key:"getIndexHeight",value:function(){return this.index.getHeight()}},{key:"getIndexWidth",value:function(){return this.index.getWidth()}},{key:"getContentHeight",value:function(){return this.xContent.getHeight()}},{key:"getContentWidth",value:function(){return this.xContent.getWidth()}},{key:"getFixedWidth",value:function(){return this.xLeft.getWidth()}},{key:"getFixedHeight",value:function(){return this.xTop.getHeight()}},{key:"visualWidth",value:function(){if(S.isNumber(this.visualWidthCache))return this.visualWidthCache;var t=this.box().width;return this.visualWidthCache=t,t}},{key:"visualHeight",value:function(){if(S.isNumber(this.visualHeightCache))return this.visualHeightCache;var t=this.box().height;return this.visualHeightCache=t,t}},{key:"xIconsEvent",value:function(t,e,n){var o=this.xIconBuilder,r=this.getXTableStyle(),i=this.getTableCells(),c=r.fixedCellIcon,l=r.staticCellIcon,u=e.ri,a=e.ci,s=e.mri,f=e.mci,h=e.fx,p=e.fy,y=e.sx,b=e.sy,d=[],v=[],g=c.getIcon(u,a);g&&(v=v.concat(g));var w=i.getCell(s,f);w&&(d=d.concat(w.icons));var m=l.getIcon(s,f);m&&(d=d.concat(m)),o.xIconsEvent({native:n,type:t,staticIcons:d,fixedIcons:v,sx:hc.srcTransformStylePx(y),sy:hc.srcTransformStylePx(b),fx:hc.srcTransformStylePx(h),fy:hc.srcTransformStylePx(p)})}},{key:"pointerEvent",value:function(t){var e=this.mousePointer,n=t.ri,o=t.ci;-1!==n||-1!==o?-1!==n?-1!==o?e.set(wh.KEYS.cell):e.set(wh.KEYS.eResize):e.set(wh.KEYS.sResize):e.set(wh.KEYS.default)}},{key:"getRiCiByXy",value:function(t,e){var n=this.xFixedView,o=this.rows,r=this.cols,i=this.index,c=n.getFixedView(),l=this.getTableMerges(),u=this.getFixedWidth(),a=this.getFixedHeight(),s=t,f=e,h=-1,p=-1;s-=i.getWidth(),f-=i.getHeight();var y=0;if(s<=u&&t>i.getWidth()){var b=0;Ss.getInstance().setBegin(c.sci).setEnd(c.eci).setLoop((function(t){var e=r.getWidth(t);return h=t,(b+=e)<s})).execute(),y=-1*(b-r.getWidth(h)-s)}else if(t>i.getWidth()){var d=u,v=this.getScrollView();Ss.getInstance().setBegin(v.sci).setEnd(v.eci).setLoop((function(t){var e=r.getWidth(t);return h=t,(d+=e)<s})).execute(),y=-1*(d-r.getWidth(h)-s)}var g=0;if(f<a&&e>i.getHeight()){var w=0;vs.getInstance().setBegin(c.sri).setEnd(c.eri).setLoop((function(t){var e=o.getHeight(t);return p=t,(w+=e)<=f})).execute(),g=-1*(w-o.getHeight(p)-f)}else if(e>i.getHeight()){var m=a,O=this.getScrollView();vs.getInstance().setBegin(O.sri).setEnd(O.eri).setLoop((function(t){var e=o.getHeight(t);return p=t,(m+=e)<=f})).execute(),g=-1*(m-o.getHeight(p)-f)}var E=l.getFirstIncludes(p,h),S=h,_=p,T=y,x=g;if(E){_=E.sri,S=E.sci;var k=this.rows,P=this.cols;x+=k.sectionSumHeight(_,p-1),T+=P.sectionSumWidth(S,h-1)}return{ri:p,ci:h,mri:_,mci:S,fx:y,fy:g,sx:T,sy:x}}},{key:"onAttach",value:function(){this.focus.register({target:this});var t=this.xTableStyle;this.attach(t),this.attach(this.xScreen),this.xScreen.addItem(new fy(this)),this.xScreen.addItem(new kh(this)),this.xScreen.addItem(new Sy(this)),this.xScreen.addItem(new Q_(this)),this.attach(this.xHeightLight),this.attach(this.yHeightLight),this.attach(this.edit),this.attach(this.rowFixed),this.attach(this.colFixed),this.attach(this.xReSizer),this.attach(this.yReSizer),this.attach(this.dropRowFixed),this.attach(this.dropColFixed),this.bind(),_x.register(this)}},{key:"unbind",value:function(){this.keyboard.unbind(),this.focus.unbind()}},{key:"bind",value:function(){var t=this;L.bind(this,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.resize()})),L.bind(this,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.resize()})),L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(e){var n=t.eventXy(e),o=n.x,r=n.y,i=t.getRiCiByXy(o,r);t.pointerEvent(i),t.xIconsEvent(Ma.ICON_EVENT_TYPE.MOUSE_MOVE,i,e)})),L.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(t.focus.activate.target===t){var n=t.eventXy(e),o=n.x,r=n.y,i=t.getRiCiByXy(o,r);t.xIconsEvent(Ma.ICON_EVENT_TYPE.MOUSE_DOWN,i,e)}}))}},{key:"getScrollView",value:function(){return this.xTableAreaView.getScrollView()}},{key:"scrollX",value:function(t){var n,o=this.cols,r=this.xFixedView,i=this.scroll,c=r.getFixedView(),l=ox(e.colsReduceIf(c.eci+1,o.len,0,0,t,(function(t){return o.getWidth(t)})),3),u=l[0],a=l[1],s=l[2],f=a;t>0&&(f+=s),i.x>f?n=vg.H_LEFT:i.x<f&&(n=vg.H_RIGHT),i.type=n,i.ci=u,i.x=f,this.scrolling(),i.type=vg.UN}},{key:"scrollY",value:function(t){var n,o=this.rows,r=this.xFixedView,i=this.scroll,c=r.getFixedView(),l=ox(e.rowsReduceIf(c.eri+1,o.len,0,0,t,(function(t){return o.getHeight(t)})),3),u=l[0],a=l[1],s=l[2],f=a;t>0&&(f+=s),i.y>f?n=vg.V_TOP:i.y<f&&(n=vg.V_BOTTOM),i.type=n,i.ri=u,i.y=f,this.scrolling(),i.type=vg.UN}},{key:"getTop",value:function(){var t=this.rows,e=this.xFixedView.getFixedView(),n=this.getScrollView();return t.sectionSumHeight(e.eri+1,n.sri-1)}},{key:"getLeft",value:function(){var t=this.cols,e=this.xFixedView.getFixedView(),n=this.getScrollView();return t.sectionSumWidth(e.eci+1,n.sci-1)}},{key:"setFixedRow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=this.xFixedView,r=this.rows,i=this.scroll,c=this.rowFixed,l=n.getFixedView();l.eri=t,e>-1&&(l.sri=e),n.setFixedView(l);var u=l.sri,a=l.eri;n.hasFixedTop()?(i.y=0,i.ri=a+1):(i.y=r.sectionSumHeight(0,u-1),i.ri=u),c.fxSri=l.sri,c.fxEri=l.eri,this.resize(),this.trigger(o.TABLE_EVENT_TYPE.FIXED_CHANGE)}},{key:"setFixedCol",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=this.xFixedView,r=this.rows,i=this.scroll,c=this.colFixed,l=n.getFixedView();l.eci=t,e>-1&&(l.sci=e),n.setFixedView(l);var u=l.sci,a=l.eci;n.hasFixedLeft()?(i.x=0,i.ci=a+1):(i.x=r.sectionSumHeight(0,u-1),i.ci=u),c.fxSci=l.sci,c.fxEci=l.eci,this.resize(),this.trigger(o.TABLE_EVENT_TYPE.FIXED_CHANGE)}},{key:"setScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this.yHeightLight,n=this.xHeightLight,r=this.xTableStyle,i=this.xScreen,c=this.scale,l=this.rowFixed,u=this.colFixed;this.reset(),c.setValue(t),i.setZone(),n.offsetHandle(),e.offsetHandle(),l.setSize(),u.setSize(),r.setScale(t),this.trigger(o.TABLE_EVENT_TYPE.SCALE_CHANGE)}},{key:"reset",value:function(){var t=this.xTableAreaView,e=this.xTableFrozenContent,n=this.xLeftIndex,o=this.xTopIndex,r=this.xLeft,i=this.xTop,c=this.xContent;this.visualHeightCache=null,this.visualWidthCache=null,t.reset(),e.reset(),n.reset(),o.reset(),r.reset(),i.reset(),c.reset()}},{key:"resize",value:function(){var t=this.xTableStyle,e=this.xScreen,n=this.rowFixed,r=this.colFixed;this.reset(),e.setZone(),n.setSize(),r.setSize(),t.resize(),this.trigger(o.TABLE_EVENT_TYPE.RESIZE_CHANGE)}},{key:"render",value:function(){this.xTableStyle.render(),this.trigger(o.TABLE_EVENT_TYPE.RENDER)}},{key:"scrolling",value:function(){var t=this.xTableStyle,e=this.xFixedView,n=this.scroll,r=e.getFixedView();e.hasFixedTop()||(r.sri=n.ri),e.hasFixedLeft()||(r.sci=n.ci),this.reset(),e.setFixedView(r),t.scrolling(),this.trigger(o.SYSTEM_EVENT_TYPE.SCROLL)}},{key:"destroy",value:function(){lx(fx(e.prototype),"destroy",this).call(this),this.unbind(),this.xScreen.destroy(),this.xReSizer.destroy(),this.yReSizer.destroy(),this.xHeightLight.destroy(),this.yHeightLight.destroy(),this.edit.destroy(),this.rowFixed.destroy(),this.colFixed.destroy()}}]),e}(B);function xx(t){return(xx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kx(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Px(t,e){return!e||"object"!==xx(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jx(t){return(jx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cx(t,e){return(Cx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rx=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{tableConfig:{data:[]}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Px(this,jx(e).call(this,"".concat(r,"-sheet")))).options=n,t.table=new Tx({settings:t.options.tableConfig}),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cx(t,e)}(e,t),n=e,(o=[{key:"onAttach",value:function(){var t=this.table;this.attach(t)}}])&&kx(n.prototype,o),i&&kx(n,i),e}(B),Lx=n(4),Ax=n.n(Lx);function Nx(t){return(Nx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ix(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Vx(t,e){return!e||"object"!==Nx(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dx(t,e,n){return(Dx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Mx(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Mx(t){return(Mx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hx(t,e){return(Hx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fx=function(t){function e(t){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{sheets:[]};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Vx(this,Mx(e).call(this,"".concat(r,"-work-body")))).work=t,n.workConfig=o,n.sheets=n.workConfig.sheets,n.tabSheet=[],n.activeIndex=-1,n.version=k("div","".concat(r,"-version-tips")),n.version.html('<a target="_blank" href="https://gitee.com/eigi/x-sheet">'.concat(i,"</a>")),n.children(n.version),n.sheetViewLayer=new jv({style:{flexGrow:1}}),n.scrollBarYLayer=new jv({style:{overflow:"inherit"}}),n.scrollBarXLayer=new Nv,n.scrollBarXVerticalCenter=new Hv,n.scrollBarXHorizontalLayer=new jv({style:{flexGrow:2}}),n.scrollBarXVerticalCenter.children(n.scrollBarXLayer),n.scrollBarXHorizontalLayer.children(n.scrollBarXVerticalCenter),n.sheetSwitchTabLayer=new jv({style:{flexGrow:3}}),n.horizontalLayer1=new sv,n.horizontalLayer2=new sv,n.horizontalLayer1.children(n.sheetViewLayer),n.horizontalLayer1.children(n.scrollBarYLayer),n.horizontalLayer2.children(n.sheetSwitchTabLayer),n.horizontalLayer2.children(n.scrollBarXHorizontalLayer),n.horizontalLayer1Layer=new nt({style:{flexGrow:1}}),n.horizontalLayer2Layer=new nt,n.layerVerticalLayer=new q,n.horizontalLayer1Layer.children(n.horizontalLayer1),n.horizontalLayer2Layer.children(n.horizontalLayer2),n.layerVerticalLayer.children(n.horizontalLayer1Layer),n.layerVerticalLayer.children(n.horizontalLayer2Layer),n.children(n.layerVerticalLayer),n.scrollBarY=new _v({scroll:function(t){n.sheetView.getActiveSheet().table.scrollY(t)}}),n.scrollBarX=new vv({scroll:function(t){n.sheetView.getActiveSheet().table.scrollX(t)}}),n.sheetView=new Gv,n.tabView=new Jv({onAdd:function(){var t=new Rx,e=new cg;n.addTabSheet({tab:e,sheet:t})},onSwitch:function(t){n.setActiveTab(t)}}),n}var n,c,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hx(t,e)}(e,t),n=e,(c=[{key:"onAttach",value:function(){var t=this.sheetViewLayer,e=this.scrollBarYLayer,n=this.sheetSwitchTabLayer,o=this.scrollBarXLayer;e.attach(this.scrollBarY),o.attach(this.scrollBarX),n.attach(this.tabView),t.attach(this.sheetView),this.bind(),this.createSheet()}},{key:"bind",value:function(){var t=this,e=S.getExplorerInfo(),n=new gw;L.bind(this.sheetView,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.scrollBarLocal(),t.scrollBarSize()})),L.bind(this.sheetView,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.scrollBarLocal(),t.scrollBarSize()})),L.bind(this.sheetView,o.TABLE_EVENT_TYPE.FIXED_CHANGE,(function(){t.getActiveTable()&&(t.scrollBarLocal(),t.scrollBarSize())})),L.bind(this.sheetView,o.TABLE_EVENT_TYPE.DATA_CHANGE,(function(e){t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),e.stopPropagation()})),L.bind(this.sheetView,o.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(e){t.trigger(o.TABLE_EVENT_TYPE.SELECT_CHANGE),e.stopPropagation()})),L.bind(this.sheetView,o.TABLE_EVENT_TYPE.SELECT_DOWN,(function(e){t.trigger(o.TABLE_EVENT_TYPE.SELECT_DOWN,t),e.stopPropagation()})),L.bind(this.sheetView,o.SYSTEM_EVENT_TYPE.MOUSE_WHEEL,(function(n){var o=t.sheetView.getActiveSheet();if(!S.isUnDef(o)){var r=o.table,i=r.scroll,c=r.rows,l=r.getScrollView(),u=t.scrollBarY.scrollTo,a=n.deltaY;switch(e.type){case"Chrome":a>0?t.scrollBarY.scrollMove(u+Math.abs(a)):t.scrollBarY.scrollMove(u-Math.abs(a));break;case"Firefox":if(a>0){var s=c.getHeight(l.sri+1);t.scrollBarY.scrollMove(u+s)}else{var f=c.getHeight(l.sri-1);t.scrollBarY.scrollMove(u-f)}}i.blockTop<i.maxBlockTop&&i.blockTop>0&&(n.preventDefault(),n.stopPropagation())}})),L.bind(window,o.SYSTEM_EVENT_TYPE.RESIZE,(function(){n.action((function(){hc.dprUpdate();var e=t.getActiveTable();e&&(e.reset(),t.scrollBarLocal(),t.scrollBarSize(),e.resize())}))}))}},{key:"unbind",value:function(){L.unbind(this.sheetView),L.unbind(window)}},{key:"addTabSheet",value:function(t){var e=t.tab,n=t.sheet,o=this.tabSheet,r=this.sheetView,i=this.tabView;r.attach(n),i.attach(e),o.push({tab:e,sheet:n})}},{key:"scrollBarSize",value:function(){var t=this.getActiveTable(),e=this.scrollBarXHorizontalLayer,n=this.scrollBarY,o=this.scrollBarX,r=t.getScrollTotalHeight(),i=t.getScrollTotalWidth();i>t.getContentWidth()?e.show():e.hide(),n.setSize(t.getContentHeight(),r),o.setSize(t.getContentWidth(),i)}},{key:"scrollBarLocal",value:function(){var t=this.getActiveTable();this.scrollBarY.setLocal(t.getTop()),this.scrollBarX.setLocal(t.getLeft())}},{key:"createSheet",value:function(){var t=!0,e=!1,n=void 0;try{for(var o,r=this.sheets[Symbol.iterator]();!(t=(o=r.next()).done);t=!0){var i=o.value,c=i.name,l=new Rx(i),u=new cg(c);this.addTabSheet({tab:u,sheet:l})}}catch(t){e=!0,n=t}finally{try{t||null==r.return||r.return()}finally{if(e)throw n}}this.tabSheet.length&&this.setActiveIndex(0)}},{key:"setActiveIndex",value:function(t){var e=this.sheetView,n=this.tabView;e.setActiveSheet(t),n.setActiveTab(t);var r=this.getActiveTable();r&&(r.reset(),this.scrollBarLocal(),this.scrollBarSize(),r.resize()),this.trigger(o.WORK_BODY_EVENT_TYPE.CHANGE_ACTIVE),this.activeIndex=t}},{key:"setScale",value:function(t){this.sheetView.getActiveSheet().table.setScale(t),this.scrollBarLocal(),this.scrollBarSize()}},{key:"setActiveTab",value:function(t){var e=this;this.tabSheet.forEach((function(n,o){n.tab===t&&e.setActiveIndex(o)}))}},{key:"getActiveSheet",value:function(){return this.sheetView.getActiveSheet()}},{key:"getActiveTable",value:function(){var t=this.getActiveSheet();return t?t.table:null}},{key:"toJSONTemplate",value:function(){var t=this.activeIndex,e=this.sheetView,n=this.tabView,o=e.sheetList[t],r=n.tabList[t];if(o&&r){var i=o.table,c=i.rows,l=i.cols,u=i.settings,a=i.getTableCells(),s=i.getTableMerges(),f={name:r.name,tableConfig:{table:{showGrid:u.table.showGrid,background:u.table.background},rows:{len:c.len,height:c.height,data:c.getData()},cols:{len:l.len,width:l.width,data:l.getData()},merge:{merges:s.getData().map((function(t){return t.toString()}))},data:a.getData()}},h="window['".concat(r.name,"'] = ").concat(JSON.stringify(f));Ax()(h,"".concat(r.name,".js"),"application/x-javascript")}}},{key:"destroy",value:function(){Dx(Mx(e.prototype),"destroy",this).call(this),this.unbind()}}])&&Ix(n.prototype,c),l&&Ix(n,l),e}(B);function Bx(t){return(Bx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wx(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Yx(t,e){return!e||"object"!==Bx(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ux(t,e,n){return(Ux="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=zx(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function zx(t){return(zx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gx(t,e){return(Gx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xx=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Yx(this,zx(e).call(this,"".concat(r,"-bottom-menu")))).workBottom=t,n.sum=k("div","".concat(r,"-bottom-sum")),n.avg=k("div","".concat(r,"-bottom-avg")),n.number=k("div","".concat(r,"-bottom-number")),n.fullScreen=k("div","".concat(r,"-bottom-full-screen")),n.grid=k("div","".concat(r,"-bottom-grid")),n.throttle=new gw({time:800}),n.children(n.grid),n.children(n.fullScreen),n.children(n.sum),n.children(n.avg),n.children(n.number),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gx(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"computer",value:function(){var t=this.workBottom.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableMerges(),o=t.getTableCells(),r=e.findType(kh).selectRange;if(r){var i=r.sri,c=r.sci,l=r.eri,u=r.eci,a=0,s=0;vs.getInstance().setBegin(i).setEnd(l).setLoop((function(t){Ss.getInstance().setBegin(c).setEnd(u).setLoop((function(e){var r=n.getFirstIncludes(t,e),i=o.getCell(t,e);if((!r||r.sri===t&&r.sci===e)&&i){a+=1;var c=i.text;S.isNumber(c)&&(s+=parseFloat(c))}})).execute()})).execute();var f=s/a;this.setNumber(a),this.setSum(s),this.setAvg(f)}else this.setNumber(0),this.setSum(0),this.setAvg(0)}},{key:"unbind",value:function(){var t=this.workBottom,e=this.grid,n=this.fullScreen,o=t.work.body;L.unbind(e),L.unbind(n),L.unbind(o)}},{key:"bind",value:function(){var t=this,e=this.workBottom,n=this.grid,r=this.fullScreen,i=this.throttle,c=e.work,l=c.body,u=l.sheetView;L.bind(l,o.WORK_BODY_EVENT_TYPE.CHANGE_ACTIVE,(function(){i.action((function(){t.computer()}))})),L.bind(l,o.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(){i.action((function(){t.computer()}))})),L.bind(l,o.TABLE_EVENT_TYPE.DATA_CHANGE,(function(){i.action((function(){t.computer()}))})),L.bind(r,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){S.isFull()?S.exitFullscreen():S.fullScreen(c.root)})),L.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=u.getActiveSheet().table;t.settings.table.showGrid=!t.settings.table.showGrid,t.render()}))}},{key:"setNumber",value:function(t){this.number.text("数量: ".concat(t))}},{key:"setSum",value:function(t){this.sum.text("求和: ".concat(t))}},{key:"setAvg",value:function(t){this.avg.text("平均数: ".concat(t))}},{key:"destroy",value:function(){Ux(zx(e.prototype),"destroy",this).call(this),this.unbind()}}])&&Wx(n.prototype,i),c&&Wx(n,c),e}(B);function Zx(t){return(Zx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kx(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function $x(t,e){return!e||"object"!==Zx(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qx(t){return(qx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qx(t,e){return(Qx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jx=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=$x(this,qx(e).call(this,"".concat(r,"-work-bottom")))).work=t,n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qx(t,e)}(e,t),n=e,(o=[{key:"onAttach",value:function(){this.bottomMenu=new Xx(this),this.attach(this.bottomMenu)}}])&&Kx(n.prototype,o),i&&Kx(n,i),e}(B);function tk(t){return(tk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ek(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function nk(t){return(nk=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ok(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rk(t,e){return(rk=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ik=function(t){function e(){var t,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{body:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=nk(e).call(this,"".concat(r,"-work")))||"object"!==tk(o)&&"function"!=typeof o?ok(n):o).options=i.workConfig,t.root=null,t.topLayer=new nt,t.bodyLayer=new nt({style:{flexGrow:1}}),t.bottomLayer=new nt,t.verticalLayer=new q,t.verticalLayer.children(t.topLayer),t.verticalLayer.children(t.bodyLayer),t.verticalLayer.children(t.bottomLayer),t.children(t.verticalLayer),t.top=new iv(ok(t)),t.body=new Fx(ok(t),t.options.body),t.bottom=new Jx(ok(t)),t}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rk(t,e)}(e,t),n=e,(o=[{key:"onAttach",value:function(t){this.root=t;var e=this.bodyLayer,n=this.topLayer,o=this.bottomLayer;n.attach(this.top),o.attach(this.bottom),e.attach(this.body),this.bottom.bottomMenu.setSum(0),this.bottom.bottomMenu.setAvg(0),this.bottom.bottomMenu.setNumber(0)}}])&&ek(n.prototype,o),i&&ek(n,i),e}(B);n(5),n(6);function ck(t){return(ck="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lk(t){return(lk=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function uk(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ak(t,e){return(ak=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.d(e,"XSheet",(function(){return sk}));var sk=function(t){function e(t){var n,o,i,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{workConfig:{body:{sheets:[{tableConfig:{}}]}}};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,n=!(i=lk(e).call(this,"".concat(r)))||"object"!==ck(i)&&"function"!=typeof i?uk(o):i;var l=t;return"string"==typeof t&&(l=document.querySelector(t)),(l=k(l)).children(uk(n)),n.work=new ik(c),n.attach(n.work),Kt.setRoot(uk(n)),co.setRoot(uk(n)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ak(t,e)}(e,t),e}(B);sk.version=i,sk.PlainUtils=S,sk.XDraw=hc,sk.XIcon=Ma,sk.RectRange=xs,sk.BaseFont=ll,window&&(window.XSheet=sk)}]);
//# sourceMappingURL=XSheet.js.map