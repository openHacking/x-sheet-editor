!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=3)}([function(t,e,r){var n,o,i;o=[],void 0===(i="function"==typeof(n=function(){return function t(e,r,n){var o,i,c=window,l="application/octet-stream",s=n||l,a=e,u=!r&&!n&&a,f=document.createElement("a"),h=function(t){return String(t)},p=c.Blob||c.MozBlob||c.WebKitBlob||h,y=r||"download";if(p=p.call?p.bind(c):Blob,"true"===String(this)&&(s=(a=[a,s])[0],a=a[1]),u&&u.length<2048&&(y=u.split("/").pop().split("?")[0],f.href=u,-1!==f.href.indexOf(u))){var b=new XMLHttpRequest;return b.open("GET",u,!0),b.responseType="blob",b.onload=function(e){t(e.target.response,y,l)},setTimeout((function(){b.send()}),0),b}if(/^data\:[\w+\-]+\/[\w+\-]+[,;]/.test(a)){if(!(a.length>2096103.424&&p!==h))return navigator.msSaveBlob?navigator.msSaveBlob(d(a),y):v(a);s=(a=d(a)).type||l}function d(t){for(var e=t.split(/[:;,]/),r=e[1],n=("base64"==e[2]?atob:decodeURIComponent)(e.pop()),o=n.length,i=0,c=new Uint8Array(o);i<o;++i)c[i]=n.charCodeAt(i);return new p([c],{type:r})}function v(t,e){if("download"in f)return f.href=t,f.setAttribute("download",y),f.className="download-js-link",f.innerHTML="downloading...",f.style.display="none",document.body.appendChild(f),setTimeout((function(){f.click(),document.body.removeChild(f),!0===e&&setTimeout((function(){c.URL.revokeObjectURL(f.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return t=t.replace(/^data:([\w\/\-\+]+)/,l),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var r=document.createElement("iframe");document.body.appendChild(r),e||(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,l)),r.src=t,setTimeout((function(){document.body.removeChild(r)}),333)}if(o=a instanceof p?a:new p([a],{type:s}),navigator.msSaveBlob)return navigator.msSaveBlob(o,y);if(c.URL)v(c.URL.createObjectURL(o),!0);else{if("string"==typeof o||o.constructor===h)try{return v("data:"+s+";base64,"+c.btoa(o))}catch(t){return v("data:"+s+","+encodeURIComponent(o))}(i=new FileReader).onload=function(t){v(this.result)},i.readAsDataURL(o)}return!0}})?n.apply(e,o):n)||(t.exports=i)},function(t,e,r){},function(t,e,r){},function(t,e,r){"use strict";r.r(e);var n={};n.SYSTEM_EVENT_TYPE={MOUSE_MOVE:"mouseMove".toLocaleLowerCase(),MOUSE_DOWN:"mouseDown".toLocaleLowerCase(),MOUSE_UP:"mouseUp".toLocaleLowerCase(),MOUSE_OVER:"mouseOver".toLocaleLowerCase(),MOUSE_LEAVE:"mouseLeave".toLocaleLowerCase(),MOUSE_WHEEL:"mouseWheel".toLocaleLowerCase(),MOUSE_ENTER:"mouseEnter".toLocaleLowerCase(),CLICK:"click".toLocaleLowerCase(),KEY_DOWN:"keyDown".toLocaleLowerCase(),KEY_UP:"keyUp".toLocaleLowerCase(),DRAG_START:"dragStart".toLocaleLowerCase(),SCROLL:"scroll".toLocaleLowerCase(),RESIZE:"resize".toLocaleLowerCase(),CHANGE:"change".toLocaleLowerCase(),INPUT:"input".toLocaleLowerCase(),VISIBILITY_CHANGE:"visibilityChange".toLocaleLowerCase()},n.TABLE_EVENT_TYPE={CHANGE_HEIGHT:"tableChangeHeight".toLocaleLowerCase(),CHANGE_WIDTH:"tableChangeWidth".toLocaleLowerCase(),DATA_CHANGE:"tableDataChange".toLocaleLowerCase(),SELECT_CHANGE:"tableSelectChange".toLocaleLowerCase(),SELECT_DOWN:"tableSelectDown".toLocaleLowerCase(),SCALE_CHANGE:"scaleChange".toLocaleLowerCase()},n.WORK_BODY_EVENT_TYPE={CHANGE_ACTIVE:"workBodyChangeActive".toLocaleLowerCase()},n.MOUSE_POINTER_TYPE={SELECT_ONE_COLUMN:{key:Symbol("选择一列"),type:"s-resize"},SELECT_ONE_ROW:{key:Symbol("选择一行"),type:"e-resize"},SELECT_CELL:{key:Symbol("选择单元格"),type:"cell"},AUTO_FILL:{key:Symbol("单元格内容自动填充"),type:"crosshair"},COL_RESIZE:{key:Symbol("调整列宽"),type:"col-resize"},ROW_RESIZE:{key:Symbol("调整行高"),type:"row-resize"}};var o="x-sheet",i="X-Sheet 1.0.0-develop";function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(n=(c=l.next()).done)&&(r.push(c.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==l.return||l.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],u=null,f=1,h=2,p=3,y=5,b=6,d=7,v=8,g=9,w=10,m=11,O=12,S=13,E=14,x=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,r=null,n=[{key:"type",value:function(t){var e=Object.prototype.toString.call(t);switch(e){case"[object Null]":return d;case"[object Undefined]":return v;case"[object String]":return f;case"[object Boolean]":return h;case"[object Number]":return p;case"[object Function]":return b;case"[object Array]":return y;case"[object Promise]":return g;case"[object GeneratorFunction]":return w;case"[object AsyncFunction]":return m;case"[object BigInt]":return O;case"[object Symbol]":return S;default:return E}}},{key:"cloneDeep",value:function(t){var e=JSON.stringify(t);return JSON.parse(e)}},{key:"mergeDeep",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.isUnDef(e))return{};for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return t.isUnDef(n)||0===n.length?e:(n.forEach((function(r){t.isUnDef(r)||Object.keys(r).forEach((function(n){var o=r[n];"string"==typeof o||"number"==typeof o||"boolean"==typeof o?e[n]=o:"function"!=typeof o&&!Array.isArray(o)&&t.isPlainObject(o)?(e[n]=e[n]||{},t.mergeDeep(e[n],o)):e[n]=o}))})),e)}},{key:"copyProp",value:function(t,e){return Object.assign(t,e)}},{key:"isMac",value:function(){return/macintosh|mac os x/i.test(navigator.userAgent)}},{key:"isWindows",value:function(){return/windows|win32/i.test(navigator.userAgent)}},{key:"isEmptyObject",value:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}},{key:"isNotEmptyObject",value:function(e){return!t.isEmptyObject(e)}},{key:"isUnDef",value:function(t){return null==t}},{key:"isNotUnDef",value:function(t){return!this.isUnDef(t)}},{key:"isNotZero",value:function(t){return 0!==t}},{key:"isNumber",value:function(t){return/^(-?\d+.\d+)$|^(-?\d+)$/.test(t)}},{key:"isFraction",value:function(t){return/^\d+\/\d+$/.test(t)}},{key:"isFunction",value:function(e){return t.type(e)===b}},{key:"isArray",value:function(e){return t.type(e)===y}},{key:"isBlank",value:function(e){return!!t.isUnDef(e)||""===e.toString().trim()}},{key:"isPlainObject",value:function(e){return!t.isUnDef(e)&&Object.getPrototypeOf(e)===Object.getPrototypeOf({})}},{key:"isString",value:function(e){return t.type(e)===f}},{key:"sum",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},r=0,n=0;return Object.keys(t).forEach((function(o){r+=e(t[o],o),n+=1})),[r,n]}},{key:"rangeSum",value:function(t,e,r){for(var n=0,o=t;o<e;o+=1)n+=r(o);return n}},{key:"parseFloat",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(e){return t.isNumber(e)?parseFloat(e):0}))},{key:"parseInt",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(e){return t.isNumber(e)?parseInt(e,10):0}))},{key:"stringAt",value:function(t){for(var e="",r=t;r>=a.length;)r/=a.length,r-=1,e+=a[parseInt(r,10)%a.length];return e+=a[t%a.length]}},{key:"indexAt",value:function(t){for(var e=0,r=0;r<t.length-1;r+=1){var n=t.charCodeAt(r)-65,o=t.length-1-r;e+=Math.pow(a.length,o)+a.length*n}return e+=t.charCodeAt(t.length-1)-65}},{key:"expr2xy",value:function(e){for(var r="",n="",o=0;o<e.length;o+=1)e.charAt(o)>="0"&&e.charAt(o)<="9"?n+=e.charAt(o):r+=e.charAt(o);return[t.indexAt(r),parseInt(n,10)-1]}},{key:"xy2expr",value:function(e,r){return"".concat(t.stringAt(e)).concat(r+1)}},{key:"expr2expr",value:function(e,r,n){var o=l(t.expr2xy(e),2),i=o[0],c=o[1];return t.xy2expr(i+r,c+n)}},{key:"rangeReduceIf",value:function(t,e,r,n,o,i){for(var c=r,l=n,s=t;s<e&&!(c>=o);s+=1)c+=l=i(s);return[s,c-l,l]}},{key:"throttle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;u&&clearTimeout(u),u=setTimeout(t,e)}},{key:"contrastDifference",value:function(e,r){var n={};if(t.isUnDef(e)||t.isUnDef(r))return n;for(var o in e)if(e.hasOwnProperty(o)){var i=r[o],c=e[o];t.isUnDef(i)||t.isUnDef(c)||t.equal(i,c)||(n[o]=e[o])}return n}},{key:"minIf",value:function(t,e){return t<e?e:t}},{key:"maxIf",value:function(t,e){return t>e?e:t}},{key:"equal",value:function(t,e){var r,n,o,i;function l(t,e){var r;if(isNaN(t)&&isNaN(e)&&"number"==typeof t&&"number"==typeof e)return!0;if(t===e)return!0;if("function"==typeof t&&"function"==typeof e||t instanceof Date&&e instanceof Date||t instanceof RegExp&&e instanceof RegExp||t instanceof String&&e instanceof String||t instanceof Number&&e instanceof Number)return t.toString()===e.toString();if(!(t instanceof Object&&e instanceof Object))return!1;if(t.isPrototypeOf(e)||e.isPrototypeOf(t))return!1;if(t.constructor!==e.constructor)return!1;if(t.prototype!==e.prototype)return!1;if(o.indexOf(t)>-1||i.indexOf(e)>-1)return!1;for(r in e){if(e.hasOwnProperty(r)!==t.hasOwnProperty(r))return!1;if(c(e[r])!==c(t[r]))return!1}for(r in t){if(e.hasOwnProperty(r)!==t.hasOwnProperty(r))return!1;if(c(e[r])!==c(t[r]))return!1;switch(c(t[r])){case"object":case"function":if(o.push(t),i.push(e),!l(t[r],e[r]))return!1;o.pop(),i.pop();break;default:if(t[r]!==e[r])return!1}}return!0}if(arguments.length<1)return!0;for(r=1,n=arguments.length;r<n;r++)if(o=[],i=[],!l(arguments[0],arguments[r]))return!1;return!0}},{key:"arrayIncludeArray",value:function(e,r){if(t.isUnDef(e)||t.isUnDef(r))return!1;if(e.length!==r.length)return!1;for(var n=0;n<e.length;n+=1)if(-1===r.indexOf(e[n]))return!1;return!0}},{key:"keepLastIndex",value:function(t){if(window.getSelection){t.focus();var e=window.getSelection();e.selectAllChildren(t),e.collapseToEnd()}else if(document.selection){var r=document.selection.createRange();r.moveToElementText(t),r.collapse(!1),r.select()}}},{key:"trim",value:function(t){return this.isBlank(t)?"":t.trim()}},{key:"now",value:function(){return Date.now().toString()}},{key:"viewPort",value:function(){return{width:window.innerWidth,height:window.innerHeight}}},{key:"exitFullscreen",value:function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}},{key:"fullScreen",value:function(t){t.el&&(t=t.el),t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}},{key:"isFull",value:function(){return!!(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)}}],r&&s(e.prototype,r),n&&s(e,n),t}();function _(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function k(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}x.EMPTY="",x.Nul=null,x.Undef=void 0;var T=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=r):this.el=e,this.el.data=[]}var e,r,n;return e=t,(r=[{key:"data",value:function(t,e){return void 0!==e?(this.el.data[t]=e,this):this.el.data[t]}},{key:"on",value:function(t,e){var r=_(t.split(".")),n=r[0],o=r.slice(1),i=n;return"mousewheel"===i&&/Firefox/i.test(window.navigator.userAgent)&&(i="DOMMouseScroll"),this.el.addEventListener(i,(function(t){e(t);for(var r=0;r<o.length;r+=1){var n=o[r];if("left"===n&&0!==t.button)return;if("right"===n&&2!==t.button)return;"stop"===n&&t.stopPropagation()}})),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach((function(r){e.css(r,"".concat(t[r],"px"))})),this;var r=this.el;return{top:r.offsetTop,left:r.offsetLeft,height:r.offsetHeight,width:r.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"scrollTop",value:function(){return this.el.scrollTop}},{key:"clientHeight",value:function(){return this.el.clientHeight}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return 0===arguments.length?this.el.childNodes:(r.forEach((function(e){return t.child(e)})),this)}},{key:"first",value:function(){return this.el.firstChild}},{key:"last",value:function(){return this.el.lastChild}},{key:"remove",value:function(t){return this.el.removeChild(t.el||t)}},{key:"prepend",value:function(t){var e=this.el;return e.children.length>0?e.insertBefore(t,e.firstChild):e.appendChild(t),this}},{key:"prev",value:function(){return this.el.previousSibling}},{key:"next",value:function(){return this.el.nextSibling}},{key:"child",value:function(e){var r=e;return"string"==typeof e?r=document.createTextNode(e):e instanceof t&&(r=e.el),this.el.appendChild(r),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var r=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach((function(e){r.el.setAttribute(e,t[e])}))}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach((function(e){return t.el.style.removeProperty(e)})),this}},{key:"css",value:function(t,e){var r=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach((function(e){r.el.style[e]=t[e]})),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){var t=this.computedStyle();return t&&"block"!==t.display&&this.css("display","block"),this}},{key:"hide",value:function(){var t=this.computedStyle();return t&&"none"!==t.display&&this.css("display","none"),this}},{key:"display",value:function(t){t?this.show():this.hide()}},{key:"text",value:function(t){return void 0===t?this.el.innerText:(this.el.innerText=t,t)}},{key:"sibling",value:function(){for(var e=this.el,r=[];null!==(e=e.previousElementSibling);)r.push(new t(e));for(e=this.el;null!==(e=e.nextElementSibling);)r.push(new t(e));return r}},{key:"position",value:function(){var t=0,e=0;return this.el.style.position&&(this.el.top&&(t=this.el.style.top.replace("%","").repeat("px","")),this.el.left&&(e=this.el.style.left.replace("%","").repeat("px","")),this.el.right&&(t=this.el.style.right.replace("%","").repeat("px","")),this.el.bottom&&(t=this.el.style.bottom.replace("%","").repeat("px",""))),{top:x.parseFloat(t),left:x.parseFloat(e),right:x.parseFloat(0),bottom:x.parseFloat(0)}}},{key:"trigger",value:function(t,e){var r=new CustomEvent(t,{detail:e,bubbles:!0,cancelable:!1});this.el.dispatchEvent(r)}},{key:"focus",value:function(){this.el.focus()}},{key:"find",value:function(e){var r=this.el.querySelectorAll(e);if(r&&1===r.length)return new t(r[0]);var n=[];if(r){var o=!0,i=!1,c=void 0;try{for(var l,s=r[Symbol.iterator]();!(o=(l=s.next()).done);o=!0){var a=l.value;n.push(new t(a))}}catch(t){i=!0,c=t}finally{try{o||null==s.return||s.return()}finally{if(i)throw c}}}return n}},{key:"isChild",value:function(t){for(var e=t||t.el;null!=e&&e!==document.body;){if(e===this.el)return!0;e=e.parentNode}return!1}}])&&k(e.prototype,r),n&&k(e,n),t}(),C=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new T(t,e)};function A(t){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function P(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function j(t,e){return!e||"object"!==A(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function L(t){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function R(t,e){return(R=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var V=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),j(this,L(e).call(this,r,"".concat(o,"-widget ").concat(t)))}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&R(t,e)}(e,t),r=e,(n=[{key:"computeEventXy",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,r=e.box(),n=r.top,o=r.left;return{x:t.pageX-o,y:t.pageY-n}}},{key:"computeWidgetXy",value:function(t){if(!t)return{x:0,y:0};var e=t.box(),r=e.top,n=e.left,o=this.box(),i=o.top;return{x:n-o.left,y:r-i}}},{key:"attach",value:function(t){this.children(t),t.onAttach(this)}},{key:"onAttach",value:function(){}}])&&P(r.prototype,n),i&&P(r,i),e}(T);function N(t){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function M(t,e){return!e||"object"!==N(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function W(t){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function H(t,e){return(H=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var D=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),M(this,W(e).call(this,"".concat(o,"-layer ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&H(t,e)}(e,t),e}(V);function B(t){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function I(t,e){return!e||"object"!==B(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Y(t){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function F(t,e){return(F=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var U=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=I(this,Y(e).call(this,"".concat(o,"-vertical-layer")))).options=x.mergeDeep({style:{}},t),r.css(r.options.style),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&F(t,e)}(e,t),e}(D);function z(t){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function G(t,e){return!e||"object"!==z(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function X(t){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function K(t,e){return(K=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var q=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=G(this,X(e).call(this,"".concat(o,"-vertical-layer-element")))).options=x.mergeDeep({style:{flexGrow:"0"}},t),r.css(r.options.style),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&K(t,e)}(e,t),e}(D);function $(t){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Z(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function J(t,e){return!e||"object"!==$(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Q(t){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tt(t,e){return(tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var et=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=J(this,Q(e).call(this,"".concat(o,"-icon")))).iconNameEl=C("div","".concat(o,"-icon-img ").concat(r)),t.child(t.iconNameEl),t}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tt(t,e)}(e,t),r=e,(n=[{key:"setWidth",value:function(t){this.iconNameEl.css("width","".concat(t,"px"))}},{key:"setHeight",value:function(t){this.iconNameEl.css("height","".concat(t,"px"))}}])&&Z(r.prototype,n),i&&Z(r,i),e}(V);function rt(t){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nt(t,e){return!e||"object"!==rt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ot(t){return(ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function it(t,e){return(it=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ct=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),nt(this,ot(e).call(this,"".concat(o,"-tools-item ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&it(t,e)}(e,t),e}(V);function lt(t){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function st(t,e){return!e||"object"!==lt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function at(t){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ut(t,e){return(ut=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ft=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=st(this,at(e).call(this,"".concat(o,"-tools-undo")))).icon=new et("undo"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ut(t,e)}(e,t),e}(ct);function ht(t){return(ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pt(t,e){return!e||"object"!==ht(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function yt(t){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bt(t,e){return(bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=pt(this,yt(e).call(this,"".concat(o,"-tools-redo")))).icon=new et("redo"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bt(t,e)}(e,t),e}(ct);function vt(t){return(vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function wt(t,e){return!e||"object"!==vt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mt(t){return(mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ot(t,e){return(Ot=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var St=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=wt(this,mt(e).call(this,"".concat(o,"-tools-point-format")))).icon=new et("point-format"),t.sheets=[],t.children(t.icon),t}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ot(t,e)}(e,t),r=e,(n=[{key:"addSheet",value:function(t){this.sheets.push(t)}},{key:"removeSheet",value:function(t){for(var e=0;e<this.sheets.length;e+=1)if(this.sheets[e]===t)return void this.sheets.splice(e,1)}},{key:"includeSheet",value:function(t){for(var e=0;e<this.sheets.length;e+=1)if(this.sheets[e]===t)return!0;return!1}}])&&gt(r.prototype,n),i&&gt(r,i),e}(ct);function Et(t){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xt(t,e){return!e||"object"!==Et(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _t(t){return(_t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kt(t,e){return(kt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=xt(this,_t(e).call(this,"".concat(o,"-tools-clear-format")))).icon=new et("clear-format"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kt(t,e)}(e,t),e}(ct);function Ct(t){return(Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function At(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Pt(t,e){return!e||"object"!==Ct(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jt(t){return(jt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Lt(t,e){return(Lt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rt=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Pt(this,jt(e).call(this,"".concat(o,"-tools-drop-down-item ").concat(t)))).drop=C("div","".concat(o,"-tools-drop-down-item-mark")),r.title=C("div","".concat(o,"-tools-drop-down-item-title")),r.drop.children(new et("arrow-down")),r.children(r.title),r.children(r.drop),r}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lt(t,e)}(e,t),r=e,(n=[{key:"setTitle",value:function(t){this.title.text(t)}},{key:"setIcon",value:function(t){this.title.html(""),this.title.children(t)}},{key:"setWidth",value:function(t){this.title.css("width","".concat(t,"px"))}},{key:"setEllipsis",value:function(){this.title.css("overflow","hidden"),this.title.css("text-overflow","ellipsis"),this.title.css("white-space","nowrap")}},{key:"removeEllipsis",value:function(){this.title.cssRemoveKeys("overflow"),this.title.cssRemoveKeys("text-overflow"),this.title.cssRemoveKeys("white-space")}}])&&At(r.prototype,n),i&&At(r,i),e}(ct);function Vt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Nt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,o;return e=t,o=[{key:"bind",value:function(t,e,r){if(Array.isArray(t)){var n=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(n=(c=l.next()).done);n=!0){var s=c.value;(s.el||s).addEventListener(e,r)}}catch(t){o=!0,i=t}finally{try{n||null==l.return||l.return()}finally{if(o)throw i}}}else(t.el||t).addEventListener(e,r)}},{key:"unbind",value:function(t,e,r){if(Array.isArray(t)){var n=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(n=(c=l.next()).done);n=!0){var s=c.value;(s.el||s).addEventListener(e,r)}}catch(t){o=!0,i=t}finally{try{n||null==l.return||l.return()}finally{if(o)throw i}}}else(t.el||t).removeEventListener(e,r)}},{key:"mouseMoveUp",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=function i(c){t.unbind(e,n.SYSTEM_EVENT_TYPE.MOUSE_MOVE,r),t.unbind(e,n.SYSTEM_EVENT_TYPE.MOUSE_UP,i),o(c)};t.bind(e,n.SYSTEM_EVENT_TYPE.MOUSE_MOVE,r),t.bind(e,n.SYSTEM_EVENT_TYPE.MOUSE_UP,i)}},{key:"dbClick",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=0;t.bind(e,n.SYSTEM_EVENT_TYPE.CLICK,(function(t){var e=Date.now();e-o<=300?(r(t),o=0):o=e}))}}],(r=null)&&Vt(e.prototype,r),o&&Vt(e,o),t}();function Mt(t){return(Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ht(t,e){return!e||"object"!==Mt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dt(t){return(Dt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bt(t,e){return(Bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var It=function(t){function e(t){var r,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ht(this,Dt(e).call(this,"".concat(o,"-scroll-bar-x")))).option=x.mergeDeep({style:{},scroll:function(t){return t}},t),n.lastBut=C("div","".concat(o,"-scroll-bar-x-last-but")),n.nextBut=C("div","".concat(o,"-scroll-bar-x-next-but")),n.content=C("div","".concat(o,"-scroll-bar-x-content")),n.block=C("div","".concat(o,"-scroll-bar-x-block")),n.content.children(n.block),(r=n).children.apply(r,[n.lastBut,n.nextBut,n.content]),n.blockLeft=0,n.maxBlockLeft=0,n.blockWidth=0,n.minBlockWidth=20,n.scrollTo=0,n.contentWidth=0,n.viewPortWidth=0,n.isHide=!0,n.css(n.option.style),n.hide(),n}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bt(t,e)}(e,t),r=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"bind",value:function(){var t=this;this.block.on(n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(0===e.button){var r=t.computeEventXy(e,t.block);Nt.mouseMoveUp(C(document),(function(e){var n=t.computeEventXy(e,t.content).x-r.x;n<0&&(n=0),n>t.maxBlockLeft&&(n=t.maxBlockLeft),t.blockLeft=n,t.scrollTo=t.computeScrollTo(t.blockLeft),t.block.css("left","".concat(n,"px")),t.option.scroll(t.scrollTo),e.stopPropagation(),e.preventDefault()})),e.stopPropagation(),e.preventDefault()}}))}},{key:"setSize",value:function(t,e){if(t<e){this.isHide=!1,this.show();var r=this.content.box(),n=t/e*r.width;this.blockWidth=n<this.minBlockWidth?this.minBlockWidth:n,this.viewPortWidth=t,this.contentWidth=e,this.maxBlockLeft=r.width-this.blockWidth,this.block.css("width","".concat(this.blockWidth,"px"));var o=this.scrollTo/(e-t)*this.maxBlockLeft;this.blockLeft=o>this.maxBlockLeft?this.maxBlockLeft:o,this.scrollTo=this.computeScrollTo(this.blockLeft),this.block.css("left","".concat(this.blockLeft,"px"))}else this.isHide=!0,this.hide(),this.option.scroll(0)}},{key:"scrollMove",value:function(t){var e=t,r=this.contentWidth-this.viewPortWidth;e>r?e=r:e<0&&(e=0);var n=e/(this.contentWidth-this.viewPortWidth)*this.maxBlockLeft;this.blockLeft=n>this.maxBlockLeft?this.maxBlockLeft:n,this.scrollTo!==e&&!1===this.isHide&&(this.scrollTo=e,this.block.css("left","".concat(this.blockLeft,"px")),this.option.scroll(this.scrollTo))}},{key:"computeScrollTo",value:function(t){return t/this.maxBlockLeft*(this.contentWidth-this.viewPortWidth)}}])&&Wt(r.prototype,i),c&&Wt(r,c),e}(V);function Yt(t){return(Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ft(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ut(t,e){return!e||"object"!==Yt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zt(t){return(zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gt(t,e){return(Gt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xt=function(t){function e(t){var r,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ut(this,zt(e).call(this,"".concat(o,"-scroll-bar-y")))).option=x.mergeDeep({style:{},scroll:function(t){return t}},t),n.lastBut=C("div","".concat(o,"-scroll-bar-y-last-but")),n.nextBut=C("div","".concat(o,"-scroll-bar-y-next-but")),n.content=C("div","".concat(o,"-scroll-bar-y-content")),n.block=C("div","".concat(o,"-scroll-bar-y-block")),n.content.children(n.block),(r=n).children.apply(r,[n.lastBut,n.nextBut,n.content]),n.blockTop=0,n.maxBlockTop=0,n.blockHeight=0,n.minBlockHeight=20,n.scrollTo=0,n.contentHeight=0,n.viewPortHeight=0,n.isHide=!0,n.css(n.option.style),n.hide(),n}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gt(t,e)}(e,t),r=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"bind",value:function(){var t=this;Nt.bind(this.block,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(0===e.button){var r=t.computeEventXy(e,t.block);Nt.mouseMoveUp(C(document),(function(e){var n=t.computeEventXy(e,t.content).y-r.y;n<0&&(n=0),n>t.maxBlockTop&&(n=t.maxBlockTop),t.blockTop=n,t.scrollTo=t.computeScrollTo(t.blockTop),t.block.css("top","".concat(n,"px")),t.option.scroll(t.scrollTo),e.stopPropagation(),e.preventDefault()}))}}))}},{key:"setSize",value:function(t,e){if(t<e){this.isHide=!1,this.show();var r=this.content.box(),n=t/e*r.height;this.blockHeight=n<this.minBlockHeight?this.minBlockHeight:n,this.viewPortHeight=t,this.contentHeight=e,this.maxBlockTop=r.height-this.blockHeight,this.block.css("height","".concat(this.blockHeight,"px"));var o=this.scrollTo/(e-t)*this.maxBlockTop;this.blockTop=o>this.maxBlockTop?this.maxBlockTop:o,this.scrollTo=this.computeScrollTo(this.blockTop),this.block.css("top","".concat(this.blockTop,"px"))}else this.isHide=!0,this.hide(),this.option.scroll(0)}},{key:"scrollMove",value:function(t){var e=t,r=this.contentHeight-this.viewPortHeight;e>r?e=r:e<0&&(e=0);var n=e/(this.contentHeight-this.viewPortHeight)*this.maxBlockTop;this.blockTop=n>this.maxBlockTop?this.maxBlockTop:n,this.scrollTo!==e&&!1===this.isHide&&(this.scrollTo=e,this.block.css("top","".concat(this.blockTop,"px")),this.option.scroll(this.scrollTo))}},{key:"computeScrollTo",value:function(t){return t/this.maxBlockTop*(this.contentHeight-this.viewPortHeight)}}])&&Ft(r.prototype,i),c&&Ft(r,c),e}(V);function Kt(t){return(Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qt(t,e){return!e||"object"!==Kt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $t(t){return($t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zt(t,e){return(Zt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jt=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=qt(this,$t(e).call(this,"".concat(o,"-horizontal-layer-element")))).options=x.mergeDeep({style:{flexGrow:"0"}},t),r.css(r.options.style),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zt(t,e)}(e,t),e}(D);function Qt(t){return(Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function te(t,e){return!e||"object"!==Qt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ee(t){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function re(t,e){return(re=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ne=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=te(this,ee(e).call(this,"".concat(o,"-horizontal-layer")))).options=x.mergeDeep({style:{}},t),r.css(r.options.style),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&re(t,e)}(e,t),e}(D);function oe(t){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ie(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ce(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function le(t,e){return(le=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function se(t,e,r){return(se="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ae(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function ae(t){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ue={TOP:1,LEFT:2,BOTTOM:3,RIGHT:4},fe=[],he=null,pe=function(t){function e(t){var r,n,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,r=!(i=ae(e).call(this,"".concat(o,"-el-pop-up")))||"object"!==oe(i)&&"function"!=typeof i?ce(n):i,fe.push(ce(r)),r.options=x.mergeDeep({position:ue.BOTTOM,el:null},t),r.off=!0,r.content=new V("".concat(o,"-el-pop-up-content")),r.scrollBarX=new It,r.scrollBarY=new Xt;var c=new Jt({style:{flexGrow:1}});c.children(r.content);var l=new Jt({style:{overflow:"inherit"}});l.children(r.scrollBarY);var s=new ne;s.children(c),s.children(l);var a=new q(s);a.children(s);var u=new q;u.children(r.scrollBarX);var f=new U;return f.children(a),f.children(u),se(ae(e.prototype),"children",ce(r)).call(ce(r),f),r.bind(),r}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&le(t,e)}(e,t),r=e,c=[{key:"closeAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];fe.forEach((function(e){-1===t.indexOf(e)&&e.close()}))}},{key:"setRoot",value:function(t){t=t.el?C(t.el):C(t),he=t}}],(i=[{key:"bind",value:function(){var t=this;Nt.bind(window,n.SYSTEM_EVENT_TYPE.RESIZE,(function(){t.position(),t.scrollbar()}))}},{key:"children",value:function(){var t;(t=this.content).children.apply(t,arguments)}},{key:"position",value:function(){var t=this.content,e=this.options,r=e.el,n=e.position,o=r.box(),i=t.box(),c=o.top,l=o.left;switch(n){case ue.TOP:c=o.top-i.height;break;case ue.LEFT:l=o.left-i.width;break;case ue.RIGHT:l=o.left+o.width;break;case ue.BOTTOM:c=o.top+o.height}var s=window.innerWidth,a=window.innerHeight;if(l<0||l+i.width>s)switch(n){case ue.LEFT:l=o.left+o.width;break;case ue.RIGHT:l=o.left-i.width}if(c<0||c+i.height>a)switch(n){case ue.TOP:c=o.top+o.height;break;case ue.BOTTOM:c=o.top-i.height}(l<0||l+i.width>s)&&(c=o.top+o.height,l=o.left),(c<0||c+i.height>a)&&(c=o.top+o.height,l=o.left),this.offset({top:c,left:l})}},{key:"scrollbar",value:function(){var t=this.content.box(),e=this.box();this.scrollBarY.setSize(e.height,t.height),this.scrollBarX.setSize(e.width,t.width)}},{key:"open",value:function(){this.off&&he&&(he.children(this),this.position(),this.scrollbar(),this.off=!1)}},{key:"close",value:function(){!1===this.off&&he&&(he.remove(this),this.off=!0)}}])&&ie(r.prototype,i),c&&ie(r,c),e}(V);function ye(t){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function be(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function de(t){return(de=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ve(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ge(t,e){return(ge=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var we=function(t){function e(){var t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(t=!(n=de(e).call(this,"".concat(o,"-el-context-menu ").concat(i)))||"object"!==ye(n)&&"function"!=typeof n?ve(r):n).options=x.mergeDeep({},c),t.menus=[],t.elPopUp=new pe(t.options),t.elPopUp.children(ve(t)),t.bind(),t}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ge(t,e)}(e,t),r=e,(i=[{key:"bind",value:function(){var t=this;Nt.bind(this,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){t.stopPropagation(),t.preventDefault()})),Nt.bind(document.body,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.close()}))}},{key:"addItem",value:function(t){return this.menus.push(t),this.children(t),this}},{key:"open",value:function(){return this.elPopUp.open(),this}},{key:"close",value:function(){return this.elPopUp.close(),this}},{key:"isOpen",value:function(){return this.elPopUp.off}}])&&be(r.prototype,i),c&&be(r,c),e}(V);function me(t){return(me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oe(t,e){return!e||"object"!==me(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Se(t){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ee(t,e){return(Ee=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xe=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Oe(this,Se(e).call(this,"".concat(o,"-el-context-menu-item hover ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ee(t,e)}(e,t),e}(V);function _e(t){return(_e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ke(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Te(t){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ce(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ae(t,e){return(Ae=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pe=[],je=function(t){function e(t,r){var n,i,c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i=this,(n=!(c=Te(e).call(this,"".concat(o,"-format-context-menu-item")))||"object"!==_e(c)&&"function"!=typeof c?Ce(i):c).title=t,n.desc=r,n.icon=new et("checked"),n.iconElement=C("div","".concat(o,"-format-context-menu-item-icon")),n.iconElement.children(n.icon),n.titleElement=C("div","".concat(o,"-format-context-menu-item-title")),n.descElement=C("div","".concat(o,"-format-context-menu-item-desc")),n.titleElement.text(t),n.descElement.text(r),n.children(n.iconElement),n.children(n.titleElement),n.children(n.descElement),Pe.push(Ce(n)),n}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ae(t,e)}(e,t),r=e,(n=[{key:"setTitle",value:function(t){this.titleElement.text(t)}},{key:"setDesc",value:function(t){this.descElement.text(t)}},{key:"setActive",value:function(){Pe.forEach((function(t){t.removeClass("active")})),this.addClass("active")}}])&&ke(r.prototype,n),i&&ke(r,i),e}(xe);function Le(t){return(Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Re(t,e){return!e||"object"!==Le(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ve(t){return(Ve=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ne(t,e){return(Ne=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Me=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Re(this,Ve(e).call(this,"".concat(o,"-el-context-menu-item-divider")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ne(t,e)}(e,t),e}(V);function We(t){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function He(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function De(t,e){return!e||"object"!==We(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Be(t){return(Be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ie(t,e){return(Ie=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ye=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=De(this,Be(e).call(this,"".concat(o,"-format-context-menu"),x.mergeDeep({onUpdate:function(){}},r)))).items=[new je("常规","").data("type","default"),new je("文本","").data("type","text"),new Me,new je("数值","0.59").data("type","number"),new je("百分比","90.00%").data("type","percentage"),new je("分数","1/2").data("type","fraction"),new je("科学计数","9.50e-01").data("type","ENotation"),new Me,new je("人民币","￥5.00").data("type","rmb"),new je("港币","HK5.00").data("type","hk"),new je("美元","$5.00").data("type","dollar"),new Me,new je("日期","2018/4/18").data("type","date1"),new je("日期","4月18日").data("type","date2"),new je("日期","2018年4月").data("type","date3"),new je("日期","2018年4月18日").data("type","date4"),new je("日期","2018/4/18 14:30:30").data("type","date5"),new je("时间","14:30:30").data("type","time")],t.items.forEach((function(e){e instanceof je&&e.data("type")&&e.on(n.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.data("type"),e.title),e.setActive()})),t.addItem(e)})),t.init(),t}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ie(t,e)}(e,t),r=e,(i=[{key:"init",value:function(){var t=this.options,e=this.items,r=t.el,n=e[0];r.setTitle(n.title),n.setActive()}},{key:"update",value:function(t,e){this.options.onUpdate(t,e),this.close()}},{key:"setActiveByType",value:function(t){this.items.forEach((function(e){e.data("type")===t&&e.setActive()}))}}])&&He(r.prototype,i),c&&He(r,c),e}(we);function Fe(t){return(Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ue(t){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ze(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ge(t,e){return(Ge=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xe=function(t){function e(t){var r,n,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(r=!(i=Ue(e).call(this,"".concat(o,"-tools-format")))||"object"!==Fe(i)&&"function"!=typeof i?ze(n):i).options=x.copyProp({contextMenu:{}},t),r.setTitle("常规"),r.setWidth(50),r.setEllipsis(),r.formatContextMenu=new Ye(x.copyProp({el:ze(r),position:ue.BOTTOM},r.options.contextMenu)),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ge(t,e)}(e,t),e}(Rt);function Ke(t){return(Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function $e(t){return($e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ze(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Je(t,e){return(Je=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qe=[],tr=function(t){function e(t){var r,n,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(r=!(i=$e(e).call(this,"".concat(o,"-font-context-menu-item")))||"object"!==Ke(i)&&"function"!=typeof i?Ze(n):i).title=t,r.icon=new et("checked"),r.iconElement=C("div","".concat(o,"-font-context-menu-item-icon")),r.iconElement.children(r.icon),r.titleElement=C("div","".concat(o,"-font-context-menu-item-title")),r.titleElement.text(t),r.titleElement.css("font-family",t),r.children(r.iconElement),r.children(r.titleElement),Qe.push(Ze(r)),r}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Je(t,e)}(e,t),r=e,(n=[{key:"setTitle",value:function(t){this.title=t,this.titleElement.text(t)}},{key:"setActive",value:function(){Qe.forEach((function(t){t.removeClass("active")})),this.addClass("active")}}])&&qe(r.prototype,n),i&&qe(r,i),e}(xe);function er(t){return(er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function nr(t,e){return!e||"object"!==er(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function or(t){return(or=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ir(t,e){return(ir=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var cr=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=nr(this,or(e).call(this,"".concat(o,"-font-context-menu"),x.mergeDeep({onUpdate:function(){}},r)))).items=[new tr("Arial"),new tr("Helvetica"),new tr("Source Sans Pro"),new tr("Comic Sans Ms"),new tr("Courier New"),new tr("Verdana"),new tr("Lalo")],t.items.forEach((function(e){e.on(n.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.title),e.setActive()})),t.addItem(e)})),t.setActiveByType(t.items[0].title),t}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ir(t,e)}(e,t),r=e,(i=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}},{key:"setActiveByType",value:function(t){this.items.forEach((function(e){e.title===t&&e.setActive()}))}}])&&rr(r.prototype,i),c&&rr(r,c),e}(we);function lr(t){return(lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sr(t){return(sr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ar(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ur(t,e){return(ur=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fr=function(t){function e(t){var r,n,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(r=!(i=sr(e).call(this,"".concat(o,"-tools-font")))||"object"!==lr(i)&&"function"!=typeof i?ar(n):i).options=x.copyProp({contextMenu:{}},t),r.setTitle("Arial"),r.setWidth(50),r.setEllipsis(),r.fontContextMenu=new cr(x.copyProp({el:ar(r),position:ue.BOTTOM},r.options.contextMenu)),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ur(t,e)}(e,t),e}(Rt);function hr(t){return(hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pr(t,e){return!e||"object"!==hr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function yr(t){return(yr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function br(t,e){return(br=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dr=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=pr(this,yr(e).call(this,"".concat(o,"-font-size-context-menu-item")))).size=t,r.titleElement=C("div","".concat(o,"-font-size-context-menu-item-title")),r.titleElement.text(t),r.titleElement.css("text-align","center"),r.children(r.titleElement),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&br(t,e)}(e,t),e}(xe);function vr(t){return(vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function wr(t,e){return!e||"object"!==vr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mr(t){return(mr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Or(t,e){return(Or=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Sr=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=wr(this,mr(e).call(this,"".concat(o,"-font-size-context-menu"),x.mergeDeep({onUpdate:function(){}},r)))).items=[new dr(6),new dr(7),new dr(8),new dr(9),new dr(10),new dr(11),new dr(12),new dr(14),new dr(15),new dr(18),new dr(24),new dr(36)],t.items.forEach((function(e){e.on(n.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.size)})),t.addItem(e)})),t}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Or(t,e)}(e,t),r=e,(i=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}}])&&gr(r.prototype,i),c&&gr(r,c),e}(we);function Er(t){return(Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xr(t){return(xr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kr(t,e){return(kr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tr=function(t){function e(){var t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(t=!(n=xr(e).call(this,"".concat(o,"-tools-font-size")))||"object"!==Er(n)&&"function"!=typeof n?_r(r):n).options=i,t.setTitle("10"),t.setWidth(30),t.setEllipsis(),t.fontSizeContextMenu=new Sr(x.copyProp({el:_r(t),position:ue.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kr(t,e)}(e,t),e}(Rt);function Cr(t){return(Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ar(t,e){return!e||"object"!==Cr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pr(t){return(Pr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jr(t,e){return(jr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Lr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ar(this,Pr(e).call(this,"".concat(o,"-tools-font-bold")))).icon=new et("font-bold"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jr(t,e)}(e,t),e}(ct);function Rr(t){return(Rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vr(t,e){return!e||"object"!==Rr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Nr(t){return(Nr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mr(t,e){return(Mr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Vr(this,Nr(e).call(this,"".concat(o,"-tools-font-italic")))).icon=new et("font-italic"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mr(t,e)}(e,t),e}(ct);function Hr(t){return(Hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dr(t,e){return!e||"object"!==Hr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Br(t){return(Br=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ir(t,e){return(Ir=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Dr(this,Br(e).call(this,"".concat(o,"-tools-under-line")))).icon=new et("under-line"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ir(t,e)}(e,t),e}(ct);function Fr(t){return(Fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ur(t,e){return!e||"object"!==Fr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zr(t){return(zr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gr(t,e){return(Gr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ur(this,zr(e).call(this,"".concat(o,"-tools-font-strike")))).icon=new et("font-strike"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gr(t,e)}(e,t),e}(ct);function Kr(t){return(Kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qr(t,e){return!e||"object"!==Kr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $r(t){return($r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zr(t,e){return(Zr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jr=function(t){function e(t,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=qr(this,$r(e).call(this,"".concat(o,"-font-color-context-menu-item")))).title=t,n.icon=r,r&&(n.iconElement=C("div","".concat(o,"-font-color-context-menu-item-icon")),n.iconElement.children(n.icon),n.children(n.iconElement)),t&&(n.titleElement=C("div","".concat(o,"-font-color-context-menu-item-title")),n.titleElement.text(t),n.children(n.titleElement)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zr(t,e)}(e,t),e}(xe);function Qr(t){return(Qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function en(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rn(t,e){return(rn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function nn(t,e,r){return(nn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=on(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function on(t){return(on=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var cn=[],ln=null,sn={LEFT:1,TOP:2,RIGHT:3,CENTER:4},an=function(t){function e(t){var r,n,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(r=!(i=on(e).call(this,"".concat(o,"-drag-panel")))||"object"!==Qr(i)&&"function"!=typeof i?en(n):i).options=x.mergeDeep({position:sn.CENTER},t),r.off=!0,r.mask=C("div","".concat(o,"-drag-panel-mask")),r.content=C("div","".concat(o,"-drag-panel-content")),nn(on(e.prototype),"children",en(r)).call(en(r),r.content),r.bind(),cn.push(en(r)),r}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rn(t,e)}(e,t),r=e,c=[{key:"closeAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];cn.forEach((function(e){-1===t.indexOf(e)&&e.close()}))}},{key:"setRoot",value:function(t){t=t.el?C(t.el):C(t),ln=t}}],(i=[{key:"bind",value:function(){var t=this,e=this.mask;Nt.bind(e,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.close(),e.stopPropagation()})),Nt.bind(this,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(0===e.button){var r=t.computeEventXy(e,t);Nt.mouseMoveUp(C(document),(function(e){var n=e.pageY-r.y,o=e.pageX-r.x;t.offset({top:n,left:o}),e.stopPropagation(),e.preventDefault()})),e.stopPropagation(),e.preventDefault()}}))}},{key:"position",value:function(){var t=this.options.position,e=x.viewPort(),r=e.width,n=e.height,o=this.box();switch(t){case sn.LEFT:case sn.RIGHT:case sn.TOP:break;case sn.CENTER:this.offset({left:r/2-o.width/2,top:n/2-o.height/2})}}},{key:"open",value:function(){if(this.off&&ln){var t=this.mask;ln.children(t),ln.children(this),this.position(),this.off=!1}}},{key:"close",value:function(){if(!1===this.off&&ln){var t=this.mask;ln.remove(this),ln.remove(t),this.off=!0}}},{key:"children",value:function(){var t;(t=this.content).children.apply(t,arguments)}}])&&tn(r.prototype,i),c&&tn(r,c),e}(V);function un(t){return(un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function hn(t){return(hn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yn(t,e){return(yn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bn=function(t){function e(t){var r,n,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(r=!(i=hn(e).call(this,"".concat(o,"-color-picker")))||"object"!==un(i)&&"function"!=typeof i?pn(n):i).options=x.mergeDeep({selectCb:function(){}},t),r.dragPanel=new an,r.color=[360,0,100],r.preViewColorPoint=C("div","".concat(o,"-color-picker-pre-view-color-point")),r.colorValueTips=C("div","".concat(o,"-color-picker-color-value-tips")),r.colorValueTips.text("十六进制颜色值"),r.colorInput=C("input","".concat(o,"-color-picker-color-input")),r.top=C("div","".concat(o,"-color-picker-top")),r.top.children(r.preViewColorPoint),r.top.children(r.colorValueTips),r.top.children(r.colorInput),r.selectColorPoint=C("div","".concat(o,"-color-picker-select-color-point")),r.selectColorArea1=C("div","".concat(o,"-color-picker-select-color-area area1")),r.selectColorArea2=C("div","".concat(o,"-color-picker-select-color-area area2")),r.selectColorArea3=C("div","".concat(o,"-color-picker-select-color-area area3")),r.center=C("div","".concat(o,"-color-picker-center")),r.center.children(r.selectColorArea1),r.center.children(r.selectColorArea2),r.center.children(r.selectColorArea3),r.center.children(r.selectColorPoint),r.colorHuxTips=C("div","".concat(o,"-color-picker-color-hux-tips")),r.colorBar=C("div","".concat(o,"-color-picker-color-bar")),r.colorBarPoint=C("div","".concat(o,"-color-picker-bar-point")),r.bottom=C("div","".concat(o,"-color-picker-bottom")),r.colorHuxTips.text("HUE"),r.colorBar.children(r.colorBarPoint),r.bottom.children(r.colorHuxTips),r.bottom.children(r.colorBar),r.cancelButton=C("div","".concat(o,"-color-picker-button cancel")),r.selectButton=C("div","".concat(o,"-color-picker-button select")),r.buttons=C("div","".concat(o,"-color-picker-buttons")),r.cancelButton.text("取消"),r.selectButton.text("确定"),r.buttons.children(r.selectButton),r.buttons.children(r.cancelButton),r.children(r.top),r.children(r.center),r.children(r.bottom),r.children(r.buttons),r.dragPanel.children(pn(r)),r.dragPanel.css("background","#ffffff"),r.bind(),r}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yn(t,e)}(e,t),r=e,c=[{key:"fixHex",value:function(t){var e=6-t.length;if(e>0){for(var r=[],n=0;n<e;n+=1)r.push("0");r.push(t),t=r.join("")}return t}},{key:"fixHsx",value:function(t){return{h:Math.min(360,Math.max(0,t.h)),s:Math.min(100,Math.max(0,t.s)),x:Math.min(100,Math.max(0,t.x))}}},{key:"hexToRgb",value:function(t){return{r:(t=parseInt(t.indexOf("#")>-1?t.substring(1):t,16))>>16,g:(65280&t)>>8,b:255&t}}},{key:"hexToHsb",value:function(t){return this.rgbToHsb(this.hexToRgb(t))}},{key:"rgbToHsb",value:function(t){var e={h:0,s:0,x:0},r=Math.min(t.r,t.g,t.b),n=Math.max(t.r,t.g,t.b),o=n-r;return e.x=n,e.s=0!==n?255*o/n:0,0!==e.s?t.r===n?e.h=(t.g-t.b)/o:t.g===n?e.h=2+(t.b-t.r)/o:e.h=4+(t.r-t.g)/o:e.h=-1,e.h*=60,e.h<0&&(e.h+=360),e.s*=100/255,e.x*=100/255,e}},{key:"hsbToRgb",value:function(t){var e={},r=t.h,n=255*t.s/100,o=255*t.x/100;if(0===n)e.r=o,e.g=o,e.b=o;else{var i=o,c=(255-n)*o/255,l=r%60*(i-c)/60;360===r&&(r=0),r<60?(e.r=i,e.b=c,e.g=c+l):r<120?(e.g=i,e.b=c,e.r=i-l):r<180?(e.g=i,e.r=c,e.b=c+l):r<240?(e.b=i,e.r=c,e.g=i-l):r<300?(e.b=i,e.g=c,e.r=c+l):r<360?(e.r=i,e.g=c,e.b=i-l):(e.r=0,e.g=0,e.b=0)}return{r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)}}},{key:"rgbToHex",value:function(t){var e=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return e.forEach((function(t,r){1===t.length&&(e[r]="0".concat(t))})),e.join("")}},{key:"hsbToHex",value:function(t){return this.rgbToHex(this.hsbToRgb(t))}},{key:"isRgb",value:function(t){return t.startsWith("rgb")}},{key:"isHex",value:function(t){return t.startsWith("#")}},{key:"parseRgb",value:function(t){var e=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return{r:e[1],g:e[2],b:e[3]}}},{key:"isDark",value:function(t){if(x.isBlank(t))return!1;if(this.isHex(t)){var r=e.hexToRgb(t);t="rgb(".concat(r.r,", ").concat(r.g,", ").concat(r.b,")")}var n=e.parseRgb(t);return.299*n.r+.578*n.g+.114*n.b>=192}}],(i=[{key:"bind",value:function(){var t=this,r=this.selectColorPoint,o=this.center,i=this.colorBarPoint,c=this.colorBar,l=this.colorInput,s=this.cancelButton,a=this.selectButton;Nt.bind(this,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){t.stopPropagation()})),Nt.bind(r,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.computeEventXy(e,o),n=o.box();r.x<0&&(r.x=0),r.x>n.width&&(r.x=n.width),r.y<0&&(r.y=0),r.y>n.height&&(r.y=n.height),t.downSelect(r.x,r.y,n.width,n.height),Nt.mouseMoveUp(C(document),(function(e){var r=t.computeEventXy(e,o);r.x<0&&(r.x=0),r.x>n.width&&(r.x=n.width),r.y<0&&(r.y=0),r.y>n.height&&(r.y=n.height),t.moveSelect(r.x,r.y,n.width,n.height)}))})),Nt.bind(i,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.computeEventXy(e,c),n=c.box();r.x<0&&(r.x=0),r.x>n.width&&(r.x=n.width),t.downHue(r.x,n.width),Nt.mouseMoveUp(C(document),(function(e){var r=t.computeEventXy(e,c),n=c.box();r.x<0&&(r.x=0),r.x>n.width&&(r.x=n.width),t.moveHue(r.x,n.width)}))})),Nt.bind(l,n.SYSTEM_EVENT_TYPE.CHANGE,(function(){var e=l.val();e&&t.hexColor(e)})),Nt.bind(s,n.SYSTEM_EVENT_TYPE.CLICK,(function(){t.close()})),Nt.bind(a,n.SYSTEM_EVENT_TYPE.CLICK,(function(){var r=t.color,n=e.fixHsx({h:parseInt(r[0],10),s:parseInt(r[1],10),x:parseInt(r[2],10)}),o=e.hsbToHex(n);t.options.selectCb("#".concat(o)),t.close()}))}},{key:"open",value:function(t){if(this.dragPanel.open(),t){if(e.isRgb(t)){var r=e.parseRgb(t);t=e.rgbToHex(r)}this.hexColor(t)}else this.change();return this}},{key:"close",value:function(){return this.dragPanel.close(),this}},{key:"sliderPosition",value:function(t){var e=this.colorBar,r=this.colorBarPoint,n=r.box(),o=e.box(),i=parseInt(o.width-o.width*t.h/360,10);i-=n.width/2,r.offset({left:i});var c=this.center,l=this.selectColorPoint,s=l.box(),a=c.box(),u=parseInt(a.width*t.s/100,10),f=parseInt(a.height*(100-t.x)/100,10);u-=s.width/2,f-=s.height/2,l.offset({left:u,top:f})}},{key:"hueChange",value:function(){var t=this.color,r=e.fixHsx({h:parseInt(t[0],10),s:parseInt(t[1],10),x:parseInt(t[2],10)}),n=this.colorBarPoint,o=this.selectColorPoint,i=this.preViewColorPoint,c=this.selectColorArea1,l=this.colorInput,s=e.hsbToHex(r),a=e.hsbToHex({h:r.h,s:100,x:100});o.css("backgroundColor","#".concat(s)),i.css("backgroundColor","#".concat(s)),n.css("backgroundColor","#".concat(a)),c.css("backgroundColor","#".concat(a)),l.val("#".concat(s)),this.sliderPosition(r)}},{key:"selectChange",value:function(){var t=this.color,r=e.fixHsx({h:parseInt(t[0],10),s:parseInt(t[1],10),x:parseInt(t[2],10)}),n=this.preViewColorPoint,o=this.selectColorPoint,i=this.colorInput,c=e.hsbToHex(r);o.css("backgroundColor","#".concat(c)),n.css("backgroundColor","#".concat(c)),i.val("#".concat(c)),this.sliderPosition(r)}},{key:"change",value:function(){this.hueChange(),this.selectChange()}},{key:"downSelect",value:function(t,e,r,n){var o=this.color;o[1]=parseInt(100*t/r,10),o[2]=parseInt(100*(n-e)/n,10),this.selectChange()}},{key:"moveSelect",value:function(t,e,r,n){var o=this.color;o[1]=parseInt(100*Math.max(0,Math.min(r,t))/r,10),o[2]=parseInt(100*(n-Math.max(0,Math.min(n,e)))/n,10),this.selectChange()}},{key:"downHue",value:function(t,e){this.color[0]=parseInt(360*(e-t)/e,10),this.hueChange()}},{key:"moveHue",value:function(t,e){this.color[0]=parseInt(360*(e-Math.max(0,Math.min(e,t)))/e,10),this.hueChange()}},{key:"hexColor",value:function(t){var r=this.color,n=e.hexToHsb(e.fixHex(t));r[0]=n.h,r[1]=n.s,r[2]=n.x,this.change()}}])&&fn(r.prototype,i),c&&fn(r,c),e}(V);function dn(t){return(dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function gn(t,e){return!e||"object"!==dn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wn(t){return(wn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mn(t,e){return(mn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var On=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=gn(this,wn(e).call(this,"".concat(o,"-color-array-item")))).options=x.mergeDeep({color:null,icon:null},t),r.color=r.options.color,r.icon=r.options.icon,r.color&&(r.css("backgroundColor",r.color),bn.isDark(r.options.color)?(r.checkedIcon=new et("checked-dark"),r.children(r.checkedIcon)):(r.checkedIcon=new et("checked-light"),r.children(r.checkedIcon)),r.checkedIcon.hide()),r.icon&&r.children(r.options.icon),r}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mn(t,e)}(e,t),r=e,(n=[{key:"setActive",value:function(t){this.checkedIcon&&(t?this.checkedIcon.show():this.checkedIcon.hide())}}])&&vn(r.prototype,n),i&&vn(r,i),e}(V);function Sn(t){return(Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function En(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function xn(t,e){return!e||"object"!==Sn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _n(t){return(_n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kn(t,e){return(kn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tn=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=xn(this,_n(e).call(this,"".concat(o,"-color-array")))).options=x.mergeDeep({colors:[new On({color:"rgb(0,0,0)"}),new On({color:"rgb(67, 67, 67)"}),new On({color:"rgb(102, 102, 102)"}),new On({color:"rgb(153, 153, 153)"}),new On({color:"rgb(183, 183, 183)"}),new On({color:"rgb(204, 204, 204)"}),new On({color:"rgb(217, 217, 217)"}),new On({color:"rgb(239, 239, 239)"}),new On({color:"rgb(255, 255, 255)"}),new On({color:"rgb(152, 0, 0)"}),new On({color:"rgb(255, 0, 0)"}),new On({color:"rgb(255, 153, 0)"}),new On({color:"rgb(255, 255, 0)"}),new On({color:"rgb(0, 255, 0)"}),new On({color:"rgb(0, 255, 255)"}),new On({color:"rgb(74, 134, 232)"}),new On({color:"rgb(0, 0, 255)"}),new On({color:"rgb(153, 0, 255)"}),new On({color:"rgb(255, 0, 255)"}),new On({color:"rgb(230, 184, 175)"}),new On({color:"rgb(244, 204, 204)"}),new On({color:"rgb(252, 229, 205)"}),new On({color:"rgb(255, 242, 204)"}),new On({color:"rgb(217, 234, 211)"}),new On({color:"rgb(208, 224, 227)"}),new On({color:"rgb(201, 218, 248)"}),new On({color:"rgb(207, 226, 243)"}),new On({color:"rgb(217, 210, 233)"}),new On({color:"rgb(234, 209, 220)"}),new On({color:"rgb(221, 126, 107)"}),new On({color:"rgb(234, 153, 153)"}),new On({color:"rgb(249, 203, 156)"}),new On({color:"rgb(255, 229, 153)"}),new On({color:"rgb(182, 215, 168)"}),new On({color:"rgb(162, 196, 201)"}),new On({color:"rgb(164, 194, 244)"}),new On({color:"rgb(159, 197, 232)"}),new On({color:"rgb(180, 167, 214)"}),new On({color:"rgb(213, 166, 189)"}),new On({color:"rgb(204, 65, 37)"}),new On({color:"rgb(224, 102, 102)"}),new On({color:"rgb(246, 178, 107)"}),new On({color:"rgb(255, 217, 102)"}),new On({color:"rgb(147, 196, 125)"}),new On({color:"rgb(118, 165, 175)"}),new On({color:"rgb(109, 158, 235)"}),new On({color:"rgb(111, 168, 220)"}),new On({color:"rgb(142, 124, 195)"}),new On({color:"rgb(194, 123, 160)"}),new On({color:"rgb(166, 28, 0)"}),new On({color:"rgb(204, 0, 0)"}),new On({color:"rgb(230, 145, 56)"}),new On({color:"rgb(241, 194, 50)"}),new On({color:"rgb(106, 168, 79)"}),new On({color:"rgb(69, 129, 142)"}),new On({color:"rgb(60, 120, 216)"}),new On({color:"rgb(61, 133, 198)"}),new On({color:"rgb(103, 78, 167)"}),new On({color:"rgb(166, 77, 121)"}),new On({color:"rgb(133, 32, 12)"}),new On({color:"rgb(153, 0, 0)"}),new On({color:"rgb(180, 95, 6)"}),new On({color:"rgb(191, 144, 0)"}),new On({color:"rgb(56, 118, 29)"}),new On({color:"rgb(19, 79, 92)"}),new On({color:"rgb(17, 85, 204)"}),new On({color:"rgb(11, 83, 148)"}),new On({color:"rgb(53, 28, 117)"}),new On({color:"rgb(116, 27, 71)"}),new On({color:"rgb(91, 15, 0)"}),new On({color:"rgb(102, 0, 0)"}),new On({color:"rgb(120, 63, 4)"}),new On({color:"rgb(127, 96, 0)"}),new On({color:"rgb(39, 78, 19)"}),new On({color:"rgb(12, 52, 61)"}),new On({color:"rgb(28, 69, 135)"}),new On({color:"rgb(7, 55, 99)"}),new On({color:"rgb(32, 18, 77)"}),new On({color:"rgb(76, 17, 48)"})],selectCb:function(){}},t),r.colors=r.options.colors,r.activeColor=null,r.colors.forEach((function(t){r.children(t),t.on(n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){r.options.selectCb(t),t.options.color&&r.setActiveByColor(t.options.color)}))})),r.colors.length>0&&r.setActiveByColor(r.colors[0].options.color),r}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kn(t,e)}(e,t),r=e,(i=[{key:"add",value:function(t){var e=this;t.on(n.SYSTEM_EVENT_TYPE.CLICK,(function(){e.options.selectCb(t),t.options.color&&e.setActiveByColor(t.options.color)})),this.colors.push(t),this.children(t)}},{key:"setActiveByColor",value:function(t){var e=this;this.colors.forEach((function(r){var n=r.options;n.color===t?(r.setActive(!0),e.activeColor=n.color):r.setActive(!1)}))}}])&&En(r.prototype,i),c&&En(r,c),e}(V);function Cn(t){return(Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function An(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Pn(t,e){return!e||"object"!==Cn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jn(t){return(jn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ln(t,e){return(Ln=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rn=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Pn(this,jn(e).call(this,"".concat(o,"-font-color-context-menu"),x.mergeDeep({onUpdate:function(){}},r)))).colorPicker=new bn({selectCb:function(e){var r=new On({color:e});t.customizeColorArray.add(r),t.customizeColorArray.setActiveByColor(e),t.colorArray.setActiveByColor(null),t.options.onUpdate(e),t.close()}}),t.reset=new Jr("重置",new et("clear-color")),t.reset.on(n.SYSTEM_EVENT_TYPE.CLICK,(function(){t.options.onUpdate("rgb(0,0,0)"),t.customizeColorArray.setActiveByColor(null),t.colorArray.setActiveByColor(null)})),t.array=new Jr,t.array.removeClass("hover"),t.colorArray=new Tn({selectCb:function(e){var r=e.options.color;r&&t.options.onUpdate(r),t.customizeColorArray.setActiveByColor(null),t.close()}}),t.array.children(t.colorArray),t.title=C("div","".concat(o,"-font-color-context-menu-color-title")),t.title.text("自定义"),t.plus=new et("plus"),t.customizeColorArray=new Tn({colors:[new On({icon:t.plus})],selectCb:function(e){var r=e.options.color;r?(t.options.onUpdate(r),t.colorArray.setActiveByColor(null),t.close()):t.colorPicker.open(t.customizeColorArray.activeColor)}}),t.customize=new Jr,t.customize.removeClass("hover"),t.customize.children(t.title),t.customize.children(t.customizeColorArray),t.addItem(t.reset),t.addItem(t.array),t.addItem(new Me),t.addItem(t.customize),t}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ln(t,e)}(e,t),r=e,(i=[{key:"setActiveByColor",value:function(t){this.customizeColorArray.setActiveByColor(t),this.colorArray.setActiveByColor(t)}}])&&An(r.prototype,i),c&&An(r,c),e}(we);function Vn(t){return(Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Mn(t){return(Mn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Hn(t,e){return(Hn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Dn=function(t){function e(t){var r,n,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(r=!(i=Mn(e).call(this,"".concat(o,"-tools-font-color")))||"object"!==Vn(i)&&"function"!=typeof i?Wn(n):i).options=x.mergeDeep({contextMenu:{}},t),r.icon=new et("color"),r.fontColorContextMenu=new Rn(x.copyProp({el:Wn(r),position:ue.BOTTOM},r.options.contextMenu)),r.setIcon(r.icon),r.setColor("rgb(0,0,0)"),r.fontColorContextMenu.setActiveByColor("rgb(0,0,0)"),r}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hn(t,e)}(e,t),r=e,(n=[{key:"setColor",value:function(t){this.icon.css("border-bottom","3px solid ".concat(t))}}])&&Nn(r.prototype,n),i&&Nn(r,i),e}(Rt);function Bn(t){return(Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function In(t,e){return!e||"object"!==Bn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yn(t){return(Yn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fn(t,e){return(Fn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Un=function(t){function e(t,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=In(this,Yn(e).call(this,"".concat(o,"-fill-color-context-menu-item")))).title=t,n.icon=r,r&&(n.iconElement=C("div","".concat(o,"-fill-color-context-menu-item-icon")),n.iconElement.children(n.icon),n.children(n.iconElement)),t&&(n.titleElement=C("div","".concat(o,"-fill-color-context-menu-item-title")),n.titleElement.text(t),n.children(n.titleElement)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fn(t,e)}(e,t),e}(xe);function zn(t){return(zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Xn(t,e){return!e||"object"!==zn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Kn(t){return(Kn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qn(t,e){return(qn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $n=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Xn(this,Kn(e).call(this,"".concat(o,"-font-color-context-menu"),x.mergeDeep({onUpdate:function(){}},r)))).colorPicker=new bn({selectCb:function(e){var r=new On({color:e});t.customizeColorArray.add(r),t.customizeColorArray.setActiveByColor(e),t.colorArray.setActiveByColor(null),t.options.onUpdate(e),t.close()}}),t.reset=new Un("重置",new et("clear-color")),t.reset.on(n.SYSTEM_EVENT_TYPE.CLICK,(function(){t.options.onUpdate(null),t.customizeColorArray.setActiveByColor(null),t.colorArray.setActiveByColor(null)})),t.array=new Un,t.array.removeClass("hover"),t.colorArray=new Tn({selectCb:function(e){var r=e.options.color;r&&t.options.onUpdate(r),t.customizeColorArray.setActiveByColor(null),t.close()}}),t.array.children(t.colorArray),t.title=C("div","".concat(o,"-font-color-context-menu-color-title")),t.title.text("自定义"),t.plus=new et("plus"),t.customizeColorArray=new Tn({colors:[new On({icon:t.plus})],selectCb:function(e){var r=e.options.color;r?(t.options.onUpdate(r),t.colorArray.setActiveByColor(null),t.close()):t.colorPicker.open(t.customizeColorArray.activeColor)}}),t.customize=new Un,t.customize.removeClass("hover"),t.customize.children(t.title),t.customize.children(t.customizeColorArray),t.addItem(t.reset),t.addItem(t.array),t.addItem(new Me),t.addItem(t.customize),t}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qn(t,e)}(e,t),r=e,(i=[{key:"setActiveByColor",value:function(t){this.customizeColorArray.setActiveByColor(t),this.colorArray.setActiveByColor(t)}}])&&Gn(r.prototype,i),c&&Gn(r,c),e}(we);function Zn(t){return(Zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Qn(t){return(Qn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function to(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function eo(t,e){return(eo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ro=function(t){function e(t){var r,n,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(r=!(i=Qn(e).call(this,"".concat(o,"-tools-fill-color")))||"object"!==Zn(i)&&"function"!=typeof i?to(n):i).options=x.mergeDeep({contextMenu:{}},t),r.icon=new et("fill-color"),r.fillColorContextMenu=new $n(x.copyProp({el:to(r),position:ue.BOTTOM},r.options.contextMenu)),r.setIcon(r.icon),r.setColor("rgb(255, 255, 255)"),r.fillColorContextMenu.setActiveByColor("rgb(255, 255, 255)"),r}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&eo(t,e)}(e,t),r=e,(n=[{key:"setColor",value:function(t){this.icon.css("border-bottom","3px solid ".concat(t))}}])&&Jn(r.prototype,n),i&&Jn(r,i),e}(Rt);function no(t){return(no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oo(t,e){return!e||"object"!==no(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function io(t){return(io=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function co(t,e){return(co=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var lo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),oo(this,io(e).call(this,"".concat(o,"-border-type-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&co(t,e)}(e,t),e}(xe);function so(t){return(so="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ao(t,e){return!e||"object"!==so(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function uo(t){return(uo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fo(t,e){return(fo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ho=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ao(this,uo(e).call(this,"".concat(o,"-tools-border1")))).icon=new et("border1"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fo(t,e)}(e,t),e}(ct);function po(t){return(po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yo(t,e){return!e||"object"!==po(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bo(t){return(bo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vo(t,e){return(vo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var go=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=yo(this,bo(e).call(this,"".concat(o,"-tools-border2")))).icon=new et("border2"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vo(t,e)}(e,t),e}(ct);function wo(t){return(wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mo(t,e){return!e||"object"!==wo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Oo(t){return(Oo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function So(t,e){return(So=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Eo=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=mo(this,Oo(e).call(this,"".concat(o,"-tools-border3")))).icon=new et("border3"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&So(t,e)}(e,t),e}(ct);function xo(t){return(xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _o(t,e){return!e||"object"!==xo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ko(t){return(ko=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function To(t,e){return(To=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Co=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=_o(this,ko(e).call(this,"".concat(o,"-tools-border4")))).icon=new et("border4"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&To(t,e)}(e,t),e}(ct);function Ao(t){return(Ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Po(t,e){return!e||"object"!==Ao(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jo(t){return(jo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Lo(t,e){return(Lo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ro=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Po(this,jo(e).call(this,"".concat(o,"-tools-border5")))).icon=new et("border5"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lo(t,e)}(e,t),e}(ct);function Vo(t){return(Vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function No(t,e){return!e||"object"!==Vo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mo(t){return(Mo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wo(t,e){return(Wo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ho=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=No(this,Mo(e).call(this,"".concat(o,"-tools-border6")))).icon=new et("border6"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wo(t,e)}(e,t),e}(ct);function Do(t){return(Do="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bo(t,e){return!e||"object"!==Do(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Io(t){return(Io=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yo(t,e){return(Yo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fo=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Bo(this,Io(e).call(this,"".concat(o,"-tools-border7")))).icon=new et("border7"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yo(t,e)}(e,t),e}(ct);function Uo(t){return(Uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zo(t,e){return!e||"object"!==Uo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Go(t){return(Go=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xo(t,e){return(Xo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ko=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=zo(this,Go(e).call(this,"".concat(o,"-tools-border8")))).icon=new et("border8"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xo(t,e)}(e,t),e}(ct);function qo(t){return(qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $o(t,e){return!e||"object"!==qo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zo(t){return(Zo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jo(t,e){return(Jo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qo=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=$o(this,Zo(e).call(this,"".concat(o,"-tools-border9")))).icon=new et("border9"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jo(t,e)}(e,t),e}(ct);function ti(t){return(ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ei(t,e){return!e||"object"!==ti(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ri(t){return(ri=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ni(t,e){return(ni=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var oi=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ei(this,ri(e).call(this,"".concat(o,"-tools-border10")))).icon=new et("border10"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ni(t,e)}(e,t),e}(ct);function ii(t){return(ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ci(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function li(t,e){return!e||"object"!==ii(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function si(t){return(si=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ai(t,e){return(ai=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ui=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=li(this,si(e).call(this,"".concat(o,"-tools-border-color")))).icon=new et("border-color"),t.setIcon(t.icon),t.setColor("#000000"),t}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ai(t,e)}(e,t),r=e,(n=[{key:"setColor",value:function(t){this.icon.css("border-bottom","3px solid ".concat(t))}}])&&ci(r.prototype,n),i&&ci(r,i),e}(Rt);function fi(t){return(fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hi(t,e){return!e||"object"!==fi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pi(t){return(pi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yi(t,e){return(yi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bi=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=hi(this,pi(e).call(this,"".concat(o,"-tools-border-type")))).icon=new et("border-type"),t.setIcon(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yi(t,e)}(e,t),e}(Rt);function di(t){return(di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vi(t,e){return!e||"object"!==di(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gi(t){return(gi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wi(t,e){return(wi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mi=function(t){function e(t,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=vi(this,gi(e).call(this,"".concat(o,"-border-color-context-menu-item")))).title=t,n.icon=r,r&&(n.iconElement=C("div","".concat(o,"-border-color-context-menu-item-icon")),n.iconElement.children(n.icon),n.children(n.iconElement)),t&&(n.titleElement=C("div","".concat(o,"-border-color-context-menu-item-title")),n.titleElement.text(t),n.children(n.titleElement)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wi(t,e)}(e,t),e}(xe);function Oi(t){return(Oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Si(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ei(t,e){return!e||"object"!==Oi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xi(t){return(xi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _i(t,e){return(_i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ki=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ei(this,xi(e).call(this,"".concat(o,"-border-color-context-menu"),x.mergeDeep({onUpdate:function(){}},r)))).colorPicker=new bn({selectCb:function(e){var r=new On({color:e});t.customizeColorArray.add(r),t.customizeColorArray.setActiveByColor(e),t.colorArray.setActiveByColor(null),t.options.onUpdate(e),t.close()}}),t.reset=new mi("重置",new et("clear-color")),t.reset.on(n.SYSTEM_EVENT_TYPE.CLICK,(function(){t.options.onUpdate("rgb(0,0,0)"),t.customizeColorArray.setActiveByColor(null),t.colorArray.setActiveByColor(null)})),t.array=new mi,t.array.removeClass("hover"),t.colorArray=new Tn({selectCb:function(e){var r=e.options.color;r&&t.options.onUpdate(r),t.customizeColorArray.setActiveByColor(null),t.close()}}),t.array.children(t.colorArray),t.title=C("div","".concat(o,"-border-color-context-menu-color-title")),t.title.text("自定义"),t.plus=new et("plus"),t.customizeColorArray=new Tn({colors:[new On({icon:t.plus})],selectCb:function(e){var r=e.options.color;r?(t.options.onUpdate(r),t.colorArray.setActiveByColor(null),t.close()):t.colorPicker.open(t.customizeColorArray.activeColor)}}),t.customize=new mi,t.customize.removeClass("hover"),t.customize.children(t.title),t.customize.children(t.customizeColorArray),t.addItem(t.reset),t.addItem(t.array),t.addItem(new Me),t.addItem(t.customize),t}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_i(t,e)}(e,t),r=e,(i=[{key:"setActiveByColor",value:function(t){this.customizeColorArray.setActiveByColor(t),this.colorArray.setActiveByColor(t)}}])&&Si(r.prototype,i),c&&Si(r,c),e}(we);function Ti(t){return(Ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ci(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ai(t){return(Ai=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ji(t,e){return(ji=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Li=[],Ri=function(t){function e(t){var r,n,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(r=!(i=Ai(e).call(this,"".concat(o,"-font-context-menu-item")))||"object"!==Ti(i)&&"function"!=typeof i?Pi(n):i).type=t,r.icon=new et("checked"),r.typeIcon=new et(t),r.typeIcon.setWidth(50),r.iconElement=C("div","".concat(o,"-font-context-menu-item-icon")),r.titleElement=C("div","".concat(o,"-font-context-menu-item-title")),r.iconElement.children(r.icon),r.titleElement.children(r.typeIcon),r.children(r.iconElement),r.children(r.titleElement),Li.push(Pi(r)),r}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ji(t,e)}(e,t),r=e,(n=[{key:"setTitle",value:function(t){this.title=t,this.titleElement.text(t)}},{key:"setActive",value:function(){Li.forEach((function(t){t.removeClass("active")})),this.addClass("active")}}])&&Ci(r.prototype,n),i&&Ci(r,i),e}(xe);function Vi(t){return(Vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ni(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Mi(t,e){return!e||"object"!==Vi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wi(t){return(Wi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hi(t,e){return(Hi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Di=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Mi(this,Wi(e).call(this,"".concat(o,"-line-type-context-menu"),x.mergeDeep({onUpdate:function(){}},r)))).items=[new Ri("line1"),new Ri("line2"),new Ri("line3"),new Ri("line4"),new Ri("line5"),new Ri("line6")],t.items.forEach((function(e){e.on(n.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.type),e.setActive()})),t.addItem(e)})),t.setActiveByType(t.items[0].type),t}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hi(t,e)}(e,t),r=e,(i=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}},{key:"setActiveByType",value:function(t){this.items.forEach((function(e){e.type===t&&e.setActive()}))}}])&&Ni(r.prototype,i),c&&Ni(r,c),e}(we);function Bi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ii(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Yi(t,e,r){return e&&Ii(t.prototype,e),r&&Ii(t,r),t}var Fi={SOLID_LINE:0,DOTTED_LINE:1,POINT_LINE:2,DOUBLE_LINE:3},Ui=function(){function t(e,r){Bi(this,t),this.draw=e,x.mergeDeep(this,{color:"#000000",width:1},r)}return Yi(t,[{key:"drawLine",value:function(t,e,r,n){var o=this.draw,i=this.width,c=this.color;o.attr({lineWidth:i,strokeStyle:c}),o.setLineDash([]),o.line([t,e],[r,n])}},{key:"setColor",value:function(t){this.color=t}},{key:"setWidth",value:function(t){this.width=t}}]),t}(),zi=function(){function t(e,r){Bi(this,t),this.draw=e,x.mergeDeep(this,{color:"#000000",width:1,dash:[5]},r)}return Yi(t,[{key:"drawLine",value:function(t,e,r,n){var o=this.draw,i=this.dash,c=this.width,l=this.color;o.attr({lineWidth:c,strokeStyle:l}),o.setLineDash(i),o.line([t,e],[r,n])}},{key:"setColor",value:function(t){this.color=t}},{key:"setWidth",value:function(t){this.width=t}}]),t}(),Gi=function(){function t(e,r){Bi(this,t),this.draw=e,x.mergeDeep(this,{color:"#000000",width:1,padding:1,spacing:2,leftShow:function(){return!1},topShow:function(){return!1},rightShow:function(){return!1},bottomShow:function(){return!1},iFMerge:function(){return!1},iFMergeFirstRow:function(){return!1},iFMergeLastRow:function(){return!1},iFMergeFirstCol:function(){return!1},iFMergeLastCol:function(){return!1}},r)}return Yi(t,[{key:"handleExternal",value:function(t,e,r,n,o,i,c){var l={},s=this.leftShow,a=this.topShow,u=this.rightShow,f=this.bottomShow,h=this.iFMerge,p=this.iFMergeFirstRow,y=this.iFMergeLastRow,b=this.iFMergeFirstCol,d=this.iFMergeLastCol,v=this.spacing,g=null,w=null,m=null,O=null,S=null;switch(c){case"left":(g=h(o,i-1))&&(w=p(o,i-1),m=y(o,i-1),O=b(o,i-1),S=d(o,i-1));break;case"top":(g=h(o-1,i))&&(w=p(o-1,i),m=y(o-1,i),O=b(o-1,i),S=d(o-1,i));break;case"right":(g=h(o,i+1))&&(w=p(o,i+1),m=y(o,i+1),O=b(o,i+1),S=d(o,i+1));break;case"bottom":(g=h(o+1,i))&&(w=p(o+1,i),m=y(o+1,i),O=b(o+1,i),S=d(o+1,i))}if(g){switch(c){case"left":l.sx=t-v,l.ex=r-v;var E=f(o-1,i-1)||a(o,i-1),x=a(o,i),_=f(o-1,i);l.sy=e,(x||_)&&(l.sy=e-v),E&&w&&(l.sy=e+v);var k=a(o+1,i-1)||f(o,i-1),T=f(o,i),C=a(o+1,i);l.ey=n,(T||C)&&(l.ey=n+v),k&&m&&(l.ey=n-v);break;case"top":l.sy=e-v,l.ey=n-v;var A=u(o-1,i-1)||s(o-1,i),P=s(o,i),j=u(o,i-1);l.sx=t,(P||j)&&(l.sx=t-v),A&&O&&(l.sx=t+v);var L=s(o-1,i+1)||u(o-1,i),R=u(o,i),V=s(o,i+1);l.ex=r,(R||V)&&(l.ex=r+v),L&&S&&(l.ex=r-v);break;case"right":l.sx=t+v,l.ex=r+v;var N=f(o-1,i+1)||a(o,i+1),M=a(o,i),W=f(o-1,i);l.sy=e,(M||W)&&(l.sy=e-v),N&&w&&(l.sy=e+v);var H=a(o+1,i+1)||f(o,i+1),D=f(o,i),B=a(o+1,i);l.ey=n,(D||B)&&(l.ey=n+v),H&&m&&(l.ey=n-v);break;case"bottom":l.sy=e+v,l.ey=n+v;var I=u(o+1,i-1)||s(o+1,i),Y=s(o,i),F=u(o,i-1);l.sx=t,(Y||F)&&(l.sx=t-v),I&&O&&(l.sx=t+v);var U=s(o+1,i+1)||u(o+1,i),z=u(o,i),G=s(o,i+1);l.ex=r,(z||G)&&(l.ex=r+v),U&&S&&(l.ex=r-v)}return l}switch(c){case"left":l.sx=t-v,l.ex=r-v;var X=f(o-1,i-1)||a(o,i-1),K=a(o,i),q=f(o-1,i);l.sy=e,(K||q)&&(l.sy=e-v),X&&(l.sy=e+v);var $=a(o+1,i-1)||f(o,i-1),Z=f(o,i),J=a(o+1,i);l.ey=n,(Z||J)&&(l.ey=n+v),$&&(l.ey=n-v);break;case"top":l.sy=e-v,l.ey=n-v;var Q=u(o-1,i-1)||s(o-1,i),tt=s(o,i),et=u(o,i-1);l.sx=t,(tt||et)&&(l.sx=t-v),Q&&(l.sx=t+v);var rt=s(o-1,i+1)||u(o-1,i),nt=u(o,i),ot=s(o,i+1);l.ex=r,(nt||ot)&&(l.ex=r+v),rt&&(l.ex=r-v);break;case"right":l.sx=t+v,l.ex=r+v;var it=f(o-1,i+1)||a(o,i+1),ct=a(o,i),lt=f(o-1,i);l.sy=e,(ct||lt)&&(l.sy=e-v),it&&(l.sy=e+v);var st=a(o+1,i+1)||f(o,i+1),at=f(o,i),ut=a(o+1,i);l.ey=n,(at||ut)&&(l.ey=n+v),st&&(l.ey=n-v);break;case"bottom":l.sy=e+v,l.ey=n+v;var ft=u(o+1,i-1)||s(o+1,i),ht=s(o,i),pt=u(o,i-1);l.sx=t,(ht||pt)&&(l.sx=t-v),ft&&(l.sx=t+v);var yt=s(o+1,i+1)||u(o+1,i),bt=u(o,i),dt=s(o,i+1);l.ex=r,(bt||dt)&&(l.ex=r+v),yt&&(l.ex=r-v)}return l}},{key:"handleInternal",value:function(t,e,r,n,o,i,c){var l={},s=this.leftShow,a=this.topShow,u=this.rightShow,f=this.bottomShow,h=this.iFMerge,p=this.iFMergeFirstRow,y=this.iFMergeLastRow,b=this.iFMergeFirstCol,d=this.iFMergeLastCol,v=this.spacing;if(h(o,i)){var g=p(o,i),w=y(o,i),m=b(o,i),O=d(o,i);switch(c){case"left":l.sx=t+v,l.ex=r+v;var S=f(o-1,i-1)||a(o,i-1),E=a(o,i),x=f(o-1,i);l.sy=e,S&&(l.sy=e-v),(E||x)&&g&&(l.sy=e+v);var _=a(o+1,i-1)||f(o,i-1),k=f(o,i),T=a(o+1,i);l.ey=n,_&&(l.ey=n+v),(k||T)&&w&&(l.ey=n-v);break;case"top":l.sy=e+v,l.ey=n+v;var C=u(o-1,i-1)||s(o-1,i),A=s(o,i),P=u(o,i-1);l.sx=t,C&&(l.sx=t-v),(A||P)&&m&&(l.sx=t+v);var j=s(o-1,i+1)||u(o-1,i),L=u(o,i),R=s(o,i+1);l.ex=r,j&&(l.ex=r+v),(L||R)&&O&&(l.ex=r-v);break;case"right":l.sx=t-v,l.ex=r-v;var V=f(o-1,i+1)||a(o,i+1),N=a(o,i),M=f(o-1,i);l.sy=e,V&&(l.sy=e-v),(N||M)&&g&&(l.sy=e+v);var W=a(o+1,i+1)||f(o,i+1),H=f(o,i),D=a(o+1,i);l.ey=n,W&&(l.ey=n+v),(H||D)&&w&&(l.ey=n-v);break;case"bottom":l.sy=e-v,l.ey=n-v;var B=u(o+1,i-1)||s(o+1,i),I=s(o,i),Y=u(o,i-1);l.sx=t,B&&(l.sx=t-v),(I||Y)&&m&&(l.sx=t+v);var F=s(o+1,i+1)||u(o+1,i),U=u(o,i),z=s(o,i+1);l.ex=r,F&&(l.ex=r+v),(U||z)&&O&&(l.ex=r-v)}return l}switch(c){case"left":l.sx=t+v,l.ex=r+v;var G=f(o-1,i-1)||a(o,i-1),X=a(o,i),K=f(o-1,i);l.sy=e,G&&(l.sy=e-v),(X||K)&&(l.sy=e+v);var q=a(o+1,i-1)||f(o,i-1),$=f(o,i),Z=a(o+1,i);l.ey=n,q&&(l.ey=n+v),($||Z)&&(l.ey=n-v);break;case"top":l.sy=e+v,l.ey=n+v;var J=u(o-1,i-1)||s(o-1,i),Q=s(o,i),tt=u(o,i-1);l.sx=t,J&&(l.sx=t-v),(Q||tt)&&(l.sx=t+v);var et=s(o-1,i+1)||u(o-1,i),rt=u(o,i),nt=s(o,i+1);l.ex=r,et&&(l.ex=r+v),(rt||nt)&&(l.ex=r-v);break;case"right":l.sx=t-v,l.ex=r-v;var ot=f(o-1,i+1)||a(o,i+1),it=a(o,i),ct=f(o-1,i);l.sy=e,ot&&(l.sy=e-v),(it||ct)&&(l.sy=e+v);var lt=a(o+1,i+1)||f(o,i+1),st=f(o,i),at=a(o+1,i);l.ey=n,lt&&(l.ey=n+v),(st||at)&&(l.ey=n-v);break;case"bottom":l.sy=e-v,l.ey=n-v;var ut=u(o+1,i-1)||s(o+1,i),ft=s(o,i),ht=u(o,i-1);l.sx=t,ut&&(l.sx=t-v),(ft||ht)&&(l.sx=t+v);var pt=s(o+1,i+1)||u(o+1,i),yt=u(o,i),bt=s(o,i+1);l.ex=r,pt&&(l.ex=r+v),(yt||bt)&&(l.ex=r-v)}return l}},{key:"drawLine",value:function(t,e,r,n,o,i,c){var l=this.draw,s=this.width,a=this.color;l.attr({lineWidth:s,strokeStyle:a}),l.setLineDash([]);var u=this.handleExternal(t,e,r,n,o,i,c),f=this.handleInternal(t,e,r,n,o,i,c);x.isEmptyObject(f)||l.line([f.sx,f.sy],[f.ex,f.ey]),x.isEmptyObject(u)||l.line([u.sx,u.sy],[u.ex,u.ey])}},{key:"setColor",value:function(t){this.color=t}},{key:"setWidth",value:function(t){this.width=t}}]),t}(),Xi=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Bi(this,t),this.type=Fi.SOLID_LINE,this.solidLine=new Ui(e,x.mergeDeep({},r)),this.dottedLine=new zi(e,x.mergeDeep({dash:[5]},r)),this.pointLine=new zi(e,x.mergeDeep({dash:[2,2]},r)),this.doubleLine=new Gi(e,x.mergeDeep({},r))}return Yi(t,[{key:"drawLine",value:function(t,e,r,n,o,i,c){var l=this.type,s=this.solidLine,a=this.dottedLine,u=this.pointLine,f=this.doubleLine;switch(l){case Fi.SOLID_LINE:s.drawLine(t,e,r,n);break;case Fi.DOTTED_LINE:a.drawLine(t,e,r,n);break;case Fi.POINT_LINE:u.drawLine(t,e,r,n);break;case Fi.DOUBLE_LINE:f.drawLine(t,e,r,n,o,i,c)}}},{key:"setType",value:function(t){this.type=t}},{key:"setWidth",value:function(t){t&&this.type===Fi.SOLID_LINE&&this.solidLine.setWidth(t)}},{key:"setColor",value:function(t){t&&(this.solidLine.setColor(t),this.dottedLine.setColor(t),this.pointLine.setColor(t),this.doubleLine.setColor(t))}}]),t}();function Ki(t){return(Ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qi(t){return(qi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Zi(t,e){return(Zi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ji=function(t){function e(){var t,r,i,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,i=qi(e).call(this,"".concat(o,"-border-type-context-menu"),x.mergeDeep({onUpdate:function(){}},c)),(t=!i||"object"!==Ki(i)&&"function"!=typeof i?$i(r):i).type=Fi.SOLID_LINE,t.color="#000000",t.borderIcon1=new ho,t.borderIcon2=new go,t.borderIcon3=new Eo,t.borderIcon4=new Co,t.borderIcon5=new Ro;var l=C("div","".concat(o,"-border-type-context-menu-type-icon-line"));l.children(t.borderIcon1),l.children(t.borderIcon2),l.children(t.borderIcon3),l.children(t.borderIcon4),l.children(t.borderIcon5),t.borderIcon6=new Ho,t.borderIcon7=new Fo,t.borderIcon8=new Ko,t.borderIcon9=new Qo,t.borderIcon10=new oi;var s=C("div","".concat(o,"-border-type-context-menu-type-icon-line"));s.children(t.borderIcon6),s.children(t.borderIcon7),s.children(t.borderIcon8),s.children(t.borderIcon9),s.children(t.borderIcon10),t.borderIcons=new lo,t.borderIcons.removeClass("hover"),t.borderIcons.children(l),t.borderIcons.children(s),t.borderColor=new ui,t.borderType=new bi;var a=C("div","".concat(o,"-border-type-context-menu-type-icon-line"));return a.children(t.borderColor),a.children(t.borderType),t.borderColorAndType=new lo,t.borderColorAndType.removeClass("hover"),t.borderColorAndType.children(a),t.addItem(t.borderIcons),t.addItem(new Me),t.addItem(t.borderColorAndType),t.borderColorContextMenu=new ki(x.copyProp({el:t.borderColor,position:ue.BOTTOM},{onUpdate:function(e){t.color=e,t.borderColor.setColor(e)}})),t.lineTypeContextMenu=new Di(x.copyProp({el:t.borderType,position:ue.BOTTOM},{onUpdate:function(e){t.type=e}})),Nt.bind(t.borderColor,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=$i(t).borderColorContextMenu,n=r.elPopUp;pe.closeAll([n,t.elPopUp]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderType,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=$i(t).lineTypeContextMenu,n=r.elPopUp;pe.closeAll([n,t.elPopUp]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon1,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border1",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon2,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border2",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon3,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border3",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon4,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border4",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon5,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border5",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon6,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border6",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon7,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border7",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon8,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border8",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon9,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border9",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon10,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border10",t.color,t.type),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zi(t,e)}(e,t),e}(we);function Qi(t){return(Qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tc(t){return(tc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ec(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rc(t,e){return(rc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nc=function(t){function e(t){var r,n,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(r=!(i=tc(e).call(this,"".concat(o,"-tools-border")))||"object"!==Qi(i)&&"function"!=typeof i?ec(n):i).options=x.copyProp({contextMenu:{}},t),r.icon=new et("border"),r.setIcon(r.icon),r.borderTypeContextMenu=new Ji(x.copyProp({el:ec(r),position:ue.BOTTOM},r.options.contextMenu)),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rc(t,e)}(e,t),e}(Rt);function oc(t){return(oc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ic(t,e){return!e||"object"!==oc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cc(t){return(cc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lc(t,e){return(lc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ic(this,cc(e).call(this,"".concat(o,"-tools-merge")))).icon=new et("merge"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lc(t,e)}(e,t),e}(ct);function ac(t){return(ac="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uc(t,e){return!e||"object"!==ac(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fc(t){return(fc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hc(t,e){return(hc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=uc(this,fc(e).call(this,"".concat(o,"-tools-horizontal1")))).icon=new et("align-left"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hc(t,e)}(e,t),e}(ct);function yc(t){return(yc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bc(t,e){return!e||"object"!==yc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dc(t){return(dc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vc(t,e){return(vc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=bc(this,dc(e).call(this,"".concat(o,"-tools-horizontal2")))).icon=new et("align-center"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vc(t,e)}(e,t),e}(ct);function wc(t){return(wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mc(t,e){return!e||"object"!==wc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Oc(t){return(Oc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sc(t,e){return(Sc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ec=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=mc(this,Oc(e).call(this,"".concat(o,"-tools-horizontal3")))).icon=new et("align-right"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sc(t,e)}(e,t),e}(ct);function xc(t){return(xc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _c(t,e){return!e||"object"!==xc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kc(t){return(kc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tc(t,e){return(Tc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Cc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),_c(this,kc(e).call(this,"".concat(o,"-horizontal-type-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tc(t,e)}(e,t),e}(xe);function Ac(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Pc=function(){function t(e){var r=e.rect,n=e.draw,o=e.offset,i=void 0===o?0:o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rect=r,this.draw=n,this.offset=i}var e,r,n;return e=t,(r=[{key:"open",value:function(){var t=this.rect,e=this.draw,r=this.offset,n=t.x,o=t.y,i=t.width,c=t.height;return e.save(),e.rect(n,o,i+r,c+r),e.clip(),this}},{key:"close",value:function(){return this.draw.restore(),this}}])&&Ac(e.prototype,r),n&&Ac(e,n),t}();function jc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Lc=function(){function t(e){var r=e.x,n=e.y,o=e.width,i=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=r,this.y=n,this.width=o,this.height=i}var e,r,n;return e=t,(r=[{key:"expandSize",value:function(t){return this.width+=t,this.height+=t,this}},{key:"disjoint",value:function(t){return this.x>t.x+t.width||this.y>this.y+t.height||t.x>this.x+this.width||t.y>this.y+this.height}},{key:"clone",value:function(){return new t({x:this.x,y:this.y,width:this.width,height:this.height})}}])&&jc(e.prototype,r),n&&jc(e,n),t}();function Rc(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(n=(c=l.next()).done)&&(r.push(c.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==l.return||l.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Vc(t){return(Vc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nc(t,e){return!e||"object"!==Vc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mc(t){return(Mc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wc(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hc(t,e)}function Hc(t,e){return(Hc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Dc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ic(t,e,r){return e&&Bc(t.prototype,e),r&&Bc(t,r),t}var Yc=function(t){function e(){return Dc(this,e),Nc(this,Mc(e).apply(this,arguments))}return Wc(e,t),Ic(e,[{key:"fillText",value:function(t,r,n){return r+=this.getOffsetX(),n+=this.getOffsetY(),this.ctx.fillText(t,e.upRounding(r),e.upRounding(n)),this}},{key:"rect",value:function(t,r,n,o){return t+=this.getOffsetX(),r+=this.getOffsetY(),this.ctx.rect(e.upRounding(t),e.upRounding(r),e.upRounding(n),e.upRounding(o)),this}},{key:"fillRect",value:function(t,r,n,o){return t+=this.getOffsetX(),r+=this.getOffsetY(),this.ctx.fillRect(e.upRounding(t),e.upRounding(r),e.upRounding(n),e.upRounding(o)),this}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){this.beginPath();var r=arguments.length<=0?void 0:arguments[0],n=Rc(r,2),o=n[0],i=n[1];o+=this.getOffsetX(),i+=this.getOffsetY(),t.moveTo(this.lpx(e.upRounding(o)),this.lpx(e.upRounding(i)));for(var c=1,l=arguments.length;c<l;c+=1){var s=c<0||arguments.length<=c?void 0:arguments[c],a=Rc(s,2),u=a[0],f=a[1];u+=this.getOffsetX(),f+=this.getOffsetY(),t.lineTo(this.lpx(e.upRounding(u)),this.lpx(e.upRounding(f)))}t.stroke()}return this}},{key:"drawImage",value:function(t,r,n,o,i,c,l,s,a){var u=this.ctx;return r+=this.getOffsetX(),n+=this.getOffsetY(),c+=this.getOffsetX(),l+=this.getOffsetY(),u.drawImage(t,e.upRounding(r),e.upRounding(n),e.upRounding(o),e.upRounding(i),e.upRounding(c),e.upRounding(l),e.upRounding(s),e.upRounding(a)),this}}]),e}(function(t){function e(t){var r;return Dc(this,e),(r=Nc(this,Mc(e).call(this,t))).offsetX=0,r.offsetY=0,r}return Wc(e,t),Ic(e,[{key:"offset",value:function(t,e){this.offsetX=t,this.offsetY=e}},{key:"getOffsetX",value:function(){return this.offsetX}},{key:"getOffsetY",value:function(){return this.offsetY}},{key:"fillText",value:function(){throw new TypeError("child impl")}},{key:"rect",value:function(){throw new TypeError("child impl")}},{key:"fillRect",value:function(){throw new TypeError("child impl")}},{key:"line",value:function(){throw new TypeError("child impl")}},{key:"drawImage",value:function(){throw new TypeError("child impl")}}]),e}(function(t){function e(){return Dc(this,e),Nc(this,Mc(e).apply(this,arguments))}return Wc(e,t),Ic(e,[{key:"measureText",value:function(t){return this.ctx.measureText(t)}},{key:"attr",value:function(t){for(var e in t)if(t.hasOwnProperty(e)){var r=t[e];("string"==typeof r||r instanceof String)&&(r=r.trim()),this.ctx[e]!==r&&(this.ctx[e]=r)}return this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"save",value:function(){return this.ctx.save(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"clip",value:function(){return this.ctx.clip(),this}},{key:"fill",value:function(){return this.ctx.fill(),this}},{key:"setLineDash",value:function(t){return this.ctx.setLineDash(t),this}},{key:"rotate",value:function(t){return this.ctx.rotate(e.radian(t)),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"translate",value:function(t,e){return this.ctx.translate(t,e),this}},{key:"fullRect",value:function(){var t=this.canvas,e=t.width,r=t.height;return this.ctx.fillRect(0,0,e,r),this}},{key:"lpx",value:function(t){return t-(this.ctx.lineWidth%2==0?0:.5)}}]),e}(function(){function t(e){Dc(this,t),this.canvas=e,this.ctx=e.getContext("2d")}return Ic(t,null,[{key:"upRounding",value:function(t){return Math.ceil(t)}},{key:"radian",value:function(t){return-t*(Math.PI/180)}},{key:"dpr",value:function(){return window.devicePixelRatio||1}},{key:"rpx",value:function(t){return t*this.dpr()}}]),Ic(t,[{key:"resize",value:function(e,r){var n=this.canvas;return n.width=t.upRounding(t.rpx(e)),n.height=t.upRounding(t.rpx(r)),n.style.width="".concat(n.width/t.dpr(),"px"),n.style.height="".concat(n.height/t.dpr(),"px"),this}}]),t}())));function Fc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Uc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function zc(t,e,r){return e&&Uc(t.prototype,e),r&&Uc(t,r),t}var Gc={TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right",MIDDLE_LEFT:"middle-left",MIDDLE_CENTER:"middle-center",MIDDLE_RIGHT:"middle-right",BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right"},Xc=function(){function t(e){var r=e.angle,n=e.width,o=e.height;Fc(this,t),this.angle=r,this.width=n,this.height=o}return zc(t,[{key:"sinWidthAngle",value:function(){var t=this.angle,e=this.width;return Math.abs(Math.sin(Yc.radian(t))*e)}},{key:"cosWidthAngle",value:function(){var t=this.angle,e=this.width;return Math.abs(Math.cos(Yc.radian(t)*e))}},{key:"sinHeightAngle",value:function(){var t=this.angle,e=this.height;return Math.abs(e/Math.sin(Yc.radian(t)))}},{key:"setWidth",value:function(t){this.width=t}},{key:"setHeight",value:function(t){this.height=t}},{key:"setAngle",value:function(t){this.angle=t}}]),t}(),Kc=function(){function t(e){var r=e.angle,n=e.dw,o=e.origin,i=void 0===o?Gc.MIDDLE_CENTER:o,c=e.rect,l=void 0===c?new Lc({x:0,y:0,width:0,height:0}):c;Fc(this,t),this.dw=n,this.origin=i,this.rect=l,this.angle=r}return zc(t,[{key:"rotate",value:function(){var t=this.origin,e=this.dw,r=this.rect,n=this.angle,o=r.x,i=r.y,c=r.width,l=r.height;e.save();var s=0,a=0;switch(t){case Gc.TOP_LEFT:s=o,a=i;break;case Gc.TOP_CENTER:s=o+c/2,a=i;break;case Gc.TOP_RIGHT:s=o+c,a=i;break;case Gc.MIDDLE_LEFT:s=o,a=i+l/2;break;case Gc.MIDDLE_CENTER:s=o+c/2,a=i+l/2;break;case Gc.MIDDLE_RIGHT:s=o+c,a=i+l/2;break;case Gc.BOTTOM_LEFT:s=o,a=i+l;break;case Gc.BOTTOM_CENTER:s=o+c/2,a=i+l;break;case Gc.BOTTOM_RIGHT:s=o+c,a=i+l}var u=e.getOffsetX(),f=e.getOffsetY();return e.translate(s+u,a+f).rotate(n).translate(-(s+u),-(a+f)),this}},{key:"revert",value:function(){return this.dw.restore(),this}},{key:"setOrigin",value:function(t){return this.origin=t,this}},{key:"setRect",value:function(t){return this.rect=t,this}}],[{key:"triangleHypotenuse",value:function(t,e){var r=Math.cos(Yc.radian(t)),n=Math.sin(Yc.radian(t));return{width:Math.abs(r*e),height:Math.abs(n*e)}}}]),t}();function qc(t){return(qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $c(t,e){return!e||"object"!==qc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zc(t){return(Zc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jc(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qc(t,e)}function Qc(t,e){return(Qc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function tl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function el(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function rl(t,e,r){return e&&el(t.prototype,e),r&&el(t,r),t}var nl={left:"left",center:"center",right:"right"},ol={top:"top",center:"middle",bottom:"bottom"},il={OVER_FLOW:1,WORD_WRAP:2,TRUNCATE:3},cl={HORIZONTAL:"horizontal",VERTICAL:"vertical",ANGLE:"angle"},ll=function(){function t(e){var r=e.text,n=e.rect,o=e.dw,i=e.overflow,c=e.overflowCrop,l=e.attr;tl(this,t),this.text=r,this.dw=o,this.rect=n,this.overflow=i,this.overflowCrop=c,this.attr=l}return rl(t,[{key:"dprMeasureSize",value:function(t){return this.dw.measureText(t).width/Yc.dpr()}},{key:"dprFontSize",value:function(t){return Yc.rpx(t)}},{key:"isBlank",value:function(t){return null==t||""===t.toString().trim()}},{key:"existBreak",value:function(t){return/\n/.test(t)}},{key:"textBreak",value:function(t){return t.split("\n")}}]),t}(),sl=function(t){function e(){return tl(this,e),$c(this,Zc(e).apply(this,arguments))}return Jc(e,t),rl(e,[{key:"drawLine",value:function(t,e,r,n){var o=this.dw,i=this.attr,c=i.size,l=i.verticalAlign,s=i.align,a=[0,0],u=[0,0];if("strike"===t){switch(s){case nl.right:a[0]=e-n,u[0]=e;break;case nl.center:a[0]=e-n/2,u[0]=e+n/2;break;case nl.left:a[0]=e,u[0]=e+n}switch(l){case ol.top:a[1]=r+c/2,u[1]=r+c/2;break;case ol.center:a[1]=r,u[1]=r;break;case ol.bottom:a[1]=r-c/2,u[1]=r-c/2}}if("underline"===t){switch(s){case nl.right:a[0]=e-n,u[0]=e;break;case nl.center:a[0]=e-n/2,u[0]=e+n/2;break;case nl.left:a[0]=e,u[0]=e+n}switch(l){case ol.top:a[1]=r+c,u[1]=r+c;break;case ol.center:a[1]=r+c/2,u[1]=r+c/2;break;case ol.bottom:a[1]=r,u[1]=r}}o.line(a,u)}},{key:"drawTextTruncate",value:function(){var t,e=this.text,r=this.dw,n=this.attr,o=this.rect,i=n.underline,c=n.strikethrough,l=n.align,s=n.verticalAlign,a=n.padding,u=o.width,f=o.height,h=this.dprMeasureSize(e),p=o.x,y=o.y;switch(l){case nl.left:p+=a;break;case nl.center:p+=u/2;break;case nl.right:p+=u-a}switch(s){case ol.top:y+=a;break;case ol.center:y+=f/2;break;case ol.bottom:y+=f-a}switch(l){case nl.right:case nl.left:t=h+2*a;break;case nl.center:default:t=h}var b=new Pc({draw:r,rect:o});return b.open(),r.fillText(e,p,y),i&&this.drawLine("underline",p,y,h),c&&this.drawLine("strike",p,y,h),b.close(),t}},{key:"drawTextOverFlow",value:function(){var t,e=this.text,r=this.dw,n=this.attr,o=this.rect,i=this.overflow,c=this.overflowCrop,l=n.size,s=n.underline,a=n.strikethrough,u=n.align,f=n.verticalAlign,h=n.padding,p=o.width,y=o.height,b=this.dprMeasureSize(e),d=o.x,v=o.y,g=0,w=0;switch(u){case nl.left:d+=h,g=h;break;case nl.center:d+=p/2;break;case nl.right:d+=p-h,g=h}switch(f){case ol.top:v+=h,w=h;break;case ol.center:v+=y/2;break;case ol.bottom:v+=y-h,w=h}switch(u){case nl.right:case nl.left:t=b+2*h;break;case nl.center:default:t=b}if(c||i&&(b+g>i.width||l+w>i.height)){var m=new Pc({draw:r,rect:i});m.open(),r.fillText(e,d,v),s&&this.drawLine("underline",d,v,b),a&&this.drawLine("strike",d,v,b),m.close()}else r.fillText(e,d,v),s&&this.drawLine("underline",d,v,b),a&&this.drawLine("strike",d,v,b);return t}},{key:"drawTextWarp",value:function(){for(var t=this.text,e=this.dw,r=this.attr,n=this.rect,o=r.size,i=r.underline,c=r.strikethrough,l=r.align,s=r.verticalAlign,a=r.padding,u=n.width,f=n.height,h=u-2*a,p=[],y={len:0,start:0},b=t.length,d=0,v=0,g=0;v<b;){var w=this.dprMeasureSize(t.charAt(v)),m=y.len+w;m>h?(0===y.len?(p.push({text:t.substring(v,v+1),len:m,tx:0,ty:d}),v+=1,m>g&&(g=m)):(p.push({text:t.substring(y.start,v),len:y.len,tx:0,ty:d}),y.len>g&&(g=y.len)),d+=o+4,y.len=0,y.start=v):(y.len=m,v+=1)}y.len>0&&(p.push({text:t.substring(y.start),len:y.len,tx:0,ty:d}),y.len>g&&(g=y.len));var O,S=n.x,E=n.y;switch(l){case nl.left:S+=a;break;case nl.center:S+=u/2;break;case nl.right:S+=u-a}switch(s){case ol.top:E+=a;break;case ol.center:E+=f/2-d/2;break;case ol.bottom:E+=f-d-a}switch(l){case nl.right:case nl.left:O=g+2*a;break;case nl.center:default:O=g}var x=new Pc({draw:e,rect:n});x.open();for(var _=0,k=p.length;_<k;_+=1){var T=p[_];T.tx+=S,T.ty+=E,e.fillText(T.text,T.tx,T.ty),i&&this.drawLine("underline",T.tx,T.ty,T.len),c&&this.drawLine("strike",T.tx,T.ty,T.len)}return x.close(),O}},{key:"draw",value:function(){var t=this.text;if(this.isBlank(t))return 0;this.existBreak(t)&&this.setTextWrap(il.OVER_FLOW);var e=this.dw,r=this.attr,n=r.textWrap;switch(e.attr({textAlign:r.align,textBaseline:r.verticalAlign,font:"".concat(r.italic?"italic":""," ").concat(r.bold?"bold":""," ").concat(this.dprFontSize(r.size),"px ").concat(r.name),fillStyle:r.color,strokeStyle:r.color}),n){case il.TRUNCATE:return this.drawTextTruncate();case il.WORD_WRAP:return this.drawTextWarp();case il.OVER_FLOW:default:return this.drawTextOverFlow()}}},{key:"setOverflowCrop",value:function(t){this.overflowCrop=t}},{key:"setSize",value:function(t){this.attr.size=t}},{key:"setTextWrap",value:function(t){this.attr.textWrap=t}},{key:"setPadding",value:function(t){this.attr.padding=t}}]),e}(ll),al=function(t){function e(){return tl(this,e),$c(this,Zc(e).apply(this,arguments))}return Jc(e,t),rl(e,[{key:"drawLine",value:function(t,e,r,n,o,i){var c=this.dw,l=this.attr.size,s=[0,0],a=[0,0];if("strike"===t){switch(o){case nl.right:s[0]=e-n,a[0]=e;break;case nl.center:s[0]=e-n/2,a[0]=e+n/2;break;case nl.left:s[0]=e,a[0]=e+n}switch(i){case ol.top:s[1]=r+l/2,a[1]=r+l/2;break;case ol.center:s[1]=r,a[1]=r;break;case ol.bottom:s[1]=r-l/2,a[1]=r-l/2}}if("underline"===t){switch(o){case nl.right:s[0]=e-n,a[0]=e;break;case nl.center:s[0]=e-n/2,a[0]=e+n/2;break;case nl.left:s[0]=e,a[0]=e+n}switch(i){case ol.top:s[1]=r+l,a[1]=r+l;break;case ol.center:s[1]=r+l/2,a[1]=r+l/2;break;case ol.bottom:s[1]=r,a[1]=r}}c.line(s,a)}},{key:"drawTextTruncate",value:function(){for(var t=this.text,e=this.dw,r=this.attr,n=this.rect,o=r.underline,i=r.strikethrough,c=r.align,l=r.verticalAlign,s=r.size,a=r.padding,u=n.width,f=n.height,h=[],p=0,y=0;y<t.length;y+=1){var b=t.charAt(y);h.push({len:this.dprMeasureSize(b),text:b,tx:0,ty:p}),y<t.length-1?p+=s+2:p+=s}var d,v=n.x,g=n.y;switch(c){case nl.left:v+=a;break;case nl.center:v+=u/2;break;case nl.right:v+=u-a}switch(l){case ol.top:g+=a;break;case ol.center:g+=f/2-p/2+a;break;case ol.bottom:g+=f-p+a}switch(c){case nl.left:case nl.right:d=s+2*a;break;case nl.center:default:d=s}var w=new Pc({draw:e,rect:n});w.open();for(var m=0,O=h.length;m<O;m+=1){var S=h[m];S.tx+=v,S.ty+=g,e.fillText(S.text,S.tx,S.ty),o&&this.drawLine("underline",S.tx,S.ty,S.len,c,l),i&&this.drawLine("strike",S.tx,S.ty,S.len,c,l)}return w.close(),d}},{key:"drawTextOverFlow",value:function(){for(var t=this.text,e=this.dw,r=this.attr,n=this.rect,o=this.overflow,i=this.overflowCrop,c=r.underline,l=r.strikethrough,s=r.align,a=r.verticalAlign,u=r.size,f=r.padding,h=n.width,p=n.height,y=[],b=0,d=0;d<t.length;d+=1){var v=t.charAt(d);y.push({len:this.dprMeasureSize(v),text:v,tx:0,ty:b}),d<t.length-1?b+=u+2:b+=u}var g,w=n.x,m=n.y,O=0,S=0;switch(s){case nl.left:w+=f,O=f;break;case nl.center:w+=h/2;break;case nl.right:w+=h-f,O=f}switch(a){case ol.top:m+=f,S=f;break;case ol.center:m+=p/2-b/2+f;break;case ol.bottom:m+=p-b+f,S=f}switch(s){case nl.left:case nl.right:g=u+2*f;break;case nl.center:default:g=u}if(i||o&&(b+S>o.height||u+O>o.width)){var E=new Pc({draw:e,rect:o});E.open();for(var x=0,_=y.length;x<_;x+=1){var k=y[x];k.tx+=w,k.ty+=m,e.fillText(k.text,k.tx,k.ty),c&&this.drawLine("underline",k.tx,k.ty,k.len,s,a),l&&this.drawLine("strike",k.tx,k.ty,k.len,s,a)}E.close()}else for(var T=0,C=y.length;T<C;T+=1){var A=y[T];A.tx+=w,A.ty+=m,e.fillText(A.text,A.tx,A.ty),c&&this.drawLine("underline",A.tx,A.ty,A.len,s,a),l&&this.drawLine("strike",A.tx,A.ty,A.len,s,a)}return g}},{key:"drawTextWarp",value:function(){for(var t=this.text,e=this.dw,r=this.attr,n=this.rect,o=r.underline,i=r.strikethrough,c=r.align,l=r.verticalAlign,s=r.size,a=r.padding,u=n.width,f=n.height,h=[],p=t.length,y=f-2*a,b=[],d=0,v=0,g=0,w=0,m=0;m<p;){var O=m===p-1,S=0===m,E=t.charAt(m),x=this.dprMeasureSize(E),_=void 0;(_=O?d+s:d+s+2)>y?(b.length>0&&h.push(b),d=0,S||(g+=s+0),w+=1,(b=[]).push({len:x,text:E,tx:g,ty:v=0}),d=O?s:s+2):(b.push({len:x,text:E,tx:g,ty:v}),d=_),v+=O?s:s+2,m+=1}b.length>0&&h.push(b);var k,T=n.x,C=n.y,A=l;switch(c){case nl.left:T+=a;break;case nl.center:T+=u/2-g/2;break;case nl.right:T+=u-g-a}switch(l){case ol.top:e.attr({textBaseline:r.verticalAlign}),C+=a,A=ol.top;break;case ol.center:0===w?(e.attr({textBaseline:r.verticalAlign}),C+=f/2-v/2+a,A=ol.center):(e.attr({textBaseline:ol.top}),C+=a,A=ol.top);break;case ol.bottom:0===w?(e.attr({textBaseline:ol.bottom}),C+=f-v+a,A=ol.bottom):(e.attr({textBaseline:ol.top}),C+=a,A=ol.top)}switch(c){case nl.left:case nl.right:k=g+s+2*a;break;case nl.center:default:k=g+s}var P=new Pc({draw:e,rect:n});P.open();for(var j=0,L=h.length;j<L;j+=1)for(var R=h[j],V=0;V<R.length;V+=1){var N=R[V];N.tx+=T,N.ty+=C,e.fillText(N.text,N.tx,N.ty),o&&this.drawLine("underline",N.tx,N.ty,N.len,c,A),i&&this.drawLine("strike",N.tx,N.ty,N.len,c,A)}return P.close(),k}},{key:"draw",value:function(){var t=this.text;if(this.isBlank(t))return 0;this.existBreak(t)&&this.setTextWrap(il.OVER_FLOW);var e=this.dw,r=this.attr;switch(r.textWrap){case il.TRUNCATE:return e.attr({textAlign:r.align,textBaseline:r.verticalAlign,font:"".concat(r.italic?"italic":""," ").concat(r.bold?"bold":""," ").concat(this.dprFontSize(r.size),"px ").concat(r.name),fillStyle:r.color,strokeStyle:r.color}),this.drawTextTruncate();case il.WORD_WRAP:return e.attr({textAlign:r.align,font:"".concat(r.italic?"italic":""," ").concat(r.bold?"bold":""," ").concat(this.dprFontSize(r.size),"px ").concat(r.name),fillStyle:r.color,strokeStyle:r.color}),this.drawTextWarp();case il.OVER_FLOW:default:return e.attr({textAlign:r.align,textBaseline:r.verticalAlign,font:"".concat(r.italic?"italic":""," ").concat(r.bold?"bold":""," ").concat(this.dprFontSize(r.size),"px ").concat(r.name),fillStyle:r.color,strokeStyle:r.color}),this.drawTextOverFlow()}}},{key:"setOverflowCrop",value:function(t){this.overflowCrop=t}},{key:"setSize",value:function(t){this.attr.size=t}},{key:"setTextWrap",value:function(t){this.attr.textWrap=t}},{key:"setPadding",value:function(t){this.attr.padding=t}}]),e}(ll),ul=function(t){function e(){return tl(this,e),$c(this,Zc(e).apply(this,arguments))}return Jc(e,t),rl(e,[{key:"drawLine",value:function(t,e,r,n){var o=this.dw,i=this.attr.size,c=[0,0],l=[0,0];"strike"===t&&(c[0]=e,l[0]=e+n,c[1]=r+i/2,l[1]=r+i/2),"underline"===t&&(c[0]=e,l[0]=e+n,c[1]=r+i,l[1]=r+i),o.line(c,l)}},{key:"drawTextTruncate",value:function(){var t=this.text,e=this.dw,r=this.attr,n=this.rect,o=r.underline,i=r.strikethrough,c=r.align,l=r.verticalAlign,s=r.size,a=r.padding,u=r.angle,f=n.width,h=n.height;u>90&&(u=90),u<-90&&(u=-90);var p,y=this.dprMeasureSize(t),b=new Xc({angle:u,width:y,height:s}),d=b.cosWidthAngle(),v=b.sinWidthAngle(),g=n.x,w=n.y;switch(c){case nl.left:g+=a;break;case nl.center:g+=f/2-d/2;break;case nl.right:g+=f-d-a}switch(l){case ol.top:w+=a;break;case ol.center:w+=h/2-v/2;break;case ol.bottom:w+=h-v-a}switch(c){case nl.right:case nl.left:p=d+2*a;break;case nl.center:default:p=d}var m,O=g+(d/2-y/2),S=w+(v/2-s/2),E=new Kc({dw:e,angle:u,rect:new Lc({x:g,y:w,width:d,height:v})});return(m=new Pc(0===u?{draw:e,rect:n}:{draw:e,rect:new Lc({x:0,y:n.y,width:p,height:n.height})})).open(),E.rotate(),e.fillText(t,O,S),o&&this.drawLine("underline",O,S,y),i&&this.drawLine("strike",O,S,y),E.revert(),m.close(),p}},{key:"drawTextOverFlow",value:function(){var t=this.text,e=this.dw,r=this.attr,n=this.rect,o=this.overflow,i=r.underline,c=r.strikethrough,l=r.align,s=r.verticalAlign,a=r.size,u=r.overflowCrop,f=r.padding,h=r.angle,p=n.width,y=n.height;h>90&&(h=90),h<-90&&(h=-90);var b,d=this.dprMeasureSize(t),v=new Xc({angle:h,width:d,height:a}),g=v.cosWidthAngle(),w=v.sinWidthAngle(),m=n.x,O=n.y;switch(l){case nl.left:m+=f;break;case nl.center:m+=p/2-g/2;break;case nl.right:m+=p-g-f}switch(s){case ol.top:O+=f;break;case ol.center:O+=y/2-w/2;break;case ol.bottom:O+=y-w-f}switch(l){case nl.right:case nl.left:b=g+2*f;break;case nl.center:default:b=g}var S,E=m+(g/2-d/2),x=O+(w/2-a/2),_=new Kc({dw:e,angle:h,rect:new Lc({x:m,y:O,width:g,height:w})});return S=new Pc(0===h?{draw:e,rect:o}:{draw:e,rect:new Lc({x:0,y:n.y,width:b,height:n.height})}),u||o&&(g>o.width||w>o.height)?(S.open(),_.rotate(),e.fillText(t,E,x),i&&this.drawLine("underline",E,x,d),c&&this.drawLine("strike",E,x,d),_.revert(),S.close()):(_.rotate(),e.fillText(t,E,x),i&&this.drawLine("underline",E,x,d),c&&this.drawLine("strike",E,x,d),_.revert()),b}},{key:"drawTextWarp",value:function(){var t=this.text,e=this.dw,r=this.attr,n=this.rect,o=r.underline,i=r.strikethrough,c=r.align,l=r.verticalAlign,s=r.size,a=r.padding,u=r.angle;u>90&&(u=90),u<-90&&(u=-90);var f=n.width,h=n.height;if(u>0){var p=new Xc({angle:u});p.setHeight(h-2*a);var y=p.sinHeightAngle();p.setHeight(s+4);for(var b=p.sinHeightAngle(),d=[],v={len:0,start:0},g=t.length,w=0;w<g;){var m=this.dprMeasureSize(t.charAt(w)),O=v.len+m;O>y?(0===v.len?(d.push({text:t.substring(w,w+1),len:O,tx:0,ty:0}),w+=1):d.push({text:t.substring(v.start,w),len:v.len,tx:0,ty:0}),v.len=0,v.start=w):(v.len=O,w+=1)}v.len>0&&d.push({text:t.substring(v.start),len:v.len,tx:0,ty:0});for(var S=d.length,E=0,x=0;x<S;x+=1){d[x].tx=E,E+=b}if(S>1){p.setWidth(y);var _,k=Math.max(p.cosWidthAngle(),s),T=p.sinWidthAngle(),C=k+(d.length-1)*b,A=n.x,P=n.y;switch(c){case nl.left:A+=a;break;case nl.center:A+=f/2-C/2;break;case nl.right:A+=f-C-a}switch(l){case ol.top:P+=a;break;case ol.center:P+=h/2-T/2;break;case ol.bottom:P+=h-T-a}switch(c){case nl.right:case nl.left:_=C+2*a;break;case nl.center:default:_=C}for(var j=0;j<d.length;j+=1){var L=d[j],R=L.tx+A,V=L.ty+P,N=0,M=0;switch(c){case nl.left:p.setWidth(L.len/2),N+=R+Math.max(p.cosWidthAngle(),s),M+=V+T-p.sinWidthAngle();break;case nl.center:N=R+k/2,M=V+T/2;break;case nl.right:p.setWidth(L.len/2),N+=R+k-Math.max(p.cosWidthAngle(),s),M+=V+p.sinWidthAngle()}var W=N-L.len/2,H=M-s/2;-1===j&&(e.attr({fillStyle:"#000000"}),e.fillRect(R,V,k,T),e.attr({fillStyle:"red"}));var D=new Kc({dw:e,angle:u,rect:new Lc({x:W,y:H,width:L.len,height:s})});D.rotate(),e.fillText(L.text,W,H),o&&this.drawLine("underline",W,H,L.len),i&&this.drawLine("strike",W,H,L.len),D.revert()}return _}var B=this.dprMeasureSize(t);p.setWidth(B);var I,Y=Math.max(p.cosWidthAngle(),s),F=p.sinWidthAngle(),U=n.x,z=n.y;switch(c){case nl.left:U+=a;break;case nl.center:U+=f/2-Y/2;break;case nl.right:U+=f-Y-a}switch(l){case ol.top:z+=a;break;case ol.center:z+=h/2-F/2;break;case ol.bottom:z+=h-F-a}switch(c){case nl.right:case nl.left:I=Y+2*a;break;case nl.center:default:I=Y}var G=new Kc({dw:e,angle:u,rect:new Lc({x:U,y:z,width:Y,height:F})});G.rotate();var X=U+(Y/2-B/2),K=z+(F/2-s/2);return e.fillText(t,X,K),o&&this.drawLine("underline",X,K,B),i&&this.drawLine("strike",X,K,B),G.revert(),I}if(u<0){var q=new Xc({angle:u});q.setHeight(h-2*a);var $=q.sinHeightAngle();q.setHeight(s+4);for(var Z=q.sinHeightAngle(),J=[],Q={len:0,start:0},tt=t.length,et=0;et<tt;){var rt=this.dprMeasureSize(t.charAt(et)),nt=Q.len+rt;nt>$?(0===Q.len?(J.push({text:t.substring(et,et+1),len:nt,tx:0,ty:0}),et+=1):J.push({text:t.substring(Q.start,et),len:Q.len,tx:0,ty:0}),Q.len=0,Q.start=et):(Q.len=nt,et+=1)}Q.len>0&&J.push({text:t.substring(Q.start),len:Q.len,tx:0,ty:0});for(var ot=J.length,it=0,ct=ot-1;ct>=0;ct-=1){J[ct].tx=it,it+=Z}if(ot>1){q.setWidth($);var lt,st=Math.max(q.cosWidthAngle(),s),at=q.sinWidthAngle(),ut=st+(J.length-1)*Z,ft=n.x,ht=n.y;switch(c){case nl.left:ft+=a;break;case nl.center:ft+=f/2-ut/2;break;case nl.right:ft+=f-ut-a}switch(l){case ol.top:ht+=a;break;case ol.center:ht+=h/2-at/2;break;case ol.bottom:ht+=h-at-a}switch(c){case nl.right:case nl.left:lt=ut+2*a;break;case nl.center:default:lt=ut}for(var pt=0;pt<J.length;pt+=1){var yt=J[pt],bt=yt.tx+ft,dt=yt.ty+ht,vt=0,gt=0;switch(c){case nl.left:q.setWidth(yt.len/2),vt+=bt+Math.max(q.cosWidthAngle(),s),gt+=dt+q.sinWidthAngle();break;case nl.center:vt=bt+st/2,gt=dt+at/2;break;case nl.right:q.setWidth(yt.len/2),vt+=bt+st-Math.max(q.cosWidthAngle(),s),gt+=dt+at-q.sinWidthAngle()}var wt=vt-yt.len/2,mt=gt-s/2;-1===pt&&(e.attr({fillStyle:"#000000"}),e.fillRect(bt,dt,st,at),e.attr({fillStyle:"red"}));var Ot=new Kc({dw:e,angle:u,rect:new Lc({x:wt,y:mt,width:yt.len,height:s})});Ot.rotate(),e.fillText(yt.text,wt,mt),o&&this.drawLine("underline",wt,mt,yt.len),i&&this.drawLine("strike",wt,mt,yt.len),Ot.revert()}return lt}var St=this.dprMeasureSize(t);q.setWidth(St);var Et,xt=Math.max(q.cosWidthAngle(),s),_t=q.sinWidthAngle(),kt=n.x,Tt=n.y;switch(c){case nl.left:kt+=a;break;case nl.center:kt+=f/2-xt/2;break;case nl.right:kt+=f-xt-a}switch(l){case ol.top:Tt+=a;break;case ol.center:Tt+=h/2-_t/2;break;case ol.bottom:Tt+=h-_t-a}switch(c){case nl.right:case nl.left:Et=xt+2*a;break;case nl.center:default:Et=xt}var Ct=new Kc({dw:e,angle:u,rect:new Lc({x:kt,y:Tt,width:xt,height:_t})});Ct.rotate();var At=kt+(xt/2-St/2),Pt=Tt+(_t/2-s/2);return e.fillText(t,At,Pt),o&&this.drawLine("underline",At,Pt,St),i&&this.drawLine("strike",At,Pt,St),Ct.revert(),Et}if(0===u){for(var jt=f-2*a,Lt=[],Rt={len:0,start:0},Vt=t.length,Nt=0,Mt=0;Nt<Vt;){var Wt=this.dprMeasureSize(t.charAt(Nt)),Ht=Rt.len+Wt;Ht>jt?(0===Rt.len?(Lt.push({text:t.substring(Nt,Nt+1),len:Ht,tx:0,ty:0}),Nt+=1,Ht>Mt&&(Mt=Ht)):(Lt.push({text:t.substring(Rt.start,Nt),len:Rt.len,tx:0,ty:0}),Rt.len>Mt&&(Mt=Rt.len)),Rt.len=0,Rt.start=Nt):(Rt.len=Ht,Nt+=1)}Rt.len>0&&(Lt.push({text:t.substring(Rt.start),len:Rt.len,tx:0,ty:0}),Rt.len>Mt&&(Mt=Rt.len));for(var Dt=Lt.length,Bt=0,It=0;It<Dt;It+=1){Lt[It].ty=Bt,Bt+=s+4}var Yt,Ft=Dt*(s+4);switch(c){case nl.right:case nl.left:Yt=Mt+2*a;break;case nl.center:default:Yt=Mt}var Ut=new Pc({draw:e,rect:n});Ut.open();for(var zt=0;zt<Dt;zt+=1){var Gt=Lt[zt],Xt=n.x,Kt=n.y;switch(c){case nl.left:Xt+=a;break;case nl.center:Xt+=f/2-Gt.len/2;break;case nl.right:Xt+=f-Gt.len-a}switch(l){case ol.top:Kt+=Gt.ty+a;break;case ol.center:Kt+=Gt.ty+(h/2-Ft/2);break;case ol.bottom:Kt+=Gt.ty+(h-Ft-a)}e.fillText(Gt.text,Xt,Kt),o&&this.drawLine("underline",Xt,Kt,Gt.len),i&&this.drawLine("strike",Xt,Kt,Gt.len)}return Ut.close(),Yt}return 0}},{key:"draw",value:function(){var t=this.text;if(this.isBlank(t))return 0;this.existBreak(t)&&this.setTextWrap(il.OVER_FLOW);var e=this.dw,r=this.attr,n=r.textWrap;switch(e.attr({textAlign:nl.left,textBaseline:ol.top,font:"".concat(r.italic?"italic":""," ").concat(r.bold?"bold":""," ").concat(this.dprFontSize(r.size),"px ").concat(r.name),fillStyle:r.color,strokeStyle:r.color}),n){case il.TRUNCATE:return this.drawTextTruncate();case il.WORD_WRAP:return this.drawTextWarp();case il.OVER_FLOW:default:return this.drawTextOverFlow()}}},{key:"setOverflowCrop",value:function(t){this.overflowCrop=t}},{key:"setSize",value:function(t){this.attr.size=t}},{key:"setTextWrap",value:function(t){this.attr.textWrap=t}},{key:"setPadding",value:function(t){this.attr.padding=t}}]),e}(ll),fl=function(){function t(e){var r=e.text,n=e.rect,o=e.dw,i=e.overflow,c=e.attr;tl(this,t),this.attr=x.mergeDeep({},{name:"Arial",size:14,color:"#000000",bold:!1,italic:!1,textWrap:!1,underline:!1,strikethrough:!1,align:nl.left,verticalAlign:ol.center,direction:cl.HORIZONTAL,angle:0,padding:8},c),this.verticalFontDraw=new al({text:r,rect:n,dw:o,overflow:i,attr:this.attr}),this.horizontalFontDraw=new sl({text:r,rect:n,dw:o,overflow:i,attr:this.attr}),this.angleFontDraw=new ul({text:r,rect:n,dw:o,overflow:i,attr:this.attr})}return rl(t,[{key:"draw",value:function(){switch(this.attr.direction){case cl.VERTICAL:return this.verticalFontDraw.draw();case cl.ANGLE:return this.angleFontDraw.draw();case cl.HORIZONTAL:default:return this.horizontalFontDraw.draw()}}},{key:"setOverflowCrop",value:function(t){this.verticalFontDraw.setOverflowCrop(t),this.horizontalFontDraw.setOverflowCrop(t),this.angleFontDraw.setOverflowCrop(t)}},{key:"setSize",value:function(t){this.verticalFontDraw.setSize(t),this.horizontalFontDraw.setSize(t),this.angleFontDraw.setSize(t)}},{key:"setTextWrap",value:function(t){this.verticalFontDraw.setTextWrap(t),this.horizontalFontDraw.setTextWrap(t),this.angleFontDraw.setTextWrap(t)}},{key:"setPadding",value:function(t){this.verticalFontDraw.setPadding(t),this.horizontalFontDraw.setPadding(t),this.angleFontDraw.setPadding(t)}}]),t}();function hl(t){return(hl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pl(t,e){return!e||"object"!==hl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function yl(t){return(yl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bl(t,e){return(bl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dl=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=pl(this,yl(e).call(this,"".concat(o,"-horizontal-type-context-menu"),x.mergeDeep({onUpdate:function(){}},r)))).horizontalIcon1=new pc,t.horizontalIcon2=new gc,t.horizontalIcon3=new Ec;var i=C("div","".concat(o,"-horizontal-type-context-menu-type-icon-line"));return i.children(t.horizontalIcon1),i.children(t.horizontalIcon2),i.children(t.horizontalIcon3),t.horizontalIcons=new Cc,t.horizontalIcons.removeClass("hover"),t.horizontalIcons.children(i),t.addItem(t.horizontalIcons),Nt.bind(t.horizontalIcon1,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(nl.left),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.horizontalIcon2,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(nl.center),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.horizontalIcon3,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(nl.right),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bl(t,e)}(e,t),e}(we);function vl(t){return(vl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gl(t){return(gl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wl(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ml(t,e){return(ml=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ol=function(t){function e(){var t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(t=!(n=gl(e).call(this,"".concat(o,"-tools-horizontal-align")))||"object"!==vl(n)&&"function"!=typeof n?wl(r):n).options=x.mergeDeep({contextMenu:{}},i),t.icon=new et("align-left"),t.setIcon(t.icon),t.horizontalContextMenu=new dl(x.copyProp({el:wl(t),position:ue.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ml(t,e)}(e,t),e}(Rt);function Sl(t){return(Sl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function El(t,e){return!e||"object"!==Sl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xl(t){return(xl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _l(t,e){return(_l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),El(this,xl(e).call(this,"".concat(o,"-vertical-type-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_l(t,e)}(e,t),e}(xe);function Tl(t){return(Tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cl(t,e){return!e||"object"!==Tl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Al(t){return(Al=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pl(t,e){return(Pl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jl=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Cl(this,Al(e).call(this,"".concat(o,"-tools-verticalIcon1")))).icon=new et("align-top"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pl(t,e)}(e,t),e}(ct);function Ll(t){return(Ll="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rl(t,e){return!e||"object"!==Ll(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vl(t){return(Vl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nl(t,e){return(Nl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ml=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Rl(this,Vl(e).call(this,"".concat(o,"-tools-verticalIcon2")))).icon=new et("align-middle"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nl(t,e)}(e,t),e}(ct);function Wl(t){return(Wl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hl(t,e){return!e||"object"!==Wl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dl(t){return(Dl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bl(t,e){return(Bl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Il=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Hl(this,Dl(e).call(this,"".concat(o,"-tools-verticalIcon3")))).icon=new et("align-bottom"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bl(t,e)}(e,t),e}(ct);function Yl(t){return(Yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fl(t,e){return!e||"object"!==Yl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ul(t){return(Ul=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zl(t,e){return(zl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gl=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Fl(this,Ul(e).call(this,"".concat(o,"-vertical-type-context-menu"),x.mergeDeep({onUpdate:function(){}},r)))).verticalIcon1=new jl,t.verticalIcon2=new Ml,t.verticalIcon3=new Il;var i=C("div","".concat(o,"-vertical-type-context-menu-type-icon-line"));return i.children(t.verticalIcon1),i.children(t.verticalIcon2),i.children(t.verticalIcon3),t.verticalIcons=new kl,t.verticalIcons.removeClass("hover"),t.verticalIcons.children(i),t.addItem(t.verticalIcons),Nt.bind(t.verticalIcon1,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(ol.top),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.verticalIcon2,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(ol.center),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.verticalIcon3,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(ol.bottom),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zl(t,e)}(e,t),e}(we);function Xl(t){return(Xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kl(t){return(Kl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ql(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $l(t,e){return($l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zl=function(t){function e(){var t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(t=!(n=Kl(e).call(this,"".concat(o,"-tools-vertical-align")))||"object"!==Xl(n)&&"function"!=typeof n?ql(r):n).options=x.mergeDeep({contextMenu:{}},i),t.icon=new et("align-middle"),t.setIcon(t.icon),t.verticalContextMenu=new Gl(x.copyProp({el:ql(t),position:ue.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$l(t,e)}(e,t),e}(Rt);function Jl(t){return(Jl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ql(t,e){return!e||"object"!==Jl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ts(t){return(ts=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function es(t,e){return(es=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rs=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ql(this,ts(e).call(this,"".concat(o,"-tools-text-wrapping1")))).icon=new et("truncate"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&es(t,e)}(e,t),e}(ct);function ns(t){return(ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function os(t,e){return!e||"object"!==ns(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function is(t){return(is=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cs(t,e){return(cs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ls=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=os(this,is(e).call(this,"".concat(o,"-tools-text-wrapping2")))).icon=new et("overflow"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cs(t,e)}(e,t),e}(ct);function ss(t){return(ss="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function as(t,e){return!e||"object"!==ss(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function us(t){return(us=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fs(t,e){return(fs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hs=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=as(this,us(e).call(this,"".concat(o,"-tools-text-wrapping3")))).icon=new et("wrap"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fs(t,e)}(e,t),e}(ct);function ps(t){return(ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ys(t,e){return!e||"object"!==ps(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bs(t){return(bs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ds(t,e){return(ds=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vs=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ys(this,bs(e).call(this,"".concat(o,"-text-wrapping-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ds(t,e)}(e,t),e}(xe);function gs(t){return(gs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ws(t,e){return!e||"object"!==gs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ms(t){return(ms=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Os(t,e){return(Os=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ss=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ws(this,ms(e).call(this,"".concat(o,"-text-wrapping-context-menu"),x.mergeDeep({onUpdate:function(){}},r)))).textWrappingIcon1=new rs,t.textWrappingIcon2=new ls,t.textWrappingIcon3=new hs;var i=C("div","".concat(o,"-text-wrapping-context-menu-type-icon-line"));return i.children(t.textWrappingIcon1),i.children(t.textWrappingIcon2),i.children(t.textWrappingIcon3),t.textWrappingIcons=new vs,t.textWrappingIcons.removeClass("hover"),t.textWrappingIcons.children(i),t.addItem(t.textWrappingIcons),Nt.bind(t.textWrappingIcon1,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(il.TRUNCATE),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.textWrappingIcon2,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(il.OVER_FLOW),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.textWrappingIcon3,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(il.WORD_WRAP),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Os(t,e)}(e,t),e}(we);function Es(t){return(Es="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xs(t){return(xs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ks(t,e){return(ks=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ts=function(t){function e(){var t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(t=!(n=xs(e).call(this,"".concat(o,"-tools-text-wrapping")))||"object"!==Es(n)&&"function"!=typeof n?_s(r):n).options=x.mergeDeep({contextMenu:{}},i),t.icon=new et("text-wrap"),t.setIcon(t.icon),t.textWrappingContextMenu=new Ss(x.copyProp({el:_s(t),position:ue.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ks(t,e)}(e,t),e}(Rt);function Cs(t){return(Cs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function As(t,e){return!e||"object"!==Cs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ps(t){return(Ps=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function js(t,e){return(js=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ls=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=As(this,Ps(e).call(this,"".concat(o,"-tools-fixed")))).icon=new et("freeze"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&js(t,e)}(e,t),e}(ct);function Rs(t){return(Rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vs(t,e){return!e||"object"!==Rs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ns(t){return(Ns=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ms(t,e){return(Ms=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ws=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Vs(this,Ns(e).call(this,"".concat(o,"-tools-filter")))).icon=new et("filter"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ms(t,e)}(e,t),e}(ct);function Hs(t){return(Hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ds(t,e){return!e||"object"!==Hs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bs(t){return(Bs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Is(t,e){return(Is=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ys=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ds(this,Bs(e).call(this,"".concat(o,"-tools-format")))).icon=new et("functions"),t.setIcon(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Is(t,e)}(e,t),e}(Rt);function Fs(t){return(Fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Us(t,e){return!e||"object"!==Fs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zs(t){return(zs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gs(t,e){return(Gs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xs='\n  <svg class="'.concat(o,'-copy-style-svg" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">\n    <line class="').concat(o,'-copy-style-stroked-top" x1="0" y1="0" x2="100%" y2="0"/>\n    <line class="').concat(o,'-copy-style-stroked-left" x1="0" y1="0" x2="0" y2="100%"/>\n    <line class="').concat(o,'-copy-style-stroked-bottom" x1="0" y1="100%" x2="100%" y2="100%"/>\n    <line class="').concat(o,'-copy-style-stroked-right" x1="100%" y1="0" x2="100%" y2="100%"/>\n  </svg>\n'),Ks=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Us(this,zs(e).call(this,"".concat(o,"-copy-style")))).options=x.mergeDeep({},t),r.mask=C("div","".concat(o,"-copy-style-mask")),r.html(Xs),r.children(r.mask),r.top=r.find(".".concat(o,"-copy-style-stroked-top")),r.left=r.find(".".concat(o,"-copy-style-stroked-left")),r.bottom=r.find(".".concat(o,"-copy-style-stroked-bottom")),r.right=r.find(".".concat(o,"-copy-style-stroked-right")),r.hide(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gs(t,e)}(e,t),e}(V);function qs(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var $s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.screen=e,this.lt=null,this.t=null,this.l=null,this.br=null}var e,r,n;return e=t,(r=[{key:"getLT",value:function(){return this.lt}},{key:"getT",value:function(){return this.t}},{key:"getL",value:function(){return this.l}},{key:"getBR",value:function(){return this.br}},{key:"onAppendScreen",value:function(){}}])&&qs(e.prototype,r),n&&qs(e,n),t}();function Zs(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(n=(c=l.next()).done)&&(r.push(c.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==l.return||l.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Js(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Qs=function(){function t(e,r,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sri=e,this.sci=r,this.eri=n,this.eci=o,this.w=i,this.h=c}var e,r,n;return e=t,n=[{key:"valueOf",value:function(e){var r=e.split(":"),n=Zs(x.expr2xy(r[0]),2),o=n[0],i=n[1],c=i,l=o;if(r.length>1){var s=Zs(x.expr2xy(r[1]),2);l=s[0],c=s[1]}return new t(i,o,c,l)}}],(r=[{key:"set",value:function(t,e,r,n){this.sri=t,this.sci=e,this.eri=r,this.eci=n}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];if(1===n.length){var i=x.expr2xy(n[0]),c=Zs(i,2);e=c[0],t=c[1]}else 2===n.length&&(t=n[0],e=n[1]);var l=this.sri,s=this.sci,a=this.eri,u=this.eci;return l<=t&&t<=a&&s<=e&&e<=u}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},r=this.sri,n=this.sci,o=this.eri,i=this.eci,c=r;c<=o;c+=1)if(e(c))for(var l=n;l<=i;l+=1)t(c,l)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var r=this.sri,n=this.sci,o=this.eri,i=this.eci;return new t(e.sri<r?e.sri:r,e.sci<n?e.sci:n,e.eri>o?e.eri:o,e.eci>i?e.eci:i)}},{key:"coincide",value:function(e){var r=this.sri,n=this.sci,o=this.eri,i=this.eci;return this.disjoint(e)?t.EMPTY:new t(e.sri>r?e.sri:r,e.sci>n?e.sci:n,e.eri<o?e.eri:o,e.eci<i?e.eci:i)}},{key:"coincideDifference",value:function(e){return this.coincide(e).equals(t.EMPTY)?[]:this.difference(e)}},{key:"difference",value:function(e){var r=[],n=function(e,n,o,i){r.push(new t(e,n,o,i))},o=this.sri,i=this.sci,c=this.eri,l=this.eci,s=e.sri-o,a=e.sci-i,u=c-e.eri,f=l-e.eci;return s>0?(n(o,i,e.sri-1,l),u>0?(n(e.eri+1,i,c,l),a>0&&n(e.sri,i,e.eri,e.sci-1),f>0&&n(e.sri,e.eci+1,e.eri,l)):(a>0&&n(e.sri,i,c,e.sci-1),f>0&&n(e.sri,e.eci+1,c,l))):u>0&&(n(e.eri+1,i,c,l),a>0&&n(o,i,e.eri,e.sci-1),f>0&&n(o,e.eci+1,e.eri,l)),a>0?(n(o,i,c,e.sci-1),f>0?(n(o,e.eri+1,c,l),s>0&&n(o,e.sci,e.sri-1,e.eci),u>0&&n(e.sri+1,e.sci,c,e.eci)):(s>0&&n(o,e.sci,e.sri-1,l),u>0&&n(e.sri+1,e.sci,c,l))):f>0&&(n(o,e.eci+1,c,l),s>0&&n(o,i,e.sri-1,e.eci),u>0&&n(e.eri+1,i,c,e.eci)),r}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"brink",value:function(){var e=this.sri,r=this.eri,n=this.sci,o=this.eci,i=new t(e,n,e,o),c=new t(r,n,r,o);return{top:i,right:new t(e,o,r,o),bottom:c,left:new t(e,n,r,n)}}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"toString",value:function(){var t=this.sri,e=this.sci,r=this.eri,n=this.eci,o=x.xy2expr(e,t);return this.multiple()&&(o="".concat(o,":").concat(x.xy2expr(n,r))),o}}])&&Js(e.prototype,r),n&&Js(e,n),t}();function ta(t){return(ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ea(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ra(t,e){return!e||"object"!==ta(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function na(t){return(na=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oa(t,e){return(oa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Qs.EMPTY=new Qs(-1,-1,-1,-1);var ia=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=ra(this,na(e).call(this,t))).options=x.mergeDeep({},n),r.lt=new Ks,r.t=new Ks,r.l=new Ks,r.br=new Ks,r.selectorAttr=null,r.bind(),r}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oa(t,e)}(e,t),r=e,(o=[{key:"setLTOffset",value:function(t){var e=this.screen.table,r=e.xTableFrozenContent,n=e.cols,o=e.rows,i=(e.grid,r.getScrollView()),c=t.rect,l=new Qs(-1,-1,-1,-1),s=c.coincide(i);if(l.equals(s))this.lt.hide();else{var a=n.sectionSumWidth(s.sci,s.eci),u=o.sectionSumHeight(s.sri,s.eri),f=o.sectionSumHeight(i.sri,s.sri-1),h=n.sectionSumWidth(i.sci,s.sci-1);c.eci>i.eci?(this.lt.right.hide(),this.lt.mask.css("border-right","none")):(this.lt.right.show(),this.lt.mask.cssRemoveKeys("border-right")),c.eri>i.eri?(this.lt.bottom.hide(),this.lt.mask.css("border-bottom","none")):(this.lt.bottom.show(),this.lt.mask.cssRemoveKeys("border-bottom"));var p=new Lc({x:h,y:f,width:a,height:u});this.lt.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setTOffset",value:function(t){var e=this.screen.table,r=e.xTop,n=e.cols,o=e.rows,i=(e.grid,r.getScrollView()),c=t.rect,l=new Qs(-1,-1,-1,-1),s=c.coincide(i);if(l.equals(s))this.t.hide();else{var a=n.sectionSumWidth(s.sci,s.eci),u=o.sectionSumHeight(s.sri,s.eri),f=o.sectionSumHeight(i.sri,s.sri-1),h=n.sectionSumWidth(i.sci,s.sci-1);c.sci<i.sci?(this.t.left.hide(),this.t.mask.css("border-left","none")):(this.t.left.show(),this.t.mask.cssRemoveKeys("border-left")),c.eri>i.eri?(this.t.bottom.hide(),this.t.mask.css("border-bottom","none")):(this.t.bottom.show(),this.t.mask.cssRemoveKeys("border-bottom")),c.eci>i.eci?(this.t.right.hide(),this.t.mask.css("border-right","none")):(this.t.right.show(),this.t.mask.cssRemoveKeys("border-right"));var p=new Lc({x:h,y:f,width:a,height:u});this.t.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setLOffset",value:function(t){var e=this.screen.table,r=e.xLeft,n=e.cols,o=e.rows,i=(e.grid,r.getScrollView()),c=t.rect,l=new Qs(-1,-1,-1,-1),s=c.coincide(i);if(l.equals(s))this.l.hide();else{var a=n.sectionSumWidth(s.sci,s.eci),u=o.sectionSumHeight(s.sri,s.eri),f=o.sectionSumHeight(i.sri,s.sri-1),h=n.sectionSumWidth(i.sci,s.sci-1);c.sri<i.sri?(this.l.top.hide(),this.l.mask.css("border-top","none")):(this.l.top.show(),this.l.mask.cssRemoveKeys("border-top")),c.eci>i.eci?(this.l.right.hide(),this.l.mask.css("border-right","none")):(this.l.right.show(),this.l.mask.cssRemoveKeys("border-right")),c.eri>i.eri?(this.l.bottom.hide(),this.l.mask.css("border-bottom","none")):(this.l.bottom.show(),this.l.mask.cssRemoveKeys("border-bottom"));var p=new Lc({x:h,y:f,width:a,height:u});this.l.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setBROffset",value:function(t){var e=this.screen.table,r=e.cols,n=e.rows,o=(e.grid,e.getScrollView()),i=t.rect,c=new Qs(-1,-1,-1,-1),l=i.coincide(o);if(c.equals(l))this.br.hide();else{var s=r.sectionSumWidth(l.sci,l.eci),a=n.sectionSumHeight(l.sri,l.eri),u=n.sectionSumHeight(o.sri,l.sri-1),f=r.sectionSumWidth(o.sci,l.sci-1);i.sci<o.sci?(this.br.left.hide(),this.br.mask.css("border-left","none")):(this.br.left.show(),this.br.mask.cssRemoveKeys("border-left")),i.sri<o.sri?(this.br.top.hide(),this.br.mask.css("border-top","none")):(this.br.top.show(),this.br.mask.cssRemoveKeys("border-top")),i.eri>o.eri?(this.br.bottom.hide(),this.br.mask.css("border-bottom","none")):(this.br.bottom.show(),this.br.mask.cssRemoveKeys("border-bottom")),i.eci>o.eci?(this.br.right.hide(),this.br.mask.css("border-right","none")):(this.br.right.show(),this.br.mask.cssRemoveKeys("border-right"));var h=new Lc({x:f,y:u,width:s,height:a});this.br.offset({width:h.width,height:h.height,left:h.x,top:h.y}).show()}}},{key:"setOffset",value:function(t){this.setLTOffset(t),this.setTOffset(t),this.setLOffset(t),this.setBROffset(t)}},{key:"bind",value:function(){var t=this,e=this.screen.table;Nt.bind(e,n.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.selectorAttr&&t.setOffset(t.selectorAttr)})),Nt.bind(e,n.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(e){t.selectorAttr&&t.setOffset(t.selectorAttr)})),Nt.bind(e,n.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(e){t.selectorAttr&&t.setOffset(t.selectorAttr)}))}},{key:"setShow",value:function(t){this.selectorAttr=t,this.setOffset(t)}},{key:"setHide",value:function(){this.selectorAttr=null,this.lt.hide(),this.t.hide(),this.l.hide(),this.br.hide()}}])&&ea(r.prototype,o),i&&ea(r,i),e}($s);function ca(t){return(ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function la(t,e){return!e||"object"!==ca(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function sa(t){return(sa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function aa(t,e){return(aa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ua=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=la(this,sa(e).call(this,"".concat(o,"-selector")))).cornerEl=C("div","".concat(o,"-selector-corner")),t.areaEl=C("div","".concat(o,"-selector-area")),t.areaEl.children(t.cornerEl),t.children(t.areaEl),t.hide(),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&aa(t,e)}(e,t),e}(V);function fa(t){return(fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ha(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function pa(t,e){return!e||"object"!==fa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ya(t){return(ya=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ba(t,e){return(ba=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var da={DOWN_SELECT:Symbol("选择单元格时触发"),CHANGE:Symbol("选择区域大小发生变化时触发"),SELECT_CHANGE:Symbol("选择区域发生变化时触发"),SELECT_CHANGE_OVER:Symbol("选择区域结束时触发")},va=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=pa(this,ya(e).call(this,t))).options=n,r.selectorAttr=null,r.downSelectorAttr=null,r.onChangeStack=[],r.onSelectChangeStack=[],r.onSelectChangeOver=[],r.onDownSelectStack=[],r.lt=new ua,r.t=new ua,r.l=new ua,r.br=new ua,r.bind(),r}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ba(t,e)}(e,t),r=e,(o=[{key:"bind",value:function(){var t=this,e=this.screen.table,r=e.mousePointer,o=e.focus;Nt.bind(e,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(i){if(0===i.button&&o.activate.el===e){var c,l=e.computeEventXy(i),s=l.x,a=l.y,u=t.getDownXYSelectorAttr(s,a);switch(t.setSelectAttr(u),t.setDownSelectAttr(u),t.setOffset(u),t.onDownSelectStack.forEach((function(t){return t()})),t.onChangeStack.forEach((function(t){return t()})),t.onSelectChangeStack.forEach((function(t){return t()})),u.edgeType){case"left":c=n.MOUSE_POINTER_TYPE.SELECT_ONE_ROW;break;case"top":c=n.MOUSE_POINTER_TYPE.SELECT_ONE_COLUMN;break;default:c=n.MOUSE_POINTER_TYPE.SELECT_CELL}r.on(c),Nt.mouseMoveUp(document,(function(r){var n=e.computeEventXy(r),o=n.x,i=n.y,c=t.getMoveXySelectorAttr(u,o,i);t.setSelectAttr(c),t.setOffset(c),t.onChangeStack.forEach((function(t){return t()})),t.onSelectChangeStack.forEach((function(t){return t()}))}),(function(){r.off(c),t.onSelectChangeOver.forEach((function(t){return t()}))}))}})),Nt.bind(e,n.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.selectorAttr&&t.setOffset(t.selectorAttr)})),Nt.bind(e,n.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.selectorAttr&&(t.setOffset(t.selectorAttr),t.onChangeStack.forEach((function(t){return t()})))})),Nt.bind(e,n.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.selectorAttr&&(t.setOffset(t.selectorAttr),t.onChangeStack.forEach((function(t){return t()})))})),Nt.bind(e,n.TABLE_EVENT_TYPE.SCALE_CHANGE,(function(){t.selectorAttr&&(t.setOffset(t.selectorAttr),t.onChangeStack.forEach((function(t){return t()})))}))}},{key:"setLTOffset",value:function(t){var e=this.screen.table,r=e.xTableFrozenContent,n=e.cols,o=e.rows,i=r.getScrollView(),c=t.rect,l=new Qs(-1,-1,-1,-1),s=c.coincide(i);if(l.equals(s))this.lt.hide();else{var a=n.sectionSumWidth(s.sci,s.eci),u=o.sectionSumHeight(s.sri,s.eri),f=o.sectionSumHeight(i.sri,s.sri-1),h=n.sectionSumWidth(i.sci,s.sci-1);c.eci>i.eci?this.lt.areaEl.css("border-right","none"):this.lt.areaEl.cssRemoveKeys("border-right"),c.eri>i.eri?this.lt.areaEl.css("border-bottom","none"):this.lt.areaEl.cssRemoveKeys("border-bottom");var p=new Lc({x:h,y:f,width:a,height:u});this.lt.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setTOffset",value:function(t){var e=this.screen.table,r=e.xTop,n=e.cols,o=e.rows,i=r.getScrollView(),c=t.rect,l=new Qs(-1,-1,-1,-1),s=c.coincide(i);if(l.equals(s))this.t.hide();else{var a=n.sectionSumWidth(s.sci,s.eci),u=o.sectionSumHeight(s.sri,s.eri),f=o.sectionSumHeight(i.sri,s.sri-1),h=n.sectionSumWidth(i.sci,s.sci-1);c.sci<i.sci?this.t.areaEl.css("border-left","none"):this.t.areaEl.cssRemoveKeys("border-left"),c.eri>i.eri?this.t.areaEl.css("border-bottom","none"):this.t.areaEl.cssRemoveKeys("border-bottom"),c.eci>i.eci?this.t.areaEl.css("border-right","none"):this.t.areaEl.cssRemoveKeys("border-right");var p=new Lc({x:h,y:f,width:a,height:u});this.t.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setLOffset",value:function(t){var e=this.screen.table,r=e.xLeft,n=e.cols,o=e.rows,i=r.getScrollView(),c=t.rect,l=new Qs(-1,-1,-1,-1),s=c.coincide(i);if(l.equals(s))this.l.hide();else{var a=n.sectionSumWidth(s.sci,s.eci),u=o.sectionSumHeight(s.sri,s.eri),f=o.sectionSumHeight(i.sri,s.sri-1),h=n.sectionSumWidth(i.sci,s.sci-1);c.sri<i.sri?this.l.areaEl.css("border-top","none"):this.l.areaEl.cssRemoveKeys("border-top"),c.eci>i.eci?this.l.areaEl.css("border-right","none"):this.l.areaEl.cssRemoveKeys("border-right"),c.eri>i.eri?this.l.areaEl.css("border-bottom","none"):this.l.areaEl.cssRemoveKeys("border-bottom");var p=new Lc({x:h,y:f,width:a,height:u});this.l.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setBROffset",value:function(t){var e=this.screen.table,r=e.cols,n=e.rows,o=e.getScrollView(),i=t.rect,c=new Qs(-1,-1,-1,-1),l=i.coincide(o);if(c.equals(l))this.br.hide();else{var s=r.sectionSumWidth(l.sci,l.eci),a=n.sectionSumHeight(l.sri,l.eri),u=n.sectionSumHeight(o.sri,l.sri-1),f=r.sectionSumWidth(o.sci,l.sci-1);i.sci<o.sci?this.br.areaEl.css("border-left","none"):this.br.areaEl.cssRemoveKeys("border-left"),i.sri<o.sri?this.br.areaEl.css("border-top","none"):this.br.areaEl.cssRemoveKeys("border-top"),i.eri>o.eri?this.br.areaEl.css("border-bottom","none"):this.br.areaEl.cssRemoveKeys("border-bottom"),i.eci>o.eci?this.br.areaEl.css("border-right","none"):this.br.areaEl.cssRemoveKeys("border-right");var h=new Lc({x:f,y:u,width:s,height:a});this.br.offset({width:h.width,height:h.height,left:h.x,top:h.y}).show()}}},{key:"setLTCorner",value:function(t,e){var r=this.screen.table.xTableFrozenContent.getScrollView(),n=t.rect,o=t.edge,i=t.edgeType,c=new Qs(-1,-1,-1,-1),l=n.coincide(r);if(!c.equals(l))if(this.lt.cornerEl.cssRemoveKeys("left"),this.lt.cornerEl.cssRemoveKeys("top"),this.lt.cornerEl.cssRemoveKeys("right"),this.lt.cornerEl.cssRemoveKeys("bottom"),this.lt.cornerEl.hide(),o){var s="ltl"===e;"left"===i&&"ltt"===e&&(this.lt.cornerEl.show(),this.lt.cornerEl.css("left","0px"),this.lt.cornerEl.css("bottom","0px")),"top"===i&&s&&(this.lt.cornerEl.show(),this.lt.cornerEl.css("right","0px"),this.lt.cornerEl.css("top","0px"))}else"lt"===e&&(this.lt.cornerEl.show(),this.lt.cornerEl.css("right","0px"),this.lt.cornerEl.css("bottom","0px")),n.eci>r.eci&&this.lt.cornerEl.hide(),n.eri>r.eri&&this.lt.cornerEl.hide()}},{key:"setTCorner",value:function(t,e){var r=this.screen.table.xTop.getScrollView(),n=t.rect,o=t.edge,i=t.edgeType,c=new Qs(-1,-1,-1,-1),l=n.coincide(r);if(!c.equals(l))if(this.t.cornerEl.cssRemoveKeys("left"),this.t.cornerEl.cssRemoveKeys("top"),this.t.cornerEl.cssRemoveKeys("right"),this.t.cornerEl.cssRemoveKeys("bottom"),this.t.cornerEl.hide(),o){var s="lttlbr"===e;"top"===i&&"tbr"===e&&(this.t.cornerEl.show(),this.t.cornerEl.css("right","0px"),this.t.cornerEl.css("top","0px")),"top"===i&&s&&(this.t.cornerEl.show(),this.t.cornerEl.css("right","0px"),this.t.cornerEl.css("top","0px")),"top"===i&&n.eci>r.eci&&this.t.cornerEl.hide()}else("t"===e||"ltt"===e)&&(this.t.cornerEl.show(),this.t.cornerEl.css("right","0px"),this.t.cornerEl.css("bottom","0px")),n.eci>r.eci&&this.t.cornerEl.hide(),n.eri>r.eri&&this.t.cornerEl.hide()}},{key:"setLCorner",value:function(t,e){var r=this.screen.table.xLeft.getScrollView(),n=t.rect,o=t.edge,i=t.edgeType,c=new Qs(-1,-1,-1,-1),l=n.coincide(r);if(!c.equals(l))if(this.l.cornerEl.cssRemoveKeys("left"),this.l.cornerEl.cssRemoveKeys("top"),this.l.cornerEl.cssRemoveKeys("right"),this.l.cornerEl.cssRemoveKeys("bottom"),this.l.cornerEl.hide(),o){var s="lttlbr"===e;"left"===i&&"lbr"===e&&(this.l.cornerEl.show(),this.l.cornerEl.css("left","0"),this.l.cornerEl.css("bottom","0")),"left"===i&&s&&(this.l.cornerEl.show(),this.l.cornerEl.css("left","0"),this.l.cornerEl.css("bottom","0")),"left"===i&&n.eri>r.eri&&this.l.cornerEl.hide()}else("l"===e||"ltl"===e)&&(this.l.cornerEl.show(),this.l.cornerEl.css("right","0px"),this.l.cornerEl.css("bottom","0px")),n.eci>r.eci&&this.l.cornerEl.hide(),n.eri>r.eri&&this.l.cornerEl.hide()}},{key:"setBrCorner",value:function(t,e){var r=this.screen.table.getScrollView(),n=t.rect,o=t.edge,i=t.edgeType,c=new Qs(-1,-1,-1,-1),l=n.coincide(r);if(!c.equals(l))if(this.br.cornerEl.cssRemoveKeys("left"),this.br.cornerEl.cssRemoveKeys("top"),this.br.cornerEl.cssRemoveKeys("right"),this.br.cornerEl.cssRemoveKeys("bottom"),this.br.cornerEl.hide(),o){var s="br"===e,a="lttlbr"===e;"left"===i&&s&&(this.br.cornerEl.show(),this.br.cornerEl.css("left","0"),this.br.cornerEl.css("bottom","0")),"top"===i&&s&&(this.br.cornerEl.show(),this.br.cornerEl.css("right","0"),this.br.cornerEl.css("top","0")),"left-top"===i&&a&&(this.br.cornerEl.show(),this.br.cornerEl.css("right","0"),this.br.cornerEl.css("bottom","0")),"left-top"===i&&s&&(this.br.cornerEl.show(),this.br.cornerEl.css("right","0"),this.br.cornerEl.css("bottom","0")),"left"===i&&n.eri>r.eri&&this.br.cornerEl.hide(),"top"===i&&n.eci>r.eci&&this.br.cornerEl.hide()}else{var u="lbr"===e;("br"===e||"tbr"===e||u||u||"lttlbr"===e)&&(this.br.cornerEl.show(),this.br.cornerEl.css("right","0px"),this.br.cornerEl.css("bottom","0px")),n.eri>r.eri&&this.br.cornerEl.hide(),n.eci>r.eci&&this.br.cornerEl.hide()}}},{key:"setSelectAttr",value:function(t){this.selectorAttr=t,this.selectorAttr.id=Date.now()}},{key:"setDownSelectAttr",value:function(t){this.downSelectorAttr=t}},{key:"getIntersectsArea",value:function(t){var e=this.screen.table,r=e.fixed,n=e.cols,o=e.rows,i=t.rect,c="",l=new Qs(0,0,r.fxTop,r.fxLeft),s=new Qs(0,r.fxLeft+1,r.fxTop,n.len),a=new Qs(r.fxTop+1,0,o.len,r.fxLeft),u=new Qs(r.fxTop+1,r.fxLeft+1,o.len,n.len);return i.intersects(l)&&(c+="lt"),i.intersects(s)&&(c+="t"),i.intersects(a)&&(c+="l"),i.intersects(u)&&(c+="br"),c}},{key:"setOffset",value:function(t){var e=this.getIntersectsArea(t);this.setLTOffset(t),this.setTOffset(t),this.setLOffset(t),this.setBROffset(t),this.setLTCorner(t,e),this.setTCorner(t,e),this.setLCorner(t,e),this.setBrCorner(t,e)}},{key:"getViewRange",value:function(){var t=this.screen.table,e=t.cols,r=t.rows,n=t.getScrollView(),o=n.sri,i=n.sci,c=n.eri,l=n.eci;t.getFixedWidth()>0&&(o=0),t.getFixedHeight()>0&&(i=0);var s=e.sectionSumWidth(i,l),a=r.sectionSumHeight(o,c);return new Qs(o,i,c,l,s,a)}},{key:"getDownXYSelectorAttr",value:function(t,e){var r=this.screen.table,n=r.merges,o=r.rows,i=r.cols,c=r.getRiCiByXy(t,e),l=c.ri,s=c.ci;if(-1===l&&-1===s)return{rect:new Qs(0,0,o.len-1,i.len-1),edge:!0,edgeType:"left-top"};if(-1===l)return{rect:new Qs(0,s,o.len-1,s),edge:!0,edgeType:"top"};if(-1===s)return{rect:new Qs(l,0,l,i.len-1),edge:!0,edgeType:"left"};var a=n.getFirstIncludes(l,s),u=new Qs(l,s,l,s);return a&&(u=a),{rect:u}}},{key:"getMoveXySelectorAttr",value:function(t,e,r){var n=this.screen.table,o=n.merges,i=n.rows,c=n.cols,l=t.rect,s=t.edgeType,a=this.getViewRange(),u=n.getRiCiByXy(e,r),f=u.ri,h=u.ci;switch(-1===f&&(f=a.sri),-1===h&&(h=a.sci),s){case"left-top":var p=l.union(new Qs(0,0,i.len-1,c.len-1));return{rect:p=l.union(p),edge:!0,edgeType:"left-top"};case"top":var y=l.union(new Qs(0,h,0,h));return{rect:y=l.union(y),edge:!0,edgeType:"top"};case"left":var b=l.union(new Qs(f,0,f,0));return{rect:b=l.union(b),edge:!0,edgeType:"left"}}var d=l.union(new Qs(f,h,f,h));return{rect:d=o.union(d)}}},{key:"getSelectRange",value:function(){return this.selectorAttr.rect}},{key:"on",value:function(t,e){var r;switch(t){case da.CHANGE:r=this.onChangeStack;break;case da.SELECT_CHANGE_OVER:r=this.onSelectChangeOver;break;case da.DOWN_SELECT:r=this.onDownSelectStack;break;case da.SELECT_CHANGE:r=this.onSelectChangeStack}r&&r.push(e)}},{key:"remove",value:function(t,e){var r;switch(t){case da.CHANGE:r=this.onChangeStack;break;case da.SELECT_CHANGE_OVER:r=this.onSelectChangeOver;break;case da.DOWN_SELECT:r=this.onDownSelectStack;break;case da.SELECT_CHANGE:r=this.onSelectChangeStack}if(r)for(var n=0;n<r.length;n+=1)if(r[n]===e)return void r.splice(n,1)}}])&&ha(r.prototype,o),i&&ha(r,i),e}($s);function ga(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var wa=function(){function t(e){var r=e.align,n=void 0===r?nl.left:r,o=e.verticalAlign,i=void 0===o?ol.center:o,c=e.textWrap,l=void 0===c?il.OVER_FLOW:c,s=e.strikethrough,a=void 0!==s&&s,u=e.underline,f=void 0!==u&&u,h=e.color,p=void 0===h?"rgb(0,0,0)":h,y=e.name,b=void 0===y?"Arial":y,d=e.size,v=void 0===d?12:d,g=e.bold,w=void 0!==g&&g,m=e.italic,O=void 0!==m&&m,S=e.angle,E=void 0===S?0:S,x=e.direction,_=void 0===x?cl.HORIZONTAL:x,k=e.padding,T=void 0===k?5:k;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.align=n,this.verticalAlign=i,this.textWrap=l,this.strikethrough=a,this.underline=f,this.color=p,this.name=b,this.size=v,this.bold=w,this.italic=O,this.direction=_,this.angle=E,this.padding=T}var e,r,n;return e=t,(r=[{key:"clone",value:function(){return new t({align:this.align,verticalAlign:this.verticalAlign,textWrap:this.textWrap,strikethrough:this.strikethrough,underline:this.underline,color:this.color,name:this.name,size:this.size,bold:this.bold,italic:this.italic,angle:this.angle,direction:this.direction,padding:this.padding})}}])&&ga(e.prototype,r),n&&ga(e,n),t}();function ma(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Oa=function(){function t(e){var r=e.time,n=void 0===r?x.now():r,o=e.display,i=void 0!==o&&o,c=e.width,l=void 0===c?1:c,s=e.color,a=void 0===s?"#000000":s,u=e.type,f=void 0===u?Fi.SOLID_LINE:u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$time=n,this.$display=i,this.$width=l,this.$color=a,this.$type=f}var e,r,n;return e=t,(r=[{key:"equal",value:function(t){var e=this.color===t.color,r=this.width===t.width,n=this.type===t.type;return e&&r&&n}},{key:"compareTime",value:function(t){if(x.isUnDef(t))return-2;var e=this.time,r=t.time;return e>r?1:r>e?-1:0}},{key:"toJSON",value:function(){return{time:this.$time,display:this.$display,width:this.$width,color:this.$color,type:this.$type}}},{key:"time",get:function(){return this.$time}},{key:"display",get:function(){return this.$display},set:function(t){this.$time=x.now(),this.$display=t}},{key:"width",get:function(){return this.$width},set:function(t){this.$time=x.now(),this.$width=t}},{key:"color",get:function(){return this.$color},set:function(t){this.$time=x.now(),this.$color=t}},{key:"type",get:function(){return this.$type},set:function(t){this.$time=x.now(),this.$type=t}}])&&ma(e.prototype,r),n&&ma(e,n),t}();function Sa(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Ea=function(){function t(e){var r=e.left,n=void 0===r?{}:r,o=e.top,i=void 0===o?{}:o,c=e.right,l=void 0===c?{}:c,s=e.bottom,a=void 0===s?{}:s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.left=new Oa(n),this.top=new Oa(i),this.right=new Oa(l),this.bottom=new Oa(a)}var e,r,n;return e=t,(r=[{key:"clone",value:function(){return new t({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}}])&&Sa(e.prototype,r),n&&Sa(e,n),t}();function xa(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var _a=function(){function t(e){var r=e.text,n=void 0===r?x.EMPTY:r,o=e.background,i=void 0===o?x.Nul:o,c=e.format,l=void 0===c?"default":c,s=e.fontAttr,a=void 0===s?{}:s,u=e.borderAttr,f=void 0===u?{}:u,h=e.contentWidth,p=void 0===h?0:h;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.background=i,this.format=l,this.text=n,this.fontAttr=new wa(a),this.borderAttr=new Ea(f),this.contentWidth=p}var e,r,n;return e=t,(r=[{key:"setContentWidth",value:function(t){this.contentWidth=t}},{key:"clone",value:function(){return new t({background:this.background,format:this.format,text:this.text,fontAttr:this.fontAttr,borderAttr:this.borderAttr,contentWidth:this.contentWidth})}},{key:"toJSON",value:function(){return{background:this.background,format:this.format,text:this.text,fontAttr:this.fontAttr,borderAttr:this.borderAttr,contentWidth:this.contentWidth}}}])&&xa(e.prototype,r),n&&xa(e,n),t}();function ka(t){return(ka="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ta(t,e){return!e||"object"!==ka(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ca(t){return(Ca=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Aa(t,e){return(Aa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pa=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Ta(this,Ca(e).call(this,"".concat(o,"-scale-context-menu-item")))).scale=t,r.titleElement=C("div","".concat(o,"-scale-context-menu-item-title")),r.titleElement.text("".concat(t,"%")),r.titleElement.css("text-align","center"),r.children(r.titleElement),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Aa(t,e)}(e,t),e}(xe);function ja(t){return(ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function La(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ra(t,e){return!e||"object"!==ja(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Va(t){return(Va=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Na(t,e){return(Na=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ma=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ra(this,Va(e).call(this,"".concat(o,"-scale-context-menu"),x.mergeDeep({onUpdate:function(){}},r)))).items=[new Pa(200),new Pa(150),new Pa(125),new Pa(100),new Pa(90),new Pa(75),new Pa(50)],t.items.forEach((function(e){e.on(n.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.scale)})),t.addItem(e)})),t}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Na(t,e)}(e,t),r=e,(i=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}}])&&La(r.prototype,i),c&&La(r,c),e}(we);function Wa(t){return(Wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ha(t){return(Ha=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Da(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ba(t,e){return(Ba=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ia=function(t){function e(){var t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(t=!(n=Ha(e).call(this,"".concat(o,"-tools-scale")))||"object"!==Wa(n)&&"function"!=typeof n?Da(r):n).options=i,t.setTitle("100%"),t.setWidth(50),t.setEllipsis(),t.scaleContextMenu=new Ma(x.copyProp({el:Da(t),position:ue.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ba(t,e)}(e,t),e}(Rt);function Ya(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Fa(t){return(Fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ua(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function za(t,e){return!e||"object"!==Fa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ga(t){return(Ga=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xa(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ka(t,e)}function Ka(t,e){return(Ka=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qa=function(t){function e(){return Ua(this,e),za(this,Ga(e).call(this,"".concat(o,"-tools-divider")))}return Xa(e,t),e}(V),$a=function(t){function e(t){var r;Ua(this,e),(r=za(this,Ga(e).call(this,"".concat(o,"-tools-menu")))).workTop=t;var n=r.workTop.work.body.sheetView;return r.undo=new ft,r.redo=new dt,r.scale=new Ia({contextMenu:{onUpdate:function(t){r.scale.setTitle("".concat(t,"%")),r.workTop.work.body.setScale(t/100)}}}),r.paintFormat=new St,r.clearFormat=new Tt,r.format=new Xe({contextMenu:{onUpdate:function(t,e){var o=n.getActiveSheet().table,i=o.screen,c=o.styleCellsHelper,l=o.tableDataSnapshot,s=i.findByClass(va).selectorAttr;if(r.format.setTitle(e),s){l.begin();var a=l.cellDataProxy;c.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(e,r,n){var o=n.clone();o.format=t,a.setCell(e,r,o)}}),l.end(),o.render()}}}}),r.font=new fr({contextMenu:{onUpdate:function(t){var e=n.getActiveSheet().table,o=e.screen,i=e.styleCellsHelper,c=e.tableDataSnapshot,l=o.findByClass(va).selectorAttr;if(r.font.setTitle(t),l){c.begin();var s=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(e,r,n){var o=n.clone();o.fontAttr.name=t,s.setCell(e,r,o)}}),c.end(),e.render()}}}}),r.dprFontSize=new Tr({contextMenu:{onUpdate:function(t){var e=n.getActiveSheet().table,o=e.screen,i=e.styleCellsHelper,c=e.tableDataSnapshot,l=o.findByClass(va).selectorAttr;if(r.dprFontSize.setTitle(t),l){c.begin();var s=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(e,r,n){var o=n.clone();o.fontAttr.size=t,s.setCell(e,r,o)}}),c.end(),e.render()}}}}),r.fontColor=new Dn({contextMenu:{onUpdate:function(t){var e=n.getActiveSheet().table,o=e.screen,i=e.styleCellsHelper,c=e.tableDataSnapshot,l=o.findByClass(va).selectorAttr;if(r.fontColor.setColor(t),l){c.begin();var s=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(e,r,n){var o=n.clone();o.fontAttr.color=t,s.setCell(e,r,o)}}),c.end(),e.render()}}}}),r.fillColor=new ro({contextMenu:{onUpdate:function(t){var e=n.getActiveSheet().table,o=e.screen,i=e.styleCellsHelper,c=e.tableDataSnapshot,l=o.findByClass(va).selectorAttr;if(r.fillColor.setColor(t),l){c.begin();var s=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(e,r,n){var o=n.clone();o.background=t,s.setCell(e,r,o)}}),c.end(),e.render()}}}}),r.border=new nc({contextMenu:{onUpdate:function(t,e,r){var o=n.getActiveSheet().table,i=o.screen,c=o.styleCellsHelper,l=o.cells,s=o.tableDataSnapshot,a=i.findByClass(va).selectorAttr;if(a){s.begin();var u=s.cellDataProxy,f=1,h=Fi.SOLID_LINE;switch(r){case"line1":f=1,h=Fi.SOLID_LINE;break;case"line2":f=2,h=Fi.SOLID_LINE;break;case"line3":f=3,h=Fi.SOLID_LINE;break;case"line4":h=Fi.DOTTED_LINE;break;case"line5":h=Fi.POINT_LINE;break;case"line6":h=Fi.DOUBLE_LINE}switch(t){case"border1":c.getCellOrNewCellByViewRange({rectRange:a.rect,callback:function(t,r,n){var o=n.clone();o.borderAttr.left.display=!0,o.borderAttr.top.display=!0,o.borderAttr.right.display=!0,o.borderAttr.bottom.display=!0,o.borderAttr.left.color=e,o.borderAttr.top.color=e,o.borderAttr.right.color=e,o.borderAttr.bottom.color=e,o.borderAttr.left.width=f,o.borderAttr.top.width=f,o.borderAttr.right.width=f,o.borderAttr.bottom.width=f,o.borderAttr.left.type=h,o.borderAttr.top.type=h,o.borderAttr.right.type=h,o.borderAttr.bottom.type=h,u.setCell(t,r,o)}});break;case"border2":c.getCellOrNewCellByViewRange({rectRange:a.rect,callback:function(t,r,n){var o=n.clone();a.rect.sri===t?o.borderAttr.bottom.display=!0:a.rect.eri===t?o.borderAttr.top.display=!0:(o.borderAttr.bottom.display=!0,o.borderAttr.top.display=!0),a.rect.sci===r?o.borderAttr.right.display=!0:a.rect.eci===r?o.borderAttr.left.display=!0:(o.borderAttr.right.display=!0,o.borderAttr.left.display=!0),a.rect.sri===t?o.borderAttr.bottom.color=e:a.rect.eri===t?o.borderAttr.top.color=e:(o.borderAttr.bottom.color=e,o.borderAttr.top.color=e),a.rect.sci===r?o.borderAttr.right.color=e:a.rect.eci===r?o.borderAttr.left.color=e:(o.borderAttr.right.color=e,o.borderAttr.left.color=e),a.rect.sri===t?o.borderAttr.bottom.width=f:a.rect.eri===t?o.borderAttr.top.width=f:(o.borderAttr.bottom.width=f,o.borderAttr.top.width=f),a.rect.sci===r?o.borderAttr.right.width=f:a.rect.eci===r?o.borderAttr.left.width=f:(o.borderAttr.right.width=f,o.borderAttr.left.width=f),a.rect.sri===t?o.borderAttr.bottom.type=h:a.rect.eri===t?o.borderAttr.top.type=h:(o.borderAttr.bottom.type=h,o.borderAttr.top.type=h),a.rect.sci===r?o.borderAttr.right.type=h:a.rect.eci===r?o.borderAttr.left.type=h:(o.borderAttr.right.type=h,o.borderAttr.left.type=h),u.setCell(t,r,o)}});break;case"border3":c.getCellOrNewCellByViewRange({rectRange:a.rect,callback:function(t,r,n){var o=n.clone();a.rect.sri===t?o.borderAttr.bottom.display=!0:a.rect.eri===t?o.borderAttr.top.display=!0:(o.borderAttr.bottom.display=!0,o.borderAttr.top.display=!0),a.rect.sri===t?o.borderAttr.bottom.color=e:a.rect.eri===t?o.borderAttr.top.color=e:(o.borderAttr.bottom.color=e,o.borderAttr.top.color=e),a.rect.sri===t?o.borderAttr.bottom.width=f:a.rect.eri===t?o.borderAttr.top.width=f:(o.borderAttr.bottom.width=f,o.borderAttr.top.width=f),a.rect.sri===t?o.borderAttr.bottom.type=h:a.rect.eri===t?o.borderAttr.top.type=h:(o.borderAttr.bottom.type=h,o.borderAttr.top.type=h),u.setCell(t,r,o)}});break;case"border4":c.getCellOrNewCellByViewRange({rectRange:a.rect,callback:function(t,r,n){var o=n.clone();a.rect.sci===r?o.borderAttr.right.display=!0:a.rect.eci===r?o.borderAttr.left.display=!0:(o.borderAttr.right.display=!0,o.borderAttr.left.display=!0),a.rect.sci===r?o.borderAttr.right.color=e:a.rect.eci===r?o.borderAttr.left.color=e:(o.borderAttr.right.color=e,o.borderAttr.left.color=e),a.rect.sci===r?o.borderAttr.right.width=f:a.rect.eci===r?o.borderAttr.left.width=f:(o.borderAttr.right.width=f,o.borderAttr.left.width=f),a.rect.sci===r?o.borderAttr.right.type=h:a.rect.eci===r?o.borderAttr.left.type=h:(o.borderAttr.right.type=h,o.borderAttr.left.type=h),u.setCell(t,r,o)}});break;case"border5":c.getCellOrNewCellByViewRange({rectRange:a.rect,callback:function(t,r,n){var o=n.clone();a.rect.sci===r?o.borderAttr.left.display=!0:a.rect.eci===r&&(o.borderAttr.right.display=!0),a.rect.sri===t?o.borderAttr.top.display=!0:a.rect.eri===t&&(o.borderAttr.bottom.display=!0),a.rect.sci===r?o.borderAttr.left.color=e:a.rect.eci===r&&(o.borderAttr.right.color=e),a.rect.sri===t?o.borderAttr.top.color=e:a.rect.eri===t&&(o.borderAttr.bottom.color=e),a.rect.sci===r?o.borderAttr.left.width=f:a.rect.eci===r&&(o.borderAttr.right.width=f),a.rect.sri===t?o.borderAttr.top.width=f:a.rect.eri===t&&(o.borderAttr.bottom.width=f),a.rect.sci===r?o.borderAttr.left.type=h:a.rect.eci===r&&(o.borderAttr.right.type=h),a.rect.sri===t?o.borderAttr.top.type=h:a.rect.eri===t&&(o.borderAttr.bottom.type=h),u.setCell(t,r,o)}});break;case"border6":c.getCellOrNewCellByViewRange({rectRange:a.rect,callback:function(t,r,n){if(r===a.rect.sci){var o=n.clone();o.borderAttr.left.display=!0,o.borderAttr.left.color=e,o.borderAttr.left.width=f,o.borderAttr.left.type=h,u.setCell(t,r,o)}}});break;case"border7":c.getCellOrNewCellByViewRange({rectRange:a.rect,callback:function(t,r,n){if(t===a.rect.sri){var o=n.clone();o.borderAttr.top.display=!0,o.borderAttr.top.color=e,o.borderAttr.top.width=f,o.borderAttr.top.type=h,u.setCell(t,r,o)}}});break;case"border8":c.getCellOrNewCellByViewRange({rectRange:a.rect,callback:function(t,r,n){if(r===a.rect.eci){var o=n.clone();o.borderAttr.right.display=!0,o.borderAttr.right.color=e,o.borderAttr.right.width=f,o.borderAttr.right.type=h,u.setCell(t,r,o)}}});break;case"border9":c.getCellOrNewCellByViewRange({rectRange:a.rect,callback:function(t,r,n){if(t===a.rect.eri){var o=n.clone();o.borderAttr.bottom.display=!0,o.borderAttr.bottom.color=e,o.borderAttr.bottom.width=f,o.borderAttr.bottom.type=h,u.setCell(t,r,o)}}});break;case"border10":c.getCellOrNewCellByViewRange({rectRange:a.rect,callback:function(t,e,r){var n=r.clone();a.rect.sri===t&&(l.getCellOrNew(t-1,e).borderAttr.bottom.display=!1);a.rect.eri===t&&(l.getCellOrNew(t+1,e).borderAttr.top.display=!1);a.rect.sci===e&&(l.getCellOrNew(t,e-1).borderAttr.right.display=!1);a.rect.eci===e&&(l.getCellOrNew(t,e+1).borderAttr.left.display=!1);n.borderAttr.left.display=!1,n.borderAttr.top.display=!1,n.borderAttr.right.display=!1,n.borderAttr.bottom.display=!1,n.borderAttr.left.color=!1,n.borderAttr.top.color=!1,n.borderAttr.right.color=!1,n.borderAttr.bottom.color=!1,n.borderAttr.left.width=!1,n.borderAttr.top.width=!1,n.borderAttr.right.width=!1,n.borderAttr.bottom.width=!1,n.borderAttr.left.type=!1,n.borderAttr.top.type=!1,n.borderAttr.right.type=!1,n.borderAttr.bottom.type=!1,u.setCell(t,e,n)}})}s.end(),o.render()}}}}),r.fontBold=new Lr,r.fontItalic=new Wr,r.underLine=new Yr,r.fontStrike=new Xr,r.merge=new sc,r.horizontalAlign=new Ol({contextMenu:{onUpdate:function(t){var e=n.getActiveSheet().table,o=e.screen,i=e.styleCellsHelper,c=e.tableDataSnapshot,l=o.findByClass(va).selectorAttr;switch(t){case nl.left:r.horizontalAlign.setIcon(new et("align-left"));break;case nl.center:r.horizontalAlign.setIcon(new et("align-center"));break;case nl.right:r.horizontalAlign.setIcon(new et("align-right"))}if(l){c.begin();var s=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(e,r,n){var o=n.clone();o.fontAttr.align=t,s.setCell(e,r,o)}}),c.end(),e.render()}}}}),r.verticalAlign=new Zl({contextMenu:{onUpdate:function(t){var e=n.getActiveSheet().table,o=e.screen,i=e.styleCellsHelper,c=e.tableDataSnapshot,l=o.findByClass(va).selectorAttr;switch(t){case ol.top:r.verticalAlign.setIcon(new et("align-top"));break;case ol.center:r.verticalAlign.setIcon(new et("align-middle"));break;case ol.bottom:r.verticalAlign.setIcon(new et("align-bottom"))}if(l){c.begin();var s=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(e,r,n){var o=n.clone();o.fontAttr.verticalAlign=t,s.setCell(e,r,o)}}),c.end(),e.render()}}}}),r.textWrapping=new Ts({contextMenu:{onUpdate:function(t){var e,o=n.getActiveSheet().table,i=o.screen,c=o.styleCellsHelper,l=o.tableDataSnapshot,s=i.findByClass(va).selectorAttr;switch(t){case il.TRUNCATE:e=new et("truncate");break;case il.WORD_WRAP:e=new et("text-wrap");break;case il.OVER_FLOW:default:e=new et("overflow")}if(r.textWrapping.setIcon(e),s){l.begin();var a=l.cellDataProxy;c.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(e,r,n){var o=n.clone();o.fontAttr.textWrap=t,a.setCell(e,r,o)}}),l.end(),o.render()}}}}),r.fixed=new Ls,r.filter=new Ws,r.functions=new Ys,r.children(r.undo),r.children(r.redo),r.children(new qa),r.children(r.scale),r.children(r.paintFormat),r.children(r.clearFormat),r.children(r.format),r.children(new qa),r.children(r.font),r.children(r.dprFontSize),r.children(new qa),r.children(r.fontBold),r.children(r.fontItalic),r.children(r.underLine),r.children(r.fontStrike),r.children(r.fontColor),r.children(new qa),r.children(r.fillColor),r.children(r.border),r.children(r.merge),r.children(r.horizontalAlign),r.children(r.verticalAlign),r.children(r.textWrapping),r.children(r.fixed),r.children(r.filter),r.children(r.functions),r}var r,i,c;return Xa(e,t),r=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"bind",value:function(){var t=this,e=this.workTop.work.body,r=e.sheetView;Nt.bind(e,n.WORK_BODY_EVENT_TYPE.CHANGE_ACTIVE,(function(){t.setStatus()})),Nt.bind(e,n.TABLE_EVENT_TYPE.DATA_CHANGE,(function(){t.setStatus()})),Nt.bind(e,n.TABLE_EVENT_TYPE.SELECT_DOWN,(function(){t.setFormatStatus(),t.setFontStatus(),t.setFontSizeStatus(),t.setFontBoldStatus(),t.setFontItalicStatus(),t.setUnderLineStatus(),t.setFontStrikeStatus(),t.setFontColorStatus(),t.setFillColorStatus(),t.setHorizontalAlignStatus(),t.setVerticalAlignStatus(),t.setTextWrappingStatus()})),Nt.bind(this.undo,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=r.getActiveSheet().table.tableDataSnapshot;t.canBack()&&t.back()})),Nt.bind(this.redo,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=r.getActiveSheet().table.tableDataSnapshot;t.canGo()&&t.go()})),Nt.bind(this.scale,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.scale.scaleContextMenu,n=r.elPopUp;pe.closeAll([n]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(this.paintFormat,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var e=r.getActiveSheet(),n=e.table,o=n.screen,i=n.cells,c=n.tableDataSnapshot,l=o.findByClass(ia),s=o.findByClass(va),a=s.selectorAttr;a&&(l.setShow(a),t.paintFormat.active(!0),t.paintFormat.addSheet(e),s.on(da.SELECT_CHANGE_OVER,(function r(){l.setHide(),t.paintFormat.active(!1),t.paintFormat.removeSheet(e),s.remove(da.SELECT_CHANGE_OVER,r);var o=a.rect,u=s.selectorAttr.rect;c.begin();for(var f=c.cellDataProxy,h=o.sri,p=u.sri;h<=o.eri;h+=1,p+=1)for(var y=o.sci,b=u.sci;y<=o.eci;y+=1,b+=1){var d=i.getMergeCellMasterOrCell(h,y);if(d){var v=i.getCellOrNew(p,b),g=d.clone();g.text=v.text,f.setCell(p,b,g)}}c.end(),n.render()})))})),Nt.bind(this.clearFormat,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=r.getActiveSheet().table,e=t.screen,n=t.styleCellsHelper,o=t.tableDataSnapshot,i=e.findByClass(va).selectorAttr;if(i){o.begin();var c=o.cellDataProxy;n.getCellOrNewCellByViewRange({rectRange:i.rect,callback:function(t,e,r){var n=r.text;c.setCell(t,e,new _a({text:n}))}}),o.end(),t.render()}})),Nt.bind(this.format,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.format.formatContextMenu,n=r.elPopUp;pe.closeAll([n]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(this.font,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.font.fontContextMenu,n=r.elPopUp;pe.closeAll([n]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(this.dprFontSize,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.dprFontSize.fontSizeContextMenu,n=r.elPopUp;pe.closeAll([n]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(this.fontBold,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=r.getActiveSheet().table,e=t.screen,n=t.cells,o=t.styleCellsHelper,i=t.tableDataSnapshot,c=e.findByClass(va).selectorAttr;if(c){var l=!n.getCellOrNew(c.rect.sri,c.rect.sci).fontAttr.bold;i.begin();var s=i.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:c.rect,callback:function(t,e,r){var n=r.clone();n.fontAttr.bold=l,s.setCell(t,e,n)}}),i.end(),t.render()}})),Nt.bind(this.fontItalic,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=r.getActiveSheet().table,e=t.screen,n=t.cells,o=t.styleCellsHelper,i=t.tableDataSnapshot,c=e.findByClass(va).selectorAttr;if(c){var l=!n.getCellOrNew(c.rect.sri,c.rect.sci).fontAttr.italic;i.begin();var s=i.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:c.rect,callback:function(t,e,r){var n=r.clone();n.fontAttr.italic=l,s.setCell(t,e,n)}}),i.end(),t.render()}})),Nt.bind(this.underLine,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=r.getActiveSheet().table,e=t.screen,n=t.cells,o=t.styleCellsHelper,i=t.tableDataSnapshot,c=e.findByClass(va).selectorAttr;if(c){var l=!n.getCellOrNew(c.rect.sri,c.rect.sci).fontAttr.underline;i.begin();var s=i.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:c.rect,callback:function(t,e,r){var n=r.clone();n.fontAttr.underline=l,s.setCell(t,e,n)}}),i.end(),t.render()}})),Nt.bind(this.fontStrike,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=r.getActiveSheet().table,e=t.screen,n=t.cells,o=t.styleCellsHelper,i=t.tableDataSnapshot,c=e.findByClass(va).selectorAttr;if(c){var l=!n.getCellOrNew(c.rect.sri,c.rect.sci).fontAttr.strikethrough;i.begin();var s=i.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:c.rect,callback:function(t,e,r){var n=r.clone();n.fontAttr.strikethrough=l,s.setCell(t,e,n)}}),i.end(),t.render()}})),Nt.bind(this.fontColor,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.fontColor.fontColorContextMenu,n=r.elPopUp;pe.closeAll([n]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(this.fillColor,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.fillColor.fillColorContextMenu,n=r.elPopUp;pe.closeAll([n]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(this.border,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.border.borderTypeContextMenu,n=r.elPopUp;pe.closeAll([n]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(this.merge,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){var e=r.getActiveSheet().table,n=e.screen,o=e.merges,i=e.tableDataSnapshot,c=n.findByClass(va).selectorAttr;if(c){var l=c.rect.clone(),s=o.getFirstIncludes(l.sri,l.sci);i.begin();var a=i.mergeDataProxy;x.isNotUnDef(s)&&l.equals(s)?a.deleteMerge(s):a.addMerge(l),i.end(),e.render()}t.stopPropagation(),t.preventDefault()})),Nt.bind(this.horizontalAlign,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.horizontalAlign.horizontalContextMenu,n=r.elPopUp;pe.closeAll([n]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(this.verticalAlign,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.verticalAlign.verticalContextMenu,n=r.elPopUp;pe.closeAll([n]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(this.textWrapping,n.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var r=t.textWrapping.textWrappingContextMenu,n=r.elPopUp;pe.closeAll([n]),r.isOpen()?r.open():r.close(),e.stopPropagation(),e.preventDefault()}))}},{key:"setUndoStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table.tableDataSnapshot;this.undo.active(t.canBack())}},{key:"setRedoStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table.tableDataSnapshot;this.redo.active(t.canGo())}},{key:"setScaleStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table.scale.goto(100);this.scale.setTitle("".concat(t,"%"))}},{key:"setPaintFormatStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet();this.paintFormat.active(this.paintFormat.includeSheet(t))}},{key:"setFormatStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,n=e.findByClass(va).selectorAttr,o="常规",i="default";if(n)switch(i=r.getCellOrNew(n.rect.sri,n.rect.sci).format){case"default":o="常规";break;case"text":o="文本";break;case"number":o="数字";break;case"percentage":o="百分比";break;case"fraction":o="分数";break;case"ENotation":o="科学计数";break;case"rmb":o="人民币";break;case"hk":o="港币";break;case"dollar":o="美元";break;case"date1":case"date2":case"date3":case"date4":case"date5":o="日期";break;case"time":o="时间"}this.format.setTitle(o),this.format.formatContextMenu.setActiveByType(i)}},{key:"setFontStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,n=e.findByClass(va).selectorAttr,o="Arial";n&&(o=r.getCellOrNew(n.rect.sri,n.rect.sci).fontAttr.name),this.font.setTitle(o),this.font.fontContextMenu.setActiveByType(o)}},{key:"setFontSizeStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,n=e.findByClass(va).selectorAttr,o="12";n&&(o=r.getCellOrNew(n.rect.sri,n.rect.sci).fontAttr.size),this.dprFontSize.setTitle(o)}},{key:"setFontBoldStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,n=e.findByClass(va).selectorAttr,o=!1;n&&(o=r.getCellOrNew(n.rect.sri,n.rect.sci).fontAttr.bold),this.fontBold.active(o)}},{key:"setFontItalicStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,n=e.findByClass(va).selectorAttr,o=!1;n&&(o=r.getCellOrNew(n.rect.sri,n.rect.sci).fontAttr.italic),this.fontItalic.active(o)}},{key:"setUnderLineStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,n=e.findByClass(va).selectorAttr,o=!1;n&&(o=r.getCellOrNew(n.rect.sri,n.rect.sci).fontAttr.underline),this.underLine.active(o)}},{key:"setFontStrikeStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,n=e.findByClass(va).selectorAttr,o=!1;n&&(o=r.getCellOrNew(n.rect.sri,n.rect.sci).fontAttr.strikethrough),this.fontStrike.active(o)}},{key:"setFontColorStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,n=e.findByClass(va).selectorAttr,o="rgb(0, 0, 0)";n&&(o=r.getCellOrNew(n.rect.sri,n.rect.sci).fontAttr.color),this.fontColor.setColor(o),this.fontColor.fontColorContextMenu.setActiveByColor(o)}},{key:"setFillColorStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,n=e.findByClass(va).selectorAttr,o="rgb(255, 255, 255)";if(n){var i=r.getCellOrNew(n.rect.sri,n.rect.sci);i.background&&(o=i.background)}this.fillColor.setColor(o),this.fillColor.fillColorContextMenu.setActiveByColor(o)}},{key:"setHorizontalAlignStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,n=e.findByClass(va).selectorAttr,o=new et("align-left");if(n)switch(r.getCellOrNew(n.rect.sri,n.rect.sci).fontAttr.align){case nl.left:o=new et("align-left");break;case nl.center:o=new et("align-center");break;case nl.right:o=new et("align-right")}this.horizontalAlign.setIcon(o)}},{key:"setVerticalAlignStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,n=e.findByClass(va).selectorAttr,o=new et("align-middle");if(n)switch(r.getCellOrNew(n.rect.sri,n.rect.sci).fontAttr.verticalAlign){case ol.top:o=new et("align-top");break;case ol.center:o=new et("align-middle");break;case ol.bottom:o=new et("align-bottom")}this.verticalAlign.setIcon(o)}},{key:"setTextWrappingStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,r=t.cells,n=e.findByClass(va).selectorAttr,o=new et("text-wrap");if(n)switch(r.getCellOrNew(n.rect.sri,n.rect.sci).fontAttr.textWrap){case il.TRUNCATE:o=new et("truncate");break;case il.WORD_WRAP:o=new et("text-wrap");break;case il.OVER_FLOW:default:o=new et("overflow")}this.textWrapping.setIcon(o)}},{key:"setStatus",value:function(){this.setUndoStatus(),this.setRedoStatus(),this.setScaleStatus(),this.setPaintFormatStatus(),this.setFormatStatus(),this.setFontStatus(),this.setFontSizeStatus(),this.setFontBoldStatus(),this.setFontItalicStatus(),this.setUnderLineStatus(),this.setFontStrikeStatus(),this.setFontColorStatus(),this.setFillColorStatus(),this.setHorizontalAlignStatus(),this.setVerticalAlignStatus(),this.setTextWrappingStatus()}}])&&Ya(r.prototype,i),c&&Ya(r,c),e}(V);function Za(t){return(Za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ja(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Qa(t,e){return!e||"object"!==Za(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tu(t){return(tu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function eu(t,e){return(eu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ru=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Qa(this,tu(e).call(this,"".concat(o,"-option-item ").concat(t)))).title="",r}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&eu(t,e)}(e,t),r=e,(n=[{key:"setTitle",value:function(t){this.title=t,this.text(this.title)}}])&&Ja(r.prototype,n),i&&Ja(r,i),e}(V);function nu(t){return(nu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ou(t,e){return!e||"object"!==nu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function iu(t){return(iu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cu(t,e){return(cu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var lu=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ou(this,iu(e).call(this,"".concat(o,"-tools-file")))).setTitle("文件"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cu(t,e)}(e,t),e}(ru);function su(t){return(su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function au(t,e){return!e||"object"!==su(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function uu(t){return(uu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fu(t,e){return(fu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hu=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=au(this,uu(e).call(this,"".concat(o,"-tools-format")))).setTitle("格式"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fu(t,e)}(e,t),e}(ru);function pu(t){return(pu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yu(t,e){return!e||"object"!==pu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bu(t){return(bu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function du(t,e){return(du=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vu=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=yu(this,bu(e).call(this,"".concat(o,"-tools-insert")))).setTitle("插入"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&du(t,e)}(e,t),e}(ru);function gu(t){return(gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wu(t,e){return!e||"object"!==gu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mu(t){return(mu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ou(t,e){return(Ou=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Su=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=wu(this,mu(e).call(this,"".concat(o,"-tools-look")))).setTitle("查看"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ou(t,e)}(e,t),e}(ru);function Eu(t){return(Eu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xu(t,e){return!e||"object"!==Eu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _u(t){return(_u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ku(t,e){return(ku=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tu=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=xu(this,_u(e).call(this,"".concat(o,"-tools-update")))).setTitle("修改"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ku(t,e)}(e,t),e}(ru);function Cu(t){return(Cu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Au(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Pu(t,e){return!e||"object"!==Cu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ju(t){return(ju=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Lu(t,e){return(Lu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ru=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Pu(this,ju(e).call(this,"".concat(o,"-option")))).workTop=t,r.title=" X-Sheet 工作簿",r.logoEle=C("div","".concat(o,"-option-logo")),r.titleEle=C("div","".concat(o,"-option-title")),r.optionsEle=C("div","".concat(o,"-option-box")),r.leftEle=C("div","".concat(o,"-option-left")),r.rightEle=C("div","".concat(o,"-option-right")),r.leftEle.children(r.logoEle),r.rightEle.children(r.titleEle,r.optionsEle),r.children(r.leftEle),r.children(r.rightEle),r.setTitle(r.title),r.file=new lu,r.format=new hu,r.insert=new vu,r.look=new Su,r.update=new Tu,r.optionsEle.children(r.file),r.optionsEle.children(r.format),r.optionsEle.children(r.insert),r.optionsEle.children(r.look),r.optionsEle.children(r.update),r}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lu(t,e)}(e,t),r=e,(n=[{key:"setTitle",value:function(t){this.title=t,this.titleEle.text(t)}}])&&Au(r.prototype,n),i&&Au(r,i),e}(V);function Vu(t){return(Vu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Mu(t,e){return!e||"object"!==Vu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wu(t){return(Wu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hu(t,e){return(Hu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Du=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Mu(this,Wu(e).call(this,"".concat(o,"-work-top")))).work=t,r}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hu(t,e)}(e,t),r=e,(n=[{key:"onAttach",value:function(){this.toolsMenu=new $a(this),this.option=new Ru(this),this.attach(this.option),this.attach(this.toolsMenu)}}])&&Nu(r.prototype,n),i&&Nu(r,i),e}(V);function Bu(t){return(Bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Iu(t,e){return!e||"object"!==Bu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yu(t){return(Yu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fu(t,e){return(Fu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Uu=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Iu(this,Yu(e).call(this,"".concat(o,"-vertical-center-element")))).options=x.mergeDeep({style:{}},t),r.css(r.options.style),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fu(t,e)}(e,t),e}(D);function zu(t){return(zu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gu(t,e){return!e||"object"!==zu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xu(t){return(Xu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ku(t,e){return(Ku=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qu=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Gu(this,Xu(e).call(this,"div","".concat(o,"-vertical-center")))).options=x.mergeDeep({style:{}},t),r.css(r.options.style),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ku(t,e)}(e,t),e}(D);function $u(t){return($u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ju(t,e){return!e||"object"!==$u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qu(t,e,r){return(Qu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=tf(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function tf(t){return(tf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ef(t,e){return(ef=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rf=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ju(this,tf(e).call(this,"".concat(o,"-sheet-view")))).sheetList=[],t.activeIndex=-1,t}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ef(t,e)}(e,t),r=e,(i=[{key:"attach",value:function(t){var r=this;this.sheetList.push(t),Qu(tf(e.prototype),"attach",this).call(this,t),t.hide(),Nt.bind(t,n.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){r.trigger(n.TABLE_EVENT_TYPE.CHANGE_WIDTH)})),Nt.bind(t,n.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){r.trigger(n.TABLE_EVENT_TYPE.CHANGE_HEIGHT)})),Nt.bind(t,n.TABLE_EVENT_TYPE.DATA_CHANGE,(function(){r.trigger(n.TABLE_EVENT_TYPE.DATA_CHANGE)})),Nt.bind(t,n.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(){r.trigger(n.TABLE_EVENT_TYPE.SELECT_CHANGE)})),Nt.bind(t,n.TABLE_EVENT_TYPE.SELECT_DOWN,(function(){r.trigger(n.TABLE_EVENT_TYPE.SELECT_DOWN,r)}))}},{key:"setActiveSheet",value:function(t){var e=this.sheetList;return e[t]?(this.activeIndex=t,this.setActive(e[t])):null}},{key:"setActive",value:function(t){return t.show(),t.sibling().forEach((function(t){t.hide()})),t}},{key:"getActiveSheet",value:function(){return this.sheetList[this.activeIndex]}},{key:"getLastIndex",value:function(){return this.sheetList.length-1}}])&&Zu(r.prototype,i),c&&Zu(r,c),e}(V);function nf(t){return(nf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function of(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function cf(t,e){return!e||"object"!==nf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function lf(t){return(lf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sf(t,e){return(sf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var af=function(t){function e(t){var r,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=cf(this,lf(e).call(this,"".concat(o,"-sheet-switch-tab")))).last=C("div","".concat(o,"-switch-tab-last-btn")),n.next=C("div","".concat(o,"-switch-tab-next-btn")),n.content=C("div","".concat(o,"-sheet-tab-content")),n.tabs=C("div","".concat(o,"-sheet-tab-tabs")),n.plus=C("div","".concat(o,"-sheet-tab-plus")),n.content.children(n.tabs),(r=n).children.apply(r,[n.last,n.next,n.content,n.plus]),n.optiions=x.mergeDeep({onAdd:function(t){return t},onSwitch:function(t){return t}},t),n.left=null,n.tabList=[],n}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sf(t,e)}(e,t),r=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"offsetSizeLeft",value:function(){var t=this.content.offset().width,e=this.tabs.offset().width;e>t&&(this.left=-(e-t),this.tabs.css("marginLeft","".concat(this.left,"px")))}},{key:"bind",value:function(){var t=this,e=this.next,r=this.last,o=this.plus;Nt.bind(e,n.SYSTEM_EVENT_TYPE.CLICK,(function(){var e=t.content.offset().width,r=-(t.tabs.offset().width-e),n=t.left||0;(n-=30)<r&&(n=r),t.left=n,t.tabs.css("marginLeft","".concat(t.left,"px"))})),Nt.bind(r,n.SYSTEM_EVENT_TYPE.CLICK,(function(){var e=t.left||0;(e+=30)>0&&(e=0),t.left=e,t.tabs.css("marginLeft","".concat(t.left,"px"))})),Nt.bind(o,n.SYSTEM_EVENT_TYPE.CLICK,(function(){t.optiions.onAdd(),t.offsetSizeLeft()}))}},{key:"attach",value:function(t){var e=this;this.tabList.push(t),this.tabs.children(t),t.onAttach(),Nt.bind(t,n.SYSTEM_EVENT_TYPE.CLICK,(function(){e.setActive(t),e.optiions.onSwitch(t)}))}},{key:"setActiveTab",value:function(t){var e=this.tabList;return e[t]?(this.setActive(e[t]),e[t]):null}},{key:"setActive",value:function(t){t.addClass("active"),t.sibling().forEach((function(t){t.removeClass("active")}))}},{key:"getLastIndex",value:function(){return this.tabList.length-1}}])&&of(r.prototype,i),c&&of(r,c),e}(V);function uf(t){return(uf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ff(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function hf(t,e){return!e||"object"!==uf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pf(t){return(pf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yf(t,e){return(yf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bf=0,df=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Sheet".concat(bf+=1);return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=hf(this,pf(e).call(this,"".concat(o,"-sheet-tab")))).setName(r),t}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yf(t,e)}(e,t),r=e,(n=[{key:"setName",value:function(t){this.name=t,this.text(this.name)}}])&&ff(r.prototype,n),i&&ff(r,i),e}(V);function vf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var wf=function(){function t(){vf(this,t),this.value=1,this.enableFloat=!1}var e,r,n;return e=t,(r=[{key:"useFloat",value:function(){this.enableFloat=!0}},{key:"notFloat",value:function(){this.enableFloat=!1}},{key:"back",value:function(t){return this.enableFloat?t/this.value:Yc.upRounding(t/this.value)}},{key:"goto",value:function(t){return this.enableFloat?this.value*t:Yc.upRounding(this.value*t)}},{key:"setValue",value:function(t){this.value=t}}])&&gf(e.prototype,r),n&&gf(e,n),t}(),mf=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.goto,n=void 0===r?function(t){return t}:r,o=e.back,i=void 0===o?function(t){return t}:o;vf(this,t),this.goto=n,this.back=i};function Of(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Sf=function(){function t(e){var r=e.scaleAdapter,n=void 0===r?new mf:r,o=e.len,i=void 0===o?10:o,c=e.data,l=void 0===c?[]:c,s=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scaleAdapter=n,this.len=i,this.data=l,this.min=5,this.height=x.minIf(s,this.min)}var e,r,n;return e=t,(r=[{key:"getOrNew",value:function(t){return this.data[t]=this.data[t]||{},this.data[t]}},{key:"getHeight",value:function(t){var e=this.scaleAdapter,r=this.get(t);return r&&r.height?e.goto(r.height):e.goto(this.height)}},{key:"get",value:function(t){return this.data[t]}},{key:"eachHeight",value:function(t,e,r){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=n,i=t;i<=e;i+=1){var c=this.getHeight(i);r(i,c,o),o+=c}}},{key:"setHeight",value:function(t,e){var r=this.getOrNew(t),n=this.scaleAdapter;r.height=n.back(x.minIf(e,this.min))}},{key:"rectRangeSumHeight",value:function(t){return this.sectionSumHeight(t.sri,t.eri)}},{key:"sectionSumHeight",value:function(t,e){var r=this;return x.rangeSum(t,e+1,(function(t){return r.getHeight(t)}))}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(t){this.data=t}}])&&Of(e.prototype,r),n&&Of(e,n),t}();function Ef(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var xf=function(){function t(e){var r=e.scaleAdapter,n=void 0===r?new mf:r,o=e.len,i=void 0===o?10:o,c=e.data,l=void 0===c?[]:c,s=e.width,a=void 0===s?110:s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scaleAdapter=n,this.len=i,this.data=l,this.min=5,this.width=x.minIf(a,this.min)}var e,r,n;return e=t,(r=[{key:"getOrNew",value:function(t){return this.data[t]=this.data[t]||{},this.data[t]}},{key:"getWidth",value:function(t){var e=this.scaleAdapter,r=this.data[t];return r&&r.width?e.goto(r.width):e.goto(this.width)}},{key:"get",value:function(t){return this.data[t]}},{key:"eachWidth",value:function(t,e,r){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=n,i=t;i<=e;i+=1){var c=this.getWidth(i);r(i,c,o),o+=c}}},{key:"setWidth",value:function(t,e){var r=this.getOrNew(t),n=this.scaleAdapter;r.width=n.goto(x.minIf(e,this.min))}},{key:"rectRangeSumWidth",value:function(t){return this.sectionSumWidth(t.sci,t.eci)}},{key:"sectionSumWidth",value:function(t,e){var r=this;return x.rangeSum(t,e+1,(function(t){return r.getWidth(t)}))}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(t){this.data=t}}])&&Ef(e.prototype,r),n&&Ef(e,n),t}();var _f={H_LEFT:Symbol("水平方向左边滚动条"),H_RIGHT:Symbol("水平方向向右边滚动"),V_TOP:Symbol("垂直方向向上滚动"),V_BOTTOM:Symbol("垂直方向下滚动"),UN:Symbol("未知")},kf=function t(e){var r=e.fixed;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ri=r.fxTop+1,this.ci=r.fxLeft+1,this.x=0,this.y=0,this.type=_f.UN};function Tf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Cf=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.draw=e,this.color="#000000",x.mergeDeep(this,r)}var e,r,n;return e=t,(r=[{key:"horizontalLine",value:function(t,e,r,n){if(e!==n)throw new Error("coordinate errors sy should be equal to ey !!!");var o=this.draw,i=this.color;o.attr({strokeStyle:i,lineWidth:1}),o.line([t,e],[r,n])}},{key:"verticalLine",value:function(t,e,r,n){if(t!==r)throw new Error("coordinate errors sx should be equal to ex !!!");var o=this.draw,i=this.color;o.attr({strokeStyle:i,lineWidth:1}),o.line([t,e],[r,n])}}])&&Tf(e.prototype,r),n&&Tf(e,n),t}();function Af(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Pf=function(){function t(e){var r=e.merges,n=e.rows,o=e.cols,i=e.cells;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.merges=r,this.rows=n,this.cols=o,this.cells=i}var e,r,n;return e=t,(r=[{key:"vLineRightBoundOut",value:function(t,e){var r=this.cells,n=this.cols,o=this.merges,i=n.len,c=r.getMergeCellOrCell(e,t),l=r.getMergeCellOrCell(e,t+1);if(o.getFirstIncludes(e,t+1))return!0;var s=!0,a=!0;if(c&&!x.isBlank(c.text)){var u=c.fontAttr,f=!0;if(u.direction===cl.ANGLE){var h=u.angle;90!==h&&-90!==h||(f=!1),u.textWrap===il.TRUNCATE&&(f=!1)}else u.textWrap!==il.OVER_FLOW&&(f=!1);var p=u.align,y=n.getWidth(t);p!==nl.left&&p!==nl.center&&(f=!1),f&&r.getCellBoundOutSize(e,t)>y&&(null===l||x.isBlank(l.text))&&(a=!1)}for(var b=n.getWidth(t-1)+n.getWidth(t),d=t-1;d>=0;d-=1,b+=n.getWidth(d)){var v=r.getCell(e,d);if(null!==v){var g=v.text;if(!x.isBlank(g)){var w=v.fontAttr;if(w.direction===cl.ANGLE){var m=w.angle,O=w.textWrap;if(90===m||-90===m)break;if(O===il.TRUNCATE)break}else{if(w.textWrap!==il.OVER_FLOW)break;var S=w.align;if(S!==nl.left&&S!==nl.center)break}if(r.getCellBoundOutSize(e,d)>b){var E=null===c||x.isBlank(c.text),_=null===l||x.isBlank(l.text);E&&_&&(a=!1)}break}}}for(var k=n.getWidth(t+1),T=t+1;T<=i;T+=1,k+=n.getWidth(T)){var C=r.getCell(e,T);if(null!==C){var A=C.text;if(!x.isBlank(A)){var P=C.fontAttr;if(P.direction===cl.ANGLE){var j=P.angle,L=P.textWrap;if(90===j||-90===j)break;if(L===il.TRUNCATE)break}else{if(P.textWrap!==il.OVER_FLOW)break;var R=P.align;if(R!==nl.right&&R!==nl.center)break}r.getCellBoundOutSize(e,T)>k&&(null===c||x.isBlank(c.text))&&(s=!1);break}}}return a&&s}},{key:"vLineLeftBoundOut",value:function(t,e){var r=this.cells,n=this.cols,o=this.merges,i=n.len,c=r.getMergeCellOrCell(e,t),l=r.getMergeCellOrCell(e,t-1);if(o.getFirstIncludes(e,t-1))return!0;var s=!0,a=!0;if(c&&!x.isBlank(c.text)){var u=c.fontAttr,f=!0;if(u.direction===cl.ANGLE){var h=u.angle;90!==h&&-90!==h||(f=!1),u.textWrap===il.TRUNCATE&&(f=!1)}else u.textWrap!==il.OVER_FLOW&&(f=!1);var p=u.align,y=n.getWidth(t);p!==nl.right&&p!==nl.center&&(f=!1),f&&r.getCellBoundOutSize(e,t)>y&&(null===l||x.isBlank(l.text))&&(a=!1)}for(var b=n.getWidth(t-1),d=t-1;d>=0;d-=1,b+=n.getWidth(d)){var v=r.getCell(e,d);if(null!==v){var g=v.text;if(!x.isBlank(g)){var w=v.fontAttr;if(w.direction===cl.ANGLE){var m=w.angle,O=w.textWrap;if(90===m||-90===m)break;if(O===il.TRUNCATE)break}else{if(w.textWrap!==il.OVER_FLOW)break;var S=w.align;if(S!==nl.left&&S!==nl.center)break}r.getCellBoundOutSize(e,d)>b&&(null===c||x.isBlank(c.text))&&(a=!1);break}}}for(var E=n.getWidth(t+1)+n.getWidth(t),_=t+1;_<=i;_+=1,E+=n.getWidth(_)){var k=r.getCell(e,_);if(null!==k){var T=k.text;if(!x.isBlank(T)){var C=k.fontAttr;if(C.direction===cl.ANGLE){var A=C.angle,P=C.textWrap;if(90===A||-90===A)break;if(P===il.TRUNCATE)break}else{if(C.textWrap!==il.OVER_FLOW)break;var j=C.align;if(j!==nl.right&&j!==nl.center)break}if(r.getCellBoundOutSize(e,_)>E){var L=null===c||x.isBlank(c.text),R=null===l||x.isBlank(l.text);L&&R&&(s=!1)}break}}}return a&&s}},{key:"hEach",value:function(t){for(var e=t.viewRange,r=void 0===e?new Qs(0,0,0,0):e,n=t.newRow,o=void 0===n?function(){return!0}:n,i=t.filter,c=void 0===i?function(){return!0}:i,l=t.jump,s=void 0===l?function(){return!0}:l,a=t.handle,u=void 0===a?function(){return!0}:a,f=t.endRow,h=void 0===f?function(){return!0}:f,p=t.bx,y=void 0===p?0:p,b=t.by,d=void 0===b?0:b,v=this.cols,g=this.rows,w=r.sri,m=r.eri,O=r.sci,S=r.eci,E=d,x=w;x<=m;x+=1){var _=g.getHeight(x),k=y;o(x,E);for(var T=O;T<=S;T+=1){var C=v.getWidth(T);c(x,T,k,E)?u(x,T,k,E):s(x,T,k,E),k+=C}h(),E+=_}}},{key:"vEach",value:function(t){for(var e=t.viewRange,r=void 0===e?new Qs(0,0,0,0):e,n=t.newCol,o=void 0===n?function(){return!0}:n,i=t.filter,c=void 0===i?function(){return!0}:i,l=t.jump,s=void 0===l?function(){return!0}:l,a=t.handle,u=void 0===a?function(){return!0}:a,f=t.endCol,h=void 0===f?function(){return!0}:f,p=t.bx,y=void 0===p?0:p,b=t.by,d=void 0===b?0:b,v=this.cols,g=this.rows,w=r.sri,m=r.eri,O=r.sci,S=r.eci,E=y,x=O;x<=S;x+=1){var _=v.getWidth(x),k=d;o(x,E);for(var T=w;T<=m;T+=1){var C=g.getHeight(T);c(x,T,E,k)?u(x,T,E,k):s(x,T,E,k),k+=C}h(),E+=_}}},{key:"viewRangeAndMergeCoincideView",value:function(t){var e=t.viewRange,r=void 0===e?new Qs(0,0,0,0):e,n=this.merges,o=this.cols,i=this.rows,c=[],l=[];return this.hEach({viewRange:r,handle:function(t,e,s,a){var u=n.getFirstIncludes(t,e);if(u&&-1===c.indexOf(u)){c.push(u);var f=r.coincide(u),h=o.sectionSumWidth(f.sci,f.eci),p=i.sectionSumHeight(f.sri,f.eri),y=new Lc({x:s,y:a,width:h,height:p});l.push({rect:y,view:f,merge:u})}}}),l}},{key:"coincideViewBrink",value:function(t){for(var e=t.coincideView,r=this.cols,n=this.rows,o=[],i=0;i<e.length;i+=1){var c=e[i],l=c.view,s=c.rect,a=c.merge,u=l.brink(),f={view:u.top,x:s.x,y:s.y},h={view:u.left,x:s.x,y:s.y},p={view:u.bottom,x:s.x,y:s.y+s.height-n.rectRangeSumHeight(u.bottom)},y={view:u.right,x:s.x+s.width-r.rectRangeSumWidth(u.right),y:s.y},b={};a.sri===l.sri&&(b.top=f),a.sci===l.sci&&(b.left=h),a.eri===l.eri&&(b.bottom=p),a.eci===l.eci&&(b.right=y),o.push(b)}return o}}])&&Af(e.prototype,r),n&&Af(e,n),t}();function jf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Lf=function(){function t(e){var r=e.merges,n=e.rows,o=e.cols,i=e.cells,c=e.lineHandle;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.merges=r,this.rows=n,this.cols=o,this.cells=i,this.lineHandle=c,this.drawOptimization=!0,this.borderOptimization=!0}var e,r,n;return e=t,(r=[{key:"borderHTLine",value:function(t){var e,r,n,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},s=this.drawOptimization,a=this.lineHandle,u=this.cols,f=this.cells,h=[];if(a.hEach({viewRange:t,newRow:function(t,l){n=e=i,o=r=c+l},filter:l,jump:function(t,r){var o=u.getWidth(r);n=e=n+o},handle:function(t,i){var c=u.getWidth(i),l=f.getCell(t,i).borderAttr;n+=c,h.push({sx:e,sy:r,ex:n,ey:o,row:t,col:i,borderAttr:l}),e=n}}),s)for(var p=1;p<h.length;){var y=h[p],b=h[p-1],d=y.borderAttr.top.equal(b.borderAttr.top),v=y.col-b.col==1,g=y.row===b.row;d&&v&&g?(b.ex=y.ex,b.col=y.col,h.splice(p,1)):p+=1}return h}},{key:"borderHBLine",value:function(t){var e,r,n,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},s=this.drawOptimization,a=this.lineHandle,u=this.cols,f=this.rows,h=this.cells,p=[];if(a.hEach({viewRange:t,newRow:function(t,l){var s=f.getHeight(t);n=e=i,o=r=c+l+s},filter:l,jump:function(t,r){var o=u.getWidth(r);n=e=n+o},handle:function(t,i){var c=u.getWidth(i),l=h.getCell(t,i).borderAttr;n+=c,p.push({sx:e,sy:r,ex:n,ey:o,row:t,col:i,borderAttr:l}),e=n}}),s)for(var y=1;y<p.length;){var b=p[y],d=p[y-1],v=b.borderAttr.bottom.equal(d.borderAttr.bottom),g=b.col-d.col==1,w=b.row===d.row;v&&g&&w?(d.ex=b.ex,d.col=b.col,p.splice(y,1)):y+=1}return p}},{key:"borderVLLine",value:function(t){var e,r,n,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},s=this.drawOptimization,a=this.lineHandle,u=this.rows,f=this.cells,h=[];if(a.vEach({viewRange:t,newCol:function(t,l){n=e=i+l,o=r=c},filter:l,jump:function(t,e){var n=u.getHeight(e);o=r=o+n},handle:function(t,i){var c=u.getHeight(i),l=f.getCell(i,t).borderAttr;o+=c,h.push({sx:e,sy:r,ex:n,ey:o,row:i,col:t,borderAttr:l}),r=o}}),s)for(var p=1;p<h.length;){var y=h[p],b=h[p-1],d=y.borderAttr.left.equal(b.borderAttr.left),v=y.row-b.row==1,g=y.col===b.col;d&&v&&g?(b.ey=y.ey,b.row=y.row,h.splice(p,1)):p+=1}return h}},{key:"borderVRLine",value:function(t){var e,r,n,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},s=this.drawOptimization,a=this.lineHandle,u=this.rows,f=this.cols,h=this.cells,p=[];if(a.vEach({viewRange:t,newCol:function(t,l){var s=f.getWidth(t);n=e=i+l+s,o=r=c},filter:l,jump:function(t,e){var n=u.getHeight(e);o=r=o+n},handle:function(t,i){var c=u.getHeight(i),l=h.getCell(i,t).borderAttr;o+=c,p.push({sx:e,sy:r,ex:n,ey:o,row:i,col:t,borderAttr:l}),r=o}}),s)for(var y=1;y<p.length;){var b=p[y],d=p[y-1],v=b.borderAttr.right.equal(d.borderAttr.right),g=b.row-d.row==1,w=b.col===d.col;v&&g&&w?(d.ey=b.ey,d.row=b.row,p.splice(y,1)):y+=1}return p}},{key:"htLine",value:function(t){var e=this.borderOptimization,r=this.merges,n=this.cells;return this.borderHTLine(t,0,0,(function(t,o){var i=r.getFirstIncludes(t,o),c=n.getMergeCellOrCell(t,o),l=n.getMergeCellOrCell(t-1,o);if(!c||i)return!1;if(l&&e){var s=c.borderAttr.top.display&&l.borderAttr.bottom.display,a=c.borderAttr.top.compareTime(l.borderAttr.bottom);if(s)return 1===a}return c.borderAttr.top.display}))}},{key:"hbLine",value:function(t){var e=this.borderOptimization,r=this.merges,n=this.cells;return this.borderHBLine(t,0,0,(function(t,o){var i=r.getFirstIncludes(t,o),c=n.getMergeCellOrCell(t,o),l=n.getMergeCellOrCell(t+1,o);if(!c||i)return!1;if(l&&e){var s=c.borderAttr.bottom.display&&l.borderAttr.top.display,a=c.borderAttr.bottom.compareTime(l.borderAttr.top);if(s)return 1===a||0===a}return c.borderAttr.bottom.display}))}},{key:"vlLine",value:function(t){var e=this.borderOptimization,r=this.merges,n=this.cells,o=this.lineHandle;return this.borderVLLine(t,0,0,(function(t,i){var c=r.getFirstIncludes(i,t),l=n.getMergeCellOrCell(i,t),s=n.getMergeCellOrCell(i,t-1);return!(!l||c)&&(s&&e&&l.borderAttr.left.display&&s.borderAttr.right.display?!(1!==l.borderAttr.left.compareTime(s.borderAttr.right))&&o.vLineLeftBoundOut(t,i):l.borderAttr.left.display?o.vLineLeftBoundOut(t,i):l.borderAttr.left.display)}))}},{key:"vrLine",value:function(t){var e=this.borderOptimization,r=this.merges,n=this.cells,o=this.lineHandle;return this.borderVRLine(t,0,0,(function(t,i){var c=r.getFirstIncludes(i,t),l=n.getMergeCellOrCell(i,t),s=n.getMergeCellOrCell(i,t+1);if(!l||c)return!1;if(s&&e&&l.borderAttr.right.display&&s.borderAttr.left.display){var a=l.borderAttr.right.compareTime(s.borderAttr.left);return!(1!==a&&0!==a)&&o.vLineRightBoundOut(t,i)}return l.borderAttr.right.display?o.vLineRightBoundOut(t,i):l.borderAttr.right.display}))}},{key:"htMergeLine",value:function(t){for(var e=this.borderOptimization,r=this.cells,n=[],o=0;o<t.length;o+=1){var i=t[o].top;if(i){var c=this.borderHTLine(i.view,i.x,i.y,(function(t,n){var o=r.getCell(t,n),i=r.getCell(t-1,n);if(!o)return!1;if(i&&e){var c=o.borderAttr.top.display&&i.borderAttr.bottom.display,l=o.borderAttr.top.compareTime(i.borderAttr.bottom);if(c)return 1===l}return o.borderAttr.top.display}));n=n.concat(c)}}return n}},{key:"hbMergeLine",value:function(t){for(var e=this.borderOptimization,r=this.cells,n=[],o=0;o<t.length;o+=1){var i=t[o].bottom;if(i){var c=this.borderHBLine(i.view,i.x,i.y,(function(t,n){var o=r.getCell(t,n),i=r.getCell(t+1,n);if(!o)return!1;if(i&&e){var c=o.borderAttr.bottom.display&&i.borderAttr.top.display,l=o.borderAttr.bottom.compareTime(i.borderAttr.top);if(c)return 1===l||0===l}return o.borderAttr.bottom.display}));n=n.concat(c)}}return n}},{key:"vlMergeLine",value:function(t){for(var e=this.borderOptimization,r=this.cells,n=[],o=0;o<t.length;o+=1){var i=t[o].left;if(i){var c=this.borderVLLine(i.view,i.x,i.y,(function(t,n){var o=r.getCell(n,t),i=r.getCell(n,t-1);if(!o)return!1;if(i&&e){var c=o.borderAttr.left.display&&i.borderAttr.right.display,l=o.borderAttr.left.compareTime(i.borderAttr.right);if(c)return 1===l}return o.borderAttr.left.display}));n=n.concat(c)}}return n}},{key:"vrMergeLine",value:function(t){for(var e=this.borderOptimization,r=this.cells,n=[],o=0;o<t.length;o+=1){var i=t[o].right;if(i){var c=this.borderVRLine(i.view,i.x,i.y,(function(t,n){var o=r.getCell(n,t),i=r.getCell(n,t+1);if(!o)return!1;if(i&&e){var c=o.borderAttr.right.display&&i.borderAttr.left.display,l=o.borderAttr.right.compareTime(i.borderAttr.left);if(c)return 1===l||0===l}return o.borderAttr.right.display}));n=n.concat(c)}}return n}},{key:"openDrawOptimization",value:function(){this.drawOptimization=!0}},{key:"closeDrawOptimization",value:function(){this.drawOptimization=!1}},{key:"openBorderOptimization",value:function(){this.borderOptimization=!0}},{key:"closeBorderOptimization",value:function(){this.borderOptimization=!1}}])&&jf(e.prototype,r),n&&jf(e,n),t}();function Rf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Vf=function(){function t(e){var r=e.checked,n=void 0===r||r,o=e.merges,i=e.rows,c=e.cols,l=e.cells,s=e.lineHandle,a=e.getWidth,u=void 0===a?function(t){return c.getWidth(t)}:a,f=e.getHeight,h=void 0===f?function(t){return i.getHeight(t)}:f;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.checked=n,this.merges=o,this.rows=i,this.cols=c,this.cells=l,this.lineHandle=s,this.getWidth=u,this.getHeight=h}var e,r,n;return e=t,(r=[{key:"vLineBorderChecked",value:function(t,e){var r=this.cells,n=r.getMergeCellOrCell(e,t),o=r.getMergeCellOrCell(e,t+1);return n&&o?!(n.borderAttr.right.display||o.borderAttr.left.display):n?!n.borderAttr.right.display:!o||!o.borderAttr.left.display}},{key:"hLineBorderChecked",value:function(t,e){var r=this.cells,n=r.getMergeCellOrCell(t,e),o=r.getMergeCellOrCell(t+1,e);return n&&o?!(n.borderAttr.bottom.display||o.borderAttr.top.display):n?!n.borderAttr.bottom.display:!o||!o.borderAttr.top.display}},{key:"gridHLine",value:function(t){var e,r,n,o,i,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},a=this.lineHandle,u=this.getHeight,f=this.getWidth,h=[];return a.hEach({viewRange:t,newRow:function(t,s){var a=u(t);n=e=c,o=r=l+s+a,i=!1},filter:s,jump:function(t,c){i&&(i=!1,h.push({sx:e,sy:r,ex:n,ey:o}));var l=f(c);n=e=n+l},handle:function(t,e){i=!0;var r=f(e);n+=r},endRow:function(){i&&h.push({sx:e,sy:r,ex:n,ey:o})}}),h}},{key:"gridVLine",value:function(t){var e,r,n,o,i,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},a=this.lineHandle,u=this.getHeight,f=this.getWidth,h=[];return a.vEach({viewRange:t,newCol:function(t,s){var a=f(t);n=e=c+s+a,o=r=l,i=!1},filter:s,jump:function(t,c){i&&(i=!1,h.push({sx:e,sy:r,ex:n,ey:o}));var l=u(c);o=r=o+l},handle:function(t,e){i=!0;var r=u(e);o+=r},endCol:function(){i&&h.push({sx:e,sy:r,ex:n,ey:o})}}),h}},{key:"hLine",value:function(t){var e=this,r=this.merges;return this.checked?this.gridHLine(t,0,0,(function(t,n){return!r.getFirstIncludes(t,n)&&e.hLineBorderChecked(t,n)})):this.gridHLine(t,0,0)}},{key:"vLine",value:function(t){var e=this,r=this.merges,n=this.lineHandle;return this.checked?this.gridVLine(t,0,0,(function(t,o){return!r.getFirstIncludes(o,t)&&!1!==e.vLineBorderChecked(t,o)&&n.vLineRightBoundOut(t,o)})):this.gridVLine(t,0,0)}},{key:"hMergeLine",value:function(t){var e=this,r=[];if(this.checked)for(var n=0;n<t.length;n+=1){var o=t[n].bottom;if(o){var i=o.view,c=o.x,l=o.y,s=this.gridHLine(i,c,l,(function(t,r){return e.hLineBorderChecked(t,r)}));r=r.concat(s)}}else for(var a=0;a<t.length;a+=1){var u=t[a].bottom;if(u){var f=u.view,h=u.x,p=u.y,y=this.gridHLine(f,h,p);r=r.concat(y)}}return r}},{key:"vMergeLine",value:function(t){var e=this,r=[];if(this.checked)for(var n=0;n<t.length;n+=1){var o=t[n].right;if(o){var i=o.view,c=o.x,l=o.y,s=this.gridVLine(i,c,l,(function(t,r){return e.vLineBorderChecked(t,r)}));r=r.concat(s)}}else for(var a=0;a<t.length;a+=1){var u=t[a].right;if(u){var f=u.view,h=u.x,p=u.y,y=this.gridVLine(f,h,p);r=r.concat(y)}}return r}}])&&Rf(e.prototype,r),n&&Rf(e,n),t}();function Nf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Mf=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,n=[{key:"dateFormat",value:function(t,e){var r={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()},n=/(y+)/.exec(t);if(n){var o=n[0],i=e.getFullYear().toString().substr(4-o.length);t=t.replace(o,i)}for(var c in r){var l=new RegExp("(".concat(c,")")).exec(t);if(l){var s=r[c].toString(),a=l[0],u=1===a.length?s:"00".concat(s).substr(s.length);t=t.replace(a,u)}}return t}},{key:"parserToDate",value:function(t,e){if(!t)return null;for(var r=new Date("1970/01/01 00:00:00"),n=[{reg:"y+"},{reg:"M+"},{reg:"d+"},{reg:"h+"},{reg:"m+"},{reg:"s+"},{reg:"S"}],o=r.getFullYear(),i=r.getMonth()+1,c=r.getDate(),l=r.getHours(),s=r.getMinutes(),a=r.getSeconds(),u=r.getMilliseconds(),f=1,h=0;h<e.length;h+=1)for(var p=e[h],y=0;y<n.length;y+=1){var b=n[y];if(b.reg[0]===p){b.index||(b.index=f,f+=1);break}}for(var d=0;d<n.length;d+=1){var v=n[d].reg,g=new RegExp("(".concat(v,")")).exec(e);if(g){var w=g[0],m="([0-9]{1,".concat(w.length,"})");e=e.replace(w,m)}}var O={},S=new RegExp(e).exec(t);if(!S)return null;for(var E=1;E<S.length;E+=1)O[E]=S[E];return n[0].index&&(o=O[n[0].index]),n[1].index&&(i=O[n[1].index]),n[2].index&&(c=O[n[2].index]),n[3].index&&(l=O[n[3].index]),n[4].index&&(s=O[n[4].index]),n[5].index&&(a=O[n[5].index]),n[6].index&&(u=O[n[6].index]),new Date(o,i-1,c,l,s,a,u)}}],(r=null)&&Nf(e.prototype,r),n&&Nf(e,n),t}();function Wf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Hf(t){var e=Mf.parserToDate(t,"yyyy/MM/dd hh:mm:ss");return e||((e=Mf.parserToDate(t,"yyyy/MM/dd"))?e:(e=Mf.parserToDate(t,"hh:mm:ss"))?e:(e=Mf.parserToDate(t,"MM月dd日"))?e:(e=Mf.parserToDate(t,"yyyy年MM月"))?e:(e=Mf.parserToDate(t,"yyyy年MM月dd日"))||null)}var Df=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,(r=[{key:"default",value:function(t){return t}},{key:"text",value:function(t){return t}},{key:"number",value:function(t){if(x.isNumber(t)){if(-1!==t.toString().indexOf(".")){var e=t.toString().lastIndexOf(".")+1;return t.toString().substring(0,e+2)}return"".concat(t,".00")}return t}},{key:"percentage",value:function(t){return x.isNumber(t)?"".concat(t,"%"):t}},{key:"fraction",value:function(t){if(x.isFraction(t)){var e=t.split("/")[0],r=t.split("/")[1];return x.parseInt(e)/x.parseInt(r)}return t}},{key:"ENotation",value:function(t){return x.isNumber(t)?x.parseFloat(t).toExponential(2):t}},{key:"rmb",value:function(t){return x.isNumber(t)?"￥".concat(t):t}},{key:"hk",value:function(t){return x.isNumber(t)?"HK".concat(t):t}},{key:"dollar",value:function(t){return x.isNumber(t)?"$".concat(t):t}},{key:"date1",value:function(t){var e=Hf(t);return e?Mf.dateFormat("yyyy/MM/dd",e):t}},{key:"date2",value:function(t){var e=Hf(t);return e?Mf.dateFormat("MM月dd日",e):t}},{key:"date3",value:function(t){var e=Hf(t);return e?Mf.dateFormat("yyyy年MM月",e):t}},{key:"date4",value:function(t){var e=Hf(t);return e?Mf.dateFormat("yyyy年MM月dd日",e):t}},{key:"date5",value:function(t){var e=Hf(t);return e?Mf.dateFormat("yyyy/MM/dd hh:mm:ss",e):t}},{key:"time",value:function(t){var e=Hf(t);return e?Mf.dateFormat("hh:mm:ss",e):t}}])&&Wf(e.prototype,r),n&&Wf(e,n),t}()),Bf=function(t,e){return Df[t](e)};function If(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Yf=function(){function t(e){var r=e.rect,n=e.draw;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.draw=n,this.rect=r,this.backgroundColor=null}var e,r,n;return e=t,(r=[{key:"drawBackgroundColor",value:function(t){if(t&&(this.backgroundColor=t,t)){var e=this.draw,r=this.rect;e.attr({fillStyle:t}),e.fillRect(r.x,r.y,r.width,r.height)}}}])&&If(e.prototype,r),n&&If(e,n),t}();function Ff(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Uf=function(){function t(e){var r=e.merges,n=e.cols,o=e.rows,i=e.data,c=void 0===i?[]:i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.merges=r,this.cols=n,this.rows=o,this.data=c}var e,r,n;return e=t,(r=[{key:"getCellBoundOutSize",value:function(t,e){var r=this.cols,n=this.getCell(t,e);if(n){var o=r.getWidth(e),i=n.contentWidth;switch(n.fontAttr.align){case nl.right:case nl.left:return i;case nl.center:return o+(i-o)/2;default:return 0}}return 0}},{key:"getCell",value:function(t,e){var r=this.data[t];if(r&&r[e]){var n=r[e];return n instanceof _a?r[e]:(x.isString(n)&&(n={text:n}),r[e]=new _a(n),r[e])}return null}},{key:"getMergeCellMasterOrCell",value:function(t,e){var r=this.merges.getFirstIncludes(t,e);return r?r.sri===t&&r.sci===e?this.getCell(t,e):null:this.getCell(t,e)}},{key:"getMergeCellOrCell",value:function(t,e){var r=this.merges.getFirstIncludes(t,e);return r?this.getCell(r.sri,r.sci):this.getCell(t,e)}},{key:"getCellOrNew",value:function(t,e){return x.isUnDef(this.data[t])&&(this.data[t]=[]),x.isUnDef(this.data[t][e])&&(this.data[t][e]={text:""}),this.getCell(t,e)}},{key:"setCell",value:function(t,e,r){var n=this.data[t];n&&n[e]&&(n[e]=r)}},{key:"setCellOrNew",value:function(t,e,r){x.isUnDef(this.data[t])&&(this.data[t]=[]),this.data[t][e]=r}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.data=t,this}}])&&Ff(e.prototype,r),n&&Ff(e,n),t}();function zf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Gf=function(){function t(e){var r=e.scaleAdapter,n=void 0===r?new mf:r,o=e.height,i=void 0===o?33:o,c=e.width,l=void 0===c?50:c,s=e.background,a=void 0===s?"#f6f7fa":s,u=e.color,f=void 0===u?"#585757":u,h=e.size,p=void 0===h?11:h,y=e.gridColor,b=void 0===y?"#e8e8e8":y;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scaleAdapter=n,this.height=i,this.width=l,this.background=a,this.color=f,this.size=p,this.gridColor=b}var e,r,n;return e=t,(r=[{key:"getGridColor",value:function(){return this.gridColor}},{key:"getColor",value:function(){return this.color}},{key:"getSize",value:function(){var t=this.scaleAdapter,e=this.size;return t.goto(e)}},{key:"getBackground",value:function(){return this.background}},{key:"getHeight",value:function(){var t=this.scaleAdapter,e=this.height;return t.goto(e)}},{key:"getWidth",value:function(){var t=this.scaleAdapter,e=this.width;return t.goto(e)}}])&&zf(e.prototype,r),n&&zf(e,n),t}();function Xf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Kf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function qf(t,e,r){return e&&Kf(t.prototype,e),r&&Kf(t,r),t}var $f=function(){function t(e){var r=e.scaleAdapter;Xf(this,t),this.scaleAdapter=r,this.text=null,this.rect=null,this.attr=null,this.dw=null,this.overflow=null}return qf(t,[{key:"setDraw",value:function(t){this.dw=t}},{key:"setText",value:function(t){this.text=t}},{key:"setRect",value:function(t){this.rect=t}},{key:"setAttr",value:function(t){this.attr=t}},{key:"setOverFlow",value:function(t){this.overflow=t}},{key:"build",value:function(){var t=this.text,e=this.rect,r=this.attr,n=this.overflow,o=this.dw,i=this.scaleAdapter,c=new fl({dw:o,text:t,rect:e,attr:r,overflow:n});return c.setPadding(i.goto(r.padding)),c.setSize(i.goto(r.size)),c}}]),t}(),Zf=function(){function t(e){var r=e.scaleAdapter,n=void 0===r?new mf:r;Xf(this,t),this.scaleAdapter=n}return qf(t,[{key:"getBuilder",value:function(){var t=this.scaleAdapter;return new $f({scaleAdapter:t})}}]),t}();function Jf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Qf=function(){function t(e){var r=e.cells,n=e.merges,o=e.rows,i=e.cols,c=e.scale;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cells=r,this.merges=n,this.rows=o,this.cols=i,this.scale=c}var e,r,n;return e=t,(r=[{key:"getCellTextMaxHeight",value:function(t,e){var r=this.cells,n=this.rows,o=r.getCell(t,e).fontAttr.verticalAlign,i=0,c=0;if(o===ol.top)for(var l=t,s=n.len;l<=s;l+=1){var a=r.getCell(l,e);if(l===e)i+=n.getHeight(l);else{if(!x.isUnDef(a)&&!x.isBlank(a.text))break;i+=n.getHeight(l)}}if(o===ol.center){for(var u=t,f=n.len;u<=f;u+=1){var h=r.getCell(u,e);if(u===e)i+=n.getHeight(u);else{if(!x.isUnDef(h)&&!x.isBlank(h.text))break;i+=n.getHeight(u)}}for(var p=t-1;p>=0;p-=1){var y=r.getCell(t,p);if(!x.isUnDef(y)&&!x.isBlank(y.text))break;var b=n.getHeight(p);i+=b,c-=b}}if(o===ol.bottom)for(var d=t;d>=0;d-=1){var v=r.getCell(t,d);if(d===e)i+=n.getHeight(d);else{if(!x.isUnDef(v)&&!x.isBlank(v.text))break;var g=n.getHeight(d);i+=g,c-=g}}return{height:i,offset:c}}},{key:"getCellTextMaxWidth",value:function(t,e){var r=this.cells,n=this.cols,o=this.merges,i=r.getCell(t,e).fontAttr.align,c=0,l=0;if(i===nl.left)for(var s=e,a=n.len;s<=a;s+=1){var u=r.getCell(t,s),f=o.getFirstIncludes(t,s);if(s===e)c+=n.getWidth(s);else{if(!x.isUnDef(u)&&!x.isBlank(u.text)||!x.isUnDef(f))break;c+=n.getWidth(s)}}if(i===nl.center){for(var h=0,p=0,y=e+1,b=n.len;y<=b;y+=1){var d=r.getCell(t,y),v=o.getFirstIncludes(t,y);if(!x.isUnDef(d)&&!x.isBlank(d.text)||!x.isUnDef(v))break;h+=n.getWidth(y)}for(var g=e-1;g>=0;g-=1){var w=r.getCell(t,g),m=o.getFirstIncludes(t,g);if(!x.isUnDef(w)&&!x.isBlank(w.text)||!x.isUnDef(m))break;var O=n.getWidth(g);p+=O,l-=O}c=n.getWidth(e)+p+h}if(i===nl.right)for(var S=e;S>=0;S-=1){var E=r.getCell(t,S),_=o.getFirstIncludes(t,S);if(S===e)c+=n.getWidth(S);else{if(!x.isUnDef(E)&&!x.isBlank(E.text)||!x.isUnDef(_))break;var k=n.getWidth(S);c+=k,l-=k}}return{width:c,offset:l}}},{key:"getCellOverFlow",value:function(t,e,r,n){var o=n.fontAttr,i=o.direction,c=o.textWrap,l=r.x,s=r.y,a=r.width,u=r.height;if(c===il.OVER_FLOW){if(i===cl.VERTICAL){var f=this.getCellTextMaxHeight(t,e);return new Lc({x:l,y:s+f.offset,width:a,height:f.height})}var h=this.getCellTextMaxWidth(t,e);return new Lc({x:l+h.offset,y:s,width:h.width,height:u})}return null}}])&&Jf(e.prototype,r),n&&Jf(e,n),t}();function th(t){return(th="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function rh(t,e){return!e||"object"!==th(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nh(t){return(nh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oh(t,e){return(oh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ih=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),rh(this,nh(e).apply(this,arguments))}var r,n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oh(t,e)}(e,t),r=e,(n=[{key:"getCellByViewRange",value:function(t){for(var e=t.rectRange,r=t.callback,n=t.startX,o=void 0===n?0:n,i=t.startY,c=void 0===i?0:i,l=this.rows,s=this.cols,a=this.cells,u=e.sri,f=e.eri,h=e.sci,p=e.eci,y=c,b=u;b<=f;b+=1){for(var d=l.getHeight(b),v=o,g=h;g<=p;g+=1){var w=s.getWidth(g),m=a.getCell(b,g);if(m){var O=new Lc({x:v,y:y,width:w,height:d});if(!1===r(b,g,m,O,this.getCellOverFlow(b,g,O,m)))return}v+=w}y+=d}}},{key:"getCellOrNewCellByViewRange",value:function(t){for(var e=t.rectRange,r=t.callback,n=t.startX,o=void 0===n?0:n,i=t.startY,c=void 0===i?0:i,l=this.rows,s=this.cols,a=this.cells,u=e.sri,f=e.eri,h=e.sci,p=e.eci,y=c,b=u;b<=f;b+=1){for(var d=l.getHeight(b),v=o,g=h;g<=p;g+=1){var w=s.getWidth(g),m=a.getCellOrNew(b,g),O=new Lc({x:v,y:y,width:w,height:d});if(!1===r(b,g,m,O,this.getCellOverFlow(b,g,O,m)))return;v+=w}y+=d}}},{key:"getMergeCellByViewRange",value:function(t){for(var e=t.rectRange,r=t.callback,n=t.startX,o=void 0===n?0:n,i=t.startY,c=void 0===i?0:i,l=this.rows,s=this.cols,a=this.cells,u=this.merges,f=e.sri,h=e.eri,p=e.sci,y=e.eci,b=[],d=f;d<=h;d+=1)for(var v=function(t){var n=u.getFirstIncludes(d,t);if(x.isUnDef(n)||b.find((function(t){return t===n})))return"continue";var i=Math.min(e.sri,n.sri),f=Math.min(e.sci,n.sci),h=Math.max(e.sri,n.sri),p=Math.max(e.sci,n.sci);h-=1,p-=1;var y=s.sectionSumWidth(f,p),v=l.sectionSumHeight(i,h);y=e.sci>n.sci?-1*y:y,v=e.sri>n.sri?-1*v:v,y+=o,v+=c;var g=l.sectionSumHeight(n.sri,n.eri),w=s.sectionSumWidth(n.sci,n.eci),m=a.getCellOrNew(n.sri,n.sci),O=new Lc({x:y,y:v,width:w,height:g});r(O,m,n),b.push(n)},g=p;g<=y;g+=1)v(g)}},{key:"getCellSkipMergeCellByViewRange",value:function(t){var e=t.rectRange,r=t.callback,n=t.startX,o=void 0===n?0:n,i=t.startY,c=void 0===i?0:i,l=this.merges;this.getCellByViewRange({rectRange:e,callback:function(t,e,n,o,i){null===l.getFirstIncludes(t,e)&&r(t,e,n,o,i)},startX:o,startY:c})}}])&&eh(r.prototype,n),o&&eh(r,o),e}(Qf);function ch(t){return(ch="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function sh(t,e){return!e||"object"!==ch(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ah(t){return(ah=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function uh(t,e){return(uh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fh=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),sh(this,ah(e).apply(this,arguments))}var r,n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&uh(t,e)}(e,t),r=e,(n=[{key:"getCellByViewRange",value:function(t){var e=t.reverseRows,r=void 0!==e&&e,n=t.reverseCols,o=void 0!==n&&n,i=t.rectRange,c=t.callback,l=t.startX,s=void 0===l?0:l,a=t.startY,u=void 0===a?0:a,f=this.rows,h=this.cols,p=this.cells,y=this.scale,b=i.sri,d=i.eri,v=i.sci,g=i.eci;if(r&&o)for(var w=u,m=d;b<=m;m-=1){for(var O=f.getHeight(m),S=s,E=g;v<=E;E-=1){var x=h.getWidth(E),_=p.getCell(m,E);if(_){y.useFloat();var k=new Lc({x:S,y:w,width:h.getWidth(E),height:O});if(y.notFloat(),!1===c(m,E,_,k,this.getCellOverFlow(m,E,k,_)))return}S-=x}w-=O}else if(r)for(var T=u,C=d;b<=C;C-=1){for(var A=f.getHeight(C),P=s,j=v;j<=g;j+=1){var L=h.getWidth(j),R=p.getCell(C,j);if(R){y.useFloat();var V=new Lc({x:P,y:T,width:h.getWidth(j),height:A});if(y.notFloat(),!1===c(C,j,R,V,this.getCellOverFlow(C,j,V,R)))return}P+=L}T-=A}else if(o)for(var N=u,M=b;M<=d;M+=1){for(var W=f.getHeight(M),H=s,D=g;v<=D;D-=1){var B=h.getWidth(D),I=p.getCell(M,D);if(I){y.useFloat();var Y=new Lc({x:H,y:N,width:h.getWidth(D),height:W});if(y.notFloat(),!1===c(M,D,I,Y,this.getCellOverFlow(M,D,Y,I)))return}H-=B}N+=W}else for(var F=u,U=b;U<=d;U+=1){for(var z=f.getHeight(U),G=s,X=v;X<=g;X+=1){var K=h.getWidth(X),q=p.getCell(U,X);if(q){y.useFloat();var $=new Lc({x:G,y:F,width:h.getWidth(X),height:z});if(y.notFloat(),!1===c(U,X,q,$,this.getCellOverFlow(U,X,$,q)))return}G+=K}F+=z}}},{key:"getMergeCellByViewRange",value:function(t){for(var e=t.rectRange,r=t.callback,n=t.startX,o=void 0===n?0:n,i=t.startY,c=void 0===i?0:i,l=this.rows,s=this.cols,a=this.cells,u=this.merges,f=this.scale,h=e.sri,p=e.eri,y=e.sci,b=e.eci,d=[],v=h;v<=p;v+=1)for(var g=function(t){var n=u.getFirstIncludes(v,t);if(x.isUnDef(n)||d.find((function(t){return t===n})))return"continue";var i=Math.min(e.sri,n.sri),h=Math.min(e.sci,n.sci),p=Math.max(e.sri,n.sri),y=Math.max(e.sci,n.sci);p-=1,y-=1;var b=s.sectionSumWidth(h,y),g=l.sectionSumHeight(i,p);b=e.sci>n.sci?-1*b:b,g=e.sri>n.sri?-1*g:g,b+=o,g+=c;var w=l.sectionSumHeight(n.sri,n.eri);f.useFloat();var m=s.sectionSumWidth(n.sci,n.eci);f.notFloat();var O=a.getCellOrNew(n.sri,n.sci),S=new Lc({x:b,y:g,width:m,height:w});r(S,O,n),d.push(n)},w=y;w<=b;w+=1)g(w)}},{key:"getCellSkipMergeCellByViewRange",value:function(t){var e=t.reverseRows,r=void 0!==e&&e,n=t.reverseCols,o=void 0!==n&&n,i=t.rectRange,c=t.callback,l=t.startX,s=void 0===l?0:l,a=t.startY,u=void 0===a?0:a,f=this.merges;this.getCellByViewRange({reverseRows:r,reverseCols:o,rectRange:i,callback:function(t,e,r,n,o){null===f.getFirstIncludes(t,e)&&c(t,e,r,n,o)},startX:s,startY:u})}}])&&lh(r.prototype,n),o&&lh(r,o),e}(Qf);function hh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var ph=function(){function t(e){var r=e.merges,n=void 0===r?[]:r,o=e.cols,i=e.rows;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rows=i,this.cols=o,this.data=n.map((function(t){return Qs.valueOf(t)})),this.index=new Array(i.len*o.len)}var e,r,n;return e=t,(r=[{key:"getIncludes",value:function(t,e){var r=this,n=this.index,o=this.data;t.each((function(t,i){var c=r.getOffset(t,i),l=n[c];x.isNotUnDef(l)&&e(o[l])}))}},{key:"getOffset",value:function(t,e){return t*this.cols.len+e}},{key:"getFirstIncludes",value:function(t,e){var r=this.index,n=this.data,o=r[this.getOffset(t,e)];if(x.isUnDef(o))return null;var i=n[o];return x.isUnDef(i)?null:i}},{key:"add",value:function(t){var e=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.index,o=this.data;r&&this.getIncludes(t,(function(t){return e.delete(t)}));var i=o.length;o.push(t),t.each((function(t,r){var o=e.getOffset(t,r);n[o]=i}))}},{key:"delete",value:function(t){var e=this,r=this.index,n=this.data,o=t.sri,i=t.sci,c=this.getOffset(o,i),l=r[c];x.isUnDef(l)||(n.splice(l,1),t.each((function(t,n){var o=e.getOffset(t,n);r[o]=void 0})),this.sync(l))}},{key:"union",value:function(t){for(var e=this,r=t,n=[],o=function(t){var o=e.data[t];if(n.find((function(t){return t===o})))return i=t,"continue";o.intersects(r)&&(n.push(o),r=o.union(r),t=-1),i=t},i=0;i<this.data.length;i+=1)o(i);return r}},{key:"sync",value:function(){for(var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=this.index,n=this.data,o=function(e){n[e].each((function(n,o){var i=t.getOffset(n,o);r[i]=e}))},i=e;i<n.length;i+=1)o(i)}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(t){this.data=t}}])&&hh(e.prototype,r),n&&hh(e,n),t}();function yh(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(n=(c=l.next()).done)&&(r.push(c.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==l.return||l.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function bh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function vh(t,e,r){return e&&dh(t.prototype,e),r&&dh(t,r),t}var gh={CHANGE_ADD:Symbol("change_add"),CHANGE_NOT:Symbol("change_not"),STATIC:Symbol("static"),BOUND_OUT:Symbol("bound_out")},wh=function(){function t(e){var r=e.scroll,n=e.rows,o=e.cols,i=e.getHeight,c=void 0===i?function(){return 0}:i,l=e.getWidth,s=void 0===l?function(){return 0}:l;bh(this,t),this.scroll=r,this.rows=n,this.cols=o,this.getHeight=c,this.getWidth=s}return vh(t,null,[{key:"viewMode",value:function(t,e){return x.isUnDef(t)?gh.CHANGE_NOT:e.equals(t)?gh.STATIC:e.coincide(t).equals(Qs.EMPTY)?gh.BOUND_OUT:e.within(t)?gh.CHANGE_NOT:gh.CHANGE_ADD}}]),vh(t,[{key:"getScrollView",value:function(){for(var t=this.rows,e=this.cols,r=this.scroll,n=this.getHeight,o=this.getWidth,i=0,c=0,l=r.ri,s=r.ci,a=[t.len,e.len],u=a[0],f=a[1],h=l;h<t.len&&(u=h,!((c+=t.getHeight(h))>n()));h+=1);for(var p=s;p<e.len&&(f=p,!((i+=e.getWidth(p))>o()));p+=1);return new Qs(l,s,u,f)}}]),t}(),mh=function(){function t(e){var r=e.xTableScrollView,n=e.rows,o=e.cols,i=e.scroll;bh(this,t),this.xTableScrollView=r,this.scroll=i,this.rows=n,this.cols=o,this.lastScrollView=null,this.scrollView=null,this.scrollEnterView=null,this.enterView=null,this.leaveView=null}return vh(t,[{key:"record",value:function(){this.lastScrollView=this.scrollView}},{key:"undo",value:function(){this.lastScrollView=null}},{key:"reset",value:function(){this.scrollView=null,this.scrollEnterView=null,this.enterView=null,this.leaveView=null}},{key:"getLastScrollView",value:function(){return x.isNotUnDef(this.lastScrollView)?this.lastScrollView.clone():null}},{key:"getScrollView",value:function(){if(x.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.xTableScrollView,e=this.cols,r=this.rows,n=t.getScrollView();return n.w=e.rectRangeSumWidth(n),n.h=r.rectRangeSumHeight(n),this.scrollView=n,n.clone()}},{key:"getLeaveView",value:function(){if(x.isNotUnDef(this.leaveView))return this.leaveView.clone();var t=this.getLastScrollView(),e=this.getScrollView(),r=this.cols,n=this.rows;if(t){var o=yh(t.coincideDifference(e),1)[0];if(o)return o.w=r.rectRangeSumWidth(o),o.h=n.rectRangeSumHeight(o),this.leaveView=o,o.clone()}return null}},{key:"getEnterView",value:function(){if(x.isNotUnDef(this.enterView))return this.enterView.clone();var t=this.getLastScrollView(),e=this.getScrollView(),r=this.cols,n=this.rows;if(t){var o=yh(e.coincideDifference(t),1)[0];if(o)return o.w=r.rectRangeSumWidth(o),o.h=n.rectRangeSumHeight(o),this.enterView=o,o.clone()}return null}},{key:"getScrollEnterView",value:function(){if(x.isNotUnDef(this.scrollEnterView))return this.scrollEnterView.clone();var t=this.cols,e=this.rows,r=this.scroll,n=this.getEnterView();if(n){switch(r.type){case _f.H_RIGHT:n.sci-=1;break;case _f.V_BOTTOM:n.sri-=1;break;case _f.H_LEFT:n.eci+=1;break;case _f.V_TOP:n.eri+=1}return n.w=t.rectRangeSumWidth(n),n.h=e.rectRangeSumHeight(n),this.scrollEnterView=n,n.clone()}return null}}]),t}();function Oh(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Sh(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Oh(Object(r),!0).forEach((function(e){Eh(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Oh(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Eh(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xh(t,e,r){return(xh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ch(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function _h(t){return(_h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kh(t,e){return!e||"object"!==_h(e)&&"function"!=typeof e?Th(t):e}function Th(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ch(t){return(Ch=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ah(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ph(t,e)}function Ph(t,e){return(Ph=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function jh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Rh(t,e,r){return e&&Lh(t.prototype,e),r&&Lh(t,r),t}var Vh={SCROLL:Symbol("scroll"),RENDER:Symbol("render"),SCALE:Symbol("scale")},Nh=function(){function t(e){jh(this,t),this.table=e,this.width=null,this.height=null,this.x=null,this.y=null,this.drawX=null,this.drawY=null,this.mapOriginX=null,this.mapOriginY=null,this.mapTargetX=null,this.mapTargetY=null,this.mapWidth=null,this.mapHeight=null,this.fullScrollView=null,this.scrollView=null,this.borderView=null,this.borderX=null,this.borderY=null,this.viewMode=null}return Rh(t,[{key:"reset",value:function(){this.width=null,this.height=null,this.x=null,this.y=null,this.drawX=null,this.drawY=null,this.mapOriginX=null,this.mapOriginY=null,this.mapTargetX=null,this.mapTargetY=null,this.mapWidth=null,this.mapHeight=null,this.fullScrollView=null,this.scrollView=null,this.borderView=null,this.borderX=null,this.borderY=null,this.viewMode=null}},{key:"getWidth",value:function(){throw new TypeError("getWidth child impl")}},{key:"getHeight",value:function(){throw new TypeError("getHeight child impl")}},{key:"getX",value:function(){throw new TypeError("getX child impl")}},{key:"getY",value:function(){throw new TypeError("getY child impl")}},{key:"getDrawX",value:function(){if(x.isNumber(this.drawX))return this.drawX;var t=this.table,e=this.getX();if(t.getRenderMode()===Vh.RENDER)return this.drawX=e,e;if(t.getRenderMode()===Vh.SCALE)return this.drawX=e,e;if(this.getViewMode()===gh.BOUND_OUT)return this.drawX=e,e;if(this.getViewMode()===gh.CHANGE_NOT)return this.drawX=e,e;var r=t.scroll,n=this.getScrollView(),o=this.getFullScrollView(),i=0;switch(r.type){case _f.H_RIGHT:i=o.w-n.w;break;case _f.H_LEFT:i=0}return i=e+i,this.drawX=i,i}},{key:"getDrawY",value:function(){if(x.isNumber(this.drawY))return this.drawY;var t=this.table,e=this.getY();if(t.getRenderMode()===Vh.RENDER)return this.drawY=e,e;if(t.getRenderMode()===Vh.SCALE)return this.drawY=e,e;if(this.getViewMode()===gh.BOUND_OUT)return this.drawY=e,e;if(this.getViewMode()===gh.CHANGE_NOT)return this.drawY=e,e;var r=t.scroll,n=this.getScrollView(),o=this.getFullScrollView(),i=0;switch(r.type){case _f.V_BOTTOM:i=o.h-n.h;break;case _f.V_TOP:i=0}return i=e+i,this.drawY=i,i}},{key:"getLineX",value:function(){if(x.isNumber(this.borderX))return this.borderX;var t=this.table,e=this.getX();if(t.getRenderMode()===Vh.RENDER)return this.borderX=e,e;if(t.getRenderMode()===Vh.SCALE)return this.borderX=e,e;if(this.getViewMode()===gh.BOUND_OUT)return this.borderX=e,e;if(this.getViewMode()===gh.CHANGE_NOT)return this.borderX=e,e;var r=0;switch(t.scroll.type){case _f.H_RIGHT:var n=this.getLineView();r=this.getFullScrollView().w-n.w;break;case _f.H_LEFT:r=0}return r=e+r,this.borderX=r,r}},{key:"getLineY",value:function(){if(x.isNumber(this.borderY))return this.borderY;var t=this.table,e=this.getY();if(t.getRenderMode()===Vh.RENDER)return this.borderY=e,e;if(t.getRenderMode()===Vh.SCALE)return this.borderY=e,e;if(this.getViewMode()===gh.BOUND_OUT)return this.borderY=e,e;if(this.getViewMode()===gh.CHANGE_NOT)return this.borderY=e,e;var r=0;switch(t.scroll.type){case _f.V_BOTTOM:var n=this.getLineView();r=this.getFullScrollView().h-n.h;break;case _f.V_TOP:r=0}return r=e+r,this.borderY=r,r}},{key:"getMapOriginX",value:function(){if(x.isNumber(this.mapOriginX))return this.mapOriginX;var t=this.table,e=t.xTableAreaView,r=t.scroll,n=this.getX(),o=0;switch(r.type){case _f.H_LEFT:o=0;break;case _f.H_RIGHT:o=e.getLeaveView().w}return o=n+o,this.mapOriginX=o,o}},{key:"getMapOriginY",value:function(){if(x.isNumber(this.mapOriginY))return this.mapOriginY;var t=this.table,e=t.xTableAreaView,r=t.scroll,n=this.getY(),o=0;switch(r.type){case _f.V_TOP:o=0;break;case _f.V_BOTTOM:o=e.getLeaveView().h}return o=n+o,this.mapOriginY=o,o}},{key:"getMapTargetX",value:function(){if(x.isNumber(this.mapTargetX))return this.mapTargetX;var t=this.table,e=t.xTableAreaView,r=t.scroll,n=this.getX(),o=0;switch(r.type){case _f.H_LEFT:o=e.getEnterView().w;break;case _f.H_RIGHT:o=0}return o=n+o,this.mapTargetX=o,o}},{key:"getMapTargetY",value:function(){if(x.isNumber(this.mapTargetY))return this.mapTargetY;var t=this.table,e=t.xTableAreaView,r=t.scroll,n=this.getY(),o=0;switch(r.type){case _f.V_TOP:o=e.getEnterView().h;break;case _f.V_BOTTOM:o=0}return o=n+o,this.mapTargetY=o,o}},{key:"getMapWidth",value:function(){if(x.isNumber(this.mapWidth))return this.mapWidth;var t=this.table,e=t.xTableAreaView,r=t.scroll,n=this.getWidth();switch(r.type){case _f.H_RIGHT:n-=e.getLeaveView().w;break;case _f.H_LEFT:n-=e.getEnterView().w}return this.mapWidth=n,n}},{key:"getMapHeight",value:function(){if(x.isNumber(this.mapHeight))return this.mapHeight;var t=this.table,e=t.xTableAreaView,r=t.scroll,n=this.getHeight();switch(r.type){case _f.V_BOTTOM:n-=e.getLeaveView().h;break;case _f.V_TOP:n-=e.getEnterView().h}return this.mapHeight=n,n}},{key:"getScrollView",value:function(){throw new TypeError("getScrollView child impl")}},{key:"getFullScrollView",value:function(){throw new TypeError("getFullScrollView child impl")}},{key:"getLineView",value:function(){if(x.isNotUnDef(this.borderView))return this.borderView.clone();var t=this.table,e=t.cols,r=t.rows,n=t.getRenderMode(),o=this.getViewMode(),i=this.getScrollView();if(o===gh.CHANGE_ADD&&n===Vh.SCROLL)switch(t.scroll.type){case _f.V_TOP:i.eri+=1,i.h=r.rectRangeSumHeight(i);break;case _f.V_BOTTOM:i.sri-=1,i.h=r.rectRangeSumHeight(i);break;case _f.H_RIGHT:i.sci-=1,i.w=e.rectRangeSumWidth(i);break;case _f.H_LEFT:i.eci+=1,i.w=e.rectRangeSumWidth(i)}return this.borderView=i,i.clone()}},{key:"getViewMode",value:function(){throw new TypeError("getViewMode child impl")}},{key:"drawMap",value:function(){var t=this.table,e=t.getRenderMode();if(this.getViewMode()===gh.CHANGE_ADD&&e===Vh.SCROLL){var r=t.draw,n=t.el,o=this.getMapWidth(),i=this.getMapHeight(),c=this.getMapOriginX(),l=this.getMapOriginY(),s=this.getMapTargetX(),a=this.getMapTargetY();r.drawImage(n,c,l,o,i,s,a,o,i)}}},{key:"drawClear",value:function(){var t=this.table,e=t.scroll,r=t.draw,n=t.settings,o=this.getViewMode(),i=t.getRenderMode(),c=this.getDrawX(),l=this.getDrawY();if(r.attr({fillStyle:n.table.background}),i===Vh.SCROLL)switch(o){case gh.CHANGE_NOT:case gh.STATIC:case gh.BOUND_OUT:var s=this.getHeight(),a=this.getWidth();r.fillRect(c,l,a,s);break;case gh.CHANGE_ADD:switch(e.type){case _f.V_BOTTOM:var u=this.getFullScrollView(),f=this.getScrollView(),h=t.visualHeight()-(u.h-f.h),p=this.getWidth();r.fillRect(c,l,p,h);break;case _f.V_TOP:var y=this.getScrollView().h,b=this.getWidth();r.fillRect(c,l,b,y);break;case _f.H_LEFT:var d=this.getScrollView(),v=this.getHeight(),g=d.w;r.fillRect(c,l,g,v);break;case _f.H_RIGHT:var w=this.getFullScrollView(),m=this.getScrollView(),O=this.getHeight(),S=t.visualWidth()-(w.w-m.w);r.fillRect(c,l,S,O)}}else if(Vh.RENDER){var E=this.getHeight(),x=this.getWidth();r.fillRect(c,l,x,E)}}}]),t}(),Mh=function(t){function e(){return jh(this,e),kh(this,Ch(e).apply(this,arguments))}return Ah(e,t),Rh(e,[{key:"drawBoundOutFont",value:function(){var t=this.getScrollView(),e=this.table,r=e.draw,n=e.cols,o=e.textCellsHelper,i=e.cells,c=e.textFont,l=e.scale,s=t.clone();if(s.sci=0,s.eci=t.sci-1,s.eci>-1){var a,u,f=this.getDrawX()-n.getWidth(s.eci),h=this.getDrawY();r.offset(f,h),o.getCellSkipMergeCellByViewRange({rectRange:s,reverseCols:!0,callback:function(t,e,n,o,s){t!==u&&(a=0,u=t),a+=o.width;var f=n.text,h=n.fontAttr,p=h.align,y=h.textWrap;if(!x.isBlank(f)&&p!==nl.right&&y===il.OVER_FLOW){var b=i.getCellBoundOutSize(t,e);if(0===b||b>a){var d=n.format,v=n.text,g=n.fontAttr;l.useFloat();var w=g.align,m=c.getBuilder();m.setDraw(r),m.setText(Bf(d,v)),m.setAttr(g),m.setRect(o),m.setOverFlow(s);var O=m.build();O.setOverflowCrop(w===nl.center),n.setContentWidth(O.draw()),l.notFloat()}}}}),r.offset(0,0)}var p=t.clone();if(p.sci=t.eci+1,p.eci=n.len-1,p.sci<n.len){var y,b,d=this.getDrawX()+t.w,v=this.getDrawY();r.offset(d,v),o.getCellSkipMergeCellByViewRange({rectRange:p,callback:function(t,e,n,o,s){t!==b&&(y=0,b=t),y+=o.width;var a=n.text,u=n.fontAttr,f=u.align,h=u.textWrap;if(!x.isBlank(a)&&f!==nl.left&&h===il.OVER_FLOW){var p=i.getCellBoundOutSize(t,e);if(0===p||p>y){var d=n.format,v=n.text,g=n.fontAttr;l.useFloat();var w=g.align,m=c.getBuilder();m.setDraw(r),m.setText(Bf(d,v)),m.setAttr(g),m.setRect(o),m.setOverFlow(s);var O=m.build();O.setOverflowCrop(w===nl.center),n.setContentWidth(O.draw()),l.notFloat()}}}}),r.offset(0,0)}}},{key:"drawFont",value:function(){var t=this.getScrollView(),e=this.getDrawX(),r=this.getDrawY(),n=this.table,o=n.draw,i=n.textCellsHelper,c=n.textFont,l=n.scale;o.offset(e,r),i.getCellSkipMergeCellByViewRange({rectRange:t,callback:function(t,e,r,n,i){var s=r.format,a=r.text,u=r.fontAttr;l.useFloat();var f=u.align,h=c.getBuilder();h.setDraw(o),h.setText(Bf(s,a)),h.setAttr(u),h.setRect(n),h.setOverFlow(i);var p=h.build();p.setOverflowCrop(f===nl.center),r.setContentWidth(p.draw()),l.notFloat()}}),i.getMergeCellByViewRange({rectRange:t,callback:function(t,e){var r=e.format,n=e.text,i=e.fontAttr;l.useFloat();var s=c.getBuilder();s.setDraw(o),s.setText(Bf(r,n)),s.setAttr(i),s.setRect(t);var a=s.build();a.setTextWrap(il.WORD_WRAP),e.setContentWidth(a.draw()),l.notFloat()}}),o.offset(0,0)}},{key:"drawBorder",value:function(){var t=this.getLineView(),e=this.getLineX(),r=this.getLineY(),n=this.table,o=n.draw,i=n.lineHandle,c=n.borderHandle,l=n.line;o.offset(e,r);var s=i.viewRangeAndMergeCoincideView({viewRange:t}),a=i.coincideViewBrink({coincideView:s}),u=c.htLine(t),f=c.hbLine(t),h=c.vlLine(t),p=c.vrLine(t);u.forEach((function(t){var e=t.borderAttr,r=t.row,n=t.col,o=e.top,i=o.color,c=o.width,s=o.type;l.setType(s),l.setColor(i),l.setWidth(c),l.drawLine(t.sx,t.sy,t.ex,t.ey,r,n,"top")})),f.forEach((function(t){var e=t.borderAttr,r=t.row,n=t.col,o=e.bottom,i=o.color,c=o.width,s=o.type;l.setType(s),l.setColor(i),l.setWidth(c),l.drawLine(t.sx,t.sy,t.ex,t.ey,r,n,"bottom")})),h.forEach((function(t){var e=t.borderAttr,r=t.row,n=t.col,o=e.left,i=o.color,c=o.width,s=o.type;l.setType(s),l.setColor(i),l.setWidth(c),l.drawLine(t.sx,t.sy,t.ex,t.ey,r,n,"left")})),p.forEach((function(t){var e=t.borderAttr,r=t.row,n=t.col,o=e.right,i=o.color,c=o.width,s=o.type;l.setType(s),l.setColor(i),l.setWidth(c),l.drawLine(t.sx,t.sy,t.ex,t.ey,r,n,"right")}));var y=c.htMergeLine(a),b=c.hbMergeLine(a),d=c.vlMergeLine(a),v=c.vrMergeLine(a);y.forEach((function(t){var e=t.borderAttr,r=t.row,n=t.col,o=e.top,i=o.color,c=o.width,s=o.type;l.setType(s),l.setColor(i),l.setWidth(c),l.drawLine(t.sx,t.sy,t.ex,t.ey,r,n,"top")})),b.forEach((function(t){var e=t.borderAttr,r=t.row,n=t.col,o=e.bottom,i=o.color,c=o.width,s=o.type;l.setType(s),l.setColor(i),l.setWidth(c),l.drawLine(t.sx,t.sy,t.ex,t.ey,r,n,"bottom")})),d.forEach((function(t){var e=t.borderAttr,r=t.row,n=t.col,o=e.left,i=o.color,c=o.width,s=o.type;l.setType(s),l.setColor(i),l.setWidth(c),l.drawLine(t.sx,t.sy,t.ex,t.ey,r,n,"left")})),v.forEach((function(t){var e=t.borderAttr,r=t.row,n=t.col,o=e.right,i=o.color,c=o.width,s=o.type;l.setType(s),l.setColor(i),l.setWidth(c),l.drawLine(t.sx,t.sy,t.ex,t.ey,r,n,"right")})),o.offset(0,0)}},{key:"drawGrid",value:function(){var t=this.getLineView(),e=this.getLineX(),r=this.getLineY(),n=this.table,o=n.draw,i=n.lineHandle,c=n.gridHandle,l=n.grid;o.offset(e,r);var s=i.viewRangeAndMergeCoincideView({viewRange:t}),a=i.coincideViewBrink({coincideView:s}),u=c.hLine(t),f=c.vLine(t);u.forEach((function(t){l.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),f.forEach((function(t){l.verticalLine(t.sx,t.sy,t.ex,t.ey)}));var h=c.hMergeLine(a),p=c.vMergeLine(a);h.forEach((function(t){l.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),p.forEach((function(t){l.verticalLine(t.sx,t.sy,t.ex,t.ey)})),o.offset(0,0)}},{key:"drawColor",value:function(){var t=this.getScrollView(),e=this.table,r=this.getDrawX(),n=this.getDrawY(),o=e.draw,i=e.styleCellsHelper;o.offset(r,n),i.getMergeCellByViewRange({rectRange:t,callback:function(t,e){var r=e.background;new Yf({draw:o,rect:t}).drawBackgroundColor(r)}}),i.getCellByViewRange({rectRange:t,callback:function(t,e,r,n){var i=r.background;new Yf({draw:o,rect:n}).drawBackgroundColor(i)}}),o.offset(0,0)}},{key:"render",value:function(){var t=this.table,e=t.getRenderMode();if(this.getViewMode()!==gh.STATIC||e!==Vh.SCROLL){this.drawMap(),this.drawClear();var r=this.getScrollView(),n=this.getDrawX(),o=this.getDrawY(),i=r.w,c=r.h,l=t.draw,s=new Pc({rect:new Lc({x:n,y:o,width:i,height:c}),draw:l});s.open(),this.drawColor(),this.drawFont(),this.drawBoundOutFont(),this.table.settings.table.showGrid&&this.drawGrid(),this.drawBorder(),s.close()}}}]),e}(Nh),Wh=function(t){function e(){return jh(this,e),kh(this,Ch(e).apply(this,arguments))}return Ah(e,t),Rh(e,[{key:"drawFont",value:function(){throw new TypeError("drawFont child impl")}},{key:"drawColor",value:function(){throw new TypeError("drawColor child impl")}},{key:"drawGrid",value:function(){throw new TypeError("drawGrid child impl")}},{key:"render",value:function(){var t=this.table.getRenderMode();this.getViewMode()===gh.STATIC&&t===Vh.SCROLL||(this.drawMap(),this.drawClear(),this.drawColor(),this.drawGrid(),this.drawFont())}}]),e}(Nh),Hh=function(t){function e(){return jh(this,e),kh(this,Ch(e).apply(this,arguments))}return Ah(e,t),Rh(e,[{key:"drawFont",value:function(){var t=this.getDrawX(),e=this.getDrawY(),r=this.getScrollView(),n=this.getWidth(),o=this.table,i=o.draw,c=o.rows,l=o.index,s=r.sri,a=r.eri;i.offset(t,e),i.attr({textAlign:"center",textBaseline:"middle",font:"".concat(l.getSize(),"px Arial"),fillStyle:l.getColor()}),c.eachHeight(s,a,(function(t,e,r){i.fillText(t+1,n/2,r+e/2)})),i.offset(0,0)}},{key:"drawGrid",value:function(){var t=this.getLineView(),e=this.getLineX(),r=this.getLineY(),n=this.table,o=n.draw,i=n.leftIdxGridHandle,c=n.indexGrid;o.offset(e,r);var l=i.hLine(t),s=i.vLine(t);l.forEach((function(t){c.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),s.forEach((function(t){c.verticalLine(t.sx,t.sy,t.ex,t.ey)})),o.offset(0,0)}},{key:"drawColor",value:function(){var t=this.getDrawX(),e=this.getDrawY(),r=this.getScrollView().h,n=this.getWidth(),o=this.table,i=o.draw,c=o.index;i.offset(t,e),i.attr({fillStyle:c.getBackground()}),i.fillRect(0,0,n,r),i.offset(0,0)}}]),e}(Wh),Dh=function(t){function e(){return jh(this,e),kh(this,Ch(e).apply(this,arguments))}return Ah(e,t),Rh(e,[{key:"drawFont",value:function(){var t=this.getDrawX(),e=this.getDrawY(),r=this.getScrollView(),n=this.getHeight(),o=this.table,i=o.draw,c=o.cols,l=o.index,s=r.sci,a=r.eci;i.offset(t,e),i.attr({textAlign:"center",textBaseline:"middle",font:"".concat(l.getSize(),"px Arial"),fillStyle:l.getColor()}),c.eachWidth(s,a,(function(t,e,r){i.fillText(x.stringAt(t),r+e/2,n/2)})),i.offset(0,0)}},{key:"drawGrid",value:function(){var t=this.getLineView(),e=this.getLineX(),r=this.getLineY(),n=this.table,o=n.draw,i=n.topIdxGridHandle,c=n.indexGrid;o.offset(e,r);var l=i.hLine(t),s=i.vLine(t);l.forEach((function(t){c.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),s.forEach((function(t){c.verticalLine(t.sx,t.sy,t.ex,t.ey)})),o.offset(0,0)}},{key:"drawColor",value:function(){var t=this.table,e=t.draw,r=t.index,n=this.getScrollView(),o=this.getDrawX(),i=this.getDrawY(),c=this.getHeight(),l=n.w;e.offset(o,i),e.attr({fillStyle:r.getBackground()}),e.fillRect(0,0,l,c),e.offset(0,0)}}]),e}(Wh),Bh=function(t){function e(){return jh(this,e),kh(this,Ch(e).apply(this,arguments))}return Ah(e,t),Rh(e,[{key:"getWidth",value:function(){if(x.isNumber(this.width))return this.width;var t=this.table.index.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(x.isNumber(this.height))return this.height;var t=this.table,e=t.fixed,r=t.rows.sectionSumHeight(0,e.fxTop);return this.height=r,r}},{key:"getX",value:function(){if(x.isNumber(this.x))return this.x;return this.x=0,0}},{key:"getY",value:function(){if(x.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}},{key:"getScrollView",value:function(){if(x.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.rows,r=t.cols,n=t.fixed,o=new Qs(0,0,n.fxTop,0);return o.w=r.rectRangeSumWidth(o),o.h=e.rectRangeSumHeight(o),this.scrollView=o,o.clone()}},{key:"getFullScrollView",value:function(){if(x.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.getScrollView();return this.fullScrollView=t,t.clone()}},{key:"getViewMode",value:function(){return this.viewMode=gh.STATIC,gh.STATIC}},{key:"render",value:function(){var t=this.table.getRenderMode();t!==Vh.RENDER&&t!==Vh.SCALE||xh(Ch(e.prototype),"render",this).call(this)}}]),e}(Hh),Ih=function(t){function e(){return jh(this,e),kh(this,Ch(e).apply(this,arguments))}return Ah(e,t),Rh(e,[{key:"getWidth",value:function(){if(x.isNumber(this.width))return this.width;var t=this.table,e=t.fixed,r=t.rows.sectionSumHeight(0,e.fxLeft);return this.width=r,r}},{key:"getHeight",value:function(){if(x.isNumber(this.height))return this.height;var t=this.table,e=t.fixed,r=t.rows.sectionSumHeight(0,e.fxTop);return this.height=r,r}},{key:"getX",value:function(){if(x.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(x.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}},{key:"getScrollView",value:function(){if(x.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.rows,r=t.cols,n=t.fixed,o=new Qs(0,0,n.fxTop,n.fxLeft);return o.w=r.rectRangeSumWidth(o),o.h=e.rectRangeSumHeight(o),this.scrollView=o,o.clone()}},{key:"getFullScrollView",value:function(){if(x.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.getScrollView();return this.fullScrollView=t,t.clone()}},{key:"getViewMode",value:function(){return this.viewMode=gh.STATIC,gh.STATIC}},{key:"render",value:function(){var t=this.table.getRenderMode();t!==Vh.RENDER&&t!==Vh.SCALE||xh(Ch(e.prototype),"render",this).call(this)}}]),e}(Mh),Yh=function(t){function e(){return jh(this,e),kh(this,Ch(e).apply(this,arguments))}return Ah(e,t),Rh(e,[{key:"getWidth",value:function(){if(x.isNumber(this.width))return this.width;var t=this.table,e=t.fixed,r=t.rows.sectionSumHeight(0,e.fxLeft);return this.width=r,r}},{key:"getHeight",value:function(){if(x.isNumber(this.height))return this.height;var t=this.table.index.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(x.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(x.isNumber(this.y))return this.y;return this.y=0,0}},{key:"getScrollView",value:function(){if(x.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.rows,r=t.cols,n=t.fixed,o=new Qs(0,0,0,n.fxLeft);return o.w=r.rectRangeSumWidth(o),o.h=e.rectRangeSumHeight(o),this.scrollView=o,o.clone()}},{key:"getFullScrollView",value:function(){if(x.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.getScrollView();return this.fullScrollView=t,t.clone()}},{key:"getViewMode",value:function(){return this.viewMode=gh.STATIC,gh.STATIC}},{key:"render",value:function(){var t=this.table.getRenderMode();t!==Vh.RENDER&&t!==Vh.SCALE||xh(Ch(e.prototype),"render",this).call(this)}}]),e}(Dh),Fh=function(){function t(e){jh(this,t),this.table=e}return Rh(t,[{key:"draw",value:function(){var t=this.table,e=t.draw,r=t.indexGrid,n=t.index,o=n.getHeight(),i=n.getWidth();e.save(),e.offset(0,0),e.attr({fillStyle:"#f4f5f8"}),e.fillRect(0,0,n.getWidth(),o),e.offset(0,0),r.horizontalLine(0,o,i,o),r.verticalLine(i,0,i,o),e.restore()}},{key:"render",value:function(){var t=this.table.getRenderMode();t!==Vh.RENDER&&t!==Vh.SCALE||this.draw()}}]),t}(),Uh=function(t){function e(){return jh(this,e),kh(this,Ch(e).apply(this,arguments))}return Ah(e,t),Rh(e,[{key:"getWidth",value:function(){if(x.isNumber(this.width))return this.width;var t=this.table.index.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(x.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,r=t.index,n=t.visualHeight()-(r.getHeight()+e.getHeight());return this.height=n,n}},{key:"getX",value:function(){if(x.isNumber(this.x))return this.x;return this.x=0,0}},{key:"getY",value:function(){if(x.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,r=t.index.getHeight()+e.getHeight();return this.y=r,r}},{key:"getScrollView",value:function(){if(x.isNotUnDef(this.scrollView))return this.scrollView.clone();var t,e=this.table,r=e.xTableAreaView,n=e.index,o=e.getRenderMode(),i=r.getScrollView(),c=r.getScrollEnterView();return(t=x.isNotUnDef(c)&&o===Vh.SCROLL?c:i).sci=0,t.eci=0,t.w=n.getWidth(),this.scrollView=t,t.clone()}},{key:"getFullScrollView",value:function(){if(x.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table,e=t.index,r=t.xTableAreaView.getScrollView();return r.sci=0,r.eci=0,r.w=e.getWidth(),this.fullScrollView=r,r.clone()}},{key:"getViewMode",value:function(){if(x.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table,e=t.xTableAreaView,r=t.cols,n=e.getLastScrollView(),o=e.getScrollView();x.isNotUnDef(n)&&(n.sci=0,n.eci=0,n.w=r.sectionSumWidth(n.sci,n.eci)),o.sci=0,o.eci=0,o.w=r.sectionSumWidth(o.sci,o.eci);var i=wh.viewMode(n,o);return this.viewMode=i,i}}]),e}(Hh),zh=function(t){function e(){return jh(this,e),kh(this,Ch(e).apply(this,arguments))}return Ah(e,t),Rh(e,[{key:"getWidth",value:function(){if(x.isNumber(this.width))return this.width;var t=this.table,e=t.cols,r=t.fixed,n=e.sectionSumWidth(0,r.fxLeft);return this.width=n,n}},{key:"getHeight",value:function(){if(x.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,r=t.index,n=t.visualHeight()-(r.getHeight()+e.getHeight());return this.height=n,n}},{key:"getX",value:function(){if(x.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(x.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,r=t.index.getHeight()+e.getHeight();return this.y=r,r}},{key:"getScrollView",value:function(){if(x.isNotUnDef(this.scrollView))return this.scrollView.clone();var t,e=this.table,r=e.fixed,n=e.cols,o=e.xTableAreaView,i=e.getRenderMode(),c=o.getScrollView(),l=o.getScrollEnterView();return(t=x.isNotUnDef(l)&&i===Vh.SCROLL?l:c).sci=0,t.eci=r.fxLeft,t.w=n.sectionSumWidth(t.sci,t.eci),this.scrollView=t,t.clone()}},{key:"getFullScrollView",value:function(){if(x.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table,e=t.fixed,r=t.cols,n=t.xTableAreaView.getScrollView();return n.sci=0,n.eci=e.fxLeft,n.w=r.sectionSumWidth(n.sci,n.eci),this.fullScrollView=n,n.clone()}},{key:"getViewMode",value:function(){if(x.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table,e=t.xTableAreaView,r=t.cols,n=t.fixed,o=e.getLastScrollView(),i=e.getScrollView();x.isNotUnDef(o)&&(o.sci=0,o.eci=n.fxLeft,o.w=r.sectionSumWidth(o.sci,o.eci)),i.sci=0,i.eci=n.fxLeft,i.w=r.sectionSumWidth(i.sci,i.eci);var c=wh.viewMode(o,i);return this.viewMode=c,c}}]),e}(Mh),Gh=function(t){function e(){return jh(this,e),kh(this,Ch(e).apply(this,arguments))}return Ah(e,t),Rh(e,[{key:"getWidth",value:function(){if(x.isNumber(this.width))return this.width;var t=this.table,e=t.index,r=t.xLeft,n=t.visualWidth()-(e.getWidth()+r.getWidth());return this.width=n,n}},{key:"getHeight",value:function(){if(x.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,r=t.index,n=t.visualHeight()-(r.getHeight()+e.getHeight());return this.height=n,n}},{key:"getX",value:function(){if(x.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,r=t.index.getWidth()+e.getWidth();return this.x=r,r}},{key:"getY",value:function(){if(x.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,r=t.index.getHeight()+e.getHeight();return this.y=r,r}},{key:"getScrollView",value:function(){if(x.isNotUnDef(this.scrollView))return this.scrollView.clone();var t,e=this.table,r=e.xTableAreaView,n=e.getRenderMode(),o=r.getScrollView(),i=r.getScrollEnterView();return t=x.isNotUnDef(i)&&n===Vh.SCROLL?i:o,this.scrollView=t,t.clone()}},{key:"getFullScrollView",value:function(){if(x.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table.xTableAreaView.getScrollView();return this.fullScrollView=t,t.clone()}},{key:"getViewMode",value:function(){if(x.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table.xTableAreaView,e=t.getLastScrollView(),r=t.getScrollView(),n=wh.viewMode(e,r);return this.viewMode=n,n}}]),e}(Mh),Xh=function(t){function e(){return jh(this,e),kh(this,Ch(e).apply(this,arguments))}return Ah(e,t),Rh(e,[{key:"getWidth",value:function(){if(x.isNumber(this.width))return this.width;var t=this.table,e=t.xLeft,r=t.index,n=t.visualWidth()-(r.getWidth()+e.getWidth());return this.width=n,n}},{key:"getHeight",value:function(){if(x.isNumber(this.height))return this.height;var t=this.table,e=t.fixed,r=t.rows.sectionSumHeight(0,e.fxTop);return this.height=r,r}},{key:"getX",value:function(){if(x.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,r=t.index.getWidth()+e.getWidth();return this.x=r,r}},{key:"getY",value:function(){if(x.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}},{key:"getScrollView",value:function(){if(x.isNotUnDef(this.scrollView))return this.scrollView.clone();var t,e=this.table,r=e.fixed,n=e.rows,o=e.xTableAreaView,i=e.getRenderMode(),c=o.getScrollView(),l=o.getScrollEnterView();return(t=x.isNotUnDef(l)&&i===Vh.SCROLL?l:c).sri=0,t.eri=r.fxTop,t.h=n.sectionSumHeight(t.sci,t.eci),this.scrollView=t,t.clone()}},{key:"getFullScrollView",value:function(){if(x.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table,e=t.fixed,r=t.rows,n=t.xTableAreaView.getScrollView();return n.sri=0,n.eri=e.fxTop,n.h=r.sectionSumHeight(n.sci,n.eci),this.scrollView=n,n.clone()}},{key:"getViewMode",value:function(){if(x.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table,e=t.xTableAreaView,r=t.rows,n=t.fixed,o=e.getLastScrollView(),i=e.getScrollView();x.isNotUnDef(o)&&(o.sri=0,o.eri=n.fxTop,o.h=r.sectionSumHeight(o.sci,o.eci)),i.sri=0,i.eri=n.fxTop,i.h=r.sectionSumHeight(i.sci,i.eci);var c=wh.viewMode(o,i);return this.viewMode=c,c}}]),e}(Mh),Kh=function(t){function e(){return jh(this,e),kh(this,Ch(e).apply(this,arguments))}return Ah(e,t),Rh(e,[{key:"getWidth",value:function(){if(x.isNumber(this.width))return this.width;var t=this.table,e=t.xLeft,r=t.index,n=t.visualWidth()-(r.getWidth()+e.getWidth());return this.width=n,n}},{key:"getHeight",value:function(){if(x.isNumber(this.height))return this.height;var t=this.table.index.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(x.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,r=t.index.getWidth()+e.getWidth();return this.x=r,r}},{key:"getY",value:function(){if(x.isNumber(this.y))return this.y;return this.y=0,0}},{key:"getScrollView",value:function(){if(x.isNotUnDef(this.scrollView))return this.scrollView.clone();var t,e=this.table,r=e.index,n=e.xTableAreaView,o=e.getRenderMode(),i=n.getScrollView(),c=n.getScrollEnterView();return(t=x.isNotUnDef(c)&&o===Vh.SCROLL?c:i).sri=0,t.eri=0,t.h=r.getHeight(),this.scrollView=t,t.clone()}},{key:"getFullScrollView",value:function(){if(x.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table,e=t.index,r=t.xTableAreaView.getScrollView();return r.sri=0,r.eri=0,r.h=e.getHeight(),this.fullScrollView=r,r.clone()}},{key:"getViewMode",value:function(){if(x.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table,e=t.xTableAreaView,r=t.rows,n=e.getLastScrollView(),o=e.getScrollView();x.isNotUnDef(n)&&(n.sri=0,n.eri=0,n.h=r.sectionSumHeight(n.sri,n.eri)),o.sri=0,o.eri=0,o.h=r.sectionSumHeight(o.sri,o.eri);var i=wh.viewMode(n,o);return this.viewMode=i,i}}]),e}(Dh),qh=function(t){function e(t){var r,n=t.xTableScrollView,i=t.scroll,c=t.fixed,l=t.settings;return jh(this,e),(r=kh(this,Ch(e).call(this,"".concat(o,"-table-canvas"),"canvas"))).settings=x.mergeDeep({index:{height:25,width:40,gridColor:"#c4c4c4",size:9,color:"#000000"},table:{showGrid:!0,background:"#ffffff",borderColor:"#e5e5e5",gridColor:"#c5c5c5"},rows:{len:1e3,height:28},cols:{len:26,width:110},data:[],merge:{}},l),r.renderMode=Vh.RENDER,r.scale=new wf,r.index=new Gf(Sh({},r.settings.index,{scaleAdapter:new mf({goto:function(t){return Yc.rpx(r.scale.goto(t))}})})),r.rows=new Sf(Sh({},r.settings.rows,{scaleAdapter:new mf({goto:function(t){return Yc.rpx(r.scale.goto(t))}})})),r.cols=new xf(Sh({},r.settings.cols,{scaleAdapter:new mf({goto:function(t){return Yc.rpx(r.scale.goto(t))}})})),r.merges=new ph(Sh({},r.settings.merge,{rows:r.rows,cols:r.cols})),r.cells=new Uf({rows:r.rows,cols:r.cols,data:r.settings.data,merges:r.merges}),r.fixed=c,r.scroll=i,r.xTableAreaView=new mh({xTableScrollView:n,rows:r.rows,cols:r.cols,scroll:r.scroll}),r.styleCellsHelper=new ih({cells:r.cells,merges:r.merges,rows:r.rows,cols:r.cols,scale:r.scale}),r.textCellsHelper=new fh({cells:r.cells,merges:r.merges,rows:r.rows,cols:r.cols,scale:r.scale}),r.draw=new Yc(r.el),r.indexGrid=new Cf(r.draw,{color:r.index.getGridColor()}),r.grid=new Cf(r.draw,{color:r.settings.table.gridColor}),r.line=new Xi(r.draw,{leftShow:function(t,e){var n=r.cells.getCell(t,e);if(null===n)return!1;var o=r.merges.getFirstIncludes(t,e);return o?r.cells.getCell(o.sri,o.sci).borderAttr.left.display:!!n.borderAttr.left.display&&r.lineHandle.vLineLeftBoundOut(e,t)},topShow:function(t,e){var n=r.cells.getMergeCellOrCell(t,e);return n&&n.borderAttr.top.display},rightShow:function(t,e){var n=r.cells.getCell(t,e);if(null===n)return!1;var o=r.merges.getFirstIncludes(t,e);return o?r.cells.getCell(o.sri,o.sci).borderAttr.right.display:!!n.borderAttr.right.display&&r.lineHandle.vLineRightBoundOut(e,t)},bottomShow:function(t,e){var n=r.cells.getMergeCellOrCell(t,e);return n&&n.borderAttr.bottom.display},iFMerge:function(t,e){return null!==r.merges.getFirstIncludes(t,e)},iFMergeFirstRow:function(t,e){return r.merges.getFirstIncludes(t,e).sri===t},iFMergeLastRow:function(t,e){return r.merges.getFirstIncludes(t,e).eri===t},iFMergeFirstCol:function(t,e){return r.merges.getFirstIncludes(t,e).sci===e},iFMergeLastCol:function(t,e){return r.merges.getFirstIncludes(t,e).eci===e}}),r.textFont=new Zf({scaleAdapter:new mf({goto:function(t){return r.scale.goto(t)}})}),r.lineHandle=new Pf({merges:r.merges,rows:r.rows,cols:r.cols,cells:r.cells}),r.leftIdxGridHandle=new Vf({checked:!1,merges:r.merges,rows:r.rows,cols:r.cols,cells:r.cells,lineHandle:r.lineHandle,getWidth:function(){return r.index.getWidth()}}),r.topIdxGridHandle=new Vf({checked:!1,merges:r.merges,rows:r.rows,cols:r.cols,cells:r.cells,lineHandle:r.lineHandle,getHeight:function(){return r.index.getHeight()}}),r.borderHandle=new Lf({merges:r.merges,rows:r.rows,cols:r.cols,cells:r.cells,lineHandle:r.lineHandle}),r.gridHandle=new Vf({merges:r.merges,rows:r.rows,cols:r.cols,cells:r.cells,lineHandle:r.lineHandle}),r.xTableFrozenFullRect=new Fh(Th(r)),r.xLeftFrozenIndex=new Bh(Th(r)),r.xTopFrozenIndex=new Yh(Th(r)),r.xTableFrozenContent=new Ih(Th(r)),r.xLeftIndex=new Uh(Th(r)),r.xTopIndex=new Kh(Th(r)),r.xLeft=new zh(Th(r)),r.xTop=new Xh(Th(r)),r.xContent=new Gh(Th(r)),r.visualWidthCache=null,r.visualHeightCache=null,r.merges.sync(),r}return Ah(e,t),Rh(e,[{key:"drawBorderOptimize",value:function(){var t=this.styleCellsHelper,e=this.xTableAreaView,r=this.borderHandle,n=e.getScrollView(),o=!0;t.getCellByViewRange({rectRange:n,callback:function(t,e,r){var n=r.borderAttr,i=n.top,c=n.left,l=n.right,s=n.bottom;return i.type===Fi.DOUBLE_LINE?o=!1:c.type===Fi.DOUBLE_LINE?o=!1:l.type===Fi.DOUBLE_LINE?o=!1:s.type!==Fi.DOUBLE_LINE||(o=!1)}}),o?r.openDrawOptimization():r.closeDrawOptimization()}},{key:"reset",value:function(){var t=this.xTableAreaView,e=this.xLeftFrozenIndex,r=this.xTopFrozenIndex,n=this.xTableFrozenContent,o=this.xLeftIndex,i=this.xTopIndex,c=this.xLeft,l=this.xTop,s=this.xContent;t.reset(),e.reset(),r.reset(),n.reset(),o.reset(),i.reset(),c.reset(),l.reset(),s.reset()}},{key:"getRenderMode",value:function(){return this.renderMode}},{key:"visualWidth",value:function(){if(x.isNumber(this.visualWidthCache))return this.visualWidthCache;var t=Yc.rpx(this.box().width);return this.visualWidthCache=t,t}},{key:"visualHeight",value:function(){if(x.isNumber(this.visualHeightCache))return this.visualHeightCache;var t=Yc.rpx(this.box().height);return this.visualHeightCache=t,t}},{key:"resize",value:function(){var t=this.draw,e=this.xTableAreaView,r=this.parent().box();this.visualWidthCache=null,this.visualHeightCache=null,t.resize(r.width,r.height),e.undo(),this.reset(),this.render()}},{key:"setScale",value:function(t){this.draw.attr({fillStyle:this.settings.table.background}),this.draw.fullRect(),this.scale.setValue(t),this.renderMode=Vh.SCALE,this.resize(),this.renderMode=Vh.RENDER}},{key:"scrolling",value:function(){var t=this.xTableAreaView;this.renderMode=Vh.SCROLL,this.reset(),this.render(),t.record(),this.renderMode=Vh.RENDER}},{key:"render",value:function(){var t=this.fixed,e=this.xTableFrozenFullRect,r=this.xLeftFrozenIndex,n=this.xTopFrozenIndex,o=this.xTableFrozenContent,i=this.xLeftIndex,c=this.xTopIndex,l=this.xLeft,s=this.xTop,a=this.xContent;this.drawBorderOptimize(),e.render(),t.fxLeft>-1&&t.fxTop>-1&&o.render(),t.fxTop>-1&&(r.render(),s.render()),t.fxLeft>-1&&(n.render(),l.render()),a.render(),i.render(),c.render()}}]),e}(V);var $h=function t(e){var r=e.fxTop,n=void 0===r?-1:r,o=e.fxLeft,i=void 0===o?-1:o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fxTop=n,this.fxLeft=i};function Zh(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(n=(c=l.next()).done)&&(r.push(c.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==l.return||l.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Jh(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Qh(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Jh(Object(r),!0).forEach((function(e){tp(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Jh(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function tp(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ep(t){return(ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rp(t,e){return!e||"object"!==ep(e)&&"function"!=typeof e?np(t):e}function np(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function op(t){return(op=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ip(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cp(t,e)}function cp(t,e){return(cp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function lp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sp(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ap(t,e,r){return e&&sp(t.prototype,e),r&&sp(t,r),t}var up=function(){function t(e){lp(this,t),this.table=e,this.width=null,this.height=null,this.x=null,this.y=null}return ap(t,[{key:"reset",value:function(){this.width=null,this.height=null,this.x=null,this.y=null}},{key:"getX",value:function(){throw new TypeError("child impl")}},{key:"getY",value:function(){throw new TypeError("child impl")}},{key:"getHeight",value:function(){throw new TypeError("child impl")}},{key:"getWidth",value:function(){throw new TypeError("child impl")}}]),t}(),fp=function(t){function e(){return lp(this,e),rp(this,op(e).apply(this,arguments))}return ip(e,t),ap(e,[{key:"getWidth",value:function(){if(x.isNumber(this.width))return this.width;var t=this.table,e=t.fixed,r=t.rows.sectionSumHeight(0,e.fxLeft);return this.width=r,r}},{key:"getHeight",value:function(){if(x.isNumber(this.height))return this.height;var t=this.table,e=t.fixed,r=t.rows.sectionSumHeight(0,e.fxTop);return this.height=r,r}},{key:"getX",value:function(){if(x.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(x.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}}]),e}(up),hp=function(t){function e(){return lp(this,e),rp(this,op(e).apply(this,arguments))}return ip(e,t),ap(e,[{key:"getWidth",value:function(){if(x.isNumber(this.width))return this.width;var t=this.table,e=t.xLeft,r=t.index,n=t.visualWidth()-(r.getWidth()+e.getWidth());return this.width=n,n}},{key:"getHeight",value:function(){if(x.isNumber(this.height))return this.height;var t=this.table.index.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(x.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,r=t.index.getWidth()+e.getWidth();return this.x=r,r}},{key:"getY",value:function(){if(x.isNumber(this.y))return this.y;return this.y=0,0}}]),e}(up),pp=function(t){function e(){return lp(this,e),rp(this,op(e).apply(this,arguments))}return ip(e,t),ap(e,[{key:"getWidth",value:function(){if(x.isNumber(this.width))return this.width;var t=this.table.index.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(x.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,r=t.index,n=t.visualHeight()-(r.getHeight()+e.getHeight());return this.height=n,n}},{key:"getX",value:function(){if(x.isNumber(this.x))return this.x;return this.x=0,0}},{key:"getY",value:function(){if(x.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,r=t.index.getHeight()+e.getHeight();return this.y=r,r}}]),e}(up),yp=function(t){function e(){return lp(this,e),rp(this,op(e).apply(this,arguments))}return ip(e,t),ap(e,[{key:"getWidth",value:function(){if(x.isNumber(this.width))return this.width;var t=this.table,e=t.xLeft,r=t.index,n=t.visualWidth()-(r.getWidth()+e.getWidth());return this.width=n,n}},{key:"getHeight",value:function(){if(x.isNumber(this.height))return this.height;var t=this.table,e=t.fixed,r=t.rows.sectionSumHeight(0,e.fxTop);return this.height=r,r}},{key:"getX",value:function(){if(x.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,r=t.index.getWidth()+e.getWidth();return this.x=r,r}},{key:"getY",value:function(){if(x.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}}]),e}(up),bp=function(t){function e(){return lp(this,e),rp(this,op(e).apply(this,arguments))}return ip(e,t),ap(e,[{key:"getWidth",value:function(){if(x.isNumber(this.width))return this.width;var t=this.table,e=t.index,r=t.xLeft,n=t.visualWidth()-(e.getWidth()+r.getWidth());return this.width=n,n}},{key:"getHeight",value:function(){if(x.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,r=t.index,n=t.visualHeight()-(r.getHeight()+e.getHeight());return this.height=n,n}},{key:"getX",value:function(){if(x.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,r=t.index.getWidth()+e.getWidth();return this.x=r,r}},{key:"getY",value:function(){if(x.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,r=t.index.getHeight()+e.getHeight();return this.y=r,r}}]),e}(up),dp=function(t){function e(){return lp(this,e),rp(this,op(e).apply(this,arguments))}return ip(e,t),ap(e,[{key:"getWidth",value:function(){if(x.isNumber(this.width))return this.width;var t=this.table,e=t.cols,r=t.fixed,n=e.sectionSumWidth(0,r.fxLeft);return this.width=n,n}},{key:"getHeight",value:function(){if(x.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,r=t.index,n=t.visualHeight()-(r.getHeight()+e.getHeight());return this.height=n,n}},{key:"getX",value:function(){if(x.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(x.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,r=t.index.getHeight()+e.getHeight();return this.y=r,r}}]),e}(up),vp=function(t){function e(t){var r,n=t.settings;return lp(this,e),(r=rp(this,op(e).call(this,"".concat(o,"-table")))).settings=x.mergeDeep({index:{height:25,width:40,gridColor:"#c4c4c4",size:9,color:"#000000"},table:{showGrid:!0,background:"#ffffff",borderColor:"#e5e5e5",gridColor:"#c5c5c5"},fixed:{fxTop:-1,fxLeft:-1},rows:{len:1e3,height:28},cols:{len:26,width:110}},n),r.scale=new wf,r.index=new Gf(Qh({},r.settings.index,{scaleAdapter:new mf({goto:function(t){return r.scale.goto(t)}})})),r.rows=new Sf(Qh({},r.settings.rows,{scaleAdapter:new mf({goto:function(t){return r.scale.goto(t)}})})),r.cols=new xf(Qh({},r.settings.cols,{scaleAdapter:new mf({goto:function(t){return r.scale.goto(t)}})})),r.fixed=new $h(r.settings.fixed),r.scroll=new kf({fixed:r.fixed}),r.xTableScrollView=new wh({scroll:r.scroll,rows:r.rows,cols:r.cols,getHeight:function(){return r.xContent.getHeight()},getWidth:function(){return r.xContent.getWidth()}}),r.xTableAreaView=new mh({xTableScrollView:r.xTableScrollView,rows:r.rows,cols:r.cols,scroll:r.scroll}),r.xLeftIndex=new pp(np(r)),r.xTopIndex=new hp(np(r)),r.xLeft=new dp(np(r)),r.xTop=new yp(np(r)),r.xContent=new bp(np(r)),r.xTableFrozenContent=new fp(np(r)),r.xTableImage=new qh({xTableScrollView:r.xTableScrollView,settings:n,scroll:r.scroll,fixed:r.fixed}),r.visualHeightCache=null,r.visualWidthCache=null,r}return ip(e,t),ap(e,[{key:"getContentWidth",value:function(){return this.xContent.getWidth()}},{key:"getContentHeight",value:function(){return this.xContent.getHeight()}},{key:"getScrollTotalHeight",value:function(){var t=this.fixed,e=this.rows;return t.fxTop>-1?e.sectionSumHeight(t.fxTop,e.len-1):e.sectionSumHeight(0,e.len-1)}},{key:"getScrollTotalWidth",value:function(){var t=this.fixed,e=this.cols;return t.fxTop>-1?e.sectionSumWidth(t.fxLeft,e.len-1):e.sectionSumWidth(0,e.len-1)}},{key:"getFixedWidth",value:function(){return this.xLeft.getWidth()}},{key:"getFixedHeight",value:function(){return this.xTop.getHeight()}},{key:"getIndexWidth",value:function(){return this.index.getWidth()}},{key:"getIndexHeight",value:function(){return this.index.getHeight()}},{key:"visualWidth",value:function(){if(x.isNumber(this.visualWidthCache))return this.visualWidthCache;var t=this.box().width;return this.visualWidthCache=t,t}},{key:"visualHeight",value:function(){if(x.isNumber(this.visualHeightCache))return this.visualHeightCache;var t=this.box().height;return this.visualHeightCache=t,t}},{key:"getRiCiByXy",value:function(t,e){var r=this.fixed,n=this.rows,o=this.cols,i=this.index,c=this.getFixedHeight(),l=this.getFixedWidth(),s=t,a=e,u=-1,f=-1;if(s-=i.getWidth(),a-=i.getHeight(),s<=l&&t>i.getWidth())for(var h=0,p=0;p<=r.fxLeft;p+=1){if(u=p,(h+=o.getWidth(p))>s)break}else if(t>i.getWidth())for(var y=l,b=this.getScrollView(),d=b.sci;d<=b.eci;d+=1){if(u=d,(y+=o.getWidth(d))>s)break}if(a<c&&e>i.getHeight())for(var v=0,g=0;g<=r.fxTop;g+=1){if(f=g,(v+=n.getHeight(g))>a)break}else if(e>i.getHeight())for(var w=c,m=this.getScrollView(),O=m.sri;O<=m.eri;O+=1){if(f=O,(w+=n.getHeight(O))>a)break}return{ri:f,ci:u}}},{key:"reset",value:function(){var t=this.xTableAreaView,e=this.xTableFrozenContent,r=this.xLeftIndex,n=this.xTopIndex,o=this.xLeft,i=this.xTop,c=this.xContent;t.reset(),e.reset(),r.reset(),n.reset(),o.reset(),i.reset(),c.reset()}},{key:"onAttach",value:function(){var t=this.xTableImage;this.bind(),this.attach(t)}},{key:"bind",value:function(){var t=this;Nt.bind(this,n.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.resize()})),Nt.bind(this,n.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.resize()})),Nt.bind(this,n.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.scrolling()}))}},{key:"getScrollView",value:function(){return this.xTableAreaView.getScrollView()}},{key:"scrollX",value:function(t){var e=this.cols,r=this.fixed,o=this.scroll,i=r.fxLeft;i+=1;var c,l=Zh(x.rangeReduceIf(i,e.len,0,0,t,(function(t){return e.getWidth(t)})),3),s=l[0],a=l[1],u=l[2],f=a;t>0&&(f+=u),o.x>f?c=_f.H_LEFT:o.x<f&&(c=_f.H_RIGHT),o.type=c,o.ci=s,o.x=f,this.trigger(n.SYSTEM_EVENT_TYPE.SCROLL),o.type=_f.UN}},{key:"scrollY",value:function(t){var e=this.rows,r=this.fixed,o=this.scroll,i=r.fxTop;i+=1;var c,l=Zh(x.rangeReduceIf(i,e.len,0,0,t,(function(t){return e.getHeight(t)})),3),s=l[0],a=l[1],u=l[2],f=a;t>0&&(f+=u),o.y>f?c=_f.V_TOP:o.y<f&&(c=_f.V_BOTTOM),o.type=c,o.ri=s,o.y=f,this.trigger(n.SYSTEM_EVENT_TYPE.SCROLL),o.type=_f.UN}},{key:"getTop",value:function(){var t=this.rows,e=this.getScrollView();return t.sectionSumHeight(0,e.sri-1)}},{key:"getLeft",value:function(){var t=this.cols,e=this.getScrollView();return t.sectionSumWidth(0,e.sci-1)}},{key:"resize",value:function(){var t=this.xTableImage,e=this.xTableAreaView;this.visualHeightCache=null,this.visualWidthCache=null,e.undo(),this.reset(),t.resize()}},{key:"setScale",value:function(t){var e=this.xTableImage,r=this.scale;this.reset(),r.setValue(t),e.setScale(t)}},{key:"scrolling",value:function(){this.xTableImage.scrolling()}},{key:"render",value:function(){this.xTableImage.render()}}]),e}(V);function gp(t){return(gp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wp(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function mp(t,e){return!e||"object"!==gp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Op(t){return(Op=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sp(t,e){return(Sp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ep=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{tableConfig:{data:[]}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=mp(this,Op(e).call(this,"".concat(o,"-sheet")))).options=r,t.table=new vp({settings:t.options.tableConfig}),t}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sp(t,e)}(e,t),r=e,(i=[{key:"bind",value:function(){var t=this,e=this.table;Nt.bind(e,n.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(e){t.trigger(n.TABLE_EVENT_TYPE.CHANGE_WIDTH,t),e.stopPropagation()})),Nt.bind(e,n.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(e){t.trigger(n.TABLE_EVENT_TYPE.CHANGE_HEIGHT,t),e.stopPropagation()})),Nt.bind(e,n.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(e){t.trigger(n.TABLE_EVENT_TYPE.SELECT_CHANGE,t),e.stopPropagation()})),Nt.bind(e,n.TABLE_EVENT_TYPE.SELECT_DOWN,(function(e){t.trigger(n.TABLE_EVENT_TYPE.SELECT_DOWN,t),e.stopPropagation()}))}},{key:"onAttach",value:function(){var t=this.table;this.attach(t)}}])&&wp(r.prototype,i),c&&wp(r,c),e}(V),xp=r(0),_p=r.n(xp);function kp(t){return(kp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tp(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Cp(t,e){return!e||"object"!==kp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ap(t){return(Ap=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pp(t,e){return(Pp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jp=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{sheets:[]};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Cp(this,Ap(e).call(this,"".concat(o,"-work-body")))).work=t,r.workConfig=n,r.sheets=r.workConfig.sheets,r.tabSheet=[],r.activeIndex=-1,r.poweredBy=C("div","".concat(o,"-powered-by-tips")),r.poweredBy.text(i),r.children(r.poweredBy),r.sheetViewLayer=new Jt({style:{flexGrow:1}}),r.scrollBarYLayer=new Jt({style:{overflow:"inherit"}}),r.scrollBarXLayer=new Uu,r.scrollBarXVerticalCenter=new qu,r.scrollBarXHorizontalLayer=new Jt({style:{flexGrow:2}}),r.scrollBarXVerticalCenter.children(r.scrollBarXLayer),r.scrollBarXHorizontalLayer.children(r.scrollBarXVerticalCenter),r.sheetSwitchTabLayer=new Jt({style:{flexGrow:3}}),r.horizontalLayer1=new ne,r.horizontalLayer2=new ne,r.horizontalLayer1.children(r.sheetViewLayer),r.horizontalLayer1.children(r.scrollBarYLayer),r.horizontalLayer2.children(r.sheetSwitchTabLayer),r.horizontalLayer2.children(r.scrollBarXHorizontalLayer),r.horizontalLayer1Layer=new q({style:{flexGrow:1}}),r.horizontalLayer2Layer=new q,r.layerVerticalLayer=new U,r.horizontalLayer1Layer.children(r.horizontalLayer1),r.horizontalLayer2Layer.children(r.horizontalLayer2),r.layerVerticalLayer.children(r.horizontalLayer1Layer),r.layerVerticalLayer.children(r.horizontalLayer2Layer),r.children(r.layerVerticalLayer),r.sheetView=new rf,r.scrollBarY=new Xt({scroll:function(t){r.sheetView.getActiveSheet().table.scrollY(t)}}),r.tabView=new af({onAdd:function(){var t=new Ep,e=new df;r.addTabSheet({tab:e,sheet:t})},onSwitch:function(t){r.setActiveTab(t)}}),r.scrollBarX=new It({scroll:function(t){r.sheetView.getActiveSheet().table.scrollX(t)}}),r}var r,c,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pp(t,e)}(e,t),r=e,(c=[{key:"updateScroll",value:function(){var t=this.sheetView.getActiveSheet();if(!x.isUnDef(t)){var e=this.scrollBarXHorizontalLayer,r=t.table,n=r.xContent,o=r.getScrollTotalHeight(),i=r.getScrollTotalWidth();e.display(i>n.getWidth()),this.scrollBarY.setSize(n.getHeight(),o),this.scrollBarX.setSize(n.getWidth(),i),this.scrollBarY.scrollMove(r.getTop()),this.scrollBarX.scrollMove(r.getLeft())}}},{key:"createSheet",value:function(){var t=!0,e=!1,r=void 0;try{for(var n,o=this.sheets[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var i=n.value,c=i.name,l=new Ep(i),s=new df(c);this.addTabSheet({tab:s,sheet:l})}}catch(t){e=!0,r=t}finally{try{t||null==o.return||o.return()}finally{if(e)throw r}}this.tabSheet.length&&this.setActiveIndex(0)}},{key:"bind",value:function(){var t=this;this.on(n.SYSTEM_EVENT_TYPE.MOUSE_WHEEL,(function(e){var r=t.sheetView.getActiveSheet();if(!x.isUnDef(r)){var n=r.table,o=n.rows,i=n.scroll,c=t.scrollBarY.scrollTo,l=e.deltaY;e.detail&&(l=40*e.detail),l>0?t.scrollBarY.scrollMove(c+o.getHeight(i.ri)):t.scrollBarY.scrollMove(c-o.getHeight(i.ri-1)),i.blockTop<i.maxBlockTop&&i.blockTop>0&&(e.preventDefault(),e.stopPropagation())}})),Nt.bind(window,n.SYSTEM_EVENT_TYPE.RESIZE,(function(){x.throttle((function(){t.sheetView.getActiveSheet().table.resize(),t.updateScroll()}))})),Nt.bind(this.sheetView,n.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.updateScroll()})),Nt.bind(this.sheetView,n.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.updateScroll()})),Nt.bind(this.sheetView,n.TABLE_EVENT_TYPE.DATA_CHANGE,(function(e){t.trigger(n.TABLE_EVENT_TYPE.DATA_CHANGE),e.stopPropagation()})),Nt.bind(this.sheetView,n.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(e){t.trigger(n.TABLE_EVENT_TYPE.SELECT_CHANGE),e.stopPropagation()})),Nt.bind(this.sheetView,n.TABLE_EVENT_TYPE.SELECT_DOWN,(function(e){t.trigger(n.TABLE_EVENT_TYPE.SELECT_DOWN,t),e.stopPropagation()}))}},{key:"onAttach",value:function(){var t=this.sheetViewLayer,e=this.scrollBarYLayer,r=this.sheetSwitchTabLayer,n=this.scrollBarXLayer;t.attach(this.sheetView),e.attach(this.scrollBarY),r.attach(this.tabView),n.attach(this.scrollBarX),this.bind(),this.createSheet(),this.updateScroll()}},{key:"addTabSheet",value:function(t){var e=t.tab,r=t.sheet,n=this.tabSheet,o=this.sheetView,i=this.tabView;o.attach(r),i.attach(e),n.push({tab:e,sheet:r})}},{key:"setActiveIndex",value:function(t){var e=this.sheetView,r=this.tabView,n=e.setActiveSheet(t),o=r.setActiveTab(t);if(n&&o){var i=n.table;this.updateScroll(),i.resize(),this.activeIndex=t}}},{key:"setActiveTab",value:function(t){var e=this;this.tabSheet.forEach((function(r,n){r.tab===t&&e.setActiveIndex(n)}))}},{key:"toTemplate",value:function(){var t=this.activeIndex,e=this.sheetView,r=this.tabView,n=e.sheetList[t],o=r.tabList[t];if(n&&o){var i=n.table,c=i.rows,l=i.cols,s=i.merges,a=i.cells,u=i.settings,f={name:o.name,tableConfig:{table:{showGrid:u.table.showGrid,background:u.table.background},rows:{len:c.len,height:c.height,data:c.getData()},cols:{len:l.len,width:l.width,data:l.getData()},merge:{merges:s.getData().map((function(t){return t.toString()}))},data:a.getData()}},h="window['".concat(o.name,"'] = ").concat(JSON.stringify(f));_p()(h,"".concat(o.name,".js"),"application/x-javascript")}}},{key:"setScale",value:function(t){this.sheetView.getActiveSheet().table.setScale(t),this.updateScroll()}}])&&Tp(r.prototype,c),l&&Tp(r,l),e}(V);function Lp(t){return(Lp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rp(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Vp(t,e){return!e||"object"!==Lp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Np(t){return(Np=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mp(t,e){return(Mp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wp=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Vp(this,Np(e).call(this,"".concat(o,"-bottom-menu")))).workBottom=t,r.sum=C("div","".concat(o,"-bottom-sum")),r.avg=C("div","".concat(o,"-bottom-avg")),r.number=C("div","".concat(o,"-bottom-number")),r.fullScreen=C("div","".concat(o,"-bottom-full-screen")),r.grid=C("div","".concat(o,"-bottom-grid")),r.children(r.grid),r.children(r.fullScreen),r.children(r.sum),r.children(r.avg),r.children(r.number),r}var r,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mp(t,e)}(e,t),r=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"bind",value:function(){var t=this.workBottom.work,e=t.body.sheetView;Nt.bind(this.grid,n.SYSTEM_EVENT_TYPE.CLICK,(function(){var t=e.getActiveSheet().table;t.settings.table.showGrid=!t.settings.table.showGrid,t.render()})),Nt.bind(this.fullScreen,n.SYSTEM_EVENT_TYPE.CLICK,(function(){x.isFull()?x.exitFullscreen():x.fullScreen(t.root)}))}},{key:"setSum",value:function(t){this.sum.text("求和: ".concat(t))}},{key:"setAvg",value:function(t){this.avg.text("平均数: ".concat(t))}},{key:"setNumber",value:function(t){this.number.text("数量: ".concat(t))}}])&&Rp(r.prototype,i),c&&Rp(r,c),e}(V);function Hp(t){return(Hp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dp(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Bp(t,e){return!e||"object"!==Hp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ip(t){return(Ip=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yp(t,e){return(Yp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fp=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Bp(this,Ip(e).call(this,"".concat(o,"-work-bottom")))).work=t,r}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yp(t,e)}(e,t),r=e,(n=[{key:"onAttach",value:function(){this.bottomMenu=new Wp(this),this.attach(this.bottomMenu)}}])&&Dp(r.prototype,n),i&&Dp(r,i),e}(V);function Up(t){return(Up="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zp(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Gp(t){return(Gp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Kp(t,e){return(Kp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qp=function(t){function e(){var t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{body:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(t=!(n=Gp(e).call(this,"".concat(o,"-work")))||"object"!==Up(n)&&"function"!=typeof n?Xp(r):n).options=i.workConfig,t.root=null,t.topLayer=new q,t.bodyLayer=new q({style:{flexGrow:1}}),t.bottomLayer=new q,t.verticalLayer=new U,t.verticalLayer.children(t.topLayer),t.verticalLayer.children(t.bodyLayer),t.verticalLayer.children(t.bottomLayer),t.children(t.verticalLayer),t.top=new Du(Xp(t)),t.body=new jp(Xp(t),t.options.body),t.bottom=new Fp(Xp(t)),t}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kp(t,e)}(e,t),r=e,(n=[{key:"onAttach",value:function(t){this.root=t;var e=this.bodyLayer,r=this.topLayer,n=this.bottomLayer;r.attach(this.top),n.attach(this.bottom),e.attach(this.body),this.bottom.bottomMenu.setSum(0),this.bottom.bottomMenu.setAvg(0),this.bottom.bottomMenu.setNumber(0)}}])&&zp(r.prototype,n),i&&zp(r,i),e}(V);r(1),r(2);function $p(t){return($p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zp(t){return(Zp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qp(t,e){return(Qp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}r.d(e,"XSheet",(function(){return ty}));var ty=function(t){function e(t){var r,n,i,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{workConfig:{body:{sheets:[{tableConfig:{}}]}}};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,r=!(i=Zp(e).call(this,"".concat(o)))||"object"!==$p(i)&&"function"!=typeof i?Jp(n):i;var l=t;return"string"==typeof t&&(l=document.querySelector(t)),(l=C(l)).children(Jp(r)),r.work=new qp(c),r.attach(r.work),pe.setRoot(Jp(r)),an.setRoot(Jp(r)),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qp(t,e)}(e,t),e}(V);ty.version=i,ty.Utils=x,window&&(window.XSheet=ty)}]);
//# sourceMappingURL=XSheet.js.map