!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=6)}([function(t,e,n){t.exports=n.p+"c4ab8001e109540f7ae6a34181d695d3.png"},function(t,e,n){t.exports=n.p+"42b436e7c64603182355d52d31ea49f1.png"},function(t,e,n){t.exports=n.p+"9dfd8685ea7e1e5c025514eec46a4547.png"},function(t,e,n){var r,o,i;o=[],void 0===(i="function"==typeof(r=function(){return function t(e,n,r){var o,i,c=window,l="application/octet-stream",s=r||l,a=e,u=!n&&!r&&a,f=document.createElement("a"),h=function(t){return String(t)},p=c.Blob||c.MozBlob||c.WebKitBlob||h,y=n||"download";if(p=p.call?p.bind(c):Blob,"true"===String(this)&&(s=(a=[a,s])[0],a=a[1]),u&&u.length<2048&&(y=u.split("/").pop().split("?")[0],f.href=u,-1!==f.href.indexOf(u))){var b=new XMLHttpRequest;return b.open("GET",u,!0),b.responseType="blob",b.onload=function(e){t(e.target.response,y,l)},setTimeout((function(){b.send()}),0),b}if(/^data\:[\w+\-]+\/[\w+\-]+[,;]/.test(a)){if(!(a.length>2096103.424&&p!==h))return navigator.msSaveBlob?navigator.msSaveBlob(d(a),y):g(a);s=(a=d(a)).type||l}function d(t){for(var e=t.split(/[:;,]/),n=e[1],r=("base64"==e[2]?atob:decodeURIComponent)(e.pop()),o=r.length,i=0,c=new Uint8Array(o);i<o;++i)c[i]=r.charCodeAt(i);return new p([c],{type:n})}function g(t,e){if("download"in f)return f.href=t,f.setAttribute("download",y),f.className="download-js-link",f.innerHTML="downloading...",f.style.display="none",document.body.appendChild(f),setTimeout((function(){f.click(),document.body.removeChild(f),!0===e&&setTimeout((function(){c.URL.revokeObjectURL(f.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return t=t.replace(/^data:([\w\/\-\+]+)/,l),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var n=document.createElement("iframe");document.body.appendChild(n),e||(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,l)),n.src=t,setTimeout((function(){document.body.removeChild(n)}),333)}if(o=a instanceof p?a:new p([a],{type:s}),navigator.msSaveBlob)return navigator.msSaveBlob(o,y);if(c.URL)g(c.URL.createObjectURL(o),!0);else{if("string"==typeof o||o.constructor===h)try{return g("data:"+s+";base64,"+c.btoa(o))}catch(t){return g("data:"+s+","+encodeURIComponent(o))}(i=new FileReader).onload=function(t){g(this.result)},i.readAsDataURL(o)}return!0}})?r.apply(e,o):r)||(t.exports=i)},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var r={};r.SYSTEM_EVENT_TYPE={MOUSE_MOVE:"mouseMove".toLocaleLowerCase(),MOUSE_DOWN:"mouseDown".toLocaleLowerCase(),MOUSE_UP:"mouseUp".toLocaleLowerCase(),MOUSE_OVER:"mouseOver".toLocaleLowerCase(),MOUSE_LEAVE:"mouseLeave".toLocaleLowerCase(),MOUSE_WHEEL:"mouseWheel".toLocaleLowerCase(),MOUSE_ENTER:"mouseEnter".toLocaleLowerCase(),CLICK:"click".toLocaleLowerCase(),KEY_DOWN:"keyDown".toLocaleLowerCase(),KEY_UP:"keyUp".toLocaleLowerCase(),DRAG_START:"dragStart".toLocaleLowerCase(),SCROLL:"scroll".toLocaleLowerCase(),RESIZE:"resize".toLocaleLowerCase(),CHANGE:"change".toLocaleLowerCase(),INPUT:"input".toLocaleLowerCase(),VISIBILITY_CHANGE:"visibilityChange".toLocaleLowerCase()},r.TABLE_EVENT_TYPE={CHANGE_HEIGHT:"tableChangeHeight".toLocaleLowerCase(),CHANGE_WIDTH:"tableChangeWidth".toLocaleLowerCase(),DATA_CHANGE:"tableDataChange".toLocaleLowerCase(),SELECT_CHANGE:"tableSelectChange".toLocaleLowerCase(),SELECT_DOWN:"tableSelectDown".toLocaleLowerCase(),SCALE_CHANGE:"scaleChange".toLocaleLowerCase()},r.WORK_BODY_EVENT_TYPE={CHANGE_ACTIVE:"workBodyChangeActive".toLocaleLowerCase()},r.MOUSE_POINTER_TYPE={SELECT_ONE_COLUMN:{key:Symbol("选择一列"),type:"s-resize"},SELECT_ONE_ROW:{key:Symbol("选择一行"),type:"e-resize"},SELECT_CELL:{key:Symbol("选择单元格"),type:"cell"},AUTO_FILL:{key:Symbol("单元格内容自动填充"),type:"crosshair"},COL_RESIZE:{key:Symbol("调整列宽"),type:"col-resize"},ROW_RESIZE:{key:Symbol("调整行高"),type:"row-resize"}};var o="x-sheet",i="X-Sheet 1.0.0-develop";function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],u=null,f=1,h=2,p=3,y=5,b=6,d=7,g=8,v=9,w=10,m=11,S=12,O=13,E=14,_=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,n=null,r=[{key:"type",value:function(t){var e=Object.prototype.toString.call(t);switch(e){case"[object Null]":return d;case"[object Undefined]":return g;case"[object String]":return f;case"[object Boolean]":return h;case"[object Number]":return p;case"[object Function]":return b;case"[object Array]":return y;case"[object Promise]":return v;case"[object GeneratorFunction]":return w;case"[object AsyncFunction]":return m;case"[object BigInt]":return S;case"[object Symbol]":return O;default:return E}}},{key:"cloneDeep",value:function(t){var e=JSON.stringify(t);return JSON.parse(e)}},{key:"mergeDeep",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.isUnDef(e))return{};for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return t.isUnDef(r)||0===r.length?e:(r.forEach((function(n){t.isUnDef(n)||Object.keys(n).forEach((function(r){var o=n[r];"string"==typeof o||"number"==typeof o||"boolean"==typeof o?e[r]=o:"function"!=typeof o&&!Array.isArray(o)&&t.isPlainObject(o)?(e[r]=e[r]||{},t.mergeDeep(e[r],o)):e[r]=o}))})),e)}},{key:"copyProp",value:function(t,e){return Object.assign(t,e)}},{key:"isMac",value:function(){return/macintosh|mac os x/i.test(navigator.userAgent)}},{key:"isWindows",value:function(){return/windows|win32/i.test(navigator.userAgent)}},{key:"isEmptyObject",value:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}},{key:"isNotEmptyObject",value:function(e){return!t.isEmptyObject(e)}},{key:"isUnDef",value:function(t){return null==t}},{key:"isNotUnDef",value:function(t){return!this.isUnDef(t)}},{key:"isNotZero",value:function(t){return 0!==t}},{key:"isNumber",value:function(t){return/^(-?\d+.\d+)$|^(-?\d+)$/.test(t)}},{key:"isFraction",value:function(t){return/^\d+\/\d+$/.test(t)}},{key:"isFunction",value:function(e){return t.type(e)===b}},{key:"isArray",value:function(e){return t.type(e)===y}},{key:"isBlank",value:function(e){return!!t.isUnDef(e)||""===e.toString().trim()}},{key:"isPlainObject",value:function(e){return!t.isUnDef(e)&&Object.getPrototypeOf(e)===Object.getPrototypeOf({})}},{key:"isString",value:function(e){return t.type(e)===f}},{key:"sum",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},n=0,r=0;return Object.keys(t).forEach((function(o){n+=e(t[o],o),r+=1})),[n,r]}},{key:"rangeSum",value:function(t,e,n){for(var r=0,o=t;o<e;o+=1)r+=n(o);return r}},{key:"parseFloat",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(e){return t.isNumber(e)?parseFloat(e):0}))},{key:"parseInt",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(e){return t.isNumber(e)?parseInt(e,10):0}))},{key:"stringAt",value:function(t){for(var e="",n=t;n>=a.length;)n/=a.length,n-=1,e+=a[parseInt(n,10)%a.length];return e+=a[t%a.length]}},{key:"indexAt",value:function(t){for(var e=0,n=0;n<t.length-1;n+=1){var r=t.charCodeAt(n)-65,o=t.length-1-n;e+=Math.pow(a.length,o)+a.length*r}return e+=t.charCodeAt(t.length-1)-65}},{key:"expr2xy",value:function(e){for(var n="",r="",o=0;o<e.length;o+=1)e.charAt(o)>="0"&&e.charAt(o)<="9"?r+=e.charAt(o):n+=e.charAt(o);return[t.indexAt(n),parseInt(r,10)-1]}},{key:"xy2expr",value:function(e,n){return"".concat(t.stringAt(e)).concat(n+1)}},{key:"expr2expr",value:function(e,n,r){var o=l(t.expr2xy(e),2),i=o[0],c=o[1];return t.xy2expr(i+n,c+r)}},{key:"rangeReduceIf",value:function(t,e,n,r,o,i){for(var c=n,l=r,s=t;s<e&&!(c>=o);s+=1)c+=l=i(s);return[s,c-l,l]}},{key:"throttle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;u&&clearTimeout(u),u=setTimeout(t,e)}},{key:"contrastDifference",value:function(e,n){var r={};if(t.isUnDef(e)||t.isUnDef(n))return r;for(var o in e)if(e.hasOwnProperty(o)){var i=n[o],c=e[o];t.isUnDef(i)||t.isUnDef(c)||t.equal(i,c)||(r[o]=e[o])}return r}},{key:"minIf",value:function(t,e){return t<e?e:t}},{key:"maxIf",value:function(t,e){return t>e?e:t}},{key:"equal",value:function(t,e){var n,r,o,i;function l(t,e){var n;if(isNaN(t)&&isNaN(e)&&"number"==typeof t&&"number"==typeof e)return!0;if(t===e)return!0;if("function"==typeof t&&"function"==typeof e||t instanceof Date&&e instanceof Date||t instanceof RegExp&&e instanceof RegExp||t instanceof String&&e instanceof String||t instanceof Number&&e instanceof Number)return t.toString()===e.toString();if(!(t instanceof Object&&e instanceof Object))return!1;if(t.isPrototypeOf(e)||e.isPrototypeOf(t))return!1;if(t.constructor!==e.constructor)return!1;if(t.prototype!==e.prototype)return!1;if(o.indexOf(t)>-1||i.indexOf(e)>-1)return!1;for(n in e){if(e.hasOwnProperty(n)!==t.hasOwnProperty(n))return!1;if(c(e[n])!==c(t[n]))return!1}for(n in t){if(e.hasOwnProperty(n)!==t.hasOwnProperty(n))return!1;if(c(e[n])!==c(t[n]))return!1;switch(c(t[n])){case"object":case"function":if(o.push(t),i.push(e),!l(t[n],e[n]))return!1;o.pop(),i.pop();break;default:if(t[n]!==e[n])return!1}}return!0}if(arguments.length<1)return!0;for(n=1,r=arguments.length;n<r;n++)if(o=[],i=[],!l(arguments[0],arguments[n]))return!1;return!0}},{key:"arrayIncludeArray",value:function(e,n){if(t.isUnDef(e)||t.isUnDef(n))return!1;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r+=1)if(-1===n.indexOf(e[r]))return!1;return!0}},{key:"keepLastIndex",value:function(t){if(window.getSelection){t.focus();var e=window.getSelection();e.selectAllChildren(t),e.collapseToEnd()}else if(document.selection){var n=document.selection.createRange();n.moveToElementText(t),n.collapse(!1),n.select()}}},{key:"trim",value:function(t){return this.isBlank(t)?"":t.trim()}},{key:"now",value:function(){return Date.now().toString()}},{key:"viewPort",value:function(){return{width:window.innerWidth,height:window.innerHeight}}},{key:"exitFullscreen",value:function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}},{key:"fullScreen",value:function(t){t.el&&(t=t.el),t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}},{key:"isFull",value:function(){return!!(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)}}],n&&s(e.prototype,n),r&&s(e,r),t}();function x(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function T(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}_.EMPTY="",_.Nul=null,_.Undef=void 0;var k=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=n):this.el=e,this.el.data=[]}var e,n,r;return e=t,(n=[{key:"data",value:function(t,e){return void 0!==e?(this.el.data[t]=e,this):this.el.data[t]}},{key:"on",value:function(t,e){var n=x(t.split(".")),r=n[0],o=n.slice(1),i=r;return"mousewheel"===i&&/Firefox/i.test(window.navigator.userAgent)&&(i="DOMMouseScroll"),this.el.addEventListener(i,(function(t){e(t);for(var n=0;n<o.length;n+=1){var r=o[n];if("left"===r&&0!==t.button)return;if("right"===r&&2!==t.button)return;"stop"===r&&t.stopPropagation()}})),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach((function(n){e.css(n,"".concat(t[n],"px"))})),this;var n=this.el;return{top:n.offsetTop,left:n.offsetLeft,height:n.offsetHeight,width:n.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"scrollTop",value:function(){return this.el.scrollTop}},{key:"clientHeight",value:function(){return this.el.clientHeight}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return 0===arguments.length?this.el.childNodes:(n.forEach((function(e){return t.child(e)})),this)}},{key:"first",value:function(){return this.el.firstChild}},{key:"last",value:function(){return this.el.lastChild}},{key:"remove",value:function(t){return this.el.removeChild(t.el||t)}},{key:"prepend",value:function(t){var e=this.el;return e.children.length>0?e.insertBefore(t,e.firstChild):e.appendChild(t),this}},{key:"prev",value:function(){return this.el.previousSibling}},{key:"next",value:function(){return this.el.nextSibling}},{key:"child",value:function(e){var n=e;return"string"==typeof e?n=document.createTextNode(e):e instanceof t&&(n=e.el),this.el.appendChild(n),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var n=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach((function(e){n.el.setAttribute(e,t[e])}))}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach((function(e){return t.el.style.removeProperty(e)})),this}},{key:"css",value:function(t,e){var n=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach((function(e){n.el.style[e]=t[e]})),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){var t=this.computedStyle();return t&&"block"!==t.display&&this.css("display","block"),this}},{key:"hide",value:function(){var t=this.computedStyle();return t&&"none"!==t.display&&this.css("display","none"),this}},{key:"display",value:function(t){t?this.show():this.hide()}},{key:"text",value:function(t){return void 0===t?this.el.innerText:(this.el.innerText=t,t)}},{key:"sibling",value:function(){for(var e=this.el,n=[];null!==(e=e.previousElementSibling);)n.push(new t(e));for(e=this.el;null!==(e=e.nextElementSibling);)n.push(new t(e));return n}},{key:"position",value:function(){var t=0,e=0;return this.el.style.position&&(this.el.top&&(t=this.el.style.top.replace("%","").repeat("px","")),this.el.left&&(e=this.el.style.left.replace("%","").repeat("px","")),this.el.right&&(t=this.el.style.right.replace("%","").repeat("px","")),this.el.bottom&&(t=this.el.style.bottom.replace("%","").repeat("px",""))),{top:_.parseFloat(t),left:_.parseFloat(e),right:_.parseFloat(0),bottom:_.parseFloat(0)}}},{key:"trigger",value:function(t,e){var n=new CustomEvent(t,{detail:e,bubbles:!0,cancelable:!1});this.el.dispatchEvent(n)}},{key:"focus",value:function(){this.el.focus()}},{key:"find",value:function(e){var n=this.el.querySelectorAll(e);if(n&&1===n.length)return new t(n[0]);var r=[];if(n){var o=!0,i=!1,c=void 0;try{for(var l,s=n[Symbol.iterator]();!(o=(l=s.next()).done);o=!0){var a=l.value;r.push(new t(a))}}catch(t){i=!0,c=t}finally{try{o||null==s.return||s.return()}finally{if(i)throw c}}}return r}},{key:"isChild",value:function(t){for(var e=t||t.el;null!=e&&e!==document.body;){if(e===this.el)return!0;e=e.parentNode}return!1}}])&&T(e.prototype,n),r&&T(e,r),t}(),C=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new k(t,e)};function P(t){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function A(t,e){return!e||"object"!==P(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function L(t){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function R(t,e){return(R=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var V=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),A(this,L(e).call(this,n,"".concat(o,"-widget ").concat(t)))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&R(t,e)}(e,t),n=e,(r=[{key:"computeEventXy",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=e.box(),r=n.top,o=n.left;return{x:t.pageX-o,y:t.pageY-r}}},{key:"computeWidgetXy",value:function(t){if(!t)return{x:0,y:0};var e=t.box(),n=e.top,r=e.left,o=this.box(),i=o.top;return{x:r-o.left,y:n-i}}},{key:"attach",value:function(t){this.children(t),t.onAttach(this)}},{key:"onAttach",value:function(){}}])&&j(n.prototype,r),i&&j(n,i),e}(k);function N(t){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function W(t,e){return!e||"object"!==N(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function D(t){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function H(t,e){return(H=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var M=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),W(this,D(e).call(this,"".concat(o,"-layer ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&H(t,e)}(e,t),e}(V);function B(t){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function I(t,e){return!e||"object"!==B(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Y(t){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function F(t,e){return(F=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var U=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=I(this,Y(e).call(this,"".concat(o,"-vertical-layer")))).options=_.mergeDeep({style:{}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&F(t,e)}(e,t),e}(M);function z(t){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function G(t,e){return!e||"object"!==z(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function X(t){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function K(t,e){return(K=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var q=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=G(this,X(e).call(this,"".concat(o,"-vertical-layer-element")))).options=_.mergeDeep({style:{flexGrow:"0"}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&K(t,e)}(e,t),e}(M);function $(t){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function J(t,e){return!e||"object"!==$(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Q(t){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tt(t,e){return(tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var et=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=J(this,Q(e).call(this,"".concat(o,"-icon")))).iconNameEl=C("div","".concat(o,"-icon-img ").concat(n)),t.child(t.iconNameEl),t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tt(t,e)}(e,t),n=e,(r=[{key:"setWidth",value:function(t){this.iconNameEl.css("width","".concat(t,"px"))}},{key:"setHeight",value:function(t){this.iconNameEl.css("height","".concat(t,"px"))}}])&&Z(n.prototype,r),i&&Z(n,i),e}(V);function nt(t){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rt(t,e){return!e||"object"!==nt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ot(t){return(ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function it(t,e){return(it=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ct=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),rt(this,ot(e).call(this,"".concat(o,"-tools-item ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&it(t,e)}(e,t),e}(V);function lt(t){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function st(t,e){return!e||"object"!==lt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function at(t){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ut(t,e){return(ut=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ft=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=st(this,at(e).call(this,"".concat(o,"-tools-undo")))).icon=new et("undo"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ut(t,e)}(e,t),e}(ct);function ht(t){return(ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pt(t,e){return!e||"object"!==ht(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function yt(t){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bt(t,e){return(bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=pt(this,yt(e).call(this,"".concat(o,"-tools-redo")))).icon=new et("redo"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bt(t,e)}(e,t),e}(ct);function gt(t){return(gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wt(t,e){return!e||"object"!==gt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mt(t){return(mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function St(t,e){return(St=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ot=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=wt(this,mt(e).call(this,"".concat(o,"-tools-point-format")))).icon=new et("point-format"),t.sheets=[],t.children(t.icon),t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&St(t,e)}(e,t),n=e,(r=[{key:"addSheet",value:function(t){this.sheets.push(t)}},{key:"removeSheet",value:function(t){for(var e=0;e<this.sheets.length;e+=1)if(this.sheets[e]===t)return void this.sheets.splice(e,1)}},{key:"includeSheet",value:function(t){for(var e=0;e<this.sheets.length;e+=1)if(this.sheets[e]===t)return!0;return!1}}])&&vt(n.prototype,r),i&&vt(n,i),e}(ct);function Et(t){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _t(t,e){return!e||"object"!==Et(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xt(t){return(xt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tt(t,e){return(Tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=_t(this,xt(e).call(this,"".concat(o,"-tools-clear-format")))).icon=new et("clear-format"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tt(t,e)}(e,t),e}(ct);function Ct(t){return(Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jt(t,e){return!e||"object"!==Ct(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function At(t){return(At=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Lt(t,e){return(Lt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=jt(this,At(e).call(this,"".concat(o,"-tools-drop-down-item ").concat(t)))).drop=C("div","".concat(o,"-tools-drop-down-item-mark")),n.title=C("div","".concat(o,"-tools-drop-down-item-title")),n.drop.children(new et("arrow-down")),n.children(n.title),n.children(n.drop),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lt(t,e)}(e,t),n=e,(r=[{key:"setTitle",value:function(t){this.title.text(t)}},{key:"setIcon",value:function(t){this.title.html(""),this.title.children(t)}},{key:"setWidth",value:function(t){this.title.css("width","".concat(t,"px"))}},{key:"setEllipsis",value:function(){this.title.css("overflow","hidden"),this.title.css("text-overflow","ellipsis"),this.title.css("white-space","nowrap")}},{key:"removeEllipsis",value:function(){this.title.cssRemoveKeys("overflow"),this.title.cssRemoveKeys("text-overflow"),this.title.cssRemoveKeys("white-space")}}])&&Pt(n.prototype,r),i&&Pt(n,i),e}(ct);function Vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Nt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,o=[{key:"bind",value:function(t,e,n){if(Array.isArray(t)){var r=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var s=c.value;(s.el||s).addEventListener(e,n)}}catch(t){o=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}}else(t.el||t).addEventListener(e,n)}},{key:"unbind",value:function(t,e,n){if(Array.isArray(t)){var r=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var s=c.value;(s.el||s).addEventListener(e,n)}}catch(t){o=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}}else(t.el||t).removeEventListener(e,n)}},{key:"mouseMoveUp",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=function i(c){t.unbind(e,r.SYSTEM_EVENT_TYPE.MOUSE_MOVE,n),t.unbind(e,r.SYSTEM_EVENT_TYPE.MOUSE_UP,i),o(c)};t.bind(e,r.SYSTEM_EVENT_TYPE.MOUSE_MOVE,n),t.bind(e,r.SYSTEM_EVENT_TYPE.MOUSE_UP,i)}},{key:"dbClick",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=0;t.bind(e,r.SYSTEM_EVENT_TYPE.CLICK,(function(t){var e=Date.now();e-o<=300?(n(t),o=0):o=e}))}}],(n=null)&&Vt(e.prototype,n),o&&Vt(e,o),t}();function Wt(t){return(Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ht(t,e){return!e||"object"!==Wt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mt(t){return(Mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bt(t,e){return(Bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var It=function(t){function e(t){var n,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Ht(this,Mt(e).call(this,"".concat(o,"-scroll-bar-x")))).option=_.mergeDeep({style:{},scroll:function(t){return t}},t),r.lastBut=C("div","".concat(o,"-scroll-bar-x-last-but")),r.nextBut=C("div","".concat(o,"-scroll-bar-x-next-but")),r.content=C("div","".concat(o,"-scroll-bar-x-content")),r.block=C("div","".concat(o,"-scroll-bar-x-block")),r.content.children(r.block),(n=r).children.apply(n,[r.lastBut,r.nextBut,r.content]),r.blockLeft=0,r.maxBlockLeft=0,r.blockWidth=0,r.minBlockWidth=20,r.scrollTo=0,r.contentWidth=0,r.viewPortWidth=0,r.isHide=!0,r.css(r.option.style),r.hide(),r}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bt(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"bind",value:function(){var t=this;this.block.on(r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(0===e.button){var n=t.computeEventXy(e,t.block);Nt.mouseMoveUp(C(document),(function(e){var r=t.computeEventXy(e,t.content).x-n.x;r<0&&(r=0),r>t.maxBlockLeft&&(r=t.maxBlockLeft),t.blockLeft=r,t.scrollTo=t.computeScrollTo(t.blockLeft),t.block.css("left","".concat(r,"px")),t.option.scroll(t.scrollTo),e.stopPropagation(),e.preventDefault()})),e.stopPropagation(),e.preventDefault()}}))}},{key:"setSize",value:function(t,e){if(t<e){this.isHide=!1,this.show();var n=this.content.box(),r=t/e*n.width;this.blockWidth=r<this.minBlockWidth?this.minBlockWidth:r,this.viewPortWidth=t,this.contentWidth=e,this.maxBlockLeft=n.width-this.blockWidth,this.block.css("width","".concat(this.blockWidth,"px"));var o=this.scrollTo/(e-t)*this.maxBlockLeft;this.blockLeft=o>this.maxBlockLeft?this.maxBlockLeft:o,this.scrollTo=this.computeScrollTo(this.blockLeft),this.block.css("left","".concat(this.blockLeft,"px"))}else this.isHide=!0,this.hide(),this.option.scroll(0)}},{key:"scrollMove",value:function(t){var e=t,n=this.contentWidth-this.viewPortWidth;e>n?e=n:e<0&&(e=0);var r=e/(this.contentWidth-this.viewPortWidth)*this.maxBlockLeft;this.blockLeft=r>this.maxBlockLeft?this.maxBlockLeft:r,this.scrollTo!==e&&!1===this.isHide&&(this.scrollTo=e,this.block.css("left","".concat(this.blockLeft,"px")),this.option.scroll(this.scrollTo))}},{key:"computeScrollTo",value:function(t){return t/this.maxBlockLeft*(this.contentWidth-this.viewPortWidth)}}])&&Dt(n.prototype,i),c&&Dt(n,c),e}(V);function Yt(t){return(Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ut(t,e){return!e||"object"!==Yt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zt(t){return(zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gt(t,e){return(Gt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xt=function(t){function e(t){var n,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Ut(this,zt(e).call(this,"".concat(o,"-scroll-bar-y")))).option=_.mergeDeep({style:{},scroll:function(t){return t}},t),r.lastBut=C("div","".concat(o,"-scroll-bar-y-last-but")),r.nextBut=C("div","".concat(o,"-scroll-bar-y-next-but")),r.content=C("div","".concat(o,"-scroll-bar-y-content")),r.block=C("div","".concat(o,"-scroll-bar-y-block")),r.content.children(r.block),(n=r).children.apply(n,[r.lastBut,r.nextBut,r.content]),r.blockTop=0,r.maxBlockTop=0,r.blockHeight=0,r.minBlockHeight=20,r.scrollTo=0,r.contentHeight=0,r.viewPortHeight=0,r.isHide=!0,r.css(r.option.style),r.hide(),r}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gt(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"bind",value:function(){var t=this;Nt.bind(this.block,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(0===e.button){var n=t.computeEventXy(e,t.block);Nt.mouseMoveUp(C(document),(function(e){var r=t.computeEventXy(e,t.content).y-n.y;r<0&&(r=0),r>t.maxBlockTop&&(r=t.maxBlockTop),t.blockTop=r,t.scrollTo=t.computeScrollTo(t.blockTop),t.block.css("top","".concat(r,"px")),t.option.scroll(t.scrollTo),e.stopPropagation(),e.preventDefault()}))}}))}},{key:"setSize",value:function(t,e){if(t<e){this.isHide=!1,this.show();var n=this.content.box(),r=t/e*n.height;this.blockHeight=r<this.minBlockHeight?this.minBlockHeight:r,this.viewPortHeight=t,this.contentHeight=e,this.maxBlockTop=n.height-this.blockHeight,this.block.css("height","".concat(this.blockHeight,"px"));var o=this.scrollTo/(e-t)*this.maxBlockTop;this.blockTop=o>this.maxBlockTop?this.maxBlockTop:o,this.scrollTo=this.computeScrollTo(this.blockTop),this.block.css("top","".concat(this.blockTop,"px"))}else this.isHide=!0,this.hide(),this.option.scroll(0)}},{key:"scrollMove",value:function(t){var e=t,n=this.contentHeight-this.viewPortHeight;e>n?e=n:e<0&&(e=0);var r=e/(this.contentHeight-this.viewPortHeight)*this.maxBlockTop;this.blockTop=r>this.maxBlockTop?this.maxBlockTop:r,this.scrollTo!==e&&!1===this.isHide&&(this.scrollTo=e,this.block.css("top","".concat(this.blockTop,"px")),this.option.scroll(this.scrollTo))}},{key:"computeScrollTo",value:function(t){return t/this.maxBlockTop*(this.contentHeight-this.viewPortHeight)}}])&&Ft(n.prototype,i),c&&Ft(n,c),e}(V);function Kt(t){return(Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qt(t,e){return!e||"object"!==Kt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $t(t){return($t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zt(t,e){return(Zt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=qt(this,$t(e).call(this,"".concat(o,"-horizontal-layer-element")))).options=_.mergeDeep({style:{flexGrow:"0"}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zt(t,e)}(e,t),e}(M);function Qt(t){return(Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function te(t,e){return!e||"object"!==Qt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ee(t){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ne(t,e){return(ne=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var re=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=te(this,ee(e).call(this,"".concat(o,"-horizontal-layer")))).options=_.mergeDeep({style:{}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ne(t,e)}(e,t),e}(M);function oe(t){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ie(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ce(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function le(t,e){return(le=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function se(t,e,n){return(se="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ae(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ae(t){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ue={TOP:1,LEFT:2,BOTTOM:3,RIGHT:4},fe=[],he=null,pe=function(t){function e(t){var n,r,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,n=!(i=ae(e).call(this,"".concat(o,"-el-pop-up")))||"object"!==oe(i)&&"function"!=typeof i?ce(r):i,fe.push(ce(n)),n.options=_.mergeDeep({position:ue.BOTTOM,el:null},t),n.off=!0,n.content=new V("".concat(o,"-el-pop-up-content")),n.scrollBarX=new It,n.scrollBarY=new Xt;var c=new Jt({style:{flexGrow:1}});c.children(n.content);var l=new Jt({style:{overflow:"inherit"}});l.children(n.scrollBarY);var s=new re;s.children(c),s.children(l);var a=new q(s);a.children(s);var u=new q;u.children(n.scrollBarX);var f=new U;return f.children(a),f.children(u),se(ae(e.prototype),"children",ce(n)).call(ce(n),f),n.bind(),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&le(t,e)}(e,t),n=e,c=[{key:"closeAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];fe.forEach((function(e){-1===t.indexOf(e)&&e.close()}))}},{key:"setRoot",value:function(t){t=t.el?C(t.el):C(t),he=t}}],(i=[{key:"bind",value:function(){var t=this;Nt.bind(window,r.SYSTEM_EVENT_TYPE.RESIZE,(function(){t.position(),t.scrollbar()}))}},{key:"children",value:function(){var t;(t=this.content).children.apply(t,arguments)}},{key:"position",value:function(){var t=this.content,e=this.options,n=e.el,r=e.position,o=n.box(),i=t.box(),c=o.top,l=o.left;switch(r){case ue.TOP:c=o.top-i.height;break;case ue.LEFT:l=o.left-i.width;break;case ue.RIGHT:l=o.left+o.width;break;case ue.BOTTOM:c=o.top+o.height}var s=window.innerWidth,a=window.innerHeight;if(l<0||l+i.width>s)switch(r){case ue.LEFT:l=o.left+o.width;break;case ue.RIGHT:l=o.left-i.width}if(c<0||c+i.height>a)switch(r){case ue.TOP:c=o.top+o.height;break;case ue.BOTTOM:c=o.top-i.height}(l<0||l+i.width>s)&&(c=o.top+o.height,l=o.left),(c<0||c+i.height>a)&&(c=o.top+o.height,l=o.left),this.offset({top:c,left:l})}},{key:"scrollbar",value:function(){var t=this.content.box(),e=this.box();this.scrollBarY.setSize(e.height,t.height),this.scrollBarX.setSize(e.width,t.width)}},{key:"open",value:function(){this.off&&he&&(he.children(this),this.position(),this.scrollbar(),this.off=!1)}},{key:"close",value:function(){!1===this.off&&he&&(he.remove(this),this.off=!0)}}])&&ie(n.prototype,i),c&&ie(n,c),e}(V);function ye(t){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function be(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function de(t){return(de=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ge(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ve(t,e){return(ve=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var we=function(t){function e(){var t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(r=de(e).call(this,"".concat(o,"-el-context-menu ").concat(i)))||"object"!==ye(r)&&"function"!=typeof r?ge(n):r).options=_.mergeDeep({},c),t.menus=[],t.elPopUp=new pe(t.options),t.elPopUp.children(ge(t)),t.bind(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ve(t,e)}(e,t),n=e,(i=[{key:"bind",value:function(){var t=this;Nt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){t.stopPropagation(),t.preventDefault()})),Nt.bind(document.body,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.close()}))}},{key:"addItem",value:function(t){return this.menus.push(t),this.children(t),this}},{key:"open",value:function(){return this.elPopUp.open(),this}},{key:"close",value:function(){return this.elPopUp.close(),this}},{key:"isOpen",value:function(){return this.elPopUp.off}}])&&be(n.prototype,i),c&&be(n,c),e}(V);function me(t){return(me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Se(t,e){return!e||"object"!==me(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Oe(t){return(Oe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ee(t,e){return(Ee=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _e=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Se(this,Oe(e).call(this,"".concat(o,"-el-context-menu-item hover ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ee(t,e)}(e,t),e}(V);function xe(t){return(xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Te(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ke(t){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ce(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Pe(t,e){return(Pe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var je=[],Ae=function(t){function e(t,n){var r,i,c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i=this,(r=!(c=ke(e).call(this,"".concat(o,"-format-context-menu-item")))||"object"!==xe(c)&&"function"!=typeof c?Ce(i):c).title=t,r.desc=n,r.icon=new et("checked"),r.iconElement=C("div","".concat(o,"-format-context-menu-item-icon")),r.iconElement.children(r.icon),r.titleElement=C("div","".concat(o,"-format-context-menu-item-title")),r.descElement=C("div","".concat(o,"-format-context-menu-item-desc")),r.titleElement.text(t),r.descElement.text(n),r.children(r.iconElement),r.children(r.titleElement),r.children(r.descElement),je.push(Ce(r)),r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pe(t,e)}(e,t),n=e,(r=[{key:"setTitle",value:function(t){this.titleElement.text(t)}},{key:"setDesc",value:function(t){this.descElement.text(t)}},{key:"setActive",value:function(){je.forEach((function(t){t.removeClass("active")})),this.addClass("active")}}])&&Te(n.prototype,r),i&&Te(n,i),e}(_e);function Le(t){return(Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Re(t,e){return!e||"object"!==Le(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ve(t){return(Ve=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ne(t,e){return(Ne=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var We=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Re(this,Ve(e).call(this,"".concat(o,"-el-context-menu-item-divider")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ne(t,e)}(e,t),e}(V);function De(t){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function He(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Me(t,e){return!e||"object"!==De(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Be(t){return(Be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ie(t,e){return(Ie=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ye=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Me(this,Be(e).call(this,"".concat(o,"-format-context-menu"),_.mergeDeep({onUpdate:function(){}},n)))).items=[new Ae("常规","").data("type","default"),new Ae("文本","").data("type","text"),new We,new Ae("数值","0.59").data("type","number"),new Ae("百分比","90.00%").data("type","percentage"),new Ae("分数","1/2").data("type","fraction"),new Ae("科学计数","9.50e-01").data("type","ENotation"),new We,new Ae("人民币","￥5.00").data("type","rmb"),new Ae("港币","HK5.00").data("type","hk"),new Ae("美元","$5.00").data("type","dollar"),new We,new Ae("日期","2018/4/18").data("type","date1"),new Ae("日期","4月18日").data("type","date2"),new Ae("日期","2018年4月").data("type","date3"),new Ae("日期","2018年4月18日").data("type","date4"),new Ae("日期","2018/4/18 14:30:30").data("type","date5"),new Ae("时间","14:30:30").data("type","time")],t.items.forEach((function(e){e instanceof Ae&&e.data("type")&&e.on(r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.data("type"),e.title),e.setActive()})),t.addItem(e)})),t.init(),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ie(t,e)}(e,t),n=e,(i=[{key:"init",value:function(){var t=this.options,e=this.items,n=t.el,r=e[0];n.setTitle(r.title),r.setActive()}},{key:"update",value:function(t,e){this.options.onUpdate(t,e),this.close()}},{key:"setActiveByType",value:function(t){this.items.forEach((function(e){e.data("type")===t&&e.setActive()}))}}])&&He(n.prototype,i),c&&He(n,c),e}(we);function Fe(t){return(Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ue(t){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ze(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ge(t,e){return(Ge=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xe=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(i=Ue(e).call(this,"".concat(o,"-tools-format")))||"object"!==Fe(i)&&"function"!=typeof i?ze(r):i).options=_.copyProp({contextMenu:{}},t),n.setTitle("常规"),n.setWidth(50),n.setEllipsis(),n.formatContextMenu=new Ye(_.copyProp({el:ze(n),position:ue.BOTTOM},n.options.contextMenu)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ge(t,e)}(e,t),e}(Rt);function Ke(t){return(Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $e(t){return($e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ze(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Je(t,e){return(Je=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qe=[],tn=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(i=$e(e).call(this,"".concat(o,"-font-context-menu-item")))||"object"!==Ke(i)&&"function"!=typeof i?Ze(r):i).title=t,n.icon=new et("checked"),n.iconElement=C("div","".concat(o,"-font-context-menu-item-icon")),n.iconElement.children(n.icon),n.titleElement=C("div","".concat(o,"-font-context-menu-item-title")),n.titleElement.text(t),n.titleElement.css("font-family",t),n.children(n.iconElement),n.children(n.titleElement),Qe.push(Ze(n)),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Je(t,e)}(e,t),n=e,(r=[{key:"setTitle",value:function(t){this.title=t,this.titleElement.text(t)}},{key:"setActive",value:function(){Qe.forEach((function(t){t.removeClass("active")})),this.addClass("active")}}])&&qe(n.prototype,r),i&&qe(n,i),e}(_e);function en(t){return(en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rn(t,e){return!e||"object"!==en(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function on(t){return(on=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cn(t,e){return(cn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ln=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=rn(this,on(e).call(this,"".concat(o,"-font-context-menu"),_.mergeDeep({onUpdate:function(){}},n)))).items=[new tn("Arial"),new tn("Helvetica"),new tn("Source Sans Pro"),new tn("Comic Sans Ms"),new tn("Courier New"),new tn("Verdana"),new tn("Lalo")],t.items.forEach((function(e){e.on(r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.title),e.setActive()})),t.addItem(e)})),t.setActiveByType(t.items[0].title),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cn(t,e)}(e,t),n=e,(i=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}},{key:"setActiveByType",value:function(t){this.items.forEach((function(e){e.title===t&&e.setActive()}))}}])&&nn(n.prototype,i),c&&nn(n,c),e}(we);function sn(t){return(sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function an(t){return(an=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function un(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fn(t,e){return(fn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hn=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(i=an(e).call(this,"".concat(o,"-tools-font")))||"object"!==sn(i)&&"function"!=typeof i?un(r):i).options=_.copyProp({contextMenu:{}},t),n.setTitle("Arial"),n.setWidth(50),n.setEllipsis(),n.fontContextMenu=new ln(_.copyProp({el:un(n),position:ue.BOTTOM},n.options.contextMenu)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fn(t,e)}(e,t),e}(Rt);function pn(t){return(pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yn(t,e){return!e||"object"!==pn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bn(t){return(bn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dn(t,e){return(dn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gn=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=yn(this,bn(e).call(this,"".concat(o,"-font-size-context-menu-item")))).size=t,n.titleElement=C("div","".concat(o,"-font-size-context-menu-item-title")),n.titleElement.text(t),n.titleElement.css("text-align","center"),n.children(n.titleElement),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dn(t,e)}(e,t),e}(_e);function vn(t){return(vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mn(t,e){return!e||"object"!==vn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sn(t){return(Sn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function On(t,e){return(On=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var En=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=mn(this,Sn(e).call(this,"".concat(o,"-font-size-context-menu"),_.mergeDeep({onUpdate:function(){}},n)))).items=[new gn(6),new gn(7),new gn(8),new gn(9),new gn(10),new gn(11),new gn(12),new gn(14),new gn(15),new gn(18),new gn(24),new gn(36)],t.items.forEach((function(e){e.on(r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.size)})),t.addItem(e)})),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&On(t,e)}(e,t),n=e,(i=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}}])&&wn(n.prototype,i),c&&wn(n,c),e}(we);function _n(t){return(_n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xn(t){return(xn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kn(t,e){return(kn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Cn=function(t){function e(){var t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(r=xn(e).call(this,"".concat(o,"-tools-font-size")))||"object"!==_n(r)&&"function"!=typeof r?Tn(n):r).options=i,t.setTitle("10"),t.setWidth(30),t.setEllipsis(),t.fontSizeContextMenu=new En(_.copyProp({el:Tn(t),position:ue.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kn(t,e)}(e,t),e}(Rt);function Pn(t){return(Pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jn(t,e){return!e||"object"!==Pn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function An(t){return(An=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ln(t,e){return(Ln=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=jn(this,An(e).call(this,"".concat(o,"-tools-font-bold")))).icon=new et("font-bold"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ln(t,e)}(e,t),e}(ct);function Vn(t){return(Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nn(t,e){return!e||"object"!==Vn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wn(t){return(Wn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dn(t,e){return(Dn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Nn(this,Wn(e).call(this,"".concat(o,"-tools-font-italic")))).icon=new et("font-italic"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dn(t,e)}(e,t),e}(ct);function Mn(t){return(Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bn(t,e){return!e||"object"!==Mn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function In(t){return(In=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yn(t,e){return(Yn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Bn(this,In(e).call(this,"".concat(o,"-tools-under-line")))).icon=new et("under-line"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yn(t,e)}(e,t),e}(ct);function Un(t){return(Un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zn(t,e){return!e||"object"!==Un(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gn(t){return(Gn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xn(t,e){return(Xn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Kn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=zn(this,Gn(e).call(this,"".concat(o,"-tools-font-strike")))).icon=new et("font-strike"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xn(t,e)}(e,t),e}(ct);function qn(t){return(qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $n(t,e){return!e||"object"!==qn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zn(t){return(Zn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jn(t,e){return(Jn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qn=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=$n(this,Zn(e).call(this,"".concat(o,"-font-color-context-menu-item")))).title=t,r.icon=n,n&&(r.iconElement=C("div","".concat(o,"-font-color-context-menu-item-icon")),r.iconElement.children(r.icon),r.children(r.iconElement)),t&&(r.titleElement=C("div","".concat(o,"-font-color-context-menu-item-title")),r.titleElement.text(t),r.children(r.titleElement)),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jn(t,e)}(e,t),e}(_e);function tr(t){return(tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function er(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rr(t,e){return(rr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function or(t,e,n){return(or="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ir(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ir(t){return(ir=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var cr=[],lr=null,sr={LEFT:1,TOP:2,RIGHT:3,CENTER:4},ar=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(i=ir(e).call(this,"".concat(o,"-drag-panel")))||"object"!==tr(i)&&"function"!=typeof i?nr(r):i).options=_.mergeDeep({position:sr.CENTER},t),n.off=!0,n.mask=C("div","".concat(o,"-drag-panel-mask")),n.content=C("div","".concat(o,"-drag-panel-content")),or(ir(e.prototype),"children",nr(n)).call(nr(n),n.content),n.bind(),cr.push(nr(n)),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rr(t,e)}(e,t),n=e,c=[{key:"closeAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];cr.forEach((function(e){-1===t.indexOf(e)&&e.close()}))}},{key:"setRoot",value:function(t){t=t.el?C(t.el):C(t),lr=t}}],(i=[{key:"bind",value:function(){var t=this,e=this.mask;Nt.bind(e,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.close(),e.stopPropagation()})),Nt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(0===e.button){var n=t.computeEventXy(e,t);Nt.mouseMoveUp(C(document),(function(e){var r=e.pageY-n.y,o=e.pageX-n.x;t.offset({top:r,left:o}),e.stopPropagation(),e.preventDefault()})),e.stopPropagation(),e.preventDefault()}}))}},{key:"position",value:function(){var t=this.options.position,e=_.viewPort(),n=e.width,r=e.height,o=this.box();switch(t){case sr.LEFT:case sr.RIGHT:case sr.TOP:break;case sr.CENTER:this.offset({left:n/2-o.width/2,top:r/2-o.height/2})}}},{key:"open",value:function(){if(this.off&&lr){var t=this.mask;lr.children(t),lr.children(this),this.position(),this.off=!1}}},{key:"close",value:function(){if(!1===this.off&&lr){var t=this.mask;lr.remove(this),lr.remove(t),this.off=!0}}},{key:"children",value:function(){var t;(t=this.content).children.apply(t,arguments)}}])&&er(n.prototype,i),c&&er(n,c),e}(V);function ur(t){return(ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hr(t){return(hr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yr(t,e){return(yr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var br=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(i=hr(e).call(this,"".concat(o,"-color-picker")))||"object"!==ur(i)&&"function"!=typeof i?pr(r):i).options=_.mergeDeep({selectCb:function(){}},t),n.dragPanel=new ar,n.color=[360,0,100],n.preViewColorPoint=C("div","".concat(o,"-color-picker-pre-view-color-point")),n.colorValueTips=C("div","".concat(o,"-color-picker-color-value-tips")),n.colorValueTips.text("十六进制颜色值"),n.colorInput=C("input","".concat(o,"-color-picker-color-input")),n.top=C("div","".concat(o,"-color-picker-top")),n.top.children(n.preViewColorPoint),n.top.children(n.colorValueTips),n.top.children(n.colorInput),n.selectColorPoint=C("div","".concat(o,"-color-picker-select-color-point")),n.selectColorArea1=C("div","".concat(o,"-color-picker-select-color-area area1")),n.selectColorArea2=C("div","".concat(o,"-color-picker-select-color-area area2")),n.selectColorArea3=C("div","".concat(o,"-color-picker-select-color-area area3")),n.center=C("div","".concat(o,"-color-picker-center")),n.center.children(n.selectColorArea1),n.center.children(n.selectColorArea2),n.center.children(n.selectColorArea3),n.center.children(n.selectColorPoint),n.colorHuxTips=C("div","".concat(o,"-color-picker-color-hux-tips")),n.colorBar=C("div","".concat(o,"-color-picker-color-bar")),n.colorBarPoint=C("div","".concat(o,"-color-picker-bar-point")),n.bottom=C("div","".concat(o,"-color-picker-bottom")),n.colorHuxTips.text("HUE"),n.colorBar.children(n.colorBarPoint),n.bottom.children(n.colorHuxTips),n.bottom.children(n.colorBar),n.cancelButton=C("div","".concat(o,"-color-picker-button cancel")),n.selectButton=C("div","".concat(o,"-color-picker-button select")),n.buttons=C("div","".concat(o,"-color-picker-buttons")),n.cancelButton.text("取消"),n.selectButton.text("确定"),n.buttons.children(n.selectButton),n.buttons.children(n.cancelButton),n.children(n.top),n.children(n.center),n.children(n.bottom),n.children(n.buttons),n.dragPanel.children(pr(n)),n.dragPanel.css("background","#ffffff"),n.bind(),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yr(t,e)}(e,t),n=e,c=[{key:"fixHex",value:function(t){var e=6-t.length;if(e>0){for(var n=[],r=0;r<e;r+=1)n.push("0");n.push(t),t=n.join("")}return t}},{key:"fixHsx",value:function(t){return{h:Math.min(360,Math.max(0,t.h)),s:Math.min(100,Math.max(0,t.s)),x:Math.min(100,Math.max(0,t.x))}}},{key:"hexToRgb",value:function(t){return{r:(t=parseInt(t.indexOf("#")>-1?t.substring(1):t,16))>>16,g:(65280&t)>>8,b:255&t}}},{key:"hexToHsb",value:function(t){return this.rgbToHsb(this.hexToRgb(t))}},{key:"rgbToHsb",value:function(t){var e={h:0,s:0,x:0},n=Math.min(t.r,t.g,t.b),r=Math.max(t.r,t.g,t.b),o=r-n;return e.x=r,e.s=0!==r?255*o/r:0,0!==e.s?t.r===r?e.h=(t.g-t.b)/o:t.g===r?e.h=2+(t.b-t.r)/o:e.h=4+(t.r-t.g)/o:e.h=-1,e.h*=60,e.h<0&&(e.h+=360),e.s*=100/255,e.x*=100/255,e}},{key:"hsbToRgb",value:function(t){var e={},n=t.h,r=255*t.s/100,o=255*t.x/100;if(0===r)e.r=o,e.g=o,e.b=o;else{var i=o,c=(255-r)*o/255,l=n%60*(i-c)/60;360===n&&(n=0),n<60?(e.r=i,e.b=c,e.g=c+l):n<120?(e.g=i,e.b=c,e.r=i-l):n<180?(e.g=i,e.r=c,e.b=c+l):n<240?(e.b=i,e.r=c,e.g=i-l):n<300?(e.b=i,e.g=c,e.r=c+l):n<360?(e.r=i,e.g=c,e.b=i-l):(e.r=0,e.g=0,e.b=0)}return{r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)}}},{key:"rgbToHex",value:function(t){var e=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return e.forEach((function(t,n){1===t.length&&(e[n]="0".concat(t))})),e.join("")}},{key:"hsbToHex",value:function(t){return this.rgbToHex(this.hsbToRgb(t))}},{key:"isRgb",value:function(t){return t.startsWith("rgb")}},{key:"isHex",value:function(t){return t.startsWith("#")}},{key:"parseRgb",value:function(t){var e=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return{r:e[1],g:e[2],b:e[3]}}},{key:"isDark",value:function(t){if(_.isBlank(t))return!1;if(this.isHex(t)){var n=e.hexToRgb(t);t="rgb(".concat(n.r,", ").concat(n.g,", ").concat(n.b,")")}var r=e.parseRgb(t);return.299*r.r+.578*r.g+.114*r.b>=192}}],(i=[{key:"bind",value:function(){var t=this,n=this.selectColorPoint,o=this.center,i=this.colorBarPoint,c=this.colorBar,l=this.colorInput,s=this.cancelButton,a=this.selectButton;Nt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){t.stopPropagation()})),Nt.bind(n,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.computeEventXy(e,o),r=o.box();n.x<0&&(n.x=0),n.x>r.width&&(n.x=r.width),n.y<0&&(n.y=0),n.y>r.height&&(n.y=r.height),t.downSelect(n.x,n.y,r.width,r.height),Nt.mouseMoveUp(C(document),(function(e){var n=t.computeEventXy(e,o);n.x<0&&(n.x=0),n.x>r.width&&(n.x=r.width),n.y<0&&(n.y=0),n.y>r.height&&(n.y=r.height),t.moveSelect(n.x,n.y,r.width,r.height)}))})),Nt.bind(i,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.computeEventXy(e,c),r=c.box();n.x<0&&(n.x=0),n.x>r.width&&(n.x=r.width),t.downHue(n.x,r.width),Nt.mouseMoveUp(C(document),(function(e){var n=t.computeEventXy(e,c),r=c.box();n.x<0&&(n.x=0),n.x>r.width&&(n.x=r.width),t.moveHue(n.x,r.width)}))})),Nt.bind(l,r.SYSTEM_EVENT_TYPE.CHANGE,(function(){var e=l.val();e&&t.hexColor(e)})),Nt.bind(s,r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.close()})),Nt.bind(a,r.SYSTEM_EVENT_TYPE.CLICK,(function(){var n=t.color,r=e.fixHsx({h:parseInt(n[0],10),s:parseInt(n[1],10),x:parseInt(n[2],10)}),o=e.hsbToHex(r);t.options.selectCb("#".concat(o)),t.close()}))}},{key:"open",value:function(t){if(this.dragPanel.open(),t){if(e.isRgb(t)){var n=e.parseRgb(t);t=e.rgbToHex(n)}this.hexColor(t)}else this.change();return this}},{key:"close",value:function(){return this.dragPanel.close(),this}},{key:"sliderPosition",value:function(t){var e=this.colorBar,n=this.colorBarPoint,r=n.box(),o=e.box(),i=parseInt(o.width-o.width*t.h/360,10);i-=r.width/2,n.offset({left:i});var c=this.center,l=this.selectColorPoint,s=l.box(),a=c.box(),u=parseInt(a.width*t.s/100,10),f=parseInt(a.height*(100-t.x)/100,10);u-=s.width/2,f-=s.height/2,l.offset({left:u,top:f})}},{key:"hueChange",value:function(){var t=this.color,n=e.fixHsx({h:parseInt(t[0],10),s:parseInt(t[1],10),x:parseInt(t[2],10)}),r=this.colorBarPoint,o=this.selectColorPoint,i=this.preViewColorPoint,c=this.selectColorArea1,l=this.colorInput,s=e.hsbToHex(n),a=e.hsbToHex({h:n.h,s:100,x:100});o.css("backgroundColor","#".concat(s)),i.css("backgroundColor","#".concat(s)),r.css("backgroundColor","#".concat(a)),c.css("backgroundColor","#".concat(a)),l.val("#".concat(s)),this.sliderPosition(n)}},{key:"selectChange",value:function(){var t=this.color,n=e.fixHsx({h:parseInt(t[0],10),s:parseInt(t[1],10),x:parseInt(t[2],10)}),r=this.preViewColorPoint,o=this.selectColorPoint,i=this.colorInput,c=e.hsbToHex(n);o.css("backgroundColor","#".concat(c)),r.css("backgroundColor","#".concat(c)),i.val("#".concat(c)),this.sliderPosition(n)}},{key:"change",value:function(){this.hueChange(),this.selectChange()}},{key:"downSelect",value:function(t,e,n,r){var o=this.color;o[1]=parseInt(100*t/n,10),o[2]=parseInt(100*(r-e)/r,10),this.selectChange()}},{key:"moveSelect",value:function(t,e,n,r){var o=this.color;o[1]=parseInt(100*Math.max(0,Math.min(n,t))/n,10),o[2]=parseInt(100*(r-Math.max(0,Math.min(r,e)))/r,10),this.selectChange()}},{key:"downHue",value:function(t,e){this.color[0]=parseInt(360*(e-t)/e,10),this.hueChange()}},{key:"moveHue",value:function(t,e){this.color[0]=parseInt(360*(e-Math.max(0,Math.min(e,t)))/e,10),this.hueChange()}},{key:"hexColor",value:function(t){var n=this.color,r=e.hexToHsb(e.fixHex(t));n[0]=r.h,n[1]=r.s,n[2]=r.x,this.change()}}])&&fr(n.prototype,i),c&&fr(n,c),e}(V);function dr(t){return(dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vr(t,e){return!e||"object"!==dr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wr(t){return(wr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mr(t,e){return(mr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Sr=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=vr(this,wr(e).call(this,"".concat(o,"-color-array-item")))).options=_.mergeDeep({color:null,icon:null},t),n.color=n.options.color,n.icon=n.options.icon,n.color&&(n.css("backgroundColor",n.color),br.isDark(n.options.color)?(n.checkedIcon=new et("checked-dark"),n.children(n.checkedIcon)):(n.checkedIcon=new et("checked-light"),n.children(n.checkedIcon)),n.checkedIcon.hide()),n.icon&&n.children(n.options.icon),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mr(t,e)}(e,t),n=e,(r=[{key:"setActive",value:function(t){this.checkedIcon&&(t?this.checkedIcon.show():this.checkedIcon.hide())}}])&&gr(n.prototype,r),i&&gr(n,i),e}(V);function Or(t){return(Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Er(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _r(t,e){return!e||"object"!==Or(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xr(t){return(xr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tr(t,e){return(Tr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kr=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=_r(this,xr(e).call(this,"".concat(o,"-color-array")))).options=_.mergeDeep({colors:[new Sr({color:"rgb(0,0,0)"}),new Sr({color:"rgb(67, 67, 67)"}),new Sr({color:"rgb(102, 102, 102)"}),new Sr({color:"rgb(153, 153, 153)"}),new Sr({color:"rgb(183, 183, 183)"}),new Sr({color:"rgb(204, 204, 204)"}),new Sr({color:"rgb(217, 217, 217)"}),new Sr({color:"rgb(239, 239, 239)"}),new Sr({color:"rgb(255, 255, 255)"}),new Sr({color:"rgb(152, 0, 0)"}),new Sr({color:"rgb(255, 0, 0)"}),new Sr({color:"rgb(255, 153, 0)"}),new Sr({color:"rgb(255, 255, 0)"}),new Sr({color:"rgb(0, 255, 0)"}),new Sr({color:"rgb(0, 255, 255)"}),new Sr({color:"rgb(74, 134, 232)"}),new Sr({color:"rgb(0, 0, 255)"}),new Sr({color:"rgb(153, 0, 255)"}),new Sr({color:"rgb(255, 0, 255)"}),new Sr({color:"rgb(230, 184, 175)"}),new Sr({color:"rgb(244, 204, 204)"}),new Sr({color:"rgb(252, 229, 205)"}),new Sr({color:"rgb(255, 242, 204)"}),new Sr({color:"rgb(217, 234, 211)"}),new Sr({color:"rgb(208, 224, 227)"}),new Sr({color:"rgb(201, 218, 248)"}),new Sr({color:"rgb(207, 226, 243)"}),new Sr({color:"rgb(217, 210, 233)"}),new Sr({color:"rgb(234, 209, 220)"}),new Sr({color:"rgb(221, 126, 107)"}),new Sr({color:"rgb(234, 153, 153)"}),new Sr({color:"rgb(249, 203, 156)"}),new Sr({color:"rgb(255, 229, 153)"}),new Sr({color:"rgb(182, 215, 168)"}),new Sr({color:"rgb(162, 196, 201)"}),new Sr({color:"rgb(164, 194, 244)"}),new Sr({color:"rgb(159, 197, 232)"}),new Sr({color:"rgb(180, 167, 214)"}),new Sr({color:"rgb(213, 166, 189)"}),new Sr({color:"rgb(204, 65, 37)"}),new Sr({color:"rgb(224, 102, 102)"}),new Sr({color:"rgb(246, 178, 107)"}),new Sr({color:"rgb(255, 217, 102)"}),new Sr({color:"rgb(147, 196, 125)"}),new Sr({color:"rgb(118, 165, 175)"}),new Sr({color:"rgb(109, 158, 235)"}),new Sr({color:"rgb(111, 168, 220)"}),new Sr({color:"rgb(142, 124, 195)"}),new Sr({color:"rgb(194, 123, 160)"}),new Sr({color:"rgb(166, 28, 0)"}),new Sr({color:"rgb(204, 0, 0)"}),new Sr({color:"rgb(230, 145, 56)"}),new Sr({color:"rgb(241, 194, 50)"}),new Sr({color:"rgb(106, 168, 79)"}),new Sr({color:"rgb(69, 129, 142)"}),new Sr({color:"rgb(60, 120, 216)"}),new Sr({color:"rgb(61, 133, 198)"}),new Sr({color:"rgb(103, 78, 167)"}),new Sr({color:"rgb(166, 77, 121)"}),new Sr({color:"rgb(133, 32, 12)"}),new Sr({color:"rgb(153, 0, 0)"}),new Sr({color:"rgb(180, 95, 6)"}),new Sr({color:"rgb(191, 144, 0)"}),new Sr({color:"rgb(56, 118, 29)"}),new Sr({color:"rgb(19, 79, 92)"}),new Sr({color:"rgb(17, 85, 204)"}),new Sr({color:"rgb(11, 83, 148)"}),new Sr({color:"rgb(53, 28, 117)"}),new Sr({color:"rgb(116, 27, 71)"}),new Sr({color:"rgb(91, 15, 0)"}),new Sr({color:"rgb(102, 0, 0)"}),new Sr({color:"rgb(120, 63, 4)"}),new Sr({color:"rgb(127, 96, 0)"}),new Sr({color:"rgb(39, 78, 19)"}),new Sr({color:"rgb(12, 52, 61)"}),new Sr({color:"rgb(28, 69, 135)"}),new Sr({color:"rgb(7, 55, 99)"}),new Sr({color:"rgb(32, 18, 77)"}),new Sr({color:"rgb(76, 17, 48)"})],selectCb:function(){}},t),n.colors=n.options.colors,n.activeColor=null,n.colors.forEach((function(t){n.children(t),t.on(r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){n.options.selectCb(t),t.options.color&&n.setActiveByColor(t.options.color)}))})),n.colors.length>0&&n.setActiveByColor(n.colors[0].options.color),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tr(t,e)}(e,t),n=e,(i=[{key:"add",value:function(t){var e=this;t.on(r.SYSTEM_EVENT_TYPE.CLICK,(function(){e.options.selectCb(t),t.options.color&&e.setActiveByColor(t.options.color)})),this.colors.push(t),this.children(t)}},{key:"setActiveByColor",value:function(t){var e=this;this.colors.forEach((function(n){var r=n.options;r.color===t?(n.setActive(!0),e.activeColor=r.color):n.setActive(!1)}))}}])&&Er(n.prototype,i),c&&Er(n,c),e}(V);function Cr(t){return(Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jr(t,e){return!e||"object"!==Cr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ar(t){return(Ar=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Lr(t,e){return(Lr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rr=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=jr(this,Ar(e).call(this,"".concat(o,"-font-color-context-menu"),_.mergeDeep({onUpdate:function(){}},n)))).colorPicker=new br({selectCb:function(e){var n=new Sr({color:e});t.customizeColorArray.add(n),t.customizeColorArray.setActiveByColor(e),t.colorArray.setActiveByColor(null),t.options.onUpdate(e),t.close()}}),t.reset=new Qn("重置",new et("clear-color")),t.reset.on(r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.options.onUpdate("rgb(0,0,0)"),t.customizeColorArray.setActiveByColor(null),t.colorArray.setActiveByColor(null)})),t.array=new Qn,t.array.removeClass("hover"),t.colorArray=new kr({selectCb:function(e){var n=e.options.color;n&&t.options.onUpdate(n),t.customizeColorArray.setActiveByColor(null),t.close()}}),t.array.children(t.colorArray),t.title=C("div","".concat(o,"-font-color-context-menu-color-title")),t.title.text("自定义"),t.plus=new et("plus"),t.customizeColorArray=new kr({colors:[new Sr({icon:t.plus})],selectCb:function(e){var n=e.options.color;n?(t.options.onUpdate(n),t.colorArray.setActiveByColor(null),t.close()):t.colorPicker.open(t.customizeColorArray.activeColor)}}),t.customize=new Qn,t.customize.removeClass("hover"),t.customize.children(t.title),t.customize.children(t.customizeColorArray),t.addItem(t.reset),t.addItem(t.array),t.addItem(new We),t.addItem(t.customize),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lr(t,e)}(e,t),n=e,(i=[{key:"setActiveByColor",value:function(t){this.customizeColorArray.setActiveByColor(t),this.colorArray.setActiveByColor(t)}}])&&Pr(n.prototype,i),c&&Pr(n,c),e}(we);function Vr(t){return(Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wr(t){return(Wr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Hr(t,e){return(Hr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mr=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(i=Wr(e).call(this,"".concat(o,"-tools-font-color")))||"object"!==Vr(i)&&"function"!=typeof i?Dr(r):i).options=_.mergeDeep({contextMenu:{}},t),n.icon=new et("color"),n.fontColorContextMenu=new Rr(_.copyProp({el:Dr(n),position:ue.BOTTOM},n.options.contextMenu)),n.setIcon(n.icon),n.setColor("rgb(0,0,0)"),n.fontColorContextMenu.setActiveByColor("rgb(0,0,0)"),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hr(t,e)}(e,t),n=e,(r=[{key:"setColor",value:function(t){this.icon.css("border-bottom","3px solid ".concat(t))}}])&&Nr(n.prototype,r),i&&Nr(n,i),e}(Rt);function Br(t){return(Br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ir(t,e){return!e||"object"!==Br(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yr(t){return(Yr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fr(t,e){return(Fr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ur=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Ir(this,Yr(e).call(this,"".concat(o,"-fill-color-context-menu-item")))).title=t,r.icon=n,n&&(r.iconElement=C("div","".concat(o,"-fill-color-context-menu-item-icon")),r.iconElement.children(r.icon),r.children(r.iconElement)),t&&(r.titleElement=C("div","".concat(o,"-fill-color-context-menu-item-title")),r.titleElement.text(t),r.children(r.titleElement)),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fr(t,e)}(e,t),e}(_e);function zr(t){return(zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xr(t,e){return!e||"object"!==zr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Kr(t){return(Kr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qr(t,e){return(qr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $r=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Xr(this,Kr(e).call(this,"".concat(o,"-font-color-context-menu"),_.mergeDeep({onUpdate:function(){}},n)))).colorPicker=new br({selectCb:function(e){var n=new Sr({color:e});t.customizeColorArray.add(n),t.customizeColorArray.setActiveByColor(e),t.colorArray.setActiveByColor(null),t.options.onUpdate(e),t.close()}}),t.reset=new Ur("重置",new et("clear-color")),t.reset.on(r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.options.onUpdate(null),t.customizeColorArray.setActiveByColor(null),t.colorArray.setActiveByColor(null)})),t.array=new Ur,t.array.removeClass("hover"),t.colorArray=new kr({selectCb:function(e){var n=e.options.color;n&&t.options.onUpdate(n),t.customizeColorArray.setActiveByColor(null),t.close()}}),t.array.children(t.colorArray),t.title=C("div","".concat(o,"-font-color-context-menu-color-title")),t.title.text("自定义"),t.plus=new et("plus"),t.customizeColorArray=new kr({colors:[new Sr({icon:t.plus})],selectCb:function(e){var n=e.options.color;n?(t.options.onUpdate(n),t.colorArray.setActiveByColor(null),t.close()):t.colorPicker.open(t.customizeColorArray.activeColor)}}),t.customize=new Ur,t.customize.removeClass("hover"),t.customize.children(t.title),t.customize.children(t.customizeColorArray),t.addItem(t.reset),t.addItem(t.array),t.addItem(new We),t.addItem(t.customize),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qr(t,e)}(e,t),n=e,(i=[{key:"setActiveByColor",value:function(t){this.customizeColorArray.setActiveByColor(t),this.colorArray.setActiveByColor(t)}}])&&Gr(n.prototype,i),c&&Gr(n,c),e}(we);function Zr(t){return(Zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qr(t){return(Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function to(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function eo(t,e){return(eo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var no=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(i=Qr(e).call(this,"".concat(o,"-tools-fill-color")))||"object"!==Zr(i)&&"function"!=typeof i?to(r):i).options=_.mergeDeep({contextMenu:{}},t),n.icon=new et("fill-color"),n.fillColorContextMenu=new $r(_.copyProp({el:to(n),position:ue.BOTTOM},n.options.contextMenu)),n.setIcon(n.icon),n.setColor("rgb(255, 255, 255)"),n.fillColorContextMenu.setActiveByColor("rgb(255, 255, 255)"),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&eo(t,e)}(e,t),n=e,(r=[{key:"setColor",value:function(t){this.icon.css("border-bottom","3px solid ".concat(t))}}])&&Jr(n.prototype,r),i&&Jr(n,i),e}(Rt);function ro(t){return(ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oo(t,e){return!e||"object"!==ro(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function io(t){return(io=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function co(t,e){return(co=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var lo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),oo(this,io(e).call(this,"".concat(o,"-border-type-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&co(t,e)}(e,t),e}(_e);function so(t){return(so="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ao(t,e){return!e||"object"!==so(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function uo(t){return(uo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fo(t,e){return(fo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ho=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ao(this,uo(e).call(this,"".concat(o,"-tools-border1")))).icon=new et("border1"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fo(t,e)}(e,t),e}(ct);function po(t){return(po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yo(t,e){return!e||"object"!==po(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bo(t){return(bo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function go(t,e){return(go=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vo=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=yo(this,bo(e).call(this,"".concat(o,"-tools-border2")))).icon=new et("border2"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&go(t,e)}(e,t),e}(ct);function wo(t){return(wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mo(t,e){return!e||"object"!==wo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function So(t){return(So=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oo(t,e){return(Oo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Eo=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=mo(this,So(e).call(this,"".concat(o,"-tools-border3")))).icon=new et("border3"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oo(t,e)}(e,t),e}(ct);function _o(t){return(_o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xo(t,e){return!e||"object"!==_o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function To(t){return(To=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ko(t,e){return(ko=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Co=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=xo(this,To(e).call(this,"".concat(o,"-tools-border4")))).icon=new et("border4"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ko(t,e)}(e,t),e}(ct);function Po(t){return(Po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jo(t,e){return!e||"object"!==Po(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ao(t){return(Ao=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Lo(t,e){return(Lo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ro=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=jo(this,Ao(e).call(this,"".concat(o,"-tools-border5")))).icon=new et("border5"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lo(t,e)}(e,t),e}(ct);function Vo(t){return(Vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function No(t,e){return!e||"object"!==Vo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wo(t){return(Wo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Do(t,e){return(Do=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ho=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=No(this,Wo(e).call(this,"".concat(o,"-tools-border6")))).icon=new et("border6"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Do(t,e)}(e,t),e}(ct);function Mo(t){return(Mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bo(t,e){return!e||"object"!==Mo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Io(t){return(Io=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yo(t,e){return(Yo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fo=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Bo(this,Io(e).call(this,"".concat(o,"-tools-border7")))).icon=new et("border7"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yo(t,e)}(e,t),e}(ct);function Uo(t){return(Uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zo(t,e){return!e||"object"!==Uo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Go(t){return(Go=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xo(t,e){return(Xo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ko=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=zo(this,Go(e).call(this,"".concat(o,"-tools-border8")))).icon=new et("border8"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xo(t,e)}(e,t),e}(ct);function qo(t){return(qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $o(t,e){return!e||"object"!==qo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zo(t){return(Zo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jo(t,e){return(Jo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qo=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=$o(this,Zo(e).call(this,"".concat(o,"-tools-border9")))).icon=new et("border9"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jo(t,e)}(e,t),e}(ct);function ti(t){return(ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ei(t,e){return!e||"object"!==ti(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ni(t){return(ni=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ri(t,e){return(ri=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var oi=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ei(this,ni(e).call(this,"".concat(o,"-tools-border10")))).icon=new et("border10"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ri(t,e)}(e,t),e}(ct);function ii(t){return(ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ci(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function li(t,e){return!e||"object"!==ii(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function si(t){return(si=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ai(t,e){return(ai=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ui=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=li(this,si(e).call(this,"".concat(o,"-tools-border-color")))).icon=new et("border-color"),t.setIcon(t.icon),t.setColor("#000000"),t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ai(t,e)}(e,t),n=e,(r=[{key:"setColor",value:function(t){this.icon.css("border-bottom","3px solid ".concat(t))}}])&&ci(n.prototype,r),i&&ci(n,i),e}(Rt);function fi(t){return(fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hi(t,e){return!e||"object"!==fi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pi(t){return(pi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yi(t,e){return(yi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bi=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=hi(this,pi(e).call(this,"".concat(o,"-tools-border-type")))).icon=new et("border-type"),t.setIcon(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yi(t,e)}(e,t),e}(Rt);function di(t){return(di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gi(t,e){return!e||"object"!==di(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vi(t){return(vi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wi(t,e){return(wi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mi=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=gi(this,vi(e).call(this,"".concat(o,"-border-color-context-menu-item")))).title=t,r.icon=n,n&&(r.iconElement=C("div","".concat(o,"-border-color-context-menu-item-icon")),r.iconElement.children(r.icon),r.children(r.iconElement)),t&&(r.titleElement=C("div","".concat(o,"-border-color-context-menu-item-title")),r.titleElement.text(t),r.children(r.titleElement)),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wi(t,e)}(e,t),e}(_e);function Si(t){return(Si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ei(t,e){return!e||"object"!==Si(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _i(t){return(_i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xi(t,e){return(xi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ti=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ei(this,_i(e).call(this,"".concat(o,"-border-color-context-menu"),_.mergeDeep({onUpdate:function(){}},n)))).colorPicker=new br({selectCb:function(e){var n=new Sr({color:e});t.customizeColorArray.add(n),t.customizeColorArray.setActiveByColor(e),t.colorArray.setActiveByColor(null),t.options.onUpdate(e),t.close()}}),t.reset=new mi("重置",new et("clear-color")),t.reset.on(r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.options.onUpdate("rgb(0,0,0)"),t.customizeColorArray.setActiveByColor(null),t.colorArray.setActiveByColor(null)})),t.array=new mi,t.array.removeClass("hover"),t.colorArray=new kr({selectCb:function(e){var n=e.options.color;n&&t.options.onUpdate(n),t.customizeColorArray.setActiveByColor(null),t.close()}}),t.array.children(t.colorArray),t.title=C("div","".concat(o,"-border-color-context-menu-color-title")),t.title.text("自定义"),t.plus=new et("plus"),t.customizeColorArray=new kr({colors:[new Sr({icon:t.plus})],selectCb:function(e){var n=e.options.color;n?(t.options.onUpdate(n),t.colorArray.setActiveByColor(null),t.close()):t.colorPicker.open(t.customizeColorArray.activeColor)}}),t.customize=new mi,t.customize.removeClass("hover"),t.customize.children(t.title),t.customize.children(t.customizeColorArray),t.addItem(t.reset),t.addItem(t.array),t.addItem(new We),t.addItem(t.customize),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xi(t,e)}(e,t),n=e,(i=[{key:"setActiveByColor",value:function(t){this.customizeColorArray.setActiveByColor(t),this.colorArray.setActiveByColor(t)}}])&&Oi(n.prototype,i),c&&Oi(n,c),e}(we);function ki(t){return(ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ci(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pi(t){return(Pi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ji(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ai(t,e){return(Ai=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Li=[],Ri=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(i=Pi(e).call(this,"".concat(o,"-font-context-menu-item")))||"object"!==ki(i)&&"function"!=typeof i?ji(r):i).type=t,n.icon=new et("checked"),n.typeIcon=new et(t),n.typeIcon.setWidth(50),n.iconElement=C("div","".concat(o,"-font-context-menu-item-icon")),n.titleElement=C("div","".concat(o,"-font-context-menu-item-title")),n.iconElement.children(n.icon),n.titleElement.children(n.typeIcon),n.children(n.iconElement),n.children(n.titleElement),Li.push(ji(n)),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ai(t,e)}(e,t),n=e,(r=[{key:"setTitle",value:function(t){this.title=t,this.titleElement.text(t)}},{key:"setActive",value:function(){Li.forEach((function(t){t.removeClass("active")})),this.addClass("active")}}])&&Ci(n.prototype,r),i&&Ci(n,i),e}(_e);function Vi(t){return(Vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ni(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wi(t,e){return!e||"object"!==Vi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Di(t){return(Di=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hi(t,e){return(Hi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mi=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Wi(this,Di(e).call(this,"".concat(o,"-line-type-context-menu"),_.mergeDeep({onUpdate:function(){}},n)))).items=[new Ri("line1"),new Ri("line2"),new Ri("line3"),new Ri("line4"),new Ri("line5"),new Ri("line6")],t.items.forEach((function(e){e.on(r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.type),e.setActive()})),t.addItem(e)})),t.setActiveByType(t.items[0].type),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hi(t,e)}(e,t),n=e,(i=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}},{key:"setActiveByType",value:function(t){this.items.forEach((function(e){e.type===t&&e.setActive()}))}}])&&Ni(n.prototype,i),c&&Ni(n,c),e}(we);function Bi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ii(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yi(t,e,n){return e&&Ii(t.prototype,e),n&&Ii(t,n),t}var Fi={SOLID_LINE:0,DOTTED_LINE:1,POINT_LINE:2,DOUBLE_LINE:3},Ui=function(){function t(e,n){Bi(this,t),this.draw=e,_.mergeDeep(this,{color:"#000000",width:1},n)}return Yi(t,[{key:"drawLine",value:function(t,e,n,r){var o=this.draw,i=this.width,c=this.color;o.attr({lineWidth:i,strokeStyle:c}),o.setLineDash([]),o.line([t,e],[n,r])}},{key:"setColor",value:function(t){this.color=t}},{key:"setWidth",value:function(t){this.width=t}}]),t}(),zi=function(){function t(e,n){Bi(this,t),this.draw=e,_.mergeDeep(this,{color:"#000000",width:1,dash:[5]},n)}return Yi(t,[{key:"drawLine",value:function(t,e,n,r){var o=this.draw,i=this.dash,c=this.width,l=this.color;o.attr({lineWidth:c,strokeStyle:l}),o.setLineDash(i),o.line([t,e],[n,r])}},{key:"setColor",value:function(t){this.color=t}},{key:"setWidth",value:function(t){this.width=t}}]),t}(),Gi=function(){function t(e,n){Bi(this,t),this.draw=e,_.mergeDeep(this,{color:"#000000",width:1,padding:1,spacing:2,leftShow:function(){return!1},topShow:function(){return!1},rightShow:function(){return!1},bottomShow:function(){return!1},iFMerge:function(){return!1},iFMergeFirstRow:function(){return!1},iFMergeLastRow:function(){return!1},iFMergeFirstCol:function(){return!1},iFMergeLastCol:function(){return!1}},n)}return Yi(t,[{key:"handleExternal",value:function(t,e,n,r,o,i,c){var l={},s=this.leftShow,a=this.topShow,u=this.rightShow,f=this.bottomShow,h=this.iFMerge,p=this.iFMergeFirstRow,y=this.iFMergeLastRow,b=this.iFMergeFirstCol,d=this.iFMergeLastCol,g=this.spacing,v=null,w=null,m=null,S=null,O=null;switch(c){case"left":(v=h(o,i-1))&&(w=p(o,i-1),m=y(o,i-1),S=b(o,i-1),O=d(o,i-1));break;case"top":(v=h(o-1,i))&&(w=p(o-1,i),m=y(o-1,i),S=b(o-1,i),O=d(o-1,i));break;case"right":(v=h(o,i+1))&&(w=p(o,i+1),m=y(o,i+1),S=b(o,i+1),O=d(o,i+1));break;case"bottom":(v=h(o+1,i))&&(w=p(o+1,i),m=y(o+1,i),S=b(o+1,i),O=d(o+1,i))}if(v){switch(c){case"left":l.sx=t-g,l.ex=n-g;var E=f(o-1,i-1)||a(o,i-1),_=a(o,i),x=f(o-1,i);l.sy=e,(_||x)&&(l.sy=e-g),E&&w&&(l.sy=e+g);var T=a(o+1,i-1)||f(o,i-1),k=f(o,i),C=a(o+1,i);l.ey=r,(k||C)&&(l.ey=r+g),T&&m&&(l.ey=r-g);break;case"top":l.sy=e-g,l.ey=r-g;var P=u(o-1,i-1)||s(o-1,i),j=s(o,i),A=u(o,i-1);l.sx=t,(j||A)&&(l.sx=t-g),P&&S&&(l.sx=t+g);var L=s(o-1,i+1)||u(o-1,i),R=u(o,i),V=s(o,i+1);l.ex=n,(R||V)&&(l.ex=n+g),L&&O&&(l.ex=n-g);break;case"right":l.sx=t+g,l.ex=n+g;var N=f(o-1,i+1)||a(o,i+1),W=a(o,i),D=f(o-1,i);l.sy=e,(W||D)&&(l.sy=e-g),N&&w&&(l.sy=e+g);var H=a(o+1,i+1)||f(o,i+1),M=f(o,i),B=a(o+1,i);l.ey=r,(M||B)&&(l.ey=r+g),H&&m&&(l.ey=r-g);break;case"bottom":l.sy=e+g,l.ey=r+g;var I=u(o+1,i-1)||s(o+1,i),Y=s(o,i),F=u(o,i-1);l.sx=t,(Y||F)&&(l.sx=t-g),I&&S&&(l.sx=t+g);var U=s(o+1,i+1)||u(o+1,i),z=u(o,i),G=s(o,i+1);l.ex=n,(z||G)&&(l.ex=n+g),U&&O&&(l.ex=n-g)}return l}switch(c){case"left":l.sx=t-g,l.ex=n-g;var X=f(o-1,i-1)||a(o,i-1),K=a(o,i),q=f(o-1,i);l.sy=e,(K||q)&&(l.sy=e-g),X&&(l.sy=e+g);var $=a(o+1,i-1)||f(o,i-1),Z=f(o,i),J=a(o+1,i);l.ey=r,(Z||J)&&(l.ey=r+g),$&&(l.ey=r-g);break;case"top":l.sy=e-g,l.ey=r-g;var Q=u(o-1,i-1)||s(o-1,i),tt=s(o,i),et=u(o,i-1);l.sx=t,(tt||et)&&(l.sx=t-g),Q&&(l.sx=t+g);var nt=s(o-1,i+1)||u(o-1,i),rt=u(o,i),ot=s(o,i+1);l.ex=n,(rt||ot)&&(l.ex=n+g),nt&&(l.ex=n-g);break;case"right":l.sx=t+g,l.ex=n+g;var it=f(o-1,i+1)||a(o,i+1),ct=a(o,i),lt=f(o-1,i);l.sy=e,(ct||lt)&&(l.sy=e-g),it&&(l.sy=e+g);var st=a(o+1,i+1)||f(o,i+1),at=f(o,i),ut=a(o+1,i);l.ey=r,(at||ut)&&(l.ey=r+g),st&&(l.ey=r-g);break;case"bottom":l.sy=e+g,l.ey=r+g;var ft=u(o+1,i-1)||s(o+1,i),ht=s(o,i),pt=u(o,i-1);l.sx=t,(ht||pt)&&(l.sx=t-g),ft&&(l.sx=t+g);var yt=s(o+1,i+1)||u(o+1,i),bt=u(o,i),dt=s(o,i+1);l.ex=n,(bt||dt)&&(l.ex=n+g),yt&&(l.ex=n-g)}return l}},{key:"handleInternal",value:function(t,e,n,r,o,i,c){var l={},s=this.leftShow,a=this.topShow,u=this.rightShow,f=this.bottomShow,h=this.iFMerge,p=this.iFMergeFirstRow,y=this.iFMergeLastRow,b=this.iFMergeFirstCol,d=this.iFMergeLastCol,g=this.spacing;if(h(o,i)){var v=p(o,i),w=y(o,i),m=b(o,i),S=d(o,i);switch(c){case"left":l.sx=t+g,l.ex=n+g;var O=f(o-1,i-1)||a(o,i-1),E=a(o,i),_=f(o-1,i);l.sy=e,O&&(l.sy=e-g),(E||_)&&v&&(l.sy=e+g);var x=a(o+1,i-1)||f(o,i-1),T=f(o,i),k=a(o+1,i);l.ey=r,x&&(l.ey=r+g),(T||k)&&w&&(l.ey=r-g);break;case"top":l.sy=e+g,l.ey=r+g;var C=u(o-1,i-1)||s(o-1,i),P=s(o,i),j=u(o,i-1);l.sx=t,C&&(l.sx=t-g),(P||j)&&m&&(l.sx=t+g);var A=s(o-1,i+1)||u(o-1,i),L=u(o,i),R=s(o,i+1);l.ex=n,A&&(l.ex=n+g),(L||R)&&S&&(l.ex=n-g);break;case"right":l.sx=t-g,l.ex=n-g;var V=f(o-1,i+1)||a(o,i+1),N=a(o,i),W=f(o-1,i);l.sy=e,V&&(l.sy=e-g),(N||W)&&v&&(l.sy=e+g);var D=a(o+1,i+1)||f(o,i+1),H=f(o,i),M=a(o+1,i);l.ey=r,D&&(l.ey=r+g),(H||M)&&w&&(l.ey=r-g);break;case"bottom":l.sy=e-g,l.ey=r-g;var B=u(o+1,i-1)||s(o+1,i),I=s(o,i),Y=u(o,i-1);l.sx=t,B&&(l.sx=t-g),(I||Y)&&m&&(l.sx=t+g);var F=s(o+1,i+1)||u(o+1,i),U=u(o,i),z=s(o,i+1);l.ex=n,F&&(l.ex=n+g),(U||z)&&S&&(l.ex=n-g)}return l}switch(c){case"left":l.sx=t+g,l.ex=n+g;var G=f(o-1,i-1)||a(o,i-1),X=a(o,i),K=f(o-1,i);l.sy=e,G&&(l.sy=e-g),(X||K)&&(l.sy=e+g);var q=a(o+1,i-1)||f(o,i-1),$=f(o,i),Z=a(o+1,i);l.ey=r,q&&(l.ey=r+g),($||Z)&&(l.ey=r-g);break;case"top":l.sy=e+g,l.ey=r+g;var J=u(o-1,i-1)||s(o-1,i),Q=s(o,i),tt=u(o,i-1);l.sx=t,J&&(l.sx=t-g),(Q||tt)&&(l.sx=t+g);var et=s(o-1,i+1)||u(o-1,i),nt=u(o,i),rt=s(o,i+1);l.ex=n,et&&(l.ex=n+g),(nt||rt)&&(l.ex=n-g);break;case"right":l.sx=t-g,l.ex=n-g;var ot=f(o-1,i+1)||a(o,i+1),it=a(o,i),ct=f(o-1,i);l.sy=e,ot&&(l.sy=e-g),(it||ct)&&(l.sy=e+g);var lt=a(o+1,i+1)||f(o,i+1),st=f(o,i),at=a(o+1,i);l.ey=r,lt&&(l.ey=r+g),(st||at)&&(l.ey=r-g);break;case"bottom":l.sy=e-g,l.ey=r-g;var ut=u(o+1,i-1)||s(o+1,i),ft=s(o,i),ht=u(o,i-1);l.sx=t,ut&&(l.sx=t-g),(ft||ht)&&(l.sx=t+g);var pt=s(o+1,i+1)||u(o+1,i),yt=u(o,i),bt=s(o,i+1);l.ex=n,pt&&(l.ex=n+g),(yt||bt)&&(l.ex=n-g)}return l}},{key:"drawLine",value:function(t,e,n,r,o,i,c){var l=this.draw,s=this.width,a=this.color;l.attr({lineWidth:s,strokeStyle:a}),l.setLineDash([]);var u=this.handleExternal(t,e,n,r,o,i,c),f=this.handleInternal(t,e,n,r,o,i,c);_.isEmptyObject(f)||l.line([f.sx,f.sy],[f.ex,f.ey]),_.isEmptyObject(u)||l.line([u.sx,u.sy],[u.ex,u.ey])}},{key:"setColor",value:function(t){this.color=t}},{key:"setWidth",value:function(t){this.width=t}}]),t}(),Xi=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Bi(this,t),this.type=Fi.SOLID_LINE,this.solidLine=new Ui(e,_.mergeDeep({},n)),this.dottedLine=new zi(e,_.mergeDeep({dash:[5]},n)),this.pointLine=new zi(e,_.mergeDeep({dash:[2,2]},n)),this.doubleLine=new Gi(e,_.mergeDeep({},n))}return Yi(t,[{key:"drawLine",value:function(t,e,n,r,o,i,c){var l=this.type,s=this.solidLine,a=this.dottedLine,u=this.pointLine,f=this.doubleLine;switch(l){case Fi.SOLID_LINE:s.drawLine(t,e,n,r);break;case Fi.DOTTED_LINE:a.drawLine(t,e,n,r);break;case Fi.POINT_LINE:u.drawLine(t,e,n,r);break;case Fi.DOUBLE_LINE:f.drawLine(t,e,n,r,o,i,c)}}},{key:"setType",value:function(t){this.type=t}},{key:"setWidth",value:function(t){t&&this.type===Fi.SOLID_LINE&&this.solidLine.setWidth(t)}},{key:"setColor",value:function(t){t&&(this.solidLine.setColor(t),this.dottedLine.setColor(t),this.pointLine.setColor(t),this.doubleLine.setColor(t))}}]),t}();function Ki(t){return(Ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qi(t){return(qi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Zi(t,e){return(Zi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ji=function(t){function e(){var t,n,i,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,i=qi(e).call(this,"".concat(o,"-border-type-context-menu"),_.mergeDeep({onUpdate:function(){}},c)),(t=!i||"object"!==Ki(i)&&"function"!=typeof i?$i(n):i).type=Fi.SOLID_LINE,t.color="#000000",t.borderIcon1=new ho,t.borderIcon2=new vo,t.borderIcon3=new Eo,t.borderIcon4=new Co,t.borderIcon5=new Ro;var l=C("div","".concat(o,"-border-type-context-menu-type-icon-line"));l.children(t.borderIcon1),l.children(t.borderIcon2),l.children(t.borderIcon3),l.children(t.borderIcon4),l.children(t.borderIcon5),t.borderIcon6=new Ho,t.borderIcon7=new Fo,t.borderIcon8=new Ko,t.borderIcon9=new Qo,t.borderIcon10=new oi;var s=C("div","".concat(o,"-border-type-context-menu-type-icon-line"));s.children(t.borderIcon6),s.children(t.borderIcon7),s.children(t.borderIcon8),s.children(t.borderIcon9),s.children(t.borderIcon10),t.borderIcons=new lo,t.borderIcons.removeClass("hover"),t.borderIcons.children(l),t.borderIcons.children(s),t.borderColor=new ui,t.borderType=new bi;var a=C("div","".concat(o,"-border-type-context-menu-type-icon-line"));return a.children(t.borderColor),a.children(t.borderType),t.borderColorAndType=new lo,t.borderColorAndType.removeClass("hover"),t.borderColorAndType.children(a),t.addItem(t.borderIcons),t.addItem(new We),t.addItem(t.borderColorAndType),t.borderColorContextMenu=new Ti(_.copyProp({el:t.borderColor,position:ue.BOTTOM},{onUpdate:function(e){t.color=e,t.borderColor.setColor(e)}})),t.lineTypeContextMenu=new Mi(_.copyProp({el:t.borderType,position:ue.BOTTOM},{onUpdate:function(e){t.type=e}})),Nt.bind(t.borderColor,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=$i(t).borderColorContextMenu,r=n.elPopUp;pe.closeAll([r,t.elPopUp]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderType,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=$i(t).lineTypeContextMenu,r=n.elPopUp;pe.closeAll([r,t.elPopUp]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon1,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border1",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon2,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border2",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon3,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border3",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon4,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border4",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon5,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border5",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon6,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border6",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon7,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border7",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon8,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border8",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon9,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border9",t.color,t.type),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.borderIcon10,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border10",t.color,t.type),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zi(t,e)}(e,t),e}(we);function Qi(t){return(Qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tc(t){return(tc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ec(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nc(t,e){return(nc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rc=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(i=tc(e).call(this,"".concat(o,"-tools-border")))||"object"!==Qi(i)&&"function"!=typeof i?ec(r):i).options=_.copyProp({contextMenu:{}},t),n.icon=new et("border"),n.setIcon(n.icon),n.borderTypeContextMenu=new Ji(_.copyProp({el:ec(n),position:ue.BOTTOM},n.options.contextMenu)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nc(t,e)}(e,t),e}(Rt);function oc(t){return(oc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ic(t,e){return!e||"object"!==oc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cc(t){return(cc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lc(t,e){return(lc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ic(this,cc(e).call(this,"".concat(o,"-tools-merge")))).icon=new et("merge"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lc(t,e)}(e,t),e}(ct);function ac(t){return(ac="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uc(t,e){return!e||"object"!==ac(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fc(t){return(fc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hc(t,e){return(hc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=uc(this,fc(e).call(this,"".concat(o,"-tools-horizontal1")))).icon=new et("align-left"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hc(t,e)}(e,t),e}(ct);function yc(t){return(yc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bc(t,e){return!e||"object"!==yc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dc(t){return(dc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gc(t,e){return(gc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=bc(this,dc(e).call(this,"".concat(o,"-tools-horizontal2")))).icon=new et("align-center"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gc(t,e)}(e,t),e}(ct);function wc(t){return(wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mc(t,e){return!e||"object"!==wc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sc(t){return(Sc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oc(t,e){return(Oc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ec=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=mc(this,Sc(e).call(this,"".concat(o,"-tools-horizontal3")))).icon=new et("align-right"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oc(t,e)}(e,t),e}(ct);function _c(t){return(_c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xc(t,e){return!e||"object"!==_c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tc(t){return(Tc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kc(t,e){return(kc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Cc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),xc(this,Tc(e).call(this,"".concat(o,"-horizontal-type-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kc(t,e)}(e,t),e}(_e);function Pc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var jc=function(){function t(e){var n=e.rect,r=e.draw,o=e.offset,i=void 0===o?0:o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rect=n,this.draw=r,this.offset=i}var e,n,r;return e=t,(n=[{key:"open",value:function(){var t=this.rect,e=this.draw,n=this.offset,r=t.x,o=t.y,i=t.width,c=t.height;return e.save().beginPath().rect(r,o,i+n,c+n).clip(),this}},{key:"close",value:function(){return this.draw.restore(),this}}])&&Pc(e.prototype,n),r&&Pc(e,r),t}();function Ac(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Lc=function(){function t(e){var n=e.x,r=e.y,o=e.width,i=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=n,this.y=r,this.width=o,this.height=i}var e,n,r;return e=t,(n=[{key:"expandSize",value:function(t){return this.width+=t,this.height+=t,this}},{key:"disjoint",value:function(t){return this.x>t.x+t.width||this.y>this.y+t.height||t.x>this.x+this.width||t.y>this.y+this.height}},{key:"clone",value:function(){return new t({x:this.x,y:this.y,width:this.width,height:this.height})}}])&&Ac(e.prototype,n),r&&Ac(e,r),t}();function Rc(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Vc(t){return(Vc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nc(t,e){return!e||"object"!==Vc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wc(t){return(Wc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dc(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hc(t,e)}function Hc(t,e){return(Hc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Mc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ic(t,e,n){return e&&Bc(t.prototype,e),n&&Bc(t,n),t}var Yc=window.devicePixelRatio||1,Fc=function(t){function e(){return Mc(this,e),Nc(this,Wc(e).apply(this,arguments))}return Dc(e,t),Ic(e,[{key:"fillText",value:function(t,n,r){return n+=this.getOffsetX(),r+=this.getOffsetY(),this.ctx.fillText(t,e.rounding(n),e.rounding(r)),this}},{key:"rect",value:function(t,n,r,o){return t+=this.getOffsetX(),n+=this.getOffsetY(),this.ctx.rect(e.rounding(t),e.rounding(n),e.rounding(r),e.rounding(o)),this}},{key:"fillRect",value:function(t,n,r,o){return t+=this.getOffsetX(),n+=this.getOffsetY(),this.ctx.fillRect(e.rounding(t),e.rounding(n),e.rounding(r),e.rounding(o)),this}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){this.beginPath();var n=arguments.length<=0?void 0:arguments[0],r=Rc(n,2),o=r[0],i=r[1];o+=this.getOffsetX(),i+=this.getOffsetY(),t.moveTo(this.lpx(e.rounding(o)),this.lpx(e.rounding(i)));for(var c=1,l=arguments.length;c<l;c+=1){var s=c<0||arguments.length<=c?void 0:arguments[c],a=Rc(s,2),u=a[0],f=a[1];u+=this.getOffsetX(),f+=this.getOffsetY(),t.lineTo(this.lpx(e.rounding(u)),this.lpx(e.rounding(f)))}t.stroke()}return this}},{key:"drawImage",value:function(t,n,r,o,i,c,l,s,a){var u=this.ctx;return n+=this.getOffsetX(),r+=this.getOffsetY(),c+=this.getOffsetX(),l+=this.getOffsetY(),u.drawImage(t,e.rounding(n),e.rounding(r),e.rounding(o),e.rounding(i),e.rounding(c),e.rounding(l),e.rounding(s),e.rounding(a)),this}}]),e}(function(t){function e(t){var n;return Mc(this,e),(n=Nc(this,Wc(e).call(this,t))).offsetX=0,n.offsetY=0,n}return Dc(e,t),Ic(e,[{key:"offset",value:function(t,e){this.offsetX=t,this.offsetY=e}},{key:"getOffsetX",value:function(){return this.offsetX}},{key:"getOffsetY",value:function(){return this.offsetY}},{key:"fillText",value:function(){throw new TypeError("child impl")}},{key:"rect",value:function(){throw new TypeError("child impl")}},{key:"fillRect",value:function(){throw new TypeError("child impl")}},{key:"line",value:function(){throw new TypeError("child impl")}},{key:"drawImage",value:function(){throw new TypeError("child impl")}}]),e}(function(t){function e(){return Mc(this,e),Nc(this,Wc(e).apply(this,arguments))}return Dc(e,t),Ic(e,[{key:"measureText",value:function(t){return this.ctx.measureText(t)}},{key:"attr",value:function(t){for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];("string"==typeof n||n instanceof String)&&(n=n.trim()),this.ctx[e]!==n&&(this.ctx[e]=n)}return this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"save",value:function(){return this.ctx.save(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"clip",value:function(){return this.ctx.clip(),this}},{key:"fill",value:function(){return this.ctx.fill(),this}},{key:"setLineDash",value:function(t){return this.ctx.setLineDash(t),this}},{key:"rotate",value:function(t){return this.ctx.rotate(e.radian(t)),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"translate",value:function(t,e){return this.ctx.translate(t,e),this}},{key:"fullRect",value:function(){var t=this.canvas,e=t.width,n=t.height;return this.ctx.fillRect(0,0,e,n),this}},{key:"lpx",value:function(t){return t-(this.ctx.lineWidth%2==0?0:.5)}}]),e}(function(){function t(e){Mc(this,t),this.canvas=e,this.ctx=e.getContext("2d")}return Ic(t,null,[{key:"rounding",value:function(t){return~~t}},{key:"dpr",value:function(){return Yc}},{key:"cvCssPx",value:function(t){return this.rpx(t)/this.dpr()}},{key:"radian",value:function(t){return-t*(Math.PI/180)}},{key:"rpx",value:function(t){return this.rounding(this.dpx(t))}},{key:"dpx",value:function(t){return t*this.dpr()}}]),Ic(t,[{key:"resize",value:function(e,n){var r=this.canvas;return r.width=t.rpx(e),r.height=t.rpx(n),r.style.width="".concat(r.width/t.dpr(),"px"),r.style.height="".concat(r.height/t.dpr(),"px"),this}}]),t}())));function Uc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Gc(t,e,n){return e&&zc(t.prototype,e),n&&zc(t,n),t}var Xc={TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right",MIDDLE_LEFT:"middle-left",MIDDLE_CENTER:"middle-center",MIDDLE_RIGHT:"middle-right",BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right"},Kc=function(){function t(e){var n=e.angle,r=e.width,o=e.height;Uc(this,t),this.angle=n,this.width=r,this.height=o}return Gc(t,[{key:"sinWidthAngle",value:function(){var t=this.angle,e=this.width;return Math.abs(Math.sin(Fc.radian(t))*e)}},{key:"cosWidthAngle",value:function(){var t=this.angle,e=this.width;return Math.abs(Math.cos(Fc.radian(t)*e))}},{key:"sinHeightAngle",value:function(){var t=this.angle,e=this.height;return Math.abs(e/Math.sin(Fc.radian(t)))}},{key:"setWidth",value:function(t){this.width=t}},{key:"setHeight",value:function(t){this.height=t}},{key:"setAngle",value:function(t){this.angle=t}}]),t}(),qc=function(){function t(e){var n=e.angle,r=e.dw,o=e.origin,i=void 0===o?Xc.MIDDLE_CENTER:o,c=e.rect,l=void 0===c?new Lc({x:0,y:0,width:0,height:0}):c;Uc(this,t),this.dw=r,this.origin=i,this.rect=l,this.angle=n}return Gc(t,[{key:"rotate",value:function(){var t=this.origin,e=this.dw,n=this.rect,r=this.angle,o=n.x,i=n.y,c=n.width,l=n.height;e.save();var s=0,a=0;switch(t){case Xc.TOP_LEFT:s=o,a=i;break;case Xc.TOP_CENTER:s=o+c/2,a=i;break;case Xc.TOP_RIGHT:s=o+c,a=i;break;case Xc.MIDDLE_LEFT:s=o,a=i+l/2;break;case Xc.MIDDLE_CENTER:s=o+c/2,a=i+l/2;break;case Xc.MIDDLE_RIGHT:s=o+c,a=i+l/2;break;case Xc.BOTTOM_LEFT:s=o,a=i+l;break;case Xc.BOTTOM_CENTER:s=o+c/2,a=i+l;break;case Xc.BOTTOM_RIGHT:s=o+c,a=i+l}var u=e.getOffsetX(),f=e.getOffsetY();return e.translate(s+u,a+f).rotate(r).translate(-(s+u),-(a+f)),this}},{key:"revert",value:function(){return this.dw.restore(),this}},{key:"setOrigin",value:function(t){return this.origin=t,this}},{key:"setRect",value:function(t){return this.rect=t,this}}],[{key:"triangleHypotenuse",value:function(t,e){var n=Math.cos(Fc.radian(t)),r=Math.sin(Fc.radian(t));return{width:Math.abs(n*e),height:Math.abs(r*e)}}}]),t}();function $c(t){return($c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zc(t,e){return!e||"object"!==$c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jc(t){return(Jc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qc(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tl(t,e)}function tl(t,e){return(tl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function el(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rl(t,e,n){return e&&nl(t.prototype,e),n&&nl(t,n),t}var ol={left:"left",center:"center",right:"right"},il={top:"top",center:"middle",bottom:"bottom"},cl={OVER_FLOW:1,WORD_WRAP:2,TRUNCATE:3},ll={HORIZONTAL:"horizontal",VERTICAL:"vertical",ANGLE:"angle"},sl=function(){function t(e){var n=e.text,r=e.rect,o=e.dw,i=e.overflow,c=e.attr;el(this,t),this.text=n,this.dw=o,this.rect=r,this.overflow=i,this.attr=c}return rl(t,[{key:"measureWidth",value:function(t){return this.dw.measureText(t).width}},{key:"existBreak",value:function(t){return/\n/.test(t)}},{key:"isBlank",value:function(t){return null==t||""===t.toString().trim()}},{key:"textBreak",value:function(t){return t.split("\n")}}]),t}(),al=function(t){function e(){return el(this,e),Zc(this,Jc(e).apply(this,arguments))}return Qc(e,t),rl(e,[{key:"drawLine",value:function(t,e,n,r){var o=this.dw,i=this.attr,c=i.size,l=i.verticalAlign,s=i.align,a=[0,0],u=[0,0];if("strike"===t){switch(s){case ol.right:a[0]=e-r,u[0]=e;break;case ol.center:a[0]=e-r/2,u[0]=e+r/2;break;case ol.left:a[0]=e,u[0]=e+r}switch(l){case il.top:a[1]=n+c/2,u[1]=n+c/2;break;case il.center:a[1]=n,u[1]=n;break;case il.bottom:a[1]=n-c/2,u[1]=n-c/2}}if("underline"===t){switch(s){case ol.right:a[0]=e-r,u[0]=e;break;case ol.center:a[0]=e-r/2,u[0]=e+r/2;break;case ol.left:a[0]=e,u[0]=e+r}switch(l){case il.top:a[1]=n+c,u[1]=n+c;break;case il.center:a[1]=n+c/2,u[1]=n+c/2;break;case il.bottom:a[1]=n,u[1]=n}}o.line(a,u)}},{key:"drawTextTruncate",value:function(){var t,e=this.text,n=this.dw,r=this.attr,o=this.rect,i=r.underline,c=r.strikethrough,l=r.align,s=r.verticalAlign,a=r.padding,u=o.width,f=o.height,h=this.measureWidth(e),p=o.x,y=o.y;switch(l){case ol.left:p+=a;break;case ol.center:p+=u/2;break;case ol.right:p+=u-a}switch(s){case il.top:y+=a;break;case il.center:y+=f/2;break;case il.bottom:y+=f-a}switch(l){case ol.right:case ol.left:t=h+2*a;break;case ol.center:default:t=h}var b=new jc({draw:n,rect:o});return b.open(),n.fillText(e,p,y),i&&this.drawLine("underline",p,y,h),c&&this.drawLine("strike",p,y,h),b.close(),t}},{key:"drawTextOverFlow",value:function(){var t,e=this.text,n=this.dw,r=this.attr,o=this.rect,i=this.overflow,c=r.size,l=r.underline,s=r.strikethrough,a=r.align,u=r.verticalAlign,f=r.padding,h=o.width,p=o.height,y=this.measureWidth(e),b=o.x,d=o.y,g=0,v=0;switch(a){case ol.left:b+=f,g=f;break;case ol.center:b+=h/2;break;case ol.right:b+=h-f,g=f}switch(u){case il.top:d+=f,v=f;break;case il.center:d+=p/2;break;case il.bottom:d+=p-f,v=f}switch(a){case ol.right:case ol.left:t=y+2*f;break;case ol.center:default:t=y}if(y+g>i.width||c+v>i.height){var w=new jc({draw:n,rect:i});w.open(),n.fillText(e,b,d),l&&this.drawLine("underline",b,d,y),s&&this.drawLine("strike",b,d,y),w.close()}else n.fillText(e,b,d),l&&this.drawLine("underline",b,d,y),s&&this.drawLine("strike",b,d,y);return t}},{key:"drawTextWarp",value:function(){for(var t=this.text,e=this.dw,n=this.attr,r=this.rect,o=n.size,i=n.underline,c=n.strikethrough,l=n.align,s=n.verticalAlign,a=n.padding,u=r.width,f=r.height,h=u-2*a,p=[],y={len:0,start:0},b=t.length,d=0,g=0,v=0;g<b;){var w=this.measureWidth(t.charAt(g)),m=y.len+w;m>h?(0===y.len?(p.push({text:t.substring(g,g+1),len:m,tx:0,ty:d}),g+=1,m>v&&(v=m)):(p.push({text:t.substring(y.start,g),len:y.len,tx:0,ty:d}),y.len>v&&(v=y.len)),d+=o+4,y.len=0,y.start=g):(y.len=m,g+=1)}y.len>0&&(p.push({text:t.substring(y.start),len:y.len,tx:0,ty:d}),y.len>v&&(v=y.len));var S,O=r.x,E=r.y;switch(l){case ol.left:O+=a;break;case ol.center:O+=u/2;break;case ol.right:O+=u-a}switch(s){case il.top:E+=a;break;case il.center:E+=f/2-d/2;break;case il.bottom:E+=f-d-a}switch(l){case ol.right:case ol.left:S=v+2*a;break;case ol.center:default:S=v}var _=new jc({draw:e,rect:r});_.open();for(var x=0,T=p.length;x<T;x+=1){var k=p[x];k.tx+=O,k.ty+=E,e.fillText(k.text,k.tx,k.ty),i&&this.drawLine("underline",k.tx,k.ty,k.len),c&&this.drawLine("strike",k.tx,k.ty,k.len)}return _.close(),S}},{key:"draw",value:function(){var t=this.text;if(this.isBlank(t))return 0;this.existBreak(t)&&this.setTextWrap(cl.OVER_FLOW);var e=this.dw,n=this.attr,r=n.textWrap;switch(e.attr({textAlign:n.align,textBaseline:n.verticalAlign,font:"".concat(n.italic?"italic":""," ").concat(n.bold?"bold":""," ").concat(n.size,"px ").concat(n.name),fillStyle:n.color,strokeStyle:n.color}),r){case cl.TRUNCATE:return this.drawTextTruncate();case cl.WORD_WRAP:return this.drawTextWarp();case cl.OVER_FLOW:default:return this.drawTextOverFlow()}}},{key:"setSize",value:function(t){this.attr.size=t}},{key:"setTextWrap",value:function(t){this.attr.textWrap=t}},{key:"setPadding",value:function(t){this.attr.padding=t}}]),e}(sl),ul=function(t){function e(){return el(this,e),Zc(this,Jc(e).apply(this,arguments))}return Qc(e,t),rl(e,[{key:"drawLine",value:function(t,e,n,r,o,i){var c=this.dw,l=this.attr.size,s=[0,0],a=[0,0];if("strike"===t){switch(o){case ol.right:s[0]=e-r,a[0]=e;break;case ol.center:s[0]=e-r/2,a[0]=e+r/2;break;case ol.left:s[0]=e,a[0]=e+r}switch(i){case il.top:s[1]=n+l/2,a[1]=n+l/2;break;case il.center:s[1]=n,a[1]=n;break;case il.bottom:s[1]=n-l/2,a[1]=n-l/2}}if("underline"===t){switch(o){case ol.right:s[0]=e-r,a[0]=e;break;case ol.center:s[0]=e-r/2,a[0]=e+r/2;break;case ol.left:s[0]=e,a[0]=e+r}switch(i){case il.top:s[1]=n+l,a[1]=n+l;break;case il.center:s[1]=n+l/2,a[1]=n+l/2;break;case il.bottom:s[1]=n,a[1]=n}}c.line(s,a)}},{key:"drawTextTruncate",value:function(){for(var t=this.text,e=this.dw,n=this.attr,r=this.rect,o=n.underline,i=n.strikethrough,c=n.align,l=n.verticalAlign,s=n.size,a=n.padding,u=r.width,f=r.height,h=[],p=0,y=0;y<t.length;y+=1){var b=t.charAt(y);h.push({len:this.measureWidth(b),text:b,tx:0,ty:p}),y<t.length-1?p+=s+2:p+=s}var d,g=r.x,v=r.y;switch(c){case ol.left:g+=a;break;case ol.center:g+=u/2;break;case ol.right:g+=u-a}switch(l){case il.top:v+=a;break;case il.center:v+=f/2-p/2+a;break;case il.bottom:v+=f-p+a}switch(c){case ol.left:case ol.right:d=s+2*a;break;case ol.center:default:d=s}var w=new jc({draw:e,rect:r});w.open();for(var m=0,S=h.length;m<S;m+=1){var O=h[m];O.tx+=g,O.ty+=v,e.fillText(O.text,O.tx,O.ty),o&&this.drawLine("underline",O.tx,O.ty,O.len,c,l),i&&this.drawLine("strike",O.tx,O.ty,O.len,c,l)}return w.close(),d}},{key:"drawTextOverFlow",value:function(){for(var t=this.text,e=this.dw,n=this.attr,r=this.rect,o=this.overflow,i=n.underline,c=n.strikethrough,l=n.align,s=n.verticalAlign,a=n.size,u=n.padding,f=r.width,h=r.height,p=[],y=0,b=0;b<t.length;b+=1){var d=t.charAt(b);p.push({len:this.measureWidth(d),text:d,tx:0,ty:y}),b<t.length-1?y+=a+2:y+=a}var g,v=r.x,w=r.y,m=0,S=0;switch(l){case ol.left:v+=u,m=u;break;case ol.center:v+=f/2;break;case ol.right:v+=f-u,m=u}switch(s){case il.top:w+=u,S=u;break;case il.center:w+=h/2-y/2+u;break;case il.bottom:w+=h-y+u,S=u}switch(l){case ol.left:case ol.right:g=a+2*u;break;case ol.center:default:g=a}if(y+S>o.height||a+m>o.width){var O=new jc({draw:e,rect:o});O.open();for(var E=0,_=p.length;E<_;E+=1){var x=p[E];x.tx+=v,x.ty+=w,e.fillText(x.text,x.tx,x.ty),i&&this.drawLine("underline",x.tx,x.ty,x.len,l,s),c&&this.drawLine("strike",x.tx,x.ty,x.len,l,s)}O.close()}else for(var T=0,k=p.length;T<k;T+=1){var C=p[T];C.tx+=v,C.ty+=w,e.fillText(C.text,C.tx,C.ty),i&&this.drawLine("underline",C.tx,C.ty,C.len,l,s),c&&this.drawLine("strike",C.tx,C.ty,C.len,l,s)}return g}},{key:"drawTextWarp",value:function(){for(var t=this.text,e=this.dw,n=this.attr,r=this.rect,o=n.underline,i=n.strikethrough,c=n.align,l=n.verticalAlign,s=n.size,a=n.padding,u=r.width,f=r.height,h=[],p=t.length,y=f-2*a,b=[],d=0,g=0,v=0,w=0,m=0;m<p;){var S=m===p-1,O=0===m,E=t.charAt(m),_=this.measureWidth(E),x=void 0;(x=S?d+s:d+s+2)>y?(b.length>0&&h.push(b),d=0,O||(v+=s+0),w+=1,(b=[]).push({len:_,text:E,tx:v,ty:g=0}),d=S?s:s+2):(b.push({len:_,text:E,tx:v,ty:g}),d=x),g+=S?s:s+2,m+=1}b.length>0&&h.push(b);var T,k=r.x,C=r.y,P=l;switch(c){case ol.left:k+=a;break;case ol.center:k+=u/2-v/2;break;case ol.right:k+=u-v-a}switch(l){case il.top:e.attr({textBaseline:n.verticalAlign}),C+=a,P=il.top;break;case il.center:0===w?(e.attr({textBaseline:n.verticalAlign}),C+=f/2-g/2+a,P=il.center):(e.attr({textBaseline:il.top}),C+=a,P=il.top);break;case il.bottom:0===w?(e.attr({textBaseline:il.bottom}),C+=f-g+a,P=il.bottom):(e.attr({textBaseline:il.top}),C+=a,P=il.top)}switch(c){case ol.left:case ol.right:T=v+s+2*a;break;case ol.center:default:T=v+s}var j=new jc({draw:e,rect:r});j.open();for(var A=0,L=h.length;A<L;A+=1)for(var R=h[A],V=0;V<R.length;V+=1){var N=R[V];N.tx+=k,N.ty+=C,e.fillText(N.text,N.tx,N.ty),o&&this.drawLine("underline",N.tx,N.ty,N.len,c,P),i&&this.drawLine("strike",N.tx,N.ty,N.len,c,P)}return j.close(),T}},{key:"draw",value:function(){var t=this.text;if(this.isBlank(t))return 0;this.existBreak(t)&&this.setTextWrap(cl.OVER_FLOW);var e=this.dw,n=this.attr;switch(n.textWrap){case cl.TRUNCATE:return e.attr({textAlign:n.align,textBaseline:n.verticalAlign,font:"".concat(n.italic?"italic":""," ").concat(n.bold?"bold":""," ").concat(n.size,"px ").concat(n.name),fillStyle:n.color,strokeStyle:n.color}),this.drawTextTruncate();case cl.WORD_WRAP:return e.attr({textAlign:n.align,font:"".concat(n.italic?"italic":""," ").concat(n.bold?"bold":""," ").concat(n.size,"px ").concat(n.name),fillStyle:n.color,strokeStyle:n.color}),this.drawTextWarp();case cl.OVER_FLOW:default:return e.attr({textAlign:n.align,textBaseline:n.verticalAlign,font:"".concat(n.italic?"italic":""," ").concat(n.bold?"bold":""," ").concat(n.size,"px ").concat(n.name),fillStyle:n.color,strokeStyle:n.color}),this.drawTextOverFlow()}}},{key:"setSize",value:function(t){this.attr.size=t}},{key:"setTextWrap",value:function(t){this.attr.textWrap=t}},{key:"setPadding",value:function(t){this.attr.padding=t}}]),e}(sl),fl=function(t){function e(){return el(this,e),Zc(this,Jc(e).apply(this,arguments))}return Qc(e,t),rl(e,[{key:"drawLine",value:function(t,e,n,r){var o=this.dw,i=this.attr.size,c=[0,0],l=[0,0];"strike"===t&&(c[0]=e,l[0]=e+r,c[1]=n+i/2,l[1]=n+i/2),"underline"===t&&(c[0]=e,l[0]=e+r,c[1]=n+i,l[1]=n+i),o.line(c,l)}},{key:"drawTextTruncate",value:function(){var t=this.text,e=this.dw,n=this.attr,r=this.rect,o=n.underline,i=n.strikethrough,c=n.align,l=n.verticalAlign,s=n.size,a=n.padding,u=n.angle,f=r.width,h=r.height;u>90&&(u=90),u<-90&&(u=-90);var p,y=this.measureWidth(t),b=new Kc({angle:u,width:y,height:s}),d=b.cosWidthAngle(),g=b.sinWidthAngle(),v=r.x,w=r.y;switch(c){case ol.left:v+=a;break;case ol.center:v+=f/2-d/2;break;case ol.right:v+=f-d-a}switch(l){case il.top:w+=a;break;case il.center:w+=h/2-g/2;break;case il.bottom:w+=h-g-a}switch(c){case ol.right:case ol.left:p=d+2*a;break;case ol.center:default:p=d}var m,S=v+(d/2-y/2),O=w+(g/2-s/2),E=new qc({dw:e,angle:u,rect:new Lc({x:v,y:w,width:d,height:g})});return(m=new jc(0===u?{draw:e,rect:r}:{draw:e,rect:new Lc({x:0,y:r.y,width:p,height:r.height})})).open(),E.rotate(),e.fillText(t,S,O),o&&this.drawLine("underline",S,O,y),i&&this.drawLine("strike",S,O,y),E.revert(),m.close(),p}},{key:"drawTextOverFlow",value:function(){var t=this.text,e=this.dw,n=this.attr,r=this.rect,o=this.overflow,i=n.underline,c=n.strikethrough,l=n.align,s=n.verticalAlign,a=n.size,u=n.padding,f=n.angle,h=r.width,p=r.height;f>90&&(f=90),f<-90&&(f=-90);var y,b=this.measureWidth(t),d=new Kc({angle:f,width:b,height:a}),g=d.cosWidthAngle(),v=d.sinWidthAngle(),w=r.x,m=r.y;switch(l){case ol.left:w+=u;break;case ol.center:w+=h/2-g/2;break;case ol.right:w+=h-g-u}switch(s){case il.top:m+=u;break;case il.center:m+=p/2-v/2;break;case il.bottom:m+=p-v-u}switch(l){case ol.right:case ol.left:y=g+2*u;break;case ol.center:default:y=g}var S,O=w+(g/2-b/2),E=m+(v/2-a/2),_=new qc({dw:e,angle:f,rect:new Lc({x:w,y:m,width:g,height:v})});return S=new jc(0===f?{draw:e,rect:o}:{draw:e,rect:new Lc({x:0,y:r.y,width:y,height:r.height})}),g>o.width||v>o.height?(S.open(),_.rotate(),e.fillText(t,O,E),i&&this.drawLine("underline",O,E,b),c&&this.drawLine("strike",O,E,b),_.revert(),S.close()):(_.rotate(),e.fillText(t,O,E),i&&this.drawLine("underline",O,E,b),c&&this.drawLine("strike",O,E,b),_.revert()),y}},{key:"drawTextWarp",value:function(){var t=this.text,e=this.dw,n=this.attr,r=this.rect,o=n.underline,i=n.strikethrough,c=n.align,l=n.verticalAlign,s=n.size,a=n.padding,u=n.angle;u>90&&(u=90),u<-90&&(u=-90);var f=r.width,h=r.height;if(u>0){var p=new Kc({angle:u});p.setHeight(h-2*a);var y=p.sinHeightAngle();p.setHeight(s+4);for(var b=p.sinHeightAngle(),d=[],g={len:0,start:0},v=t.length,w=0;w<v;){var m=this.measureWidth(t.charAt(w)),S=g.len+m;S>y?(0===g.len?(d.push({text:t.substring(w,w+1),len:S,tx:0,ty:0}),w+=1):d.push({text:t.substring(g.start,w),len:g.len,tx:0,ty:0}),g.len=0,g.start=w):(g.len=S,w+=1)}g.len>0&&d.push({text:t.substring(g.start),len:g.len,tx:0,ty:0});for(var O=d.length,E=0,_=0;_<O;_+=1){d[_].tx=E,E+=b}if(O>1){p.setWidth(y);var x,T=Math.max(p.cosWidthAngle(),s),k=p.sinWidthAngle(),C=T+(d.length-1)*b,P=r.x,j=r.y;switch(c){case ol.left:P+=a;break;case ol.center:P+=f/2-C/2;break;case ol.right:P+=f-C-a}switch(l){case il.top:j+=a;break;case il.center:j+=h/2-k/2;break;case il.bottom:j+=h-k-a}switch(c){case ol.right:case ol.left:x=C+2*a;break;case ol.center:default:x=C}for(var A=0;A<d.length;A+=1){var L=d[A],R=L.tx+P,V=L.ty+j,N=0,W=0;switch(c){case ol.left:p.setWidth(L.len/2),N+=R+Math.max(p.cosWidthAngle(),s),W+=V+k-p.sinWidthAngle();break;case ol.center:N=R+T/2,W=V+k/2;break;case ol.right:p.setWidth(L.len/2),N+=R+T-Math.max(p.cosWidthAngle(),s),W+=V+p.sinWidthAngle()}var D=N-L.len/2,H=W-s/2;-1===A&&(e.attr({fillStyle:"#000000"}),e.fillRect(R,V,T,k),e.attr({fillStyle:"red"}));var M=new qc({dw:e,angle:u,rect:new Lc({x:D,y:H,width:L.len,height:s})});M.rotate(),e.fillText(L.text,D,H),o&&this.drawLine("underline",D,H,L.len),i&&this.drawLine("strike",D,H,L.len),M.revert()}return x}var B=this.measureWidth(t);p.setWidth(B);var I,Y=Math.max(p.cosWidthAngle(),s),F=p.sinWidthAngle(),U=r.x,z=r.y;switch(c){case ol.left:U+=a;break;case ol.center:U+=f/2-Y/2;break;case ol.right:U+=f-Y-a}switch(l){case il.top:z+=a;break;case il.center:z+=h/2-F/2;break;case il.bottom:z+=h-F-a}switch(c){case ol.right:case ol.left:I=Y+2*a;break;case ol.center:default:I=Y}var G=new qc({dw:e,angle:u,rect:new Lc({x:U,y:z,width:Y,height:F})});G.rotate();var X=U+(Y/2-B/2),K=z+(F/2-s/2);return e.fillText(t,X,K),o&&this.drawLine("underline",X,K,B),i&&this.drawLine("strike",X,K,B),G.revert(),I}if(u<0){var q=new Kc({angle:u});q.setHeight(h-2*a);var $=q.sinHeightAngle();q.setHeight(s+4);for(var Z=q.sinHeightAngle(),J=[],Q={len:0,start:0},tt=t.length,et=0;et<tt;){var nt=this.measureWidth(t.charAt(et)),rt=Q.len+nt;rt>$?(0===Q.len?(J.push({text:t.substring(et,et+1),len:rt,tx:0,ty:0}),et+=1):J.push({text:t.substring(Q.start,et),len:Q.len,tx:0,ty:0}),Q.len=0,Q.start=et):(Q.len=rt,et+=1)}Q.len>0&&J.push({text:t.substring(Q.start),len:Q.len,tx:0,ty:0});for(var ot=J.length,it=0,ct=ot-1;ct>=0;ct-=1){J[ct].tx=it,it+=Z}if(ot>1){q.setWidth($);var lt,st=Math.max(q.cosWidthAngle(),s),at=q.sinWidthAngle(),ut=st+(J.length-1)*Z,ft=r.x,ht=r.y;switch(c){case ol.left:ft+=a;break;case ol.center:ft+=f/2-ut/2;break;case ol.right:ft+=f-ut-a}switch(l){case il.top:ht+=a;break;case il.center:ht+=h/2-at/2;break;case il.bottom:ht+=h-at-a}switch(c){case ol.right:case ol.left:lt=ut+2*a;break;case ol.center:default:lt=ut}for(var pt=0;pt<J.length;pt+=1){var yt=J[pt],bt=yt.tx+ft,dt=yt.ty+ht,gt=0,vt=0;switch(c){case ol.left:q.setWidth(yt.len/2),gt+=bt+Math.max(q.cosWidthAngle(),s),vt+=dt+q.sinWidthAngle();break;case ol.center:gt=bt+st/2,vt=dt+at/2;break;case ol.right:q.setWidth(yt.len/2),gt+=bt+st-Math.max(q.cosWidthAngle(),s),vt+=dt+at-q.sinWidthAngle()}var wt=gt-yt.len/2,mt=vt-s/2;-1===pt&&(e.attr({fillStyle:"#000000"}),e.fillRect(bt,dt,st,at),e.attr({fillStyle:"red"}));var St=new qc({dw:e,angle:u,rect:new Lc({x:wt,y:mt,width:yt.len,height:s})});St.rotate(),e.fillText(yt.text,wt,mt),o&&this.drawLine("underline",wt,mt,yt.len),i&&this.drawLine("strike",wt,mt,yt.len),St.revert()}return lt}var Ot=this.measureWidth(t);q.setWidth(Ot);var Et,_t=Math.max(q.cosWidthAngle(),s),xt=q.sinWidthAngle(),Tt=r.x,kt=r.y;switch(c){case ol.left:Tt+=a;break;case ol.center:Tt+=f/2-_t/2;break;case ol.right:Tt+=f-_t-a}switch(l){case il.top:kt+=a;break;case il.center:kt+=h/2-xt/2;break;case il.bottom:kt+=h-xt-a}switch(c){case ol.right:case ol.left:Et=_t+2*a;break;case ol.center:default:Et=_t}var Ct=new qc({dw:e,angle:u,rect:new Lc({x:Tt,y:kt,width:_t,height:xt})});Ct.rotate();var Pt=Tt+(_t/2-Ot/2),jt=kt+(xt/2-s/2);return e.fillText(t,Pt,jt),o&&this.drawLine("underline",Pt,jt,Ot),i&&this.drawLine("strike",Pt,jt,Ot),Ct.revert(),Et}if(0===u){for(var At=f-2*a,Lt=[],Rt={len:0,start:0},Vt=t.length,Nt=0,Wt=0;Nt<Vt;){var Dt=this.measureWidth(t.charAt(Nt)),Ht=Rt.len+Dt;Ht>At?(0===Rt.len?(Lt.push({text:t.substring(Nt,Nt+1),len:Ht,tx:0,ty:0}),Nt+=1,Ht>Wt&&(Wt=Ht)):(Lt.push({text:t.substring(Rt.start,Nt),len:Rt.len,tx:0,ty:0}),Rt.len>Wt&&(Wt=Rt.len)),Rt.len=0,Rt.start=Nt):(Rt.len=Ht,Nt+=1)}Rt.len>0&&(Lt.push({text:t.substring(Rt.start),len:Rt.len,tx:0,ty:0}),Rt.len>Wt&&(Wt=Rt.len));for(var Mt=Lt.length,Bt=0,It=0;It<Mt;It+=1){Lt[It].ty=Bt,Bt+=s+4}var Yt,Ft=Mt*(s+4);switch(c){case ol.right:case ol.left:Yt=Wt+2*a;break;case ol.center:default:Yt=Wt}var Ut=new jc({draw:e,rect:r});Ut.open();for(var zt=0;zt<Mt;zt+=1){var Gt=Lt[zt],Xt=r.x,Kt=r.y;switch(c){case ol.left:Xt+=a;break;case ol.center:Xt+=f/2-Gt.len/2;break;case ol.right:Xt+=f-Gt.len-a}switch(l){case il.top:Kt+=Gt.ty+a;break;case il.center:Kt+=Gt.ty+(h/2-Ft/2);break;case il.bottom:Kt+=Gt.ty+(h-Ft-a)}e.fillText(Gt.text,Xt,Kt),o&&this.drawLine("underline",Xt,Kt,Gt.len),i&&this.drawLine("strike",Xt,Kt,Gt.len)}return Ut.close(),Yt}return 0}},{key:"draw",value:function(){var t=this.text;if(this.isBlank(t))return 0;this.existBreak(t)&&this.setTextWrap(cl.OVER_FLOW);var e=this.dw,n=this.attr,r=n.textWrap;switch(e.attr({textAlign:ol.left,textBaseline:il.top,font:"".concat(n.italic?"italic":""," ").concat(n.bold?"bold":""," ").concat(n.size,"px ").concat(n.name),fillStyle:n.color,strokeStyle:n.color}),r){case cl.TRUNCATE:return this.drawTextTruncate();case cl.WORD_WRAP:return this.drawTextWarp();case cl.OVER_FLOW:default:return this.drawTextOverFlow()}}},{key:"setSize",value:function(t){this.attr.size=t}},{key:"setTextWrap",value:function(t){this.attr.textWrap=t}},{key:"setPadding",value:function(t){this.attr.padding=t}}]),e}(sl),hl=function(){function t(e){var n=e.text,r=e.rect,o=e.dw,i=e.overflow,c=e.attr;el(this,t),this.attr=_.mergeDeep({},{name:"Arial",size:14,color:"#000000",bold:!1,italic:!1,textWrap:!1,underline:!1,strikethrough:!1,align:ol.left,verticalAlign:il.center,direction:ll.HORIZONTAL,angle:0,padding:8},c),this.verticalFontDraw=new ul({text:n,rect:r,dw:o,overflow:i,attr:this.attr}),this.horizontalFontDraw=new al({text:n,rect:r,dw:o,overflow:i,attr:this.attr}),this.angleFontDraw=new fl({text:n,rect:r,dw:o,overflow:i,attr:this.attr})}return rl(t,[{key:"draw",value:function(){switch(this.attr.direction){case ll.VERTICAL:return this.verticalFontDraw.draw();case ll.ANGLE:return this.angleFontDraw.draw();case ll.HORIZONTAL:default:return this.horizontalFontDraw.draw()}}},{key:"setSize",value:function(t){this.verticalFontDraw.setSize(t),this.horizontalFontDraw.setSize(t),this.angleFontDraw.setSize(t)}},{key:"setTextWrap",value:function(t){this.verticalFontDraw.setTextWrap(t),this.horizontalFontDraw.setTextWrap(t),this.angleFontDraw.setTextWrap(t)}},{key:"setPadding",value:function(t){this.verticalFontDraw.setPadding(t),this.horizontalFontDraw.setPadding(t),this.angleFontDraw.setPadding(t)}}]),t}();function pl(t){return(pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yl(t,e){return!e||"object"!==pl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bl(t){return(bl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dl(t,e){return(dl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gl=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=yl(this,bl(e).call(this,"".concat(o,"-horizontal-type-context-menu"),_.mergeDeep({onUpdate:function(){}},n)))).horizontalIcon1=new pc,t.horizontalIcon2=new vc,t.horizontalIcon3=new Ec;var i=C("div","".concat(o,"-horizontal-type-context-menu-type-icon-line"));return i.children(t.horizontalIcon1),i.children(t.horizontalIcon2),i.children(t.horizontalIcon3),t.horizontalIcons=new Cc,t.horizontalIcons.removeClass("hover"),t.horizontalIcons.children(i),t.addItem(t.horizontalIcons),Nt.bind(t.horizontalIcon1,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(ol.left),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.horizontalIcon2,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(ol.center),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.horizontalIcon3,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(ol.right),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dl(t,e)}(e,t),e}(we);function vl(t){return(vl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wl(t){return(wl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ml(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Sl(t,e){return(Sl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ol=function(t){function e(){var t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(r=wl(e).call(this,"".concat(o,"-tools-horizontal-align")))||"object"!==vl(r)&&"function"!=typeof r?ml(n):r).options=_.mergeDeep({contextMenu:{}},i),t.icon=new et("align-left"),t.setIcon(t.icon),t.horizontalContextMenu=new gl(_.copyProp({el:ml(t),position:ue.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sl(t,e)}(e,t),e}(Rt);function El(t){return(El="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _l(t,e){return!e||"object"!==El(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xl(t){return(xl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tl(t,e){return(Tl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),_l(this,xl(e).call(this,"".concat(o,"-vertical-type-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tl(t,e)}(e,t),e}(_e);function Cl(t){return(Cl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pl(t,e){return!e||"object"!==Cl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jl(t){return(jl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Al(t,e){return(Al=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ll=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Pl(this,jl(e).call(this,"".concat(o,"-tools-verticalIcon1")))).icon=new et("align-top"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Al(t,e)}(e,t),e}(ct);function Rl(t){return(Rl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vl(t,e){return!e||"object"!==Rl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Nl(t){return(Nl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wl(t,e){return(Wl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Dl=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Vl(this,Nl(e).call(this,"".concat(o,"-tools-verticalIcon2")))).icon=new et("align-middle"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wl(t,e)}(e,t),e}(ct);function Hl(t){return(Hl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ml(t,e){return!e||"object"!==Hl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bl(t){return(Bl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Il(t,e){return(Il=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yl=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ml(this,Bl(e).call(this,"".concat(o,"-tools-verticalIcon3")))).icon=new et("align-bottom"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Il(t,e)}(e,t),e}(ct);function Fl(t){return(Fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ul(t,e){return!e||"object"!==Fl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zl(t){return(zl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gl(t,e){return(Gl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xl=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ul(this,zl(e).call(this,"".concat(o,"-vertical-type-context-menu"),_.mergeDeep({onUpdate:function(){}},n)))).verticalIcon1=new Ll,t.verticalIcon2=new Dl,t.verticalIcon3=new Yl;var i=C("div","".concat(o,"-vertical-type-context-menu-type-icon-line"));return i.children(t.verticalIcon1),i.children(t.verticalIcon2),i.children(t.verticalIcon3),t.verticalIcons=new kl,t.verticalIcons.removeClass("hover"),t.verticalIcons.children(i),t.addItem(t.verticalIcons),Nt.bind(t.verticalIcon1,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(il.top),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.verticalIcon2,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(il.center),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.verticalIcon3,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(il.bottom),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gl(t,e)}(e,t),e}(we);function Kl(t){return(Kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ql(t){return(ql=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Zl(t,e){return(Zl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jl=function(t){function e(){var t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(r=ql(e).call(this,"".concat(o,"-tools-vertical-align")))||"object"!==Kl(r)&&"function"!=typeof r?$l(n):r).options=_.mergeDeep({contextMenu:{}},i),t.icon=new et("align-middle"),t.setIcon(t.icon),t.verticalContextMenu=new Xl(_.copyProp({el:$l(t),position:ue.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zl(t,e)}(e,t),e}(Rt);function Ql(t){return(Ql="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ts(t,e){return!e||"object"!==Ql(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function es(t){return(es=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ns(t,e){return(ns=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rs=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ts(this,es(e).call(this,"".concat(o,"-tools-text-wrapping1")))).icon=new et("truncate"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ns(t,e)}(e,t),e}(ct);function os(t){return(os="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function is(t,e){return!e||"object"!==os(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cs(t){return(cs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ls(t,e){return(ls=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ss=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=is(this,cs(e).call(this,"".concat(o,"-tools-text-wrapping2")))).icon=new et("overflow"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ls(t,e)}(e,t),e}(ct);function as(t){return(as="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function us(t,e){return!e||"object"!==as(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fs(t){return(fs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hs(t,e){return(hs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ps=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=us(this,fs(e).call(this,"".concat(o,"-tools-text-wrapping3")))).icon=new et("wrap"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hs(t,e)}(e,t),e}(ct);function ys(t){return(ys="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bs(t,e){return!e||"object"!==ys(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ds(t){return(ds=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gs(t,e){return(gs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vs=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),bs(this,ds(e).call(this,"".concat(o,"-text-wrapping-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gs(t,e)}(e,t),e}(_e);function ws(t){return(ws="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ms(t,e){return!e||"object"!==ws(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ss(t){return(Ss=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Os(t,e){return(Os=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Es=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ms(this,Ss(e).call(this,"".concat(o,"-text-wrapping-context-menu"),_.mergeDeep({onUpdate:function(){}},n)))).textWrappingIcon1=new rs,t.textWrappingIcon2=new ss,t.textWrappingIcon3=new ps;var i=C("div","".concat(o,"-text-wrapping-context-menu-type-icon-line"));return i.children(t.textWrappingIcon1),i.children(t.textWrappingIcon2),i.children(t.textWrappingIcon3),t.textWrappingIcons=new vs,t.textWrappingIcons.removeClass("hover"),t.textWrappingIcons.children(i),t.addItem(t.textWrappingIcons),Nt.bind(t.textWrappingIcon1,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(cl.TRUNCATE),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.textWrappingIcon2,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(cl.OVER_FLOW),e.stopPropagation(),e.preventDefault()})),Nt.bind(t.textWrappingIcon3,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(cl.WORD_WRAP),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Os(t,e)}(e,t),e}(we);function _s(t){return(_s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xs(t){return(xs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ts(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ks(t,e){return(ks=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Cs=function(t){function e(){var t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(r=xs(e).call(this,"".concat(o,"-tools-text-wrapping")))||"object"!==_s(r)&&"function"!=typeof r?Ts(n):r).options=_.mergeDeep({contextMenu:{}},i),t.icon=new et("text-wrap"),t.setIcon(t.icon),t.textWrappingContextMenu=new Es(_.copyProp({el:Ts(t),position:ue.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ks(t,e)}(e,t),e}(Rt);function Ps(t){return(Ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function js(t,e){return!e||"object"!==Ps(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function As(t){return(As=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ls(t,e){return(Ls=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rs=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=js(this,As(e).call(this,"".concat(o,"-tools-fixed")))).icon=new et("freeze"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ls(t,e)}(e,t),e}(ct);function Vs(t){return(Vs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ns(t,e){return!e||"object"!==Vs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ws(t){return(Ws=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ds(t,e){return(Ds=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hs=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ns(this,Ws(e).call(this,"".concat(o,"-tools-filter")))).icon=new et("filter"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ds(t,e)}(e,t),e}(ct);function Ms(t){return(Ms="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bs(t,e){return!e||"object"!==Ms(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Is(t){return(Is=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ys(t,e){return(Ys=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fs=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Bs(this,Is(e).call(this,"".concat(o,"-tools-format")))).icon=new et("functions"),t.setIcon(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ys(t,e)}(e,t),e}(Rt);function Us(t){return(Us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zs(t,e){return!e||"object"!==Us(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gs(t){return(Gs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xs(t,e){return(Xs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ks='\n  <svg class="'.concat(o,'-copy-style-svg" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">\n    <line class="').concat(o,'-copy-style-stroked-top" x1="0" y1="0" x2="100%" y2="0"/>\n    <line class="').concat(o,'-copy-style-stroked-left" x1="0" y1="0" x2="0" y2="100%"/>\n    <line class="').concat(o,'-copy-style-stroked-bottom" x1="0" y1="100%" x2="100%" y2="100%"/>\n    <line class="').concat(o,'-copy-style-stroked-right" x1="100%" y1="0" x2="100%" y2="100%"/>\n  </svg>\n'),qs=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=zs(this,Gs(e).call(this,"".concat(o,"-copy-style")))).options=_.mergeDeep({},t),n.mask=C("div","".concat(o,"-copy-style-mask")),n.html(Ks),n.children(n.mask),n.top=n.find(".".concat(o,"-copy-style-stroked-top")),n.left=n.find(".".concat(o,"-copy-style-stroked-left")),n.bottom=n.find(".".concat(o,"-copy-style-stroked-bottom")),n.right=n.find(".".concat(o,"-copy-style-stroked-right")),n.hide(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xs(t,e)}(e,t),e}(V);function $s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Zs=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.screen=e,this.lt=null,this.t=null,this.l=null,this.br=null}var e,n,r;return e=t,(n=[{key:"getLT",value:function(){return this.lt}},{key:"getT",value:function(){return this.t}},{key:"getL",value:function(){return this.l}},{key:"getBR",value:function(){return this.br}},{key:"onAppendScreen",value:function(){}}])&&$s(e.prototype,n),r&&$s(e,r),t}();function Js(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Qs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ta=function(){function t(e,n,r,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sri=e,this.sci=n,this.eri=r,this.eci=o,this.w=i,this.h=c}var e,n,r;return e=t,r=[{key:"valueOf",value:function(e){var n=e.split(":"),r=Js(_.expr2xy(n[0]),2),o=r[0],i=r[1],c=i,l=o;if(n.length>1){var s=Js(_.expr2xy(n[1]),2);l=s[0],c=s[1]}return new t(i,o,c,l)}}],(n=[{key:"set",value:function(t,e,n,r){this.sri=t,this.sci=e,this.eri=n,this.eci=r}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];if(1===r.length){var i=_.expr2xy(r[0]),c=Js(i,2);e=c[0],t=c[1]}else 2===r.length&&(t=r[0],e=r[1]);var l=this.sri,s=this.sci,a=this.eri,u=this.eci;return l<=t&&t<=a&&s<=e&&e<=u}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=this.sri,r=this.sci,o=this.eri,i=this.eci,c=n;c<=o;c+=1)if(e(c))for(var l=r;l<=i;l+=1)t(c,l)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var n=this.sri,r=this.sci,o=this.eri,i=this.eci;return new t(e.sri<n?e.sri:n,e.sci<r?e.sci:r,e.eri>o?e.eri:o,e.eci>i?e.eci:i)}},{key:"coincide",value:function(e){var n=this.sri,r=this.sci,o=this.eri,i=this.eci;return this.disjoint(e)?t.EMPTY:new t(e.sri>n?e.sri:n,e.sci>r?e.sci:r,e.eri<o?e.eri:o,e.eci<i?e.eci:i)}},{key:"coincideDifference",value:function(e){return this.coincide(e).equals(t.EMPTY)?[]:this.difference(e)}},{key:"difference",value:function(e){var n=[],r=function(e,r,o,i){n.push(new t(e,r,o,i))},o=this.sri,i=this.sci,c=this.eri,l=this.eci,s=e.sri-o,a=e.sci-i,u=c-e.eri,f=l-e.eci;return s>0?(r(o,i,e.sri-1,l),u>0?(r(e.eri+1,i,c,l),a>0&&r(e.sri,i,e.eri,e.sci-1),f>0&&r(e.sri,e.eci+1,e.eri,l)):(a>0&&r(e.sri,i,c,e.sci-1),f>0&&r(e.sri,e.eci+1,c,l))):u>0&&(r(e.eri+1,i,c,l),a>0&&r(o,i,e.eri,e.sci-1),f>0&&r(o,e.eci+1,e.eri,l)),a>0?(r(o,i,c,e.sci-1),f>0?(r(o,e.eri+1,c,l),s>0&&r(o,e.sci,e.sri-1,e.eci),u>0&&r(e.sri+1,e.sci,c,e.eci)):(s>0&&r(o,e.sci,e.sri-1,l),u>0&&r(e.sri+1,e.sci,c,l))):f>0&&(r(o,e.eci+1,c,l),s>0&&r(o,i,e.sri-1,e.eci),u>0&&r(e.eri+1,i,c,e.eci)),n}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"brink",value:function(){var e=this.sri,n=this.eri,r=this.sci,o=this.eci,i=new t(e,r,e,o),c=new t(n,r,n,o);return{top:i,right:new t(e,o,n,o),bottom:c,left:new t(e,r,n,r)}}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"toString",value:function(){var t=this.sri,e=this.sci,n=this.eri,r=this.eci,o=_.xy2expr(e,t);return this.multiple()&&(o="".concat(o,":").concat(_.xy2expr(r,n))),o}}])&&Qs(e.prototype,n),r&&Qs(e,r),t}();function ea(t){return(ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function na(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ra(t,e){return!e||"object"!==ea(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function oa(t){return(oa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ia(t,e){return(ia=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}ta.EMPTY=new ta(-1,-1,-1,-1);var ca=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ra(this,oa(e).call(this,t))).options=_.mergeDeep({},r),n.lt=new qs,n.t=new qs,n.l=new qs,n.br=new qs,n.selectorAttr=null,n.bind(),n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ia(t,e)}(e,t),n=e,(o=[{key:"setLTOffset",value:function(t){var e=this.screen.table,n=e.xTableFrozenContent,r=e.cols,o=e.rows,i=(e.grid,n.getScrollView()),c=t.rect,l=new ta(-1,-1,-1,-1),s=c.coincide(i);if(l.equals(s))this.lt.hide();else{var a=r.sectionSumWidth(s.sci,s.eci),u=o.sectionSumHeight(s.sri,s.eri),f=o.sectionSumHeight(i.sri,s.sri-1),h=r.sectionSumWidth(i.sci,s.sci-1);c.eci>i.eci?(this.lt.right.hide(),this.lt.mask.css("border-right","none")):(this.lt.right.show(),this.lt.mask.cssRemoveKeys("border-right")),c.eri>i.eri?(this.lt.bottom.hide(),this.lt.mask.css("border-bottom","none")):(this.lt.bottom.show(),this.lt.mask.cssRemoveKeys("border-bottom"));var p=new Lc({x:h,y:f,width:a,height:u});this.lt.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setTOffset",value:function(t){var e=this.screen.table,n=e.xTop,r=e.cols,o=e.rows,i=(e.grid,n.getScrollView()),c=t.rect,l=new ta(-1,-1,-1,-1),s=c.coincide(i);if(l.equals(s))this.t.hide();else{var a=r.sectionSumWidth(s.sci,s.eci),u=o.sectionSumHeight(s.sri,s.eri),f=o.sectionSumHeight(i.sri,s.sri-1),h=r.sectionSumWidth(i.sci,s.sci-1);c.sci<i.sci?(this.t.left.hide(),this.t.mask.css("border-left","none")):(this.t.left.show(),this.t.mask.cssRemoveKeys("border-left")),c.eri>i.eri?(this.t.bottom.hide(),this.t.mask.css("border-bottom","none")):(this.t.bottom.show(),this.t.mask.cssRemoveKeys("border-bottom")),c.eci>i.eci?(this.t.right.hide(),this.t.mask.css("border-right","none")):(this.t.right.show(),this.t.mask.cssRemoveKeys("border-right"));var p=new Lc({x:h,y:f,width:a,height:u});this.t.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setLOffset",value:function(t){var e=this.screen.table,n=e.xLeft,r=e.cols,o=e.rows,i=(e.grid,n.getScrollView()),c=t.rect,l=new ta(-1,-1,-1,-1),s=c.coincide(i);if(l.equals(s))this.l.hide();else{var a=r.sectionSumWidth(s.sci,s.eci),u=o.sectionSumHeight(s.sri,s.eri),f=o.sectionSumHeight(i.sri,s.sri-1),h=r.sectionSumWidth(i.sci,s.sci-1);c.sri<i.sri?(this.l.top.hide(),this.l.mask.css("border-top","none")):(this.l.top.show(),this.l.mask.cssRemoveKeys("border-top")),c.eci>i.eci?(this.l.right.hide(),this.l.mask.css("border-right","none")):(this.l.right.show(),this.l.mask.cssRemoveKeys("border-right")),c.eri>i.eri?(this.l.bottom.hide(),this.l.mask.css("border-bottom","none")):(this.l.bottom.show(),this.l.mask.cssRemoveKeys("border-bottom"));var p=new Lc({x:h,y:f,width:a,height:u});this.l.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setBROffset",value:function(t){var e=this.screen.table,n=e.cols,r=e.rows,o=(e.grid,e.getScrollView()),i=t.rect,c=new ta(-1,-1,-1,-1),l=i.coincide(o);if(c.equals(l))this.br.hide();else{var s=n.sectionSumWidth(l.sci,l.eci),a=r.sectionSumHeight(l.sri,l.eri),u=r.sectionSumHeight(o.sri,l.sri-1),f=n.sectionSumWidth(o.sci,l.sci-1);i.sci<o.sci?(this.br.left.hide(),this.br.mask.css("border-left","none")):(this.br.left.show(),this.br.mask.cssRemoveKeys("border-left")),i.sri<o.sri?(this.br.top.hide(),this.br.mask.css("border-top","none")):(this.br.top.show(),this.br.mask.cssRemoveKeys("border-top")),i.eri>o.eri?(this.br.bottom.hide(),this.br.mask.css("border-bottom","none")):(this.br.bottom.show(),this.br.mask.cssRemoveKeys("border-bottom")),i.eci>o.eci?(this.br.right.hide(),this.br.mask.css("border-right","none")):(this.br.right.show(),this.br.mask.cssRemoveKeys("border-right"));var h=new Lc({x:f,y:u,width:s,height:a});this.br.offset({width:h.width,height:h.height,left:h.x,top:h.y}).show()}}},{key:"setOffset",value:function(t){this.setLTOffset(t),this.setTOffset(t),this.setLOffset(t),this.setBROffset(t)}},{key:"bind",value:function(){var t=this,e=this.screen.table;Nt.bind(e,r.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.selectorAttr&&t.setOffset(t.selectorAttr)})),Nt.bind(e,r.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(e){t.selectorAttr&&t.setOffset(t.selectorAttr)})),Nt.bind(e,r.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(e){t.selectorAttr&&t.setOffset(t.selectorAttr)}))}},{key:"setShow",value:function(t){this.selectorAttr=t,this.setOffset(t)}},{key:"setHide",value:function(){this.selectorAttr=null,this.lt.hide(),this.t.hide(),this.l.hide(),this.br.hide()}}])&&na(n.prototype,o),i&&na(n,i),e}(Zs);function la(t){return(la="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sa(t,e){return!e||"object"!==la(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function aa(t){return(aa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ua(t,e){return(ua=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fa=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=sa(this,aa(e).call(this,"".concat(o,"-selector")))).cornerEl=C("div","".concat(o,"-selector-corner")),t.areaEl=C("div","".concat(o,"-selector-area")),t.areaEl.children(t.cornerEl),t.children(t.areaEl),t.hide(),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ua(t,e)}(e,t),e}(V);function ha(t){return(ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ya(t,e){return!e||"object"!==ha(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ba(t){return(ba=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function da(t,e){return(da=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ga={DOWN_SELECT:Symbol("选择单元格时触发"),CHANGE:Symbol("选择区域大小发生变化时触发"),SELECT_CHANGE:Symbol("选择区域发生变化时触发"),SELECT_CHANGE_OVER:Symbol("选择区域结束时触发")},va=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ya(this,ba(e).call(this,t))).options=r,n.selectorAttr=null,n.downSelectorAttr=null,n.onChangeStack=[],n.onSelectChangeStack=[],n.onSelectChangeOver=[],n.onDownSelectStack=[],n.lt=new fa,n.t=new fa,n.l=new fa,n.br=new fa,n.bind(),n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&da(t,e)}(e,t),n=e,(o=[{key:"bind",value:function(){var t=this,e=this.screen.table,n=e.mousePointer,o=e.focus;Nt.bind(e,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(i){if(0===i.button&&o.activate.el===e){var c,l=e.computeEventXy(i),s=l.x,a=l.y,u=t.getDownXYSelectorAttr(s,a);switch(t.setSelectAttr(u),t.setDownSelectAttr(u),t.setOffset(u),t.onDownSelectStack.forEach((function(t){return t()})),t.onChangeStack.forEach((function(t){return t()})),t.onSelectChangeStack.forEach((function(t){return t()})),u.edgeType){case"left":c=r.MOUSE_POINTER_TYPE.SELECT_ONE_ROW;break;case"top":c=r.MOUSE_POINTER_TYPE.SELECT_ONE_COLUMN;break;default:c=r.MOUSE_POINTER_TYPE.SELECT_CELL}n.on(c),Nt.mouseMoveUp(document,(function(n){var r=e.computeEventXy(n),o=r.x,i=r.y,c=t.getMoveXySelectorAttr(u,o,i);t.setSelectAttr(c),t.setOffset(c),t.onChangeStack.forEach((function(t){return t()})),t.onSelectChangeStack.forEach((function(t){return t()}))}),(function(){n.off(c),t.onSelectChangeOver.forEach((function(t){return t()}))}))}})),Nt.bind(e,r.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.selectorAttr&&t.setOffset(t.selectorAttr)})),Nt.bind(e,r.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.selectorAttr&&(t.setOffset(t.selectorAttr),t.onChangeStack.forEach((function(t){return t()})))})),Nt.bind(e,r.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.selectorAttr&&(t.setOffset(t.selectorAttr),t.onChangeStack.forEach((function(t){return t()})))})),Nt.bind(e,r.TABLE_EVENT_TYPE.SCALE_CHANGE,(function(){t.selectorAttr&&(t.setOffset(t.selectorAttr),t.onChangeStack.forEach((function(t){return t()})))}))}},{key:"setLTOffset",value:function(t){var e=this.screen.table,n=e.xTableFrozenContent,r=e.cols,o=e.rows,i=n.getScrollView(),c=t.rect,l=new ta(-1,-1,-1,-1),s=c.coincide(i);if(l.equals(s))this.lt.hide();else{var a=r.sectionSumWidth(s.sci,s.eci),u=o.sectionSumHeight(s.sri,s.eri),f=o.sectionSumHeight(i.sri,s.sri-1),h=r.sectionSumWidth(i.sci,s.sci-1);c.eci>i.eci?this.lt.areaEl.css("border-right","none"):this.lt.areaEl.cssRemoveKeys("border-right"),c.eri>i.eri?this.lt.areaEl.css("border-bottom","none"):this.lt.areaEl.cssRemoveKeys("border-bottom");var p=new Lc({x:h,y:f,width:a,height:u});this.lt.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setTOffset",value:function(t){var e=this.screen.table,n=e.xTop,r=e.cols,o=e.rows,i=n.getScrollView(),c=t.rect,l=new ta(-1,-1,-1,-1),s=c.coincide(i);if(l.equals(s))this.t.hide();else{var a=r.sectionSumWidth(s.sci,s.eci),u=o.sectionSumHeight(s.sri,s.eri),f=o.sectionSumHeight(i.sri,s.sri-1),h=r.sectionSumWidth(i.sci,s.sci-1);c.sci<i.sci?this.t.areaEl.css("border-left","none"):this.t.areaEl.cssRemoveKeys("border-left"),c.eri>i.eri?this.t.areaEl.css("border-bottom","none"):this.t.areaEl.cssRemoveKeys("border-bottom"),c.eci>i.eci?this.t.areaEl.css("border-right","none"):this.t.areaEl.cssRemoveKeys("border-right");var p=new Lc({x:h,y:f,width:a,height:u});this.t.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setLOffset",value:function(t){var e=this.screen.table,n=e.xLeft,r=e.cols,o=e.rows,i=n.getScrollView(),c=t.rect,l=new ta(-1,-1,-1,-1),s=c.coincide(i);if(l.equals(s))this.l.hide();else{var a=r.sectionSumWidth(s.sci,s.eci),u=o.sectionSumHeight(s.sri,s.eri),f=o.sectionSumHeight(i.sri,s.sri-1),h=r.sectionSumWidth(i.sci,s.sci-1);c.sri<i.sri?this.l.areaEl.css("border-top","none"):this.l.areaEl.cssRemoveKeys("border-top"),c.eci>i.eci?this.l.areaEl.css("border-right","none"):this.l.areaEl.cssRemoveKeys("border-right"),c.eri>i.eri?this.l.areaEl.css("border-bottom","none"):this.l.areaEl.cssRemoveKeys("border-bottom");var p=new Lc({x:h,y:f,width:a,height:u});this.l.offset({width:p.width,height:p.height,left:p.x,top:p.y}).show()}}},{key:"setBROffset",value:function(t){var e=this.screen.table,n=e.cols,r=e.rows,o=e.getScrollView(),i=t.rect,c=new ta(-1,-1,-1,-1),l=i.coincide(o);if(c.equals(l))this.br.hide();else{var s=n.sectionSumWidth(l.sci,l.eci),a=r.sectionSumHeight(l.sri,l.eri),u=r.sectionSumHeight(o.sri,l.sri-1),f=n.sectionSumWidth(o.sci,l.sci-1);i.sci<o.sci?this.br.areaEl.css("border-left","none"):this.br.areaEl.cssRemoveKeys("border-left"),i.sri<o.sri?this.br.areaEl.css("border-top","none"):this.br.areaEl.cssRemoveKeys("border-top"),i.eri>o.eri?this.br.areaEl.css("border-bottom","none"):this.br.areaEl.cssRemoveKeys("border-bottom"),i.eci>o.eci?this.br.areaEl.css("border-right","none"):this.br.areaEl.cssRemoveKeys("border-right");var h=new Lc({x:f,y:u,width:s,height:a});this.br.offset({width:h.width,height:h.height,left:h.x,top:h.y}).show()}}},{key:"setLTCorner",value:function(t,e){var n=this.screen.table.xTableFrozenContent.getScrollView(),r=t.rect,o=t.edge,i=t.edgeType,c=new ta(-1,-1,-1,-1),l=r.coincide(n);if(!c.equals(l))if(this.lt.cornerEl.cssRemoveKeys("left"),this.lt.cornerEl.cssRemoveKeys("top"),this.lt.cornerEl.cssRemoveKeys("right"),this.lt.cornerEl.cssRemoveKeys("bottom"),this.lt.cornerEl.hide(),o){var s="ltl"===e;"left"===i&&"ltt"===e&&(this.lt.cornerEl.show(),this.lt.cornerEl.css("left","0px"),this.lt.cornerEl.css("bottom","0px")),"top"===i&&s&&(this.lt.cornerEl.show(),this.lt.cornerEl.css("right","0px"),this.lt.cornerEl.css("top","0px"))}else"lt"===e&&(this.lt.cornerEl.show(),this.lt.cornerEl.css("right","0px"),this.lt.cornerEl.css("bottom","0px")),r.eci>n.eci&&this.lt.cornerEl.hide(),r.eri>n.eri&&this.lt.cornerEl.hide()}},{key:"setTCorner",value:function(t,e){var n=this.screen.table.xTop.getScrollView(),r=t.rect,o=t.edge,i=t.edgeType,c=new ta(-1,-1,-1,-1),l=r.coincide(n);if(!c.equals(l))if(this.t.cornerEl.cssRemoveKeys("left"),this.t.cornerEl.cssRemoveKeys("top"),this.t.cornerEl.cssRemoveKeys("right"),this.t.cornerEl.cssRemoveKeys("bottom"),this.t.cornerEl.hide(),o){var s="lttlbr"===e;"top"===i&&"tbr"===e&&(this.t.cornerEl.show(),this.t.cornerEl.css("right","0px"),this.t.cornerEl.css("top","0px")),"top"===i&&s&&(this.t.cornerEl.show(),this.t.cornerEl.css("right","0px"),this.t.cornerEl.css("top","0px")),"top"===i&&r.eci>n.eci&&this.t.cornerEl.hide()}else("t"===e||"ltt"===e)&&(this.t.cornerEl.show(),this.t.cornerEl.css("right","0px"),this.t.cornerEl.css("bottom","0px")),r.eci>n.eci&&this.t.cornerEl.hide(),r.eri>n.eri&&this.t.cornerEl.hide()}},{key:"setLCorner",value:function(t,e){var n=this.screen.table.xLeft.getScrollView(),r=t.rect,o=t.edge,i=t.edgeType,c=new ta(-1,-1,-1,-1),l=r.coincide(n);if(!c.equals(l))if(this.l.cornerEl.cssRemoveKeys("left"),this.l.cornerEl.cssRemoveKeys("top"),this.l.cornerEl.cssRemoveKeys("right"),this.l.cornerEl.cssRemoveKeys("bottom"),this.l.cornerEl.hide(),o){var s="lttlbr"===e;"left"===i&&"lbr"===e&&(this.l.cornerEl.show(),this.l.cornerEl.css("left","0"),this.l.cornerEl.css("bottom","0")),"left"===i&&s&&(this.l.cornerEl.show(),this.l.cornerEl.css("left","0"),this.l.cornerEl.css("bottom","0")),"left"===i&&r.eri>n.eri&&this.l.cornerEl.hide()}else("l"===e||"ltl"===e)&&(this.l.cornerEl.show(),this.l.cornerEl.css("right","0px"),this.l.cornerEl.css("bottom","0px")),r.eci>n.eci&&this.l.cornerEl.hide(),r.eri>n.eri&&this.l.cornerEl.hide()}},{key:"setBrCorner",value:function(t,e){var n=this.screen.table.getScrollView(),r=t.rect,o=t.edge,i=t.edgeType,c=new ta(-1,-1,-1,-1),l=r.coincide(n);if(!c.equals(l))if(this.br.cornerEl.cssRemoveKeys("left"),this.br.cornerEl.cssRemoveKeys("top"),this.br.cornerEl.cssRemoveKeys("right"),this.br.cornerEl.cssRemoveKeys("bottom"),this.br.cornerEl.hide(),o){var s="br"===e,a="lttlbr"===e;"left"===i&&s&&(this.br.cornerEl.show(),this.br.cornerEl.css("left","0"),this.br.cornerEl.css("bottom","0")),"top"===i&&s&&(this.br.cornerEl.show(),this.br.cornerEl.css("right","0"),this.br.cornerEl.css("top","0")),"left-top"===i&&a&&(this.br.cornerEl.show(),this.br.cornerEl.css("right","0"),this.br.cornerEl.css("bottom","0")),"left-top"===i&&s&&(this.br.cornerEl.show(),this.br.cornerEl.css("right","0"),this.br.cornerEl.css("bottom","0")),"left"===i&&r.eri>n.eri&&this.br.cornerEl.hide(),"top"===i&&r.eci>n.eci&&this.br.cornerEl.hide()}else{var u="lbr"===e;("br"===e||"tbr"===e||u||u||"lttlbr"===e)&&(this.br.cornerEl.show(),this.br.cornerEl.css("right","0px"),this.br.cornerEl.css("bottom","0px")),r.eri>n.eri&&this.br.cornerEl.hide(),r.eci>n.eci&&this.br.cornerEl.hide()}}},{key:"setSelectAttr",value:function(t){this.selectorAttr=t,this.selectorAttr.id=Date.now()}},{key:"setDownSelectAttr",value:function(t){this.downSelectorAttr=t}},{key:"getIntersectsArea",value:function(t){var e=this.screen.table,n=e.fixed,r=e.cols,o=e.rows,i=t.rect,c="",l=new ta(0,0,n.fxTop,n.fxLeft),s=new ta(0,n.fxLeft+1,n.fxTop,r.len),a=new ta(n.fxTop+1,0,o.len,n.fxLeft),u=new ta(n.fxTop+1,n.fxLeft+1,o.len,r.len);return i.intersects(l)&&(c+="lt"),i.intersects(s)&&(c+="t"),i.intersects(a)&&(c+="l"),i.intersects(u)&&(c+="br"),c}},{key:"setOffset",value:function(t){var e=this.getIntersectsArea(t);this.setLTOffset(t),this.setTOffset(t),this.setLOffset(t),this.setBROffset(t),this.setLTCorner(t,e),this.setTCorner(t,e),this.setLCorner(t,e),this.setBrCorner(t,e)}},{key:"getViewRange",value:function(){var t=this.screen.table,e=t.cols,n=t.rows,r=t.getScrollView(),o=r.sri,i=r.sci,c=r.eri,l=r.eci;t.getFixedWidth()>0&&(o=0),t.getFixedHeight()>0&&(i=0);var s=e.sectionSumWidth(i,l),a=n.sectionSumHeight(o,c);return new ta(o,i,c,l,s,a)}},{key:"getDownXYSelectorAttr",value:function(t,e){var n=this.screen.table,r=n.rows,o=n.cols,i=n.getTableMerges(),c=n.getRiCiByXy(t,e),l=c.ri,s=c.ci;if(-1===l&&-1===s)return{rect:new ta(0,0,r.len-1,o.len-1),edge:!0,edgeType:"left-top"};if(-1===l)return{rect:new ta(0,s,r.len-1,s),edge:!0,edgeType:"top"};if(-1===s)return{rect:new ta(l,0,l,o.len-1),edge:!0,edgeType:"left"};var a=i.getFirstIncludes(l,s),u=new ta(l,s,l,s);return a&&(u=a),{rect:u}}},{key:"getMoveXySelectorAttr",value:function(t,e,n){var r=this.screen.table,o=r.rows,i=r.cols,c=r.getTableMerges(),l=t.rect,s=t.edgeType,a=this.getViewRange(),u=r.getRiCiByXy(e,n),f=u.ri,h=u.ci;switch(-1===f&&(f=a.sri),-1===h&&(h=a.sci),s){case"left-top":var p=l.union(new ta(0,0,o.len-1,i.len-1));return{rect:p=l.union(p),edge:!0,edgeType:"left-top"};case"top":var y=l.union(new ta(0,h,0,h));return{rect:y=l.union(y),edge:!0,edgeType:"top"};case"left":var b=l.union(new ta(f,0,f,0));return{rect:b=l.union(b),edge:!0,edgeType:"left"}}var d=l.union(new ta(f,h,f,h));return{rect:d=c.union(d)}}},{key:"getSelectRange",value:function(){return this.selectorAttr.rect}},{key:"on",value:function(t,e){var n;switch(t){case ga.CHANGE:n=this.onChangeStack;break;case ga.SELECT_CHANGE_OVER:n=this.onSelectChangeOver;break;case ga.DOWN_SELECT:n=this.onDownSelectStack;break;case ga.SELECT_CHANGE:n=this.onSelectChangeStack}n&&n.push(e)}},{key:"remove",value:function(t,e){var n;switch(t){case ga.CHANGE:n=this.onChangeStack;break;case ga.SELECT_CHANGE_OVER:n=this.onSelectChangeOver;break;case ga.DOWN_SELECT:n=this.onDownSelectStack;break;case ga.SELECT_CHANGE:n=this.onSelectChangeStack}if(n)for(var r=0;r<n.length;r+=1)if(n[r]===e)return void n.splice(r,1)}}])&&pa(n.prototype,o),i&&pa(n,i),e}(Zs);function wa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ma=function(){function t(e){var n=e.align,r=void 0===n?ol.left:n,o=e.verticalAlign,i=void 0===o?il.center:o,c=e.textWrap,l=void 0===c?cl.OVER_FLOW:c,s=e.strikethrough,a=void 0!==s&&s,u=e.underline,f=void 0!==u&&u,h=e.color,p=void 0===h?"rgb(0,0,0)":h,y=e.name,b=void 0===y?"Arial":y,d=e.size,g=void 0===d?12:d,v=e.bold,w=void 0!==v&&v,m=e.italic,S=void 0!==m&&m,O=e.angle,E=void 0===O?0:O,_=e.direction,x=void 0===_?ll.HORIZONTAL:_,T=e.padding,k=void 0===T?5:T;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.align=r,this.verticalAlign=i,this.textWrap=l,this.strikethrough=a,this.underline=f,this.color=p,this.name=b,this.size=g,this.bold=w,this.italic=S,this.direction=x,this.angle=E,this.padding=k}var e,n,r;return e=t,(n=[{key:"clone",value:function(){return new t({align:this.align,verticalAlign:this.verticalAlign,textWrap:this.textWrap,strikethrough:this.strikethrough,underline:this.underline,color:this.color,name:this.name,size:this.size,bold:this.bold,italic:this.italic,angle:this.angle,direction:this.direction,padding:this.padding})}}])&&wa(e.prototype,n),r&&wa(e,r),t}();function Sa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Oa(t,e,n){return e&&Sa(t.prototype,e),n&&Sa(t,n),t}var Ea=0,_a=function(){function t(e){var n=e.zIndex,r=void 0===n?0:n,o=e.display,i=void 0!==o&&o,c=e.width,l=void 0===c?1:c,s=e.color,a=void 0===s?"#000000":s,u=e.type,f=void 0===u?Fi.SOLID_LINE:u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$zIndex=r,this.$display=i,this.$width=l,this.$color=a,this.$type=f}return Oa(t,null,[{key:"getZIndex",value:function(){return Ea+=1}}]),Oa(t,[{key:"equal",value:function(t){var e=this.color===t.color,n=this.width===t.width,r=this.type===t.type;return e&&n&&r}},{key:"toJSON",value:function(){return{zIndex:this.$zIndex,display:this.$display,width:this.$width,color:this.$color,type:this.$type}}},{key:"priority",value:function(t){if(_.isUnDef(t))return-2;var e=this.zIndex,n=t.zIndex;return e>n?1:n>e?-1:0}},{key:"zIndex",get:function(){return this.$zIndex}},{key:"display",get:function(){return this.$display},set:function(e){this.$zIndex=t.getZIndex(),this.$display=e}},{key:"width",get:function(){return this.$width},set:function(e){this.$zIndex=t.getZIndex(),this.$width=e}},{key:"color",get:function(){return this.$color},set:function(e){this.$zIndex=t.getZIndex(),this.$color=e}},{key:"type",get:function(){return this.$type},set:function(e){this.$zIndex=t.getZIndex(),this.$type=e}}]),t}();function xa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ta=function(){function t(e){var n=e.left,r=void 0===n?{}:n,o=e.top,i=void 0===o?{}:o,c=e.right,l=void 0===c?{}:c,s=e.bottom,a=void 0===s?{}:s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.left=new _a(r),this.top=new _a(i),this.right=new _a(l),this.bottom=new _a(a)}var e,n,r;return e=t,(n=[{key:"setAllDisplay",value:function(t){this.setLDisplay(t),this.setTDisplay(t),this.setRDisplay(t),this.setBDisplay(t)}},{key:"setLDisplay",value:function(t){this.left.display=t}},{key:"setTDisplay",value:function(t){this.top.display=t}},{key:"setRDisplay",value:function(t){this.right.display=t}},{key:"setBDisplay",value:function(t){this.bottom.display=t}},{key:"setAllColor",value:function(t){this.setLColor(t),this.setTColor(t),this.setRColor(t),this.setBColor(t)}},{key:"setLColor",value:function(t){this.left.color=t}},{key:"setTColor",value:function(t){this.top.color=t}},{key:"setRColor",value:function(t){this.right.color=t}},{key:"setBColor",value:function(t){this.bottom.color=t}},{key:"setAllWidth",value:function(t){this.setLWidth(t),this.setTWidth(t),this.setRWidth(t),this.setBWidth(t)}},{key:"setLWidth",value:function(t){this.left.width=t}},{key:"setTWidth",value:function(t){this.top.width=t}},{key:"setRWidth",value:function(t){this.right.width=t}},{key:"setBWidth",value:function(t){this.bottom.width=t}},{key:"setAllType",value:function(t){this.setLType(t),this.setTType(t),this.setRType(t),this.setBType(t)}},{key:"setLType",value:function(t){this.left.type=t}},{key:"setTType",value:function(t){this.top.type=t}},{key:"setRType",value:function(t){this.right.type=t}},{key:"setBType",value:function(t){this.bottom.type=t}},{key:"clone",value:function(){return new t({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}}])&&xa(e.prototype,n),r&&xa(e,r),t}();function ka(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ca=function(){function t(e){var n=e.text,r=void 0===n?_.EMPTY:n,o=e.background,i=void 0===o?_.Nul:o,c=e.format,l=void 0===c?"default":c,s=e.fontAttr,a=void 0===s?{}:s,u=e.borderAttr,f=void 0===u?{}:u,h=e.contentWidth,p=void 0===h?0:h;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.background=i,this.format=l,this.text=r,this.fontAttr=new ma(a),this.borderAttr=new Ta(f),this.contentWidth=p}var e,n,r;return e=t,(n=[{key:"setContentWidth",value:function(t){this.contentWidth=t}},{key:"clone",value:function(){return new t({background:this.background,format:this.format,text:this.text,fontAttr:this.fontAttr,borderAttr:this.borderAttr,contentWidth:this.contentWidth})}},{key:"toJSON",value:function(){return{background:this.background,format:this.format,text:this.text,fontAttr:this.fontAttr,borderAttr:this.borderAttr,contentWidth:this.contentWidth}}}])&&ka(e.prototype,n),r&&ka(e,r),t}();function Pa(t){return(Pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ja(t,e){return!e||"object"!==Pa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Aa(t){return(Aa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function La(t,e){return(La=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ra=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ja(this,Aa(e).call(this,"".concat(o,"-scale-context-menu-item")))).scale=t,n.titleElement=C("div","".concat(o,"-scale-context-menu-item-title")),n.titleElement.text("".concat(t,"%")),n.titleElement.css("text-align","center"),n.children(n.titleElement),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&La(t,e)}(e,t),e}(_e);function Va(t){return(Va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Na(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wa(t,e){return!e||"object"!==Va(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Da(t){return(Da=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ha(t,e){return(Ha=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ma=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Wa(this,Da(e).call(this,"".concat(o,"-scale-context-menu"),_.mergeDeep({onUpdate:function(){}},n)))).items=[new Ra(200),new Ra(150),new Ra(125),new Ra(100),new Ra(90),new Ra(75),new Ra(50)],t.items.forEach((function(e){e.on(r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.scale)})),t.addItem(e)})),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ha(t,e)}(e,t),n=e,(i=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}}])&&Na(n.prototype,i),c&&Na(n,c),e}(we);function Ba(t){return(Ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ia(t){return(Ia=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ya(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fa(t,e){return(Fa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ua=function(t){function e(){var t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(r=Ia(e).call(this,"".concat(o,"-tools-scale")))||"object"!==Ba(r)&&"function"!=typeof r?Ya(n):r).options=i,t.setTitle("100%"),t.setWidth(50),t.setEllipsis(),t.scaleContextMenu=new Ma(_.copyProp({el:Ya(t),position:ue.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fa(t,e)}(e,t),e}(Rt);function za(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ga(t){return(Ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xa(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ka(t,e){return!e||"object"!==Ga(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qa(t){return(qa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Za(t,e)}function Za(t,e){return(Za=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ja=function(t){function e(){return Xa(this,e),Ka(this,qa(e).call(this,"".concat(o,"-tools-divider")))}return $a(e,t),e}(V),Qa=function(t){function e(t){var n;Xa(this,e),(n=Ka(this,qa(e).call(this,"".concat(o,"-tools-menu")))).workTop=t;var r=n.workTop.work.body.sheetView;return n.undo=new ft,n.redo=new dt,n.scale=new Ua({contextMenu:{onUpdate:function(t){n.scale.setTitle("".concat(t,"%")),n.workTop.work.body.setScale(t/100)}}}),n.paintFormat=new Ot,n.clearFormat=new kt,n.format=new Xe({contextMenu:{onUpdate:function(t,e){var o=r.getActiveSheet().table,i=o.screen,c=o.getStyleCellsHelper(),l=o.getTableDataSnapshot(),s=i.findByClass(va).selectorAttr;if(n.format.setTitle(e),s){l.begin();var a=l.cellDataProxy;c.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(e,n,r){var o=r.clone();o.format=t,a.setCell(e,n,o)}}),l.end(),o.render()}}}}),n.font=new hn({contextMenu:{onUpdate:function(t){var e=r.getActiveSheet().table,o=e.screen,i=e.getStyleCellsHelper(),c=e.getTableDataSnapshot(),l=o.findByClass(va).selectorAttr;if(n.font.setTitle(t),l){c.begin();var s=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(e,n,r){var o=r.clone();o.fontAttr.name=t,s.setCell(e,n,o)}}),c.end(),e.render()}}}}),n.dprFontSize=new Cn({contextMenu:{onUpdate:function(t){var e=r.getActiveSheet().table,o=e.screen,i=e.getStyleCellsHelper(),c=e.getTableDataSnapshot(),l=o.findByClass(va).selectorAttr;if(n.dprFontSize.setTitle(t),l){c.begin();var s=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(e,n,r){var o=r.clone();o.fontAttr.size=t,s.setCell(e,n,o)}}),c.end(),e.render()}}}}),n.fontColor=new Mr({contextMenu:{onUpdate:function(t){var e=r.getActiveSheet().table,o=e.screen,i=e.getStyleCellsHelper(),c=e.getTableDataSnapshot(),l=o.findByClass(va).selectorAttr;if(n.fontColor.setColor(t),l){c.begin();var s=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(e,n,r){var o=r.clone();o.fontAttr.color=t,s.setCell(e,n,o)}}),c.end(),e.render()}}}}),n.fillColor=new no({contextMenu:{onUpdate:function(t){var e=r.getActiveSheet().table,o=e.screen,i=e.getStyleCellsHelper(),c=e.getTableDataSnapshot(),l=o.findByClass(va).selectorAttr;if(n.fillColor.setColor(t),l){c.begin();var s=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(e,n,r){var o=r.clone();o.background=t,s.setCell(e,n,o)}}),c.end(),e.render()}}}}),n.border=new rc({contextMenu:{onUpdate:function(t,e,n){var o=r.getActiveSheet().table,i=o.screen,c=o.getOperateCellsHelper(),l=o.getTableDataSnapshot(),s=i.findByClass(va).selectorAttr;if(s){l.begin();var a=l.cellDataProxy,u=s.rect,f=1,h=Fi.SOLID_LINE;switch(n){case"line1":f=1,h=Fi.SOLID_LINE;break;case"line2":f=2,h=Fi.SOLID_LINE;break;case"line3":f=3,h=Fi.SOLID_LINE;break;case"line4":h=Fi.DOTTED_LINE;break;case"line5":h=Fi.POINT_LINE;break;case"line6":h=Fi.DOUBLE_LINE}switch(t){case"border1":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,n,r){var o=r.clone(),i=o.borderAttr;i.setAllDisplay(!0),i.setAllColor(e),i.setAllWidth(f),i.setAllType(h),a.setCell(t,n,o)}});break;case"border2":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,n,r){var o=r.clone(),i=o.borderAttr;t!==u.sri&&(i.setTDisplay(!0),i.setTColor(e),i.setTWidth(f),i.setTType(h)),t!==u.eri&&(i.setBDisplay(!0),i.setBColor(e),i.setBWidth(f),i.setBType(h)),n!==u.sci&&(i.setLDisplay(!0),i.setLColor(e),i.setLWidth(f),i.setLType(h)),n!==u.eci&&(i.setRDisplay(!0),i.setRColor(e),i.setRWidth(f),i.setRType(h)),a.setCell(t,n,o)}});break;case"border3":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,n,r){var o=r.clone().borderAttr;t!==u.sri&&(o.setTDisplay(!0),o.setTColor(e),o.setTWidth(f),o.setTType(h)),t!==u.eri&&(o.setBDisplay(!0),o.setBColor(e),o.setBWidth(f),o.setBType(h))}});break;case"border4":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,n,r){var o=r.clone(),i=o.borderAttr;n!==u.sci&&(i.setLDisplay(!0),i.setLColor(e),i.setLWidth(f),i.setLType(h)),n!==u.eci&&(i.setRDisplay(!0),i.setRColor(e),i.setRWidth(f),i.setRType(h)),a.setCell(t,n,o)}});break;case"border5":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,n,r){var o=r.clone(),i=o.borderAttr;t===u.sri&&(i.setTDisplay(!0),i.setTColor(e),i.setTWidth(f),i.setTType(h)),t===u.eri&&(i.setBDisplay(!0),i.setBColor(e),i.setBWidth(f),i.setBType(h)),n===u.sci&&(i.setLDisplay(!0),i.setLColor(e),i.setLWidth(f),i.setLType(h)),n===u.eci&&(i.setRDisplay(!0),i.setRColor(e),i.setRWidth(f),i.setRType(h)),a.setCell(t,n,o)}});break;case"border6":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,n,r){var o=r.clone(),i=o.borderAttr;n===u.sci&&(i.setLDisplay(!0),i.setLColor(e),i.setLWidth(f),i.setLType(h)),a.setCell(t,n,o)}});break;case"border7":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,n,r){var o=r.clone(),i=o.borderAttr;t===u.sri&&(i.setTDisplay(!0),i.setTColor(e),i.setTWidth(f),i.setTType(h)),a.setCell(t,n,o)}});break;case"border8":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,n,r){var o=r.clone(),i=o.borderAttr;n===u.eci&&(i.setRDisplay(!0),i.setRColor(e),i.setRWidth(f),i.setRType(h)),a.setCell(t,n,o)}});break;case"border9":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,n,r){var o=r.clone(),i=o.borderAttr;t===u.eri&&(i.setBDisplay(!0),i.setBColor(e),i.setBWidth(f),i.setBType(h)),a.setCell(t,n,o)}});break;case"border10":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,e,n){var r=n.clone();r.borderAttr.setAllDisplay(!1),a.setCell(t,e,r)}})}l.end(),o.render()}}}}),n.fontBold=new Rn,n.fontItalic=new Hn,n.underLine=new Fn,n.fontStrike=new Kn,n.merge=new sc,n.horizontalAlign=new Ol({contextMenu:{onUpdate:function(t){var e=r.getActiveSheet().table,o=e.screen,i=e.getStyleCellsHelper(),c=e.getTableDataSnapshot(),l=o.findByClass(va).selectorAttr;switch(t){case ol.left:n.horizontalAlign.setIcon(new et("align-left"));break;case ol.center:n.horizontalAlign.setIcon(new et("align-center"));break;case ol.right:n.horizontalAlign.setIcon(new et("align-right"))}if(l){c.begin();var s=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(e,n,r){var o=r.clone();o.fontAttr.align=t,s.setCell(e,n,o)}}),c.end(),e.render()}}}}),n.verticalAlign=new Jl({contextMenu:{onUpdate:function(t){var e=r.getActiveSheet().table,o=e.screen,i=e.getStyleCellsHelper(),c=e.getTableDataSnapshot(),l=o.findByClass(va).selectorAttr;switch(t){case il.top:n.verticalAlign.setIcon(new et("align-top"));break;case il.center:n.verticalAlign.setIcon(new et("align-middle"));break;case il.bottom:n.verticalAlign.setIcon(new et("align-bottom"))}if(l){c.begin();var s=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l.rect,callback:function(e,n,r){var o=r.clone();o.fontAttr.verticalAlign=t,s.setCell(e,n,o)}}),c.end(),e.render()}}}}),n.textWrapping=new Cs({contextMenu:{onUpdate:function(t){var e,o=r.getActiveSheet().table,i=o.screen,c=o.getStyleCellsHelper(),l=o.getTableDataSnapshot(),s=i.findByClass(va).selectorAttr;switch(t){case cl.TRUNCATE:e=new et("truncate");break;case cl.WORD_WRAP:e=new et("text-wrap");break;case cl.OVER_FLOW:default:e=new et("overflow")}if(n.textWrapping.setIcon(e),s){l.begin();var a=l.cellDataProxy;c.getCellOrNewCellByViewRange({rectRange:s.rect,callback:function(e,n,r){var o=r.clone();o.fontAttr.textWrap=t,a.setCell(e,n,o)}}),l.end(),o.render()}}}}),n.fixed=new Rs,n.filter=new Hs,n.functions=new Fs,n.children(n.undo),n.children(n.redo),n.children(new Ja),n.children(n.scale),n.children(n.paintFormat),n.children(n.clearFormat),n.children(n.format),n.children(new Ja),n.children(n.font),n.children(n.dprFontSize),n.children(new Ja),n.children(n.fontBold),n.children(n.fontItalic),n.children(n.underLine),n.children(n.fontStrike),n.children(n.fontColor),n.children(new Ja),n.children(n.fillColor),n.children(n.border),n.children(n.merge),n.children(n.horizontalAlign),n.children(n.verticalAlign),n.children(n.textWrapping),n.children(n.fixed),n.children(n.filter),n.children(n.functions),n}var n,i,c;return $a(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"bind",value:function(){var t=this,e=this.workTop.work.body,n=e.sheetView;Nt.bind(e,r.WORK_BODY_EVENT_TYPE.CHANGE_ACTIVE,(function(){t.setStatus()})),Nt.bind(e,r.TABLE_EVENT_TYPE.DATA_CHANGE,(function(){t.setStatus()})),Nt.bind(e,r.TABLE_EVENT_TYPE.SELECT_DOWN,(function(){t.setFormatStatus(),t.setFontStatus(),t.setFontSizeStatus(),t.setFontBoldStatus(),t.setFontItalicStatus(),t.setUnderLineStatus(),t.setFontStrikeStatus(),t.setFontColorStatus(),t.setFillColorStatus(),t.setHorizontalAlignStatus(),t.setVerticalAlignStatus(),t.setTextWrappingStatus()})),Nt.bind(this.undo,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table.getTableDataSnapshot();t.canBack()&&t.back()})),Nt.bind(this.redo,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table.getTableDataSnapshot();t.canGo()&&t.go()})),Nt.bind(this.scale,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.scale.scaleContextMenu,r=n.elPopUp;pe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(this.paintFormat,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var e=n.getActiveSheet(),r=e.table,o=r.screen,i=r.getTableMerges(),c=r.getTableCells(),l=r.getTableDataSnapshot(),s=o.findByClass(ca),a=o.findByClass(va),u=a.selectorAttr;u&&(s.setShow(u),t.paintFormat.active(!0),t.paintFormat.addSheet(e),a.on(ga.SELECT_CHANGE_OVER,(function n(){s.setHide(),t.paintFormat.active(!1),t.paintFormat.removeSheet(e),a.remove(ga.SELECT_CHANGE_OVER,n);var o=u.rect,f=a.selectorAttr.rect;l.begin();for(var h=l.cellDataProxy,p=o.sri,y=f.sri;p<=o.eri;p+=1,y+=1)for(var b=o.sci,d=f.sci;b<=o.eci;b+=1,d+=1){var g=i.getFirstIncludes(p,b),v=null;if(g?g.sri===p&&g.sci===b&&(v=c.getCell(p,b)):v=c.getCell(p,b),v){var w=c.getCellOrNew(y,d),m=v.clone();m.text=w.text,h.setCell(y,d,m)}}l.end(),r.render()})))})),Nt.bind(this.clearFormat,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.screen,r=t.getStyleCellsHelper(),o=t.getTableDataSnapshot(),i=e.findByClass(va).selectorAttr;if(i){o.begin();var c=o.cellDataProxy;r.getCellOrNewCellByViewRange({rectRange:i.rect,callback:function(t,e,n){var r=n.text;c.setCell(t,e,new Ca({text:r}))}}),o.end(),t.render()}})),Nt.bind(this.format,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.format.formatContextMenu,r=n.elPopUp;pe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(this.font,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.font.fontContextMenu,r=n.elPopUp;pe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(this.dprFontSize,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.dprFontSize.fontSizeContextMenu,r=n.elPopUp;pe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(this.fontBold,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.screen,r=t.getStyleCellsHelper(),o=t.getTableCells(),i=t.getTableDataSnapshot(),c=e.findByClass(va).selectorAttr;if(c){var l=!o.getCellOrNew(c.rect.sri,c.rect.sci).fontAttr.bold;i.begin();var s=i.cellDataProxy;r.getCellOrNewCellByViewRange({rectRange:c.rect,callback:function(t,e,n){var r=n.clone();r.fontAttr.bold=l,s.setCell(t,e,r)}}),i.end(),t.render()}})),Nt.bind(this.fontItalic,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.screen,r=t.getStyleCellsHelper(),o=t.getTableCells(),i=t.getTableDataSnapshot(),c=e.findByClass(va).selectorAttr;if(c){var l=!o.getCellOrNew(c.rect.sri,c.rect.sci).fontAttr.italic;i.begin();var s=i.cellDataProxy;r.getCellOrNewCellByViewRange({rectRange:c.rect,callback:function(t,e,n){var r=n.clone();r.fontAttr.italic=l,s.setCell(t,e,r)}}),i.end(),t.render()}})),Nt.bind(this.underLine,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.screen,r=t.getStyleCellsHelper(),o=t.getTableCells(),i=t.getTableDataSnapshot(),c=e.findByClass(va).selectorAttr;if(c){var l=!o.getCellOrNew(c.rect.sri,c.rect.sci).fontAttr.underline;i.begin();var s=i.cellDataProxy;r.getCellOrNewCellByViewRange({rectRange:c.rect,callback:function(t,e,n){var r=n.clone();r.fontAttr.underline=l,s.setCell(t,e,r)}}),i.end(),t.render()}})),Nt.bind(this.fontStrike,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.screen,r=t.getStyleCellsHelper(),o=t.getTableCells(),i=t.getTableDataSnapshot(),c=e.findByClass(va).selectorAttr;if(c){var l=!o.getCellOrNew(c.rect.sri,c.rect.sci).fontAttr.strikethrough;i.begin();var s=i.cellDataProxy;r.getCellOrNewCellByViewRange({rectRange:c.rect,callback:function(t,e,n){var r=n.clone();r.fontAttr.strikethrough=l,s.setCell(t,e,r)}}),i.end(),t.render()}})),Nt.bind(this.fontColor,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.fontColor.fontColorContextMenu,r=n.elPopUp;pe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(this.fillColor,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.fillColor.fillColorContextMenu,r=n.elPopUp;pe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(this.border,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.border.borderTypeContextMenu,r=n.elPopUp;pe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(this.merge,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){var e=n.getActiveSheet().table,r=e.screen,o=e.getTableMerges(),i=e.getTableDataSnapshot(),c=r.findByClass(va).selectorAttr;if(c){var l=c.rect.clone(),s=o.getFirstIncludes(l.sri,l.sci);i.begin();var a=i.mergeDataProxy;_.isNotUnDef(s)&&l.equals(s)?a.deleteMerge(s):a.addMerge(l),i.end(),e.render()}t.stopPropagation(),t.preventDefault()})),Nt.bind(this.horizontalAlign,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.horizontalAlign.horizontalContextMenu,r=n.elPopUp;pe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(this.verticalAlign,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.verticalAlign.verticalContextMenu,r=n.elPopUp;pe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),Nt.bind(this.textWrapping,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.textWrapping.textWrappingContextMenu,r=n.elPopUp;pe.closeAll([r]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()}))}},{key:"setUndoStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table.getTableDataSnapshot();this.undo.active(t.canBack())}},{key:"setRedoStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table.getTableDataSnapshot();this.redo.active(t.canGo())}},{key:"setScaleStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table.scale.goto(100);this.scale.setTitle("".concat(t,"%"))}},{key:"setPaintFormatStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet();this.paintFormat.active(this.paintFormat.includeSheet(t))}},{key:"setFormatStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.getTableCells(),r=e.findByClass(va).selectorAttr,o="常规",i="default";if(r)switch(i=n.getCellOrNew(r.rect.sri,r.rect.sci).format){case"default":o="常规";break;case"text":o="文本";break;case"number":o="数字";break;case"percentage":o="百分比";break;case"fraction":o="分数";break;case"ENotation":o="科学计数";break;case"rmb":o="人民币";break;case"hk":o="港币";break;case"dollar":o="美元";break;case"date1":case"date2":case"date3":case"date4":case"date5":o="日期";break;case"time":o="时间"}this.format.setTitle(o),this.format.formatContextMenu.setActiveByType(i)}},{key:"setFontStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.getTableCells(),r=e.findByClass(va).selectorAttr,o="Arial";r&&(o=n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.name),this.font.setTitle(o),this.font.fontContextMenu.setActiveByType(o)}},{key:"setFontSizeStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.getTableCells(),r=e.findByClass(va).selectorAttr,o="12";r&&(o=n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.size),this.dprFontSize.setTitle(o)}},{key:"setFontBoldStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.getTableCells(),r=e.findByClass(va).selectorAttr,o=!1;r&&(o=n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.bold),this.fontBold.active(o)}},{key:"setFontItalicStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.getTableCells(),r=e.findByClass(va).selectorAttr,o=!1;r&&(o=n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.italic),this.fontItalic.active(o)}},{key:"setUnderLineStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.getTableCells(),r=e.findByClass(va).selectorAttr,o=!1;r&&(o=n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.underline),this.underLine.active(o)}},{key:"setFontStrikeStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.getTableCells(),r=e.findByClass(va).selectorAttr,o=!1;r&&(o=n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.strikethrough),this.fontStrike.active(o)}},{key:"setFontColorStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.getTableCells(),r=e.findByClass(va).selectorAttr,o="rgb(0, 0, 0)";r&&(o=n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.color),this.fontColor.setColor(o),this.fontColor.fontColorContextMenu.setActiveByColor(o)}},{key:"setFillColorStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.getTableCells(),r=e.findByClass(va).selectorAttr,o="rgb(255, 255, 255)";if(r){var i=n.getCellOrNew(r.rect.sri,r.rect.sci);i.background&&(o=i.background)}this.fillColor.setColor(o),this.fillColor.fillColorContextMenu.setActiveByColor(o)}},{key:"setHorizontalAlignStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.getTableCells(),r=e.findByClass(va).selectorAttr,o=new et("align-left");if(r)switch(n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.align){case ol.left:o=new et("align-left");break;case ol.center:o=new et("align-center");break;case ol.right:o=new et("align-right")}this.horizontalAlign.setIcon(o)}},{key:"setVerticalAlignStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.getTableCells(),r=e.findByClass(va).selectorAttr,o=new et("align-middle");if(r)switch(n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.verticalAlign){case il.top:o=new et("align-top");break;case il.center:o=new et("align-middle");break;case il.bottom:o=new et("align-bottom")}this.verticalAlign.setIcon(o)}},{key:"setTextWrappingStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.screen,n=t.getTableCells(),r=e.findByClass(va).selectorAttr,o=new et("text-wrap");if(r)switch(n.getCellOrNew(r.rect.sri,r.rect.sci).fontAttr.textWrap){case cl.TRUNCATE:o=new et("truncate");break;case cl.WORD_WRAP:o=new et("text-wrap");break;case cl.OVER_FLOW:default:o=new et("overflow")}this.textWrapping.setIcon(o)}},{key:"setStatus",value:function(){this.setUndoStatus(),this.setRedoStatus(),this.setScaleStatus(),this.setPaintFormatStatus(),this.setFormatStatus(),this.setFontStatus(),this.setFontSizeStatus(),this.setFontBoldStatus(),this.setFontItalicStatus(),this.setUnderLineStatus(),this.setFontStrikeStatus(),this.setFontColorStatus(),this.setFillColorStatus(),this.setHorizontalAlignStatus(),this.setVerticalAlignStatus(),this.setTextWrappingStatus()}}])&&za(n.prototype,i),c&&za(n,c),e}(V);function tu(t){return(tu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nu(t,e){return!e||"object"!==tu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ru(t){return(ru=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ou(t,e){return(ou=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var iu=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=nu(this,ru(e).call(this,"".concat(o,"-option-item ").concat(t)))).title="",n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ou(t,e)}(e,t),n=e,(r=[{key:"setTitle",value:function(t){this.title=t,this.text(this.title)}}])&&eu(n.prototype,r),i&&eu(n,i),e}(V);function cu(t){return(cu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lu(t,e){return!e||"object"!==cu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function su(t){return(su=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function au(t,e){return(au=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var uu=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=lu(this,su(e).call(this,"".concat(o,"-tools-file")))).setTitle("文件"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&au(t,e)}(e,t),e}(iu);function fu(t){return(fu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hu(t,e){return!e||"object"!==fu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pu(t){return(pu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yu(t,e){return(yu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bu=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=hu(this,pu(e).call(this,"".concat(o,"-tools-format")))).setTitle("格式"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yu(t,e)}(e,t),e}(iu);function du(t){return(du="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gu(t,e){return!e||"object"!==du(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vu(t){return(vu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wu(t,e){return(wu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mu=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=gu(this,vu(e).call(this,"".concat(o,"-tools-insert")))).setTitle("插入"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wu(t,e)}(e,t),e}(iu);function Su(t){return(Su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ou(t,e){return!e||"object"!==Su(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Eu(t){return(Eu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _u(t,e){return(_u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xu=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ou(this,Eu(e).call(this,"".concat(o,"-tools-look")))).setTitle("查看"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_u(t,e)}(e,t),e}(iu);function Tu(t){return(Tu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ku(t,e){return!e||"object"!==Tu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Cu(t){return(Cu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pu(t,e){return(Pu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ju=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ku(this,Cu(e).call(this,"".concat(o,"-tools-update")))).setTitle("修改"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pu(t,e)}(e,t),e}(iu);function Au(t){return(Au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ru(t,e){return!e||"object"!==Au(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vu(t){return(Vu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nu(t,e){return(Nu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wu=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ru(this,Vu(e).call(this,"".concat(o,"-option")))).workTop=t,n.title=" X-Sheet 工作簿",n.logoEle=C("div","".concat(o,"-option-logo")),n.titleEle=C("div","".concat(o,"-option-title")),n.optionsEle=C("div","".concat(o,"-option-box")),n.leftEle=C("div","".concat(o,"-option-left")),n.rightEle=C("div","".concat(o,"-option-right")),n.leftEle.children(n.logoEle),n.rightEle.children(n.titleEle,n.optionsEle),n.children(n.leftEle),n.children(n.rightEle),n.setTitle(n.title),n.file=new uu,n.format=new bu,n.insert=new mu,n.look=new xu,n.update=new ju,n.optionsEle.children(n.file),n.optionsEle.children(n.format),n.optionsEle.children(n.insert),n.optionsEle.children(n.look),n.optionsEle.children(n.update),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nu(t,e)}(e,t),n=e,(r=[{key:"setTitle",value:function(t){this.title=t,this.titleEle.text(t)}}])&&Lu(n.prototype,r),i&&Lu(n,i),e}(V);function Du(t){return(Du="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mu(t,e){return!e||"object"!==Du(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bu(t){return(Bu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Iu(t,e){return(Iu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yu=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Mu(this,Bu(e).call(this,"".concat(o,"-work-top")))).work=t,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Iu(t,e)}(e,t),n=e,(r=[{key:"onAttach",value:function(){this.toolsMenu=new Qa(this),this.option=new Wu(this),this.attach(this.option),this.attach(this.toolsMenu)}}])&&Hu(n.prototype,r),i&&Hu(n,i),e}(V);function Fu(t){return(Fu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uu(t,e){return!e||"object"!==Fu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zu(t){return(zu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gu(t,e){return(Gu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xu=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Uu(this,zu(e).call(this,"".concat(o,"-vertical-center-element")))).options=_.mergeDeep({style:{}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gu(t,e)}(e,t),e}(M);function Ku(t){return(Ku="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qu(t,e){return!e||"object"!==Ku(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $u(t){return($u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zu(t,e){return(Zu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ju=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=qu(this,$u(e).call(this,"div","".concat(o,"-vertical-center")))).options=_.mergeDeep({style:{}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zu(t,e)}(e,t),e}(M);function Qu(t){return(Qu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ef(t,e){return!e||"object"!==Qu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nf(t,e,n){return(nf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=rf(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function rf(t){return(rf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function of(t,e){return(of=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var cf=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ef(this,rf(e).call(this,"".concat(o,"-sheet-view")))).sheetList=[],t.activeIndex=-1,t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&of(t,e)}(e,t),n=e,(i=[{key:"attach",value:function(t){var n=this;this.sheetList.push(t),nf(rf(e.prototype),"attach",this).call(this,t),t.hide(),Nt.bind(t,r.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){n.trigger(r.TABLE_EVENT_TYPE.CHANGE_WIDTH)})),Nt.bind(t,r.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){n.trigger(r.TABLE_EVENT_TYPE.CHANGE_HEIGHT)})),Nt.bind(t,r.TABLE_EVENT_TYPE.DATA_CHANGE,(function(){n.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE)})),Nt.bind(t,r.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(){n.trigger(r.TABLE_EVENT_TYPE.SELECT_CHANGE)})),Nt.bind(t,r.TABLE_EVENT_TYPE.SELECT_DOWN,(function(){n.trigger(r.TABLE_EVENT_TYPE.SELECT_DOWN,n)}))}},{key:"setActiveSheet",value:function(t){var e=this.sheetList;return e[t]?(this.activeIndex=t,this.setActive(e[t])):null}},{key:"setActive",value:function(t){return t.show(),t.sibling().forEach((function(t){t.hide()})),t}},{key:"getActiveSheet",value:function(){return this.sheetList[this.activeIndex]}},{key:"getLastIndex",value:function(){return this.sheetList.length-1}}])&&tf(n.prototype,i),c&&tf(n,c),e}(V);function lf(t){return(lf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function af(t,e){return!e||"object"!==lf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function uf(t){return(uf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ff(t,e){return(ff=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hf=function(t){function e(t){var n,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=af(this,uf(e).call(this,"".concat(o,"-sheet-switch-tab")))).last=C("div","".concat(o,"-switch-tab-last-btn")),r.next=C("div","".concat(o,"-switch-tab-next-btn")),r.content=C("div","".concat(o,"-sheet-tab-content")),r.tabs=C("div","".concat(o,"-sheet-tab-tabs")),r.plus=C("div","".concat(o,"-sheet-tab-plus")),r.content.children(r.tabs),(n=r).children.apply(n,[r.last,r.next,r.content,r.plus]),r.optiions=_.mergeDeep({onAdd:function(t){return t},onSwitch:function(t){return t}},t),r.left=null,r.tabList=[],r}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ff(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"offsetSizeLeft",value:function(){var t=this.content.offset().width,e=this.tabs.offset().width;e>t&&(this.left=-(e-t),this.tabs.css("marginLeft","".concat(this.left,"px")))}},{key:"bind",value:function(){var t=this,e=this.next,n=this.last,o=this.plus;Nt.bind(e,r.SYSTEM_EVENT_TYPE.CLICK,(function(){var e=t.content.offset().width,n=-(t.tabs.offset().width-e),r=t.left||0;(r-=30)<n&&(r=n),t.left=r,t.tabs.css("marginLeft","".concat(t.left,"px"))})),Nt.bind(n,r.SYSTEM_EVENT_TYPE.CLICK,(function(){var e=t.left||0;(e+=30)>0&&(e=0),t.left=e,t.tabs.css("marginLeft","".concat(t.left,"px"))})),Nt.bind(o,r.SYSTEM_EVENT_TYPE.CLICK,(function(){t.optiions.onAdd(),t.offsetSizeLeft()}))}},{key:"attach",value:function(t){var e=this;this.tabList.push(t),this.tabs.children(t),t.onAttach(),Nt.bind(t,r.SYSTEM_EVENT_TYPE.CLICK,(function(){e.setActive(t),e.optiions.onSwitch(t)}))}},{key:"setActiveTab",value:function(t){var e=this.tabList;return e[t]?(this.setActive(e[t]),e[t]):null}},{key:"setActive",value:function(t){t.addClass("active"),t.sibling().forEach((function(t){t.removeClass("active")}))}},{key:"getLastIndex",value:function(){return this.tabList.length-1}}])&&sf(n.prototype,i),c&&sf(n,c),e}(V);function pf(t){return(pf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bf(t,e){return!e||"object"!==pf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function df(t){return(df=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gf(t,e){return(gf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vf=0,wf=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Sheet".concat(vf+=1);return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=bf(this,df(e).call(this,"".concat(o,"-sheet-tab")))).setName(n),t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gf(t,e)}(e,t),n=e,(r=[{key:"setName",value:function(t){this.name=t,this.text(this.name)}}])&&yf(n.prototype,r),i&&yf(n,i),e}(V);function mf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Sf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Of=function(){function t(){mf(this,t),this.value=1,this.enableFloat=!1}var e,n,r;return e=t,(n=[{key:"useFloat",value:function(){this.enableFloat=!0}},{key:"notFloat",value:function(){this.enableFloat=!1}},{key:"back",value:function(t){return this.enableFloat?t/this.value:Fc.rounding(t/this.value)}},{key:"goto",value:function(t){return this.enableFloat?this.value*t:Fc.rounding(this.value*t)}},{key:"setValue",value:function(t){this.value=t}}])&&Sf(e.prototype,n),r&&Sf(e,r),t}(),Ef=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.goto,r=void 0===n?function(t){return t}:n,o=e.back,i=void 0===o?function(t){return t}:o;mf(this,t),this.goto=r,this.back=i};function _f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xf=function(){function t(e){var n=e.scaleAdapter,r=void 0===n?new Ef:n,o=e.len,i=void 0===o?10:o,c=e.data,l=void 0===c?[]:c,s=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scaleAdapter=r,this.len=i,this.data=l,this.min=5,this.height=_.minIf(s,this.min)}var e,n,r;return e=t,(n=[{key:"getOrNew",value:function(t){return this.data[t]=this.data[t]||{},this.data[t]}},{key:"getHeight",value:function(t){var e=this.scaleAdapter,n=this.get(t);return n&&n.height?e.goto(n.height):e.goto(this.height)}},{key:"get",value:function(t){return this.data[t]}},{key:"eachHeight",value:function(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=r,i=t;i<=e;i+=1){var c=this.getHeight(i);n(i,c,o),o+=c}}},{key:"setHeight",value:function(t,e){var n=this.getOrNew(t),r=this.scaleAdapter;n.height=r.back(_.minIf(e,this.min))}},{key:"rectRangeSumHeight",value:function(t){return this.sectionSumHeight(t.sri,t.eri)}},{key:"sectionSumHeight",value:function(t,e){var n=this;return _.rangeSum(t,e+1,(function(t){return n.getHeight(t)}))}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(t){this.data=t}}])&&_f(e.prototype,n),r&&_f(e,r),t}();function Tf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var kf=function(){function t(e){var n=e.scaleAdapter,r=void 0===n?new Ef:n,o=e.len,i=void 0===o?10:o,c=e.data,l=void 0===c?[]:c,s=e.width,a=void 0===s?110:s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scaleAdapter=r,this.len=i,this.data=l,this.min=5,this.width=_.minIf(a,this.min)}var e,n,r;return e=t,(n=[{key:"getOrNew",value:function(t){return this.data[t]=this.data[t]||{},this.data[t]}},{key:"getWidth",value:function(t){var e=this.scaleAdapter,n=this.data[t];return n&&n.width?e.goto(n.width):e.goto(this.width)}},{key:"get",value:function(t){return this.data[t]}},{key:"eachWidth",value:function(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=r,i=t;i<=e;i+=1){var c=this.getWidth(i);n(i,c,o),o+=c}}},{key:"setWidth",value:function(t,e){var n=this.getOrNew(t),r=this.scaleAdapter;n.width=r.back(_.minIf(e,this.min))}},{key:"rectRangeSumWidth",value:function(t){return this.sectionSumWidth(t.sci,t.eci)}},{key:"sectionSumWidth",value:function(t,e){var n=this;return _.rangeSum(t,e+1,(function(t){return n.getWidth(t)}))}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(t){this.data=t}}])&&Tf(e.prototype,n),r&&Tf(e,r),t}();var Cf={H_LEFT:Symbol("水平方向左边滚动条"),H_RIGHT:Symbol("水平方向向右边滚动"),V_TOP:Symbol("垂直方向向上滚动"),V_BOTTOM:Symbol("垂直方向下滚动"),UN:Symbol("未知")},Pf=function t(e){var n=e.fixed;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ri=n.fxTop+1,this.ci=n.fxLeft+1,this.x=0,this.y=0,this.type=Cf.UN};function jf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Af=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.draw=e,this.color="#000000",_.mergeDeep(this,n)}var e,n,r;return e=t,(n=[{key:"horizontalLine",value:function(t,e,n,r){if(e!==r)throw new Error("coordinate errors sy should be equal to ey !!!");var o=this.draw,i=this.color;o.attr({strokeStyle:i,lineWidth:1}),o.line([t,e],[n,r])}},{key:"verticalLine",value:function(t,e,n,r){if(t!==n)throw new Error("coordinate errors sx should be equal to ex !!!");var o=this.draw,i=this.color;o.attr({strokeStyle:i,lineWidth:1}),o.line([t,e],[n,r])}}])&&jf(e.prototype,n),r&&jf(e,r),t}();function Lf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Rf=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"dateFormat",value:function(t,e){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()},r=/(y+)/.exec(t);if(r){var o=r[0],i=e.getFullYear().toString().substr(4-o.length);t=t.replace(o,i)}for(var c in n){var l=new RegExp("(".concat(c,")")).exec(t);if(l){var s=n[c].toString(),a=l[0],u=1===a.length?s:"00".concat(s).substr(s.length);t=t.replace(a,u)}}return t}},{key:"parserToDate",value:function(t,e){if(!t)return null;for(var n=new Date("1970/01/01 00:00:00"),r=[{reg:"y+"},{reg:"M+"},{reg:"d+"},{reg:"h+"},{reg:"m+"},{reg:"s+"},{reg:"S"}],o=n.getFullYear(),i=n.getMonth()+1,c=n.getDate(),l=n.getHours(),s=n.getMinutes(),a=n.getSeconds(),u=n.getMilliseconds(),f=1,h=0;h<e.length;h+=1)for(var p=e[h],y=0;y<r.length;y+=1){var b=r[y];if(b.reg[0]===p){b.index||(b.index=f,f+=1);break}}for(var d=0;d<r.length;d+=1){var g=r[d].reg,v=new RegExp("(".concat(g,")")).exec(e);if(v){var w=v[0],m="([0-9]{1,".concat(w.length,"})");e=e.replace(w,m)}}var S={},O=new RegExp(e).exec(t);if(!O)return null;for(var E=1;E<O.length;E+=1)S[E]=O[E];return r[0].index&&(o=S[r[0].index]),r[1].index&&(i=S[r[1].index]),r[2].index&&(c=S[r[2].index]),r[3].index&&(l=S[r[3].index]),r[4].index&&(s=S[r[4].index]),r[5].index&&(a=S[r[5].index]),r[6].index&&(u=S[r[6].index]),new Date(o,i-1,c,l,s,a,u)}}],(n=null)&&Lf(e.prototype,n),r&&Lf(e,r),t}();function Vf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Nf(t){var e=Rf.parserToDate(t,"yyyy/MM/dd hh:mm:ss");return e||((e=Rf.parserToDate(t,"yyyy/MM/dd"))?e:(e=Rf.parserToDate(t,"hh:mm:ss"))?e:(e=Rf.parserToDate(t,"MM月dd日"))?e:(e=Rf.parserToDate(t,"yyyy年MM月"))?e:(e=Rf.parserToDate(t,"yyyy年MM月dd日"))||null)}var Wf=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"default",value:function(t){return t}},{key:"text",value:function(t){return t}},{key:"number",value:function(t){if(_.isNumber(t)){if(-1!==t.toString().indexOf(".")){var e=t.toString().lastIndexOf(".")+1;return t.toString().substring(0,e+2)}return"".concat(t,".00")}return t}},{key:"percentage",value:function(t){return _.isNumber(t)?"".concat(t,"%"):t}},{key:"fraction",value:function(t){if(_.isFraction(t)){var e=t.split("/")[0],n=t.split("/")[1];return _.parseInt(e)/_.parseInt(n)}return t}},{key:"ENotation",value:function(t){return _.isNumber(t)?_.parseFloat(t).toExponential(2):t}},{key:"rmb",value:function(t){return _.isNumber(t)?"￥".concat(t):t}},{key:"hk",value:function(t){return _.isNumber(t)?"HK".concat(t):t}},{key:"dollar",value:function(t){return _.isNumber(t)?"$".concat(t):t}},{key:"date1",value:function(t){var e=Nf(t);return e?Rf.dateFormat("yyyy/MM/dd",e):t}},{key:"date2",value:function(t){var e=Nf(t);return e?Rf.dateFormat("MM月dd日",e):t}},{key:"date3",value:function(t){var e=Nf(t);return e?Rf.dateFormat("yyyy年MM月",e):t}},{key:"date4",value:function(t){var e=Nf(t);return e?Rf.dateFormat("yyyy年MM月dd日",e):t}},{key:"date5",value:function(t){var e=Nf(t);return e?Rf.dateFormat("yyyy/MM/dd hh:mm:ss",e):t}},{key:"time",value:function(t){var e=Nf(t);return e?Rf.dateFormat("hh:mm:ss",e):t}}])&&Vf(e.prototype,n),r&&Vf(e,r),t}()),Df=function(t,e){return Wf[t](e)};function Hf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Mf=function(){function t(e){var n=e.rect,r=e.draw;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.draw=r,this.rect=n,this.backgroundColor=null}var e,n,r;return e=t,(n=[{key:"drawBackgroundColor",value:function(t){if(t&&(this.backgroundColor=t,t)){var e=this.draw,n=this.rect;e.attr({fillStyle:t}),e.fillRect(n.x,n.y,n.width,n.height)}}}])&&Hf(e.prototype,n),r&&Hf(e,r),t}();function Bf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var If=function(){function t(e){var n=e.merges,r=e.cols,o=e.rows,i=e.data,c=void 0===i?[]:i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.merges=n,this.cols=r,this.rows=o,this.data=c}var e,n,r;return e=t,(n=[{key:"setCellOrNew",value:function(t,e,n){_.isUnDef(this.data[t])&&(this.data[t]=[]),this.data[t][e]=n}},{key:"setCell",value:function(t,e,n){var r=this.data[t];r&&r[e]&&(r[e]=n)}},{key:"getCellOrNew",value:function(t,e){return _.isUnDef(this.data[t])&&(this.data[t]=[]),_.isUnDef(this.data[t][e])&&(this.data[t][e]={text:""}),this.getCell(t,e)}},{key:"getCell",value:function(t,e){var n=this.data[t];if(n&&n[e]){var r=n[e];return r instanceof Ca?n[e]:(_.isString(r)&&(r={text:r}),n[e]=new Ca(r),n[e])}return null}},{key:"getCellBoundOutSize",value:function(t,e){var n=this.cols,r=this.getCell(t,e);if(r){var o=n.getWidth(e),i=r.contentWidth;switch(r.fontAttr.align){case ol.right:case ol.left:return i;case ol.center:return o+(i-o)/2;default:return 0}}return 0}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.data=t,this}}])&&Bf(e.prototype,n),r&&Bf(e,r),t}();function Yf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ff=function(){function t(e){var n=e.scaleAdapter,r=void 0===n?new Ef:n,o=e.height,i=void 0===o?33:o,c=e.width,l=void 0===c?50:c,s=e.background,a=void 0===s?"#f6f7fa":s,u=e.color,f=void 0===u?"#585757":u,h=e.size,p=void 0===h?11:h,y=e.gridColor,b=void 0===y?"#e8e8e8":y;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scaleAdapter=r,this.height=i,this.width=l,this.background=a,this.color=f,this.size=p,this.gridColor=b}var e,n,r;return e=t,(n=[{key:"getGridColor",value:function(){return this.gridColor}},{key:"getColor",value:function(){return this.color}},{key:"getSize",value:function(){var t=this.scaleAdapter,e=this.size;return t.goto(e)}},{key:"getBackground",value:function(){return this.background}},{key:"getHeight",value:function(){var t=this.scaleAdapter,e=this.height;return t.goto(e)}},{key:"getWidth",value:function(){var t=this.scaleAdapter,e=this.width;return t.goto(e)}}])&&Yf(e.prototype,n),r&&Yf(e,r),t}();function Uf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Gf(t,e,n){return e&&zf(t.prototype,e),n&&zf(t,n),t}var Xf=function(){function t(e){var n=e.scaleAdapter;Uf(this,t),this.scaleAdapter=n,this.text=null,this.rect=null,this.attr=null,this.dw=null,this.overflow=null}return Gf(t,[{key:"setDraw",value:function(t){this.dw=t}},{key:"setText",value:function(t){this.text=t}},{key:"setRect",value:function(t){this.rect=t}},{key:"setAttr",value:function(t){this.attr=t}},{key:"setOverFlow",value:function(t){this.overflow=t}},{key:"build",value:function(){var t=this.text,e=this.rect,n=this.attr,r=this.overflow,o=this.dw,i=this.scaleAdapter,c=new hl({dw:o,text:t,rect:e,attr:n,overflow:r}),l=Fc.dpx(i.goto(n.size)),s=Fc.dpx(i.goto(n.padding));return c.setSize(l),c.setPadding(s),c}}]),t}(),Kf=function(){function t(e){var n=e.scaleAdapter,r=void 0===n?new Ef:n;Uf(this,t),this.scaleAdapter=r}return Gf(t,[{key:"getBuilder",value:function(){var t=this.scaleAdapter;return new Xf({scaleAdapter:t})}}]),t}();function qf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $f=function(){function t(e){var n=e.cells,r=e.merges,o=e.rows,i=e.cols,c=e.scale;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cells=n,this.merges=r,this.rows=o,this.cols=i,this.scale=c}var e,n,r;return e=t,(n=[{key:"getCellTextMaxHeight",value:function(t,e){var n=this.cells,r=this.rows,o=n.getCell(t,e).fontAttr.verticalAlign,i=0,c=0;if(o===il.top)for(var l=t,s=r.len;l<=s;l+=1){var a=n.getCell(l,e);if(l===e)i+=r.getHeight(l);else{if(!_.isUnDef(a)&&!_.isBlank(a.text))break;i+=r.getHeight(l)}}if(o===il.center){for(var u=t,f=r.len;u<=f;u+=1){var h=n.getCell(u,e);if(u===e)i+=r.getHeight(u);else{if(!_.isUnDef(h)&&!_.isBlank(h.text))break;i+=r.getHeight(u)}}for(var p=t-1;p>=0;p-=1){var y=n.getCell(t,p);if(!_.isUnDef(y)&&!_.isBlank(y.text))break;var b=r.getHeight(p);i+=b,c-=b}}if(o===il.bottom)for(var d=t;d>=0;d-=1){var g=n.getCell(t,d);if(d===e)i+=r.getHeight(d);else{if(!_.isUnDef(g)&&!_.isBlank(g.text))break;var v=r.getHeight(d);i+=v,c-=v}}return{height:i,offset:c}}},{key:"getCellTextMaxWidth",value:function(t,e){var n=this.cells,r=this.cols,o=this.merges,i=n.getCell(t,e).fontAttr.align,c=0,l=0;if(i===ol.left)for(var s=e,a=r.len;s<=a;s+=1){var u=n.getCell(t,s),f=o.getFirstIncludes(t,s);if(s===e)c+=r.getWidth(s);else{if(!_.isUnDef(u)&&!_.isBlank(u.text)||!_.isUnDef(f))break;c+=r.getWidth(s)}}if(i===ol.center){for(var h=0,p=0,y=e+1,b=r.len;y<=b;y+=1){var d=n.getCell(t,y),g=o.getFirstIncludes(t,y);if(!_.isUnDef(d)&&!_.isBlank(d.text)||!_.isUnDef(g))break;h+=r.getWidth(y)}for(var v=e-1;v>=0;v-=1){var w=n.getCell(t,v),m=o.getFirstIncludes(t,v);if(!_.isUnDef(w)&&!_.isBlank(w.text)||!_.isUnDef(m))break;var S=r.getWidth(v);p+=S,l-=S}c=r.getWidth(e)+p+h}if(i===ol.right)for(var O=e;O>=0;O-=1){var E=n.getCell(t,O),x=o.getFirstIncludes(t,O);if(O===e)c+=r.getWidth(O);else{if(!_.isUnDef(E)&&!_.isBlank(E.text)||!_.isUnDef(x))break;var T=r.getWidth(O);c+=T,l-=T}}return{width:c,offset:l}}},{key:"getCellOverFlow",value:function(t,e,n,r){var o=r.fontAttr,i=o.direction,c=o.textWrap,l=n.x,s=n.y,a=n.width,u=n.height;if(c===cl.OVER_FLOW){if(i===ll.VERTICAL){var f=this.getCellTextMaxHeight(t,e);return new Lc({x:l,y:s+f.offset,width:a,height:f.height})}var h=this.getCellTextMaxWidth(t,e);return new Lc({x:l+h.offset,y:s,width:h.width,height:u})}return null}}])&&qf(e.prototype,n),r&&qf(e,r),t}();function Zf(t){return(Zf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qf(t,e){return!e||"object"!==Zf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function th(t){return(th=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function eh(t,e){return(eh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nh=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Qf(this,th(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&eh(t,e)}(e,t),n=e,(r=[{key:"getCellByViewRange",value:function(t){for(var e=t.rectRange,n=t.callback,r=t.startX,o=void 0===r?0:r,i=t.startY,c=void 0===i?0:i,l=this.rows,s=this.cols,a=this.cells,u=e.sri,f=e.eri,h=e.sci,p=e.eci,y=c,b=u;b<=f;b+=1){for(var d=l.getHeight(b),g=o,v=h;v<=p;v+=1){var w=s.getWidth(v),m=a.getCell(b,v);if(m){var S=new Lc({x:g,y:y,width:w,height:d});if(!1===n(b,v,m,S,this.getCellOverFlow(b,v,S,m)))return}g+=w}y+=d}}},{key:"getMergeCellByViewRange",value:function(t){for(var e=t.rectRange,n=t.callback,r=t.startX,o=void 0===r?0:r,i=t.startY,c=void 0===i?0:i,l=this.rows,s=this.cols,a=this.cells,u=this.merges,f=e.sri,h=e.eri,p=e.sci,y=e.eci,b=[],d=f;d<=h;d+=1)for(var g=function(t){var r=u.getFirstIncludes(d,t);if(_.isUnDef(r)||b.find((function(t){return t===r})))return"continue";var i=Math.min(e.sri,r.sri),f=Math.min(e.sci,r.sci),h=Math.max(e.sri,r.sri),p=Math.max(e.sci,r.sci);h-=1,p-=1;var y=s.sectionSumWidth(f,p),g=l.sectionSumHeight(i,h);y=e.sci>r.sci?-1*y:y,g=e.sri>r.sri?-1*g:g,y+=o,g+=c;var v=l.sectionSumHeight(r.sri,r.eri),w=s.sectionSumWidth(r.sci,r.eci),m=a.getCellOrNew(r.sri,r.sci),S=new Lc({x:y,y:g,width:w,height:v});n(S,m,r),b.push(r)},v=p;v<=y;v+=1)g(v)}},{key:"getCellSkipMergeCellByViewRange",value:function(t){var e=t.rectRange,n=t.callback,r=t.startX,o=void 0===r?0:r,i=t.startY,c=void 0===i?0:i,l=this.merges;this.getCellByViewRange({rectRange:e,callback:function(t,e,r,o,i){null===l.getFirstIncludes(t,e)&&n(t,e,r,o,i)},startX:o,startY:c})}}])&&Jf(n.prototype,r),o&&Jf(n,o),e}($f);function rh(t){return(rh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ih(t,e){return!e||"object"!==rh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ch(t){return(ch=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lh(t,e){return(lh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sh=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ih(this,ch(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lh(t,e)}(e,t),n=e,(r=[{key:"getCellByViewRange",value:function(t){var e=t.reverseRows,n=void 0!==e&&e,r=t.reverseCols,o=void 0!==r&&r,i=t.rectRange,c=t.callback,l=t.startX,s=void 0===l?0:l,a=t.startY,u=void 0===a?0:a,f=this.rows,h=this.cols,p=this.cells,y=this.scale,b=i.sri,d=i.eri,g=i.sci,v=i.eci;if(n&&o)for(var w=u,m=d;b<=m;m-=1){for(var S=f.getHeight(m),O=s,E=v;g<=E;E-=1){var _=h.getWidth(E),x=p.getCell(m,E);if(x){y.useFloat();var T=new Lc({x:O,y:w,width:h.getWidth(E),height:S}),k=this.getCellOverFlow(m,E,T,x);if(y.notFloat(),!1===c(m,E,x,T,k))return}O-=_}w-=S}else if(n)for(var C=u,P=d;b<=P;P-=1){for(var j=f.getHeight(P),A=s,L=g;L<=v;L+=1){var R=h.getWidth(L),V=p.getCell(P,L);if(V){y.useFloat();var N=new Lc({x:A,y:C,width:h.getWidth(L),height:j}),W=this.getCellOverFlow(P,L,N,V);if(y.notFloat(),!1===c(P,L,V,N,W))return}A+=R}C-=j}else if(o)for(var D=u,H=b;H<=d;H+=1){for(var M=f.getHeight(H),B=s,I=v;g<=I;I-=1){var Y=h.getWidth(I),F=p.getCell(H,I);if(F){y.useFloat();var U=new Lc({x:B,y:D,width:h.getWidth(I),height:M}),z=this.getCellOverFlow(H,I,U,F);if(y.notFloat(),!1===c(H,I,F,U,z))return}B-=Y}D+=M}else for(var G=u,X=b;X<=d;X+=1){for(var K=f.getHeight(X),q=s,$=g;$<=v;$+=1){var Z=h.getWidth($),J=p.getCell(X,$);if(J){y.useFloat();var Q=new Lc({x:q,y:G,width:h.getWidth($),height:K}),tt=this.getCellOverFlow(X,$,Q,J);if(y.notFloat(),!1===c(X,$,J,Q,tt))return}q+=Z}G+=K}}},{key:"getMergeCellByViewRange",value:function(t){for(var e=t.rectRange,n=t.callback,r=t.startX,o=void 0===r?0:r,i=t.startY,c=void 0===i?0:i,l=this.rows,s=this.cols,a=this.cells,u=this.merges,f=this.scale,h=e.sri,p=e.eri,y=e.sci,b=e.eci,d=[],g=h;g<=p;g+=1)for(var v=function(t){var r=u.getFirstIncludes(g,t);if(_.isUnDef(r)||d.find((function(t){return t===r})))return"continue";var i=Math.min(e.sri,r.sri),h=Math.min(e.sci,r.sci),p=Math.max(e.sri,r.sri),y=Math.max(e.sci,r.sci);p-=1,y-=1;var b=s.sectionSumWidth(h,y),v=l.sectionSumHeight(i,p);b=e.sci>r.sci?-1*b:b,v=e.sri>r.sri?-1*v:v,b+=o,v+=c;var w=l.sectionSumHeight(r.sri,r.eri);f.useFloat();var m=s.sectionSumWidth(r.sci,r.eci);f.notFloat();var S=a.getCellOrNew(r.sri,r.sci),O=new Lc({x:b,y:v,width:m,height:w});n(O,S,r),d.push(r)},w=y;w<=b;w+=1)v(w)}},{key:"getCellSkipMergeCellByViewRange",value:function(t){var e=t.reverseRows,n=void 0!==e&&e,r=t.reverseCols,o=void 0!==r&&r,i=t.rectRange,c=t.callback,l=t.startX,s=void 0===l?0:l,a=t.startY,u=void 0===a?0:a,f=this.merges;this.getCellByViewRange({reverseRows:n,reverseCols:o,rectRange:i,callback:function(t,e,n,r,o){null===f.getFirstIncludes(t,e)&&c(t,e,n,r,o)},startX:s,startY:u})}}])&&oh(n.prototype,r),o&&oh(n,o),e}($f);function ah(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var uh=function(){function t(e){var n=e.merges,r=void 0===n?[]:n,o=e.cols,i=e.rows;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rows=i,this.cols=o,this.data=r.map((function(t){return ta.valueOf(t)})),this.index=new Array(i.len*o.len)}var e,n,r;return e=t,(n=[{key:"getIncludes",value:function(t,e){var n=this,r=this.index,o=this.data;t.each((function(t,i){var c=n.getOffset(t,i),l=r[c];_.isNotUnDef(l)&&e(o[l])}))}},{key:"getOffset",value:function(t,e){return t*this.cols.len+e}},{key:"getFirstIncludes",value:function(t,e){var n=this.index,r=this.data,o=n[this.getOffset(t,e)];if(_.isUnDef(o))return null;var i=r[o];return _.isUnDef(i)?null:i}},{key:"add",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.index,o=this.data;n&&this.getIncludes(t,(function(t){return e.delete(t)}));var i=o.length;o.push(t),t.each((function(t,n){var o=e.getOffset(t,n);r[o]=i}))}},{key:"delete",value:function(t){var e=this,n=this.index,r=this.data,o=t.sri,i=t.sci,c=this.getOffset(o,i),l=n[c];_.isUnDef(l)||(r.splice(l,1),t.each((function(t,r){var o=e.getOffset(t,r);n[o]=void 0})),this.sync(l))}},{key:"union",value:function(t){for(var e=this,n=t,r=[],o=function(t){var o=e.data[t];if(r.find((function(t){return t===o})))return i=t,"continue";o.intersects(n)&&(r.push(o),n=o.union(n),t=-1),i=t},i=0;i<this.data.length;i+=1)o(i);return n}},{key:"sync",value:function(){for(var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.index,r=this.data,o=function(e){r[e].each((function(r,o){var i=t.getOffset(r,o);n[i]=e}))},i=e;i<r.length;i+=1)o(i)}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(t){this.data=t}}])&&ah(e.prototype,n),r&&ah(e,r),t}();function fh(t){return(fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hh(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ph(t,e){return!e||"object"!==fh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function yh(t,e,n){return(yh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=bh(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function bh(t){return(bh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dh(t,e){return(dh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wh(t,e,n){return e&&vh(t.prototype,e),n&&vh(t,n),t}var mh={CHANGE_ADD:Symbol("change_add"),CHANGE_NOT:Symbol("change_not"),STATIC:Symbol("static"),BOUND_OUT:Symbol("bound_out")},Sh=function(){function t(e){var n=e.scroll,r=e.rows,o=e.cols,i=e.getHeight,c=void 0===i?function(){return 0}:i,l=e.getWidth,s=void 0===l?function(){return 0}:l;gh(this,t),this.scroll=n,this.rows=r,this.cols=o,this.getHeight=c,this.getWidth=s}return wh(t,null,[{key:"viewMode",value:function(t,e){return _.isUnDef(t)?mh.CHANGE_NOT:e.equals(t)?mh.STATIC:e.coincide(t).equals(ta.EMPTY)?mh.BOUND_OUT:e.within(t)?mh.CHANGE_NOT:mh.CHANGE_ADD}}]),wh(t,[{key:"getScrollView",value:function(){for(var t=this.rows,e=this.cols,n=this.scroll,r=this.getHeight,o=this.getWidth,i=n.ri,c=n.ci,l=0,s=0,a=[t.len,e.len],u=a[0],f=a[1],h=i;h<t.len&&(u=h,!((s+=t.getHeight(h))>=r()));h+=1);for(var p=c;p<e.len&&(f=p,!((l+=e.getWidth(p))>=o()));p+=1);return new ta(i,c,u,f)}}]),t}(),Oh=function(){function t(e){var n=e.xTableScrollView,r=e.rows,o=e.cols,i=e.scroll;gh(this,t),this.xTableScrollView=n,this.scroll=i,this.rows=r,this.cols=o,this.scrollView=null}return wh(t,[{key:"reset",value:function(){this.scrollView=null}},{key:"getScrollView",value:function(){if(_.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.xTableScrollView,e=this.cols,n=this.rows,r=t.getScrollView();return r.w=e.rectRangeSumWidth(r),r.h=n.rectRangeSumHeight(r),this.scrollView=r,r.clone()}}]),t}(),Eh=function(t){function e(t){var n,r=t.xTableScrollView,o=t.rows,i=t.cols,c=t.scroll;return gh(this,e),(n=ph(this,bh(e).call(this,{xTableScrollView:r,rows:o,cols:i,scroll:c}))).lastScrollView=null,n.enterView=null,n.scrollEnterView=null,n.leaveView=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dh(t,e)}(e,t),wh(e,[{key:"reset",value:function(){yh(bh(e.prototype),"reset",this).call(this),this.scrollEnterView=null,this.enterView=null,this.leaveView=null}},{key:"getLastScrollView",value:function(){return _.isNotUnDef(this.lastScrollView)?this.lastScrollView.clone():null}},{key:"getLeaveView",value:function(){if(_.isNotUnDef(this.leaveView))return this.leaveView.clone();var t=this.getLastScrollView(),e=this.getScrollView(),n=this.cols,r=this.rows;if(t){var o=hh(t.coincideDifference(e),1)[0];if(o)return o.w=n.rectRangeSumWidth(o),o.h=r.rectRangeSumHeight(o),this.leaveView=o,o.clone()}return null}},{key:"getEnterView",value:function(){if(_.isNotUnDef(this.enterView))return this.enterView.clone();var t=this.getLastScrollView(),e=this.getScrollView(),n=this.cols,r=this.rows;if(t){var o=hh(e.coincideDifference(t),1)[0];if(o)return o.w=n.rectRangeSumWidth(o),o.h=r.rectRangeSumHeight(o),this.enterView=o,o.clone()}return null}},{key:"getScrollEnterView",value:function(){if(_.isNotUnDef(this.scrollEnterView))return this.scrollEnterView.clone();var t=this.cols,e=this.rows,n=this.scroll,r=this.getEnterView();if(r){switch(n.type){case Cf.H_RIGHT:r.sci-=1;break;case Cf.V_BOTTOM:r.sri-=1;break;case Cf.H_LEFT:r.eci+=1;break;case Cf.V_TOP:r.eri+=1}return r.w=t.rectRangeSumWidth(r),r.h=e.rectRangeSumHeight(r),this.scrollEnterView=r,r.clone()}return null}},{key:"undo",value:function(){this.lastScrollView=null}},{key:"record",value:function(){this.lastScrollView=this.scrollView}}]),e}(Oh);function _h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xh=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.change=!1}var e,n,r;return e=t,(n=[{key:"endNotice",value:function(){this.change&&(this.change=!1)}},{key:"backNotice",value:function(){this.change&&(this.change=!1)}},{key:"goNotice",value:function(){this.change&&(this.change=!1)}}])&&_h(e.prototype,n),r&&_h(e,r),t}();function Th(t){return(Th="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ch(t,e){return!e||"object"!==Th(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ph(t,e,n){return(Ph="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=jh(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function jh(t){return(jh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ah(t,e){return(Ah=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Lh=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{setCell:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ch(this,jh(e).call(this))).table=t,n.option=r,n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ah(t,e)}(e,t),n=e,(o=[{key:"$setCell",value:function(t,e,n){this.change=!0,this.table.cells.setCellOrNew(t,e,n)}},{key:"setCell",value:function(t,e,n){var r=this.option,o=this.table,i=r.on.setCell,c=o.cells.getCell(t,e);this.$setCell(t,e,n),i(t,e,c,n)}},{key:"endNotice",value:function(){var t=this.table;this.change&&t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),Ph(jh(e.prototype),"endNotice",this).call(this)}},{key:"goNotice",value:function(){var t=this.table;this.change&&t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),Ph(jh(e.prototype),"goNotice",this).call(this)}},{key:"backNotice",value:function(){var t=this.table;this.change&&t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),Ph(jh(e.prototype),"backNotice",this).call(this)}}])&&kh(n.prototype,o),i&&kh(n,i),e}(xh);var Rh=function t(e){var n=e.ri,r=e.ci,o=e.oldCell,i=e.newCell;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ri=n,this.ci=r,this.oldCell=o,this.newCell=i};var Vh={ADD:Symbol("添加一个合并单元格"),DELETE:Symbol("删除一个合并单元格")},Nh=function t(e){var n=e.merge,r=e.recordType;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.merge=n,this.recordType=r};function Wh(t){return(Wh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Hh(t,e){return!e||"object"!==Wh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mh(t,e,n){return(Mh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Bh(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Bh(t){return(Bh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ih(t,e){return(Ih=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yh=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{addMerge:function(){},deleteMerge:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Hh(this,Bh(e).call(this))).table=t,n.option=r,n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ih(t,e)}(e,t),n=e,(o=[{key:"$addMerge",value:function(t){var e=this;this.change=!0;var n=this.table.merges;n.getIncludes(t,(function(t){return e.deleteMerge(t)})),n.add(t,!1)}},{key:"$deleteMerge",value:function(t){this.change=!0,this.table.merges.delete(t)}},{key:"deleteMerge",value:function(t){var e=this.option.on.deleteMerge;this.$deleteMerge(t),e(t)}},{key:"addMerge",value:function(t){var e=this.option.on.addMerge;this.$addMerge(t),e(t)}},{key:"endNotice",value:function(){var t=this.table;this.change&&t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),Mh(Bh(e.prototype),"endNotice",this).call(this)}},{key:"goNotice",value:function(){var t=this.table;this.change&&t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),Mh(Bh(e.prototype),"goNotice",this).call(this)}},{key:"backNotice",value:function(){var t=this.table;this.change&&t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),Mh(Bh(e.prototype),"backNotice",this).call(this)}}])&&Dh(n.prototype,o),i&&Dh(n,i),e}(xh);function Fh(t){return(Fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zh(t,e){return!e||"object"!==Fh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gh(t,e,n){return(Gh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xh(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Xh(t){return(Xh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kh(t,e){return(Kh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qh=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{setWidth:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=zh(this,Xh(e).call(this))).table=t,n.option=r,n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kh(t,e)}(e,t),n=e,(o=[{key:"$setWidth",value:function(t,e){this.change=!0,this.table.cols.setWidth(t,e)}},{key:"setWidth",value:function(t,e){var n=this.option,r=this.table,o=n.on.setWidth,i=r.cols.getWidth(t);this.$setWidth(t,e),o(t,i,e)}},{key:"endNotice",value:function(){var t=this.table;this.change&&(t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(r.TABLE_EVENT_TYPE.CHANGE_WIDTH)),Gh(Xh(e.prototype),"endNotice",this).call(this)}},{key:"backNotice",value:function(){var t=this.table;this.change&&(t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(r.TABLE_EVENT_TYPE.CHANGE_WIDTH)),Gh(Xh(e.prototype),"backNotice",this).call(this)}},{key:"goNotice",value:function(){var t=this.table;this.change&&(t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(r.TABLE_EVENT_TYPE.CHANGE_WIDTH)),Gh(Xh(e.prototype),"goNotice",this).call(this)}}])&&Uh(n.prototype,o),i&&Uh(n,i),e}(xh);var $h=function t(e){var n=e.ci,r=e.oldWidth,o=e.newWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ci=n,this.oldWidth=r,this.newWidth=o};function Zh(t){return(Zh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qh(t,e){return!e||"object"!==Zh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tp(t,e,n){return(tp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ep(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ep(t){return(ep=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function np(t,e){return(np=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rp=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{setHeight:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Qh(this,ep(e).call(this))).table=t,n.option=r,n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&np(t,e)}(e,t),n=e,(o=[{key:"$setHeight",value:function(t,e){this.change=!0,this.table.rows.setHeight(t,e)}},{key:"setHeight",value:function(t,e){var n=this.option,r=this.table,o=n.on.setHeight,i=r.rows.getHeight(t);this.$setHeight(t,e),o(t,i,e)}},{key:"endNotice",value:function(){var t=this.table;this.change&&(t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(r.TABLE_EVENT_TYPE.CHANGE_HEIGHT)),tp(ep(e.prototype),"endNotice",this).call(this)}},{key:"backNotice",value:function(){var t=this.table;this.change&&(t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(r.TABLE_EVENT_TYPE.CHANGE_HEIGHT)),tp(ep(e.prototype),"backNotice",this).call(this)}},{key:"goNotice",value:function(){var t=this.table;this.change&&(t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(r.TABLE_EVENT_TYPE.CHANGE_HEIGHT)),tp(ep(e.prototype),"goNotice",this).call(this)}}])&&Jh(n.prototype,o),i&&Jh(n,i),e}(xh);var op=function t(e){var n=e.ri,r=e.oldHeight,o=e.newHeight;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ri=n,this.oldHeight=r,this.newHeight=o};function ip(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var cp=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.record=!1,this.backLayerStack=[],this.goLayerStack=[],this.recordLayer=[],this.table=e,this.mergeDataProxy=new Yh(e,{on:{deleteMerge:function(t){!1!==n.record&&n.recordLayer.push(new Nh({merge:t,recordType:Vh.DELETE}))},addMerge:function(t){!1!==n.record&&n.recordLayer.push(new Nh({merge:t,recordType:Vh.ADD}))}}}),this.cellDataProxy=new Lh(e,{on:{setCell:function(t,e,r,o){!1!==n.record&&n.recordLayer.push(new Rh({ri:t,ci:e,oldCell:r,newCell:o}))}}}),this.colsDataProxy=new qh(e,{on:{setWidth:function(t,e,r){!1!==n.record&&n.recordLayer.push(new $h({ci:t,oldWidth:e,newWidth:r}))}}}),this.rowsDataProxy=new rp(e,{on:{setHeight:function(t,e,r){!1!==n.record&&n.recordLayer.push(new op({ri:t,oldHeight:e,newHeight:r}))}}})}var e,n,r;return e=t,(n=[{key:"back",value:function(){for(var t=this.backLayerStack,e=this.goLayerStack,n=this.table,r=t.pop(),o=r.length-1;o>=0;o-=1){var i=r[o];if(i instanceof Rh){var c=i.ri,l=i.ci,s=i.oldCell;this.cellDataProxy.$setCell(c,l,s)}else if(i instanceof Nh)switch(i.recordType){case Vh.DELETE:var a=i.merge;this.mergeDataProxy.$addMerge(a);break;case Vh.ADD:var u=i.merge;this.mergeDataProxy.$deleteMerge(u)}else if(i instanceof $h){var f=i.ci,h=i.oldWidth;this.colsDataProxy.$setWidth(f,h)}else if(i instanceof op){var p=i.ri,y=i.oldHeight;this.rowsDataProxy.$setHeight(p,y)}}e.push(r),this.mergeDataProxy.backNotice(),this.cellDataProxy.backNotice(),this.colsDataProxy.backNotice(),this.rowsDataProxy.backNotice(),n.render()}},{key:"go",value:function(){for(var t=this.backLayerStack,e=this.goLayerStack,n=this.table,r=e.pop(),o=0,i=r.length;o<i;o+=1){var c=r[o];if(c instanceof Rh){var l=c.ri,s=c.ci,a=c.newCell;this.cellDataProxy.$setCell(l,s,a)}else if(c instanceof Nh)switch(c.recordType){case Vh.DELETE:var u=c.merge;this.mergeDataProxy.$deleteMerge(u);break;case Vh.ADD:var f=c.merge;this.mergeDataProxy.$addMerge(f)}else if(c instanceof $h){var h=c.ci,p=c.newWidth;this.colsDataProxy.$setWidth(h,p)}else if(c instanceof op){var y=c.ri,b=c.newHeight;this.rowsDataProxy.$setHeight(y,b)}}t.push(r),this.mergeDataProxy.goNotice(),this.cellDataProxy.goNotice(),this.colsDataProxy.goNotice(),this.rowsDataProxy.goNotice(),n.render()}},{key:"end",value:function(){var t=this.recordLayer,e=this.backLayerStack;this.record=!1,t.length&&e.push(t),this.recordLayer=[],this.mergeDataProxy.endNotice(),this.cellDataProxy.endNotice(),this.colsDataProxy.endNotice(),this.rowsDataProxy.endNotice()}},{key:"begin",value:function(){this.record=!0,this.goLayerStack=[]}},{key:"canBack",value:function(){return 0!==this.backLayerStack.length}},{key:"canGo",value:function(){return 0!==this.goLayerStack.length}}])&&ip(e.prototype,n),r&&ip(e,r),t}();function lp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var sp=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.callback=e}var e,n,r;return e=t,(n=[{key:"execute",value:function(){return this.callback.apply(this,arguments)}}])&&lp(e.prototype,n),r&&lp(e,r),t}();function ap(t){return(ap="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function up(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fp(t,e){return!e||"object"!==ap(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hp(t){return(hp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pp(t,e){return(pp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yp=function(t){function e(t){var n,r=t.cells,o=t.cols,i=t.merges;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=fp(this,hp(e).call(this,(function(t,e){return!!i.getFirstIncludes(e,t-1)||n.master(e,t)&&n.right(e,t)&&n.left(e,t)})))).cells=r,n.cols=o,n.merges=i,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pp(t,e)}(e,t),n=e,(r=[{key:"master",value:function(t,e){var n=this.cells,r=this.cols,o=n.getCell(t,e-1),i=n.getCell(t,e);if(_.isUnDef(i)||_.isBlank(i.text))return!0;var c=i.fontAttr,l=!0;if(c.direction===ll.ANGLE){var s=c.angle;90!==s&&-90!==s||(l=!1),c.textWrap===cl.TRUNCATE&&(l=!1)}else c.textWrap!==cl.OVER_FLOW&&(l=!1);var a=c.align,u=r.getWidth(e);return a!==ol.right&&a!==ol.center&&(l=!1),!l||!(n.getCellBoundOutSize(t,e)>u&&(_.isUnDef(o)||_.isBlank(o.text)))}},{key:"right",value:function(t,e){for(var n=this.cells,r=this.cols,o=r.len,i=n.getCell(t,e-1),c=n.getCell(t,e),l=r.getWidth(e+1)+r.getWidth(e),s=e+1;s<=o;s+=1,l+=r.getWidth(s)){var a=n.getCell(t,s);if(!_.isUnDef(a)){var u=a.text;if(!_.isBlank(u)){var f=a.fontAttr;if(f.direction===ll.ANGLE){var h=f.angle,p=f.textWrap;if(90===h||-90===h)break;if(p===cl.TRUNCATE)break}else{if(f.textWrap!==cl.OVER_FLOW)break;var y=f.align;if(y!==ol.right&&y!==ol.center)break}if(n.getCellBoundOutSize(t,s)>l){var b=_.isUnDef(c)||_.isBlank(c.text),d=_.isUnDef(i)||_.isBlank(i.text);if(b&&d)return!1}break}}}return!0}},{key:"left",value:function(t,e){for(var n=this.cells,r=this.cols,o=n.getCell(t,e),i=r.getWidth(e-1),c=e-1;c>=0;c-=1,i+=r.getWidth(c)){var l=n.getCell(t,c);if(null!==l){var s=l.text;if(!_.isBlank(s)){var a=l.fontAttr;if(a.direction===ll.ANGLE){var u=a.angle,f=a.textWrap;if(90===u||-90===u)break;if(f===cl.TRUNCATE)break}else{if(a.textWrap!==cl.OVER_FLOW)break;var h=a.align;if(h!==ol.left&&h!==ol.center)break}if(n.getCellBoundOutSize(t,c)>i&&(_.isUnDef(o)||_.isBlank(o.text)))return!1;break}}}return!0}}])&&up(n.prototype,r),o&&up(n,o),e}(sp);function bp(t){return(bp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gp(t,e){return!e||"object"!==bp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vp(t){return(vp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wp(t,e){return(wp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mp=function(t){function e(t){var n,r=t.cells,o=t.cols,i=t.merges;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=gp(this,vp(e).call(this,(function(t,e){return!!i.getFirstIncludes(e,t+1)||n.master(e,t)&&n.right(e,t)&&n.left(e,t)})))).cells=r,n.cols=o,n.merges=i,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wp(t,e)}(e,t),n=e,(r=[{key:"master",value:function(t,e){var n=this.cells,r=this.cols,o=n.getCell(t,e+1),i=n.getCell(t,e);if(_.isUnDef(i)||_.isBlank(i.text))return!0;var c=i.fontAttr,l=!0;if(c.direction===ll.ANGLE){var s=c.angle;90!==s&&-90!==s||(l=!1),c.textWrap===cl.TRUNCATE&&(l=!1)}else c.textWrap!==cl.OVER_FLOW&&(l=!1);var a=c.align,u=r.getWidth(e);return a!==ol.left&&a!==ol.center&&(l=!1),!l||!(n.getCellBoundOutSize(t,e)>u&&(_.isUnDef(o)||_.isBlank(o.text)))}},{key:"right",value:function(t,e){for(var n=this.cells,r=this.cols,o=r.len,i=n.getCell(t,e),c=r.getWidth(e+1),l=e+1;l<=o;l+=1,c+=r.getWidth(l)){var s=n.getCell(t,l);if(null!==s){var a=s.text;if(!_.isBlank(a)){var u=s.fontAttr;if(u.direction===ll.ANGLE){var f=u.angle,h=u.textWrap;if(90===f||-90===f)break;if(h===cl.TRUNCATE)break}else{if(u.textWrap!==cl.OVER_FLOW)break;var p=u.align;if(p!==ol.right&&p!==ol.center)break}if(n.getCellBoundOutSize(t,l)>c&&(null===i||_.isBlank(i.text)))return!1;break}}}return!0}},{key:"left",value:function(t,e){for(var n=this.cells,r=this.cols,o=n.getCell(t,e+1),i=n.getCell(t,e),c=r.getWidth(e-1)+r.getWidth(e),l=e-1;l>=0;l-=1,c+=r.getWidth(l)){var s=n.getCell(t,l);if(!_.isUnDef(s)){var a=s.text;if(!_.isBlank(a)){var u=s.fontAttr;if(u.direction===ll.ANGLE){var f=u.angle,h=u.textWrap;if(90===f||-90===f)break;if(h===cl.TRUNCATE)break}else{var p=u.textWrap,y=u.align;if(p!==cl.OVER_FLOW)break;if(y!==ol.left&&y!==ol.center)break}if(n.getCellBoundOutSize(t,l)>c){var b=_.isUnDef(i)||_.isBlank(i.text),d=_.isUnDef(o)||_.isBlank(o.text);if(b&&d)return!1}break}}}return!0}}])&&dp(n.prototype,r),o&&dp(n,o),e}(sp);function Sp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Op=function(){function t(e){var n=e.merges,r=e.rows,o=e.cols,i=e.cells;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.merges=n,this.cells=i,this.rows=r,this.cols=o,this.rightOutRangeFilter=new mp({cells:i,cols:o,merges:n}),this.leftOutRangeFilter=new yp({cells:i,cols:o,merges:n})}var e,n,r;return e=t,(n=[{key:"getMergeCoincideRange",value:function(t){var e=t.viewRange,n=void 0===e?new ta(0,0,0,0):e,r=this.merges,o=this.cols,i=this.rows,c=[],l=[];return this.horizontalIterate({viewRange:n,filter:new sp((function(t,e){var n=r.getFirstIncludes(t,e);return _.isNotUnDef(n)&&-1===c.indexOf(n)})),handle:function(t,e,s,a){var u=r.getFirstIncludes(t,e);c.push(u);var f=n.coincide(u),h=o.sectionSumWidth(f.sci,f.eci),p=i.sectionSumHeight(f.sri,f.eri),y=new Lc({x:s,y:a,width:h,height:p});l.push({rect:y,view:f,merge:u})}}),l}},{key:"getCoincideRangeBrink",value:function(t){for(var e=t.coincide,n=void 0===e?new ta(0,0,0,0):e,r=this.cols,o=this.rows,i=[],c=0;c<n.length;c+=1){var l=n[c],s=l.view,a=l.rect,u=l.merge,f=s.brink(),h={view:f.top,x:a.x,y:a.y},p={view:f.left,x:a.x,y:a.y},y={view:f.bottom,x:a.x,y:a.y+a.height-o.rectRangeSumHeight(f.bottom)},b={view:f.right,x:a.x+a.width-r.rectRangeSumWidth(f.right),y:a.y},d={};u.sri===s.sri&&(d.top=h),u.sci===s.sci&&(d.left=p),u.eri===s.eri&&(d.bottom=y),u.eci===s.eci&&(d.right=b),i.push(d)}return i}},{key:"horizontalIterate",value:function(t){for(var e=t.viewRange,n=void 0===e?new ta(0,0,0,0):e,r=t.newRow,o=void 0===r?function(){return!0}:r,i=t.filter,c=void 0===i?new sp((function(){return!0})):i,l=t.jump,s=void 0===l?function(){return!0}:l,a=t.handle,u=void 0===a?function(){return!0}:a,f=t.endRow,h=void 0===f?function(){return!0}:f,p=t.bx,y=void 0===p?0:p,b=t.by,d=void 0===b?0:b,g=this.cols,v=this.rows,w=n.sri,m=n.eri,S=n.sci,O=n.eci,E=d,_=w;_<=m;_+=1){var x=v.getHeight(_),T=y;o(_,E);for(var k=S;k<=O;k+=1){var C=g.getWidth(k);c.execute(_,k,T,E)?u(_,k,T,E):s(_,k,T,E),T+=C}h(),E+=x}}},{key:"verticalIterate",value:function(t){for(var e=t.viewRange,n=void 0===e?new ta(0,0,0,0):e,r=t.newCol,o=void 0===r?function(){return!0}:r,i=t.filter,c=void 0===i?new sp((function(){return!0})):i,l=t.jump,s=void 0===l?function(){return!0}:l,a=t.handle,u=void 0===a?function(){return!0}:a,f=t.endCol,h=void 0===f?function(){return!0}:f,p=t.bx,y=void 0===p?0:p,b=t.by,d=void 0===b?0:b,g=this.cols,v=this.rows,w=n.sri,m=n.eri,S=n.sci,O=n.eci,E=y,_=S;_<=O;_+=1){var x=g.getWidth(_),T=d;o(_,E);for(var k=w;k<=m;k+=1){var C=v.getHeight(k);c.execute(_,k,E,T)?u(_,k,E,T):s(_,k,E,T),T+=C}h(),E+=x}}}])&&Sp(e.prototype,n),r&&Sp(e,r),t}();function Ep(t){return(Ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _p(t,e){return!e||"object"!==Ep(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xp(t){return(xp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tp(t,e){return(Tp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kp=function(t){function e(t){var n=t.merges;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),_p(this,xp(e).call(this,(function(t,e){return null===n.getFirstIncludes(t,e)})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tp(t,e)}(e,t),e}(sp);function Cp(t){return(Cp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pp(t,e){return!e||"object"!==Cp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jp(t){return(jp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ap(t,e){return(Ap=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Lp=function(t){function e(t){var n=t.merges;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Pp(this,jp(e).call(this,(function(t,e){return null===n.getFirstIncludes(e,t)})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ap(t,e)}(e,t),e}(sp);function Rp(t){return(Rp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vp(t,e){return!e||"object"!==Rp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Np(t){return(Np=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wp(t,e){return(Wp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Dp=function(t){function e(t){var n=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Vp(this,Np(e).call(this,(function(t,e){var r=n.getCell(t+1,e),o=n.getCell(t,e),i=!1;return o&&!i&&(i=o.borderAttr.bottom.display),r&&!i&&(i=r.borderAttr.top.display),!i})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wp(t,e)}(e,t),e}(sp);function Hp(t){return(Hp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mp(t,e){return!e||"object"!==Hp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bp(t){return(Bp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ip(t,e){return(Ip=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yp=function(t){function e(t){var n=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Mp(this,Bp(e).call(this,(function(t,e){var r=n.getCell(e,t+1),o=n.getCell(e,t),i=!1;return o&&!i&&(i=o.borderAttr.right.display),r&&!i&&(i=r.borderAttr.left.display),!i})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ip(t,e)}(e,t),e}(sp);function Fp(t){return(Fp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Up(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zp(t,e){return!e||"object"!==Fp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gp(t){return(Gp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xp(t,e){return(Xp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Kp=function(t){function e(t){var n,r=t.merges,o=t.rows,i=t.cols,c=t.cells,l=t.drawCheck,s=void 0!==l&&l,a=t.getHeight,u=void 0===a?function(t){return o.getHeight(t)}:a,f=t.getWidth,h=void 0===f?function(t){return i.getWidth(t)}:f;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=zp(this,Gp(e).call(this,{merges:r,rows:o,cols:i,cells:c}))).drawCheck=s,n.getHeight=u,n.getWidth=h,n.horizontalBorderDisplayFilter=new Dp({cells:c}),n.verticalBorderDisplayFilter=new Yp({cells:c}),n.horizontalMergeFilter=new kp({merges:r}),n.verticalMergeFilter=new Lp({merges:r}),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xp(t,e)}(e,t),n=e,(r=[{key:"computerHorizontalLine",value:function(t){var e,n,r,o,i,c=t.viewRange,l=t.bx,s=void 0===l?0:l,a=t.by,u=void 0===a?0:a,f=t.filter,h=this.getWidth,p=this.getHeight,y=[];return this.horizontalIterate({viewRange:c,newRow:function(t,c){var l=p(t);r=e=s,o=n=u+c+l,i=!1},filter:f,jump:function(t,c){i&&(i=!1,y.push({sx:e,sy:n,ex:r,ey:o}));var l=h(c);r=e=r+l},handle:function(t,e){i=!0;var n=h(e);r+=n},endRow:function(){i&&y.push({sx:e,sy:n,ex:r,ey:o})}}),y}},{key:"computerVerticalLine",value:function(t){var e,n,r,o,i,c=t.viewRange,l=t.bx,s=void 0===l?0:l,a=t.by,u=void 0===a?0:a,f=t.filter,h=this.getWidth,p=this.getHeight,y=[];return this.verticalIterate({viewRange:c,newCol:function(t,c){var l=h(t);r=e=s+c+l,o=n=u,i=!1},filter:f,jump:function(t,c){i&&(i=!1,y.push({sx:e,sy:n,ex:r,ey:o}));var l=p(c);o=n=o+l},handle:function(t,e){i=!0;var n=p(e);o+=n},endCol:function(){i&&y.push({sx:e,sy:n,ex:r,ey:o})}}),y}}])&&Up(n.prototype,r),o&&Up(n,o),e}(Op);function qp(t){return(qp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $p(t,e){return!e||"object"!==qp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zp(t){return(Zp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jp(t,e){return(Jp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qp={AND:Symbol("and"),OR:Symbol("or")},ty=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),$p(this,Zp(e).call(this,(function(){var e;if(t===Qp.AND){e=!0;var r=!0,o=!1,i=void 0;try{for(var c,l=n[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var s=c.value;if(!1===s.execute.apply(s,arguments)){e=!1;break}}}catch(t){o=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}}else{e=!1;var a=!0,u=!1,f=void 0;try{for(var h,p=n[Symbol.iterator]();!(a=(h=p.next()).done);a=!0){var y=h.value;if(!0===y.execute.apply(y,arguments)){e=!0;break}}}catch(t){u=!0,f=t}finally{try{a||null==p.return||p.return()}finally{if(u)throw f}}}return e})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jp(t,e)}(e,t),e}(sp);function ey(t){return(ey="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ny(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ry(t,e){return!e||"object"!==ey(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function oy(t){return(oy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function iy(t,e){return(iy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var cy=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ry(this,oy(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&iy(t,e)}(e,t),n=e,(r=[{key:"getHorizontalLine",value:function(t){var e=t.viewRange,n=this.horizontalMergeFilter,r=this.horizontalBorderDisplayFilter;return this.drawCheck?this.computerHorizontalLine({viewRange:e,filter:new ty(Qp.AND,[n,r])}):this.computerHorizontalLine({viewRange:e})}},{key:"getMergeHorizontalLine",value:function(t){var e=t.brink,n=[],r=this.horizontalBorderDisplayFilter;if(this.drawCheck)for(var o=0;o<e.length;o+=1){var i=e[o].bottom;if(i){var c=i.view,l=i.x,s=i.y,a=this.computerHorizontalLine({viewRange:c,bx:l,by:s,filter:r});n=n.concat(a)}}else for(var u=0;u<e.length;u+=1){var f=e[u].bottom;if(f){var h=f.view,p=f.x,y=f.y,b=this.computerHorizontalLine({viewRange:h,bx:p,by:y});n=n.concat(b)}}return n}}])&&ny(n.prototype,r),o&&ny(n,o),e}(Kp);function ly(t){return(ly="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ay(t,e){return!e||"object"!==ly(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function uy(t){return(uy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fy(t,e){return(fy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hy=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ay(this,uy(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fy(t,e)}(e,t),n=e,(r=[{key:"getVerticalLine",value:function(t){var e=t.viewRange,n=this.verticalMergeFilter,r=this.verticalBorderDisplayFilter,o=this.rightOutRangeFilter;return this.drawCheck?this.computerVerticalLine({viewRange:e,filter:new ty(Qp.AND,[n,r,o])}):this.computerVerticalLine({viewRange:e})}},{key:"getMergeVerticalLine",value:function(t){var e=t.brink,n=[],r=this.verticalBorderDisplayFilter;if(this.drawCheck)for(var o=0;o<e.length;o+=1){var i=e[o].right;if(i){var c=i.view,l=i.x,s=i.y,a=this.computerVerticalLine({viewRange:c,bx:l,by:s,filter:r});n=n.concat(a)}}else for(var u=0;u<e.length;u+=1){var f=e[u].right;if(f){var h=f.view,p=f.x,y=f.y,b=this.computerVerticalLine({viewRange:h,bx:p,by:y});n=n.concat(b)}}return n}}])&&sy(n.prototype,r),o&&sy(n,o),e}(Kp);function py(t){return(py="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yy(t,e){return!e||"object"!==py(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function by(t){return(by=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dy(t,e){return(dy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gy=function(t){function e(t){var n=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),yy(this,by(e).call(this,(function(t,e){var r=n.getCell(t+1,e),o=n.getCell(t,e);if(_.isUnDef(o))return!1;var i=o.borderAttr.bottom;if(_.isUnDef(r))return i.display;var c=r.borderAttr.top;if(!c.display)return i.display;var l=i.priority(c);return 1===l||0===l})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dy(t,e)}(e,t),e}(sp);function vy(t){return(vy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wy(t,e){return!e||"object"!==vy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function my(t){return(my=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sy(t,e){return(Sy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Oy=function(t){function e(t){var n=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),wy(this,my(e).call(this,(function(t,e){var r=n.getCell(e,t-1),o=n.getCell(e,t);if(_.isUnDef(o))return!1;var i=o.borderAttr.left;if(_.isUnDef(r))return i.display;var c=r.borderAttr.right;return c.display?1===i.priority(c):i.display})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sy(t,e)}(e,t),e}(sp);function Ey(t){return(Ey="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _y(t,e){return!e||"object"!==Ey(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xy(t){return(xy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ty(t,e){return(Ty=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ky=function(t){function e(t){var n=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),_y(this,xy(e).call(this,(function(t,e){var r=n.getCell(e,t+1),o=n.getCell(e,t);if(_.isUnDef(o))return!1;var i=o.borderAttr.right;if(_.isUnDef(r))return i.display;var c=r.borderAttr.left;if(!c.display)return i.display;var l=i.priority(c);return 1===l||0===l})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ty(t,e)}(e,t),e}(sp);function Cy(t){return(Cy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Py(t,e){return!e||"object"!==Cy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jy(t){return(jy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ay(t,e){return(Ay=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ly=function(t){function e(t){var n=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Py(this,jy(e).call(this,(function(t,e){var r=n.getCell(t-1,e),o=n.getCell(t,e);if(_.isUnDef(o))return!1;var i=o.borderAttr.top;if(_.isUnDef(r))return i.display;var c=r.borderAttr.bottom;return c.display?1===i.priority(c):i.display})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ay(t,e)}(e,t),e}(sp);function Ry(t){return(Ry="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ny(t,e){return!e||"object"!==Ry(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wy(t){return(Wy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dy(t,e){return(Dy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hy=function(t){function e(t){var n,r=t.drawOptimization,o=void 0!==r&&r,i=t.merges,c=t.rows,l=t.cols,s=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ny(this,Wy(e).call(this,{merges:i,rows:c,cols:l,cells:s}))).drawOptimization=o,n.horizontalMergeFilter=new kp({merges:i}),n.verticalMergeFilter=new Lp({merges:i}),n.bottomBorderDiffFilter=new gy({cells:s}),n.leftBorderDiffFilter=new Oy({cells:s}),n.rightBorderDiffFilter=new ky({cells:s}),n.topBorderDiffFilter=new Ly({cells:s}),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dy(t,e)}(e,t),n=e,(r=[{key:"computerTopHorizontalLine",value:function(t){var e,n,r,o,i=t.viewRange,c=void 0===i?null:i,l=t.bx,s=void 0===l?0:l,a=t.by,u=void 0===a?0:a,f=t.filter,h=void 0===f?null:f,p=this.drawOptimization,y=this.cols,b=this.cells,d=[];if(this.horizontalIterate({viewRange:c,newRow:function(t,i){r=e=s,o=n=u+i},filter:h,jump:function(t,n){var o=y.getWidth(n);r=e=r+o},handle:function(t,i){var c=y.getWidth(i),l=b.getCell(t,i).borderAttr;r+=c,d.push({sx:e,sy:n,ex:r,ey:o,row:t,col:i,borderAttr:l}),e=r}}),p)for(var g=1;g<d.length;){var v=d[g],w=d[g-1],m=v.borderAttr.top.equal(w.borderAttr.top),S=v.col-w.col==1,O=v.row===w.row;m&&S&&O?(w.ex=v.ex,w.col=v.col,d.splice(g,1)):g+=1}return d}},{key:"computerBottomHorizontalLine",value:function(t){var e,n,r,o,i=t.viewRange,c=void 0===i?null:i,l=t.bx,s=void 0===l?0:l,a=t.by,u=void 0===a?0:a,f=t.filter,h=void 0===f?null:f,p=this.drawOptimization,y=this.cols,b=this.rows,d=this.cells,g=[];if(this.horizontalIterate({viewRange:c,newRow:function(t,i){var c=b.getHeight(t);r=e=s,o=n=u+i+c},filter:h,jump:function(t,n){var o=y.getWidth(n);r=e=r+o},handle:function(t,i){var c=y.getWidth(i),l=d.getCell(t,i).borderAttr;r+=c,g.push({sx:e,sy:n,ex:r,ey:o,row:t,col:i,borderAttr:l}),e=r}}),p)for(var v=1;v<g.length;){var w=g[v],m=g[v-1],S=w.borderAttr.bottom.equal(m.borderAttr.bottom),O=w.col-m.col==1,E=w.row===m.row;S&&O&&E?(m.ex=w.ex,m.col=w.col,g.splice(v,1)):v+=1}return g}},{key:"computerLeftVerticalLine",value:function(t){var e,n,r,o,i=t.viewRange,c=void 0===i?null:i,l=t.bx,s=void 0===l?0:l,a=t.by,u=void 0===a?0:a,f=t.filter,h=void 0===f?null:f,p=this.drawOptimization,y=this.rows,b=this.cells,d=[];if(this.verticalIterate({viewRange:c,newCol:function(t,i){r=e=s+i,o=n=u},filter:h,jump:function(t,e){var r=y.getHeight(e);o=n=o+r},handle:function(t,i){var c=y.getHeight(i),l=b.getCell(i,t).borderAttr;o+=c,d.push({sx:e,sy:n,ex:r,ey:o,row:i,col:t,borderAttr:l}),n=o}}),p)for(var g=1;g<d.length;){var v=d[g],w=d[g-1],m=v.borderAttr.left.equal(w.borderAttr.left),S=v.row-w.row==1,O=v.col===w.col;m&&S&&O?(w.ey=v.ey,w.row=v.row,d.splice(g,1)):g+=1}return d}},{key:"computerRightVerticalLine",value:function(t){var e,n,r,o,i=t.viewRange,c=void 0===i?null:i,l=t.bx,s=void 0===l?0:l,a=t.by,u=void 0===a?0:a,f=t.filter,h=void 0===f?null:f,p=this.drawOptimization,y=this.rows,b=this.cols,d=this.cells,g=[];if(this.verticalIterate({viewRange:c,newCol:function(t,i){var c=b.getWidth(t);r=e=s+i+c,o=n=u},filter:h,jump:function(t,e){var r=y.getHeight(e);o=n=o+r},handle:function(t,i){var c=y.getHeight(i),l=d.getCell(i,t).borderAttr;o+=c,g.push({sx:e,sy:n,ex:r,ey:o,row:i,col:t,borderAttr:l}),n=o}}),p)for(var v=1;v<g.length;){var w=g[v],m=g[v-1],S=w.borderAttr.right.equal(m.borderAttr.right),O=w.row-m.row==1,E=w.col===m.col;S&&O&&E?(m.ey=w.ey,m.row=w.row,g.splice(v,1)):v+=1}return g}},{key:"disableOptimization",value:function(){this.drawOptimization=!1}},{key:"enableOptimization",value:function(){this.drawOptimization=!0}}])&&Vy(n.prototype,r),o&&Vy(n,o),e}(Op);function My(t){return(My="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function By(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Iy(t,e){return!e||"object"!==My(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yy(t){return(Yy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fy(t,e){return(Fy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Uy=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Iy(this,Yy(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fy(t,e)}(e,t),n=e,(r=[{key:"getBottomHorizontalLine",value:function(t){var e=t.viewRange,n=this.horizontalMergeFilter,r=this.bottomBorderDiffFilter;return this.computerBottomHorizontalLine({viewRange:e,filter:new ty(Qp.AND,[n,r])})}},{key:"getTopHorizontalLine",value:function(t){var e=t.viewRange,n=this.horizontalMergeFilter,r=this.topBorderDiffFilter;return this.computerTopHorizontalLine({viewRange:e,filter:new ty(Qp.AND,[n,r])})}},{key:"getBottomMergeHorizontalLine",value:function(t){for(var e=t.brink,n=this.bottomBorderDiffFilter,r=[],o=0;o<e.length;o+=1){var i=e[o].bottom;if(i){var c=this.computerBottomHorizontalLine({viewRange:i.view,bx:i.x,by:i.y,filter:n});r=r.concat(c)}}return r}},{key:"getTopMergeHorizontalLine",value:function(t){for(var e=t.brink,n=this.topBorderDiffFilter,r=[],o=0;o<e.length;o+=1){var i=e[o].top;if(i){var c=this.computerTopHorizontalLine({viewRange:i.view,bx:i.x,by:i.y,filter:n});r=r.concat(c)}}return r}}])&&By(n.prototype,r),o&&By(n,o),e}(Hy);function zy(t){return(zy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xy(t,e){return!e||"object"!==zy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ky(t){return(Ky=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qy(t,e){return(qy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $y=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Xy(this,Ky(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qy(t,e)}(e,t),n=e,(r=[{key:"getRightVerticalLine",value:function(t){var e=t.viewRange,n=this.verticalMergeFilter,r=this.rightBorderDiffFilter,o=this.rightOutRangeFilter;return this.computerRightVerticalLine({viewRange:e,filter:new ty(Qp.AND,[n,r,o])})}},{key:"getLeftVerticalLine",value:function(t){var e=t.viewRange,n=this.verticalMergeFilter,r=this.leftBorderDiffFilter,o=this.leftOutRangeFilter;return this.computerLeftVerticalLine({viewRange:e,filter:new ty(Qp.AND,[n,r,o])})}},{key:"getRightMergeVerticalLine",value:function(t){for(var e=t.brink,n=this.rightBorderDiffFilter,r=[],o=0;o<e.length;o+=1){var i=e[o].right;if(i){var c=this.computerRightVerticalLine({viewRange:i.view,bx:i.x,by:i.y,filter:n});r=r.concat(c)}}return r}},{key:"getLeftMergeVerticalLine",value:function(t){for(var e=t.brink,n=this.leftBorderDiffFilter,r=[],o=0;o<e.length;o+=1){var i=e[o].left;if(i){var c=this.computerLeftVerticalLine({viewRange:i.view,bx:i.x,by:i.y,filter:n});r=r.concat(c)}}return r}}])&&Gy(n.prototype,r),o&&Gy(n,o),e}(Hy);function Zy(t){return(Zy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qy(t,e){return!e||"object"!==Zy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tb(t){return(tb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function eb(t,e){return(eb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nb=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Qy(this,tb(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&eb(t,e)}(e,t),n=e,(r=[{key:"getCellOrNewCellByViewRange",value:function(t){for(var e=t.rectRange,n=void 0===e?new ta(-1,-1,-1,-1):e,r=t.callback,o=void 0===r?function(){}:r,i=this.cells,c=n.sri,l=n.eri,s=n.sci,a=n.eci,u=c;u<=l;u+=1)for(var f=s;f<=a;f+=1)o(u,f,i.getCellOrNew(u,f))}}])&&Jy(n.prototype,r),o&&Jy(n,o),e}($f);function rb(t,e,n){return(rb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=lb(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ob(t){return(ob="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ib(t,e){return!e||"object"!==ob(e)&&"function"!=typeof e?cb(t):e}function cb(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lb(t){return(lb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sb(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ab(t,e)}function ab(t,e){return(ab=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ub(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hb(t,e,n){return e&&fb(t.prototype,e),n&&fb(t,n),t}var pb={SCROLL:Symbol("scroll"),RENDER:Symbol("render"),SCALE:Symbol("scale")},yb=function(){function t(e){ub(this,t),this.table=e,this.width=null,this.height=null,this.x=null,this.y=null,this.drawX=null,this.drawY=null,this.mapOriginX=null,this.mapOriginY=null,this.mapTargetX=null,this.mapTargetY=null,this.mapWidth=null,this.mapHeight=null,this.fullScrollView=null,this.scrollView=null,this.borderView=null,this.borderX=null,this.borderY=null,this.viewMode=null}return hb(t,[{key:"reset",value:function(){this.width=null,this.height=null,this.x=null,this.y=null,this.drawX=null,this.drawY=null,this.mapOriginX=null,this.mapOriginY=null,this.mapTargetX=null,this.mapTargetY=null,this.mapWidth=null,this.mapHeight=null,this.fullScrollView=null,this.scrollView=null,this.borderView=null,this.borderX=null,this.borderY=null,this.viewMode=null}},{key:"getWidth",value:function(){throw new TypeError("getWidth child impl")}},{key:"getHeight",value:function(){throw new TypeError("getHeight child impl")}},{key:"getX",value:function(){throw new TypeError("getX child impl")}},{key:"getY",value:function(){throw new TypeError("getY child impl")}},{key:"getDrawX",value:function(){if(_.isNumber(this.drawX))return this.drawX;var t=this.table,e=this.getX();if(t.getRenderMode()===pb.RENDER)return this.drawX=e,e;if(t.getRenderMode()===pb.SCALE)return this.drawX=e,e;if(this.getViewMode()===mh.BOUND_OUT)return this.drawX=e,e;if(this.getViewMode()===mh.CHANGE_NOT)return this.drawX=e,e;var n=t.scroll,r=this.getScrollView(),o=this.getFullScrollView(),i=0;switch(n.type){case Cf.H_RIGHT:i=o.w-r.w;break;case Cf.H_LEFT:i=0}return i=e+i,this.drawX=i,i}},{key:"getDrawY",value:function(){if(_.isNumber(this.drawY))return this.drawY;var t=this.table,e=this.getY();if(t.getRenderMode()===pb.RENDER)return this.drawY=e,e;if(t.getRenderMode()===pb.SCALE)return this.drawY=e,e;if(this.getViewMode()===mh.BOUND_OUT)return this.drawY=e,e;if(this.getViewMode()===mh.CHANGE_NOT)return this.drawY=e,e;var n=t.scroll,r=this.getScrollView(),o=this.getFullScrollView(),i=0;switch(n.type){case Cf.V_BOTTOM:i=o.h-r.h;break;case Cf.V_TOP:i=0}return i=e+i,this.drawY=i,i}},{key:"getLineX",value:function(){if(_.isNumber(this.borderX))return this.borderX;var t=this.table,e=this.getX();if(t.getRenderMode()===pb.RENDER)return this.borderX=e,e;if(t.getRenderMode()===pb.SCALE)return this.borderX=e,e;if(this.getViewMode()===mh.BOUND_OUT)return this.borderX=e,e;if(this.getViewMode()===mh.CHANGE_NOT)return this.borderX=e,e;var n=0;switch(t.scroll.type){case Cf.H_RIGHT:var r=this.getLineView();n=this.getFullScrollView().w-r.w;break;case Cf.H_LEFT:n=0}return n=e+n,this.borderX=n,n}},{key:"getLineY",value:function(){if(_.isNumber(this.borderY))return this.borderY;var t=this.table,e=this.getY();if(t.getRenderMode()===pb.RENDER)return this.borderY=e,e;if(t.getRenderMode()===pb.SCALE)return this.borderY=e,e;if(this.getViewMode()===mh.BOUND_OUT)return this.borderY=e,e;if(this.getViewMode()===mh.CHANGE_NOT)return this.borderY=e,e;var n=0;switch(t.scroll.type){case Cf.V_BOTTOM:var r=this.getLineView();n=this.getFullScrollView().h-r.h;break;case Cf.V_TOP:n=0}return n=e+n,this.borderY=n,n}},{key:"getMapOriginX",value:function(){if(_.isNumber(this.mapOriginX))return this.mapOriginX;var t=this.table,e=t.xTableAreaView,n=t.scroll,r=this.getX(),o=0;switch(n.type){case Cf.H_LEFT:o=0;break;case Cf.H_RIGHT:o=e.getLeaveView().w}return o=r+o,this.mapOriginX=o,o}},{key:"getMapOriginY",value:function(){if(_.isNumber(this.mapOriginY))return this.mapOriginY;var t=this.table,e=t.xTableAreaView,n=t.scroll,r=this.getY(),o=0;switch(n.type){case Cf.V_TOP:o=0;break;case Cf.V_BOTTOM:o=e.getLeaveView().h}return o=r+o,this.mapOriginY=o,o}},{key:"getMapTargetX",value:function(){if(_.isNumber(this.mapTargetX))return this.mapTargetX;var t=this.table,e=t.xTableAreaView,n=t.scroll,r=this.getX(),o=0;switch(n.type){case Cf.H_LEFT:o=e.getEnterView().w;break;case Cf.H_RIGHT:o=0}return o=r+o,this.mapTargetX=o,o}},{key:"getMapTargetY",value:function(){if(_.isNumber(this.mapTargetY))return this.mapTargetY;var t=this.table,e=t.xTableAreaView,n=t.scroll,r=this.getY(),o=0;switch(n.type){case Cf.V_TOP:o=e.getEnterView().h;break;case Cf.V_BOTTOM:o=0}return o=r+o,this.mapTargetY=o,o}},{key:"getMapWidth",value:function(){if(_.isNumber(this.mapWidth))return this.mapWidth;var t=this.table,e=t.xTableAreaView,n=t.scroll,r=this.getWidth();switch(n.type){case Cf.H_RIGHT:r-=e.getLeaveView().w;break;case Cf.H_LEFT:r-=e.getEnterView().w}return this.mapWidth=r,r}},{key:"getMapHeight",value:function(){if(_.isNumber(this.mapHeight))return this.mapHeight;var t=this.table,e=t.xTableAreaView,n=t.scroll,r=this.getHeight();switch(n.type){case Cf.V_BOTTOM:r-=e.getLeaveView().h;break;case Cf.V_TOP:r-=e.getEnterView().h}return this.mapHeight=r,r}},{key:"getScrollView",value:function(){throw new TypeError("getScrollView child impl")}},{key:"getFullScrollView",value:function(){throw new TypeError("getFullScrollView child impl")}},{key:"getLineView",value:function(){if(_.isNotUnDef(this.borderView))return this.borderView.clone();var t=this.table,e=t.cols,n=t.rows,r=t.getRenderMode(),o=this.getViewMode(),i=this.getScrollView();if(o===mh.CHANGE_ADD&&r===pb.SCROLL)switch(t.scroll.type){case Cf.V_TOP:i.eri+=1,i.h=n.rectRangeSumHeight(i);break;case Cf.V_BOTTOM:i.sri-=1,i.h=n.rectRangeSumHeight(i);break;case Cf.H_RIGHT:i.sci-=1,i.w=e.rectRangeSumWidth(i);break;case Cf.H_LEFT:i.eci+=1,i.w=e.rectRangeSumWidth(i)}return this.borderView=i,i.clone()}},{key:"getViewMode",value:function(){throw new TypeError("getViewMode child impl")}},{key:"drawMap",value:function(){var t=this.table,e=t.getRenderMode();if(this.getViewMode()===mh.CHANGE_ADD&&e===pb.SCROLL){var n=t.draw,r=t.el,o=this.getMapWidth(),i=this.getMapHeight(),c=this.getMapOriginX(),l=this.getMapOriginY(),s=this.getMapTargetX(),a=this.getMapTargetY();n.drawImage(r,c,l,o,i,s,a,o,i)}}},{key:"drawClear",value:function(){var t=this.table,e=t.scroll,n=t.draw,r=t.settings,o=this.getViewMode(),i=t.getRenderMode(),c=this.getDrawX(),l=this.getDrawY();if(n.attr({fillStyle:r.table.background}),i===pb.SCROLL)switch(o){case mh.CHANGE_NOT:case mh.STATIC:case mh.BOUND_OUT:var s=this.getHeight(),a=this.getWidth();n.fillRect(c,l,a,s);break;case mh.CHANGE_ADD:switch(e.type){case Cf.V_BOTTOM:var u=this.getFullScrollView(),f=this.getScrollView(),h=t.visualHeight()-(u.h-f.h),p=this.getWidth();n.fillRect(c,l,p,h);break;case Cf.V_TOP:var y=this.getScrollView().h,b=this.getWidth();n.fillRect(c,l,b,y);break;case Cf.H_LEFT:var d=this.getScrollView(),g=this.getHeight(),v=d.w;n.fillRect(c,l,v,g);break;case Cf.H_RIGHT:var w=this.getFullScrollView(),m=this.getScrollView(),S=this.getHeight(),O=t.visualWidth()-(w.w-m.w);n.fillRect(c,l,O,S)}}else if(pb.RENDER){var E=this.getHeight(),_=this.getWidth();n.fillRect(c,l,_,E)}}}]),t}(),bb=function(t){function e(){return ub(this,e),ib(this,lb(e).apply(this,arguments))}return sb(e,t),hb(e,[{key:"drawBoundOutFont",value:function(){var t=this.getScrollView(),e=this.table,n=e.draw,r=e.cols,o=e.textCellsHelper,i=e.cells,c=e.textFont,l=e.scale,s=t.clone();if(s.sci=0,s.eci=t.sci-1,s.eci>-1){var a,u,f=this.getDrawX()-r.getWidth(s.eci),h=this.getDrawY();n.offset(f,h),o.getCellSkipMergeCellByViewRange({rectRange:s,reverseCols:!0,callback:function(t,e,r,o,s){t!==u&&(a=0,u=t),a+=o.width;var f=r.text,h=r.fontAttr,p=h.align,y=h.textWrap;if(!_.isBlank(f)&&p!==ol.right&&y===cl.OVER_FLOW){var b=i.getCellBoundOutSize(t,e);if(0===b||b>a){var d=r.format,g=r.text,v=r.fontAttr;l.useFloat();var w=c.getBuilder();w.setDraw(n),w.setText(Df(d,g)),w.setAttr(v),w.setRect(o),w.setOverFlow(s);var m=w.build();r.setContentWidth(m.draw()),l.notFloat()}}}}),n.offset(0,0)}var p=t.clone();if(p.sci=t.eci+1,p.eci=r.len-1,p.sci<r.len){var y,b,d=this.getDrawX()+t.w,g=this.getDrawY();n.offset(d,g),o.getCellSkipMergeCellByViewRange({rectRange:p,callback:function(t,e,r,o,s){t!==b&&(y=0,b=t),y+=o.width;var a=r.text,u=r.fontAttr,f=u.align,h=u.textWrap;if(!_.isBlank(a)&&f!==ol.left&&h===cl.OVER_FLOW){var p=i.getCellBoundOutSize(t,e);if(0===p||p>y){var d=r.format,g=r.text,v=r.fontAttr;l.useFloat();var w=c.getBuilder();w.setDraw(n),w.setText(Df(d,g)),w.setAttr(v),w.setRect(o),w.setOverFlow(s);var m=w.build();r.setContentWidth(m.draw()),l.notFloat()}}}}),n.offset(0,0)}}},{key:"drawFont",value:function(){var t=this.getScrollView(),e=this.getDrawX(),n=this.getDrawY(),r=this.table,o=r.draw,i=r.textCellsHelper,c=r.textFont,l=r.scale;o.offset(e,n),i.getCellSkipMergeCellByViewRange({rectRange:t,callback:function(t,e,n,r,i){var s=n.format,a=n.text,u=n.fontAttr;l.useFloat();var f=c.getBuilder();f.setDraw(o),f.setText(Df(s,a)),f.setAttr(u),f.setRect(r),f.setOverFlow(i);var h=f.build();n.setContentWidth(h.draw()),l.notFloat()}}),i.getMergeCellByViewRange({rectRange:t,callback:function(t,e){var n=e.format,r=e.text,i=e.fontAttr;l.useFloat();var s=c.getBuilder();s.setDraw(o),s.setText(Df(n,r)),s.setAttr(i),s.setRect(t);var a=s.build();a.setTextWrap(cl.WORD_WRAP),e.setContentWidth(a.draw()),l.notFloat()}}),o.offset(0,0)}},{key:"drawBorder",value:function(){var t=this.getLineView(),e=this.getLineX(),n=this.getLineY(),r=this.table,o=r.draw,i=r.line,c=r.cellHorizontalBorder,l=r.cellVerticalBorder;o.offset(e,n);var s=c.getMergeCoincideRange({viewRange:t}),a=c.getCoincideRangeBrink({coincide:s}),u=c.getBottomHorizontalLine({viewRange:t}),f=c.getTopHorizontalLine({viewRange:t}),h=l.getLeftVerticalLine({viewRange:t}),p=l.getRightVerticalLine({viewRange:t});f.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.top,c=o.color,l=o.width,s=o.type;i.setType(s),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"top")})),u.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.bottom,c=o.color,l=o.width,s=o.type;i.setType(s),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"bottom")})),h.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.left,c=o.color,l=o.width,s=o.type;i.setType(s),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"left")})),p.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.right,c=o.color,l=o.width,s=o.type;i.setType(s),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"right")}));var y=c.getTopMergeHorizontalLine({brink:a}),b=c.getBottomMergeHorizontalLine({brink:a}),d=l.getLeftMergeVerticalLine({brink:a}),g=l.getRightMergeVerticalLine({brink:a});y.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.top,c=o.color,l=o.width,s=o.type;i.setType(s),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"top")})),b.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.bottom,c=o.color,l=o.width,s=o.type;i.setType(s),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"bottom")})),d.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.left,c=o.color,l=o.width,s=o.type;i.setType(s),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"left")})),g.forEach((function(t){var e=t.borderAttr,n=t.row,r=t.col,o=e.right,c=o.color,l=o.width,s=o.type;i.setType(s),i.setColor(c),i.setWidth(l),i.drawLine(t.sx,t.sy,t.ex,t.ey,n,r,"right")})),o.offset(0,0)}},{key:"drawGrid",value:function(){var t=this.getLineView(),e=this.getLineX(),n=this.getLineY(),r=this.table,o=r.draw,i=r.grid,c=r.cellHorizontalGrid,l=r.cellVerticalGrid;o.offset(e,n);var s=c.getMergeCoincideRange({viewRange:t}),a=c.getCoincideRangeBrink({coincide:s}),u=c.getHorizontalLine({viewRange:t}),f=l.getVerticalLine({viewRange:t});u.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),f.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)}));var h=c.getMergeHorizontalLine({brink:a}),p=l.getMergeVerticalLine({brink:a});h.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),p.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)})),o.offset(0,0)}},{key:"drawColor",value:function(){var t=this.getScrollView(),e=this.table,n=this.getDrawX(),r=this.getDrawY(),o=e.draw,i=e.styleCellsHelper;o.offset(n,r),i.getMergeCellByViewRange({rectRange:t,callback:function(t,e){var n=e.background;new Mf({draw:o,rect:t}).drawBackgroundColor(n)}}),i.getCellByViewRange({rectRange:t,callback:function(t,e,n,r){var i=n.background;new Mf({draw:o,rect:r}).drawBackgroundColor(i)}}),o.offset(0,0)}},{key:"render",value:function(){var t=this.table,e=t.getRenderMode();if(this.getViewMode()!==mh.STATIC||e!==pb.SCROLL){this.drawMap(),this.drawClear();var n=this.getScrollView(),r=this.getDrawX(),o=this.getDrawY(),i=n.w,c=n.h,l=t.draw,s=new jc({rect:new Lc({x:r,y:o,width:i,height:c}),draw:l});s.open(),this.drawColor(),this.drawFont(),this.drawBoundOutFont(),this.table.settings.table.showGrid&&this.drawGrid(),this.drawBorder(),s.close()}}}]),e}(yb),db=function(t){function e(){return ub(this,e),ib(this,lb(e).apply(this,arguments))}return sb(e,t),hb(e,[{key:"drawFont",value:function(){throw new TypeError("drawFont child impl")}},{key:"drawColor",value:function(){throw new TypeError("drawColor child impl")}},{key:"drawGrid",value:function(){throw new TypeError("drawGrid child impl")}},{key:"render",value:function(){var t=this.table.getRenderMode();this.getViewMode()===mh.STATIC&&t===pb.SCROLL||(this.drawMap(),this.drawClear(),this.drawColor(),this.drawGrid(),this.drawFont())}}]),e}(yb),gb=function(t){function e(){return ub(this,e),ib(this,lb(e).apply(this,arguments))}return sb(e,t),hb(e,[{key:"drawFont",value:function(){var t=this.getDrawX(),e=this.getDrawY(),n=this.getScrollView(),r=this.getWidth(),o=this.table,i=o.draw,c=o.rows,l=o.index,s=n.sri,a=n.eri;i.offset(t,e),i.attr({textAlign:"center",textBaseline:"middle",font:"".concat(l.getSize(),"px Arial"),fillStyle:l.getColor()}),c.eachHeight(s,a,(function(t,e,n){i.fillText(t+1,r/2,n+e/2)})),i.offset(0,0)}},{key:"drawGrid",value:function(){var t=this.getLineView(),e=this.getLineX(),n=this.getLineY(),r=this.table,o=r.draw,i=r.indexGrid,c=r.leftIndexHorizontalGrid,l=r.leftIndexVerticalGrid;o.offset(e,n);var s=c.getHorizontalLine({viewRange:t}),a=l.getVerticalLine({viewRange:t});s.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),a.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)})),o.offset(0,0)}},{key:"drawColor",value:function(){var t=this.getDrawX(),e=this.getDrawY(),n=this.getScrollView().h,r=this.getWidth(),o=this.table,i=o.draw,c=o.index;i.offset(t,e),i.attr({fillStyle:c.getBackground()}),i.fillRect(0,0,r,n),i.offset(0,0)}}]),e}(db),vb=function(t){function e(){return ub(this,e),ib(this,lb(e).apply(this,arguments))}return sb(e,t),hb(e,[{key:"drawFont",value:function(){var t=this.getDrawX(),e=this.getDrawY(),n=this.getScrollView(),r=this.getHeight(),o=this.table,i=o.draw,c=o.cols,l=o.index,s=n.sci,a=n.eci;i.offset(t,e),i.attr({textAlign:"center",textBaseline:"middle",font:"".concat(l.getSize(),"px Arial"),fillStyle:l.getColor()}),c.eachWidth(s,a,(function(t,e,n){i.fillText(_.stringAt(t),n+e/2,r/2)})),i.offset(0,0)}},{key:"drawGrid",value:function(){var t=this.getLineView(),e=this.getLineX(),n=this.getLineY(),r=this.table,o=r.draw,i=r.indexGrid,c=r.topIndexVerticalGrid,l=r.topIndexHorizontalGrid;o.offset(e,n);var s=l.getHorizontalLine({viewRange:t}),a=c.getVerticalLine({viewRange:t});s.forEach((function(t){i.horizontalLine(t.sx,t.sy,t.ex,t.ey)})),a.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)})),o.offset(0,0)}},{key:"drawColor",value:function(){var t=this.table,e=t.draw,n=t.index,r=this.getScrollView(),o=this.getDrawX(),i=this.getDrawY(),c=this.getHeight(),l=r.w;e.offset(o,i),e.attr({fillStyle:n.getBackground()}),e.fillRect(0,0,l,c),e.offset(0,0)}}]),e}(db),wb=function(t){function e(){return ub(this,e),ib(this,lb(e).apply(this,arguments))}return sb(e,t),hb(e,[{key:"getWidth",value:function(){if(_.isNumber(this.width))return this.width;var t=this.table.index.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(_.isNumber(this.height))return this.height;var t=this.table,e=t.fixed,n=t.rows.sectionSumHeight(0,e.fxTop);return this.height=n,n}},{key:"getX",value:function(){if(_.isNumber(this.x))return this.x;return this.x=0,0}},{key:"getY",value:function(){if(_.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}},{key:"getScrollView",value:function(){if(_.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.rows,n=t.cols,r=t.fixed,o=new ta(0,0,r.fxTop,0);return o.w=n.rectRangeSumWidth(o),o.h=e.rectRangeSumHeight(o),this.scrollView=o,o.clone()}},{key:"getFullScrollView",value:function(){if(_.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.getScrollView();return this.fullScrollView=t,t.clone()}},{key:"getViewMode",value:function(){return this.viewMode=mh.STATIC,mh.STATIC}},{key:"render",value:function(){var t=this.table.getRenderMode();t!==pb.RENDER&&t!==pb.SCALE||rb(lb(e.prototype),"render",this).call(this)}}]),e}(gb),mb=function(t){function e(){return ub(this,e),ib(this,lb(e).apply(this,arguments))}return sb(e,t),hb(e,[{key:"getWidth",value:function(){if(_.isNumber(this.width))return this.width;var t=this.table,e=t.fixed,n=t.rows.sectionSumHeight(0,e.fxLeft);return this.width=n,n}},{key:"getHeight",value:function(){if(_.isNumber(this.height))return this.height;var t=this.table,e=t.fixed,n=t.rows.sectionSumHeight(0,e.fxTop);return this.height=n,n}},{key:"getX",value:function(){if(_.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(_.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}},{key:"getScrollView",value:function(){if(_.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.rows,n=t.cols,r=t.fixed,o=new ta(0,0,r.fxTop,r.fxLeft);return o.w=n.rectRangeSumWidth(o),o.h=e.rectRangeSumHeight(o),this.scrollView=o,o.clone()}},{key:"getFullScrollView",value:function(){if(_.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.getScrollView();return this.fullScrollView=t,t.clone()}},{key:"getViewMode",value:function(){return this.viewMode=mh.STATIC,mh.STATIC}},{key:"render",value:function(){var t=this.table.getRenderMode();t!==pb.RENDER&&t!==pb.SCALE||rb(lb(e.prototype),"render",this).call(this)}}]),e}(bb),Sb=function(t){function e(){return ub(this,e),ib(this,lb(e).apply(this,arguments))}return sb(e,t),hb(e,[{key:"getWidth",value:function(){if(_.isNumber(this.width))return this.width;var t=this.table,e=t.fixed,n=t.rows.sectionSumHeight(0,e.fxLeft);return this.width=n,n}},{key:"getHeight",value:function(){if(_.isNumber(this.height))return this.height;var t=this.table.index.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(_.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(_.isNumber(this.y))return this.y;return this.y=0,0}},{key:"getScrollView",value:function(){if(_.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.rows,n=t.cols,r=t.fixed,o=new ta(0,0,0,r.fxLeft);return o.w=n.rectRangeSumWidth(o),o.h=e.rectRangeSumHeight(o),this.scrollView=o,o.clone()}},{key:"getFullScrollView",value:function(){if(_.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.getScrollView();return this.fullScrollView=t,t.clone()}},{key:"getViewMode",value:function(){return this.viewMode=mh.STATIC,mh.STATIC}},{key:"render",value:function(){var t=this.table.getRenderMode();t!==pb.RENDER&&t!==pb.SCALE||rb(lb(e.prototype),"render",this).call(this)}}]),e}(vb),Ob=function(){function t(e){ub(this,t),this.table=e}return hb(t,[{key:"draw",value:function(){var t=this.table,e=t.draw,n=t.indexGrid,r=t.index,o=r.getHeight(),i=r.getWidth();e.save(),e.offset(0,0),e.attr({fillStyle:"#f4f5f8"}),e.fillRect(0,0,r.getWidth(),o),e.offset(0,0),n.horizontalLine(0,o,i,o),n.verticalLine(i,0,i,o),e.restore()}},{key:"render",value:function(){var t=this.table.getRenderMode();t!==pb.RENDER&&t!==pb.SCALE||this.draw()}}]),t}(),Eb=function(t){function e(){return ub(this,e),ib(this,lb(e).apply(this,arguments))}return sb(e,t),hb(e,[{key:"getWidth",value:function(){if(_.isNumber(this.width))return this.width;var t=this.table.index.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(_.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,n=t.index,r=t.visualHeight()-(n.getHeight()+e.getHeight());return this.height=r,r}},{key:"getX",value:function(){if(_.isNumber(this.x))return this.x;return this.x=0,0}},{key:"getY",value:function(){if(_.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,n=t.index.getHeight()+e.getHeight();return this.y=n,n}},{key:"getScrollView",value:function(){if(_.isNotUnDef(this.scrollView))return this.scrollView.clone();var t,e=this.table,n=e.xTableAreaView,r=e.index,o=e.getRenderMode(),i=n.getScrollView(),c=n.getScrollEnterView();return(t=_.isNotUnDef(c)&&o===pb.SCROLL?c:i).sci=0,t.eci=0,t.w=r.getWidth(),this.scrollView=t,t.clone()}},{key:"getFullScrollView",value:function(){if(_.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table,e=t.index,n=t.xTableAreaView.getScrollView();return n.sci=0,n.eci=0,n.w=e.getWidth(),this.fullScrollView=n,n.clone()}},{key:"getViewMode",value:function(){if(_.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table,e=t.xTableAreaView,n=t.cols,r=e.getLastScrollView(),o=e.getScrollView();_.isNotUnDef(r)&&(r.sci=0,r.eci=0,r.w=n.sectionSumWidth(r.sci,r.eci)),o.sci=0,o.eci=0,o.w=n.sectionSumWidth(o.sci,o.eci);var i=Sh.viewMode(r,o);return this.viewMode=i,i}}]),e}(gb),_b=function(t){function e(){return ub(this,e),ib(this,lb(e).apply(this,arguments))}return sb(e,t),hb(e,[{key:"getWidth",value:function(){if(_.isNumber(this.width))return this.width;var t=this.table,e=t.cols,n=t.fixed,r=e.sectionSumWidth(0,n.fxLeft);return this.width=r,r}},{key:"getHeight",value:function(){if(_.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,n=t.index,r=t.visualHeight()-(n.getHeight()+e.getHeight());return this.height=r,r}},{key:"getX",value:function(){if(_.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(_.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,n=t.index.getHeight()+e.getHeight();return this.y=n,n}},{key:"getScrollView",value:function(){if(_.isNotUnDef(this.scrollView))return this.scrollView.clone();var t,e=this.table,n=e.fixed,r=e.cols,o=e.xTableAreaView,i=e.getRenderMode(),c=o.getScrollView(),l=o.getScrollEnterView();return(t=_.isNotUnDef(l)&&i===pb.SCROLL?l:c).sci=0,t.eci=n.fxLeft,t.w=r.sectionSumWidth(t.sci,t.eci),this.scrollView=t,t.clone()}},{key:"getFullScrollView",value:function(){if(_.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table,e=t.fixed,n=t.cols,r=t.xTableAreaView.getScrollView();return r.sci=0,r.eci=e.fxLeft,r.w=n.sectionSumWidth(r.sci,r.eci),this.fullScrollView=r,r.clone()}},{key:"getViewMode",value:function(){if(_.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table,e=t.xTableAreaView,n=t.cols,r=t.fixed,o=e.getLastScrollView(),i=e.getScrollView();_.isNotUnDef(o)&&(o.sci=0,o.eci=r.fxLeft,o.w=n.sectionSumWidth(o.sci,o.eci)),i.sci=0,i.eci=r.fxLeft,i.w=n.sectionSumWidth(i.sci,i.eci);var c=Sh.viewMode(o,i);return this.viewMode=c,c}}]),e}(bb),xb=function(t){function e(){return ub(this,e),ib(this,lb(e).apply(this,arguments))}return sb(e,t),hb(e,[{key:"getWidth",value:function(){if(_.isNumber(this.width))return this.width;var t=this.table,e=t.index,n=t.xLeft,r=t.visualWidth()-(e.getWidth()+n.getWidth());return this.width=r,r}},{key:"getHeight",value:function(){if(_.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,n=t.index,r=t.visualHeight()-(n.getHeight()+e.getHeight());return this.height=r,r}},{key:"getX",value:function(){if(_.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,n=t.index.getWidth()+e.getWidth();return this.x=n,n}},{key:"getY",value:function(){if(_.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,n=t.index.getHeight()+e.getHeight();return this.y=n,n}},{key:"getScrollView",value:function(){if(_.isNotUnDef(this.scrollView))return this.scrollView.clone();var t,e=this.table,n=e.xTableAreaView,r=e.getRenderMode(),o=n.getScrollView(),i=n.getScrollEnterView();return t=_.isNotUnDef(i)&&r===pb.SCROLL?i:o,this.scrollView=t,t.clone()}},{key:"getFullScrollView",value:function(){if(_.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table.xTableAreaView.getScrollView();return this.fullScrollView=t,t.clone()}},{key:"getViewMode",value:function(){if(_.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table.xTableAreaView,e=t.getLastScrollView(),n=t.getScrollView(),r=Sh.viewMode(e,n);return this.viewMode=r,r}}]),e}(bb),Tb=function(t){function e(){return ub(this,e),ib(this,lb(e).apply(this,arguments))}return sb(e,t),hb(e,[{key:"getWidth",value:function(){if(_.isNumber(this.width))return this.width;var t=this.table,e=t.xLeft,n=t.index,r=t.visualWidth()-(n.getWidth()+e.getWidth());return this.width=r,r}},{key:"getHeight",value:function(){if(_.isNumber(this.height))return this.height;var t=this.table,e=t.fixed,n=t.rows.sectionSumHeight(0,e.fxTop);return this.height=n,n}},{key:"getX",value:function(){if(_.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,n=t.index.getWidth()+e.getWidth();return this.x=n,n}},{key:"getY",value:function(){if(_.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}},{key:"getScrollView",value:function(){if(_.isNotUnDef(this.scrollView))return this.scrollView.clone();var t,e=this.table,n=e.fixed,r=e.rows,o=e.xTableAreaView,i=e.getRenderMode(),c=o.getScrollView(),l=o.getScrollEnterView();return(t=_.isNotUnDef(l)&&i===pb.SCROLL?l:c).sri=0,t.eri=n.fxTop,t.h=r.sectionSumHeight(t.sci,t.eci),this.scrollView=t,t.clone()}},{key:"getFullScrollView",value:function(){if(_.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table,e=t.fixed,n=t.rows,r=t.xTableAreaView.getScrollView();return r.sri=0,r.eri=e.fxTop,r.h=n.sectionSumHeight(r.sci,r.eci),this.scrollView=r,r.clone()}},{key:"getViewMode",value:function(){if(_.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table,e=t.xTableAreaView,n=t.rows,r=t.fixed,o=e.getLastScrollView(),i=e.getScrollView();_.isNotUnDef(o)&&(o.sri=0,o.eri=r.fxTop,o.h=n.sectionSumHeight(o.sci,o.eci)),i.sri=0,i.eri=r.fxTop,i.h=n.sectionSumHeight(i.sci,i.eci);var c=Sh.viewMode(o,i);return this.viewMode=c,c}}]),e}(bb),kb=function(t){function e(){return ub(this,e),ib(this,lb(e).apply(this,arguments))}return sb(e,t),hb(e,[{key:"getWidth",value:function(){if(_.isNumber(this.width))return this.width;var t=this.table,e=t.xLeft,n=t.index,r=t.visualWidth()-(n.getWidth()+e.getWidth());return this.width=r,r}},{key:"getHeight",value:function(){if(_.isNumber(this.height))return this.height;var t=this.table.index.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(_.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,n=t.index.getWidth()+e.getWidth();return this.x=n,n}},{key:"getY",value:function(){if(_.isNumber(this.y))return this.y;return this.y=0,0}},{key:"getScrollView",value:function(){if(_.isNotUnDef(this.scrollView))return this.scrollView.clone();var t,e=this.table,n=e.index,r=e.xTableAreaView,o=e.getRenderMode(),i=r.getScrollView(),c=r.getScrollEnterView();return(t=_.isNotUnDef(c)&&o===pb.SCROLL?c:i).sri=0,t.eri=0,t.h=n.getHeight(),this.scrollView=t,t.clone()}},{key:"getFullScrollView",value:function(){if(_.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table,e=t.index,n=t.xTableAreaView.getScrollView();return n.sri=0,n.eri=0,n.h=e.getHeight(),this.fullScrollView=n,n.clone()}},{key:"getViewMode",value:function(){if(_.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table,e=t.xTableAreaView,n=t.rows,r=e.getLastScrollView(),o=e.getScrollView();_.isNotUnDef(r)&&(r.sri=0,r.eri=0,r.h=n.sectionSumHeight(r.sri,r.eri)),o.sri=0,o.eri=0,o.h=n.sectionSumHeight(o.sri,o.eri);var i=Sh.viewMode(r,o);return this.viewMode=i,i}}]),e}(vb),Cb=function(t){function e(t){var n,r=t.xTableScrollView,i=t.settings,c=t.fixed,l=t.scroll;ub(this,e),(n=ib(this,lb(e).call(this,"".concat(o,"-table-canvas"),"canvas"))).settings=i,n.fixed=c,n.scroll=l,n.renderMode=pb.RENDER,n.scale=new Of,n.index=new Ff(_.mergeDeep({scaleAdapter:new Ef({goto:function(t){return Fc.rpx(n.scale.goto(t))}})},n.settings.index)),n.rows=new xf(_.mergeDeep({scaleAdapter:new Ef({goto:function(t){return Fc.rpx(n.scale.goto(t))}})},n.settings.rows)),n.cols=new kf(_.mergeDeep({scaleAdapter:new Ef({goto:function(t){return Fc.rpx(n.scale.goto(t))},back:function(t){return n.scale.back(t)}})},n.settings.cols)),n.merges=new uh(_.mergeDeep({rows:n.rows,cols:n.cols},n.settings.merge)),n.cells=new If({rows:n.rows,cols:n.cols,data:n.settings.data,merges:n.merges}),n.xTableAreaView=new Eh({xTableScrollView:r,scroll:n.scroll,rows:n.rows,cols:n.cols}),n.styleCellsHelper=new nh({cells:n.cells,merges:n.merges,rows:n.rows,cols:n.cols,scale:n.scale}),n.textCellsHelper=new sh({cells:n.cells,merges:n.merges,rows:n.rows,cols:n.cols,scale:n.scale}),n.operateCellsHelper=new nb({cells:n.cells,merges:n.merges,rows:n.rows,cols:n.cols,scale:n.scale}),n.tableDataSnapshot=new cp(cb(n));var s=new yp({merges:n.merges,cols:n.cols,cells:n.cells}),a=new mp({merges:n.merges,cols:n.cols,cells:n.cells}),u=new ty(Qp.AND,[new sp((function(t,e){var r=n.cells.getCell(t,e);return!_.isUnDef(r)&&r.borderAttr.left.display})),new sp((function(t,e){return s.execute(t,e)}))]),f=new sp((function(t,e){var r=n.cells.getCell(t,e);return!_.isUnDef(r)&&r.borderAttr.top.display})),h=new ty(Qp.AND,[new sp((function(t,e){var r=n.cells.getCell(t,e);return!_.isUnDef(r)&&r.borderAttr.right.display})),new sp((function(t,e){return a.execute(t,e)}))]),p=new sp((function(t,e){var r=n.cells.getCell(t,e);return!_.isUnDef(r)&&r.borderAttr.bottom.display}));return n.draw=new Fc(n.el),n.line=new Xi(n.draw,{leftShow:function(t,e){return u.execute(t,e)},topShow:function(t,e){return f.execute(t,e)},rightShow:function(t,e){return h.execute(t,e)},bottomShow:function(t,e){return p.execute(t,e)},iFMerge:function(t,e){return null!==n.merges.getFirstIncludes(t,e)},iFMergeFirstRow:function(t,e){return n.merges.getFirstIncludes(t,e).sri===t},iFMergeLastRow:function(t,e){return n.merges.getFirstIncludes(t,e).eri===t},iFMergeFirstCol:function(t,e){return n.merges.getFirstIncludes(t,e).sci===e},iFMergeLastCol:function(t,e){return n.merges.getFirstIncludes(t,e).eci===e}}),n.indexGrid=new Af(n.draw,{color:n.index.getGridColor()}),n.grid=new Af(n.draw,{color:n.settings.table.gridColor}),n.textFont=new Kf({scaleAdapter:new Ef({goto:function(t){return n.scale.goto(t)}})}),n.cellHorizontalGrid=new cy({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,drawCheck:!0}),n.cellVerticalGrid=new hy({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,drawCheck:!0}),n.topIndexHorizontalGrid=new cy({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,getHeight:function(){return n.index.getHeight()}}),n.topIndexVerticalGrid=new hy({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,getHeight:function(){return n.index.getHeight()}}),n.leftIndexHorizontalGrid=new cy({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,getWidth:function(){return n.index.getWidth()}}),n.leftIndexVerticalGrid=new hy({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,getWidth:function(){return n.index.getWidth()}}),n.cellHorizontalBorder=new Uy({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,drawOptimization:!0}),n.cellVerticalBorder=new $y({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,drawOptimization:!0}),n.xTableFrozenFullRect=new Ob(cb(n)),n.xLeftFrozenIndex=new wb(cb(n)),n.xTopFrozenIndex=new Sb(cb(n)),n.xTableFrozenContent=new mb(cb(n)),n.xLeftIndex=new Eb(cb(n)),n.xTopIndex=new kb(cb(n)),n.xLeft=new _b(cb(n)),n.xTop=new Tb(cb(n)),n.xContent=new xb(cb(n)),n.merges.sync(),n}return sb(e,t),hb(e,[{key:"drawBorderOptimize",value:function(){var t=this.styleCellsHelper,e=this.xTableAreaView,n=this.cellHorizontalBorder,r=this.cellVerticalBorder,o=e.getScrollView(),i=!0;t.getCellByViewRange({rectRange:o,callback:function(t,e,n){var r=n.borderAttr,o=r.top,c=r.left,l=r.right,s=r.bottom;return o.type===Fi.DOUBLE_LINE?i=!1:c.type===Fi.DOUBLE_LINE?i=!1:l.type===Fi.DOUBLE_LINE?i=!1:s.type!==Fi.DOUBLE_LINE||(i=!1)}}),i?(n.enableOptimization(),r.enableOptimization()):(n.disableOptimization(),r.disableOptimization())}},{key:"getRenderMode",value:function(){return this.renderMode}},{key:"visualWidth",value:function(){return this.el.width}},{key:"visualHeight",value:function(){return this.el.height}},{key:"resize",value:function(){var t=this.draw,e=this.xTableAreaView,n=this.parent().box();t.resize(n.width,n.height),e.undo(),this.reset(),this.render()}},{key:"scrolling",value:function(){var t=this.xTableAreaView;this.reset(),this.renderMode=pb.SCROLL,this.render(),t.record(),this.renderMode=pb.RENDER,this.reset()}},{key:"render",value:function(){var t=this.fixed,e=this.xTableFrozenFullRect,n=this.xLeftFrozenIndex,r=this.xTopFrozenIndex,o=this.xTableFrozenContent,i=this.xLeftIndex,c=this.xTopIndex,l=this.xLeft,s=this.xTop,a=this.xContent;this.drawBorderOptimize(),e.render(),t.fxLeft>-1&&t.fxTop>-1&&o.render(),t.fxTop>-1&&(n.render(),s.render()),t.fxLeft>-1&&(r.render(),l.render()),a.render(),i.render(),c.render()}},{key:"reset",value:function(){var t=this.xTableAreaView,e=this.xLeftFrozenIndex,n=this.xTopFrozenIndex,r=this.xTableFrozenContent,o=this.xLeftIndex,i=this.xTopIndex,c=this.xLeft,l=this.xTop,s=this.xContent;t.reset(),e.reset(),n.reset(),r.reset(),o.reset(),i.reset(),c.reset(),l.reset(),s.reset()}},{key:"setScale",value:function(t){this.draw.attr({fillStyle:this.settings.table.background}),this.draw.fullRect(),this.scale.setValue(t),this.renderMode=pb.SCALE,this.resize(),this.renderMode=pb.RENDER}}]),e}(V);var Pb=function t(e){var n=e.fxTop,r=void 0===n?-1:n,o=e.fxLeft,i=void 0===o?-1:o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fxTop=r,this.fxLeft=i},jb=n(0),Ab=n.n(jb),Lb=n(1),Rb=n.n(Lb),Vb=n(2),Nb=n.n(Vb);function Wb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Db=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.lock=null}var e,n,r;return e=t,(n=[{key:"on",value:function(t){null===this.lock&&(this.lock=t)}},{key:"set",value:function(t,e){if(!this.lock||e===this.lock){var n=this.table;switch(t){case"cell":n.css("cursor","url(".concat(Ab.a,") 7.5 7.5,auto"));break;case"s-resize":n.css("cursor","url(".concat(Rb.a,") 2.5 7.5,auto"));break;case"e-resize":n.css("cursor","url(".concat(Nb.a,") 7.5 2.5,auto"));break;default:n.css("cursor",t)}}}},{key:"off",value:function(t){this.lock===t&&(this.lock=null)}}])&&Wb(e.prototype,n),r&&Wb(e,r),t}();function Hb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Mb=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.bind()}var e,n,o;return e=t,(n=[{key:"register",value:function(t){var e=t.el,n=t.attr,r=void 0===n?{}:n,o=t.stop,i=void 0===o||o,c=t.focus,l=void 0!==c&&c;this.table.focus.register({el:e,attr:r,stop:i,focus:l})}},{key:"bind",value:function(){var t=this.table.focus;Nt.bind(document,r.SYSTEM_EVENT_TYPE.KEY_DOWN,(function(e){var n=t.activate,r=e.keyCode;if(n){var o=n.attr,i=o.key,c=o.code,l=o.callback;i?e[i]&&r===c&&l(e):r===c&&l(e)}9===r&&e.preventDefault()}))}}])&&Hb(e.prototype,n),o&&Hb(e,o),t}();function Bb(t){return(Bb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ib(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yb(t,e){return!e||"object"!==Bb(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fb(t){return(Fb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ub(t,e){return(Ub=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zb=function(t){function e(t){var n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:5};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Yb(this,Fb(e).call(this,"".concat(o,"-re-sizer-horizontal")))).table=t,r.options=i,r.width=i.width,r.hoverEl=C("div","".concat(o,"-re-sizer-hover")),r.lineEl=C("div","".concat(o,"-re-sizer-line")),(n=r).children.apply(n,[r.hoverEl,r.lineEl]),r}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ub(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind(),this.table.focus.register({el:this})}},{key:"getEventLeft",value:function(t){var e=this.table,n=e.cols,r=e.fixed,o=e.scroll,i=e.index,c=e.computeEventXy(t),l=c.x,s=c.y,a=e.getRiCiByXy(l,s),u=a.ri,f=a.ci;if(-1!==u)return{left:-1,x:l,y:s,ri:u,ci:f};var h=i.getWidth()+n.sectionSumWidth(0,f);return f>r.fxLeft&&(h-=o.x),{left:h,x:l,y:s,ri:u,ci:f}}},{key:"bind",value:function(){var t=this,e=this.table,n=e.cols,o=e.mousePointer,i=e.getTableDataSnapshot(),c=i.colsDataProxy,l=e.index,s=r.MOUSE_POINTER_TYPE.COL_RESIZE,a=s.key,u=s.type,f=!1;Nt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){f||(o.on(a),o.set(u,a))})),Nt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){f||o.off(a)})),Nt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(r){f=!0,o.on(a),o.set(u,a);var l=t.getEventLeft(r),s=l.left,h=l.ci,p=s-n.getWidth(h)+n.minWidth,y=e.computeEventXy(r).x;Nt.mouseMoveUp(document,(function(n){var r=e.computeEventXy(n);y=r.x,y-=t.width/2,y=Math.ceil(_.minIf(y,p)),t.css("left","".concat(y,"px")),t.lineEl.css("height","".concat(e.visualHeight(),"px")),t.lineEl.show()}),(function(r){f=!1,o.off(a),t.lineEl.hide(),t.css("left","".concat(y,"px")),e.computeEventXy(r).y<=0&&t.hide();var l=y-(s-n.getWidth(h))+t.width;i.begin(),c.setWidth(h,l),i.end(),e.resize()}))})),Nt.bind(e,r.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(r){if(!f){var o=t.getEventLeft(r),i=o.left,c=o.ci,s=i-n.getWidth(c)+n.minWidth,a=e.visualWidth();i>a&&(i=a),-1===i||s>a||-1===c?t.hide():(t.show(),t.css("left","".concat(i-t.width,"px")),t.hoverEl.css("width","".concat(t.width,"px")),t.hoverEl.css("height","".concat(l.getHeight(),"px")))}})),Nt.bind(e,r.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){f||t.hide()}))}}])&&Ib(n.prototype,i),c&&Ib(n,c),e}(V);function Gb(t){return(Gb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Kb(t,e){return!e||"object"!==Gb(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qb(t){return(qb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $b(t,e){return($b=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zb=function(t){function e(t){var n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{height:5};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Kb(this,qb(e).call(this,"".concat(o,"-re-sizer-vertical")))).table=t,r.options=i,r.height=i.height,r.hoverEl=C("div","".concat(o,"-re-sizer-hover")),r.lineEl=C("div","".concat(o,"-re-sizer-line")),(n=r).children.apply(n,[r.hoverEl,r.lineEl]),r}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$b(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind(),this.table.focus.register({el:this})}},{key:"getEventTop",value:function(t){var e=this.table,n=e.rows,r=e.fixed,o=e.scroll,i=e.index,c=e.computeEventXy(t),l=c.x,s=c.y,a=e.getRiCiByXy(l,s),u=a.ri,f=a.ci;if(-1!==f)return{top:-1,x:l,y:s,ri:u,ci:f};var h=i.getHeight()+n.sectionSumHeight(0,u);return u>r.fxTop&&(h-=o.y),{top:h,x:l,y:s,ri:u,ci:f}}},{key:"bind",value:function(){var t=this,e=this.table,n=e.rows,o=e.mousePointer,i=e.getTableDataSnapshot(),c=i.rowsDataProxy,l=e.index,s=r.MOUSE_POINTER_TYPE.ROW_RESIZE,a=s.key,u=s.type,f=!1;Nt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){f||(o.on(a),o.set(u,a))})),Nt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){f||o.off(a)})),Nt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(r){f=!0,o.on(a),o.set(u,a);var l=t.getEventTop(r),s=l.top,h=l.ri,p=s-n.getHeight(h)+n.minHeight,y=e.computeEventXy(r).y;Nt.mouseMoveUp(document,(function(n){var r=e.computeEventXy(n);y=r.y,y-=t.height/2,y=Math.ceil(_.minIf(y,p)),t.css("top","".concat(y,"px")),t.lineEl.css("width","".concat(e.visualWidth(),"px")),t.lineEl.show()}),(function(r){f=!1,o.off(a),t.lineEl.hide(),t.css("top","".concat(y,"px")),e.computeEventXy(r).x<=0&&t.hide();var l=y-(s-n.getHeight(h))+t.height;i.begin(),c.setHeight(h,l),i.end(),e.resize()}))})),Nt.bind(e,r.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(r){if(!f){var o=t.getEventTop(r),i=o.top,c=o.ri,s=i-n.getHeight(c)+n.minHeight,a=e.visualHeight();i>a&&(i=a),-1===i||s>a||-1===c?t.hide():(t.show(),t.css("top","".concat(i-t.height,"px")),t.hoverEl.css("width","".concat(l.getWidth(),"px")),t.hoverEl.css("height","".concat(t.height,"px")))}})),Nt.bind(e,r.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){f||t.hide()}))}}])&&Xb(n.prototype,i),c&&Xb(n,c),e}(V);function Jb(t){return(Jb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function td(t,e){return!e||"object"!==Jb(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ed(t){return(ed=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nd(t,e){return(nd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rd=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=td(this,ed(e).call(this,"".concat(o,"-table-x-height-light")))).table=t,n.setSize(),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nd(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind(),this.hide()}},{key:"disjoint",value:function(t,e){return t.sci>e.eci||e.sci>t.eci}},{key:"coincide",value:function(t,e){return this.disjoint(t,e)?new ta(0,-1,0,-1):new ta(0,e.sci>t.sci?e.sci:t.sci,0,e.eci<t.eci?e.eci:t.eci)}},{key:"setChangeSize",value:function(){var t=this.table.screenSelector;if(t){var e=t.selectorAttr;if(e){var n=t.getIntersectsArea(e);this.offsetHeightLight(e,n)}}}},{key:"setSize",value:function(){var t=this.table.index;this.css("height","".concat(t.getHeight(),"px")),this.setChangeSize()}},{key:"offsetHeightLight",value:function(t,e){var n=this.table,r=n.index,o=new ta(0,-1,0,-1);switch(this.hide(),e){case"lt":var i=t.rect,c=n.xTableFrozenContent,l=n.cols,s=c.getScrollView(),a=this.coincide(i,s);if(!o.equals(a)){var u=l.sectionSumWidth(a.sci,a.eci),f=l.sectionSumWidth(s.sci,a.sci-1)+r.getWidth();"".concat(u,"px")!==this.css("width")&&this.css("width","".concat(u,"px")),"".concat(f,"px")!==this.css("left")&&this.css("left","".concat(f,"px")),this.show()}break;case"t":var h=t.rect,p=n.xTop,y=n.cols,b=p.getScrollView(),d=this.coincide(h,b);if(!o.equals(d)){var g=y.sectionSumWidth(d.sci,d.eci),v=y.sectionSumWidth(b.sci,d.sci-1)+n.getFixedWidth()+r.getWidth();"".concat(g,"px")!==this.css("width")&&this.css("width","".concat(g,"px")),"".concat(v,"px")!==this.css("left")&&this.css("left","".concat(v,"px")),this.show()}break;case"br":var w=t.rect,m=n.cols,S=n.getScrollView(),O=this.coincide(w,S);if(!o.equals(O)){var E=m.sectionSumWidth(O.sci,O.eci),_=m.sectionSumWidth(S.sci,O.sci-1)+n.getFixedWidth()+r.getWidth();"".concat(E,"px")!==this.css("width")&&this.css("width","".concat(E,"px")),"".concat(_,"px")!==this.css("left")&&this.css("left","".concat(_,"px")),this.show()}break;case"l":var x=t.rect,T=n.xLeft,k=n.cols,C=T.getScrollView(),P=this.coincide(x,C);if(!o.equals(P)){var j=k.sectionSumWidth(P.sci,P.eci),A=k.sectionSumWidth(C.sci,P.sci-1)+r.getWidth();"".concat(j,"px")!==this.css("width")&&this.css("width","".concat(j,"px")),"".concat(A,"px")!==this.css("left")&&this.css("left","".concat(A,"px")),this.show()}break;case"ltt":var L=t.rect,R=n.xTableFrozenContent,V=n.xTop,N=n.cols,W=R.getScrollView(),D=V.getScrollView(),H=this.coincide(L,W),M=this.coincide(L,D),B=0,I=N.sectionSumWidth(W.sci,H.sci-1)+r.getWidth();o.equals(H)||(B+=N.sectionSumWidth(H.sci,H.eci)),o.equals(M)||(B+=N.sectionSumWidth(M.sci,M.eci)),"".concat(B,"px")!==this.css("width")&&this.css("width","".concat(B,"px")),"".concat(I,"px")!==this.css("left")&&this.css("left","".concat(I,"px")),this.show();break;case"ltl":var Y=t.rect,F=n.xTableFrozenContent,U=n.cols,z=F.getScrollView(),G=this.coincide(Y,z);if(!o.equals(G)){var X=U.sectionSumWidth(G.sci,G.eci),K=U.sectionSumWidth(z.sci,G.sci-1)+r.getWidth();"".concat(X,"px")!==this.css("width")&&this.css("width","".concat(X,"px")),"".concat(K,"px")!==this.css("left")&&this.css("left","".concat(K,"px")),this.show()}break;case"tbr":var q=t.rect,$=n.xTop,Z=n.cols,J=$.getScrollView(),Q=this.coincide(q,J);if(!o.equals(Q)){var tt=Z.sectionSumWidth(Q.sci,Q.eci),et=Z.sectionSumWidth(J.sci,Q.sci-1)+n.getFixedWidth()+r.getWidth();"".concat(tt,"px")!==this.css("width")&&this.css("width","".concat(tt,"px")),"".concat(et,"px")!==this.css("left")&&this.css("left","".concat(et,"px")),this.show()}break;case"lbr":var nt=t.rect,rt=n.xLeft,ot=n.cols,it=rt.getScrollView(),ct=n.getScrollView(),lt=this.coincide(nt,it),st=this.coincide(nt,ct),at=0,ut=ot.sectionSumWidth(it.sci,lt.sci-1)+r.getWidth();o.equals(lt)||(at+=ot.sectionSumWidth(lt.sci,lt.eci)),o.equals(st)||(at+=ot.sectionSumWidth(st.sci,st.eci)),"".concat(at,"px")!==this.css("width")&&this.css("width","".concat(at,"px")),"".concat(ut,"px")!==this.css("left")&&this.css("left","".concat(ut,"px")),this.show();break;case"lttlbr":var ft=t.rect,ht=n.xTableFrozenContent,pt=n.xTop,yt=n.cols,bt=ht.getScrollView(),dt=pt.getScrollView(),gt=this.coincide(ft,bt),vt=this.coincide(ft,dt),wt=0,mt=yt.sectionSumWidth(bt.sci,gt.sci-1)+r.getWidth();o.equals(gt)||(wt+=yt.sectionSumWidth(gt.sci,gt.eci)),o.equals(vt)||(wt+=yt.sectionSumWidth(vt.sci,vt.eci)),"".concat(wt,"px")!==this.css("width")&&this.css("width","".concat(wt,"px")),"".concat(mt,"px")!==this.css("left")&&this.css("left","".concat(mt,"px")),this.show()}}},{key:"bind",value:function(){var t=this,e=this.table,n=e.screenSelector;Nt.bind(e,r.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.setChangeSize()})),n.on(ga.CHANGE,(function(){t.setChangeSize()}))}}])&&Qb(n.prototype,i),c&&Qb(n,c),e}(V);function od(t){return(od="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function id(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function cd(t,e){return!e||"object"!==od(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ld(t){return(ld=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sd(t,e){return(sd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ad=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=cd(this,ld(e).call(this,"".concat(o,"-table-y-height-light")))).table=t,n.setSize(),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sd(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind(),this.hide()}},{key:"disjoint",value:function(t,e){return t.sri>e.eri||e.sri>t.eri}},{key:"coincide",value:function(t,e){return this.disjoint(t,e)?new ta(-1,0,-1,0):new ta(e.sri>t.sri?e.sri:t.sri,0,e.eri<t.eri?e.eri:t.eri,0)}},{key:"setChangeSize",value:function(){var t=this.table.screenSelector;if(t){var e=t.selectorAttr;if(e){var n=t.getIntersectsArea(e);this.offsetHeightLight(e,n)}}}},{key:"setSize",value:function(){var t=this.table.index;this.css("width","".concat(t.getWidth(),"px"))}},{key:"offsetHeightLight",value:function(t,e){var n=this.table,r=n.index,o=new ta(-1,0,-1,0);switch(this.hide(),e){case"lt":var i=t.rect,c=n.xTableFrozenContent,l=n.rows,s=c.getScrollView(),a=this.coincide(i,s);if(!o.equals(a)){var u=l.sectionSumHeight(a.sri,a.eri),f=l.sectionSumHeight(s.sri,a.sri-1)+r.getHeight();"".concat(u,"px")!==this.css("height")&&this.css("height","".concat(u,"px")),"".concat(f,"px")!==this.css("top")&&this.css("top","".concat(f,"px")),this.show()}break;case"t":var h=t.rect,p=n.xTop,y=n.rows,b=p.getScrollView(),d=this.coincide(h,b);if(!o.equals(d)){var g=y.sectionSumHeight(d.sri,d.eri),v=y.sectionSumHeight(b.sri,d.sri-1)+r.getHeight();"".concat(g,"px")!==this.css("height")&&this.css("height","".concat(g,"px")),"".concat(v,"px")!==this.css("top")&&this.css("top","".concat(v,"px")),this.show()}break;case"l":var w=t.rect,m=n.xLeft,S=n.rows,O=m.getScrollView(),E=this.coincide(w,O);if(!o.equals(E)){var _=S.sectionSumHeight(E.sri,E.eri),x=S.sectionSumHeight(O.sri,E.sri-1)+n.getFixedHeight()+r.getHeight();"".concat(_,"px")!==this.css("height")&&this.css("height","".concat(_,"px")),"".concat(x,"px")!==this.css("top")&&this.css("top","".concat(x,"px")),this.show()}break;case"br":var T=t.rect,k=n.rows,C=n.getScrollView(),P=this.coincide(T,C);if(!o.equals(P)){var j=k.sectionSumHeight(P.sri,P.eri),A=k.sectionSumHeight(C.sri,P.sri-1)+n.getFixedHeight()+r.getHeight();"".concat(j,"px")!==this.css("height")&&this.css("height","".concat(j,"px")),"".concat(A,"px")!==this.css("top")&&this.css("top","".concat(A,"px")),this.show()}break;case"ltt":var L=t.rect,R=n.xTableFrozenContent,V=n.rows,N=R.getScrollView(),W=this.coincide(L,N);if(!o.equals(W)){var D=V.sectionSumHeight(N.sri,W.sri-1)+r.getHeight(),H=V.sectionSumHeight(W.sri,W.eri);"".concat(H,"px")!==this.css("height")&&this.css("height","".concat(H,"px")),"".concat(D,"px")!==this.css("top")&&this.css("top","".concat(D,"px")),this.show()}break;case"ltl":var M=t.rect,B=n.xTableFrozenContent,I=n.xLeft,Y=n.rows,F=B.getScrollView(),U=I.getScrollView(),z=this.coincide(M,F),G=this.coincide(M,U),X=Y.sectionSumHeight(F.sri,z.sri-1)+r.getHeight(),K=0;o.equals(z)||(K+=Y.sectionSumHeight(z.sri,z.eri)),o.equals(G)||(K+=Y.sectionSumHeight(G.sri,G.eri)),"".concat(K,"px")!==this.css("height")&&this.css("height","".concat(K,"px")),"".concat(X,"px")!==this.css("top")&&this.css("top","".concat(X,"px")),this.show();break;case"tbr":var q=t.rect,$=n.xTop,Z=n.rows,J=$.getScrollView(),Q=n.getScrollView(),tt=this.coincide(q,J),et=this.coincide(q,Q),nt=Z.sectionSumHeight(J.sri,tt.sri-1)+r.getHeight(),rt=0;o.equals(tt)||(rt+=Z.sectionSumHeight(tt.sri,tt.eri)),o.equals(et)||(rt+=Z.sectionSumHeight(et.sri,et.eri)),"".concat(rt,"px")!==this.css("height")&&this.css("height","".concat(rt,"px")),"".concat(nt,"px")!==this.css("top")&&this.css("top","".concat(nt,"px")),this.show();break;case"lbr":var ot=t.rect,it=n.xLeft,ct=n.rows,lt=it.getScrollView(),st=this.coincide(ot,lt);if(!o.equals(st)){var at=ct.sectionSumHeight(st.sri,st.eri),ut=ct.sectionSumHeight(lt.sri,st.sri-1)+n.getFixedHeight()+r.getHeight();"".concat(at,"px")!==this.css("height")&&this.css("height","".concat(at,"px")),"".concat(ut,"px")!==this.css("top")&&this.css("top","".concat(ut,"px")),this.show()}break;case"lttlbr":var ft=t.rect,ht=n.xTableFrozenContent,pt=n.xLeft,yt=n.rows,bt=ht.getScrollView(),dt=pt.getScrollView(),gt=this.coincide(ft,bt),vt=this.coincide(ft,dt),wt=0,mt=yt.sectionSumHeight(bt.sri,gt.sri-1)+r.getHeight();o.equals(gt)||(wt+=yt.sectionSumHeight(gt.sri,gt.eri)),o.equals(vt)||(wt+=yt.sectionSumHeight(vt.sri,vt.eri)),"".concat(wt,"px")!==this.css("height")&&this.css("height","".concat(wt,"px")),"".concat(mt,"px")!==this.css("top")&&this.css("top","".concat(mt,"px")),this.show()}}},{key:"bind",value:function(){var t=this,e=this.table,n=e.screenSelector;Nt.bind(e,r.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.setChangeSize()})),n.on(ga.CHANGE,(function(){t.setChangeSize()}))}}])&&id(n.prototype,i),c&&id(n,c),e}(V);function ud(t){return(ud="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hd(t,e){return!e||"object"!==ud(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pd(t){return(pd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yd(t,e){return(yd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bd=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=hd(this,pd(e).call(this,"".concat(o,"-screen-element ").concat(t)))).widgets=[],n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yd(t,e)}(e,t),n=e,(r=[{key:"addWidget",value:function(t){this.widgets.push(t),this.children(t)}}])&&fd(n.prototype,r),i&&fd(n,i),e}(V);function dd(t){return(dd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vd(t,e){return!e||"object"!==dd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wd(t){return(wd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function md(t,e){return(md=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Sd=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=vd(this,wd(e).call(this,"".concat(o,"-screen")))).table=t,n.widgets=[],n.lt=new bd("".concat(o,"-screen-element-lt")),n.t=new bd("".concat(o,"-screen-element-t")),n.l=new bd("".concat(o,"-screen-element-l")),n.br=new bd("".concat(o,"-screen-element-br")),n.children(n.lt,n.t,n.l,n.br),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&md(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind(),this.setDivideLayer()}},{key:"init",value:function(){}},{key:"bind",value:function(){var t=this,e=this.table;Nt.bind(window,r.SYSTEM_EVENT_TYPE.RESIZE,(function(){t.setDivideLayer()})),Nt.bind(e,r.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.setDivideLayer()})),Nt.bind(e,r.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.setDivideLayer()}))}},{key:"addWidget",value:function(t){this.widgets.push(t),this.lt.addWidget(t.getLT(this)),this.t.addWidget(t.getT(this)),this.l.addWidget(t.getL(this)),this.br.addWidget(t.getBR(this))}},{key:"setDivideLayer",value:function(){var t=this.table,e=t.grid,n=t.index,r=t.getFixedWidth(),o=t.getFixedHeight(),i=n.getWidth()+r,c=n.getHeight()+o;this.br.offset({left:i,top:c}),r>0&&o>0?(this.lt.offset({left:n.getWidth(),top:n.getHeight(),width:r,height:o}).show(),this.lt.css("border-width","".concat(e.lineWidth(),"px"))):this.lt.hide(),r>0?(this.l.offset({left:n.getWidth(),top:c,width:r}).show(),this.l.css("border-width","".concat(e.lineWidth(),"px"))):this.l.hide(),o>0?(this.t.offset({left:i,top:n.getHeight(),height:o}).show(),this.t.css("border-width","".concat(e.lineWidth(),"px"))):this.t.hide()}},{key:"findByClass",value:function(t){var e=null;return this.widgets.forEach((function(n){return!(n instanceof t&&(e=n,1))})),e}}])&&gd(n.prototype,i),c&&gd(n,c),e}(V);function Od(t){return(Od="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ed(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _d(t,e){return!e||"object"!==Od(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xd(t){return(xd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Td(t,e){return(Td=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kd=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=_d(this,xd(e).call(this,"".concat(o,"-table-edit")))).input=C("div","".concat(o,"-table-edit-input")),n.input.attr("contenteditable",!0),n.input.html("<p>&nbsp;</p>"),n.table=t,n.text="",n.select=null,n.children(n.input),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Td(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind(),this.hide()}},{key:"bind",value:function(){var t=this,e=this.table,n=e.screenSelector;Nt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){t.stopPropagation()})),Nt.bind(this.input,r.SYSTEM_EVENT_TYPE.INPUT,(function(){var e=t.input;_.isBlank(t.input.text())&&e.html("<p>&nbsp;</p>"),t.text=e.text()})),Nt.bind(e,r.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.hideEdit()})),Nt.bind(e,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.hideEdit()})),Nt.dbClick([n.lt,n.t,n.l,n.br],(function(){t.showEdit()}))}},{key:"showEdit",value:function(){var t=this.table,e=this.input,n=t.screen,r=t.getTableCells(),o=n.findByClass(va).selectorAttr;if(o){var i=o.rect,c=r.getCellOrNew(i.sri,i.sci);this.select=i,this.editOffset(i),this.text=c.text,_.isBlank(this.text)?e.html("<p>&nbsp;</p>"):e.text(this.text),_.keepLastIndex(this.input.el)}}},{key:"hideEdit",value:function(){var t=this.select,e=this.table,n=e.getTableCells(),r=e.getTableDataSnapshot(),o=r.cellDataProxy;if(t){var i=n.getCellOrNew(t.sri,t.sci).clone(),c=_.trim(this.text);i.text!==c&&(r.begin(),i.text=c,o.setCell(t.sri,t.sci,i),r.end(),e.render()),this.select=null}this.hide()}},{key:"editOffset",value:function(){var t=this.table,e=t.screen.findByClass(va),n=e.selectorAttr,r=n.rect,o=t.cols,i=t.rows;switch(e.getIntersectsArea(n)){case"lt":var c=t.xTableFrozenContent.getScrollView(),l=r.coincide(c);if(new ta(-1,-1,-1,-1).equals(l))return void this.hide();var s=o.sectionSumWidth(l.sci,l.eci)-6,a=i.sectionSumHeight(l.sri,l.eri)-6,u=i.sectionSumHeight(c.sri,l.sri-1),f=o.sectionSumWidth(c.sci,l.sci-1);u+=t.getIndexHeight()+3,f+=t.getIndexWidth()+3,this.offset({width:s,height:a,top:u,left:f}).show();break;case"t":var h=t.xTop.getScrollView(),p=r.coincide(h);if(new ta(-1,-1,-1,-1).equals(p))return void this.hide();var y=o.sectionSumWidth(p.sci,p.eci)-6,b=i.sectionSumHeight(p.sri,p.eri)-6,d=i.sectionSumHeight(h.sri,p.sri-1),g=o.sectionSumWidth(h.sci,p.sci-1);d+=t.getIndexHeight()+3,g+=t.getFixedWidth()+t.getIndexWidth()+3,this.offset({width:y,height:b,top:d,left:g}).show();break;case"br":var v=t.getScrollView(),w=r.coincide(v);if(new ta(-1,-1,-1,-1).equals(w))return void this.hide();var m=o.sectionSumWidth(w.sci,w.eci)-6,S=i.sectionSumHeight(w.sri,w.eri)-6,O=i.sectionSumHeight(v.sri,w.sri-1),E=o.sectionSumWidth(v.sci,w.sci-1);O+=t.getFixedHeight()+t.getIndexHeight()+3,E+=t.getFixedWidth()+t.getIndexWidth()+3,this.offset({width:m,height:S,top:O,left:E}).show();break;case"l":var _=t.xLeft.getScrollView(),x=r.coincide(_);if(new ta(-1,-1,-1,-1).equals(x))return void this.hide();var T=o.sectionSumWidth(x.sci,x.eci)-6,k=i.sectionSumHeight(x.sri,x.eri)-6,C=i.sectionSumHeight(_.sri,x.sri-1),P=o.sectionSumWidth(_.sci,x.sci-1);C+=t.getFixedHeight()+t.getIndexHeight()+3,P+=t.getIndexWidth()+3,this.offset({width:T,height:k,top:C,left:P}).show();break;case"ltt":var j=t.xTableFrozenContent,A=t.xTop,L=j.getScrollView(),R=r.coincide(L),V=A.getScrollView(),N=r.coincide(V),W=new ta(-1,-1,-1,-1);if(W.equals(N)&&W.equals(R))return void this.hide();var D=o.sectionSumWidth(R.sci,R.eci),H=i.sectionSumHeight(R.sri,R.eri),M=i.sectionSumHeight(L.sri,R.sri-1),B=o.sectionSumWidth(L.sci,R.sci-1),I=o.sectionSumWidth(N.sci,N.eci);this.offset({width:D+I-6,height:H-6,top:M+t.getIndexHeight()+3,left:B+t.getIndexWidth()+3}).show();break;case"ltl":var Y=t.xTableFrozenContent,F=t.xLeft,U=Y.getScrollView(),z=r.coincide(U),G=F.getScrollView(),X=r.coincide(G),K=new ta(-1,-1,-1,-1);if(K.equals(z)&&K.equals(X))return void this.hide();var q=o.sectionSumWidth(z.sci,z.eci),$=i.sectionSumHeight(z.sri,z.eri),Z=i.sectionSumHeight(X.sri,X.eri),J=i.sectionSumHeight(U.sri,z.sri-1),Q=o.sectionSumWidth(U.sci,z.sci-1);J+=t.getIndexHeight()+3,Q+=t.getIndexWidth()+3,this.offset({width:q-6,height:$+Z-6,top:J,left:Q}).show();break;case"tbr":var tt=t.xTop,et=t.getScrollView(),nt=r.coincide(et),rt=tt.getScrollView(),ot=r.coincide(rt),it=new ta(-1,-1,-1,-1);if(it.equals(nt)&&it.equals(ot))return void this.hide();var ct=o.sectionSumWidth(ot.sci,ot.eci),lt=i.sectionSumHeight(ot.sri,ot.eri),st=i.sectionSumHeight(rt.sri,ot.sri-1),at=o.sectionSumWidth(rt.sci,ot.sci-1),ut=i.sectionSumHeight(nt.sri,nt.eri);this.offset({width:ct-6,height:ut+lt-6,top:st+t.getIndexHeight()+3,left:at+t.getFixedWidth()+t.getIndexWidth()+3}).show();break;case"lbr":var ft=t.xLeft,ht=t.getScrollView(),pt=r.coincide(ht),yt=ft.getScrollView(),bt=r.coincide(yt),dt=new ta(-1,-1,-1,-1);if(dt.equals(pt)&&dt.equals(bt))return void this.hide();var gt=o.sectionSumWidth(bt.sci,bt.eci),vt=i.sectionSumHeight(bt.sri,bt.eri),wt=i.sectionSumHeight(yt.sri,bt.sri-1),mt=o.sectionSumWidth(yt.sci,bt.sci-1),St=o.sectionSumWidth(pt.sci,pt.eci);this.offset({width:gt+St-6,height:vt-6,top:wt+t.getFixedHeight()+t.getIndexHeight()+3,left:mt+t.getIndexWidth()+3}).show();break;case"lttlbr":var Ot=t.xTableFrozenContent.getScrollView(),Et=r.coincide(Ot),_t=t.xTop.getScrollView(),xt=r.coincide(_t),Tt=t.xLeft.getScrollView(),kt=r.coincide(Tt),Ct=new ta(-1,-1,-1,-1);if(Ct.equals(Et)&&Ct.equals(xt)&&Ct.equals(kt))return void this.hide();var Pt=o.sectionSumWidth(Et.sci,Et.eci),jt=i.sectionSumHeight(Et.sri,Et.eri),At=o.sectionSumWidth(xt.sci,xt.eci),Lt=i.sectionSumHeight(kt.sri,kt.eri),Rt=i.sectionSumHeight(Ot.sri,Et.sri-1),Vt=o.sectionSumWidth(Ot.sci,Et.sci-1);this.offset({width:Pt+At-6,height:jt+Lt-6,top:Rt+t.getIndexHeight()+3,left:Vt+t.getIndexWidth()+3}).show()}}}])&&Ed(n.prototype,i),c&&Ed(n,c),e}(V);function Cd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Pd=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.pool=[],this.activate=null}var e,n,o;return e=t,(n=[{key:"findByEl",value:function(t){for(var e=0;e<this.pool.length;e+=1){var n=this.pool[e];if(n.el===t)return n}return null}},{key:"register",value:function(t){var e=this,n=t.el,o=t.attr,i=void 0===o?{}:o,c=t.stop,l=void 0===c||c,s=t.focus,a=void 0!==s&&s,u=this.findByEl(n);if(u)Object.assign(u.attr,i);else{var f={el:n,attr:i};this.pool.push(f),a&&(this.activate=f),Nt.bind(n,r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){e.activate=f,l&&t.stopPropagation()}))}}}])&&Cd(e.prototype,n),o&&Cd(e,o),t}();function jd(t){return(jd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ad(t,e){return!e||"object"!==jd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ld(t){return(Ld=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rd(t,e){return(Rd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vd=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ad(this,Ld(e).call(this,"".concat(o,"-autofill")))).areaEl=C("div","".concat(o,"-autofill-area")),t.children(t.areaEl),t.hide(),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rd(t,e)}(e,t),e}(V);function Nd(t){return(Nd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wd(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Dd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Hd(t,e){return!e||"object"!==Nd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Md(t){return(Md=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bd(t,e){return(Bd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Id=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Hd(this,Md(e).call(this,t))).options=_.mergeDeep({mergeForceSplit:!1,onBeforeAutoFill:function(){},onAfterAutoFill:function(){}},r),n.lt=new Vd,n.t=new Vd,n.l=new Vd,n.br=new Vd,n.autoFillAttr=null,n.bind(),n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bd(t,e)}(e,t),n=e,(o=[{key:"bind",value:function(){var t=this,e=this.screen.table,n=e.mousePointer,o=e.screenSelector,i=r.MOUSE_POINTER_TYPE.AUTO_FILL,c=i.key,l=i.type;Nt.bind([o.lt.cornerEl,o.t.cornerEl,o.l.cornerEl,o.br.cornerEl],r.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(r){n.on(c),n.set(l,c),Nt.mouseMoveUp(document,(function(n){var r=e.computeEventXy(n),o=r.x,i=r.y,c=t.getMoveAutoFillAttr(o,i);c?t.setOffset(c):(t.lt.hide(),t.t.hide(),t.l.hide(),t.br.hide()),t.autoFillAttr=c}),(function(){n.off(c),t.lt.hide(),t.t.hide(),t.l.hide(),t.br.hide(),t.autoFillAttr&&(t.autoFillTo(),e.render())})),r.stopPropagation()})),Nt.bind([o.lt.cornerEl,o.t.cornerEl,o.l.cornerEl,o.br.cornerEl],r.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){n.on(c),n.set(l,c)})),Nt.bind([o.lt.cornerEl,o.t.cornerEl,o.l.cornerEl,o.br.cornerEl],r.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){n.off(c)}))}},{key:"setLTOffset",value:function(t){var e=this.screen.table,n=e.xTableFrozenContent,r=e.cols,o=e.rows,i=n.getScrollView(),c=t.rect,l=new ta(-1,-1,-1,-1),s=c.coincide(i);if(l.equals(s))this.lt.hide();else{var a=r.sectionSumWidth(s.sci,s.eci),u=o.sectionSumHeight(s.sri,s.eri),f=o.sectionSumHeight(i.sri,s.sri-1),h=r.sectionSumWidth(i.sci,s.sci-1);c.eci>i.eci?this.lt.areaEl.css("border-right","none"):this.lt.areaEl.cssRemoveKeys("border-right"),c.eri>i.eri?this.lt.areaEl.css("border-bottom","none"):this.lt.areaEl.cssRemoveKeys("border-bottom"),this.lt.offset({width:a,height:u,left:h,top:f}).show()}}},{key:"setTOffset",value:function(t){var e=this.screen.table,n=e.xTop,r=e.cols,o=e.rows,i=n.getScrollView(),c=t.rect,l=new ta(-1,-1,-1,-1),s=c.coincide(i);if(l.equals(s))this.t.hide();else{var a=r.sectionSumWidth(s.sci,s.eci),u=o.sectionSumHeight(s.sri,s.eri),f=o.sectionSumHeight(i.sri,s.sri-1),h=r.sectionSumWidth(i.sci,s.sci-1);c.sci<i.sci?this.t.areaEl.css("border-left","none"):this.t.areaEl.cssRemoveKeys("border-left"),c.eri>i.eri?this.t.areaEl.css("border-bottom","none"):this.t.areaEl.cssRemoveKeys("border-bottom"),c.eci>i.eci?this.t.areaEl.css("border-right","none"):this.t.areaEl.cssRemoveKeys("border-right"),this.t.offset({width:a,height:u,left:h,top:f}).show()}}},{key:"setLOffset",value:function(t){var e=this.screen.table,n=e.xLeft,r=e.cols,o=e.rows,i=n.getScrollView(),c=t.rect,l=new ta(-1,-1,-1,-1),s=c.coincide(i);if(l.equals(s))this.l.hide();else{var a=r.sectionSumWidth(s.sci,s.eci),u=o.sectionSumHeight(s.sri,s.eri),f=o.sectionSumHeight(i.sri,s.sri-1),h=r.sectionSumWidth(i.sci,s.sci-1);c.sri<i.sri?this.l.areaEl.css("border-top","none"):this.l.areaEl.cssRemoveKeys("border-top"),c.eci>i.eci?this.l.areaEl.css("border-right","none"):this.l.areaEl.cssRemoveKeys("border-right"),c.eri>i.eri?this.l.areaEl.css("border-bottom","none"):this.l.areaEl.cssRemoveKeys("border-bottom"),this.l.offset({width:a,height:u,left:h,top:f}).show()}}},{key:"setBROffset",value:function(t){var e=this.screen.table,n=e.cols,r=e.rows,o=e.getScrollView(),i=t.rect,c=new ta(-1,-1,-1,-1),l=i.coincide(o);if(c.equals(l))this.br.hide();else{var s=n.sectionSumWidth(l.sci,l.eci),a=r.sectionSumHeight(l.sri,l.eri),u=r.sectionSumHeight(o.sri,l.sri-1),f=n.sectionSumWidth(o.sci,l.sci-1);i.sci<o.sci?this.br.areaEl.css("border-left","none"):this.br.areaEl.cssRemoveKeys("border-left"),i.sri<o.sri?this.br.areaEl.css("border-top","none"):this.br.areaEl.cssRemoveKeys("border-top"),i.eri>o.eri?this.br.areaEl.css("border-bottom","none"):this.br.areaEl.cssRemoveKeys("border-bottom"),i.eci>o.eci?this.br.areaEl.css("border-right","none"):this.br.areaEl.cssRemoveKeys("border-right"),this.br.offset({width:s,height:a,left:f,top:u}).show()}}},{key:"setOffset",value:function(t){this.setLTOffset(t),this.setTOffset(t),this.setLOffset(t),this.setBROffset(t)}},{key:"getMoveAutoFillAttr",value:function(t,e){var n=this.screen.table,r=n.screenSelector.selectorAttr,o=n.cols,i=n.rows,c=n.getTableMerges(),l=r.rect,s=r.edge,a=r.edgeType,u=s||null!=c.getFirstIncludes(l.sri,l.sci),f=Wd(l.size(),2),h=f[0],p=f[1],y=n.getRiCiByXy(t,e),b=y.ri,d=y.ci;b<0?b=0:b>i.len&&(b=i.len-1),d<0?d=0:d>o.len&&(d=o.len-1);var g,v,w=l.sri,m=l.sci,S=l.eri,O=l.eci;if("left"===a&&(O=o.len-1),"top"===a&&(S=i.len-1),b<w||b>S){if(b<w)if(g="top",u){var E=w-h;if(E>=0){for(var _=w-1-b,x=1;x<=_;x+=1)x%h==0&&E-h>=0&&(E-=h);v=new ta(E,m,w-1,O)}}else v=new ta(b,m,w-1,O);if(b>S)if(g="bottom",u){var T=S+h;if(T<=i.len-1){for(var k=b-(S+1),C=1;C<=k;C+=1)C%h==0&&T+h<=i.len-1&&(T+=h);v=new ta(S+1,m,T,O)}}else v=new ta(S+1,m,b,O)}else if(d<m||d>O){if(d<m)if(g="left",u){var P=m-p;if(P>=0){for(var j=m-1-d,A=1;A<=j;A+=1)A%p==0&&P-p>=0&&(P-=p);v=new ta(w,P,S,m-1)}}else v=new ta(w,d,S,m-1);if(d>O)if(g="right",u){var L=O+p;if(L<=o.len-1){for(var R=d-(O+1),V=1;V<=R;V+=1)V%p==0&&L+p<=o.len-1&&(L+=p);v=new ta(w,O+1,S,L)}}else v=new ta(w,O+1,S,d)}if(v){var N=o.sectionSumWidth(v.sci,v.eci),W=i.sectionSumHeight(v.sri,v.eri);return v.w=N,v.h=W,{rect:v,direction:g}}return null}},{key:"copyContent",value:function(){for(var t=this.screen.table,e=t.screenSelector,n=t.getTableCells(),r=t.getTableDataSnapshot().cellDataProxy,o=this.autoFillAttr,i=e.selectorAttr,c=o.rect,l=i.rect,s=l.sri,a=c.sri;a<=c.eri;){for(var u=l.sci,f=c.sci;f<=c.eci;){var h=n.getCell(s,u);if(h){var p=h.clone();r.setCell(a,f,p)}f+=1,(u+=1)>l.eci&&(u=l.sci)}a+=1,(s+=1)>l.eri&&(s=l.sri)}}},{key:"splitMerge",value:function(){var t=this.screen.table,e=t.getTableMerges(),n=t.getTableDataSnapshot().mergeDataProxy;this.autoFillAttr.rect.each((function(t,r){var o=e.getFirstIncludes(t,r);o&&n.deleteMerge(o)}))}},{key:"copyMerge",value:function(){var t=this.screen.table,e=t.screenSelector,n=t.getTableMerges(),r=t.getTableDataSnapshot().mergeDataProxy,o=this.autoFillAttr,i=e.selectorAttr,c=o.rect,l=o.direction,s=i.rect,a=i.edge,u=s.sri,f=c.sri;if(!a||"top"!==l&&"left"!==l)for(;f<=c.eri;){for(var h=s.sci,p=c.sci;p<=c.eci;){var y=n.getFirstIncludes(u,h);if(y&&y.sri===u&&y.sci===h){var b=Wd(y.size(),2),d=b[0],g=b[1],v=new ta(f,p,f+(d-=1),p+(g-=1));r.addMerge(v)}p+=1,(h+=1)>s.eci&&(h=s.sci)}f+=1,(u+=1)>s.eri&&(u=s.sri)}}},{key:"autoFillTo",value:function(){this.options.onBeforeAutoFill(),this.splitMerge(),this.copyContent(),this.copyMerge(),this.options.onAfterAutoFill()}}])&&Dd(n.prototype,o),i&&Dd(n,i),e}(Zs);function Yd(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Fd(t){return(Fd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ud(t,e){return!e||"object"!==Fd(e)&&"function"!=typeof e?zd(t):e}function zd(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gd(t){return(Gd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xd(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kd(t,e)}function Kd(t,e){return(Kd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function qd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zd(t,e,n){return e&&$d(t.prototype,e),n&&$d(t,n),t}var Jd=function(){function t(e){qd(this,t),this.table=e,this.scrollView=null,this.width=null,this.height=null,this.x=null,this.y=null}return Zd(t,[{key:"reset",value:function(){this.scrollView=null,this.width=null,this.height=null,this.x=null,this.y=null}},{key:"getX",value:function(){throw new TypeError("child impl")}},{key:"getY",value:function(){throw new TypeError("child impl")}},{key:"getHeight",value:function(){throw new TypeError("child impl")}},{key:"getWidth",value:function(){throw new TypeError("child impl")}}]),t}(),Qd=function(t){function e(){return qd(this,e),Ud(this,Gd(e).apply(this,arguments))}return Xd(e,t),Zd(e,[{key:"getWidth",value:function(){if(_.isNumber(this.width))return this.width;var t=this.table,e=t.fixed,n=t.rows.sectionSumHeight(0,e.fxLeft);return this.width=n,n}},{key:"getHeight",value:function(){if(_.isNumber(this.height))return this.height;var t=this.table,e=t.fixed,n=t.rows.sectionSumHeight(0,e.fxTop);return this.height=n,n}},{key:"getX",value:function(){if(_.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(_.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}},{key:"getScrollView",value:function(){if(_.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.rows,n=t.cols,r=t.fixed,o=new ta(0,0,r.fxTop,r.fxLeft);return o.w=n.rectRangeSumWidth(o),o.h=e.rectRangeSumHeight(o),this.scrollView=o,o.clone()}}]),e}(Jd),tg=function(t){function e(){return qd(this,e),Ud(this,Gd(e).apply(this,arguments))}return Xd(e,t),Zd(e,[{key:"getWidth",value:function(){if(_.isNumber(this.width))return this.width;var t=this.table,e=t.xLeft,n=t.index,r=t.visualWidth()-(n.getWidth()+e.getWidth());return this.width=r,r}},{key:"getHeight",value:function(){if(_.isNumber(this.height))return this.height;var t=this.table.index.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(_.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,n=t.index.getWidth()+e.getWidth();return this.x=n,n}},{key:"getY",value:function(){if(_.isNumber(this.y))return this.y;return this.y=0,0}},{key:"getScrollView",value:function(){if(_.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.index,n=t.xTableAreaView.getScrollView();return n.sri=0,n.eri=0,n.h=e.getHeight(),this.scrollView=n,n.clone()}}]),e}(Jd),eg=function(t){function e(){return qd(this,e),Ud(this,Gd(e).apply(this,arguments))}return Xd(e,t),Zd(e,[{key:"getWidth",value:function(){if(_.isNumber(this.width))return this.width;var t=this.table.index.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(_.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,n=t.index,r=t.visualHeight()-(n.getHeight()+e.getHeight());return this.height=r,r}},{key:"getX",value:function(){if(_.isNumber(this.x))return this.x;return this.x=0,0}},{key:"getY",value:function(){if(_.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,n=t.index.getHeight()+e.getHeight();return this.y=n,n}},{key:"getScrollView",value:function(){if(_.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.xTableAreaView,n=t.index,r=e.getScrollView();return r.sci=0,r.eci=0,r.w=n.getWidth(),this.scrollView=r,r.clone()}}]),e}(Jd),ng=function(t){function e(){return qd(this,e),Ud(this,Gd(e).apply(this,arguments))}return Xd(e,t),Zd(e,[{key:"getWidth",value:function(){if(_.isNumber(this.width))return this.width;var t=this.table,e=t.xLeft,n=t.index,r=t.visualWidth()-(n.getWidth()+e.getWidth());return this.width=r,r}},{key:"getHeight",value:function(){if(_.isNumber(this.height))return this.height;var t=this.table,e=t.fixed,n=t.rows.sectionSumHeight(0,e.fxTop);return this.height=n,n}},{key:"getX",value:function(){if(_.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,n=t.index.getWidth()+e.getWidth();return this.x=n,n}},{key:"getY",value:function(){if(_.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}},{key:"getScrollView",value:function(){if(_.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.fixed,n=t.rows,r=t.xTableAreaView.getScrollView();return r.sri=0,r.eri=e.fxTop,r.h=n.sectionSumHeight(r.sci,r.eci),this.scrollView=r,r.clone()}}]),e}(Jd),rg=function(t){function e(){return qd(this,e),Ud(this,Gd(e).apply(this,arguments))}return Xd(e,t),Zd(e,[{key:"getWidth",value:function(){if(_.isNumber(this.width))return this.width;var t=this.table,e=t.index,n=t.xLeft,r=t.visualWidth()-(e.getWidth()+n.getWidth());return this.width=r,r}},{key:"getHeight",value:function(){if(_.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,n=t.index,r=t.visualHeight()-(n.getHeight()+e.getHeight());return this.height=r,r}},{key:"getX",value:function(){if(_.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,n=t.index.getWidth()+e.getWidth();return this.x=n,n}},{key:"getY",value:function(){if(_.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,n=t.index.getHeight()+e.getHeight();return this.y=n,n}},{key:"getScrollView",value:function(){if(_.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table.xTableAreaView.getScrollView();return this.scrollView=t,t.clone()}}]),e}(Jd),og=function(t){function e(){return qd(this,e),Ud(this,Gd(e).apply(this,arguments))}return Xd(e,t),Zd(e,[{key:"getWidth",value:function(){if(_.isNumber(this.width))return this.width;var t=this.table,e=t.cols,n=t.fixed,r=e.sectionSumWidth(0,n.fxLeft);return this.width=r,r}},{key:"getHeight",value:function(){if(_.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,n=t.index,r=t.visualHeight()-(n.getHeight()+e.getHeight());return this.height=r,r}},{key:"getX",value:function(){if(_.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(_.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,n=t.index.getHeight()+e.getHeight();return this.y=n,n}},{key:"getScrollView",value:function(){if(_.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.fixed,n=t.cols,r=t.xTableAreaView.getScrollView();return r.sci=0,r.eci=e.fxLeft,r.w=n.sectionSumWidth(r.sci,r.eci),this.scrollView=r,r.clone()}}]),e}(Jd),ig=function t(e){qd(this,t);var n=e.keyboard,r=e.cols,o=e.rows,i=e.edit,c=e.merges,l=e.screenSelector,s=0,a=null;n.register({el:e,focus:!0,stop:!1,attr:{code:9,callback:function(){i.hideEdit();var t=l.selectorAttr,e=t,n=t.rect.clone();if(s!==e){var u=n.sri,f=n.sci;s=e,a={sri:u,sci:f}}var h=r.len-1,p=o.len-1,y=a,b=y.sri,d=y.sci,g=c.getFirstIncludes(b,d);if(g&&(d=g.eci),!(d>=h&&b>=p)){d>=h?(b+=1,d=0):d+=1,a.sri=b,a.sci=d;var v=b,w=d,m=c.getFirstIncludes(b,d);m&&(b=m.sri,d=m.sci,v=m.eri,w=m.eci),n.sri=b,n.sci=d,n.eri=v,n.eci=w,l.selectorAttr.rect=n,l.setOffset(l.selectorAttr),l.onChangeStack.forEach((function(t){return t()})),l.onSelectChangeStack.forEach((function(t){return t()})),i.showEdit()}}}})},cg=function(t){function e(t){var n,r=t.settings;return qd(this,e),(n=Ud(this,Gd(e).call(this,"".concat(o,"-table")))).settings=_.mergeDeep({index:{height:30,width:40,gridColor:"#c4c4c4",size:10,color:"#000000"},table:{showGrid:!0,background:"#ffffff",borderColor:"#e5e5e5",gridColor:"#c5c5c5"},fixed:{fxTop:-1,fxLeft:-1},rows:{len:1e3,height:30,data:[]},cols:{len:36,width:90,data:[]},data:[],merge:{}},r),n.visualHeightCache=null,n.visualWidthCache=null,n.scale=new Of,n.index=new Ff(_.mergeDeep({scaleAdapter:new Ef({goto:function(t){return Fc.cvCssPx(n.scale.goto(t))}})},n.settings.index)),n.rows=new xf(_.mergeDeep({scaleAdapter:new Ef({goto:function(t){return Fc.cvCssPx(n.scale.goto(t))}})},n.settings.rows)),n.cols=new kf(_.mergeDeep({scaleAdapter:new Ef({goto:function(t){return Fc.cvCssPx(n.scale.goto(t))}})},n.settings.cols)),n.fixed=new Pb(n.settings.fixed),n.scroll=new Pf({fixed:n.fixed}),n.xTableScrollView=new Sh({scroll:n.scroll,rows:n.rows,cols:n.cols,getHeight:function(){return n.xContent.getHeight()},getWidth:function(){return n.xContent.getWidth()}}),n.xTableAreaView=new Oh({xTableScrollView:n.xTableScrollView,rows:n.rows,cols:n.cols,scroll:n.scroll}),n.xTableImage=new Cb({xTableScrollView:n.xTableScrollView,settings:n.settings,scroll:n.scroll,fixed:n.fixed}),n.xTableFrozenContent=new Qd(zd(n)),n.xLeftIndex=new eg(zd(n)),n.xTopIndex=new tg(zd(n)),n.xLeft=new og(zd(n)),n.xTop=new ng(zd(n)),n.xContent=new rg(zd(n)),n.focus=new Pd(zd(n)),n.mousePointer=new Db(zd(n)),n.keyboard=new Mb(zd(n)),n.screen=new Sd(zd(n)),n.xReSizer=new zb(zd(n)),n.yReSizer=new Zb(zd(n)),n.xHeightLight=new rd(zd(n)),n.yHeightLight=new ad(zd(n)),n.edit=new kd(zd(n)),n}return Xd(e,t),Zd(e,[{key:"getTableDataSnapshot",value:function(){return this.xTableImage.tableDataSnapshot}},{key:"getTableMerges",value:function(){return this.xTableImage.merges}},{key:"getStyleCellsHelper",value:function(){return this.xTableImage.styleCellsHelper}},{key:"getOperateCellsHelper",value:function(){return this.xTableImage.operateCellsHelper}},{key:"getTableCells",value:function(){return this.xTableImage.cells}},{key:"getScrollTotalWidth",value:function(){var t=this.fixed,e=this.cols;return t.fxTop>-1?e.sectionSumWidth(t.fxLeft,e.len-1):e.sectionSumWidth(0,e.len-1)}},{key:"getScrollTotalHeight",value:function(){var t=this.fixed,e=this.rows;return t.fxTop>-1?e.sectionSumHeight(t.fxTop,e.len-1):e.sectionSumHeight(0,e.len-1)}},{key:"getIndexWidth",value:function(){return this.index.getWidth()}},{key:"getIndexHeight",value:function(){return this.index.getHeight()}},{key:"getContentWidth",value:function(){return this.xContent.getWidth()}},{key:"getContentHeight",value:function(){return this.xContent.getHeight()}},{key:"getFixedWidth",value:function(){return this.xLeft.getWidth()}},{key:"getFixedHeight",value:function(){return this.xTop.getHeight()}},{key:"visualWidth",value:function(){if(_.isNumber(this.visualWidthCache))return this.visualWidthCache;var t=this.box().width;return this.visualWidthCache=t,t}},{key:"visualHeight",value:function(){if(_.isNumber(this.visualHeightCache))return this.visualHeightCache;var t=this.box().height;return this.visualHeightCache=t,t}},{key:"getRiCiByXy",value:function(t,e){var n=this.fixed,r=this.rows,o=this.cols,i=this.index,c=this.getFixedHeight(),l=this.getFixedWidth(),s=t,a=e,u=-1,f=-1;if(s-=i.getWidth(),a-=i.getHeight(),s<=l&&t>i.getWidth())for(var h=0,p=0;p<=n.fxLeft;p+=1){if(u=p,(h+=o.getWidth(p))>=s)break}else if(t>i.getWidth())for(var y=l,b=this.getScrollView(),d=b.sci;d<=b.eci;d+=1){if(u=d,(y+=o.getWidth(d))>=s)break}if(a<c&&e>i.getHeight())for(var g=0,v=0;v<=n.fxTop;v+=1){if(f=v,(g+=r.getHeight(v))>a)break}else if(e>i.getHeight())for(var w=c,m=this.getScrollView(),S=m.sri;S<=m.eri;S+=1){if(f=S,(w+=r.getHeight(S))>a)break}return{ri:f,ci:u}}},{key:"reset",value:function(){var t=this.xTableAreaView,e=this.xTableFrozenContent,n=this.xLeftIndex,r=this.xTopIndex,o=this.xLeft,i=this.xTop,c=this.xContent;t.reset(),e.reset(),n.reset(),r.reset(),o.reset(),i.reset(),c.reset()}},{key:"onAttach",value:function(){var t=this,e=this.xTableImage;this.attach(e),this.bind(),this.keyBoardTab=new ig(this);var n=this.getTableDataSnapshot();this.screenSelector=new va(this.screen),this.screenAutoFill=new Id(this.screen,{onBeforeAutoFill:function(){n.begin()},onAfterAutoFill:function(){n.end()}}),this.copyStyle=new ca(this.screen,{}),this.screen.addWidget(this.screenSelector),this.screen.addWidget(this.screenAutoFill),this.screen.addWidget(this.copyStyle),this.screenSelector.on(ga.SELECT_CHANGE,(function(){t.trigger(r.TABLE_EVENT_TYPE.SELECT_CHANGE)})),this.screenSelector.on(ga.DOWN_SELECT,(function(){t.trigger(r.TABLE_EVENT_TYPE.SELECT_DOWN)})),this.attach(this.screen),this.attach(this.xReSizer),this.attach(this.yReSizer),this.attach(this.xHeightLight),this.attach(this.yHeightLight),this.attach(this.edit)}},{key:"bind",value:function(){var t=this,e=this.mousePointer;Nt.bind(this,r.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.resize()})),Nt.bind(this,r.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.resize()})),Nt.bind(this,r.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(n){var o=t.computeEventXy(n),i=o.x,c=o.y,l=t.getRiCiByXy(i,c),s=l.ri,a=l.ci;if(-1!==s)if(-1!==a){var u=r.MOUSE_POINTER_TYPE.SELECT_CELL,f=u.type,h=u.key;e.set(f,h)}else{var p=r.MOUSE_POINTER_TYPE.SELECT_ONE_ROW,y=p.type,b=p.key;e.set(y,b)}else{var d=r.MOUSE_POINTER_TYPE.SELECT_ONE_COLUMN,g=d.type,v=d.key;e.set(g,v)}})),Nt.bind(this,r.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.scrolling()}))}},{key:"getScrollView",value:function(){return this.xTableAreaView.getScrollView()}},{key:"scrollX",value:function(t){var e=this.cols,n=this.fixed,o=this.scroll,i=n.fxLeft;i+=1;var c,l=Yd(_.rangeReduceIf(i,e.len,0,0,t,(function(t){return e.getWidth(t)})),3),s=l[0],a=l[1],u=l[2],f=a;t>0&&(f+=u),o.x>f?c=Cf.H_LEFT:o.x<f&&(c=Cf.H_RIGHT),o.type=c,o.ci=s,o.x=f,this.trigger(r.SYSTEM_EVENT_TYPE.SCROLL),o.type=Cf.UN}},{key:"scrollY",value:function(t){var e=this.rows,n=this.fixed,o=this.scroll,i=n.fxTop;i+=1;var c,l=Yd(_.rangeReduceIf(i,e.len,0,0,t,(function(t){return e.getHeight(t)})),3),s=l[0],a=l[1],u=l[2],f=a;t>0&&(f+=u),o.y>f?c=Cf.V_TOP:o.y<f&&(c=Cf.V_BOTTOM),o.type=c,o.ri=s,o.y=f,this.trigger(r.SYSTEM_EVENT_TYPE.SCROLL),o.type=Cf.UN}},{key:"getTop",value:function(){var t=this.rows,e=this.getScrollView();return t.sectionSumHeight(0,e.sri-1)}},{key:"getLeft",value:function(){var t=this.cols,e=this.getScrollView();return t.sectionSumWidth(0,e.sci-1)}},{key:"resize",value:function(){var t=this.xTableImage;this.visualHeightCache=null,this.visualWidthCache=null,this.reset(),t.resize()}},{key:"scrolling",value:function(){var t=this.xTableImage;this.reset(),t.scrolling()}},{key:"render",value:function(){this.xTableImage.render()}},{key:"setScale",value:function(t){var e=this.xTableImage;this.reset(),this.scale.setValue(t),this.screen.setDivideLayer(),this.xHeightLight.setSize(),this.yHeightLight.setSize(),e.setScale(t)}}]),e}(V);function lg(t){return(lg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ag(t,e){return!e||"object"!==lg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ug(t){return(ug=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fg(t,e){return(fg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hg=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{tableConfig:{data:[]}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ag(this,ug(e).call(this,"".concat(o,"-sheet")))).options=n,t.table=new cg({settings:t.options.tableConfig}),t}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fg(t,e)}(e,t),n=e,(i=[{key:"bind",value:function(){var t=this,e=this.table;Nt.bind(e,r.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(e){t.trigger(r.TABLE_EVENT_TYPE.CHANGE_WIDTH,t),e.stopPropagation()})),Nt.bind(e,r.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(e){t.trigger(r.TABLE_EVENT_TYPE.CHANGE_HEIGHT,t),e.stopPropagation()})),Nt.bind(e,r.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(e){t.trigger(r.TABLE_EVENT_TYPE.SELECT_CHANGE,t),e.stopPropagation()})),Nt.bind(e,r.TABLE_EVENT_TYPE.SELECT_DOWN,(function(e){t.trigger(r.TABLE_EVENT_TYPE.SELECT_DOWN,t),e.stopPropagation()}))}},{key:"onAttach",value:function(){var t=this.table;this.attach(t)}}])&&sg(n.prototype,i),c&&sg(n,c),e}(V),pg=n(3),yg=n.n(pg);function bg(t){return(bg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gg(t,e){return!e||"object"!==bg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vg(t){return(vg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wg(t,e){return(wg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mg=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{sheets:[]};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=gg(this,vg(e).call(this,"".concat(o,"-work-body")))).work=t,n.workConfig=r,n.sheets=n.workConfig.sheets,n.tabSheet=[],n.activeIndex=-1,n.poweredBy=C("div","".concat(o,"-powered-by-tips")),n.poweredBy.text(i),n.children(n.poweredBy),n.sheetViewLayer=new Jt({style:{flexGrow:1}}),n.scrollBarYLayer=new Jt({style:{overflow:"inherit"}}),n.scrollBarXLayer=new Xu,n.scrollBarXVerticalCenter=new Ju,n.scrollBarXHorizontalLayer=new Jt({style:{flexGrow:2}}),n.scrollBarXVerticalCenter.children(n.scrollBarXLayer),n.scrollBarXHorizontalLayer.children(n.scrollBarXVerticalCenter),n.sheetSwitchTabLayer=new Jt({style:{flexGrow:3}}),n.horizontalLayer1=new re,n.horizontalLayer2=new re,n.horizontalLayer1.children(n.sheetViewLayer),n.horizontalLayer1.children(n.scrollBarYLayer),n.horizontalLayer2.children(n.sheetSwitchTabLayer),n.horizontalLayer2.children(n.scrollBarXHorizontalLayer),n.horizontalLayer1Layer=new q({style:{flexGrow:1}}),n.horizontalLayer2Layer=new q,n.layerVerticalLayer=new U,n.horizontalLayer1Layer.children(n.horizontalLayer1),n.horizontalLayer2Layer.children(n.horizontalLayer2),n.layerVerticalLayer.children(n.horizontalLayer1Layer),n.layerVerticalLayer.children(n.horizontalLayer2Layer),n.children(n.layerVerticalLayer),n.sheetView=new cf,n.scrollBarY=new Xt({scroll:function(t){n.sheetView.getActiveSheet().table.scrollY(t)}}),n.tabView=new hf({onAdd:function(){var t=new hg,e=new wf;n.addTabSheet({tab:e,sheet:t})},onSwitch:function(t){n.setActiveTab(t)}}),n.scrollBarX=new It({scroll:function(t){n.sheetView.getActiveSheet().table.scrollX(t)}}),n}var n,c,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wg(t,e)}(e,t),n=e,(c=[{key:"updateScroll",value:function(){var t=this.sheetView.getActiveSheet();if(!_.isUnDef(t)){var e=this.scrollBarXHorizontalLayer,n=t.table,r=n.getScrollTotalHeight(),o=n.getScrollTotalWidth();e.display(o>n.getContentWidth()),this.scrollBarY.setSize(n.getContentHeight(),r),this.scrollBarX.setSize(n.getContentWidth(),o),this.scrollBarY.scrollMove(n.getTop()),this.scrollBarX.scrollMove(n.getLeft())}}},{key:"createSheet",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,o=this.sheets[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value,c=i.name,l=new hg(i),s=new wf(c);this.addTabSheet({tab:s,sheet:l})}}catch(t){e=!0,n=t}finally{try{t||null==o.return||o.return()}finally{if(e)throw n}}this.tabSheet.length&&this.setActiveIndex(0)}},{key:"bind",value:function(){var t=this;this.on(r.SYSTEM_EVENT_TYPE.MOUSE_WHEEL,(function(e){var n=t.sheetView.getActiveSheet();if(!_.isUnDef(n)){var r=n.table,o=r.rows,i=r.scroll,c=t.scrollBarY.scrollTo,l=e.deltaY;e.detail&&(l=40*e.detail),l>0?t.scrollBarY.scrollMove(c+o.getHeight(i.ri)):t.scrollBarY.scrollMove(c-o.getHeight(i.ri-1)),i.blockTop<i.maxBlockTop&&i.blockTop>0&&(e.preventDefault(),e.stopPropagation())}})),Nt.bind(window,r.SYSTEM_EVENT_TYPE.RESIZE,(function(){_.throttle((function(){t.sheetView.getActiveSheet().table.resize(),t.updateScroll()}))})),Nt.bind(this.sheetView,r.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.updateScroll()})),Nt.bind(this.sheetView,r.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.updateScroll()})),Nt.bind(this.sheetView,r.TABLE_EVENT_TYPE.DATA_CHANGE,(function(e){t.trigger(r.TABLE_EVENT_TYPE.DATA_CHANGE),e.stopPropagation()})),Nt.bind(this.sheetView,r.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(e){t.trigger(r.TABLE_EVENT_TYPE.SELECT_CHANGE),e.stopPropagation()})),Nt.bind(this.sheetView,r.TABLE_EVENT_TYPE.SELECT_DOWN,(function(e){t.trigger(r.TABLE_EVENT_TYPE.SELECT_DOWN,t),e.stopPropagation()}))}},{key:"onAttach",value:function(){var t=this.sheetViewLayer,e=this.scrollBarYLayer,n=this.sheetSwitchTabLayer,r=this.scrollBarXLayer;t.attach(this.sheetView),e.attach(this.scrollBarY),n.attach(this.tabView),r.attach(this.scrollBarX),this.bind(),this.createSheet(),this.updateScroll()}},{key:"addTabSheet",value:function(t){var e=t.tab,n=t.sheet,r=this.tabSheet,o=this.sheetView,i=this.tabView;o.attach(n),i.attach(e),r.push({tab:e,sheet:n})}},{key:"setActiveIndex",value:function(t){var e=this.sheetView,n=this.tabView,r=e.setActiveSheet(t),o=n.setActiveTab(t);r&&o&&(r.table.resize(),this.activeIndex=t,this.updateScroll())}},{key:"setActiveTab",value:function(t){var e=this;this.tabSheet.forEach((function(n,r){n.tab===t&&e.setActiveIndex(r)}))}},{key:"toTemplate",value:function(){var t=this.activeIndex,e=this.sheetView,n=this.tabView,r=e.sheetList[t],o=n.tabList[t];if(r&&o){var i=r.table,c=i.rows,l=i.cols,s=i.settings,a=i.getTableCells(),u=i.getTableMerges(),f={name:o.name,tableConfig:{table:{showGrid:s.table.showGrid,background:s.table.background},rows:{len:c.len,height:c.height,data:c.getData()},cols:{len:l.len,width:l.width,data:l.getData()},merge:{merges:u.getData().map((function(t){return t.toString()}))},data:a.getData()}},h="window['".concat(o.name,"'] = ").concat(JSON.stringify(f));yg()(h,"".concat(o.name,".js"),"application/x-javascript")}}},{key:"setScale",value:function(t){this.sheetView.getActiveSheet().table.setScale(t),this.updateScroll()}}])&&dg(n.prototype,c),l&&dg(n,l),e}(V);function Sg(t){return(Sg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Og(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Eg(t,e){return!e||"object"!==Sg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _g(t){return(_g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xg(t,e){return(xg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tg=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Eg(this,_g(e).call(this,"".concat(o,"-bottom-menu")))).workBottom=t,n.sum=C("div","".concat(o,"-bottom-sum")),n.avg=C("div","".concat(o,"-bottom-avg")),n.number=C("div","".concat(o,"-bottom-number")),n.fullScreen=C("div","".concat(o,"-bottom-full-screen")),n.grid=C("div","".concat(o,"-bottom-grid")),n.children(n.grid),n.children(n.fullScreen),n.children(n.sum),n.children(n.avg),n.children(n.number),n}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xg(t,e)}(e,t),n=e,(i=[{key:"onAttach",value:function(){this.bind()}},{key:"bind",value:function(){var t=this.workBottom.work,e=t.body.sheetView;Nt.bind(this.grid,r.SYSTEM_EVENT_TYPE.CLICK,(function(){var t=e.getActiveSheet().table;t.settings.table.showGrid=!t.settings.table.showGrid,t.render()})),Nt.bind(this.fullScreen,r.SYSTEM_EVENT_TYPE.CLICK,(function(){_.isFull()?_.exitFullscreen():_.fullScreen(t.root)}))}},{key:"setSum",value:function(t){this.sum.text("求和: ".concat(t))}},{key:"setAvg",value:function(t){this.avg.text("平均数: ".concat(t))}},{key:"setNumber",value:function(t){this.number.text("数量: ".concat(t))}}])&&Og(n.prototype,i),c&&Og(n,c),e}(V);function kg(t){return(kg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pg(t,e){return!e||"object"!==kg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jg(t){return(jg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ag(t,e){return(Ag=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Lg=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Pg(this,jg(e).call(this,"".concat(o,"-work-bottom")))).work=t,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ag(t,e)}(e,t),n=e,(r=[{key:"onAttach",value:function(){this.bottomMenu=new Tg(this),this.attach(this.bottomMenu)}}])&&Cg(n.prototype,r),i&&Cg(n,i),e}(V);function Rg(t){return(Rg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ng(t){return(Ng=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wg(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Dg(t,e){return(Dg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hg=function(t){function e(){var t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{body:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(r=Ng(e).call(this,"".concat(o,"-work")))||"object"!==Rg(r)&&"function"!=typeof r?Wg(n):r).options=i.workConfig,t.root=null,t.topLayer=new q,t.bodyLayer=new q({style:{flexGrow:1}}),t.bottomLayer=new q,t.verticalLayer=new U,t.verticalLayer.children(t.topLayer),t.verticalLayer.children(t.bodyLayer),t.verticalLayer.children(t.bottomLayer),t.children(t.verticalLayer),t.top=new Yu(Wg(t)),t.body=new mg(Wg(t),t.options.body),t.bottom=new Lg(Wg(t)),t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dg(t,e)}(e,t),n=e,(r=[{key:"onAttach",value:function(t){this.root=t;var e=this.bodyLayer,n=this.topLayer,r=this.bottomLayer;n.attach(this.top),r.attach(this.bottom),e.attach(this.body),this.bottom.bottomMenu.setSum(0),this.bottom.bottomMenu.setAvg(0),this.bottom.bottomMenu.setNumber(0)}}])&&Vg(n.prototype,r),i&&Vg(n,i),e}(V);n(4),n(5);function Mg(t){return(Mg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bg(t){return(Bg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ig(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Yg(t,e){return(Yg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.d(e,"XSheet",(function(){return Fg}));var Fg=function(t){function e(t){var n,r,i,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{workConfig:{body:{sheets:[{tableConfig:{}}]}}};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,n=!(i=Bg(e).call(this,"".concat(o)))||"object"!==Mg(i)&&"function"!=typeof i?Ig(r):i;var l=t;return"string"==typeof t&&(l=document.querySelector(t)),(l=C(l)).children(Ig(n)),n.work=new Hg(c),n.attach(n.work),pe.setRoot(Ig(n)),ar.setRoot(Ig(n)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yg(t,e)}(e,t),e}(V);Fg.version=i,Fg.Utils=_,window&&(window.XSheet=Fg)}]);
//# sourceMappingURL=XSheet.js.map