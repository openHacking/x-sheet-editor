!function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=6)}([function(t,e,n){t.exports=n.p+"c4ab8001e109540f7ae6a34181d695d3.png"},function(t,e,n){t.exports=n.p+"42b436e7c64603182355d52d31ea49f1.png"},function(t,e,n){t.exports=n.p+"9dfd8685ea7e1e5c025514eec46a4547.png"},function(t,e,n){var o,r,i;r=[],void 0===(i="function"==typeof(o=function(){return function t(e,n,o){var r,i,c=window,l="application/octet-stream",a=o||l,s=e,u=!n&&!o&&s,f=document.createElement("a"),h=function(t){return String(t)},p=c.Blob||c.MozBlob||c.WebKitBlob||h,y=n||"download";if(p=p.call?p.bind(c):Blob,"true"===String(this)&&(a=(s=[s,a])[0],s=s[1]),u&&u.length<2048&&(y=u.split("/").pop().split("?")[0],f.href=u,-1!==f.href.indexOf(u))){var b=new XMLHttpRequest;return b.open("GET",u,!0),b.responseType="blob",b.onload=function(e){t(e.target.response,y,l)},setTimeout((function(){b.send()}),0),b}if(/^data\:[\w+\-]+\/[\w+\-]+[,;]/.test(s)){if(!(s.length>2096103.424&&p!==h))return navigator.msSaveBlob?navigator.msSaveBlob(d(s),y):v(s);a=(s=d(s)).type||l}function d(t){for(var e=t.split(/[:;,]/),n=e[1],o=("base64"==e[2]?atob:decodeURIComponent)(e.pop()),r=o.length,i=0,c=new Uint8Array(r);i<r;++i)c[i]=o.charCodeAt(i);return new p([c],{type:n})}function v(t,e){if("download"in f)return f.href=t,f.setAttribute("download",y),f.className="download-js-link",f.innerHTML="downloading...",f.style.display="none",document.body.appendChild(f),setTimeout((function(){f.click(),document.body.removeChild(f),!0===e&&setTimeout((function(){c.URL.revokeObjectURL(f.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return t=t.replace(/^data:([\w\/\-\+]+)/,l),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var n=document.createElement("iframe");document.body.appendChild(n),e||(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,l)),n.src=t,setTimeout((function(){document.body.removeChild(n)}),333)}if(r=s instanceof p?s:new p([s],{type:a}),navigator.msSaveBlob)return navigator.msSaveBlob(r,y);if(c.URL)v(c.URL.createObjectURL(r),!0);else{if("string"==typeof r||r.constructor===h)try{return v("data:"+a+";base64,"+c.btoa(r))}catch(t){return v("data:"+a+","+encodeURIComponent(r))}(i=new FileReader).onload=function(t){v(this.result)},i.readAsDataURL(r)}return!0}})?o.apply(e,r):o)||(t.exports=i)},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var o={},r="X-Sheet 1.0.0-develop",i="x-sheet";function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function l(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function a(){return(65536*(1+Math.random())|0).toString(16).substring(1)}o.WORK_BODY_EVENT_TYPE={CHANGE_ACTIVE:"changeactive"},o.SYSTEM_EVENT_TYPE={MOUSE_MOVE:"mousemove",MOUSE_DOWN:"mousedown",SCROLL:"scroll",RESIZE:"resize",MOUSE_UP:"mouseup",KEY_UP:"keyup",INPUT:"input",KEY_DOWN:"keydown",MOUSE_OVER:"mouseover",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",MOUSE_ENTER:"mouseenter",CLICK:"click",DRAG_START:"dragstart",CHANGE:"change",VISIBILITY_CHANGE:"visibilitychange"},o.TABLE_EVENT_TYPE={CHANGE_HEIGHT:"changeheight",SELECT_OVER:"selectover",SCALE_CHANGE:"scalechange",FIXED_CHANGE:"fixedchange",SELECT_DOWN:"selectdown",SELECT_CHANGE:"selectchange",DATA_CHANGE:"datachange",CHANGE_WIDTH:"changewidth",RESIZE_CHANGE:"resizechange",RENDER:"render"};var s=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],u=1,f=2,h=3,p=5,y=6,b=7,d=8,v=9,g=10,w=11,m=12,E=13,O=14,S=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,n=null,o=[{key:"isWindows",value:function(){return/windows|win32/i.test(navigator.userAgent)}},{key:"isMac",value:function(){return/macintosh|mac os x/i.test(navigator.userAgent)}},{key:"isNotEmptyObject",value:function(e){return!t.isEmptyObject(e)}},{key:"isEmptyObject",value:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}},{key:"isUnDef",value:function(t){return null==t}},{key:"isNotUnDef",value:function(t){return!this.isUnDef(t)}},{key:"isNumber",value:function(t){return/^(-?\d+.\d+)$|^(-?\d+)$/.test(t)}},{key:"isFraction",value:function(t){return/^\d+\/\d+$/.test(t)}},{key:"isFunction",value:function(e){return t.type(e)===y}},{key:"isArray",value:function(e){return t.type(e)===p}},{key:"isBlank",value:function(e){return!!t.isUnDef(e)||""===e.toString().trim()}},{key:"isPlainObject",value:function(e){return!t.isUnDef(e)&&Object.getPrototypeOf(e)===Object.getPrototypeOf({})}},{key:"isString",value:function(e){return t.type(e)===u}},{key:"mergeDeep",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.isUnDef(e))return{};for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return t.isUnDef(o)||0===o.length?e:(o.forEach((function(n){t.isUnDef(n)||Object.keys(n).forEach((function(o){var r=n[o];"string"==typeof r||"number"==typeof r||"boolean"==typeof r?e[o]=r:"function"!=typeof r&&!Array.isArray(r)&&t.isPlainObject(r)?(e[o]=e[o]||{},t.mergeDeep(e[o],r)):e[o]=r}))})),e)}},{key:"toLowCase",value:function(t){return t.toLowerCase()}},{key:"type",value:function(t){var e=Object.prototype.toString.call(t);switch(e){case"[object Null]":return b;case"[object Undefined]":return d;case"[object String]":return u;case"[object Boolean]":return f;case"[object Number]":return h;case"[object Function]":return y;case"[object Array]":return p;case"[object Promise]":return v;case"[object GeneratorFunction]":return g;case"[object AsyncFunction]":return w;case"[object BigInt]":return m;case"[object Symbol]":return E;default:return O}}},{key:"cloneDeep",value:function(t){var e=JSON.stringify(t);return JSON.parse(e)}},{key:"copyProp",value:function(t,e){return Object.assign(t,e)}},{key:"sum",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},n=0,o=0;return Object.keys(t).forEach((function(r){n+=e(t[r],r),o+=1})),[n,o]}},{key:"parseFloat",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(e){return t.isNumber(e)?parseFloat(e):0}))},{key:"parseInt",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(e){return t.isNumber(e)?parseInt(e,10):0}))},{key:"stringAt",value:function(t){for(var e="",n=t;n>=s.length;)n/=s.length,n-=1,e+=s[parseInt(n,10)%s.length];return e+=s[t%s.length]}},{key:"indexAt",value:function(t){for(var e=0,n=0;n<t.length-1;n+=1){var o=t.charCodeAt(n)-65,r=t.length-1-n;e+=Math.pow(s.length,r)+s.length*o}return e+=t.charCodeAt(t.length-1)-65}},{key:"expr2xy",value:function(e){for(var n="",o="",r=0;r<e.length;r+=1)e.charAt(r)>="0"&&e.charAt(r)<="9"?o+=e.charAt(r):n+=e.charAt(r);return[t.indexAt(n),parseInt(o,10)-1]}},{key:"xy2expr",value:function(e,n){return"".concat(t.stringAt(e)).concat(n+1)}},{key:"expr2expr",value:function(e,n,o){var r=c(t.expr2xy(e),2),i=r[0],l=r[1];return t.xy2expr(i+n,l+o)}},{key:"minIf",value:function(t,e){return t<e?e:t}},{key:"keepLastIndex",value:function(t){if(window.getSelection){t.focus();var e=window.getSelection();e.selectAllChildren(t),e.collapseToEnd()}else if(document.selection){var n=document.selection.createRange();n.moveToElementText(t),n.collapse(!1),n.select()}}},{key:"trim",value:function(t){return this.isBlank(t)?"":t.trim()}},{key:"now",value:function(){return Date.now().toString()}},{key:"viewPort",value:function(){return{width:window.innerWidth,height:window.innerHeight}}},{key:"exitFullscreen",value:function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}},{key:"fullScreen",value:function(t){t.el&&(t=t.el),t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}},{key:"isFull",value:function(){return!!(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)}},{key:"uuid",value:function(){return"".concat(a()+a()).concat(a()).concat(a()).concat(a()).concat(a()).concat(a()).concat(a())}},{key:"getExplorerInfo",value:function(){var t=window.navigator.userAgent.toLowerCase();return t.indexOf("firefox")>=0?{type:"Firefox",version:t.match(/firefox\/([\d.]+)/)[1]}:t.indexOf("chrome")>=0?{type:"Chrome",version:t.match(/chrome\/([\d.]+)/)[1]}:t.indexOf("opera")>=0?{type:"Opera",version:t.match(/opera.([\d.]+)/)[1]}:t.indexOf("Safari")>=0?{type:"Safari",version:t.match(/version\/([\d.]+)/)[1]}:t.indexOf("msie")>=0?{type:"IE",version:t.match(/msie ([\d.]+)/)[1]}:void 0}}],n&&l(e.prototype,n),o&&l(e,o),t}();function x(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function T(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}S.EMPTY="",S.Nul=null,S.Undef=void 0;var _=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=n):this.el=e,this.el.data=[]}var e,n,o;return e=t,(n=[{key:"data",value:function(t,e){return void 0!==e?(this.el.data[t]=e,this):this.el.data[t]}},{key:"on",value:function(t,e){var n=x(t.split(".")),o=n[0],r=n.slice(1),i=o;return"mousewheel"===i&&/Firefox/i.test(window.navigator.userAgent)&&(i="DOMMouseScroll"),this.el.addEventListener(i,(function(t){e(t);for(var n=0;n<r.length;n+=1){var o=r[n];if("left"===o&&0!==t.button)return;if("right"===o&&2!==t.button)return;"stop"===o&&t.stopPropagation()}})),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach((function(n){e.css(n,"".concat(t[n],"px"))})),this;var n=this.el;return{top:n.offsetTop,left:n.offsetLeft,height:n.offsetHeight,width:n.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"scrollTop",value:function(){return this.el.scrollTop}},{key:"clientHeight",value:function(){return this.el.clientHeight}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return 0===arguments.length?this.el.childNodes:(n.forEach((function(e){return t.child(e)})),this)}},{key:"first",value:function(){return this.el.firstChild}},{key:"last",value:function(){return this.el.lastChild}},{key:"remove",value:function(t){return this.el.removeChild(t.el||t)}},{key:"prepend",value:function(t){var e=this.el;return e.children.length>0?e.insertBefore(t,e.firstChild):e.appendChild(t),this}},{key:"prev",value:function(){return this.el.previousSibling}},{key:"next",value:function(){return this.el.nextSibling}},{key:"child",value:function(e){var n=e;return"string"==typeof e?n=document.createTextNode(e):e instanceof t&&(n=e.el),this.el.appendChild(n),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var n=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach((function(e){n.el.setAttribute(e,t[e])}))}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return n.forEach((function(e){return t.el.style.removeProperty(e)})),this}},{key:"css",value:function(t,e){var n=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach((function(e){n.el.style[e]=t[e]})),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){var t=this.computedStyle();return t&&"block"!==t.display&&this.css("display","block"),this}},{key:"hide",value:function(){var t=this.computedStyle();return t&&"none"!==t.display&&this.css("display","none"),this}},{key:"display",value:function(t){t?this.show():this.hide()}},{key:"text",value:function(t){return void 0===t?this.el.innerText:(this.el.innerText=t,t)}},{key:"sibling",value:function(){for(var e=this.el,n=[];null!==(e=e.previousElementSibling);)n.push(new t(e));for(e=this.el;null!==(e=e.nextElementSibling);)n.push(new t(e));return n}},{key:"position",value:function(){var t=0,e=0;return this.el.style.position&&(this.el.top&&(t=this.el.style.top.replace("%","").repeat("px","")),this.el.left&&(e=this.el.style.left.replace("%","").repeat("px","")),this.el.right&&(t=this.el.style.right.replace("%","").repeat("px","")),this.el.bottom&&(t=this.el.style.bottom.replace("%","").repeat("px",""))),{top:S.parseFloat(t),left:S.parseFloat(e),right:S.parseFloat(0),bottom:S.parseFloat(0)}}},{key:"trigger",value:function(t,e){var n=new CustomEvent(t,{detail:e,bubbles:!0,cancelable:!1});this.el.dispatchEvent(n)}},{key:"focus",value:function(){this.el.focus()}},{key:"find",value:function(e){var n=this.el.querySelectorAll(e);if(n&&1===n.length)return new t(n[0]);var o=[];if(n){var r=!0,i=!1,c=void 0;try{for(var l,a=n[Symbol.iterator]();!(r=(l=a.next()).done);r=!0){var s=l.value;o.push(new t(s))}}catch(t){i=!0,c=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw c}}}return o}},{key:"isChild",value:function(t){for(var e=t||t.el;null!=e&&e!==document.body;){if(e===this.el)return!0;e=e.parentNode}return!1}}])&&T(e.prototype,n),o&&T(e,o),t}(),k=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new _(t,e)};function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function j(t,e,n){return e&&C(t.prototype,e),n&&C(t,n),t}var L=new(function(){function t(){P(this,t),this.pool=[]}return j(t,[{key:"unbind",value:function(t,e,n,o){t instanceof _&&(t=t.el);var r=this.remove(t,e);r.length?r.forEach((function(e){t.removeEventListener(e.type,e.callback,e.option)})):t.removeEventListener(e,n,o)}},{key:"bind",value:function(t,e,n,o){t instanceof _&&(t=t.el),this.pool.push({ele:t,type:e,callback:n,option:o}),t.addEventListener(e,n,o)}},{key:"remove",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",n=[],o=[];return this.pool.forEach((function(r){t===r.ele?"*"!==e&&e!==r.type||o.push(r):n.push(r)})),this.pool=n,o}},{key:"multipleUnbind",value:function(t,e,n,o){var r=this;t.forEach((function(t){r.unbind(t,e,n,o)}))}},{key:"multipleBind",value:function(t,e,n,o){var r=this;t.forEach((function(t){r.bind(t,e,n,o)}))}}]),t}()),A=function(){function t(){P(this,t)}return j(t,null,[{key:"unbind",value:function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Array.isArray(t)?L.multipleUnbind(t,e,n,o):L.unbind(t,e,n,o)}},{key:"bind",value:function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Array.isArray(t)?L.multipleBind(t,e,n,o):L.bind(t,e,n,o)}},{key:"dbClick",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=0;t.bind(e,o.SYSTEM_EVENT_TYPE.CLICK,(function(t){var e=Date.now();e-r<=300?(n(t),r=0):r=e}))}},{key:"mouseMoveUp",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=function(t){n(t),t.stopPropagation()},c=function n(c){t.unbind(e,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,i,!0),t.unbind(e,o.SYSTEM_EVENT_TYPE.MOUSE_UP,n,!0),r(c),c.stopPropagation()};t.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,i,!0),t.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_UP,c,!0)}}]),t}();function R(t){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function N(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function V(t,e){return!e||"object"!==R(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function I(t){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function M(t,e){return(M=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var D=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),V(this,I(e).call(this,n,"".concat(i,"-widget ").concat(t)))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&M(t,e)}(e,t),n=e,(o=[{key:"computeEventXy",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=e.box(),o=n.top,r=n.left;return{x:t.pageX-r,y:t.pageY-o}}},{key:"computeWidgetXy",value:function(t){if(!t)return{x:0,y:0};var e=t.box(),n=e.top,o=e.left,r=this.box(),i=r.top;return{x:o-r.left,y:n-i}}},{key:"onAttach",value:function(){}},{key:"attach",value:function(t){this.children(t),t.onAttach(this)}},{key:"destroy",value:function(){A.unbind(this)}}])&&N(n.prototype,o),r&&N(n,r),e}(_);function B(t){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function H(t,e){return!e||"object"!==B(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function W(t){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function F(t,e){return(F=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Y=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),H(this,W(e).call(this,"".concat(i,"-layer ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&F(t,e)}(e,t),e}(D);function G(t){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function z(t,e){return!e||"object"!==G(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function U(t){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function X(t,e){return(X=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var K=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=z(this,U(e).call(this,"".concat(i,"-vertical-layer")))).options=S.mergeDeep({style:{}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&X(t,e)}(e,t),e}(Y);function Z(t){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $(t,e){return!e||"object"!==Z(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function q(t){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function J(t,e){return(J=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Q=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=$(this,q(e).call(this,"".concat(i,"-vertical-layer-element")))).options=S.mergeDeep({style:{flexGrow:"0"}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&J(t,e)}(e,t),e}(Y);function tt(t){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function et(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function nt(t,e){return!e||"object"!==tt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ot(t){return(ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rt(t,e){return(rt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var it=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=nt(this,ot(e).call(this,"".concat(i,"-icon")))).iconNameEl=k("div","".concat(i,"-icon-img ").concat(n)),t.child(t.iconNameEl),t}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rt(t,e)}(e,t),n=e,(o=[{key:"setWidth",value:function(t){this.iconNameEl.css("width","".concat(t,"px"))}},{key:"setHeight",value:function(t){this.iconNameEl.css("height","".concat(t,"px"))}}])&&et(n.prototype,o),r&&et(n,r),e}(D);function ct(t){return(ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lt(t,e){return!e||"object"!==ct(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function at(t){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function st(t,e){return(st=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ut=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),lt(this,at(e).call(this,"".concat(i,"-tools-item ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&st(t,e)}(e,t),e}(D);function ft(t){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ht(t,e){return!e||"object"!==ft(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pt(t){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yt(t,e){return(yt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ht(this,pt(e).call(this,"".concat(i,"-tools-undo")))).icon=new it("undo"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yt(t,e)}(e,t),e}(ut);function dt(t){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vt(t,e){return!e||"object"!==dt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gt(t){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wt(t,e){return(wt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=vt(this,gt(e).call(this,"".concat(i,"-tools-redo")))).icon=new it("redo"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wt(t,e)}(e,t),e}(ut);function Et(t){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ot(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function St(t,e){return!e||"object"!==Et(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xt(t){return(xt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tt(t,e){return(Tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _t=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=St(this,xt(e).call(this,"".concat(i,"-tools-point-format")))).icon=new it("point-format"),t.sheets=[],t.children(t.icon),t}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tt(t,e)}(e,t),n=e,(o=[{key:"addSheet",value:function(t){this.sheets.push(t)}},{key:"removeSheet",value:function(t){for(var e=0;e<this.sheets.length;e+=1)if(this.sheets[e]===t)return void this.sheets.splice(e,1)}},{key:"includeSheet",value:function(t){for(var e=0;e<this.sheets.length;e+=1)if(this.sheets[e]===t)return!0;return!1}}])&&Ot(n.prototype,o),r&&Ot(n,r),e}(ut);function kt(t){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pt(t,e){return!e||"object"!==kt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ct(t){return(Ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jt(t,e){return(jt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Lt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Pt(this,Ct(e).call(this,"".concat(i,"-tools-clear-format")))).icon=new it("clear-format"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jt(t,e)}(e,t),e}(ut);function At(t){return(At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Nt(t,e){return!e||"object"!==At(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vt(t){return(Vt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function It(t,e){return(It=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Nt(this,Vt(e).call(this,"".concat(i,"-tools-drop-down-item ").concat(t)))).drop=k("div","".concat(i,"-tools-drop-down-item-mark")),n.title=k("div","".concat(i,"-tools-drop-down-item-title")),n.drop.children(new it("arrow-down")),n.children(n.title),n.children(n.drop),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&It(t,e)}(e,t),n=e,(o=[{key:"setTitle",value:function(t){this.title.text(t)}},{key:"setIcon",value:function(t){this.title.html(""),this.title.children(t)}},{key:"setWidth",value:function(t){this.title.css("width","".concat(t,"px"))}},{key:"setEllipsis",value:function(){this.title.css("overflow","hidden"),this.title.css("text-overflow","ellipsis"),this.title.css("white-space","nowrap")}},{key:"removeEllipsis",value:function(){this.title.cssRemoveKeys("overflow"),this.title.cssRemoveKeys("text-overflow"),this.title.cssRemoveKeys("white-space")}}])&&Rt(n.prototype,o),r&&Rt(n,r),e}(ut);function Dt(t){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ht(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Wt(t,e,n){return(Wt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ft(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Ft(t){return(Ft=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yt(t,e){return(Yt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gt={TOP:1,LEFT:2,BOTTOM:3,RIGHT:4},zt=[],Ut=null,Xt=function(t){function e(t){var n,o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,n=!(r=Ft(e).call(this,"".concat(i,"-el-pop-up ").concat(i,"-no-scroll-bar")))||"object"!==Dt(r)&&"function"!=typeof r?Ht(o):r,zt.push(Ht(n)),n.off=!0,n.options=S.mergeDeep({el:S.Nul,position:Gt.BOTTOM,overflowY:!1,overflowX:!1,autoWidth:!1,autoHeight:!1},t),n.bind(),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yt(t,e)}(e,t),n=e,c=[{key:"removeInstance",value:function(t){var e=[];zt.forEach((function(n){n!==t&&e.push(n)})),zt=e}},{key:"closeAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];zt.forEach((function(e){-1===t.indexOf(e)&&e.close()}))}},{key:"setRoot",value:function(t){t=t.el?k(t.el):k(t),Ut=t}}],(r=[{key:"unbind",value:function(){A.unbind(window)}},{key:"bind",value:function(){var t=this;A.bind(window,o.SYSTEM_EVENT_TYPE.RESIZE,(function(){t.position()}))}},{key:"autosize",value:function(){var t=this.options;this.css("height","auto"),this.css("width","auto");var e=this.box(),n=e.top,o=e.left,r=e.width,i=e.height,c=window.innerWidth-o,l=window.innerHeight-n;t.autoWidth&&(r>c?this.css("width","".concat(c,"px")):this.css("width","auto")),t.autoHeight&&(i>l?this.css("height","".concat(l,"px")):this.css("height","auto")),t.overflowX?this.css("overflow-x","auto"):this.css("overflow-x","none"),t.overflowY?this.css("overflow-y","auto"):this.css("overflow-y","none")}},{key:"position",value:function(){var t=this.options,e=t.el,n=t.position,o=e.box(),r=this.box(),i=o.top,c=o.left;switch(n){case Gt.TOP:i=o.top-r.height;break;case Gt.LEFT:c=o.left-r.width;break;case Gt.RIGHT:c=o.left+o.width;break;case Gt.BOTTOM:i=o.top+o.height}var l=window.innerWidth,a=window.innerHeight;if(c<0||c+r.width>l)switch(n){case Gt.LEFT:c=o.left+o.width;break;case Gt.RIGHT:c=o.left-r.width}if(i<0||i+r.height>a)switch(n){case Gt.TOP:i=o.top+o.height;break;case Gt.BOTTOM:i=o.top-r.height}(c<0||c+r.width>l)&&(i=o.top+o.height,c=o.left),(i<0||i+r.height>a)&&(i=o.top+o.height,c=o.left),this.offset({top:i,left:c})}},{key:"close",value:function(){!1===this.off&&Ut&&(Ut.remove(this),this.off=!0)}},{key:"open",value:function(){this.off&&Ut&&(Ut.children(this),this.position(),this.autosize(),this.off=!1)}},{key:"toggle",value:function(){Ut&&(this.off?this.open():this.close())}},{key:"destroy",value:function(){Wt(Ft(e.prototype),"destroy",this).call(this),this.unbind(),e.removeInstance(this)}}])&&Bt(n.prototype,r),c&&Bt(n,c),e}(D);function Kt(t){return(Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function $t(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qt(t,e,n){return(qt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Jt(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Jt(t){return(Jt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qt(t,e){return(Qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var te=function(t){function e(){var t,n,o,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,o=Jt(e).call(this,"".concat(i,"-el-context-menu ").concat(r)),(t=!o||"object"!==Kt(o)&&"function"!=typeof o?$t(n):o).options=S.mergeDeep({},c),t.menus=[],t.elPopUp=new Xt(t.options),t.elPopUp.children($t(t)),t.globalHandle=function(){t.close()},t.bind(),t}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qt(t,e)}(e,t),n=e,(r=[{key:"unbind",value:function(){A.unbind(document,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,this.globalHandle)}},{key:"bind",value:function(){A.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){t.stopPropagation()})),A.bind(document,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,this.globalHandle)}},{key:"addItem",value:function(t){return this.menus.push(t),this.children(t),this}},{key:"isOpen",value:function(){return this.elPopUp.off}},{key:"open",value:function(){return this.elPopUp.open(),this}},{key:"close",value:function(){return this.elPopUp.close(),this}},{key:"destroy",value:function(){qt(Jt(e.prototype),"destroy",this).call(this),this.unbind(),this.elPopUp.destroy()}}])&&Zt(n.prototype,r),c&&Zt(n,c),e}(D);function ee(t){return(ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ne(t,e){return!e||"object"!==ee(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function oe(t){return(oe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function re(t,e){return(re=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ie=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ne(this,oe(e).call(this,"".concat(i,"-el-context-menu-item hover ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&re(t,e)}(e,t),e}(D);function ce(t){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function le(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ae(t){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function se(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ue(t,e){return(ue=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fe=[],he=function(t){function e(t,n){var o,r,c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(o=!(c=ae(e).call(this,"".concat(i,"-format-context-menu-item")))||"object"!==ce(c)&&"function"!=typeof c?se(r):c).title=t,o.desc=n,o.icon=new it("checked"),o.iconElement=k("div","".concat(i,"-format-context-menu-item-icon")),o.iconElement.children(o.icon),o.titleElement=k("div","".concat(i,"-format-context-menu-item-title")),o.descElement=k("div","".concat(i,"-format-context-menu-item-desc")),o.titleElement.text(t),o.descElement.text(n),o.children(o.iconElement),o.children(o.titleElement),o.children(o.descElement),fe.push(se(o)),o}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ue(t,e)}(e,t),n=e,(o=[{key:"setTitle",value:function(t){this.titleElement.text(t)}},{key:"setDesc",value:function(t){this.descElement.text(t)}},{key:"setActive",value:function(){fe.forEach((function(t){t.removeClass("active")})),this.addClass("active")}}])&&le(n.prototype,o),r&&le(n,r),e}(ie);function pe(t){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ye(t,e){return!e||"object"!==pe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function be(t){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function de(t,e){return(de=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ve=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ye(this,be(e).call(this,"".concat(i,"-el-context-menu-item-divider")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&de(t,e)}(e,t),e}(D);function ge(t){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function we(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function me(t,e){return!e||"object"!==ge(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ee(t){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oe(t,e){return(Oe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Se=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=me(this,Ee(e).call(this,"".concat(i,"-format-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).items=[new he("常规","").data("type","default"),new he("文本","").data("type","text"),new ve,new he("数值","0.59").data("type","number"),new he("百分比","90.00%").data("type","percentage"),new he("分数","1/2").data("type","fraction"),new he("科学计数","9.50e-01").data("type","ENotation"),new ve,new he("人民币","￥5.00").data("type","rmb"),new he("港币","HK5.00").data("type","hk"),new he("美元","$5.00").data("type","dollar"),new ve,new he("日期","2018/4/18").data("type","date1"),new he("日期","4月18日").data("type","date2"),new he("日期","2018年4月").data("type","date3"),new he("日期","2018年4月18日").data("type","date4"),new he("日期","2018/4/18 14:30:30").data("type","date5"),new he("时间","14:30:30").data("type","time")],t.items.forEach((function(e){e instanceof he&&e.data("type")&&e.on(o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.data("type"),e.title),e.setActive()})),t.addItem(e)})),t.init(),t}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oe(t,e)}(e,t),n=e,(r=[{key:"init",value:function(){var t=this.options,e=this.items,n=t.el,o=e[0];n.setTitle(o.title),o.setActive()}},{key:"update",value:function(t,e){this.options.onUpdate(t,e),this.close()}},{key:"setActiveByType",value:function(t){this.items.forEach((function(e){e.data("type")===t&&e.setActive()}))}}])&&we(n.prototype,r),c&&we(n,c),e}(te);function xe(t){return(xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Te(t){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _e(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ke(t,e){return(ke=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pe=function(t){function e(t){var n,o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(r=Te(e).call(this,"".concat(i,"-tools-format")))||"object"!==xe(r)&&"function"!=typeof r?_e(o):r).options=S.copyProp({contextMenu:{}},t),n.setTitle("常规"),n.setWidth(50),n.setEllipsis(),n.formatContextMenu=new Se(S.copyProp({el:_e(n),position:Gt.BOTTOM},n.options.contextMenu)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ke(t,e)}(e,t),e}(Mt);function Ce(t){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function je(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Le(t){return(Le=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ae(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Re(t,e){return(Re=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ne=[],Ve=function(t){function e(t){var n,o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(r=Le(e).call(this,"".concat(i,"-font-context-menu-item")))||"object"!==Ce(r)&&"function"!=typeof r?Ae(o):r).title=t,n.icon=new it("checked"),n.iconElement=k("div","".concat(i,"-font-context-menu-item-icon")),n.iconElement.children(n.icon),n.titleElement=k("div","".concat(i,"-font-context-menu-item-title")),n.titleElement.text(t),n.titleElement.css("font-family",t),n.children(n.iconElement),n.children(n.titleElement),Ne.push(Ae(n)),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Re(t,e)}(e,t),n=e,(o=[{key:"setActive",value:function(){Ne.forEach((function(t){t.removeClass("active")})),this.addClass("active")}},{key:"setTitle",value:function(t){this.title=t,this.titleElement.text(t)}}])&&je(n.prototype,o),r&&je(n,r),e}(ie);function Ie(t){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Me(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function De(t,e){return!e||"object"!==Ie(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Be(t){return(Be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function He(t,e){return(He=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var We=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=De(this,Be(e).call(this,"".concat(i,"-font-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).items=[new Ve("Arial"),new Ve("Helvetica"),new Ve("Source Sans Pro"),new Ve("Comic Sans Ms"),new Ve("Courier New"),new Ve("Verdana"),new Ve("Lalo")],t.items.forEach((function(e){e.on(o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.title),e.setActive()})),t.addItem(e)})),t.setActiveByType(t.items[0].title),t}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&He(t,e)}(e,t),n=e,(r=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}},{key:"setActiveByType",value:function(t){this.items.forEach((function(e){e.title===t&&e.setActive()}))}}])&&Me(n.prototype,r),c&&Me(n,c),e}(te);function Fe(t){return(Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ye(t){return(Ye=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ge(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ze(t,e){return(ze=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ue=function(t){function e(t){var n,o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(r=Ye(e).call(this,"".concat(i,"-tools-font")))||"object"!==Fe(r)&&"function"!=typeof r?Ge(o):r).options=S.copyProp({contextMenu:{}},t),n.setTitle("Arial"),n.setWidth(50),n.setEllipsis(),n.fontContextMenu=new We(S.copyProp({el:Ge(n),position:Gt.BOTTOM},n.options.contextMenu)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ze(t,e)}(e,t),e}(Mt);function Xe(t){return(Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ke(t,e){return!e||"object"!==Xe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ze(t){return(Ze=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $e(t,e){return($e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qe=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ke(this,Ze(e).call(this,"".concat(i,"-font-size-context-menu-item")))).size=t,n.titleElement=k("div","".concat(i,"-font-size-context-menu-item-title")),n.titleElement.text(t),n.titleElement.css("text-align","center"),n.children(n.titleElement),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$e(t,e)}(e,t),e}(ie);function Je(t){return(Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qe(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function tn(t,e){return!e||"object"!==Je(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function en(t){return(en=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nn(t,e){return(nn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var on=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=tn(this,en(e).call(this,"".concat(i,"-font-size-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).items=[new qe(6),new qe(7),new qe(8),new qe(9),new qe(10),new qe(11),new qe(12),new qe(14),new qe(15),new qe(18),new qe(24),new qe(36)],t.items.forEach((function(e){e.on(o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.size)})),t.addItem(e)})),t}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nn(t,e)}(e,t),n=e,(r=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}}])&&Qe(n.prototype,r),c&&Qe(n,c),e}(te);function rn(t){return(rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cn(t){return(cn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ln(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function an(t,e){return(an=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sn=function(t){function e(){var t,n,o,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=cn(e).call(this,"".concat(i,"-tools-font-size")))||"object"!==rn(o)&&"function"!=typeof o?ln(n):o).options=r,t.setTitle("10"),t.setWidth(30),t.setEllipsis(),t.fontSizeContextMenu=new on(S.copyProp({el:ln(t),position:Gt.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&an(t,e)}(e,t),e}(Mt);function un(t){return(un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fn(t,e){return!e||"object"!==un(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hn(t){return(hn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pn(t,e){return(pn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=fn(this,hn(e).call(this,"".concat(i,"-tools-font-bold")))).icon=new it("font-bold"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pn(t,e)}(e,t),e}(ut);function bn(t){return(bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dn(t,e){return!e||"object"!==bn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vn(t){return(vn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gn(t,e){return(gn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=dn(this,vn(e).call(this,"".concat(i,"-tools-font-italic")))).icon=new it("font-italic"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gn(t,e)}(e,t),e}(ut);function mn(t){return(mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function En(t,e){return!e||"object"!==mn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function On(t){return(On=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sn(t,e){return(Sn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=En(this,On(e).call(this,"".concat(i,"-tools-under-line")))).icon=new it("under-line"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sn(t,e)}(e,t),e}(ut);function Tn(t){return(Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _n(t,e){return!e||"object"!==Tn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kn(t){return(kn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pn(t,e){return(Pn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Cn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=_n(this,kn(e).call(this,"".concat(i,"-tools-font-strike")))).icon=new it("font-strike"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pn(t,e)}(e,t),e}(ut);function jn(t){return(jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ln(t,e){return!e||"object"!==jn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function An(t){return(An=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rn(t,e){return(Rn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nn=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Ln(this,An(e).call(this,"".concat(i,"-font-color-context-menu-item")))).title=t,o.icon=n,n&&(o.iconElement=k("div","".concat(i,"-font-color-context-menu-item-icon")),o.iconElement.children(o.icon),o.children(o.iconElement)),t&&(o.titleElement=k("div","".concat(i,"-font-color-context-menu-item-title")),o.titleElement.text(t),o.children(o.titleElement)),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rn(t,e)}(e,t),e}(ie);function Vn(t){return(Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function In(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Mn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Dn(t,e){return(Dn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Bn(t,e,n){return(Bn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Hn(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Hn(t){return(Hn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Wn={LEFT:1,TOP:2,RIGHT:3,CENTER:4},Fn=[],Yn=null,Gn=function(t){function e(t){var n,o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,n=!(r=Hn(e).call(this,"".concat(i,"-drag-panel")))||"object"!==Vn(r)&&"function"!=typeof r?Mn(o):r,Fn.push(Mn(n)),n.options=S.mergeDeep({position:Wn.CENTER},t),n.off=!0,n.mask=k("div","".concat(i,"-drag-panel-mask")),n.content=k("div","".concat(i,"-drag-panel-content")),Bn(Hn(e.prototype),"children",Mn(n)).call(Mn(n),n.content),n.bind(),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dn(t,e)}(e,t),n=e,c=[{key:"removeInstance",value:function(t){var e=[];Fn.forEach((function(n){n!==t&&e.push(n)})),Fn=e}},{key:"closeAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Fn.forEach((function(e){-1===t.indexOf(e)&&e.close()}))}},{key:"setRoot",value:function(t){t=t.el?k(t.el):k(t),Yn=t}}],(r=[{key:"unbind",value:function(){var t=this.mask;A.unbind(t)}},{key:"bind",value:function(){var t=this,e=this.mask;A.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.close(),e.stopPropagation()})),A.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(0===e.button){var n=t.computeEventXy(e,t);A.mouseMoveUp(k(document),(function(e){var o=e.pageY-n.y,r=e.pageX-n.x;t.offset({top:o,left:r}),e.stopPropagation()})),e.stopPropagation()}}))}},{key:"children",value:function(){var t;return(t=this.content).children.apply(t,arguments),this}},{key:"position",value:function(){var t=this.options.position,e=S.viewPort(),n=e.width,o=e.height,r=this.box();switch(t){case Wn.LEFT:case Wn.RIGHT:case Wn.TOP:break;case Wn.CENTER:this.offset({left:n/2-r.width/2,top:o/2-r.height/2})}return this}},{key:"close",value:function(){if(!1===this.off&&Yn){var t=this.mask;Yn.remove(this),Yn.remove(t),this.off=!0}return this}},{key:"open",value:function(){if(this.off&&Yn){var t=this.mask;Yn.children(t),Yn.children(this),this.position(),this.off=!1}return this}},{key:"destroy",value:function(){Bn(Hn(e.prototype),"destroy",this).call(this),this.unbind(),e.removeInstance(this)}}])&&In(n.prototype,r),c&&In(n,c),e}(D);function zn(t){return(zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Un(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Xn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Kn(t,e,n){return(Kn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Zn(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Zn(t){return(Zn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $n(t,e){return($n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qn=function(t){function e(t){var n,o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(r=Zn(e).call(this,"".concat(i,"-color-picker")))||"object"!==zn(r)&&"function"!=typeof r?Xn(o):r).options=S.mergeDeep({selectCb:function(){}},t),n.dragPanel=new Gn,n.color=[360,0,100],n.preViewColorPoint=k("div","".concat(i,"-color-picker-pre-view-color-point")),n.colorValueTips=k("div","".concat(i,"-color-picker-color-value-tips")),n.colorValueTips.text("十六进制颜色值"),n.colorInput=k("input","".concat(i,"-color-picker-color-input")),n.top=k("div","".concat(i,"-color-picker-top")),n.top.children(n.preViewColorPoint),n.top.children(n.colorValueTips),n.top.children(n.colorInput),n.selectColorPoint=k("div","".concat(i,"-color-picker-select-color-point")),n.selectColorArea1=k("div","".concat(i,"-color-picker-select-color-area area1")),n.selectColorArea2=k("div","".concat(i,"-color-picker-select-color-area area2")),n.selectColorArea3=k("div","".concat(i,"-color-picker-select-color-area area3")),n.center=k("div","".concat(i,"-color-picker-center")),n.center.children(n.selectColorArea1),n.center.children(n.selectColorArea2),n.center.children(n.selectColorArea3),n.center.children(n.selectColorPoint),n.colorHuxTips=k("div","".concat(i,"-color-picker-color-hux-tips")),n.colorBar=k("div","".concat(i,"-color-picker-color-bar")),n.colorBarPoint=k("div","".concat(i,"-color-picker-bar-point")),n.bottom=k("div","".concat(i,"-color-picker-bottom")),n.colorHuxTips.text("HUE"),n.colorBar.children(n.colorBarPoint),n.bottom.children(n.colorHuxTips),n.bottom.children(n.colorBar),n.cancelButton=k("div","".concat(i,"-color-picker-button cancel")),n.selectButton=k("div","".concat(i,"-color-picker-button select")),n.buttons=k("div","".concat(i,"-color-picker-buttons")),n.cancelButton.text("取消"),n.selectButton.text("确定"),n.buttons.children(n.selectButton),n.buttons.children(n.cancelButton),n.children(n.top),n.children(n.center),n.children(n.bottom),n.children(n.buttons),n.dragPanel.children(Xn(n)),n.dragPanel.css("background","#ffffff"),n.bind(),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$n(t,e)}(e,t),n=e,c=[{key:"fixHex",value:function(t){var e=6-t.length;if(e>0){for(var n=[],o=0;o<e;o+=1)n.push("0");n.push(t),t=n.join("")}return t}},{key:"fixHsx",value:function(t){return{h:Math.min(360,Math.max(0,t.h)),s:Math.min(100,Math.max(0,t.s)),x:Math.min(100,Math.max(0,t.x))}}},{key:"hexToRgb",value:function(t){return{r:(t=parseInt(t.indexOf("#")>-1?t.substring(1):t,16))>>16,g:(65280&t)>>8,b:255&t}}},{key:"hexToHsb",value:function(t){return this.rgbToHsb(this.hexToRgb(t))}},{key:"rgbToHsb",value:function(t){var e={h:0,s:0,x:0},n=Math.min(t.r,t.g,t.b),o=Math.max(t.r,t.g,t.b),r=o-n;return e.x=o,e.s=0!==o?255*r/o:0,0!==e.s?t.r===o?e.h=(t.g-t.b)/r:t.g===o?e.h=2+(t.b-t.r)/r:e.h=4+(t.r-t.g)/r:e.h=-1,e.h*=60,e.h<0&&(e.h+=360),e.s*=100/255,e.x*=100/255,e}},{key:"hsbToRgb",value:function(t){var e={},n=t.h,o=255*t.s/100,r=255*t.x/100;if(0===o)e.r=r,e.g=r,e.b=r;else{var i=r,c=(255-o)*r/255,l=n%60*(i-c)/60;360===n&&(n=0),n<60?(e.r=i,e.b=c,e.g=c+l):n<120?(e.g=i,e.b=c,e.r=i-l):n<180?(e.g=i,e.r=c,e.b=c+l):n<240?(e.b=i,e.r=c,e.g=i-l):n<300?(e.b=i,e.g=c,e.r=c+l):n<360?(e.r=i,e.g=c,e.b=i-l):(e.r=0,e.g=0,e.b=0)}return{r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)}}},{key:"rgbToHex",value:function(t){var e=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return e.forEach((function(t,n){1===t.length&&(e[n]="0".concat(t))})),e.join("")}},{key:"hsbToHex",value:function(t){return this.rgbToHex(this.hsbToRgb(t))}},{key:"isRgb",value:function(t){return t.startsWith("rgb")}},{key:"isHex",value:function(t){return t.startsWith("#")}},{key:"parseRgb",value:function(t){var e=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return{r:e[1],g:e[2],b:e[3]}}},{key:"isDark",value:function(t){if(S.isBlank(t))return!1;if(this.isHex(t)){var n=e.hexToRgb(t);t="rgb(".concat(n.r,", ").concat(n.g,", ").concat(n.b,")")}var o=e.parseRgb(t);return.299*parseInt(o.r,10)+.578*parseInt(o.g,10)+.114*parseInt(o.b,10)>=192}}],(r=[{key:"unbind",value:function(){var t=this.selectColorPoint,e=this.colorBarPoint,n=this.colorInput,o=this.cancelButton,r=this.selectButton;A.unbind(n),A.unbind(n),A.unbind(e),A.unbind(t),A.unbind(o),A.unbind(r)}},{key:"bind",value:function(){var t=this,n=this.selectColorPoint,r=this.center,i=this.colorBarPoint,c=this.colorBar,l=this.colorInput,a=this.cancelButton,s=this.selectButton;A.bind(l,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){t.stopPropagation()})),A.bind(l,o.SYSTEM_EVENT_TYPE.CHANGE,(function(){var e=l.val();e&&t.hexColor(e)})),A.bind(i,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.computeEventXy(e,c),o=c.box();n.x<0&&(n.x=0),n.x>o.width&&(n.x=o.width),t.downHue(n.x,o.width),A.mouseMoveUp(k(document),(function(e){var n=t.computeEventXy(e,c),o=c.box();n.x<0&&(n.x=0),n.x>o.width&&(n.x=o.width),t.moveHue(n.x,o.width)})),e.stopPropagation()})),A.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.computeEventXy(e,r),o=r.box();n.x<0&&(n.x=0),n.x>o.width&&(n.x=o.width),n.y<0&&(n.y=0),n.y>o.height&&(n.y=o.height),t.downSelect(n.x,n.y,o.width,o.height),A.mouseMoveUp(k(document),(function(e){var n=t.computeEventXy(e,r);n.x<0&&(n.x=0),n.x>o.width&&(n.x=o.width),n.y<0&&(n.y=0),n.y>o.height&&(n.y=o.height),t.moveSelect(n.x,n.y,o.width,o.height)})),e.stopPropagation()})),A.bind(a,o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.close()})),A.bind(s,o.SYSTEM_EVENT_TYPE.CLICK,(function(){var n=t.color,o=e.fixHsx({h:parseInt(n[0],10),s:parseInt(n[1],10),x:parseInt(n[2],10)}),r=e.hsbToHex(o);t.options.selectCb("#".concat(r)),t.close()}))}},{key:"open",value:function(t){if(this.dragPanel.open(),t){if(e.isRgb(t)){var n=e.parseRgb(t);t=e.rgbToHex(n)}this.hexColor(t)}else this.change();return this}},{key:"close",value:function(){return this.dragPanel.close(),this}},{key:"sliderPosition",value:function(t){var e=this.colorBar,n=this.colorBarPoint,o=n.box(),r=e.box(),i=parseInt(r.width-r.width*t.h/360,10);i-=o.width/2,n.offset({left:i});var c=this.center,l=this.selectColorPoint,a=l.box(),s=c.box(),u=parseInt(s.width*t.s/100,10),f=parseInt(s.height*(100-t.x)/100,10);u-=a.width/2,f-=a.height/2,l.offset({left:u,top:f})}},{key:"hueChange",value:function(){var t=this.color,n=e.fixHsx({h:parseInt(t[0],10),s:parseInt(t[1],10),x:parseInt(t[2],10)}),o=this.colorBarPoint,r=this.selectColorPoint,i=this.preViewColorPoint,c=this.selectColorArea1,l=this.colorInput,a=e.hsbToHex(n),s=e.hsbToHex({h:n.h,s:100,x:100});r.css("backgroundColor","#".concat(a)),i.css("backgroundColor","#".concat(a)),o.css("backgroundColor","#".concat(s)),c.css("backgroundColor","#".concat(s)),l.val("#".concat(a)),this.sliderPosition(n)}},{key:"selectChange",value:function(){var t=this.color,n=e.fixHsx({h:parseInt(t[0],10),s:parseInt(t[1],10),x:parseInt(t[2],10)}),o=this.preViewColorPoint,r=this.selectColorPoint,i=this.colorInput,c=e.hsbToHex(n);r.css("backgroundColor","#".concat(c)),o.css("backgroundColor","#".concat(c)),i.val("#".concat(c)),this.sliderPosition(n)}},{key:"change",value:function(){this.hueChange(),this.selectChange()}},{key:"downSelect",value:function(t,e,n,o){var r=this.color;r[1]=parseInt(100*t/n,10),r[2]=parseInt(100*(o-e)/o,10),this.selectChange()}},{key:"moveSelect",value:function(t,e,n,o){var r=this.color;r[1]=parseInt(100*Math.max(0,Math.min(n,t))/n,10),r[2]=parseInt(100*(o-Math.max(0,Math.min(o,e)))/o,10),this.selectChange()}},{key:"downHue",value:function(t,e){this.color[0]=parseInt(360*(e-t)/e,10),this.hueChange()}},{key:"moveHue",value:function(t,e){this.color[0]=parseInt(360*(e-Math.max(0,Math.min(e,t)))/e,10),this.hueChange()}},{key:"hexColor",value:function(t){var n=this.color,o=e.hexToHsb(e.fixHex(t));n[0]=o.h,n[1]=o.s,n[2]=o.x,this.change()}},{key:"destroy",value:function(){Kn(Zn(e.prototype),"destroy",this).call(this),this.unbind(),this.dragPanel.destroy()}}])&&Un(n.prototype,r),c&&Un(n,c),e}(D);function Jn(t){return(Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function to(t,e){return!e||"object"!==Jn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function eo(t){return(eo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function no(t,e){return(no=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var oo=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=to(this,eo(e).call(this,"".concat(i,"-color-array-item")))).options=S.mergeDeep({color:null,icon:null},t),n.color=n.options.color,n.icon=n.options.icon,n.color&&(n.css("backgroundColor",n.color),qn.isDark(n.options.color)?(n.checkedIcon=new it("checked-dark"),n.children(n.checkedIcon)):(n.checkedIcon=new it("checked-light"),n.children(n.checkedIcon)),n.checkedIcon.hide()),n.icon&&n.children(n.options.icon),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&no(t,e)}(e,t),n=e,(o=[{key:"setActive",value:function(t){this.checkedIcon&&(t?this.checkedIcon.show():this.checkedIcon.hide())}}])&&Qn(n.prototype,o),r&&Qn(n,r),e}(D);function ro(t){return(ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function io(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function co(t,e){return!e||"object"!==ro(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function lo(t){return(lo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ao(t,e){return(ao=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var so=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=co(this,lo(e).call(this,"".concat(i,"-color-array")))).options=S.mergeDeep({colors:[new oo({color:"rgb(0,0,0)"}),new oo({color:"rgb(67, 67, 67)"}),new oo({color:"rgb(102, 102, 102)"}),new oo({color:"rgb(153, 153, 153)"}),new oo({color:"rgb(183, 183, 183)"}),new oo({color:"rgb(204, 204, 204)"}),new oo({color:"rgb(217, 217, 217)"}),new oo({color:"rgb(239, 239, 239)"}),new oo({color:"rgb(255, 255, 255)"}),new oo({color:"rgb(152, 0, 0)"}),new oo({color:"rgb(255, 0, 0)"}),new oo({color:"rgb(255, 153, 0)"}),new oo({color:"rgb(255, 255, 0)"}),new oo({color:"rgb(0, 255, 0)"}),new oo({color:"rgb(0, 255, 255)"}),new oo({color:"rgb(74, 134, 232)"}),new oo({color:"rgb(0, 0, 255)"}),new oo({color:"rgb(153, 0, 255)"}),new oo({color:"rgb(255, 0, 255)"}),new oo({color:"rgb(230, 184, 175)"}),new oo({color:"rgb(244, 204, 204)"}),new oo({color:"rgb(252, 229, 205)"}),new oo({color:"rgb(255, 242, 204)"}),new oo({color:"rgb(217, 234, 211)"}),new oo({color:"rgb(208, 224, 227)"}),new oo({color:"rgb(201, 218, 248)"}),new oo({color:"rgb(207, 226, 243)"}),new oo({color:"rgb(217, 210, 233)"}),new oo({color:"rgb(234, 209, 220)"}),new oo({color:"rgb(221, 126, 107)"}),new oo({color:"rgb(234, 153, 153)"}),new oo({color:"rgb(249, 203, 156)"}),new oo({color:"rgb(255, 229, 153)"}),new oo({color:"rgb(182, 215, 168)"}),new oo({color:"rgb(162, 196, 201)"}),new oo({color:"rgb(164, 194, 244)"}),new oo({color:"rgb(159, 197, 232)"}),new oo({color:"rgb(180, 167, 214)"}),new oo({color:"rgb(213, 166, 189)"}),new oo({color:"rgb(204, 65, 37)"}),new oo({color:"rgb(224, 102, 102)"}),new oo({color:"rgb(246, 178, 107)"}),new oo({color:"rgb(255, 217, 102)"}),new oo({color:"rgb(147, 196, 125)"}),new oo({color:"rgb(118, 165, 175)"}),new oo({color:"rgb(109, 158, 235)"}),new oo({color:"rgb(111, 168, 220)"}),new oo({color:"rgb(142, 124, 195)"}),new oo({color:"rgb(194, 123, 160)"}),new oo({color:"rgb(166, 28, 0)"}),new oo({color:"rgb(204, 0, 0)"}),new oo({color:"rgb(230, 145, 56)"}),new oo({color:"rgb(241, 194, 50)"}),new oo({color:"rgb(106, 168, 79)"}),new oo({color:"rgb(69, 129, 142)"}),new oo({color:"rgb(60, 120, 216)"}),new oo({color:"rgb(61, 133, 198)"}),new oo({color:"rgb(103, 78, 167)"}),new oo({color:"rgb(166, 77, 121)"}),new oo({color:"rgb(133, 32, 12)"}),new oo({color:"rgb(153, 0, 0)"}),new oo({color:"rgb(180, 95, 6)"}),new oo({color:"rgb(191, 144, 0)"}),new oo({color:"rgb(56, 118, 29)"}),new oo({color:"rgb(19, 79, 92)"}),new oo({color:"rgb(17, 85, 204)"}),new oo({color:"rgb(11, 83, 148)"}),new oo({color:"rgb(53, 28, 117)"}),new oo({color:"rgb(116, 27, 71)"}),new oo({color:"rgb(91, 15, 0)"}),new oo({color:"rgb(102, 0, 0)"}),new oo({color:"rgb(120, 63, 4)"}),new oo({color:"rgb(127, 96, 0)"}),new oo({color:"rgb(39, 78, 19)"}),new oo({color:"rgb(12, 52, 61)"}),new oo({color:"rgb(28, 69, 135)"}),new oo({color:"rgb(7, 55, 99)"}),new oo({color:"rgb(32, 18, 77)"}),new oo({color:"rgb(76, 17, 48)"})],selectCb:function(){}},t),n.colors=n.options.colors,n.activeColor=null,n.colors.forEach((function(t){n.children(t),t.on(o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){n.options.selectCb(t),t.options.color&&n.setActiveByColor(t.options.color)}))})),n.colors.length>0&&n.setActiveByColor(n.colors[0].options.color),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ao(t,e)}(e,t),n=e,(r=[{key:"add",value:function(t){var e=this;t.on(o.SYSTEM_EVENT_TYPE.CLICK,(function(){e.options.selectCb(t),t.options.color&&e.setActiveByColor(t.options.color)})),this.colors.push(t),this.children(t)}},{key:"setActiveByColor",value:function(t){var e=this;this.colors.forEach((function(n){var o=n.options;o.color===t?(n.setActive(!0),e.activeColor=o.color):n.setActive(!1)}))}}])&&io(n.prototype,r),c&&io(n,c),e}(D);function uo(t){return(uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fo(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ho(t,e){return!e||"object"!==uo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function po(t){return(po=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yo(t,e){return(yo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bo=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ho(this,po(e).call(this,"".concat(i,"-font-color-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).colorPicker=new qn({selectCb:function(e){var n=new oo({color:e});t.customizeColorArray.add(n),t.customizeColorArray.setActiveByColor(e),t.colorArray.setActiveByColor(null),t.options.onUpdate(e),t.close()}}),t.reset=new Nn("重置",new it("clear-color")),t.reset.on(o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.options.onUpdate("rgb(0,0,0)"),t.customizeColorArray.setActiveByColor(null),t.colorArray.setActiveByColor(null)})),t.array=new Nn,t.array.removeClass("hover"),t.colorArray=new so({selectCb:function(e){var n=e.options.color;n&&t.options.onUpdate(n),t.customizeColorArray.setActiveByColor(null),t.close()}}),t.array.children(t.colorArray),t.title=k("div","".concat(i,"-font-color-context-menu-color-title")),t.title.text("自定义"),t.plus=new it("plus"),t.customizeColorArray=new so({colors:[new oo({icon:t.plus})],selectCb:function(e){var n=e.options.color;n?(t.options.onUpdate(n),t.colorArray.setActiveByColor(null),t.close()):t.colorPicker.open(t.customizeColorArray.activeColor)}}),t.customize=new Nn,t.customize.removeClass("hover"),t.customize.children(t.title),t.customize.children(t.customizeColorArray),t.addItem(t.reset),t.addItem(t.array),t.addItem(new ve),t.addItem(t.customize),t}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yo(t,e)}(e,t),n=e,(r=[{key:"setActiveByColor",value:function(t){this.customizeColorArray.setActiveByColor(t),this.colorArray.setActiveByColor(t)}}])&&fo(n.prototype,r),c&&fo(n,c),e}(te);function vo(t){return(vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function go(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function wo(t){return(wo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mo(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Eo(t,e){return(Eo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Oo=function(t){function e(t){var n,o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(r=wo(e).call(this,"".concat(i,"-tools-font-color")))||"object"!==vo(r)&&"function"!=typeof r?mo(o):r).options=S.mergeDeep({contextMenu:{}},t),n.icon=new it("color"),n.fontColorContextMenu=new bo(S.copyProp({el:mo(n),position:Gt.BOTTOM},n.options.contextMenu)),n.setIcon(n.icon),n.setColor("rgb(0,0,0)"),n.fontColorContextMenu.setActiveByColor("rgb(0,0,0)"),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Eo(t,e)}(e,t),n=e,(o=[{key:"setColor",value:function(t){this.icon.css("border-bottom","3px solid ".concat(t))}}])&&go(n.prototype,o),r&&go(n,r),e}(Mt);function So(t){return(So="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xo(t,e){return!e||"object"!==So(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function To(t){return(To=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _o(t,e){return(_o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ko=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=xo(this,To(e).call(this,"".concat(i,"-fill-color-context-menu-item")))).title=t,o.icon=n,n&&(o.iconElement=k("div","".concat(i,"-fill-color-context-menu-item-icon")),o.iconElement.children(o.icon),o.children(o.iconElement)),t&&(o.titleElement=k("div","".concat(i,"-fill-color-context-menu-item-title")),o.titleElement.text(t),o.children(o.titleElement)),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_o(t,e)}(e,t),e}(ie);function Po(t){return(Po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Co(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function jo(t,e){return!e||"object"!==Po(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lo(t){return(Lo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ao(t,e){return(Ao=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ro=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=jo(this,Lo(e).call(this,"".concat(i,"-font-color-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).colorPicker=new qn({selectCb:function(e){var n=new oo({color:e});t.customizeColorArray.add(n),t.customizeColorArray.setActiveByColor(e),t.colorArray.setActiveByColor(null),t.options.onUpdate(e),t.close()}}),t.reset=new ko("重置",new it("clear-color")),t.reset.on(o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.options.onUpdate(null),t.customizeColorArray.setActiveByColor(null),t.colorArray.setActiveByColor(null)})),t.array=new ko,t.array.removeClass("hover"),t.colorArray=new so({selectCb:function(e){var n=e.options.color;n&&t.options.onUpdate(n),t.customizeColorArray.setActiveByColor(null),t.close()}}),t.array.children(t.colorArray),t.title=k("div","".concat(i,"-font-color-context-menu-color-title")),t.title.text("自定义"),t.plus=new it("plus"),t.customizeColorArray=new so({colors:[new oo({icon:t.plus})],selectCb:function(e){var n=e.options.color;n?(t.options.onUpdate(n),t.colorArray.setActiveByColor(null),t.close()):t.colorPicker.open(t.customizeColorArray.activeColor)}}),t.customize=new ko,t.customize.removeClass("hover"),t.customize.children(t.title),t.customize.children(t.customizeColorArray),t.addItem(t.reset),t.addItem(t.array),t.addItem(new ve),t.addItem(t.customize),t}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ao(t,e)}(e,t),n=e,(r=[{key:"setActiveByColor",value:function(t){this.customizeColorArray.setActiveByColor(t),this.colorArray.setActiveByColor(t)}}])&&Co(n.prototype,r),c&&Co(n,c),e}(te);function No(t){return(No="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vo(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Io(t){return(Io=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mo(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Do(t,e){return(Do=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bo=function(t){function e(t){var n,o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(r=Io(e).call(this,"".concat(i,"-tools-fill-color")))||"object"!==No(r)&&"function"!=typeof r?Mo(o):r).options=S.mergeDeep({contextMenu:{}},t),n.icon=new it("fill-color"),n.fillColorContextMenu=new Ro(S.copyProp({el:Mo(n),position:Gt.BOTTOM},n.options.contextMenu)),n.setIcon(n.icon),n.setColor("rgb(255, 255, 255)"),n.fillColorContextMenu.setActiveByColor("rgb(255, 255, 255)"),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Do(t,e)}(e,t),n=e,(o=[{key:"setColor",value:function(t){this.icon.css("border-bottom","3px solid ".concat(t))}}])&&Vo(n.prototype,o),r&&Vo(n,r),e}(Mt);function Ho(t){return(Ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wo(t,e){return!e||"object"!==Ho(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fo(t){return(Fo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yo(t,e){return(Yo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Go=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Wo(this,Fo(e).call(this,"".concat(i,"-border-type-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yo(t,e)}(e,t),e}(ie);function zo(t){return(zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uo(t,e){return!e||"object"!==zo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xo(t){return(Xo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ko(t,e){return(Ko=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zo=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Uo(this,Xo(e).call(this,"".concat(i,"-tools-border1")))).icon=new it("border1"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ko(t,e)}(e,t),e}(ut);function $o(t){return($o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qo(t,e){return!e||"object"!==$o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jo(t){return(Jo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qo(t,e){return(Qo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var tr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=qo(this,Jo(e).call(this,"".concat(i,"-tools-border2")))).icon=new it("border2"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qo(t,e)}(e,t),e}(ut);function er(t){return(er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nr(t,e){return!e||"object"!==er(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function or(t){return(or=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rr(t,e){return(rr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ir=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=nr(this,or(e).call(this,"".concat(i,"-tools-border3")))).icon=new it("border3"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rr(t,e)}(e,t),e}(ut);function cr(t){return(cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lr(t,e){return!e||"object"!==cr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ar(t){return(ar=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sr(t,e){return(sr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ur=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=lr(this,ar(e).call(this,"".concat(i,"-tools-border4")))).icon=new it("border4"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sr(t,e)}(e,t),e}(ut);function fr(t){return(fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hr(t,e){return!e||"object"!==fr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pr(t){return(pr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yr(t,e){return(yr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var br=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=hr(this,pr(e).call(this,"".concat(i,"-tools-border5")))).icon=new it("border5"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yr(t,e)}(e,t),e}(ut);function dr(t){return(dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vr(t,e){return!e||"object"!==dr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gr(t){return(gr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wr(t,e){return(wr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=vr(this,gr(e).call(this,"".concat(i,"-tools-border6")))).icon=new it("border6"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wr(t,e)}(e,t),e}(ut);function Er(t){return(Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Or(t,e){return!e||"object"!==Er(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sr(t){return(Sr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xr(t,e){return(xr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Or(this,Sr(e).call(this,"".concat(i,"-tools-border7")))).icon=new it("border7"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xr(t,e)}(e,t),e}(ut);function _r(t){return(_r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kr(t,e){return!e||"object"!==_r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pr(t){return(Pr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cr(t,e){return(Cr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=kr(this,Pr(e).call(this,"".concat(i,"-tools-border8")))).icon=new it("border8"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cr(t,e)}(e,t),e}(ut);function Lr(t){return(Lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ar(t,e){return!e||"object"!==Lr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rr(t){return(Rr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nr(t,e){return(Nr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ar(this,Rr(e).call(this,"".concat(i,"-tools-border9")))).icon=new it("border9"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nr(t,e)}(e,t),e}(ut);function Ir(t){return(Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mr(t,e){return!e||"object"!==Ir(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dr(t){return(Dr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Br(t,e){return(Br=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Mr(this,Dr(e).call(this,"".concat(i,"-tools-border10")))).icon=new it("border10"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Br(t,e)}(e,t),e}(ut);function Wr(t){return(Wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fr(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Yr(t,e){return!e||"object"!==Wr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gr(t){return(Gr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zr(t,e){return(zr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ur=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Yr(this,Gr(e).call(this,"".concat(i,"-tools-border-color")))).icon=new it("border-color"),t.setIcon(t.icon),t.setColor("#000000"),t}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zr(t,e)}(e,t),n=e,(o=[{key:"setColor",value:function(t){this.icon.css("border-bottom","3px solid ".concat(t))}}])&&Fr(n.prototype,o),r&&Fr(n,r),e}(Mt);function Xr(t){return(Xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kr(t,e){return!e||"object"!==Xr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zr(t){return(Zr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $r(t,e){return($r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Kr(this,Zr(e).call(this,"".concat(i,"-tools-border-type")))).icon=new it("border-type"),t.setIcon(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$r(t,e)}(e,t),e}(Mt);function Jr(t){return(Jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qr(t,e){return!e||"object"!==Jr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ti(t){return(ti=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ei(t,e){return(ei=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ni=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Qr(this,ti(e).call(this,"".concat(i,"-border-color-context-menu-item")))).title=t,o.icon=n,n&&(o.iconElement=k("div","".concat(i,"-border-color-context-menu-item-icon")),o.iconElement.children(o.icon),o.children(o.iconElement)),t&&(o.titleElement=k("div","".concat(i,"-border-color-context-menu-item-title")),o.titleElement.text(t),o.children(o.titleElement)),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ei(t,e)}(e,t),e}(ie);function oi(t){return(oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ri(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ii(t,e){return!e||"object"!==oi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ci(t){return(ci=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function li(t,e){return(li=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ai=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ii(this,ci(e).call(this,"".concat(i,"-border-color-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).colorPicker=new qn({selectCb:function(e){var n=new oo({color:e});t.customizeColorArray.add(n),t.customizeColorArray.setActiveByColor(e),t.colorArray.setActiveByColor(null),t.options.onUpdate(e),t.close()}}),t.reset=new ni("重置",new it("clear-color")),t.reset.on(o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.options.onUpdate("rgb(0,0,0)"),t.customizeColorArray.setActiveByColor(null),t.colorArray.setActiveByColor(null)})),t.array=new ni,t.array.removeClass("hover"),t.colorArray=new so({selectCb:function(e){var n=e.options.color;n&&t.options.onUpdate(n),t.customizeColorArray.setActiveByColor(null),t.close()}}),t.array.children(t.colorArray),t.title=k("div","".concat(i,"-border-color-context-menu-color-title")),t.title.text("自定义"),t.plus=new it("plus"),t.customizeColorArray=new so({colors:[new oo({icon:t.plus})],selectCb:function(e){var n=e.options.color;n?(t.options.onUpdate(n),t.colorArray.setActiveByColor(null),t.close()):t.colorPicker.open(t.customizeColorArray.activeColor)}}),t.customize=new ni,t.customize.removeClass("hover"),t.customize.children(t.title),t.customize.children(t.customizeColorArray),t.addItem(t.reset),t.addItem(t.array),t.addItem(new ve),t.addItem(t.customize),t}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&li(t,e)}(e,t),n=e,(r=[{key:"setActiveByColor",value:function(t){this.customizeColorArray.setActiveByColor(t),this.colorArray.setActiveByColor(t)}}])&&ri(n.prototype,r),c&&ri(n,c),e}(te);function si(t){return(si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ui(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function fi(t){return(fi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pi(t,e){return(pi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yi=[],bi=function(t){function e(t){var n,o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(r=fi(e).call(this,"".concat(i,"-font-context-menu-item")))||"object"!==si(r)&&"function"!=typeof r?hi(o):r).type=t,n.icon=new it("checked"),n.typeIcon=new it(t),n.typeIcon.setWidth(50),n.iconElement=k("div","".concat(i,"-font-context-menu-item-icon")),n.titleElement=k("div","".concat(i,"-font-context-menu-item-title")),n.iconElement.children(n.icon),n.titleElement.children(n.typeIcon),n.children(n.iconElement),n.children(n.titleElement),yi.push(hi(n)),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pi(t,e)}(e,t),n=e,(o=[{key:"setTitle",value:function(t){this.title=t,this.titleElement.text(t)}},{key:"setActive",value:function(){yi.forEach((function(t){t.removeClass("active")})),this.addClass("active")}}])&&ui(n.prototype,o),r&&ui(n,r),e}(ie);function di(t){return(di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vi(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function gi(t,e){return!e||"object"!==di(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wi(t){return(wi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mi(t,e){return(mi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ei=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=gi(this,wi(e).call(this,"".concat(i,"-line-type-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).items=[new bi("line1"),new bi("line2"),new bi("line3"),new bi("line4"),new bi("line5"),new bi("line6")],t.items.forEach((function(e){e.on(o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.type),e.setActive()})),t.addItem(e)})),t.setActiveByType(t.items[0].type),t}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mi(t,e)}(e,t),n=e,(r=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}},{key:"setActiveByType",value:function(t){this.items.forEach((function(e){e.type===t&&e.setActive()}))}}])&&vi(n.prototype,r),c&&vi(n,c),e}(te);function Oi(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Si(t,e,n){return(Si="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_i(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function xi(t){return(xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ti(t,e){return!e||"object"!==xi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _i(t){return(_i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ki(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pi(t,e)}function Pi(t,e){return(Pi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ci(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ji(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Li(t,e,n){return e&&ji(t.prototype,e),n&&ji(t,n),t}var Ai=window.devicePixelRatio||1,Ri=Math.round(Ai),Ni=Ri+2,Vi=Ni+2,Ii=Ri/2,Mi=function(){function t(e){Ci(this,t),this.canvas=e,this.ctx=e.getContext("2d")}return Li(t,null,[{key:"rounding",value:function(t){return Math.round(t)}},{key:"radian",value:function(t){return-t*(Math.PI/180)}},{key:"dpr",value:function(){return Ai}},{key:"transformStylePx",value:function(t){return this.rounding(t*this.dpr())}},{key:"transformCssPx",value:function(t){return this.transformStylePx(t)/this.dpr()}}]),Li(t,[{key:"attr",value:function(t){for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];("string"==typeof n||n instanceof String)&&(n=n.trim()),this.ctx[e]!==n&&(this.ctx[e]=n)}return this}},{key:"resize",value:function(e,n){var o=this.canvas;return o.width=t.transformStylePx(e),o.height=t.transformStylePx(n),o.style.width="".concat(o.width/t.dpr(),"px"),o.style.height="".concat(o.height/t.dpr(),"px"),this}}]),t}(),Di=function(t){function e(t){var n;return Ci(this,e),(n=Ti(this,_i(e).call(this,t))).lineWidthType=e.LINE_WIDTH_TYPE.low,n.lineColor="#000000",n}return ki(e,t),Li(e,null,[{key:"offsetToLineInside",value:function(t){return Ri>1?t-Ri/2:t-1}}]),Li(e,[{key:"corsLine",value:function(t,n){var o=this,r=Oi(t,2),i=r[0],c=r[1],l=Oi(n,2),a=l[0],s=l[1],u=this.lineWidthType,f=this.lineColor,h=Ri;switch(u){case e.LINE_WIDTH_TYPE.medium:h=Ni;break;case e.LINE_WIDTH_TYPE.low:h=Ri;break;case e.LINE_WIDTH_TYPE.high:h=Vi}this.attr({strokeStyle:f,lineWidth:h}),this.polyline((function(t){var e=Oi(t,2),n=e[0],r=e[1];return[Mi.rounding(n+o.getOffsetX())-Ii,Mi.rounding(r+o.getOffsetY())-Ii]}),[i,c],[a,s])}},{key:"setLineColor",value:function(t){this.lineColor=t}},{key:"setLineWidthType",value:function(t){this.lineWidthType=t}},{key:"horizonLine",value:function(t,e){var n=Oi(t,2),o=n[0],r=n[1],i=Oi(e,2),c=i[0],l=i[1];if(r!==l)throw new TypeError("Error Horizon Line");this.corsLine([o,r],[c,l])}},{key:"verticalLine",value:function(t,e){var n=Oi(t,2),o=n[0],r=n[1],i=Oi(e,2),c=i[0],l=i[1];if(o!==c)throw new TypeError("Error Vertical Line");this.corsLine([o,r],[c,l])}}]),e}(function(t){function e(){return Ci(this,e),Ti(this,_i(e).apply(this,arguments))}return ki(e,t),Li(e,[{key:"line",value:function(){for(var t=this,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return this.polyline.apply(this,[function(e){var n=Oi(e,2),o=n[0],r=n[1];return[t.transformLinePx(Mi.rounding(o+t.getOffsetX())),t.transformLinePx(Mi.rounding(r+t.getOffsetY()))]}].concat(n)),this}},{key:"transformLinePx",value:function(t){return this.ctx.lineWidth%2==0?t:t-.5}}]),e}(function(t){function e(t){var n;return Ci(this,e),(n=Ti(this,_i(e).call(this,t))).offsetX=0,n.offsetY=0,n}return ki(e,t),Li(e,[{key:"offset",value:function(t,e){this.offsetX=t,this.offsetY=e}},{key:"getOffsetX",value:function(){return this.offsetX}},{key:"getOffsetY",value:function(){return this.offsetY}},{key:"fillText",value:function(){throw TypeError("child impl")}},{key:"fillRect",value:function(){throw TypeError("child impl")}},{key:"rect",value:function(){throw TypeError("child impl")}},{key:"drawImage",value:function(){throw TypeError("child impl")}}]),e}(function(t){function e(){return Ci(this,e),Ti(this,_i(e).apply(this,arguments))}return ki(e,t),Li(e,[{key:"fullRect",value:function(){var t=this.canvas,e=t.width,n=t.height;return this.ctx.fillRect(0,0,e,n),this}},{key:"polyline",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(t){return t},e=this.ctx;if((arguments.length<=1?0:arguments.length-1)>1){this.beginPath();var n=t(arguments.length<=1?void 0:arguments[1]),o=Oi(n,2),r=o[0],i=o[1];e.moveTo(r,i);for(var c=1,l=arguments.length<=1?0:arguments.length-1;c<l;c+=1){var a=t(c+1<1||arguments.length<=c+1?void 0:arguments[c+1]),s=Oi(a,2),u=s[0],f=s[1];e.lineTo(u,f)}e.stroke()}}},{key:"rotate",value:function(t){return Si(_i(e.prototype),"rotate",this).call(this,Mi.radian(t)),this}}]),e}(function(t){function e(t){var n;return Ci(this,e),(n=Ti(this,_i(e).call(this,t))).dash=[],n}return ki(e,t),Li(e,[{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"measureText",value:function(t){return this.ctx.measureText(t)}},{key:"save",value:function(){return this.ctx.save(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"fill",value:function(){return this.ctx.fill(),this}},{key:"clip",value:function(){return this.ctx.clip(),this}},{key:"setLineDash",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this.ctx;return this.dash=t,e.setLineDash(t),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"translate",value:function(t,e){return this.ctx.translate(t,e),this}},{key:"rotate",value:function(t){return this.ctx.rotate(t),this}}]),e}(Mi)))));Di.LINE_WIDTH_TYPE={low:"low",medium:"medium",high:"high"};var Bi=function(t){function e(){return Ci(this,e),Ti(this,_i(e).apply(this,arguments))}return ki(e,t),Li(e,[{key:"fillText",value:function(t,n,o){return n+=this.getOffsetX(),o+=this.getOffsetY(),this.ctx.fillText(t,e.rounding(n),e.rounding(o)),this}},{key:"fillRect",value:function(t,n,o,r){return t+=this.getOffsetX(),n+=this.getOffsetY(),this.ctx.fillRect(e.rounding(t),e.rounding(n),e.rounding(o),e.rounding(r)),this}},{key:"rect",value:function(t,n,o,r){return t+=this.getOffsetX(),n+=this.getOffsetY(),this.ctx.rect(e.rounding(t),e.rounding(n),e.rounding(o),e.rounding(r)),this}},{key:"drawImage",value:function(t,n,o,r,i,c,l,a,s){var u=this.ctx;return n+=this.getOffsetX(),o+=this.getOffsetY(),c+=this.getOffsetX(),l+=this.getOffsetY(),u.drawImage(t,e.rounding(n),e.rounding(o),e.rounding(r),e.rounding(i),e.rounding(c),e.rounding(l),e.rounding(a),e.rounding(s)),this}}]),e}(Di);function Hi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wi(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Fi(t,e,n){return e&&Wi(t.prototype,e),n&&Wi(t,n),t}var Yi={SOLID_LINE:0,DOTTED_LINE:1,POINT_LINE:2,DOUBLE_LINE:3},Gi=function(){function t(e,n){Hi(this,t),this.draw=e,S.mergeDeep(this,{color:"#000000",widthType:Bi.LINE_WIDTH_TYPE.low},n)}return Fi(t,[{key:"setWidthType",value:function(t){this.widthType=t}},{key:"setColor",value:function(t){this.color=t}},{key:"horizonLine",value:function(t,e,n,o){var r=this.draw,i=this.widthType,c=this.color;r.setLineColor(c),r.setLineWidthType(i),r.setLineDash([]),r.horizonLine([t,e],[n,o])}},{key:"verticalLine",value:function(t,e,n,o){var r=this.draw,i=this.widthType,c=this.color;r.setLineColor(c),r.setLineWidthType(i),r.setLineDash([]),r.verticalLine([t,e],[n,o])}}]),t}(),zi=function(){function t(e,n){Hi(this,t),this.draw=e,S.mergeDeep(this,{color:"#000000",widthType:Bi.LINE_WIDTH_TYPE.low,dash:[5]},n)}return Fi(t,[{key:"setWidthType",value:function(t){this.widthType=t}},{key:"setColor",value:function(t){this.color=t}},{key:"horizonLine",value:function(t,e,n,o){var r=this.draw,i=this.dash,c=this.widthType,l=this.color;r.setLineColor(l),r.setLineWidthType(c),r.setLineDash(i),r.horizonLine([t,e],[n,o])}},{key:"verticalLine",value:function(t,e,n,o){var r=this.draw,i=this.dash,c=this.widthType,l=this.color;r.setLineColor(l),r.setLineWidthType(c),r.setLineDash(i),r.verticalLine([t,e],[n,o])}}]),t}(),Ui=function(){function t(e,n){Hi(this,t),this.draw=e,S.mergeDeep(this,{color:"#000000",widthType:Bi.LINE_WIDTH_TYPE.low,padding:1,spacing:t.spacing,leftShow:function(){return!1},topShow:function(){return!1},rightShow:function(){return!1},bottomShow:function(){return!1},iFMerge:function(){return!1},iFMergeFirstRow:function(){return!1},iFMergeLastRow:function(){return!1},iFMergeFirstCol:function(){return!1},iFMergeLastCol:function(){return!1}},n)}return Fi(t,[{key:"setWidthType",value:function(t){this.widthType=t}},{key:"setColor",value:function(t){this.color=t}},{key:"horizonLine",value:function(t,e,n,o,r,i,c){var l=this.draw,a=this.widthType,s=this.color;l.setLineColor(s),l.setLineWidthType(a),l.setLineDash([]);var u=this.handleExternal(t,e,n,o,r,i,c),f=this.handleInternal(t,e,n,o,r,i,c);S.isEmptyObject(f)||l.horizonLine([f.sx,f.sy],[f.ex,f.ey]),S.isEmptyObject(u)||l.horizonLine([u.sx,u.sy],[u.ex,u.ey])}},{key:"verticalLine",value:function(t,e,n,o,r,i,c){var l=this.draw,a=this.widthType,s=this.color;l.setLineColor(s),l.setLineWidthType(a),l.setLineDash([]);var u=this.handleExternal(t,e,n,o,r,i,c),f=this.handleInternal(t,e,n,o,r,i,c);S.isEmptyObject(f)||l.verticalLine([f.sx,f.sy],[f.ex,f.ey]),S.isEmptyObject(u)||l.verticalLine([u.sx,u.sy],[u.ex,u.ey])}},{key:"handleExternal",value:function(t,e,n,o,r,i,c){var l={},a=this.leftShow,s=this.topShow,u=this.rightShow,f=this.bottomShow,h=this.iFMerge,p=this.iFMergeFirstRow,y=this.iFMergeLastRow,b=this.iFMergeFirstCol,d=this.iFMergeLastCol,v=this.spacing,g=null,w=null,m=null,E=null,O=null;switch(c){case"left":(g=h(r,i-1))&&(w=p(r,i-1),m=y(r,i-1),E=b(r,i-1),O=d(r,i-1));break;case"top":(g=h(r-1,i))&&(w=p(r-1,i),m=y(r-1,i),E=b(r-1,i),O=d(r-1,i));break;case"right":(g=h(r,i+1))&&(w=p(r,i+1),m=y(r,i+1),E=b(r,i+1),O=d(r,i+1));break;case"bottom":(g=h(r+1,i))&&(w=p(r+1,i),m=y(r+1,i),E=b(r+1,i),O=d(r+1,i))}if(g){switch(c){case"left":l.sx=t-v,l.ex=n-v;var S=f(r-1,i-1)||s(r,i-1),x=s(r,i),T=f(r-1,i);l.sy=e,(x||T)&&(l.sy=e-v),S&&w&&(l.sy=e+v);var _=s(r+1,i-1)||f(r,i-1),k=f(r,i),P=s(r+1,i);l.ey=o,(k||P)&&(l.ey=o+v),_&&m&&(l.ey=o-v);break;case"top":l.sy=e-v,l.ey=o-v;var C=u(r-1,i-1)||a(r-1,i),j=a(r,i),L=u(r,i-1);l.sx=t,(j||L)&&(l.sx=t-v),C&&E&&(l.sx=t+v);var A=a(r-1,i+1)||u(r-1,i),R=u(r,i),N=a(r,i+1);l.ex=n,(R||N)&&(l.ex=n+v),A&&O&&(l.ex=n-v);break;case"right":l.sx=t+v,l.ex=n+v;var V=f(r-1,i+1)||s(r,i+1),I=s(r,i),M=f(r-1,i);l.sy=e,(I||M)&&(l.sy=e-v),V&&w&&(l.sy=e+v);var D=s(r+1,i+1)||f(r,i+1),B=f(r,i),H=s(r+1,i);l.ey=o,(B||H)&&(l.ey=o+v),D&&m&&(l.ey=o-v);break;case"bottom":l.sy=e+v,l.ey=o+v;var W=u(r+1,i-1)||a(r+1,i),F=a(r,i),Y=u(r,i-1);l.sx=t,(F||Y)&&(l.sx=t-v),W&&E&&(l.sx=t+v);var G=a(r+1,i+1)||u(r+1,i),z=u(r,i),U=a(r,i+1);l.ex=n,(z||U)&&(l.ex=n+v),G&&O&&(l.ex=n-v)}return l}switch(c){case"left":l.sx=t-v,l.ex=n-v;var X=f(r-1,i-1)||s(r,i-1),K=s(r,i),Z=f(r-1,i);l.sy=e,(K||Z)&&(l.sy=e-v),X&&(l.sy=e+v);var $=s(r+1,i-1)||f(r,i-1),q=f(r,i),J=s(r+1,i);l.ey=o,(q||J)&&(l.ey=o+v),$&&(l.ey=o-v);break;case"top":l.sy=e-v,l.ey=o-v;var Q=u(r-1,i-1)||a(r-1,i),tt=a(r,i),et=u(r,i-1);l.sx=t,(tt||et)&&(l.sx=t-v),Q&&(l.sx=t+v);var nt=a(r-1,i+1)||u(r-1,i),ot=u(r,i),rt=a(r,i+1);l.ex=n,(ot||rt)&&(l.ex=n+v),nt&&(l.ex=n-v);break;case"right":l.sx=t+v,l.ex=n+v;var it=f(r-1,i+1)||s(r,i+1),ct=s(r,i),lt=f(r-1,i);l.sy=e,(ct||lt)&&(l.sy=e-v),it&&(l.sy=e+v);var at=s(r+1,i+1)||f(r,i+1),st=f(r,i),ut=s(r+1,i);l.ey=o,(st||ut)&&(l.ey=o+v),at&&(l.ey=o-v);break;case"bottom":l.sy=e+v,l.ey=o+v;var ft=u(r+1,i-1)||a(r+1,i),ht=a(r,i),pt=u(r,i-1);l.sx=t,(ht||pt)&&(l.sx=t-v),ft&&(l.sx=t+v);var yt=a(r+1,i+1)||u(r+1,i),bt=u(r,i),dt=a(r,i+1);l.ex=n,(bt||dt)&&(l.ex=n+v),yt&&(l.ex=n-v)}return l}},{key:"handleInternal",value:function(t,e,n,o,r,i,c){var l={},a=this.leftShow,s=this.topShow,u=this.rightShow,f=this.bottomShow,h=this.iFMerge,p=this.iFMergeFirstRow,y=this.iFMergeLastRow,b=this.iFMergeFirstCol,d=this.iFMergeLastCol,v=this.spacing;if(h(r,i)){var g=p(r,i),w=y(r,i),m=b(r,i),E=d(r,i);switch(c){case"left":l.sx=t+v,l.ex=n+v;var O=f(r-1,i-1)||s(r,i-1),S=s(r,i),x=f(r-1,i);l.sy=e,O&&(l.sy=e-v),(S||x)&&g&&(l.sy=e+v);var T=s(r+1,i-1)||f(r,i-1),_=f(r,i),k=s(r+1,i);l.ey=o,T&&(l.ey=o+v),(_||k)&&w&&(l.ey=o-v);break;case"top":l.sy=e+v,l.ey=o+v;var P=u(r-1,i-1)||a(r-1,i),C=a(r,i),j=u(r,i-1);l.sx=t,P&&(l.sx=t-v),(C||j)&&m&&(l.sx=t+v);var L=a(r-1,i+1)||u(r-1,i),A=u(r,i),R=a(r,i+1);l.ex=n,L&&(l.ex=n+v),(A||R)&&E&&(l.ex=n-v);break;case"right":l.sx=t-v,l.ex=n-v;var N=f(r-1,i+1)||s(r,i+1),V=s(r,i),I=f(r-1,i);l.sy=e,N&&(l.sy=e-v),(V||I)&&g&&(l.sy=e+v);var M=s(r+1,i+1)||f(r,i+1),D=f(r,i),B=s(r+1,i);l.ey=o,M&&(l.ey=o+v),(D||B)&&w&&(l.ey=o-v);break;case"bottom":l.sy=e-v,l.ey=o-v;var H=u(r+1,i-1)||a(r+1,i),W=a(r,i),F=u(r,i-1);l.sx=t,H&&(l.sx=t-v),(W||F)&&m&&(l.sx=t+v);var Y=a(r+1,i+1)||u(r+1,i),G=u(r,i),z=a(r,i+1);l.ex=n,Y&&(l.ex=n+v),(G||z)&&E&&(l.ex=n-v)}return l}switch(c){case"left":l.sx=t+v,l.ex=n+v;var U=f(r-1,i-1)||s(r,i-1),X=s(r,i),K=f(r-1,i);l.sy=e,U&&(l.sy=e-v),(X||K)&&(l.sy=e+v);var Z=s(r+1,i-1)||f(r,i-1),$=f(r,i),q=s(r+1,i);l.ey=o,Z&&(l.ey=o+v),($||q)&&(l.ey=o-v);break;case"top":l.sy=e+v,l.ey=o+v;var J=u(r-1,i-1)||a(r-1,i),Q=a(r,i),tt=u(r,i-1);l.sx=t,J&&(l.sx=t-v),(Q||tt)&&(l.sx=t+v);var et=a(r-1,i+1)||u(r-1,i),nt=u(r,i),ot=a(r,i+1);l.ex=n,et&&(l.ex=n+v),(nt||ot)&&(l.ex=n-v);break;case"right":l.sx=t-v,l.ex=n-v;var rt=f(r-1,i+1)||s(r,i+1),it=s(r,i),ct=f(r-1,i);l.sy=e,rt&&(l.sy=e-v),(it||ct)&&(l.sy=e+v);var lt=s(r+1,i+1)||f(r,i+1),at=f(r,i),st=s(r+1,i);l.ey=o,lt&&(l.ey=o+v),(at||st)&&(l.ey=o-v);break;case"bottom":l.sy=e-v,l.ey=o-v;var ut=u(r+1,i-1)||a(r+1,i),ft=a(r,i),ht=u(r,i-1);l.sx=t,ut&&(l.sx=t-v),(ft||ht)&&(l.sx=t+v);var pt=a(r+1,i+1)||u(r+1,i),yt=u(r,i),bt=a(r,i+1);l.ex=n,pt&&(l.ex=n+v),(yt||bt)&&(l.ex=n-v)}return l}}]),t}();Ui.spacing=Bi.dpr()>=2?3:2;var Xi=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Hi(this,t),this.widthType=Bi.LINE_WIDTH_TYPE.low,this.type=Yi.SOLID_LINE,this.solidLine=new Gi(e,S.mergeDeep({},n)),this.dottedLine=new zi(e,S.mergeDeep({dash:[5]},n)),this.pointLine=new zi(e,S.mergeDeep({dash:[2,2]},n)),this.doubleLine=new Ui(e,S.mergeDeep({},n))}return Fi(t,[{key:"setWidthType",value:function(t){t&&this.type===Yi.SOLID_LINE&&this.solidLine.setWidthType(t)}},{key:"setColor",value:function(t){t&&(this.solidLine.setColor(t),this.dottedLine.setColor(t),this.pointLine.setColor(t),this.doubleLine.setColor(t))}},{key:"setType",value:function(t){this.type=t}},{key:"horizonLine",value:function(t,e,n,o,r,i,c){var l=this.type,a=this.solidLine,s=this.dottedLine,u=this.pointLine,f=this.doubleLine;switch(l){case Yi.SOLID_LINE:a.horizonLine(t,e,n,o);break;case Yi.DOTTED_LINE:s.horizonLine(t,e,n,o);break;case Yi.POINT_LINE:u.horizonLine(t,e,n,o);break;case Yi.DOUBLE_LINE:f.horizonLine(t,e,n,o,r,i,c)}}},{key:"verticalLine",value:function(t,e,n,o,r,i,c){var l=this.type,a=this.solidLine,s=this.dottedLine,u=this.pointLine,f=this.doubleLine;switch(l){case Yi.SOLID_LINE:a.verticalLine(t,e,n,o);break;case Yi.DOTTED_LINE:s.verticalLine(t,e,n,o);break;case Yi.POINT_LINE:u.verticalLine(t,e,n,o);break;case Yi.DOUBLE_LINE:f.verticalLine(t,e,n,o,r,i,c)}}}]),t}();function Ki(t){return(Ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zi(t){return(Zi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qi(t,e){return(qi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ji=function(t){function e(){var t,n,r,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,r=Zi(e).call(this,"".concat(i,"-border-type-context-menu"),S.mergeDeep({onUpdate:function(){}},c)),(t=!r||"object"!==Ki(r)&&"function"!=typeof r?$i(n):r).type=Yi.SOLID_LINE,t.color="#000000",t.borderIcon1=new Zo,t.borderIcon2=new tr,t.borderIcon3=new ir,t.borderIcon4=new ur,t.borderIcon5=new br;var l=k("div","".concat(i,"-border-type-context-menu-type-icon-line"));l.children(t.borderIcon1),l.children(t.borderIcon2),l.children(t.borderIcon3),l.children(t.borderIcon4),l.children(t.borderIcon5),t.borderIcon6=new mr,t.borderIcon7=new Tr,t.borderIcon8=new jr,t.borderIcon9=new Vr,t.borderIcon10=new Hr;var a=k("div","".concat(i,"-border-type-context-menu-type-icon-line"));a.children(t.borderIcon6),a.children(t.borderIcon7),a.children(t.borderIcon8),a.children(t.borderIcon9),a.children(t.borderIcon10),t.borderIcons=new Go,t.borderIcons.removeClass("hover"),t.borderIcons.children(l),t.borderIcons.children(a),t.borderColor=new Ur,t.borderType=new qr;var s=k("div","".concat(i,"-border-type-context-menu-type-icon-line"));return s.children(t.borderColor),s.children(t.borderType),t.borderColorAndType=new Go,t.borderColorAndType.removeClass("hover"),t.borderColorAndType.children(s),t.addItem(t.borderIcons),t.addItem(new ve),t.addItem(t.borderColorAndType),t.borderColorContextMenu=new ai(S.copyProp({el:t.borderColor,position:Gt.BOTTOM},{onUpdate:function(e){t.color=e,t.borderColor.setColor(e)}})),t.lineTypeContextMenu=new Ei(S.copyProp({el:t.borderType,position:Gt.BOTTOM},{onUpdate:function(e){t.type=e}})),A.bind(t.borderColor,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=$i(t).borderColorContextMenu,o=n.elPopUp;Xt.closeAll([o,t.elPopUp]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),A.bind(t.borderType,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=$i(t).lineTypeContextMenu,o=n.elPopUp;Xt.closeAll([o,t.elPopUp]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),A.bind(t.borderIcon1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border1",t.color,t.type),e.stopPropagation(),e.preventDefault()})),A.bind(t.borderIcon2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border2",t.color,t.type),e.stopPropagation(),e.preventDefault()})),A.bind(t.borderIcon3,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border3",t.color,t.type),e.stopPropagation(),e.preventDefault()})),A.bind(t.borderIcon4,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border4",t.color,t.type),e.stopPropagation(),e.preventDefault()})),A.bind(t.borderIcon5,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border5",t.color,t.type),e.stopPropagation(),e.preventDefault()})),A.bind(t.borderIcon6,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border6",t.color,t.type),e.stopPropagation(),e.preventDefault()})),A.bind(t.borderIcon7,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border7",t.color,t.type),e.stopPropagation(),e.preventDefault()})),A.bind(t.borderIcon8,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border8",t.color,t.type),e.stopPropagation(),e.preventDefault()})),A.bind(t.borderIcon9,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border9",t.color,t.type),e.stopPropagation(),e.preventDefault()})),A.bind(t.borderIcon10,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate("border10",t.color,t.type),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qi(t,e)}(e,t),e}(te);function Qi(t){return(Qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tc(t){return(tc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ec(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nc(t,e){return(nc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var oc=function(t){function e(t){var n,o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(r=tc(e).call(this,"".concat(i,"-tools-border")))||"object"!==Qi(r)&&"function"!=typeof r?ec(o):r).options=S.copyProp({contextMenu:{}},t),n.icon=new it("border"),n.setIcon(n.icon),n.borderTypeContextMenu=new Ji(S.copyProp({el:ec(n),position:Gt.BOTTOM},n.options.contextMenu)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nc(t,e)}(e,t),e}(Mt);function rc(t){return(rc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ic(t,e){return!e||"object"!==rc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cc(t){return(cc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lc(t,e){return(lc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ac=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ic(this,cc(e).call(this,"".concat(i,"-tools-merge")))).icon=new it("merge"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lc(t,e)}(e,t),e}(ut);function sc(t){return(sc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uc(t,e){return!e||"object"!==sc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fc(t){return(fc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hc(t,e){return(hc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=uc(this,fc(e).call(this,"".concat(i,"-tools-horizontal1")))).icon=new it("align-left"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hc(t,e)}(e,t),e}(ut);function yc(t){return(yc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bc(t,e){return!e||"object"!==yc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dc(t){return(dc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vc(t,e){return(vc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=bc(this,dc(e).call(this,"".concat(i,"-tools-horizontal2")))).icon=new it("align-center"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vc(t,e)}(e,t),e}(ut);function wc(t){return(wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mc(t,e){return!e||"object"!==wc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ec(t){return(Ec=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oc(t,e){return(Oc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Sc=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=mc(this,Ec(e).call(this,"".concat(i,"-tools-horizontal3")))).icon=new it("align-right"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oc(t,e)}(e,t),e}(ut);function xc(t){return(xc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tc(t,e){return!e||"object"!==xc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _c(t){return(_c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kc(t,e){return(kc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Tc(this,_c(e).call(this,"".concat(i,"-horizontal-type-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kc(t,e)}(e,t),e}(ie);function Cc(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var jc=function(){function t(e){var n=e.overflow,o=e.text,r=e.rect,i=e.dw,c=e.attr;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.overflow=n,this.text=o,this.dw=i,this.rect=r,this.attr=c}var e,n,o;return e=t,(n=[{key:"textWidth",value:function(t){return this.dw.measureText(t).width}},{key:"textBreak",value:function(t){return t.split(/\n/)}},{key:"isBlank",value:function(t){return null==t||""===t.toString().trim()}},{key:"setTextWrap",value:function(t){this.attr.textWrap=t}},{key:"setSize",value:function(t){this.attr.size=t}},{key:"setPadding",value:function(t){this.attr.padding=t}},{key:"truncateFont",value:function(){throw new TypeError("child impl")}},{key:"overflowFont",value:function(){throw new TypeError("child impl")}},{key:"wrapTextFont",value:function(){throw new TypeError("child impl")}},{key:"draw",value:function(){throw new TypeError("child impl")}}])&&Cc(e.prototype,n),o&&Cc(e,o),t}();function Lc(t){return(Lc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ac(t,e){return!e||"object"!==Lc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rc(t){return(Rc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nc(t,e){return(Nc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}jc.VERTICAL_ALIGN={top:"top",center:"middle",bottom:"bottom"},jc.ALIGN={left:"left",center:"center",right:"right"},jc.TEXT_WRAP={OVER_FLOW:1,WORD_WRAP:2,TRUNCATE:3},jc.TEXT_DIRECTION={HORIZONTAL:"horizontal",VERTICAL:"vertical",ANGLE:"angle"};var Vc=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ac(this,Rc(e).call(this,"".concat(i,"-horizontal-type-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).horizontalIcon1=new pc,t.horizontalIcon2=new gc,t.horizontalIcon3=new Sc;var r=k("div","".concat(i,"-horizontal-type-context-menu-type-icon-line"));return r.children(t.horizontalIcon1),r.children(t.horizontalIcon2),r.children(t.horizontalIcon3),t.horizontalIcons=new Pc,t.horizontalIcons.removeClass("hover"),t.horizontalIcons.children(r),t.addItem(t.horizontalIcons),A.bind(t.horizontalIcon1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(jc.ALIGN.left),e.stopPropagation(),e.preventDefault()})),A.bind(t.horizontalIcon2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(jc.ALIGN.center),e.stopPropagation(),e.preventDefault()})),A.bind(t.horizontalIcon3,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(jc.ALIGN.right),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nc(t,e)}(e,t),e}(te);function Ic(t){return(Ic="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mc(t){return(Mc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bc(t,e){return(Bc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hc=function(t){function e(){var t,n,o,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=Mc(e).call(this,"".concat(i,"-tools-horizontal-align")))||"object"!==Ic(o)&&"function"!=typeof o?Dc(n):o).options=S.mergeDeep({contextMenu:{}},r),t.icon=new it("align-left"),t.setIcon(t.icon),t.horizontalContextMenu=new Vc(S.copyProp({el:Dc(t),position:Gt.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bc(t,e)}(e,t),e}(Mt);function Wc(t){return(Wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fc(t,e){return!e||"object"!==Wc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yc(t){return(Yc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gc(t,e){return(Gc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Fc(this,Yc(e).call(this,"".concat(i,"-vertical-type-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gc(t,e)}(e,t),e}(ie);function Uc(t){return(Uc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xc(t,e){return!e||"object"!==Uc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Kc(t){return(Kc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zc(t,e){return(Zc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $c=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Xc(this,Kc(e).call(this,"".concat(i,"-tools-verticalIcon1")))).icon=new it("align-top"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zc(t,e)}(e,t),e}(ut);function qc(t){return(qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jc(t,e){return!e||"object"!==qc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qc(t){return(Qc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tl(t,e){return(tl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var el=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Jc(this,Qc(e).call(this,"".concat(i,"-tools-verticalIcon2")))).icon=new it("align-middle"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tl(t,e)}(e,t),e}(ut);function nl(t){return(nl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ol(t,e){return!e||"object"!==nl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function rl(t){return(rl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function il(t,e){return(il=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var cl=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ol(this,rl(e).call(this,"".concat(i,"-tools-verticalIcon3")))).icon=new it("align-bottom"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&il(t,e)}(e,t),e}(ut);function ll(t){return(ll="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function al(t,e){return!e||"object"!==ll(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function sl(t){return(sl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ul(t,e){return(ul=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fl=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=al(this,sl(e).call(this,"".concat(i,"-vertical-type-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).verticalIcon1=new $c,t.verticalIcon2=new el,t.verticalIcon3=new cl;var r=k("div","".concat(i,"-vertical-type-context-menu-type-icon-line"));return r.children(t.verticalIcon1),r.children(t.verticalIcon2),r.children(t.verticalIcon3),t.verticalIcons=new zc,t.verticalIcons.removeClass("hover"),t.verticalIcons.children(r),t.addItem(t.verticalIcons),A.bind(t.verticalIcon1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(jc.VERTICAL_ALIGN.top),e.stopPropagation(),e.preventDefault()})),A.bind(t.verticalIcon2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(jc.VERTICAL_ALIGN.center),e.stopPropagation(),e.preventDefault()})),A.bind(t.verticalIcon3,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(jc.VERTICAL_ALIGN.bottom),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ul(t,e)}(e,t),e}(te);function hl(t){return(hl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pl(t){return(pl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yl(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bl(t,e){return(bl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dl=function(t){function e(){var t,n,o,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=pl(e).call(this,"".concat(i,"-tools-vertical-align")))||"object"!==hl(o)&&"function"!=typeof o?yl(n):o).options=S.mergeDeep({contextMenu:{}},r),t.icon=new it("align-middle"),t.setIcon(t.icon),t.verticalContextMenu=new fl(S.copyProp({el:yl(t),position:Gt.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bl(t,e)}(e,t),e}(Mt);function vl(t){return(vl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gl(t,e){return!e||"object"!==vl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wl(t){return(wl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ml(t,e){return(ml=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var El=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=gl(this,wl(e).call(this,"".concat(i,"-tools-text-wrapping1")))).icon=new it("truncate"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ml(t,e)}(e,t),e}(ut);function Ol(t){return(Ol="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sl(t,e){return!e||"object"!==Ol(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xl(t){return(xl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tl(t,e){return(Tl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _l=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Sl(this,xl(e).call(this,"".concat(i,"-tools-text-wrapping2")))).icon=new it("overflow"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tl(t,e)}(e,t),e}(ut);function kl(t){return(kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pl(t,e){return!e||"object"!==kl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Cl(t){return(Cl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jl(t,e){return(jl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ll=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Pl(this,Cl(e).call(this,"".concat(i,"-tools-text-wrapping3")))).icon=new it("wrap"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jl(t,e)}(e,t),e}(ut);function Al(t){return(Al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rl(t,e){return!e||"object"!==Al(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Nl(t){return(Nl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vl(t,e){return(Vl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Il=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Rl(this,Nl(e).call(this,"".concat(i,"-text-wrapping-context-menu-item")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vl(t,e)}(e,t),e}(ie);function Ml(t){return(Ml="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dl(t,e){return!e||"object"!==Ml(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bl(t){return(Bl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hl(t,e){return(Hl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wl=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Dl(this,Bl(e).call(this,"".concat(i,"-text-wrapping-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).textWrappingIcon1=new El,t.textWrappingIcon2=new _l,t.textWrappingIcon3=new Ll;var r=k("div","".concat(i,"-text-wrapping-context-menu-type-icon-line"));return r.children(t.textWrappingIcon1),r.children(t.textWrappingIcon2),r.children(t.textWrappingIcon3),t.textWrappingIcons=new Il,t.textWrappingIcons.removeClass("hover"),t.textWrappingIcons.children(r),t.addItem(t.textWrappingIcons),A.bind(t.textWrappingIcon1,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(jc.TEXT_WRAP.TRUNCATE),e.stopPropagation(),e.preventDefault()})),A.bind(t.textWrappingIcon2,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(jc.TEXT_WRAP.OVER_FLOW),e.stopPropagation(),e.preventDefault()})),A.bind(t.textWrappingIcon3,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.options.onUpdate(jc.TEXT_WRAP.WORD_WRAP),e.stopPropagation(),e.preventDefault()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hl(t,e)}(e,t),e}(te);function Fl(t){return(Fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yl(t){return(Yl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gl(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zl(t,e){return(zl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ul=function(t){function e(){var t,n,o,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=Yl(e).call(this,"".concat(i,"-tools-text-wrapping")))||"object"!==Fl(o)&&"function"!=typeof o?Gl(n):o).options=S.mergeDeep({contextMenu:{}},r),t.icon=new it("text-wrap"),t.setIcon(t.icon),t.textWrappingContextMenu=new Wl(S.copyProp({el:Gl(t),position:Gt.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zl(t,e)}(e,t),e}(Mt);function Xl(t){return(Xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kl(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Zl(t){return(Zl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ql(t,e){return(ql=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jl=[],Ql=function(t){function e(t){var n,o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(r=Zl(e).call(this,"".concat(i,"-fixed-context-menu-item")))||"object"!==Xl(r)&&"function"!=typeof r?$l(o):r).title=t,n.titleElement=k("div","".concat(i,"-fixed-context-menu-item-title")),n.titleElement.text(t),n.children(n.titleElement),Jl.push($l(n)),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ql(t,e)}(e,t),n=e,(o=[{key:"setTitle",value:function(t){this.title=t,this.titleElement.text(t)}}])&&Kl(n.prototype,o),r&&Kl(n,r),e}(ie);function ta(t){return(ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ea(t){return(ea=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function na(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oa(t,e){return(oa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ra=function(t){function e(){var t,n,r,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,r=ea(e).call(this,"".concat(i,"-fixed-context-menu"),S.mergeDeep({onUpdate:function(){}},c)),(t=!r||"object"!==ta(r)&&"function"!=typeof r?na(n):r).row=new Ql("冻结至当前行"),t.row1=new Ql("冻结1行"),t.row2=new Ql("冻结2行"),t.col=new Ql("冻结至当前列"),t.col1=new Ql("冻结1列"),t.col2=new Ql("冻结2列"),t.addItem(t.row),t.addItem(t.row1),t.addItem(t.row2),t.addItem(new ve),t.addItem(t.col),t.addItem(t.col1),t.addItem(t.col2),A.bind(t.row,o.SYSTEM_EVENT_TYPE.CLICK,(function(){na(t).options.onUpdate("ROW"),t.close()})),A.bind(t.row1,o.SYSTEM_EVENT_TYPE.CLICK,(function(){na(t).options.onUpdate("ROW1"),t.close()})),A.bind(t.row2,o.SYSTEM_EVENT_TYPE.CLICK,(function(){na(t).options.onUpdate("ROW2"),t.close()})),A.bind(t.col,o.SYSTEM_EVENT_TYPE.CLICK,(function(){na(t).options.onUpdate("COL"),t.close()})),A.bind(t.col1,o.SYSTEM_EVENT_TYPE.CLICK,(function(){na(t).options.onUpdate("COL1"),t.close()})),A.bind(t.col2,o.SYSTEM_EVENT_TYPE.CLICK,(function(){na(t).options.onUpdate("COL2"),t.close()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oa(t,e)}(e,t),e}(te);function ia(t){return(ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ca(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function la(t){return(la=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function aa(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sa(t,e){return(sa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ua=function(t){function e(t){var n,o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(r=la(e).call(this,"".concat(i,"-tools-fixed")))||"object"!==ia(r)&&"function"!=typeof r?aa(o):r).options=S.copyProp({contextMenu:{}},t),n.icon=new it("freeze"),n.rowStatus=!1,n.colStatus=!1,n.setIcon(n.icon),n.fixedContextMenu=new ra(S.copyProp({el:aa(n),position:Gt.BOTTOM},n.options.contextMenu)),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sa(t,e)}(e,t),n=e,(o=[{key:"setFixedColStatus",value:function(t){var e=this.fixedContextMenu;t?(this.colStatus=!0,e.col.setTitle("取消冻结列")):(this.colStatus=!1,e.col.setTitle("冻结至当前列"))}},{key:"setFixedRowStatus",value:function(t){var e=this.fixedContextMenu;t?(this.rowStatus=!0,e.row.setTitle("取消冻结行")):(this.rowStatus=!1,e.row.setTitle("冻结至当前行"))}}])&&ca(n.prototype,o),r&&ca(n,r),e}(Mt);function fa(t){return(fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ha(t,e){return!e||"object"!==fa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pa(t){return(pa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ya(t,e){return(ya=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ba=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ha(this,pa(e).call(this,"".concat(i,"-tools-filter")))).icon=new it("filter"),t.children(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ya(t,e)}(e,t),e}(ut);function da(t){return(da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function va(t,e){return!e||"object"!==da(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ga(t){return(ga=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wa(t,e){return(wa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ma=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=va(this,ga(e).call(this,"".concat(i,"-tools-format")))).icon=new it("functions"),t.setIcon(t.icon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wa(t,e)}(e,t),e}(Mt);function Ea(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Oa=function(){function t(e){var n=e.align,o=void 0===n?jc.ALIGN.left:n,r=e.verticalAlign,i=void 0===r?jc.VERTICAL_ALIGN.center:r,c=e.textWrap,l=void 0===c?jc.TEXT_WRAP.TRUNCATE:c,a=e.strikethrough,s=void 0!==a&&a,u=e.underline,f=void 0!==u&&u,h=e.color,p=void 0===h?"rgb(0,0,0)":h,y=e.name,b=void 0===y?"Arial":y,d=e.size,v=void 0===d?12:d,g=e.bold,w=void 0!==g&&g,m=e.italic,E=void 0!==m&&m,O=e.angle,S=void 0===O?0:O,x=e.direction,T=void 0===x?jc.TEXT_DIRECTION.HORIZONTAL:x,_=e.padding,k=void 0===_?5:_;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.align=o,this.verticalAlign=i,this.textWrap=l,this.strikethrough=s,this.underline=f,this.color=p,this.name=b,this.size=v,this.bold=w,this.italic=E,this.direction=T,this.angle=S,this.padding=k}var e,n,o;return e=t,(n=[{key:"toCssStyle",value:function(){var t=this.align,e=this.size,n=this.color,o=this.bold,r=this.italic,i=this.name,c="left",l="center";switch(this.verticalAlign){case jc.VERTICAL_ALIGN.center:l="center";break;case jc.VERTICAL_ALIGN.top:l="flex-start";break;case jc.VERTICAL_ALIGN.bottom:l="flex-end"}switch(t){case jc.ALIGN.left:c="flex-start";break;case jc.ALIGN.center:c="center";break;case jc.ALIGN.right:c="flex-end"}var a="\n      justify-content:".concat(c,";\n      font-size: ").concat(Bi.transformCssPx(e),"px;color: ").concat(n,";font-weight: ").concat(o?"bold":"initial",";\n      font-style: ").concat(r?"italic":"initial",";\n      font-family: ").concat(i,";\n      align-items: ").concat(l,";\n    ");return a=a.replace(/\s/g,"")}},{key:"clone",value:function(){return new t({align:this.align,verticalAlign:this.verticalAlign,textWrap:this.textWrap,strikethrough:this.strikethrough,underline:this.underline,color:this.color,name:this.name,size:this.size,bold:this.bold,italic:this.italic,angle:this.angle,direction:this.direction,padding:this.padding})}}])&&Ea(e.prototype,n),o&&Ea(e,o),t}();function Sa(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function xa(t,e,n){return e&&Sa(t.prototype,e),n&&Sa(t,n),t}var Ta=0,_a=function(){function t(e){var n=e.widthType,o=void 0===n?Bi.LINE_WIDTH_TYPE.low:n,r=e.width,i=void 0===r?-1:r,c=e.color,l=void 0===c?"#000000":c,a=e.zIndex,s=void 0===a?0:a,u=e.display,f=void 0!==u&&u,h=e.type,p=void 0===h?Yi.SOLID_LINE:h;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$zIndex=s,this.$display=f,this.$color=l,this.$type=p,this.$widthType=1===i?Bi.LINE_WIDTH_TYPE.low:2===i?Bi.LINE_WIDTH_TYPE.medium:3===i?Bi.LINE_WIDTH_TYPE.high:o,s>Ta&&(Ta=s)}return xa(t,null,[{key:"getZIndex",value:function(){return Ta+=1}}]),xa(t,[{key:"equal",value:function(t){var e=this.widthType===t.widthType,n=this.color===t.color,o=this.type===t.type;return n&&e&&o}},{key:"toJSON",value:function(){return{zIndex:this.$zIndex,display:this.$display,widthType:this.$widthType,color:this.$color,type:this.$type}}},{key:"priority",value:function(t){if(S.isUnDef(t))return-2;var e=this.zIndex,n=t.zIndex;return e>n?1:n>e?-1:0}},{key:"zIndex",get:function(){return this.$zIndex}},{key:"display",get:function(){return this.$display},set:function(e){this.$zIndex=t.getZIndex(),this.$display=e}},{key:"widthType",get:function(){return this.$widthType},set:function(e){this.$zIndex=t.getZIndex(),this.$widthType=e}},{key:"color",get:function(){return this.$color},set:function(e){this.$zIndex=t.getZIndex(),this.$color=e}},{key:"type",get:function(){return this.$type},set:function(e){this.$zIndex=t.getZIndex(),this.$type=e}}]),t}();function ka(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Pa=function(){function t(e){var n=e.left,o=void 0===n?{}:n,r=e.top,i=void 0===r?{}:r,c=e.right,l=void 0===c?{}:c,a=e.bottom,s=void 0===a?{}:a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.left=new _a(o),this.top=new _a(i),this.right=new _a(l),this.bottom=new _a(s)}var e,n,o;return e=t,(n=[{key:"setAllDisplay",value:function(t){this.setLDisplay(t),this.setTDisplay(t),this.setRDisplay(t),this.setBDisplay(t)}},{key:"setLDisplay",value:function(t){this.left.display=t}},{key:"setTDisplay",value:function(t){this.top.display=t}},{key:"setRDisplay",value:function(t){this.right.display=t}},{key:"setBDisplay",value:function(t){this.bottom.display=t}},{key:"setAllColor",value:function(t){this.setLColor(t),this.setTColor(t),this.setRColor(t),this.setBColor(t)}},{key:"setLColor",value:function(t){this.left.color=t}},{key:"setTColor",value:function(t){this.top.color=t}},{key:"setRColor",value:function(t){this.right.color=t}},{key:"setBColor",value:function(t){this.bottom.color=t}},{key:"setAllWidthType",value:function(t){this.setLWidthType(t),this.setTWidthType(t),this.setRWidthType(t),this.setBWidthType(t)}},{key:"setLWidthType",value:function(t){this.left.widthType=t}},{key:"setTWidthType",value:function(t){this.top.widthType=t}},{key:"setRWidthType",value:function(t){this.right.widthType=t}},{key:"setBWidthType",value:function(t){this.bottom.widthType=t}},{key:"setAllType",value:function(t){this.setLType(t),this.setTType(t),this.setRType(t),this.setBType(t)}},{key:"setLType",value:function(t){this.left.type=t}},{key:"setTType",value:function(t){this.top.type=t}},{key:"setRType",value:function(t){this.right.type=t}},{key:"setBType",value:function(t){this.bottom.type=t}},{key:"clone",value:function(){return new t({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}}])&&ka(e.prototype,n),o&&ka(e,o),t}();function Ca(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var ja=function(){function t(e){var n=e.text,o=void 0===n?S.EMPTY:n,r=e.background,i=void 0===r?S.Nul:r,c=e.format,l=void 0===c?"default":c,a=e.borderAttr,s=void 0===a?{}:a,u=e.icons,f=void 0===u?[]:u,h=e.fontAttr,p=void 0===h?{}:h,y=e.contentWidth,b=void 0===y?0:y;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.background=i,this.text=o,this.format=l,this.icons=f,this.borderAttr=new Pa(s),this.fontAttr=new Oa(p),this.contentWidth=b}var e,n,o;return e=t,(n=[{key:"setContentWidth",value:function(t){this.contentWidth=t}},{key:"setIcons",value:function(t){this.icons=t}},{key:"setBorderAttr",value:function(t){this.borderAttr=t}},{key:"setFontAttr",value:function(t){this.fontAttr=t}},{key:"clone",value:function(){return new t({background:this.background,format:this.format,text:this.text,fontAttr:this.fontAttr,borderAttr:this.borderAttr,contentWidth:this.contentWidth})}},{key:"toJSON",value:function(){return{background:this.background,format:this.format,text:this.text,fontAttr:this.fontAttr,borderAttr:this.borderAttr,contentWidth:this.contentWidth}}},{key:"toCssStyle",value:function(){var t=this.background,e=this.fontAttr,n="\n      background:".concat(t,";\n    ");return n=n.replace(/\s/g,""),e.toCssStyle()+n}}])&&Ca(e.prototype,n),o&&Ca(e,o),t}();function La(t){return(La="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Aa(t,e){return!e||"object"!==La(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ra(t){return(Ra=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Na(t,e){return(Na=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Va=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Aa(this,Ra(e).call(this,"".concat(i,"-scale-context-menu-item")))).scale=t,n.titleElement=k("div","".concat(i,"-scale-context-menu-item-title")),n.titleElement.text("".concat(t,"%")),n.children(n.titleElement),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Na(t,e)}(e,t),e}(ie);function Ia(t){return(Ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ma(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Da(t,e){return!e||"object"!==Ia(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ba(t){return(Ba=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ha(t,e){return(Ha=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wa=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Da(this,Ba(e).call(this,"".concat(i,"-scale-context-menu"),S.mergeDeep({onUpdate:function(){}},n)))).items=[new Va(200),new Va(150),new Va(125),new Va(100),new Va(90),new Va(75),new Va(50)],t.items.forEach((function(e){e.on(o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.update(e.scale)})),t.addItem(e)})),t}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ha(t,e)}(e,t),n=e,(r=[{key:"update",value:function(t){this.options.onUpdate(t),this.close()}}])&&Ma(n.prototype,r),c&&Ma(n,c),e}(te);function Fa(t){return(Fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ya(t){return(Ya=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ga(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function za(t,e){return(za=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ua=function(t){function e(){var t,n,o,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=Ya(e).call(this,"".concat(i,"-tools-scale")))||"object"!==Fa(o)&&"function"!=typeof o?Ga(n):o).options=r,t.setTitle("100%"),t.setWidth(50),t.setEllipsis(),t.scaleContextMenu=new Wa(S.copyProp({el:Ga(t),position:Gt.BOTTOM},t.options.contextMenu)),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&za(t,e)}(e,t),e}(Mt);function Xa(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Ka=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.finishCallback=function(){},this.loopCallback=function(){},this.nextCallback=function(){},this.end=0,this.begin=0}var e,n,o;return e=t,(n=[{key:"execute",value:function(){var t,e=this.loopCallback,n=this.nextCallback,o=this.begin,r=this.end;if(o>r)for(t=o;t>=r&&!1!==e(t);n(t-=1));else for(t=o;t<=r&&!1!==e(t);n(t+=1));return this.finishCallback(t),this}},{key:"setLoop",value:function(t){return this.loopCallback=t,this}},{key:"setNext",value:function(t){return this.nextCallback=t,this}},{key:"setFinish",value:function(t){return this.finishCallback=t,this}},{key:"setEnd",value:function(t){return this.end=t,this}},{key:"setBegin",value:function(t){return this.begin=t,this}}])&&Xa(e.prototype,n),o&&Xa(e,o),t}();function Za(t){return(Za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $a(t,e){return!e||"object"!==Za(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qa(t){return(qa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ja(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Qa(t,e,n){return e&&Ja(t.prototype,e),n&&Ja(t,n),t}function ts(t,e){return(ts=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var es=[],ns=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=$a(this,qa(e).call(this))).useFold=!0,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ts(t,e)}(e,t),Qa(e,null,[{key:"getInstance",value:function(){return new e}},{key:"setFold",value:function(t){es=t}}]),Qa(e,[{key:"execute",value:function(){var t,e=this.loopCallback,n=this.nextCallback,o=this.begin,r=this.end,i=this.useFold;if(o>r)for(t=o;t>=r;n(t-=1)){if(!i||!es[t])if(!1===e(t))break}else for(t=o;t<=r;n(t+=1)){if(!i||!es[t])if(!1===e(t))break}return this.finishCallback(t),this}},{key:"nextRow",value:function(){var t=this.begin,e=-1;return this.setLoop((function(n){return n===t||(e=n,!1)})).execute(),e}},{key:"hasFold",value:function(){var t=!1;return this.setLoop((function(e){return!es[e]||(t=!0,!1)})).foldOnOff(!1).execute(),t}},{key:"foldOnOff",value:function(t){return this.useFold=t,this}}]),e}(Ka);function os(t){return(os="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rs(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function is(t,e){return!e||"object"!==os(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cs(t){return(cs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ls(t,e){return(ls=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var as=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),is(this,cs(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ls(t,e)}(e,t),n=e,r=[{key:"getInstance",value:function(){return new e}}],(o=[{key:"nextRow",value:function(){var t=this.begin,e=-1;return this.setLoop((function(n){return n===t||(e=n,!1)})).execute(),e}}])&&rs(n.prototype,o),r&&rs(n,r),e}(Ka);function ss(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function us(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var fs=function(){function t(e,n,o,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sri=e,this.sci=n,this.eri=o,this.eci=r,this.w=i,this.h=c}var e,n,o;return e=t,o=[{key:"valueOf",value:function(e){var n=e.split(":"),o=ss(S.expr2xy(n[0]),2),r=o[0],i=o[1],c=i,l=r;if(n.length>1){var a=ss(S.expr2xy(n[1]),2);l=a[0],c=a[1]}return new t(i,r,c,l)}}],(n=[{key:"set",value:function(t,e,n,o){this.sri=t,this.sci=e,this.eri=n,this.eci=o}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];if(1===o.length){var i=S.expr2xy(o[0]),c=ss(i,2);e=c[0],t=c[1]}else 2===o.length&&(t=o[0],e=o[1]);var l=this.sri,a=this.sci,s=this.eri,u=this.eci;return l<=t&&t<=s&&a<=e&&e<=u}},{key:"each",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=this.sri,o=this.sci,r=this.eri,i=this.eci,c=!1;ns.getInstance().setBegin(n).setEnd(r).setLoop((function(n){return e(n)&&as.getInstance().setBegin(o).setEnd(i).setLoop((function(e){return c=t(n,e)})).execute(),c})).execute()}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var n=this.sri,o=this.sci,r=this.eri,i=this.eci;return new t(e.sri<n?e.sri:n,e.sci<o?e.sci:o,e.eri>r?e.eri:r,e.eci>i?e.eci:i)}},{key:"coincide",value:function(e){var n=this.sri,o=this.sci,r=this.eri,i=this.eci;return this.disjoint(e)?t.EMPTY:new t(e.sri>n?e.sri:n,e.sci>o?e.sci:o,e.eri<r?e.eri:r,e.eci<i?e.eci:i)}},{key:"coincideDifference",value:function(e){return this.coincide(e).equals(t.EMPTY)?[]:this.difference(e)}},{key:"difference",value:function(e){var n=[],o=function(e,o,r,i){n.push(new t(e,o,r,i))},r=this.sri,i=this.sci,c=this.eri,l=this.eci,a=e.sri-r,s=e.sci-i,u=c-e.eri,f=l-e.eci;return a>0?(o(r,i,e.sri-1,l),u>0?(o(e.eri+1,i,c,l),s>0&&o(e.sri,i,e.eri,e.sci-1),f>0&&o(e.sri,e.eci+1,e.eri,l)):(s>0&&o(e.sri,i,c,e.sci-1),f>0&&o(e.sri,e.eci+1,c,l))):u>0&&(o(e.eri+1,i,c,l),s>0&&o(r,i,e.eri,e.sci-1),f>0&&o(r,e.eci+1,e.eri,l)),s>0?(o(r,i,c,e.sci-1),f>0?(o(r,e.eri+1,c,l),a>0&&o(r,e.sci,e.sri-1,e.eci),u>0&&o(e.sri+1,e.sci,c,e.eci)):(a>0&&o(r,e.sci,e.sri-1,l),u>0&&o(e.sri+1,e.sci,c,l))):f>0&&(o(r,e.eci+1,c,l),a>0&&o(r,i,e.sri-1,e.eci),u>0&&o(e.eri+1,i,c,e.eci)),n}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"brink",value:function(){var e=this.sri,n=this.eri,o=this.sci,r=this.eci,i=new t(e,o,e,r),c=new t(n,o,n,r);return{top:i,right:new t(e,r,n,r),bottom:c,left:new t(e,o,n,o)}}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"toString",value:function(){var t=this.sri,e=this.sci,n=this.eri,o=this.eci,r=S.xy2expr(e,t);return this.multiple()&&(r="".concat(r,":").concat(S.xy2expr(o,n))),r}}])&&us(e.prototype,n),o&&us(e,o),t}();function hs(t){return(hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ps(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ys(t,e){return!e||"object"!==hs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bs(t){return(bs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ds(t,e){return(ds=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}fs.EMPTY=new fs(-1,-1,-1,-1);var vs=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ys(this,bs(e).call(this,"".concat(i,"-x-screen-part ").concat(t)))).xScreenZone=null,n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ds(t,e)}(e,t),n=e,(o=[{key:"onAttach",value:function(t){this.xScreenZone=t}}])&&ps(n.prototype,o),r&&ps(n,r),e}(D);function gs(t){return(gs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ws(t,e){return!e||"object"!==gs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ms(t){return(ms=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Es(t,e){return(Es=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Os=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ws(this,ms(e).call(this,"".concat(i,"-x-screen-lt-part ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Es(t,e)}(e,t),e}(vs);function Ss(t){return(Ss="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xs(t,e){return!e||"object"!==Ss(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ts(t){return(Ts=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _s(t,e){return(_s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ks=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),xs(this,Ts(e).call(this,"".concat(i,"-x-screen-br-part ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_s(t,e)}(e,t),e}(vs);function Ps(t){return(Ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cs(t,e){return!e||"object"!==Ps(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function js(t){return(js=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ls(t,e){return(Ls=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var As=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Cs(this,js(e).call(this,"".concat(i,"-x-screen-l-part ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ls(t,e)}(e,t),e}(vs);function Rs(t){return(Rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ns(t,e){return!e||"object"!==Rs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vs(t){return(Vs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Is(t,e){return(Is=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ms=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ns(this,Vs(e).call(this,"".concat(i,"-x-screen-br-part ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Is(t,e)}(e,t),e}(vs);function Ds(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Bs=function(){function t(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).table;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.lt=new Os,this.t=new ks,this.br=new Ms,this.l=new As,this.xScreen=null}var e,n,o;return e=t,(n=[{key:"onAdd",value:function(){}},{key:"hide",value:function(){this.lt.hide(),this.t.hide(),this.br.hide(),this.l.hide()}},{key:"show",value:function(){this.lt.show(),this.t.show(),this.br.show(),this.l.show()}},{key:"setXScreen",value:function(t){this.xScreen=t}}])&&Ds(e.prototype,n),o&&Ds(e,o),t}();function Hs(t){return(Hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ws(t,e){return!e||"object"!==Hs(e)&&"function"!=typeof e?Fs(t):e}function Fs(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ys(t,e,n){return(Ys="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Gs(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Gs(t){return(Gs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zs(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Us(t,e)}function Us(t,e){return(Us=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Xs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ks(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Zs(t,e,n){return e&&Ks(t.prototype,e),n&&Ks(t,n),t}var $s=function(){function t(e){Xs(this,t),this.viewEyes=e}return Zs(t,[{key:"setDisplay",value:function(t){var e=this.getXScreenViewRange().coincide(t),n=this.getPart();return e!==fs.EMPTY?(n.show(),!0):(n.hide(),!1)}},{key:"getPart",value:function(){throw new TypeError("child impl")}},{key:"getXScreenViewRange",value:function(){throw new TypeError("child impl")}}]),t}(),qs=function(t){function e(){return Xs(this,e),Ws(this,Gs(e).apply(this,arguments))}return zs(e,t),Zs(e,[{key:"setDisplay",value:function(t){var n=this.viewEyes.table.xFixedView;return!(!n.hasFixedTop()||!n.hasFixedLeft())&&Ys(Gs(e.prototype),"setDisplay",this).call(this,t)}},{key:"getPart",value:function(){return this.viewEyes.lt}},{key:"getXScreenViewRange",value:function(){var t=this.viewEyes.table.xFixedView;return t.hasFixedTop()&&t.hasFixedLeft()?t.getFixedView():fs.EMPTY}}]),e}($s),Js=function(t){function e(){return Xs(this,e),Ws(this,Gs(e).apply(this,arguments))}return zs(e,t),Zs(e,[{key:"setDisplay",value:function(t){return!!this.viewEyes.table.xFixedView.hasFixedTop()&&Ys(Gs(e.prototype),"setDisplay",this).call(this,t)}},{key:"getPart",value:function(){return this.viewEyes.t}},{key:"getXScreenViewRange",value:function(){var t=this.viewEyes.table,e=t.xFixedView;if(e.hasFixedTop()){var n=e.getFixedView(),o=t.getScrollView();return new fs(n.sri,o.sci,n.eri,o.eci)}return fs.EMPTY}}]),e}($s),Qs=function(t){function e(){return Xs(this,e),Ws(this,Gs(e).apply(this,arguments))}return zs(e,t),Zs(e,[{key:"getPart",value:function(){return this.viewEyes.br}},{key:"getXScreenViewRange",value:function(){return this.viewEyes.table.getScrollView()}}]),e}($s),tu=function(t){function e(){return Xs(this,e),Ws(this,Gs(e).apply(this,arguments))}return zs(e,t),Zs(e,[{key:"setDisplay",value:function(t){return!!this.viewEyes.table.xFixedView.hasFixedLeft()&&(Ys(Gs(e.prototype),"setDisplay",this).call(this,t),!0)}},{key:"getPart",value:function(){return this.viewEyes.l}},{key:"getXScreenViewRange",value:function(){var t=this.viewEyes.table,e=t.xFixedView;if(e.hasFixedLeft()){var n=e.getFixedView(),o=t.getScrollView();return new fs(o.sri,n.sci,o.eri,n.eci)}return fs.EMPTY}}]),e}($s),eu=function(t){function e(){var t,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).table;return Xs(this,e),(t=Ws(this,Gs(e).call(this,{table:n}))).ltDisplay=new qs(Fs(t)),t.tDisplay=new Js(Fs(t)),t.brDisplay=new Qs(Fs(t)),t.lDisplay=new tu(Fs(t)),t}return zs(e,t),Zs(e,[{key:"setDisplay",value:function(t){var e=this.ltDisplay.setDisplay(t),n=this.tDisplay.setDisplay(t),o=this.brDisplay.setDisplay(t),r=this.lDisplay.setDisplay(t);return e||n||o||r}},{key:"setLocal",value:function(){throw new TypeError("child impl")}},{key:"setSizer",value:function(){throw new TypeError("child impl")}}]),e}(Bs);function nu(t){return(nu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ou(t,e){return!e||"object"!==nu(e)&&"function"!=typeof e?ru(t):e}function ru(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function iu(t,e,n){return(iu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=cu(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function cu(t){return(cu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lu(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&au(t,e)}function au(t,e){return(au=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function su(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uu(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function fu(t,e,n){return e&&uu(t.prototype,e),n&&uu(t,n),t}var hu=function(){function t(e){su(this,t),this.viewLocal=e}return fu(t,[{key:"setLeft",value:function(t){var e=this.viewLocal.table.cols,n=this.getXScreenViewRange(),o=n.coincide(t),r=o!==fs.EMPTY?e.sectionSumWidth(n.sci,o.sci-1):0;this.getPart().offset({left:r})}},{key:"setTop",value:function(t){var e=this.viewLocal.table.rows,n=this.getXScreenViewRange(),o=n.coincide(t),r=o!==fs.EMPTY?e.sectionSumHeight(n.sri,o.sri-1):0;this.getPart().offset({top:r})}},{key:"setLocal",value:function(t){this.setTop(t),this.setLeft(t)}},{key:"getPart",value:function(){throw new TypeError("child impl")}},{key:"getXScreenViewRange",value:function(){throw new TypeError("child impl")}}]),t}(),pu=function(t){function e(){return su(this,e),ou(this,cu(e).apply(this,arguments))}return lu(e,t),fu(e,[{key:"setLocal",value:function(t){var n=this.viewLocal.table.xFixedView;n.hasFixedTop()&&n.hasFixedLeft()&&iu(cu(e.prototype),"setLocal",this).call(this,t)}},{key:"getPart",value:function(){return this.viewLocal.lt}},{key:"getXScreenViewRange",value:function(){var t=this.viewLocal.table.xFixedView;return t.hasFixedTop()&&t.hasFixedLeft()?t.getFixedView():fs.EMPTY}}]),e}(hu),yu=function(t){function e(){return su(this,e),ou(this,cu(e).apply(this,arguments))}return lu(e,t),fu(e,[{key:"setLocal",value:function(t){this.viewLocal.table.xFixedView.hasFixedTop()&&iu(cu(e.prototype),"setLocal",this).call(this,t)}},{key:"getPart",value:function(){return this.viewLocal.t}},{key:"getXScreenViewRange",value:function(){var t=this.viewLocal.table,e=t.xFixedView;if(e.hasFixedTop()){var n=e.getFixedView(),o=t.getScrollView();return new fs(n.sri,o.sci,n.eri,o.eci)}return fs.EMPTY}}]),e}(hu),bu=function(t){function e(){return su(this,e),ou(this,cu(e).apply(this,arguments))}return lu(e,t),fu(e,[{key:"getPart",value:function(){return this.viewLocal.br}},{key:"getXScreenViewRange",value:function(){return this.viewLocal.table.getScrollView()}}]),e}(hu),du=function(t){function e(){return su(this,e),ou(this,cu(e).apply(this,arguments))}return lu(e,t),fu(e,[{key:"setLocal",value:function(t){this.viewLocal.table.xFixedView.hasFixedLeft()&&iu(cu(e.prototype),"setLocal",this).call(this,t)}},{key:"getPart",value:function(){return this.viewLocal.l}},{key:"getXScreenViewRange",value:function(){var t=this.viewLocal.table,e=t.xFixedView;if(e.hasFixedLeft()){var n=e.getFixedView(),o=t.getScrollView();return new fs(o.sri,n.sci,o.eri,n.eci)}return fs.EMPTY}}]),e}(hu),vu=function(t){function e(){var t,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).table;return su(this,e),(t=ou(this,cu(e).call(this,{table:n}))).tlLocal=new pu(ru(t)),t.tLocal=new yu(ru(t)),t.brLocal=new bu(ru(t)),t.lLocal=new du(ru(t)),t}return lu(e,t),fu(e,[{key:"setLocal",value:function(t){this.tlLocal.setLocal(t),this.tLocal.setLocal(t),this.brLocal.setLocal(t),this.lLocal.setLocal(t)}}]),e}(eu);function gu(t){return(gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wu(t,e){return!e||"object"!==gu(e)&&"function"!=typeof e?mu(t):e}function mu(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Eu(t,e,n){return(Eu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ou(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Ou(t){return(Ou=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Su(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xu(t,e)}function xu(t,e){return(xu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Tu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _u(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ku(t,e,n){return e&&_u(t.prototype,e),n&&_u(t,n),t}var Pu=function(){function t(e){Tu(this,t),this.viewSizer=e}return ku(t,[{key:"setSizer",value:function(t){var e=this.viewSizer.table,n=e.cols,o=e.rows,r=this.getXScreenViewRange().coincide(t),i=n.rectRangeSumWidth(r),c=o.rectRangeSumHeight(r);this.getPart().offset({width:Bi.offsetToLineInside(i),height:Bi.offsetToLineInside(c)})}},{key:"getPart",value:function(){throw new TypeError("child impl")}},{key:"getXScreenViewRange",value:function(){throw new TypeError("child impl")}}]),t}(),Cu=function(t){function e(){return Tu(this,e),wu(this,Ou(e).apply(this,arguments))}return Su(e,t),ku(e,[{key:"setSizer",value:function(t){var n=this.viewSizer.table.xFixedView;n.hasFixedTop()&&n.hasFixedLeft()&&Eu(Ou(e.prototype),"setSizer",this).call(this,t)}},{key:"getPart",value:function(){return this.viewSizer.lt}},{key:"getXScreenViewRange",value:function(){var t=this.viewSizer.table.xFixedView;return t.hasFixedTop()&&t.hasFixedLeft()?t.getFixedView():fs.EMPTY}}]),e}(Pu),ju=function(t){function e(){return Tu(this,e),wu(this,Ou(e).apply(this,arguments))}return Su(e,t),ku(e,[{key:"setSizer",value:function(t){this.viewSizer.table.xFixedView.hasFixedTop()&&Eu(Ou(e.prototype),"setSizer",this).call(this,t)}},{key:"getPart",value:function(){return this.viewSizer.t}},{key:"getXScreenViewRange",value:function(){var t=this.viewSizer.table,e=t.xFixedView;if(e.hasFixedTop()){var n=e.getFixedView(),o=t.getScrollView();return new fs(n.sri,o.sci,n.eri,o.eci)}return fs.EMPTY}}]),e}(Pu),Lu=function(t){function e(){return Tu(this,e),wu(this,Ou(e).apply(this,arguments))}return Su(e,t),ku(e,[{key:"getPart",value:function(){return this.viewSizer.br}},{key:"getXScreenViewRange",value:function(){return this.viewSizer.table.getScrollView()}}]),e}(Pu),Au=function(t){function e(){return Tu(this,e),wu(this,Ou(e).apply(this,arguments))}return Su(e,t),ku(e,[{key:"setSizer",value:function(t){this.viewSizer.table.xFixedView.hasFixedLeft()&&Eu(Ou(e.prototype),"setSizer",this).call(this,t)}},{key:"getPart",value:function(){return this.viewSizer.l}},{key:"getXScreenViewRange",value:function(){var t=this.viewSizer.table,e=t.xFixedView;if(e.hasFixedLeft()){var n=e.getFixedView(),o=t.getScrollView();return new fs(o.sri,n.sci,o.eri,n.eci)}return fs.EMPTY}}]),e}(Pu),Ru=function(t){function e(){var t,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).table;return Tu(this,e),(t=wu(this,Ou(e).call(this,{table:n}))).ltSizer=new Cu(mu(t)),t.tSizer=new ju(mu(t)),t.brSizer=new Lu(mu(t)),t.lSizer=new Au(mu(t)),t}return Su(e,t),ku(e,[{key:"setSizer",value:function(t){this.ltSizer.setSizer(t),this.tSizer.setSizer(t),this.brSizer.setSizer(t),this.lSizer.setSizer(t)}}]),e}(vu);function Nu(t){return(Nu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Iu(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Mu(t,e,n){return e&&Iu(t.prototype,e),n&&Iu(t,n),t}function Du(t,e){return!e||"object"!==Nu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bu(t){return(Bu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hu(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wu(t,e)}function Wu(t,e){return(Wu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fu={LT:Symbol("lt"),T:Symbol("t"),BR:Symbol("br"),L:Symbol("l"),LTT:Symbol("ltt"),LTL:Symbol("ltl"),BRT:Symbol("brt"),BRL:Symbol("brl"),ALL:Symbol("all")},Yu=function(t){function e(t){var n,o=t.table,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Vu(this,e),(n=Du(this,Bu(e).call(this,{table:o}))).blt=new Os(r),n.bt=new ks(r),n.bl=new As(r),n.bbr=new Ms(r),n.lt.child(n.blt),n.t.child(n.bt),n.l.child(n.bl),n.br.child(n.bbr),n}return Hu(e,t),Mu(e,[{key:"hideBorder",value:function(){[this.bbr,this.bt,this.bl,this.blt].forEach((function(t){t.removeClass("show-bottom-border"),t.removeClass("show-top-border"),t.removeClass("show-right-border"),t.removeClass("show-left-border")}))}},{key:"showBorder",value:function(t){var e=this.getOverGo(t),n=this.getDisplay(t);this.showBBorder(e,n),this.showTBorder(e,n),this.showLBorder(e,n),this.showRBorder(e,n)}}]),e}(function(t){function e(){return Vu(this,e),Du(this,Bu(e).apply(this,arguments))}return Hu(e,t),Mu(e,[{key:"getDisplay",value:function(t){var e=this.table.getScrollView(),n={bottom:!1,left:!1,top:!1,right:!1};switch(this.getOverGo(t)){case Fu.LT:n.bottom=!0,n.top=!0,n.left=!0,n.right=!0;break;case Fu.T:n.bottom=!0,n.top=!0,n.left=t.sci>=e.sci&&t.sci<=e.eci,n.right=t.eci<=e.eci&&t.eci>=e.sci;break;case Fu.BR:n.bottom=t.eri<=e.eri&&t.eri>=e.sri,n.top=t.sri>=e.sri&&t.sri<=e.eri,n.left=t.sci>=e.sci&&t.sci<=e.eci,n.right=t.eci<=e.eci&&t.eci>=e.sci;break;case Fu.L:n.bottom=t.eri<=e.eri&&t.eri>=e.sri,n.top=t.sri>=e.sri&&t.sri<=e.eri,n.left=!0,n.right=!0;break;case Fu.LTT:n.bottom=!0,n.top=!0,n.left=!0,n.right=t.eci<=e.eci&&t.eci>=e.sci;break;case Fu.LTL:n.bottom=t.eri<=e.eri&&t.eri>=e.sri,n.top=!0,n.left=!0,n.right=!0;break;case Fu.BRT:n.bottom=t.eri<=e.eri&&t.eri>=e.sri,n.top=!0,n.left=t.sci>=e.sci&&t.sci<=e.eci,n.right=t.eci<=e.eci&&t.eci>=e.sci;break;case Fu.BRL:n.bottom=t.eri<=e.eri&&t.eri>=e.sri,n.top=t.sri>=e.sri&&t.sri<=e.eri,n.left=!0,n.right=t.eci<=e.eci&&t.eci>=e.sci;break;case Fu.ALL:n.bottom=t.eri<=e.eri&&t.eri>=e.sri,n.top=!0,n.left=!0,n.right=t.eci<=e.eci&&t.eci>=e.sci}return n}},{key:"getOverGo",value:function(t){var e=this.table,n=e.cols,o=e.rows,r=e.xFixedView,i=o.len-1,c=n.len-1,l=r.getFixedView();if(r.hasFixedTop()&&r.hasFixedLeft()){var a=l,s=new fs(l.sri,l.eci+1,l.eri,c),u=new fs(l.eri+1,l.sci,i,l.eci),f=new fs(l.eri+1,l.eci+1,i,c);if(a.contains(t))return Fu.LT;if(s.contains(t))return Fu.T;if(f.contains(t))return Fu.BR;if(u.contains(t))return Fu.L;var h=new fs(l.sri,l.sci,l.eri,c),p=new fs(l.sri,l.sci,i,l.eci),y=new fs(l.sri,l.eci+1,i,c),b=new fs(l.eri+1,l.sci,i,c);return h.contains(t)?Fu.LTT:p.contains(t)?Fu.LTL:y.contains(t)?Fu.BRT:b.contains(t)?Fu.BRL:Fu.ALL}if(r.hasFixedTop()){var d=new fs(l.sri,l.eci,l.eri,c),v=new fs(l.eri+1,l.eci+1,i,c);return d.contains(t)?Fu.T:v.contains(t)?Fu.BR:Fu.BRT}if(r.hasFixedLeft()){var g=new fs(l.eri,l.sci,i,l.eci),w=new fs(l.eri+1,l.eci+1,i,c);return g.contains(t)?Fu.L:w.contains(t)?Fu.BR:Fu.BRL}return Fu.BR}},{key:"showBBorder",value:function(t,e){switch(t){case Fu.LT:this.blt.addClass("show-bottom-border");break;case Fu.L:this.bl.addClass("show-bottom-border");break;case Fu.T:this.bt.addClass("show-bottom-border");break;case Fu.BR:e.bottom&&this.bbr.addClass("show-bottom-border");break;case Fu.LTT:this.blt.addClass("show-bottom-border"),this.bt.addClass("show-bottom-border");break;case Fu.LTL:e.bottom&&this.bl.addClass("show-bottom-border");break;case Fu.BRT:e.bottom&&this.bbr.addClass("show-bottom-border");break;case Fu.ALL:case Fu.BRL:e.bottom&&(this.bl.addClass("show-bottom-border"),this.bbr.addClass("show-bottom-border"))}}},{key:"showTBorder",value:function(t,e){switch(t){case Fu.LT:this.blt.addClass("show-top-border");break;case Fu.L:this.bl.addClass("show-top-border");break;case Fu.T:this.bt.addClass("show-top-border");break;case Fu.BR:e.top&&this.bbr.addClass("show-top-border");break;case Fu.LTT:this.blt.addClass("show-top-border"),this.bt.addClass("show-top-border");break;case Fu.LTL:this.blt.addClass("show-top-border");break;case Fu.BRT:this.bt.addClass("show-top-border");break;case Fu.BRL:e.top&&(this.bl.addClass("show-top-border"),this.bbr.addClass("show-top-border"));break;case Fu.ALL:this.blt.addClass("show-top-border"),this.bt.addClass("show-top-border")}}},{key:"showLBorder",value:function(t,e){switch(t){case Fu.LT:this.blt.addClass("show-left-border");break;case Fu.L:this.bl.addClass("show-left-border");break;case Fu.T:e.left&&this.bt.addClass("show-left-border");break;case Fu.BR:e.left&&this.bbr.addClass("show-left-border");break;case Fu.LTT:this.blt.addClass("show-left-border");break;case Fu.LTL:this.blt.addClass("show-left-border"),this.bl.addClass("show-left-border");break;case Fu.BRT:e.left&&(this.bt.addClass("show-left-border"),this.bbr.addClass("show-left-border"));break;case Fu.BRL:this.bl.addClass("show-left-border");break;case Fu.ALL:this.blt.addClass("show-left-border"),this.bl.addClass("show-left-border")}}},{key:"showRBorder",value:function(t,e){switch(t){case Fu.LT:this.blt.addClass("show-right-border");break;case Fu.L:this.bl.addClass("show-right-border");break;case Fu.T:e.right&&this.bt.addClass("show-right-border");break;case Fu.BR:e.right&&this.bbr.addClass("show-right-border");break;case Fu.LTT:e.right&&this.bt.addClass("show-right-border");break;case Fu.LTL:this.blt.addClass("show-right-border"),this.bl.addClass("show-right-border");break;case Fu.BRT:e.right&&(this.bt.addClass("show-right-border"),this.bbr.addClass("show-right-border"));break;case Fu.BRL:e.right&&this.bbr.addClass("show-right-border");break;case Fu.ALL:e.right&&(this.bt.addClass("show-right-border"),this.bbr.addClass("show-right-border"))}}}]),e}(Ru));function Gu(t){return(Gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zu(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Uu(t,e){return!e||"object"!==Gu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xu(t){return(Xu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ku(t,e){return(Ku=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zu=function(t){function e(t){var n,o=t.table;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Uu(this,Xu(e).call(this,{table:o},"".concat(i,"-part-border-css")))).type="solid",n.color="#42a642",n.setBorderType(n.type),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ku(t,e)}(e,t),n=e,(o=[{key:"setBorderType",value:function(t){this.type=t,this.blt.addClass(t),this.bl.addClass(t),this.bt.addClass(t),this.bbr.addClass(t)}},{key:"setBorderColor",value:function(t){this.color=t,this.blt.css("border-color",t),this.bl.css("border-color",t),this.bt.css("border-color",t),this.bbr.css("border-color",t)}}])&&zu(n.prototype,o),r&&zu(n,r),e}(Yu),$u=n(0),qu=n.n($u),Ju=n(1),Qu=n.n(Ju),tf=n(2),ef=n.n(tf);function nf(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var of=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.flag=null,this.table=e}var e,n,o;return e=t,(n=[{key:"lock",value:function(t){return this.flag=t,this}},{key:"set",value:function(t,e){if(null===this.flag||this.flag===e){var n=this.table;switch(t){case"s-resize":return void n.css("cursor","url(".concat(Qu.a,") 2.5 7.5,auto"));case"cell":return void n.css("cursor","url(".concat(qu.a,") 7.5 7.5,auto"));case"e-resize":return void n.css("cursor","url(".concat(ef.a,") 7.5 2.5,auto"))}n.css("cursor",t)}}},{key:"free",value:function(t){return this.flag===t&&(this.flag=null,!0)}}])&&nf(e.prototype,n),o&&nf(e,o),t}();function rf(t){return(rf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cf(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function lf(t,e){return!e||"object"!==rf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function af(t){return(af=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sf(t,e){return(sf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}of.KEYS={cell:"cell",crosshair:"crosshair",eResize:"e-resize",sResize:"s-resize",grab:"-webkit-grab",default:"default",rowResize:"row-resize",colResize:"col-resize",pointer:"pointer"};var uf={LT:Symbol("LT"),L:Symbol("L"),T:Symbol("T"),BR:Symbol("BR")},ff=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=lf(this,af(e).call(this,{table:t}))).selectLocal=uf.BR,n.display=!1,n.selectRange=null,n.downRange=null,n.moveRange=null,n.ltElem=new D("".concat(i,"-x-select-area")),n.brElem=new D("".concat(i,"-x-select-area")),n.lElem=new D("".concat(i,"-x-select-area")),n.tElem=new D("".concat(i,"-x-select-area")),n.ltCorner=new D("".concat(i,"-x-select-corner")),n.lCorner=new D("".concat(i,"-x-select-corner")),n.tCorner=new D("".concat(i,"-x-select-corner")),n.brCorner=new D("".concat(i,"-x-select-corner")),n.ltElem.child(n.ltCorner),n.lElem.child(n.lCorner),n.tElem.child(n.tCorner),n.brElem.child(n.brCorner),n.blt.child(n.ltElem),n.bl.child(n.lElem),n.bt.child(n.tElem),n.bbr.child(n.brElem),n.setBorderType("solid"),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sf(t,e)}(e,t),n=e,(r=[{key:"onAdd",value:function(){var t=this.table;this.bind(),this.hide(),t.focus.register({target:this.ltCorner}),t.focus.register({target:this.lCorner}),t.focus.register({target:this.tCorner}),t.focus.register({target:this.brCorner})}},{key:"bind",value:function(){var t=this,n=this.table,r=n.mousePointer,i=n.focus;A.bind(n,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.offsetHandle(),t.borderHandle(),t.cornerHandle()})),A.bind(n,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.offsetHandle(),t.borderHandle(),t.cornerHandle()})),A.bind(n,o.TABLE_EVENT_TYPE.SCALE_CHANGE,(function(){t.offsetHandle(),t.borderHandle(),t.cornerHandle()})),A.bind(n,o.TABLE_EVENT_TYPE.FIXED_CHANGE,(function(){t.offsetHandle(),t.borderHandle(),t.cornerHandle()})),A.bind(n,o.TABLE_EVENT_TYPE.RESIZE_CHANGE,(function(){t.offsetHandle(),t.borderHandle(),t.cornerHandle()})),A.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(c){if(0===c.button&&i.activate.target===n){var l=n.computeEventXy(c),a=l.x,s=l.y;t.downSelectRange(a,s),t.offsetHandle(),t.borderHandle(),t.cornerHandle();var u=t.selectLocal;switch(u){case uf.L:r.lock(e),r.set(of.KEYS.eResize,e);break;case uf.T:r.lock(e),r.set(of.KEYS.sResize,e)}n.trigger(o.TABLE_EVENT_TYPE.SELECT_DOWN),n.trigger(o.TABLE_EVENT_TYPE.SELECT_CHANGE),A.mouseMoveUp(document,(function(e){var r=n.computeEventXy(e),i=r.x,c=r.y;t.moveSelectRange(i,c),t.offsetHandle(),t.borderHandle(),t.cornerHandle(),n.trigger(o.TABLE_EVENT_TYPE.SELECT_CHANGE)}),(function(){switch(u){case uf.L:case uf.T:r.free(e)}n.trigger(o.TABLE_EVENT_TYPE.SELECT_OVER)}))}})),A.bind(n,o.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.offsetHandle(),t.borderHandle(),t.cornerHandle()}))}},{key:"borderHandle",value:function(){var t=this.selectRange,e=this.display;t&&e&&(this.hideBorder(),this.showBorder(t))}},{key:"offsetHandle",value:function(){var t=this.selectRange;t&&this.setDisplay(t)?(this.display=!0,this.setSizer(t),this.setLocal(t)):this.display=!1}},{key:"cornerHandle",value:function(){var t=this.selectRange,e=this.selectLocal,n=this.display;if(t&&n){var o=this.getOverGo(t);switch(this.ltCorner.hide(),this.tCorner.hide(),this.lCorner.hide(),this.brCorner.hide(),this.brCorner.removeClass("br-pos"),this.lCorner.removeClass("br-pos"),this.tCorner.removeClass("br-pos"),this.ltCorner.removeClass("br-pos"),this.brCorner.removeClass("tr-pos"),this.lCorner.removeClass("tr-pos"),this.tCorner.removeClass("tr-pos"),this.ltCorner.removeClass("tr-pos"),this.brCorner.removeClass("bl-pos"),this.lCorner.removeClass("bl-pos"),this.tCorner.removeClass("bl-pos"),this.ltCorner.removeClass("bl-pos"),e){case uf.L:this.brCorner.addClass("bl-pos"),this.lCorner.addClass("bl-pos"),this.tCorner.addClass("bl-pos"),this.ltCorner.addClass("bl-pos");break;case uf.T:this.brCorner.addClass("tr-pos"),this.lCorner.addClass("tr-pos"),this.tCorner.addClass("tr-pos"),this.ltCorner.addClass("tr-pos");break;case uf.LT:case uf.BR:this.brCorner.addClass("br-pos"),this.lCorner.addClass("br-pos"),this.tCorner.addClass("br-pos"),this.ltCorner.addClass("br-pos")}switch(o){case Fu.LT:this.ltCorner.show(),this.tCorner.hide(),this.brCorner.hide(),this.lCorner.hide();break;case Fu.LTT:case Fu.T:this.ltCorner.hide(),this.tCorner.show(),this.brCorner.hide(),this.lCorner.hide();break;case Fu.ALL:case Fu.BRL:case Fu.BRT:case Fu.BR:this.ltCorner.hide(),this.tCorner.hide(),this.brCorner.show(),this.lCorner.hide();break;case Fu.LTL:case Fu.L:this.ltCorner.hide(),this.tCorner.hide(),this.brCorner.hide(),this.lCorner.show()}}}},{key:"moveSelectRange",value:function(t,e){var n=this.table,o=n.rows,r=n.cols,i=this.downRange,c=this.selectLocal,l=n.getTableMerges(),a=n.getScrollView(),s=n.getRiCiByXy(t,e),u=s.ri,f=s.ci;if(-1===u&&(u=a.sri),-1===f&&(f=a.sci),c===uf.LT){var h=i.union(new fs(0,0,o.len-1,r.len-1));return this.moveRange=i.union(h),this.selectRange=this.moveRange,void(this.selectLocal=uf.LT)}if(c===uf.L){var p=i.union(new fs(u,0,u,0));return this.moveRange=i.union(p),this.selectRange=this.moveRange,void(this.selectLocal=uf.L)}if(c===uf.T){var y=i.union(new fs(0,f,0,f));return this.moveRange=i.union(y),this.selectRange=this.moveRange,void(this.selectLocal=uf.T)}var b=i.union(new fs(u,f,u,f));this.moveRange=l.union(b),this.selectRange=this.moveRange,this.selectLocal=uf.BR}},{key:"downSelectRange",value:function(t,e){var n=this.table,o=n.rows,r=n.cols,i=n.getTableMerges(),c=n.getRiCiByXy(t,e),l=c.ri,a=c.ci;return-1===l&&-1===a?(this.downRange=new fs(0,0,o.len-1,r.len-1),this.selectRange=this.downRange,void(this.selectLocal=uf.LT)):-1===l?(this.downRange=new fs(0,a,o.len-1,a),this.selectRange=this.downRange,void(this.selectLocal=uf.T)):-1===a?(this.downRange=new fs(l,0,l,r.len-1),this.selectRange=this.downRange,void(this.selectLocal=uf.L)):(this.downRange=i.getFirstIncludes(l,a)||new fs(l,a,l,a),this.selectRange=this.downRange,void(this.selectLocal=uf.BR))}},{key:"updateSelectRange",value:function(t){this.selectRange=t,this.selectLocal=uf.BR,this.offsetHandle(),this.borderHandle(),this.cornerHandle()}}])&&cf(n.prototype,r),c&&cf(n,c),e}(Zu);function hf(t){return(hf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pf(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function yf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bf(t,e,n){return(bf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=df(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function df(t){return(df=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vf(t,e){return(vf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gf=function(t){function e(t){var n,o,r,c=t.title,l=void 0===c?"提示":c,a=t.message,s=void 0===a?"":a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(r=df(e).call(this,"".concat(i,"-alert")))||"object"!==hf(r)&&"function"!=typeof r?yf(o):r).closeEle=k("div","".concat(i,"-alert-close")),n.titleEle=k("div","".concat(i,"-alert-title")),n.contentEle=k("div","".concat(i,"-alert-content")),n.okEle=k("div","".concat(i,"-alert-ok")),n.buttonsEle=k("div","".concat(i,"-alert-buttons")),n.titleEle.html(l),n.contentEle.html(s),n.okEle.html("确定"),n.buttonsEle.children(n.okEle),n.children(n.closeEle),n.children(n.titleEle),n.children(n.contentEle),n.children(n.buttonsEle),n.dragPanel=(new Gn).children(yf(n)),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vf(t,e)}(e,t),n=e,(r=[{key:"unbind",value:function(){var t=this.okEle;A.unbind(t)}},{key:"bind",value:function(){var t=this,e=this.okEle;A.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.close()}))}},{key:"open",value:function(){this.dragPanel.open(),this.bind()}},{key:"close",value:function(){this.dragPanel.close(),this.destroy()}},{key:"destroy",value:function(){bf(df(e.prototype),"destroy",this).call(this),this.unbind(),this.dragPanel.destroy()}}])&&pf(n.prototype,r),c&&pf(n,c),e}(D);function wf(t){return(wf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mf(t,e){return!e||"object"!==wf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ef(t){return(Ef=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Of(t,e){return(Of=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Sf=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=mf(this,Ef(e).call(this,"".concat(i,"-filter-data-menu-item ").concat(i,"-order-az")))).titleElement=k("div","".concat(i,"-filter-data-menu-item-title")),t.titleElement.text("以A->Z的顺序排序"),t.children(t.titleElement),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Of(t,e)}(e,t),e}(ie);function xf(t){return(xf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tf(t,e){return!e||"object"!==xf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _f(t){return(_f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kf(t,e){return(kf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pf=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Tf(this,_f(e).call(this,"".concat(i,"-filter-data-menu-item ").concat(i,"-order-za")))).titleElement=k("div","".concat(i,"-filter-data-menu-item-title")),t.titleElement.text("以Z->A的顺序排序"),t.children(t.titleElement),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kf(t,e)}(e,t),e}(ie);function Cf(t){return(Cf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jf(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Lf(t,e){return!e||"object"!==Cf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Af(t){return(Af=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rf(t,e){return(Rf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nf=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Lf(this,Af(e).call(this,"".concat(i,"-form-select-menu"),S.mergeDeep({autoHeight:!0,overflowY:!0},t)))).items=[],n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rf(t,e)}(e,t),n=e,(o=[{key:"addItem",value:function(t){this.items.push(t),this.children(t)}}])&&jf(n.prototype,o),r&&jf(n,r),e}(te);function Vf(t){return(Vf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function If(t,e){return!e||"object"!==Vf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mf(t){return(Mf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Df(t,e){return(Df=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bf=function(t){function e(t){var n,o=t.text,r=void 0===o?"":o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=If(this,Mf(e).call(this,"".concat(i,"-form-select-menu-item")))).textEle=k("div","".concat(i,"-form-select-menu-item-title")),n.textEle.text(r),n.children(n.textEle),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Df(t,e)}(e,t),e}(ie);function Hf(t){return(Hf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wf(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ff(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Yf(t,e,n){return(Yf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Gf(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Gf(t){return(Gf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zf(t,e){return(zf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Uf=function(t){function e(){var t,n,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=Gf(e).call(this,"".concat(i,"-form-select")))||"object"!==Hf(o)&&"function"!=typeof o?Ff(n):o).contextMenu=new Nf({el:Ff(t),position:Gt.BOTTOM}),t.selectText=k("div","".concat(i,"-form-select-text")),t.selectIcon=k("div","".concat(i,"-form-select-icon")),t.children(t.selectText),t.children(t.selectIcon),t.bind(),t}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zf(t,e)}(e,t),n=e,(r=[{key:"unbind",value:function(){A.unbind(this)}},{key:"bind",value:function(){var t=this;A.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){t.contextMenu.elPopUp.toggle(),e.stopPropagation()}))}},{key:"addValue",value:function(t){var e=t.text,n=t.value,o=new Bf({text:e,value:n});this.contextMenu.addItem(o)}},{key:"addDivider",value:function(){var t=new ve;this.contextMenu.addItem(t)}},{key:"destroy",value:function(){Yf(Gf(e.prototype),"destroy",this).call(this),this.unbind(),this.contextMenu.destroy()}}])&&Wf(n.prototype,r),c&&Wf(n,c),e}(D);function Xf(t){return(Xf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kf(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Zf(t,e){return!e||"object"!==Xf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $f(t,e,n){return($f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=qf(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function qf(t){return(qf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jf(t,e){return(Jf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qf=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Zf(this,qf(e).call(this,"".concat(i,"-filter-data-menu-item ").concat(i,"-if-filter")))).status=!1,t.titleEle=k("div","".concat(i,"-if-filter-title")),t.titleTextEle=k("span","".concat(i,"-if-filter-title-text")),t.titleIconEle=k("span","".concat(i,"-if-filter-title-icon")),t.titleTextEle.text("条件过滤"),t.titleEle.children(t.titleIconEle),t.titleEle.children(t.titleTextEle),t.children(t.titleEle),t.selectEleBox=k("div","".concat(i,"-if-filter-select-box")),t.selectEle=new Uf,t.selectEleBox.children(t.selectEle),t.children(t.selectEleBox),t.selectEle.addValue({text:"无"}),t.selectEle.addDivider(),t.selectEle.addValue({text:"为空"}),t.selectEle.addValue({text:"不为空"}),t.selectEle.addDivider(),t.selectEle.addValue({text:"文本包含"}),t.selectEle.addValue({text:"文本不包含"}),t.selectEle.addValue({text:"文本开头"}),t.selectEle.addValue({text:"文本结尾"}),t.selectEle.addValue({text:"文本结尾"}),t.selectEle.addValue({text:"文本相符"}),t.selectEle.addDivider(),t.selectEle.addValue({text:"日期为"}),t.selectEle.addValue({text:"日期超前"}),t.selectEle.addValue({text:"日期滞后"}),t.selectEle.addDivider(),t.selectEle.addValue({text:"数字大于"}),t.selectEle.addValue({text:"数字大于等于"}),t.selectEle.addValue({text:"数字小于"}),t.selectEle.addValue({text:"数字小于等于"}),t.selectEle.addValue({text:"数字等于"}),t.selectEle.addValue({text:"数字不等于"}),t.removeClass("hover"),t.bind(),t.hide(),t}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jf(t,e)}(e,t),n=e,(r=[{key:"unbind",value:function(){var t=this.titleEle;A.unbind(t)}},{key:"bind",value:function(){var t=this,e=this.titleEle,n=this.titleIconEle;A.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.status?(t.status=!1,t.hide(),n.removeClass("active")):(t.status=!0,t.show(),n.addClass("active"))}))}},{key:"show",value:function(){this.status=!0,this.selectEleBox.show()}},{key:"hide",value:function(){this.status=!1,this.selectEleBox.hide()}},{key:"destroy",value:function(){$f(qf(e.prototype),"destroy",this).call(this),this.unbind(),this.selectEle.destroy()}}])&&Kf(n.prototype,r),c&&Kf(n,c),e}(ie);function th(t){return(th="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eh(t,e){return!e||"object"!==th(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nh(t){return(nh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oh(t,e){return(oh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rh=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=eh(this,nh(e).call(this,"".concat(i,"-form-search-input")))).inputWrapEle=k("div","".concat(i,"-form-input-wrap")),t.inputInnerEle=k("div","".concat(i,"-form-input-inner")),t.inputEle=k("input","".concat(i,"-form-input-source")),t.searchEle=k("div","".concat(i,"-form-input-search")),t.inputInnerEle.children(t.inputEle),t.inputWrapEle.children(t.inputInnerEle),t.children(t.inputWrapEle),t.children(t.searchEle),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oh(t,e)}(e,t),e}(D);function ih(t){return(ih="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ch(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function lh(t,e){return!e||"object"!==ih(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ah(t,e,n){return(ah="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=sh(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function sh(t){return(sh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function uh(t,e){return(uh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fh=function(t){function e(t){var n,o=t.text,r=void 0===o?"":o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=lh(this,sh(e).call(this,"".concat(i,"-value-filter-item")))).status=!0,n.iconEle=k("div","".concat(i,"-value-filter-item-icon")),n.textEle=k("div","".concat(i,"-value-filter-item-text")),n.textEle.text(r),n.children(n.iconEle),n.children(n.textEle),n.bind(),n.select(!1),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&uh(t,e)}(e,t),n=e,(r=[{key:"unbind",value:function(){A.unbind(this)}},{key:"bind",value:function(){var t=this;A.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.select(!t.status)}))}},{key:"select",value:function(t){this.status=t,this.status?this.iconEle.css("opacity",1):this.iconEle.css("opacity",0)}},{key:"destroy",value:function(){ah(sh(e.prototype),"destroy",this).call(this),this.unbind()}}])&&ch(n.prototype,r),c&&ch(n,c),e}(D);function hh(t){return(hh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ph(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function yh(t,e){return!e||"object"!==hh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bh(t,e,n){return(bh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=dh(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function dh(t){return(dh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vh(t,e){return(vh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gh=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=yh(this,dh(e).call(this,"".concat(i,"-filter-data-menu-item ").concat(i,"-value-filter")))).status=!0,t.items=[],t.titleEle=k("div","".concat(i,"-value-filter-title")),t.titleTextEle=k("span","".concat(i,"-value-filter-title-text")),t.titleIconEle=k("span","".concat(i,"-value-filter-title-icon active")),t.titleTextEle.text("按值过滤"),t.titleEle.children(t.titleIconEle),t.titleEle.children(t.titleTextEle),t.children(t.titleEle),t.optionBoxEle=k("div","".concat(i,"-value-filter-option-box")),t.selectEle=k("div","".concat(i,"-value-filter-option-select")),t.flagEle=k("div","".concat(i,"-value-filter-option-flag")),t.clearEle=k("div","".concat(i,"-value-filter-option-clear")),t.clearEle.text("清空"),t.flagEle.html("&nbsp;-&nbsp;"),t.selectEle.text("全选"),t.optionBoxEle.children(t.selectEle),t.optionBoxEle.children(t.flagEle),t.optionBoxEle.children(t.clearEle),t.children(t.optionBoxEle),t.searchBoxEle=k("div","".concat(i,"-value-filter-input-box")),t.searchInput=new rh,t.searchBoxEle.children(t.searchInput),t.children(t.searchBoxEle),t.itemsBox=k("div","".concat(i,"-value-filter-items-box ").concat(i,"-no-scroll-bar")),t.children(t.itemsBox),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.addItem(new fh({text:"121212"})),t.removeClass("hover"),t.show(),t.bind(),t}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vh(t,e)}(e,t),n=e,(r=[{key:"addItem",value:function(t){this.items.push(t),this.itemsBox.children(t)}},{key:"unbind",value:function(){var t=this.titleEle,e=this.selectEle,n=this.clearEle;A.unbind(e),A.unbind(n),A.unbind(t)}},{key:"bind",value:function(){var t=this,e=this.titleEle,n=this.titleIconEle,r=this.selectEle,i=this.clearEle;A.bind(r,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.selectAll()})),A.bind(i,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.clearAll()})),A.bind(e,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.status?(t.status=!1,t.hide(),n.removeClass("active")):(t.status=!0,t.show(),n.addClass("active"))}))}},{key:"show",value:function(){this.status=!0,this.optionBoxEle.show(),this.searchBoxEle.show(),this.itemsBox.show()}},{key:"hide",value:function(){this.status=!1,this.optionBoxEle.hide(),this.searchBoxEle.hide(),this.itemsBox.hide()}},{key:"selectAll",value:function(){this.items.forEach((function(t){t.select(!0)}))}},{key:"clearAll",value:function(){this.items.forEach((function(t){t.select(!1)}))}},{key:"destroy",value:function(){bh(dh(e.prototype),"destroy",this).call(this),this.unbind(),this.items.forEach((function(t){t.destroy()})),this.searchInput.destroy()}}])&&ph(n.prototype,r),c&&ph(n,c),e}(ie);function wh(t){return(wh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mh(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Eh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Oh(t,e,n){return(Oh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Sh(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Sh(t){return(Sh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xh(t,e){return(xh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Th=function(t){function e(t){var n,r,c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,c=Sh(e).call(this,"".concat(i,"-filter-data-menu"),t),(n=!c||"object"!==wh(c)&&"function"!=typeof c?Eh(r):c).options=S.mergeDeep({ok:function(){},no:function(){}},t),n.valueFilter=new gh,n.ifFilter=new Qf,n.orderAz=new Sf,n.orderZa=new Pf,n.okEle=k("div","".concat(i,"-filter-data-menu-button ").concat(i,"-filter-data-menu-ok")),n.noEle=k("div","".concat(i,"-filter-data-menu-button ").concat(i,"-filter-data-menu-no")),n.children(n.orderAz),n.children(n.orderZa),n.children(new ve),n.children(n.ifFilter),n.children(n.valueFilter),n.children(new ve),n.children(n.noEle),n.children(n.okEle),n.okEle.html("确定"),n.noEle.html("取消"),n.okHandle=function(){n.options.ok(),n.close()},n.noHandle=function(){n.options.no(),n.close()},n.filterDataHandle=function(){Xt.closeAll([n.elPopUp])},A.bind(n.okEle,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,n.okHandle),A.bind(n.noEle,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,n.noHandle),A.bind(Eh(n),o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,n.filterDataHandle),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xh(t,e)}(e,t),n=e,(r=[{key:"destroy",value:function(){Oh(Sh(e.prototype),"destroy",this).call(this),this.valueFilter.destroy(),this.ifFilter.destroy(),A.unbind(this.okEle,o.SYSTEM_EVENT_TYPE.CLICK,this.okHandle),A.unbind(this.noEle,o.SYSTEM_EVENT_TYPE.CLICK,this.noHandle),A.unbind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,this.filterDataHandle)}}])&&mh(n.prototype,r),c&&mh(n,c),e}(te);function _h(t){return(_h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kh(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ph(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ch(t,e,n){return(Ch="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=jh(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function jh(t){return(jh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Lh(t,e){return(Lh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ah=function(t){function e(t){var n,o,r,c=t.ri,l=t.ci,a=t.xFilter,s=t.area;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(r=jh(e).call(this,"".concat(i,"-x-filter-button-box")))||"object"!==_h(r)&&"function"!=typeof r?Ph(o):r).xFilter=a,n.area=s,n.ri=c,n.ci=l,n.filterData=new Th({el:Ph(n)}),n.button=k("div","".concat(i,"-x-filter-button")),n.children(n.button),n.light(),n.bind(),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lh(t,e)}(e,t),n=e,(r=[{key:"light",value:function(){var t=this.ri,e=this.ci,n=this.xFilter,o=this.button,r=n.table.getTableCells().getCell(t,e);S.isUnDef(r)||S.isBlank(r.background)?(o.css("background-color","#ffffff"),o.addClass("".concat(i,"-x-filter-button-dark"))):(o.css("background-color",r.background),qn.isDark(r.background)?o.addClass("".concat(i,"-x-filter-button-dark")):o.addClass("".concat(i,"-x-filter-button-light")))}},{key:"bind",value:function(){var t=this.xFilter,n=this.button,r=this.filterData,i=t.table.mousePointer;A.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){i.lock(e),i.set(of.KEYS.pointer,e),A.mouseMoveUp(document,(function(){}),(function(){i.free(e)})),t.stopPropagation()})),A.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){i.free(e)})),A.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){i.lock(e),i.set(of.KEYS.pointer,e)})),A.bind(n,o.SYSTEM_EVENT_TYPE.CLICK,(function(){Xt.closeAll(),r.open()}))}},{key:"setSize",value:function(t,e,n){this.offset({left:t,top:0,width:e,height:n})}},{key:"destroy",value:function(){Ch(jh(e.prototype),"destroy",this).call(this);var t=this.area,n=this.button,o=this.filterData;A.unbind(n),o.destroy(),t.remove(this)}}])&&kh(n.prototype,r),c&&kh(n,c),e}(D);function Rh(t){return(Rh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nh(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Vh(t,e){return!e||"object"!==Rh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ih(t,e,n){return(Ih="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Mh(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Mh(t){return(Mh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dh(t,e){return(Dh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bh=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Vh(this,Mh(e).call(this,{table:t}))).display=!1,n.buttons=[],n.selectRange=null,n.flt=new D("".concat(i,"-x-filter ").concat(i,"-x-filter-lt")),n.ft=new D("".concat(i,"-x-filter ").concat(i,"-x-filter-t")),n.fbr=new D("".concat(i,"-x-filter ").concat(i,"-x-filter-br")),n.fl=new D("".concat(i,"-x-filter ").concat(i,"-x-filter-l")),n.blt.children(n.flt),n.bl.children(n.fl),n.bt.children(n.ft),n.bbr.children(n.fbr),n.setBorderColor("#0071cf"),n.bind(),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dh(t,e)}(e,t),n=e,(r=[{key:"filterRangeHandle",value:function(){var t=this.table,e=t.xScreen,n=t.cols,o=t.rows,r=e.findType(ff).selectRange,i=t.getTableCells(),c=t.getTableMerges();if(r){var l=r.clone(),a=l,s=a.sri,u=a.sci,f=a.eri,h=a.eci,p=o.len-1,y=n.len-1,b=c.getFirstIncludes(s,u)||fs.EMPTY;if(l.multiple()&&!b.equals(l))return void(this.selectRange=l);as.getInstance().setBegin(h+1).setEnd(y).setLoop((function(t){var e=i.getCellOrMergeCell(s,t);return!S.isUnDef(e)&&!S.isBlank(e.text)&&(l=l.union(new fs(s,t,s,t)),!0)})).execute(),as.getInstance().setBegin(u-1).setEnd(0).setLoop((function(t){var e=i.getCellOrMergeCell(s,t);return!S.isUnDef(e)&&!S.isBlank(e.text)&&(l=l.union(new fs(s,t,s,t)),!0)})).execute(),ns.getInstance().setBegin(f+1).setEnd(p).setLoop((function(t){var e=i.getCellOrMergeCell(t,u);return!S.isUnDef(e)&&!S.isBlank(e.text)&&(l=l.union(new fs(t,u,t,u)),!0)})).execute(),ns.getInstance().setBegin(s-1).setEnd(0).setLoop((function(t){var e=i.getCellOrMergeCell(t,u);return!S.isUnDef(e)&&!S.isBlank(e.text)&&(l=l.union(new fs(t,u,t,u)),!0)})).execute(),as.getInstance().setBegin(l.eci+1).setEnd(y).setLoop((function(t){var e=l,n=e.sri,o=e.eri,r=!0;return ns.getInstance().setBegin(n).setEnd(o).setLoop((function(e){var n=i.getCellOrMergeCell(e,t);S.isUnDef(n)||S.isBlank(n.text)||(l=l.union(new fs(e,t,e,t)),r=!1)})).execute(),!r})).execute(),as.getInstance().setBegin(l.sci-1).setEnd(0).setLoop((function(t){var e=l,n=e.sri,o=e.eri,r=!0;return ns.getInstance().setBegin(n).setEnd(o).setLoop((function(e){var n=i.getCellOrMergeCell(e,t);S.isUnDef(n)||S.isBlank(n.text)||(l=l.union(new fs(e,t,e,t)),r=!1)})).execute(),!r})).execute(),ns.getInstance().setBegin(l.eri+1).setEnd(p).setLoop((function(t){var e=l,n=e.sci,o=e.eci,r=!0;return as.getInstance().setBegin(n).setEnd(o).setLoop((function(e){var n=i.getCellOrMergeCell(t,e);S.isUnDef(n)||S.isBlank(n.text)||(l=l.union(new fs(t,e,t,e)),r=!1)})).execute(),!r})).execute(),ns.getInstance().setBegin(l.sri-1).setEnd(0).setLoop((function(t){var e=l,n=e.sci,o=e.eci,r=!0;return as.getInstance().setBegin(n).setEnd(o).setLoop((function(e){var n=i.getCellOrMergeCell(t,e);S.isUnDef(n)||S.isBlank(n.text)||(l=l.union(new fs(t,e,t,e)),r=!1)})).execute(),!r})).execute(),this.selectRange=l}else this.selectRange=null}},{key:"offsetHandle",value:function(){var t=this.selectRange;t&&(this.setDisplay(t),this.setSizer(t),this.setLocal(t))}},{key:"borderHandle",value:function(){var t=this.selectRange,e=this.display;t&&e&&(this.hideBorder(),this.showBorder(t))}},{key:"bind",value:function(){var t=this,e=this.table;A.bind(e,o.TABLE_EVENT_TYPE.RESIZE_CHANGE,(function(){t.display&&t.updateFilterButton()})),A.bind(e,o.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.display&&t.updateFilterButton()})),A.bind(e,o.TABLE_EVENT_TYPE.RENDER,(function(){t.display&&t.updateFilterButton()}))}},{key:"onAdd",value:function(){Ih(Mh(e.prototype),"onAdd",this).call(this)}},{key:"filterButtonHandle",value:function(){var t=this,e=this.table,n=this.selectRange;if(n){var o=e.xFixedView,r=e.cols,i=e.rows,c=e.xScreen,l=n.brink().top,a=o.getFixedView(),s=e.getScrollView(),u=a.sri,f=a.sci,h=a.eri,p=a.eci,y=s.sri,b=s.sci,d=s.eri,v=s.eci;this.buttons.forEach((function(t){t.destroy()}));var g=s.coincide(l),w=[],m=this.flt,E=this.ft,O=this.fbr,S=this.fl,x=fs.EMPTY,T=fs.EMPTY,_=fs.EMPTY;if(o.hasFixedTop()&&o.hasFixedLeft()){var k=c.findType(ff).getOverGo(l);switch(x=a.coincide(l),T=new fs(u,b,h,v).coincide(l),_=new fs(y,f,d,p).coincide(l),k){case Fu.ALL:case Fu.LT:case Fu.T:case Fu.LTT:case Fu.LTL:case Fu.BRT:if(!x.equals(fs.EMPTY)){var P=x.brink().top,C=i.getHeight(P.sri),j=0;as.getInstance().setBegin(P.sci).setEnd(P.eci).setLoop((function(e){var n=r.getWidth(e),o=new Ah({ri:P.sri,ci:e,xFilter:t,area:m});o.setSize(j,n,C),m.children(o),w.push(o),j+=n})).execute()}if(!T.equals(fs.EMPTY)){var L=T.brink().top,A=i.getHeight(L.sri),R=0;as.getInstance().setBegin(L.sci).setEnd(L.eci).setLoop((function(e){var n=r.getWidth(e),o=new Ah({ri:L.sri,ci:e,xFilter:t,area:E});o.setSize(R,n,A),E.children(o),w.push(o),R+=n})).execute()}break;case Fu.L:case Fu.BR:case Fu.BRL:if(!_.equals(fs.EMPTY)){var N=_.brink().top,V=i.getHeight(N.sri),I=0;as.getInstance().setBegin(N.sci).setEnd(N.eci).setLoop((function(e){var n=r.getWidth(e),o=new Ah({ri:N.sri,ci:e,xFilter:t,area:S});o.setSize(I,n,V),S.children(o),w.push(o),I+=n})).execute()}if(!g.equals(fs.EMPTY)){var M=g.brink().top,D=i.getHeight(M.sri),B=0;as.getInstance().setBegin(M.sci).setEnd(M.eci).setLoop((function(e){var n=r.getWidth(e),o=new Ah({ri:M.sri,ci:e,xFilter:t,area:O});o.setSize(B,n,D),O.children(o),w.push(o),B+=n})).execute()}}return void(this.buttons=w)}if(o.hasFixedTop()){if(!(T=new fs(u,b,h,v).coincide(l)).equals(fs.EMPTY)){var H=T.brink().top,W=i.getHeight(H.sri),F=0;as.getInstance().setBegin(H.sci).setEnd(H.eci).setLoop((function(e){var n=r.getWidth(e),o=new Ah({ri:H.sri,ci:e,xFilter:t,area:E});o.setSize(F,n,W),E.children(o),w.push(o),F+=n})).execute()}return void(this.buttons=w)}if(o.hasFixedLeft()){if(!(_=new fs(y,f,d,p).coincide(l)).equals(fs.EMPTY)){var Y=_.brink().top,G=i.getHeight(Y.sri),z=0;as.getInstance().setBegin(Y.sci).setEnd(Y.eci).setLoop((function(e){var n=r.getWidth(e),o=new Ah({ri:Y.sri,ci:e,xFilter:t,area:S});o.setSize(z,n,G),S.children(o),w.push(o),z+=n})).execute()}if(!g.equals(fs.EMPTY)){var U=g.brink().top,X=i.getHeight(U.sri),K=0;as.getInstance().setBegin(U.sci).setEnd(U.eci).setLoop((function(e){var n=r.getWidth(e),o=new Ah({ri:U.sri,ci:e,xFilter:t,area:O});o.setSize(K,n,X),O.children(o),w.push(o),K+=n})).execute()}return void(this.buttons=w)}if(!g.equals(fs.EMPTY)){var Z=g.brink().top,$=i.getHeight(Z.sri),q=0;as.getInstance().setBegin(Z.sci).setEnd(Z.eci).setLoop((function(e){var n=r.getWidth(e),o=new Ah({ri:Z.sri,ci:e,xFilter:t,area:O});o.setSize(q,n,$),O.children(o),w.push(o),q+=n})).execute()}this.buttons=w}}},{key:"openFilterButton",value:function(){var t=this.table.getTableCells();this.filterRangeHandle();var e=this.selectRange;e&&(t.emptyRectRange(e)?new gf({message:"不能为空数据区创建过滤器, 请选择非空区域"}).open():(this.display=!0,this.show(),this.updateFilterButton()))}},{key:"hideFilterButton",value:function(){this.display=!1,this.hide()}},{key:"updateFilterButton",value:function(){this.offsetHandle(),this.borderHandle(),this.filterButtonHandle()}}])&&Nh(n.prototype,r),c&&Nh(n,c),e}(Zu);function Hh(t){return(Hh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wh(t,e){return!e||"object"!==Hh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fh(t){return(Fh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yh(t,e){return(Yh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gh='\n  <svg class="'.concat(i,'-copy-style-svg" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">\n    <line class="').concat(i,"-copy-style-stroked ").concat(i,'-copy-style-stroked-top" x1="0" y1="0" x2="100%" y2="0"/>\n    <line class="').concat(i,"-copy-style-stroked ").concat(i,'-copy-style-stroked-left" x1="0" y1="0" x2="0" y2="100%"/>\n    <line class="').concat(i,"-copy-style-stroked ").concat(i,'-copy-style-stroked-bottom" x1="0" y1="100%" x2="100%" y2="100%"/>\n    <line class="').concat(i,"-copy-style-stroked ").concat(i,'-copy-style-stroked-right" x1="100%" y1="0" x2="100%" y2="100%"/>\n  </svg>\n');function zh(t){return(zh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uh(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Xh(t,e){return!e||"object"!==zh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Kh(t){return(Kh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zh(t,e){return(Zh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $h=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Xh(this,Kh(e).call(this,{table:t}))).display=!1,n.selectRange=fs.EMPTY,n.ltElem=new D("".concat(i,"-x-copy-style-area")),n.brElem=new D("".concat(i,"-x-copy-style-area")),n.lElem=new D("".concat(i,"-x-copy-style-area")),n.tElem=new D("".concat(i,"-x-copy-style-area")),n.blt.child(n.ltElem),n.bl.child(n.lElem),n.bt.child(n.tElem),n.bbr.child(n.brElem),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zh(t,e)}(e,t),n=e,(r=[{key:"onAdd",value:function(){this.hideCopyStyle(),this.bind()}},{key:"bind",value:function(){var t=this,e=this.table;A.bind(e,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.display&&(t.offsetHandle(),t.borderHandle())})),A.bind(e,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.display&&(t.offsetHandle(),t.borderHandle())})),A.bind(e,o.TABLE_EVENT_TYPE.SCALE_CHANGE,(function(){t.display&&(t.offsetHandle(),t.borderHandle())})),A.bind(e,o.TABLE_EVENT_TYPE.FIXED_CHANGE,(function(){t.display&&(t.offsetHandle(),t.borderHandle())})),A.bind(e,o.TABLE_EVENT_TYPE.RESIZE_CHANGE,(function(){t.display&&(t.offsetHandle(),t.borderHandle())})),A.bind(e,o.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.display&&(t.offsetHandle(),t.borderHandle())}))}},{key:"borderHandle",value:function(){var t=this.selectRange;t.equals(fs.EMPTY)||(this.hideBorder(),this.showBorder(t))}},{key:"offsetHandle",value:function(){var t=this.selectRange;t.equals(fs.EMPTY)?this.hide():(this.show(),this.setDisplay(t),this.setSizer(t),this.setLocal(t))}},{key:"hideCopyStyle",value:function(){this.display=!1,this.hide()}},{key:"showCopyStyle",value:function(){this.display=!0,this.show();var t=this.xScreen.findType(ff).selectRange;this.selectRange=t,this.offsetHandle(),this.borderHandle()}}])&&Uh(n.prototype,r),c&&Uh(n,c),e}(function(t){function e(t){var n,o=t.table;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Wh(this,Fh(e).call(this,{table:o},"".concat(i,"-part-border-svg")))).blt.html(Gh),n.bl.html(Gh),n.bt.html(Gh),n.bbr.html(Gh),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yh(t,e)}(e,t),e}(Yu));function qh(t){return(qh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jh(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Qh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tp(t,e,n){return(tp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ep(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function ep(t){return(ep=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function np(t,e){return(np=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var op=function(t){function e(t){var n,o,r,c=t.title,l=void 0===c?"提示":c,a=t.message,s=void 0===a?"":a,u=t.ok,f=void 0===u?function(){}:u,h=t.no,p=void 0===h?function(){}:h;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,(n=!(r=ep(e).call(this,"".concat(i,"-confirm")))||"object"!==qh(r)&&"function"!=typeof r?Qh(o):r).title=l,n.message=s,n.ok=f,n.no=p,n.closeEle=k("div","".concat(i,"-confirm-close")),n.titleEle=k("div","".concat(i,"-confirm-title")),n.contentEle=k("div","".concat(i,"-confirm-content")),n.okEle=k("div","".concat(i,"-confirm-button ").concat(i,"-confirm-ok")),n.noEle=k("div","".concat(i,"-confirm-button ").concat(i,"-confirm-no")),n.buttonsEle=k("div","".concat(i,"-confirm-buttons")),n.titleEle.html(l),n.contentEle.html(s),n.okEle.html("确定"),n.noEle.html("取消"),n.buttonsEle.children(n.noEle),n.buttonsEle.children(n.okEle),n.children(n.closeEle),n.children(n.titleEle),n.children(n.contentEle),n.children(n.buttonsEle),n.dragPanel=(new Gn).children(Qh(n)),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&np(t,e)}(e,t),n=e,(r=[{key:"unbind",value:function(){var t=this.okEle,e=this.noEle;A.unbind(t),A.unbind(e)}},{key:"bind",value:function(){var t=this,e=this.okEle,n=this.noEle;A.bind(e,o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.ok(),t.close()})),A.bind(n,o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.no(),t.close()}))}},{key:"open",value:function(){this.dragPanel.open(),this.bind()}},{key:"close",value:function(){this.dragPanel.close(),this.destroy()}},{key:"destroy",value:function(){tp(ep(e.prototype),"destroy",this).call(this),this.unbind(),this.dragPanel.destroy()}}])&&Jh(n.prototype,r),c&&Jh(n,c),e}(D);function rp(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ip(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function cp(t){return(cp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ap(t,e){return!e||"object"!==cp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function sp(t){return(sp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function up(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fp(t,e)}function fp(t,e){return(fp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hp=function(t){function e(){return lp(this,e),ap(this,sp(e).call(this,"".concat(i,"-tools-divider")))}return up(e,t),e}(D),pp=function(t){function e(t){var n;lp(this,e),(n=ap(this,sp(e).call(this,"".concat(i,"-tools-menu")))).workTop=t;var o=n.workTop.work.body.sheetView;return n.undo=new bt,n.redo=new mt,n.scale=new Ua({contextMenu:{onUpdate:function(t){n.scale.setTitle("".concat(t,"%")),n.workTop.work.body.setScale(t/100)}}}),n.paintFormat=new _t,n.clearFormat=new Lt,n.format=new Pe({contextMenu:{onUpdate:function(t,e){var r=o.getActiveSheet().table,i=r.xScreen,c=r.getStyleCellsHelper(),l=r.tableDataSnapshot,a=i.findType(ff).selectRange;if(n.format.setTitle(e),a){l.begin();var s=l.cellDataProxy;c.getCellOrNewCellByViewRange({rectRange:a,callback:function(e,n,o){var r=o.clone();r.format=t,s.setCell(e,n,r)}}),l.end(),r.render()}}}}),n.font=new Ue({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,r=e.xScreen,i=e.getStyleCellsHelper(),c=e.tableDataSnapshot,l=r.findType(ff).selectRange;if(n.font.setTitle(t),l){c.begin();var a=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l,callback:function(e,n,o){var r=o.clone();r.fontAttr.name=t,a.setCell(e,n,r)}}),c.end(),e.render()}}}}),n.dprFontSize=new sn({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,r=e.xScreen,i=e.getStyleCellsHelper(),c=e.tableDataSnapshot,l=r.findType(ff).selectRange;if(n.dprFontSize.setTitle(t),l){c.begin();var a=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l,callback:function(e,n,o){var r=o.clone();r.fontAttr.size=t,a.setCell(e,n,r)}}),c.end(),e.render()}}}}),n.fontColor=new Oo({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,r=e.xScreen,i=e.getStyleCellsHelper(),c=e.tableDataSnapshot,l=r.findType(ff).selectRange;if(n.fontColor.setColor(t),l){c.begin();var a=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l,callback:function(e,n,o){var r=o.clone();r.fontAttr.color=t,a.setCell(e,n,r)}}),c.end(),e.render()}}}}),n.fillColor=new Bo({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,r=e.xScreen,i=e.getStyleCellsHelper(),c=e.tableDataSnapshot,l=r.findType(ff).selectRange;if(n.fillColor.setColor(t),l){c.begin();var a=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l,callback:function(e,n,o){var r=o.clone();r.background=t,a.setCell(e,n,r)}}),c.end(),e.render()}}}}),n.border=new oc({contextMenu:{onUpdate:function(t,e,n){var r=o.getActiveSheet().table,i=r.xScreen,c=r.getOperateCellsHelper(),l=r.tableDataSnapshot,a=i.findType(ff).selectRange;if(a){l.begin();var s=l.cellDataProxy,u=a,f=Bi.LINE_WIDTH_TYPE.low,h=Yi.SOLID_LINE;switch(n){case"line1":f=Bi.LINE_WIDTH_TYPE.low,h=Yi.SOLID_LINE;break;case"line2":f=Bi.LINE_WIDTH_TYPE.medium,h=Yi.SOLID_LINE;break;case"line3":f=Bi.LINE_WIDTH_TYPE.high,h=Yi.SOLID_LINE;break;case"line4":h=Yi.DOTTED_LINE;break;case"line5":h=Yi.POINT_LINE;break;case"line6":h=Yi.DOUBLE_LINE}switch(t){case"border1":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,n,o){var r=o.clone(),i=r.borderAttr;i.setAllDisplay(!0),i.setAllColor(e),i.setAllWidthType(f),i.setAllType(h),s.setCell(t,n,r)}});break;case"border2":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,n,o){var r=o.clone(),i=r.borderAttr;t!==u.sri&&(i.setTDisplay(!0),i.setTColor(e),i.setTWidthType(f),i.setTType(h)),t!==u.eri&&(i.setBDisplay(!0),i.setBColor(e),i.setBWidthType(f),i.setBType(h)),n!==u.sci&&(i.setLDisplay(!0),i.setLColor(e),i.setLWidthType(f),i.setLType(h)),n!==u.eci&&(i.setRDisplay(!0),i.setRColor(e),i.setRWidthType(f),i.setRType(h)),s.setCell(t,n,r)}});break;case"border3":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,n,o){var r=o.clone().borderAttr;t!==u.sri&&(r.setTDisplay(!0),r.setTColor(e),r.setTWidthType(f),r.setTType(h)),t!==u.eri&&(r.setBDisplay(!0),r.setBColor(e),r.setBWidthType(f),r.setBType(h))}});break;case"border4":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,n,o){var r=o.clone(),i=r.borderAttr;n!==u.sci&&(i.setLDisplay(!0),i.setLColor(e),i.setLWidthType(f),i.setLType(h)),n!==u.eci&&(i.setRDisplay(!0),i.setRColor(e),i.setRWidthType(f),i.setRType(h)),s.setCell(t,n,r)}});break;case"border5":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,n,o){var r=o.clone(),i=r.borderAttr;t===u.sri&&(i.setTDisplay(!0),i.setTColor(e),i.setTWidthType(f),i.setTType(h)),t===u.eri&&(i.setBDisplay(!0),i.setBColor(e),i.setBWidthType(f),i.setBType(h)),n===u.sci&&(i.setLDisplay(!0),i.setLColor(e),i.setLWidthType(f),i.setLType(h)),n===u.eci&&(i.setRDisplay(!0),i.setRColor(e),i.setRWidthType(f),i.setRType(h)),s.setCell(t,n,r)}});break;case"border6":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,n,o){var r=o.clone(),i=r.borderAttr;n===u.sci&&(i.setLDisplay(!0),i.setLColor(e),i.setLWidthType(f),i.setLType(h)),s.setCell(t,n,r)}});break;case"border7":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,n,o){var r=o.clone(),i=r.borderAttr;t===u.sri&&(i.setTDisplay(!0),i.setTColor(e),i.setTWidthType(f),i.setTType(h)),s.setCell(t,n,r)}});break;case"border8":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,n,o){var r=o.clone(),i=r.borderAttr;n===u.eci&&(i.setRDisplay(!0),i.setRColor(e),i.setRWidthType(f),i.setRType(h)),s.setCell(t,n,r)}});break;case"border9":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,n,o){var r=o.clone(),i=r.borderAttr;t===u.eri&&(i.setBDisplay(!0),i.setBColor(e),i.setBWidthType(f),i.setBType(h)),s.setCell(t,n,r)}});break;case"border10":c.getCellOrNewCellByViewRange({rectRange:u,callback:function(t,e,n){var o=n.clone();o.borderAttr.setAllDisplay(!1),s.setCell(t,e,o)}})}l.end(),r.render()}}}}),n.fontBold=new yn,n.fontItalic=new wn,n.underLine=new xn,n.fontStrike=new Cn,n.merge=new ac,n.horizontalAlign=new Hc({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,r=e.xScreen,i=e.getStyleCellsHelper(),c=e.tableDataSnapshot,l=r.findType(ff).selectRange;switch(t){case jc.ALIGN.left:n.horizontalAlign.setIcon(new it("align-left"));break;case jc.ALIGN.center:n.horizontalAlign.setIcon(new it("align-center"));break;case jc.ALIGN.right:n.horizontalAlign.setIcon(new it("align-right"))}if(l){c.begin();var a=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l,callback:function(e,n,o){var r=o.clone();r.fontAttr.align=t,a.setCell(e,n,r)}}),c.end(),e.render()}}}}),n.verticalAlign=new dl({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,r=e.xScreen,i=e.getStyleCellsHelper(),c=e.tableDataSnapshot,l=r.findType(ff).selectRange;switch(t){case jc.VERTICAL_ALIGN.top:n.verticalAlign.setIcon(new it("align-top"));break;case jc.VERTICAL_ALIGN.center:n.verticalAlign.setIcon(new it("align-middle"));break;case jc.VERTICAL_ALIGN.bottom:n.verticalAlign.setIcon(new it("align-bottom"))}if(l){c.begin();var a=c.cellDataProxy;i.getCellOrNewCellByViewRange({rectRange:l,callback:function(e,n,o){var r=o.clone();r.fontAttr.verticalAlign=t,a.setCell(e,n,r)}}),c.end(),e.render()}}}}),n.textWrapping=new Ul({contextMenu:{onUpdate:function(t){var e,r=o.getActiveSheet().table,i=r.xScreen,c=r.getStyleCellsHelper(),l=r.tableDataSnapshot,a=i.findType(ff).selectRange;switch(t){case jc.TEXT_WRAP.TRUNCATE:e=new it("truncate");break;case jc.TEXT_WRAP.WORD_WRAP:e=new it("text-wrap");break;case jc.TEXT_WRAP.OVER_FLOW:e=new it("overflow")}if(n.textWrapping.setIcon(e),a){l.begin();var s=l.cellDataProxy;c.getCellOrNewCellByViewRange({rectRange:a,callback:function(e,n,o){var r=o.clone();r.fontAttr.textWrap=t,s.setCell(e,n,r)}}),l.end(),r.render()}}}}),n.fixed=new ua({contextMenu:{onUpdate:function(t){var e=o.getActiveSheet().table,r=e.xScreen.findType(ff).selectRange;switch(t){case"ROW":if(n.fixed.rowStatus)e.setFixedRow(-1);else if(r){var i=e.getScrollView(),c=r.sri;c<i.eri-2&&c>=i.sri?e.setFixedRow(c):new gf({message:"无法在当前区域内冻结单元格, 请重新选择冻结区域"}).open()}break;case"COL":if(n.fixed.colStatus)e.setFixedCol(-1);else if(r){var l=e.getScrollView(),a=r.sci;a<l.eci-2&&a>=l.sci?e.setFixedCol(a):new gf({message:"无法在当前区域内冻结单元格, 请重新选择冻结区域"}).open()}break;case"ROW1":e.setFixedRow(0,0);break;case"ROW2":e.setFixedRow(1,0);break;case"COL1":e.setFixedCol(0,0);break;case"COL2":e.setFixedCol(1,0)}}}}),n.filter=new ba,n.functions=new ma,n.children(n.undo),n.children(n.redo),n.children(new hp),n.children(n.scale),n.children(n.paintFormat),n.children(n.clearFormat),n.children(n.format),n.children(new hp),n.children(n.font),n.children(n.dprFontSize),n.children(new hp),n.children(n.fontBold),n.children(n.fontItalic),n.children(n.underLine),n.children(n.fontStrike),n.children(n.fontColor),n.children(new hp),n.children(n.fillColor),n.children(n.border),n.children(n.merge),n.children(n.horizontalAlign),n.children(n.verticalAlign),n.children(n.textWrapping),n.children(n.fixed),n.children(n.filter),n.children(n.functions),n}var n,r,c;return up(e,t),n=e,(r=[{key:"onAttach",value:function(){this.bind()}},{key:"bind",value:function(){var t=this,e=this.workTop.work.body,n=e.sheetView;A.bind(e,o.WORK_BODY_EVENT_TYPE.CHANGE_ACTIVE,(function(){t.setStatus()})),A.bind(e,o.TABLE_EVENT_TYPE.SELECT_DOWN,(function(){t.setFormatStatus(),t.setFontStatus(),t.setFontSizeStatus(),t.setFontBoldStatus(),t.setFontItalicStatus(),t.setUnderLineStatus(),t.setFontStrikeStatus(),t.setFontColorStatus(),t.setFillColorStatus(),t.setHorizontalAlignStatus(),t.setVerticalAlignStatus(),t.setTextWrappingStatus()})),A.bind(e,o.TABLE_EVENT_TYPE.DATA_CHANGE,(function(){t.setStatus()})),A.bind(e,o.TABLE_EVENT_TYPE.FIXED_CHANGE,(function(){t.setFixedStatus()})),A.bind(this.scale,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.scale.scaleContextMenu,o=n.elPopUp;Xt.closeAll([o]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),A.bind(this.undo,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table.tableDataSnapshot;t.canBack()&&t.back()})),A.bind(this.redo,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table.tableDataSnapshot;t.canGo()&&t.go()})),A.bind(this.paintFormat,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var e=n.getActiveSheet(),r=e.table,i=r.xScreen,c=i.findType(ff),l=c.selectRange;if(!S.isUnDef(l)){var a=r.cellMergeCopyHelper,s=r.tableDataSnapshot,u=i.findType($h),f=function n(){u.hideCopyStyle(),t.paintFormat.active(!1),t.paintFormat.removeSheet(e);var i=u.selectRange.clone(),l=c.selectRange.clone(),f=rp(i.size(),2),h=f[0],p=f[1],y=rp(l.size(),2),b=y[0],d=y[1],v=h>b?h:b,g=p>d?p:d;l.eri=l.sri+(v-1),l.eci=l.sci+(g-1),s.begin(),a.copyMergeContent({originViewRange:i,targetViewRange:l}),a.copyStylesContent({originViewRange:i,targetViewRange:l}),s.end(),r.render(),A.unbind(r,o.TABLE_EVENT_TYPE.SELECT_OVER,n)};t.paintFormat.includeSheet(e)?(u.hideCopyStyle(),t.paintFormat.active(!1),t.paintFormat.removeSheet(e),A.unbind(r,o.TABLE_EVENT_TYPE.SELECT_OVER,f)):(u.showCopyStyle(),t.paintFormat.active(!0),t.paintFormat.addSheet(e),A.bind(r,o.TABLE_EVENT_TYPE.SELECT_OVER,f))}})),A.bind(this.clearFormat,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.xScreen,o=t.getStyleCellsHelper(),r=t.tableDataSnapshot,i=e.findType(ff).selectRange;if(i){r.begin();var c=r.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:i,callback:function(t,e,n){var o=n.text;c.setCell(t,e,new ja({text:o}))}}),r.end(),t.render()}})),A.bind(this.format,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.format.formatContextMenu,o=n.elPopUp;Xt.closeAll([o]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),A.bind(this.font,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.font.fontContextMenu,o=n.elPopUp;Xt.closeAll([o]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),A.bind(this.dprFontSize,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.dprFontSize.fontSizeContextMenu,o=n.elPopUp;Xt.closeAll([o]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),A.bind(this.fontBold,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.xScreen,o=t.getStyleCellsHelper(),r=t.getTableCells(),i=t.tableDataSnapshot,c=e.findType(ff).selectRange;if(c){var l=!r.getCellOrNew(c.sri,c.sci).fontAttr.bold;i.begin();var a=i.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:c,callback:function(t,e,n){var o=n.clone();o.fontAttr.bold=l,a.setCell(t,e,o)}}),i.end(),t.render()}})),A.bind(this.fontItalic,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.xScreen,o=t.getStyleCellsHelper(),r=t.getTableCells(),i=t.tableDataSnapshot,c=e.findType(ff).selectRange;if(c){var l=!r.getCellOrNew(c.sri,c.sci).fontAttr.italic;i.begin();var a=i.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:c,callback:function(t,e,n){var o=n.clone();o.fontAttr.italic=l,a.setCell(t,e,o)}}),i.end(),t.render()}})),A.bind(this.underLine,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.xScreen,o=t.getStyleCellsHelper(),r=t.getTableCells(),i=t.tableDataSnapshot,c=e.findType(ff).selectRange;if(c){var l=!r.getCellOrNew(c.sri,c.sci).fontAttr.underline;i.begin();var a=i.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:c,callback:function(t,e,n){var o=n.clone();o.fontAttr.underline=l,a.setCell(t,e,o)}}),i.end(),t.render()}})),A.bind(this.fontStrike,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var t=n.getActiveSheet().table,e=t.xScreen,o=t.getStyleCellsHelper(),r=t.getTableCells(),i=t.tableDataSnapshot,c=e.findType(ff).selectRange;if(c){var l=!r.getCellOrNew(c.sri,c.sci).fontAttr.strikethrough;i.begin();var a=i.cellDataProxy;o.getCellOrNewCellByViewRange({rectRange:c,callback:function(t,e,n){var o=n.clone();o.fontAttr.strikethrough=l,a.setCell(t,e,o)}}),i.end(),t.render()}})),A.bind(this.fontColor,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.fontColor.fontColorContextMenu,o=n.elPopUp;Xt.closeAll([o]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),A.bind(this.fillColor,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.fillColor.fillColorContextMenu,o=n.elPopUp;Xt.closeAll([o]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),A.bind(this.border,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.border.borderTypeContextMenu,o=n.elPopUp;Xt.closeAll([o]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),A.bind(this.merge,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){var e=n.getActiveSheet().table,o=e.xScreen,r=e.getTableMerges(),i=e.getTableCells(),c=e.tableDataSnapshot,l=o.findType(ff).selectRange;if(l){var a=l.clone(),s=r.getFirstIncludes(a.sri,a.sci),u=c.mergeDataProxy;S.isNotUnDef(s)&&a.equals(s)?(c.begin(),u.deleteMerge(s),c.end(),e.render()):a.multiple()&&(i.emptyRectRange(a)?(c.begin(),u.addMerge(a),c.end(),e.render()):new op({message:"非空单元格合并将使用左上角单元格内容",ok:function(){c.begin(),u.addMerge(a),c.end(),e.render()}}).open())}t.stopPropagation(),t.preventDefault()})),A.bind(this.horizontalAlign,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.horizontalAlign.horizontalContextMenu,o=n.elPopUp;Xt.closeAll([o]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),A.bind(this.verticalAlign,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.verticalAlign.verticalContextMenu,o=n.elPopUp;Xt.closeAll([o]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),A.bind(this.textWrapping,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.textWrapping.textWrappingContextMenu,o=n.elPopUp;Xt.closeAll([o]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),A.bind(this.fixed,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){var n=t.fixed.fixedContextMenu,o=n.elPopUp;Xt.closeAll([o]),n.isOpen()?n.open():n.close(),e.stopPropagation(),e.preventDefault()})),A.bind(this.filter,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var e=n.getActiveSheet().table.xScreen.findType(Bh);e.display?(e.hideFilterButton(),t.filter.active(e.display)):(e.openFilterButton(),t.filter.active(e.display))}))}},{key:"setHorizontalAlignStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(ff).selectRange,r=new it("align-left");if(o)switch(n.getCellOrNew(o.sri,o.sci).fontAttr.align){case jc.ALIGN.left:r=new it("align-left");break;case jc.ALIGN.center:r=new it("align-center");break;case jc.ALIGN.right:r=new it("align-right")}this.horizontalAlign.setIcon(r)}},{key:"setVerticalAlignStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(ff).selectRange,r=new it("align-middle");if(o)switch(n.getCellOrNew(o.sri,o.sci).fontAttr.verticalAlign){case jc.VERTICAL_ALIGN.top:r=new it("align-top");break;case jc.VERTICAL_ALIGN.center:r=new it("align-middle");break;case jc.VERTICAL_ALIGN.bottom:r=new it("align-bottom")}this.verticalAlign.setIcon(r)}},{key:"setTextWrappingStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(ff).selectRange,r=new it("text-wrap");if(o)switch(n.getCellOrNew(o.sri,o.sci).fontAttr.textWrap){case jc.TEXT_WRAP.TRUNCATE:r=new it("truncate");break;case jc.TEXT_WRAP.WORD_WRAP:r=new it("text-wrap");break;case jc.TEXT_WRAP.OVER_FLOW:r=new it("overflow")}this.textWrapping.setIcon(r)}},{key:"setUndoStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table.tableDataSnapshot;this.undo.active(t.canBack())}},{key:"setRedoStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table.tableDataSnapshot;this.redo.active(t.canGo())}},{key:"setScaleStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table.scale.goto(100);this.scale.setTitle("".concat(t,"%"))}},{key:"setPaintFormatStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet();this.paintFormat.active(this.paintFormat.includeSheet(t))}},{key:"setFormatStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(ff).selectRange,r="常规",i="default";if(o)switch(i=n.getCellOrNew(o.sri,o.sci).format){case"default":r="常规";break;case"text":r="文本";break;case"number":r="数字";break;case"percentage":r="百分比";break;case"fraction":r="分数";break;case"ENotation":r="科学计数";break;case"rmb":r="人民币";break;case"hk":r="港币";break;case"dollar":r="美元";break;case"date1":case"date2":case"date3":case"date4":case"date5":r="日期";break;case"time":r="时间"}this.format.setTitle(r),this.format.formatContextMenu.setActiveByType(i)}},{key:"setFontStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(ff).selectRange,r="Arial";o&&(r=n.getCellOrNew(o.sri,o.sci).fontAttr.name),this.font.setTitle(r),this.font.fontContextMenu.setActiveByType(r)}},{key:"setStatus",value:function(){this.setUndoStatus(),this.setRedoStatus(),this.setScaleStatus(),this.setPaintFormatStatus(),this.setFormatStatus(),this.setFontStatus(),this.setFontSizeStatus(),this.setFontBoldStatus(),this.setFontItalicStatus(),this.setUnderLineStatus(),this.setFontStrikeStatus(),this.setFontColorStatus(),this.setFillColorStatus(),this.setHorizontalAlignStatus(),this.setVerticalAlignStatus(),this.setTextWrappingStatus(),this.setFixedStatus(),this.setFilterStatus()}},{key:"setFixedStatus",value:function(){var t=this.workTop.work.body,e=this.fixed,n=t.sheetView.getActiveSheet().table;e.setFixedRowStatus(n.xFixedView.hasFixedTop()),e.setFixedColStatus(n.xFixedView.hasFixedLeft())}},{key:"setFilterStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table.xScreen.findType(Bh);this.filter.active(t.display)}},{key:"setUnderLineStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(ff).selectRange,r=!1;o&&(r=n.getCellOrNew(o.sri,o.sci).fontAttr.underline),this.underLine.active(r)}},{key:"setFontSizeStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(ff).selectRange,r="12";o&&(r=n.getCellOrNew(o.sri,o.sci).fontAttr.size),this.dprFontSize.setTitle(r)}},{key:"setFontBoldStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(ff).selectRange,r=!1;o&&(r=n.getCellOrNew(o.sri,o.sci).fontAttr.bold),this.fontBold.active(r)}},{key:"setFontStrikeStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(ff).selectRange,r=!1;o&&(r=n.getCellOrNew(o.sri,o.sci).fontAttr.strikethrough),this.fontStrike.active(r)}},{key:"setFontColorStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(ff).selectRange,r="rgb(0, 0, 0)";o&&(r=n.getCellOrNew(o.sri,o.sci).fontAttr.color),this.fontColor.setColor(r),this.fontColor.fontColorContextMenu.setActiveByColor(r)}},{key:"setFillColorStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(ff).selectRange,r="rgb(255, 255, 255)";if(o){var i=n.getCellOrNew(o.sri,o.sci);i.background&&(r=i.background)}this.fillColor.setColor(r),this.fillColor.fillColorContextMenu.setActiveByColor(r)}},{key:"setFontItalicStatus",value:function(){var t=this.workTop.work.body.sheetView.getActiveSheet().table,e=t.xScreen,n=t.getTableCells(),o=e.findType(ff).selectRange,r=!1;o&&(r=n.getCellOrNew(o.sri,o.sci).fontAttr.italic),this.fontItalic.active(r)}}])&&ip(n.prototype,r),c&&ip(n,c),e}(D);function yp(t){return(yp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bp(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function dp(t,e){return!e||"object"!==yp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vp(t){return(vp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gp(t,e){return(gp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wp=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=dp(this,vp(e).call(this,"".concat(i,"-option-item ").concat(t)))).title="",n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gp(t,e)}(e,t),n=e,(o=[{key:"setTitle",value:function(t){this.title=t,this.text(this.title)}}])&&bp(n.prototype,o),r&&bp(n,r),e}(D);function mp(t){return(mp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ep(t,e){return!e||"object"!==mp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Op(t){return(Op=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sp(t,e){return(Sp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xp=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ep(this,Op(e).call(this,"".concat(i,"-tools-file")))).setTitle("文件"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sp(t,e)}(e,t),e}(wp);function Tp(t){return(Tp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _p(t,e){return!e||"object"!==Tp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kp(t){return(kp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pp(t,e){return(Pp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Cp=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=_p(this,kp(e).call(this,"".concat(i,"-tools-format")))).setTitle("格式"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pp(t,e)}(e,t),e}(wp);function jp(t){return(jp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lp(t,e){return!e||"object"!==jp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ap(t){return(Ap=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rp(t,e){return(Rp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Np=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Lp(this,Ap(e).call(this,"".concat(i,"-tools-insert")))).setTitle("插入"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rp(t,e)}(e,t),e}(wp);function Vp(t){return(Vp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ip(t,e){return!e||"object"!==Vp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mp(t){return(Mp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dp(t,e){return(Dp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bp=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ip(this,Mp(e).call(this,"".concat(i,"-tools-look")))).setTitle("查看"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dp(t,e)}(e,t),e}(wp);function Hp(t){return(Hp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wp(t,e){return!e||"object"!==Hp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fp(t){return(Fp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yp(t,e){return(Yp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gp=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Wp(this,Fp(e).call(this,"".concat(i,"-tools-update")))).setTitle("修改"),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yp(t,e)}(e,t),e}(wp);function zp(t){return(zp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Up(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Xp(t,e){return!e||"object"!==zp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Kp(t){return(Kp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zp(t,e){return(Zp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $p=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Xp(this,Kp(e).call(this,"".concat(i,"-option")))).workTop=t,n.title=" X-Sheet 工作簿",n.logoEle=k("div","".concat(i,"-option-logo")),n.titleEle=k("div","".concat(i,"-option-title")),n.optionsEle=k("div","".concat(i,"-option-box")),n.leftEle=k("div","".concat(i,"-option-left")),n.rightEle=k("div","".concat(i,"-option-right")),n.leftEle.children(n.logoEle),n.rightEle.children(n.titleEle,n.optionsEle),n.children(n.leftEle),n.children(n.rightEle),n.setTitle(n.title),n.file=new xp,n.format=new Cp,n.insert=new Np,n.look=new Bp,n.update=new Gp,n.optionsEle.children(n.file),n.optionsEle.children(n.format),n.optionsEle.children(n.insert),n.optionsEle.children(n.look),n.optionsEle.children(n.update),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zp(t,e)}(e,t),n=e,(o=[{key:"setTitle",value:function(t){this.title=t,this.titleEle.text(t)}}])&&Up(n.prototype,o),r&&Up(n,r),e}(D);function qp(t){return(qp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jp(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Qp(t,e){return!e||"object"!==qp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ty(t){return(ty=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ey(t,e){return(ey=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ny=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Qp(this,ty(e).call(this,"".concat(i,"-work-top")))).work=t,n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ey(t,e)}(e,t),n=e,(o=[{key:"onAttach",value:function(){this.toolsMenu=new pp(this),this.option=new $p(this),this.attach(this.option),this.attach(this.toolsMenu)}}])&&Jp(n.prototype,o),r&&Jp(n,r),e}(D);function oy(t){return(oy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ry(t,e){return!e||"object"!==oy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function iy(t){return(iy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cy(t,e){return(cy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ly=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ry(this,iy(e).call(this,"".concat(i,"-horizontal-layer")))).options=S.mergeDeep({style:{}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cy(t,e)}(e,t),e}(Y);function ay(t){return(ay="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sy(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function uy(t,e){return!e||"object"!==ay(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fy(t){return(fy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hy(t,e){return(hy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var py=function(t){function e(t){var n,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=uy(this,fy(e).call(this,"".concat(i,"-scroll-bar-x")))).option=S.mergeDeep({style:{},scroll:function(t){return t}},t),o.lastBut=k("div","".concat(i,"-scroll-bar-x-last-but")),o.nextBut=k("div","".concat(i,"-scroll-bar-x-next-but")),o.content=k("div","".concat(i,"-scroll-bar-x-content")),o.block=k("div","".concat(i,"-scroll-bar-x-block")),o.content.children(o.block),(n=o).children.apply(n,[o.lastBut,o.nextBut,o.content]),o.blockLeft=0,o.maxBlockLeft=0,o.blockWidth=0,o.minBlockWidth=20,o.scrollTo=0,o.contentWidth=0,o.viewPortWidth=0,o.isHide=!0,o.css(o.option.style),o}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hy(t,e)}(e,t),n=e,(r=[{key:"onAttach",value:function(){this.bind()}},{key:"bind",value:function(){var t=this;this.block.on(o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(0===e.button){var n=t.computeEventXy(e,t.block);A.mouseMoveUp(k(document),(function(e){var o=t.computeEventXy(e,t.content).x-n.x;o<0&&(o=0),o>t.maxBlockLeft&&(o=t.maxBlockLeft),t.blockLeft=o,t.scrollTo=t.computeScrollTo(t.blockLeft),t.block.css("left","".concat(o,"px")),t.option.scroll(t.scrollTo),e.stopPropagation(),e.preventDefault()})),e.stopPropagation(),e.preventDefault()}}))}},{key:"setSize",value:function(t,e){if(t<e){this.isHide=!1,this.show();var n=this.content.box(),o=t/e*n.width;this.blockWidth=o<this.minBlockWidth?this.minBlockWidth:o,this.viewPortWidth=t,this.contentWidth=e,this.maxBlockLeft=n.width-this.blockWidth,this.block.css("width","".concat(this.blockWidth,"px"));var r=this.scrollTo/(e-t)*this.maxBlockLeft;this.blockLeft=r>this.maxBlockLeft?this.maxBlockLeft:r,this.scrollTo=this.computeScrollTo(this.blockLeft),this.block.css("left","".concat(this.blockLeft,"px"))}else this.isHide=!0,this.hide(),this.option.scroll(0)}},{key:"setLocal",value:function(t){var e=t,n=this.contentWidth-this.viewPortWidth;e>n?e=n:e<0&&(e=0);var o=e/(this.contentWidth-this.viewPortWidth)*this.maxBlockLeft;this.blockLeft=o>this.maxBlockLeft?this.maxBlockLeft:o,!1===this.isHide&&(this.scrollTo=e,this.block.css("left","".concat(this.blockLeft,"px")))}},{key:"scrollMove",value:function(t){this.setLocal(t),this.option.scroll(this.scrollTo)}},{key:"computeScrollTo",value:function(t){return t/this.maxBlockLeft*(this.contentWidth-this.viewPortWidth)}}])&&sy(n.prototype,r),c&&sy(n,c),e}(D);function yy(t){return(yy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function by(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function dy(t,e){return!e||"object"!==yy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vy(t){return(vy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gy(t,e){return(gy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wy=function(t){function e(t){var n,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=dy(this,vy(e).call(this,"".concat(i,"-scroll-bar-y")))).option=S.mergeDeep({style:{},scroll:function(t){return t}},t),o.lastBut=k("div","".concat(i,"-scroll-bar-y-last-but")),o.nextBut=k("div","".concat(i,"-scroll-bar-y-next-but")),o.content=k("div","".concat(i,"-scroll-bar-y-content")),o.block=k("div","".concat(i,"-scroll-bar-y-block")),o.content.children(o.block),(n=o).children.apply(n,[o.lastBut,o.nextBut,o.content]),o.blockTop=0,o.maxBlockTop=0,o.blockHeight=0,o.minBlockHeight=20,o.scrollTo=0,o.contentHeight=0,o.viewPortHeight=0,o.isHide=!0,o.css(o.option.style),o}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gy(t,e)}(e,t),n=e,(r=[{key:"onAttach",value:function(){this.bind()}},{key:"bind",value:function(){var t=this;A.bind(this.block,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){if(0===e.button){var n=t.computeEventXy(e,t.block);A.mouseMoveUp(k(document),(function(e){var o=t.computeEventXy(e,t.content).y-n.y;o<0&&(o=0),o>t.maxBlockTop&&(o=t.maxBlockTop),t.blockTop=o,t.scrollTo=t.computeScrollTo(t.blockTop),t.block.css("top","".concat(o,"px")),t.option.scroll(t.scrollTo),e.stopPropagation(),e.preventDefault()}))}}))}},{key:"setSize",value:function(t,e){if(t<e){this.isHide=!1,this.show();var n=this.content.box(),o=t/e*n.height;this.blockHeight=o<this.minBlockHeight?this.minBlockHeight:o,this.viewPortHeight=t,this.contentHeight=e,this.maxBlockTop=n.height-this.blockHeight,this.block.css("height","".concat(this.blockHeight,"px"));var r=this.scrollTo/(e-t)*this.maxBlockTop;this.blockTop=r>this.maxBlockTop?this.maxBlockTop:r,this.scrollTo=this.computeScrollTo(this.blockTop),this.block.css("top","".concat(this.blockTop,"px"))}else this.isHide=!0,this.hide(),this.option.scroll(0)}},{key:"setLocal",value:function(t){var e=t,n=this.contentHeight-this.viewPortHeight;e>n?e=n:e<0&&(e=0);var o=e/(this.contentHeight-this.viewPortHeight)*this.maxBlockTop;this.blockTop=o>this.maxBlockTop?this.maxBlockTop:o,!1===this.isHide&&(this.scrollTo=e,this.block.css("top","".concat(this.blockTop,"px")))}},{key:"scrollMove",value:function(t){this.setLocal(t),this.option.scroll(this.scrollTo)}},{key:"computeScrollTo",value:function(t){return t/this.maxBlockTop*(this.contentHeight-this.viewPortHeight)}}])&&by(n.prototype,r),c&&by(n,c),e}(D);function my(t){return(my="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ey(t,e){return!e||"object"!==my(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Oy(t){return(Oy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sy(t,e){return(Sy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xy=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ey(this,Oy(e).call(this,"".concat(i,"-horizontal-layer-element")))).options=S.mergeDeep({style:{flexGrow:"0"}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sy(t,e)}(e,t),e}(Y);function Ty(t){return(Ty="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _y(t,e){return!e||"object"!==Ty(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ky(t){return(ky=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Py(t,e){return(Py=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Cy=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=_y(this,ky(e).call(this,"".concat(i,"-vertical-center-element")))).options=S.mergeDeep({style:{}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Py(t,e)}(e,t),e}(Y);function jy(t){return(jy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ly(t,e){return!e||"object"!==jy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ay(t){return(Ay=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ry(t,e){return(Ry=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ny=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ly(this,Ay(e).call(this,"".concat(i,"-vertical-center")))).options=S.mergeDeep({style:{}},t),n.css(n.options.style),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ry(t,e)}(e,t),e}(Y);function Vy(t){return(Vy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Iy(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function My(t,e){return!e||"object"!==Vy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dy(t,e,n){return(Dy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=By(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function By(t){return(By=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hy(t,e){return(Hy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wy=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=My(this,By(e).call(this,"".concat(i,"-sheet-view")))).sheetList=[],t.activeIndex=-1,t}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hy(t,e)}(e,t),n=e,(o=[{key:"setActiveSheet",value:function(t){var e=this.sheetList;return e[t]?(this.activeIndex=t,this.setActive(e[t])):null}},{key:"attach",value:function(t){this.sheetList.push(t),Dy(By(e.prototype),"attach",this).call(this,t),t.hide()}},{key:"getActiveSheet",value:function(){return this.sheetList[this.activeIndex]}},{key:"setActive",value:function(t){return t.show(),t.sibling().forEach((function(t){t.hide()})),t}},{key:"getLastIndex",value:function(){return this.sheetList.length-1}}])&&Iy(n.prototype,o),r&&Iy(n,r),e}(D);function Fy(t){return(Fy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yy(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Gy(t,e){return!e||"object"!==Fy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zy(t){return(zy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Uy(t,e){return(Uy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xy=function(t){function e(t){var n,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Gy(this,zy(e).call(this,"".concat(i,"-sheet-switch-tab")))).last=k("div","".concat(i,"-switch-tab-last-btn")),o.next=k("div","".concat(i,"-switch-tab-next-btn")),o.content=k("div","".concat(i,"-sheet-tab-content")),o.tabs=k("div","".concat(i,"-sheet-tab-tabs")),o.plus=k("div","".concat(i,"-sheet-tab-plus")),o.content.children(o.tabs),(n=o).children.apply(n,[o.last,o.next,o.content,o.plus]),o.optiions=S.mergeDeep({onAdd:function(t){return t},onSwitch:function(t){return t}},t),o.left=null,o.tabList=[],o}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Uy(t,e)}(e,t),n=e,(r=[{key:"onAttach",value:function(){this.bind()}},{key:"offsetSizeLeft",value:function(){var t=this.content.offset().width,e=this.tabs.offset().width;e>t&&(this.left=-(e-t),this.tabs.css("marginLeft","".concat(this.left,"px")))}},{key:"bind",value:function(){var t=this,e=this.next,n=this.last,r=this.plus;A.bind(e,o.SYSTEM_EVENT_TYPE.CLICK,(function(){var e=t.content.offset().width,n=-(t.tabs.offset().width-e),o=t.left||0;(o-=30)<n&&(o=n),t.left=o,t.tabs.css("marginLeft","".concat(t.left,"px"))})),A.bind(n,o.SYSTEM_EVENT_TYPE.CLICK,(function(){var e=t.left||0;(e+=30)>0&&(e=0),t.left=e,t.tabs.css("marginLeft","".concat(t.left,"px"))})),A.bind(r,o.SYSTEM_EVENT_TYPE.CLICK,(function(){t.optiions.onAdd(),t.offsetSizeLeft()}))}},{key:"attach",value:function(t){var e=this;this.tabList.push(t),this.tabs.children(t),t.onAttach(),A.bind(t,o.SYSTEM_EVENT_TYPE.CLICK,(function(){e.setActive(t),e.optiions.onSwitch(t)}))}},{key:"setActiveTab",value:function(t){var e=this.tabList;return e[t]?(this.setActive(e[t]),e[t]):null}},{key:"setActive",value:function(t){t.addClass("active"),t.sibling().forEach((function(t){t.removeClass("active")}))}},{key:"getLastIndex",value:function(){return this.tabList.length-1}}])&&Yy(n.prototype,r),c&&Yy(n,c),e}(D);function Ky(t){return(Ky="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zy(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function $y(t,e){return!e||"object"!==Ky(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qy(t){return(qy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jy(t,e){return(Jy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qy=1,tb=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Sheet".concat(Qy);return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=$y(this,qy(e).call(this,"".concat(i,"-sheet-tab"))),Qy+=1,t.setName(n),t}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jy(t,e)}(e,t),n=e,(o=[{key:"setName",value:function(t){this.name=t,this.text(this.name)}}])&&Zy(n.prototype,o),r&&Zy(n,r),e}(D);function eb(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nb(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var ob=function(){function t(){eb(this,t),this.value=1}var e,n,o;return e=t,(n=[{key:"back",value:function(t){return t/this.value}},{key:"goto",value:function(t){return this.value*t}},{key:"setValue",value:function(t){this.value=t}}])&&nb(e.prototype,n),o&&nb(e,o),t}(),rb=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.goto,o=void 0===n?function(t){return t}:n,r=e.back,i=void 0===r?function(t){return t}:r;eb(this,t),this.goto=o,this.back=i};function ib(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var cb=function(){function t(e){var n=e.scaleAdapter,o=void 0===n?new rb:n,r=e.height,i=void 0===r?33:r,c=e.width,l=void 0===c?50:c,a=e.background,s=void 0===a?"#f6f7fa":a,u=e.color,f=void 0===u?"#585757":u,h=e.size,p=void 0===h?11:h,y=e.gridColor,b=void 0===y?"#e8e8e8":y;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scaleAdapter=o,this.height=i,this.width=l,this.background=s,this.color=f,this.size=p,this.gridColor=b}var e,n,o;return e=t,(n=[{key:"getGridColor",value:function(){return this.gridColor}},{key:"getColor",value:function(){return this.color}},{key:"getSize",value:function(){var t=this.scaleAdapter,e=this.size;return t.goto(e)}},{key:"getBackground",value:function(){return this.background}},{key:"getHeight",value:function(){var t=this.scaleAdapter,e=this.height;return t.goto(e)}},{key:"getWidth",value:function(){var t=this.scaleAdapter,e=this.width;return t.goto(e)}}])&&ib(e.prototype,n),o&&ib(e,o),t}();function lb(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var ab=function(){function t(e){var n=e.scaleAdapter,o=void 0===n?new rb:n,r=e.len,i=void 0===r?10:r,c=e.data,l=void 0===c?[]:c,a=e.height,s=void 0===a?30:a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scaleAdapter=o,this.len=i,this.data=l,this.min=5,this.height=S.minIf(s,this.min)}var e,n,o;return e=t,(n=[{key:"rectRangeSumHeight",value:function(t){return t.equals(fs.EMPTY)?0:this.sectionSumHeight(t.sri,t.eri)}},{key:"sectionSumHeight",value:function(t,e){var n=this,o=0;return t>e?o:(ns.getInstance().setBegin(t).setEnd(e).setLoop((function(t){o+=n.getHeight(t)})).execute(),o)}},{key:"getOrNew",value:function(t){return this.data[t]=this.data[t]||{},this.data[t]}},{key:"getHeight",value:function(t){var e=this.scaleAdapter,n=this.get(t);return n&&n.height?e.goto(n.height):e.goto(this.height)}},{key:"get",value:function(t){return this.data[t]}},{key:"eachHeight",value:function(t,e,n){var o=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=r;ns.getInstance().setBegin(t).setEnd(e).setLoop((function(t){var e=o.getHeight(t);n(t,e,i),i+=e})).execute()}},{key:"setHeight",value:function(t,e){var n=this.getOrNew(t),o=this.scaleAdapter;n.height=o.back(S.minIf(e,this.min))}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(t){this.data=t}}])&&lb(e.prototype,n),o&&lb(e,o),t}();function sb(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var ub=function(){function t(e){var n=e.scaleAdapter,o=void 0===n?new rb:n,r=e.len,i=void 0===r?10:r,c=e.data,l=void 0===c?[]:c,a=e.width,s=void 0===a?110:a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scaleAdapter=o,this.len=i,this.data=l,this.min=5,this.width=S.minIf(s,this.min)}var e,n,o;return e=t,(n=[{key:"rectRangeSumWidth",value:function(t){return t.equals(fs.EMPTY)?0:this.sectionSumWidth(t.sci,t.eci)}},{key:"sectionSumWidth",value:function(t,e){var n=this,o=0;return t>e?o:(as.getInstance().setBegin(t).setEnd(e).setLoop((function(t){o+=n.getWidth(t)})).execute(),o)}},{key:"getOrNew",value:function(t){return this.data[t]=this.data[t]||{},this.data[t]}},{key:"getWidth",value:function(t){var e=this.scaleAdapter,n=this.data[t];return n&&n.width?e.goto(n.width):e.goto(this.width)}},{key:"get",value:function(t){return this.data[t]}},{key:"eachWidth",value:function(t,e,n){var o=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=r;as.getInstance().setBegin(t).setEnd(e).setLoop((function(t){var e=o.getWidth(t);n(t,e,i),i+=e})).execute()}},{key:"setWidth",value:function(t,e){var n=this.getOrNew(t),o=this.scaleAdapter;n.width=o.back(S.minIf(e,this.min))}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(t){this.data=t}}])&&sb(e.prototype,n),o&&sb(e,o),t}();var fb={H_LEFT:Symbol("水平方向左边滚动条"),H_RIGHT:Symbol("水平方向向右边滚动"),V_TOP:Symbol("垂直方向向上滚动"),V_BOTTOM:Symbol("垂直方向下滚动"),UN:Symbol("未知")},hb=function t(e){var n=e.xFixedView;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var o=n.getFixedView();this.ri=o.eri+1,this.ci=o.eci+1,this.x=0,this.y=0,this.type=fb.UN};function pb(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var yb=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.pool=[],this.bind()}var e,n,r;return e=t,(n=[{key:"bind",value:function(){var t=this,e=this.table.focus;A.bind(document,o.SYSTEM_EVENT_TYPE.KEY_DOWN,(function(n){var o=e.activate,r=n.keyCode;if(o){var i=o.target,c=t.find(i);c&&c.keyCode===r&&c.callback()}9===r&&n.preventDefault()}))}},{key:"find",value:function(t){for(var e=this.pool,n=0;n<e.length;n+=1){var o=e[n];if(o.target===t)return o}return null}},{key:"register",value:function(t){var e=t.target,n=t.keyCode,o=t.callback;this.pool.push({target:e,keyCode:n,callback:o})}}])&&pb(e.prototype,n),r&&pb(e,r),t}();function bb(t){return(bb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function db(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function vb(t,e){return!e||"object"!==bb(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gb(t){return(gb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wb(t,e){return(wb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mb=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=vb(this,gb(e).call(this,"".concat(i,"-table-col-fixed-bar")));var o=t.xFixedView.getFixedView(),r=k("div","".concat(i,"-table-col-fixed-block"));return n.table=t,n.fxSci=o.sci,n.fxEci=o.eci,n.block=r,n.children(r),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wb(t,e)}(e,t),n=e,(r=[{key:"bind",value:function(){var t=this,n=this.table,r=n.mousePointer,i=n.dropColFixed,c=n.xFixedView,l=!0;A.bind(n,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.setSize()})),A.bind(n,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.setSize()})),A.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){t.setActive(!0),r.lock(e),r.set(of.KEYS.grab,e)})),A.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){l&&(t.setActive(!1),r.free(e))})),A.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(o){i.show(),t.setActive(!0);var a=n.getScrollView(),s=c.getFixedView();t.fxSci=s.sci,t.fxEci=s.eci,r.lock(e),r.set(of.KEYS.grab,e);var u=n.computeEventXy(o,n).x;i.offset({left:u}),l=!1,c.hasFixedLeft()&&(n.scroll.x=0,n.scroll.ci=t.fxEci+1,n.resize()),A.mouseMoveUp(document,(function(e){var o=n.computeEventXy(e,n),r=o.x,c=o.y;i.offset({left:r});var l=n.getRiCiByXy(r,c).ci;l<a.eci-2&&(t.fxEci=l,t.setSize())}),(function(){t.setActive(!1),r.free(e),i.hide(),n.setFixedCol(t.fxEci),l=!0}))}))}},{key:"setActive",value:function(t){t?(this.block.addClass("active"),this.addClass("active")):(this.block.removeClass("active"),this.removeClass("active"))}},{key:"onAttach",value:function(){var t=this.table;this.setSize(),this.bind(),t.focus.register({target:this,stop:!1})}},{key:"setSize",value:function(){var t=this.table,n=this.block,o=this.fxSci,r=this.fxEci,i=t.cols,c=e.WIDTH,l=r>-1?t.visualHeight():t.getIndexHeight(),a=r>-1?c/2:c,s=i.sectionSumWidth(o,r)+t.getIndexWidth()-a;n.offset({height:t.getIndexHeight(),width:c}),this.offset({width:c,height:l,left:s,top:0})}}])&&db(n.prototype,r),c&&db(n,c),e}(D);function Eb(t){return(Eb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ob(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Sb(t,e){return!e||"object"!==Eb(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xb(t){return(xb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tb(t,e){return(Tb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}mb.WIDTH=6;var _b=function(t){function e(t){var n,o,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:5};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Sb(this,xb(e).call(this,"".concat(i,"-re-sizer-horizontal")))).table=t,o.options=r,o.width=r.width,o.hoverEl=k("div","".concat(i,"-re-sizer-hover")),o.lineEl=k("div","".concat(i,"-re-sizer-line")),(n=o).children.apply(n,[o.hoverEl,o.lineEl]),o}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tb(t,e)}(e,t),n=e,(r=[{key:"onAttach",value:function(){this.bind(),this.table.focus.register({target:this})}},{key:"bind",value:function(){var t=this,n=this.table,r=n.cols,i=n.mousePointer,c=n.focus,l=n.xFixedView,a=n.tableDataSnapshot,s=a.colsDataProxy,u=n.index;A.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(o){i.lock(e),i.set(of.KEYS.colResize,e);var c=t.getEventLeft(o),l=c.left,u=c.ci,f=l-r.getWidth(u)+r.min,h=n.computeEventXy(o).x;A.mouseMoveUp(document,(function(e){var o=n.computeEventXy(e);h=o.x,h-=t.width/2,h=Math.ceil(S.minIf(h,f)),t.css("left","".concat(h,"px")),t.lineEl.css("height","".concat(n.visualHeight(),"px")),t.lineEl.show()}),(function(o){i.free(e),t.lineEl.hide(),t.css("left","".concat(h,"px")),n.computeEventXy(o).y<=0&&t.hide();var c=h-(l-r.getWidth(u))+t.width;a.begin(),s.setWidth(u,c),a.end(),n.resize()}))})),A.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){i.free(e)})),A.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){i.lock(e),i.set(of.KEYS.colResize,e)})),A.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(e){var o=t.getEventLeft(e),i=o.left,c=o.ci,a=i-r.getWidth(c)+r.min,s=n.visualWidth(),f=l.getFixedView();i>s&&(i=s),-1===i||a>s||-1===c?t.hide():(t.show(),c===f.eci?t.css("left","".concat(i-t.width-mb.WIDTH/2,"px")):t.css("left","".concat(i-t.width,"px")),t.hoverEl.css("width","".concat(t.width,"px")),t.hoverEl.css("height","".concat(u.getHeight(),"px")))})),A.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){t.hide()})),A.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var e=c.activate.target;e!==n&&e!==t&&t.hide()}))}},{key:"getEventLeft",value:function(t){var e=this.table,n=e.cols,o=e.xFixedView,r=e.xFixedMeasure,i=e.index,c=e.computeEventXy(t),l=c.x,a=c.y,s=e.getRiCiByXy(l,a),u=s.ri,f=s.ci,h={ci:f,left:-1};if(-1!==u)return h;var p=r.getWidth(),y=i.getWidth(),b=o.getFixedView(),d=e.getScrollView();return o.hasFixedLeft()?f>b.eci?h.left=y+p+n.sectionSumWidth(d.sci,f):h.left=y+n.sectionSumWidth(b.sci,f):h.left=y+n.sectionSumWidth(d.sci,f),h}}])&&Ob(n.prototype,r),c&&Ob(n,c),e}(D);function kb(t){return(kb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pb(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Cb(t,e){return!e||"object"!==kb(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jb(t){return(jb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Lb(t,e){return(Lb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ab=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=Cb(this,jb(e).call(this,"".concat(i,"-table-row-fixed-bar")));var o=t.xFixedView.getFixedView(),r=k("div","".concat(i,"-table-row-fixed-block"));return n.table=t,n.fxSri=o.sri,n.fxEri=o.eri,n.block=r,n.children(n.block),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lb(t,e)}(e,t),n=e,(r=[{key:"bind",value:function(){var t=this,n=this.table,r=n.mousePointer,i=n.dropRowFixed,c=n.xFixedView,l=!0;A.bind(n,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.setSize()})),A.bind(n,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.setSize()})),A.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){t.setActive(!0),r.lock(e),r.set(of.KEYS.grab,e)})),A.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){l&&(t.setActive(!1),r.free(e))})),A.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(o){i.show(),t.setActive(!0);var a=n.getScrollView(),s=c.getFixedView();t.fxSri=s.sri,t.fxEri=s.eri,r.lock(e),r.set(of.KEYS.grab,e);var u=n.computeEventXy(o,n).y;i.offset({top:u}),l=!1,c.hasFixedTop()&&(n.scroll.y=0,n.scroll.ri=t.fxEri+1,n.resize()),A.mouseMoveUp(document,(function(e){var o=n.computeEventXy(e,n),r=o.x,c=o.y;i.offset({top:c});var l=n.getRiCiByXy(r,c).ri;l<a.eri-2&&(t.fxEri=l,t.setSize())}),(function(){t.setActive(!1),r.free(e),i.hide(),n.setFixedRow(t.fxEri),l=!0}))}))}},{key:"setActive",value:function(t){t?(this.addClass("active"),this.block.addClass("active")):(this.removeClass("active"),this.block.removeClass("active"))}},{key:"onAttach",value:function(){var t=this.table;this.setSize(),this.bind(),t.focus.register({target:this,stop:!1})}},{key:"setSize",value:function(){var t=this.table,n=this.block,o=this.fxSri,r=this.fxEri,i=t.rows,c=e.HEIGHT,l=r>-1?t.visualWidth():t.getIndexWidth(),a=r>-1?c/2:c,s=i.sectionSumHeight(o,r)+t.getIndexHeight()-a;n.offset({width:t.getIndexWidth(),height:c}),this.offset({height:c,width:l,left:0,top:s})}}])&&Pb(n.prototype,r),c&&Pb(n,c),e}(D);function Rb(t){return(Rb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nb(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Vb(t,e){return!e||"object"!==Rb(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ib(t){return(Ib=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mb(t,e){return(Mb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Ab.HEIGHT=6;var Db=function(t){function e(t){var n,o,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{height:5};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Vb(this,Ib(e).call(this,"".concat(i,"-re-sizer-vertical")))).table=t,o.options=r,o.height=r.height,o.hoverEl=k("div","".concat(i,"-re-sizer-hover")),o.lineEl=k("div","".concat(i,"-re-sizer-line")),(n=o).children.apply(n,[o.hoverEl,o.lineEl]),o}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mb(t,e)}(e,t),n=e,(r=[{key:"onAttach",value:function(){this.bind(),this.table.focus.register({target:this})}},{key:"bind",value:function(){var t=this,n=this.table,r=n.rows,i=n.mousePointer,c=n.focus,l=n.xFixedView,a=n.tableDataSnapshot,s=a.rowsDataProxy,u=n.index;A.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(o){i.lock(e),i.set(of.KEYS.rowResize,e);var c=t.getEventTop(o),l=c.top,u=c.ri,f=l-r.getHeight(u)+r.min,h=n.computeEventXy(o).y;A.mouseMoveUp(document,(function(e){var o=n.computeEventXy(e);h=o.y,h-=t.height/2,h=Math.ceil(S.minIf(h,f)),t.css("top","".concat(h,"px")),t.lineEl.css("width","".concat(n.visualWidth(),"px")),t.lineEl.show()}),(function(o){i.free(e),t.lineEl.hide(),t.css("top","".concat(h,"px")),n.computeEventXy(o).x<=0&&t.hide();var c=h-(l-r.getHeight(u))+t.height;a.begin(),s.setHeight(u,c),a.end(),n.resize()}))})),A.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){i.free(e)})),A.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){i.lock(e),i.set(of.KEYS.rowResize,e)})),A.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(e){var o=t.getEventTop(e),i=o.top,c=o.ri,a=i-r.getHeight(c)+r.min,s=n.visualHeight(),f=l.getFixedView();i>s&&(i=s),-1===i||a>s||-1===c?t.hide():(t.show(),c===f.eri?t.css("top","".concat(i-t.height-Ab.HEIGHT/2,"px")):t.css("top","".concat(i-t.height,"px")),t.hoverEl.css("width","".concat(u.getWidth(),"px")),t.hoverEl.css("height","".concat(t.height,"px")))})),A.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){t.hide()})),A.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){var e=c.activate.target;e!==n&&e!==t&&t.hide()}))}},{key:"getEventTop",value:function(t){var e=this.table,n=e.rows,o=e.xFixedView,r=e.xFixedMeasure,i=e.index,c=e.computeEventXy(t),l=c.x,a=c.y,s=e.getRiCiByXy(l,a),u=s.ri,f={ri:u,top:-1};if(-1!==s.ci)return f;var h=r.getHeight(),p=i.getHeight(),y=o.getFixedView(),b=e.getScrollView();return o.hasFixedTop()?u>y.eri?f.top=p+h+n.sectionSumHeight(b.sri,u):f.top=p+n.sectionSumHeight(y.sri,u):f.top=p+n.sectionSumHeight(b.sri,u),f}}])&&Nb(n.prototype,r),c&&Nb(n,c),e}(D);function Bb(t){return(Bb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hb(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Wb(t,e){return!e||"object"!==Bb(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fb(t){return(Fb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yb(t,e){return(Yb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gb=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Wb(this,Fb(e).call(this,"".concat(i,"-table-x-height-light")))).table=t,n.width=-1,n.left=-1,n.setSize(),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yb(t,e)}(e,t),n=e,(r=[{key:"onAttach",value:function(){this.bind(),this.hide()}},{key:"bind",value:function(){var t=this,e=this.table;A.bind(e,o.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(){t.offsetHandle()})),A.bind(e,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.offsetHandle()})),A.bind(e,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.offsetHandle()})),A.bind(e,o.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.offsetHandle()})),A.bind(e,o.TABLE_EVENT_TYPE.FIXED_CHANGE,(function(){t.offsetHandle()}))}},{key:"offsetHandle",value:function(){var t=this.table;if(t.xScreen.findType(ff).selectRange){var e=this.getLeft()+t.getIndexWidth(),n=this.getWidth();e===this.left&&n===this.width||(this.show(),this.offset({top:0,left:e,width:n,height:t.getIndexHeight()})),this.left=e,this.width=n}}},{key:"setSize",value:function(){var t=this.table;this.css("height","".concat(t.getIndexHeight(),"px"))}},{key:"getLeft",value:function(){var t=this.table,e=t.xScreen,n=t.rows,o=t.xFixedView,r=t.cols,i=e.findType(ff),c=i.selectRange,l=i.getOverGo(c),a=o.getFixedView(),s=t.getScrollView();switch(s.sri=0,s.eri=n.length-1,a.sri=0,a.eri=n.length-1,l){case Fu.BRL:case Fu.LTL:case Fu.ALL:case Fu.LT:case Fu.LTT:case Fu.L:return r.sectionSumWidth(a.sci,c.sci-1);case Fu.BR:case Fu.T:case Fu.BRT:var u=s.coincide(c),f=r.sectionSumWidth(s.sci,u.sci-1);return r.sectionSumWidth(a.sci,a.eci)+f}return 0}},{key:"getWidth",value:function(){var t=this.table,e=t.xScreen,n=t.rows,o=t.xFixedView,r=t.cols,i=e.findType(ff),c=i.selectRange,l=o.getFixedView(),a=t.getScrollView(),s=i.getOverGo(c);switch(a.sri=0,a.eri=n.length-1,l.sri=0,l.eri=n.length-1,s){case Fu.LT:case Fu.L:case Fu.LTL:return r.rectRangeSumWidth(c);case Fu.BR:case Fu.T:case Fu.BRT:return r.rectRangeSumWidth(a.coincide(c));case Fu.BRL:case Fu.LTT:case Fu.ALL:return r.rectRangeSumWidth(a.coincide(c))+r.rectRangeSumWidth(l.coincide(c))}return 0}}])&&Hb(n.prototype,r),c&&Hb(n,c),e}(D);function zb(t){return(zb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ub(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Xb(t,e){return!e||"object"!==zb(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Kb(t){return(Kb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zb(t,e){return(Zb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $b=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Xb(this,Kb(e).call(this,"".concat(i,"-table-y-height-light")))).table=t,n.height=-1,n.top=-1,n.setSize(),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zb(t,e)}(e,t),n=e,(r=[{key:"onAttach",value:function(){this.bind(),this.hide()}},{key:"bind",value:function(){var t=this,e=this.table;A.bind(e,o.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(){t.offsetHandle()})),A.bind(e,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.offsetHandle()})),A.bind(e,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.offsetHandle()})),A.bind(e,o.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.offsetHandle()})),A.bind(e,o.TABLE_EVENT_TYPE.FIXED_CHANGE,(function(){t.offsetHandle()}))}},{key:"offsetHandle",value:function(){var t=this.table;if(t.xScreen.findType(ff).selectRange){var e=this.getTop()+t.getIndexHeight(),n=this.getHeight();e===this.top&&n===this.height||(this.show(),this.offset({left:0,top:e,height:n,width:t.getIndexWidth()})),this.top=e,this.height=n}}},{key:"setSize",value:function(){var t=this.table;this.css("width","".concat(t.getIndexWidth(),"px"))}},{key:"getTop",value:function(){var t=this.table,e=t.xScreen,n=t.rows,o=t.xFixedView,r=t.cols,i=e.findType(ff),c=i.selectRange,l=i.getOverGo(c),a=o.getFixedView(),s=t.getScrollView();switch(s.sci=0,s.eci=r.length-1,a.sci=0,a.eci=r.length-1,l){case Fu.BRT:case Fu.LTL:case Fu.ALL:case Fu.LT:case Fu.LTT:case Fu.T:return n.sectionSumHeight(a.sri,c.sri-1);case Fu.BR:case Fu.L:case Fu.BRL:var u=s.coincide(c),f=n.sectionSumHeight(s.sri,u.sri-1);return n.sectionSumHeight(a.sri,a.eri)+f}return 0}},{key:"getHeight",value:function(){var t=this.table,e=t.xScreen,n=t.rows,o=t.xFixedView,r=t.cols,i=e.findType(ff),c=i.selectRange,l=o.getFixedView(),a=t.getScrollView(),s=i.getOverGo(c);switch(a.sci=0,a.eci=r.length-1,l.sci=0,l.eci=r.length-1,s){case Fu.LT:case Fu.T:case Fu.LTT:return n.rectRangeSumHeight(c);case Fu.BR:case Fu.L:case Fu.BRL:return n.rectRangeSumHeight(a.coincide(c));case Fu.BRT:case Fu.LTL:case Fu.ALL:return n.rectRangeSumHeight(a.coincide(c))+n.rectRangeSumHeight(l.coincide(c))}return 0}}])&&Ub(n.prototype,r),c&&Ub(n,c),e}(D);function qb(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Jb=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.table=e,this.pool=[],this.activate={},this.bind()}var e,n,r;return e=t,(n=[{key:"remove",value:function(t){if(!(t instanceof _))throw new TypeError(" error type not Element ");for(var e=[],n=0;n<this.pool.length;n+=1){var o=this.pool[n];o.target.el!==t.el&&e.push(o)}this.pool=e}},{key:"bind",value:function(){var t=this;A.bind(document,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.activate={}}),!0)}},{key:"add",value:function(t){return t.target instanceof _&&!this.findByNode(t.target)&&(this.pool.push(t),t.focus&&(this.activate=this.pool[this.pool.length-1]),!0)}},{key:"register",value:function(t){var e=this,n=t.attr,r=void 0===n?{}:n,i=t.target,c=t.stop,l=void 0!==c&&c,a=t.focus,s=void 0!==a&&a;this.add({attr:r,target:i,focus:s,stop:l})&&A.bind(i,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){var n=e.findByChild(t.target);n?(e.activate=n,l&&t.stopPropagation()):e.activate=null}))}},{key:"findByNode",value:function(t){for(var e=0;e<this.pool.length;e+=1){var n=this.pool[e];if(n.target.el===t)return n}return null}},{key:"findByChild",value:function(t){for(var e=this.table.el.parentNode;t!==e;){var n=this.findByNode(t);if(n)return n;t=t.parentNode}return null}}])&&qb(e.prototype,n),r&&qb(e,r),t}();function Qb(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function td(t,e,n){return e&&Qb(t.prototype,e),n&&Qb(t,n),t}var ed={CHANGE_ADD:Symbol("change_add"),CHANGE_NOT:Symbol("change_not"),STATIC:Symbol("static"),BOUND_OUT:Symbol("bound_out")},nd=function(){function t(e){var n=e.scroll,o=e.rows,r=e.cols,i=e.getHeight,c=void 0===i?function(){return 0}:i,l=e.getWidth,a=void 0===l?function(){return 0}:l;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scroll=n,this.rows=o,this.cols=r,this.getHeight=c,this.getWidth=a}return td(t,null,[{key:"viewMode",value:function(t,e){return S.isUnDef(t)?ed.CHANGE_NOT:e.equals(t)?ed.STATIC:e.coincide(t).equals(fs.EMPTY)?ed.BOUND_OUT:e.within(t)?ed.CHANGE_NOT:ed.CHANGE_ADD}}]),td(t,[{key:"getScrollView",value:function(){var t=this.rows,e=this.cols,n=this.scroll,o=this.getHeight,r=this.getWidth,i=n.ri,c=n.ci,l=0,a=0,s=[t.len,e.len],u=s[0],f=s[1];return ns.getInstance().setBegin(i).setEnd(t.len-1).setLoop((function(e){return a+=t.getHeight(e),u=e,a<o()})).execute(),as.getInstance().setBegin(c).setEnd(e.len-1).setLoop((function(t){return l+=e.getWidth(t),f=t,l<r()})).execute(),new fs(i,c,u,f)}}]),t}();function od(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var rd=function(){function t(e){var n=e.xTableScrollView,o=e.rows,r=e.cols,i=e.scroll;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.xTableScrollView=n,this.scroll=i,this.rows=o,this.cols=r,this.scrollView=null}var e,n,o;return e=t,(n=[{key:"reset",value:function(){this.scrollView=null}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.xTableScrollView,e=this.cols,n=this.rows,o=t.getScrollView();return o.w=e.rectRangeSumWidth(o),o.h=n.rectRangeSumHeight(o),this.scrollView=o,o.clone()}}])&&od(e.prototype,n),o&&od(e,o),t}();function id(t){return(id="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cd(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ld(t,e){return!e||"object"!==id(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ad(t){return(ad=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sd(t,e){return(sd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ud=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ld(this,ad(e).call(this,"".concat(i,"-table-edit")))).table=t,n.text=S.EMPTY,n.input=k("div","".concat(i,"-table-edit-input")),n.input.attr("contenteditable",!0),n.input.html(e.EMPTY),n.cell=null,n.select=null,n.children(n.input),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sd(t,e)}(e,t),n=e,(r=[{key:"onAttach",value:function(){this.bind(),this.hide()}},{key:"bind",value:function(){var t=this,n=this.table,r=n.xScreen.findType(ff);A.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){t.stopPropagation()})),A.bind(this.input,o.SYSTEM_EVENT_TYPE.INPUT,(function(){var n=t.input;S.isBlank(t.input.text())&&n.html(e.EMPTY),t.text=n.text()})),A.bind(n,o.SYSTEM_EVENT_TYPE.SCROLL,(function(){t.hideEdit()})),A.bind(n,o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.hideEdit()})),A.dbClick([r.lt,r.t,r.l,r.br],(function(){t.showEdit()}))}},{key:"showEdit",value:function(){var t=this.table,n=this.input,o=t.getTableCells(),r=t.xScreen.findType(ff).selectRange;if(this.show(),r){var i=o.getCellOrNew(r.sri,r.sci);this.input.attr("style",i.toCssStyle()),this.cell=i,this.select=r,this.editOffset(),this.text=i.text,S.isBlank(this.text)?n.html(e.EMPTY):n.text(this.text),S.keepLastIndex(this.input.el)}}},{key:"hideEdit",value:function(){var t=this.select,e=this.table,n=e.getTableCells(),o=e.tableDataSnapshot,r=o.cellDataProxy;if(this.hide(),t){var i=n.getCellOrNew(t.sri,t.sci).clone(),c=S.trim(this.text);i.text!==c&&(o.begin(),i.text=c,r.setCell(t.sri,t.sci,i),o.end(),e.render()),this.select=null}}},{key:"editOffset",value:function(){var t=this.table,e=this.cell,n=t.xHeightLight,o=t.yHeightLight,r=e.fontAttr,i=e.contentWidth,c=r.align,l=o.getTop()+t.getIndexHeight()+3,a=n.getLeft()+t.getIndexWidth()+3,s=n.getWidth()-7,u=o.getHeight()-7;this.input.css("float","none"),c===jc.ALIGN.right&&i&&i>s&&this.input.css("float","right"),this.offset({top:l,left:a,height:u,width:s})}}])&&cd(n.prototype,r),c&&cd(n,c),e}(D);function fd(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}ud.EMPTY="<p>&nbsp;</p>";var hd=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.solidLine=new Gi(e,n)}var e,n,o;return e=t,(n=[{key:"horizonLine",value:function(t,e,n,o){this.solidLine.horizonLine(t,e,n,o)}},{key:"verticalLine",value:function(t,e,n,o){this.solidLine.verticalLine(t,e,n,o)}}])&&fd(e.prototype,n),o&&fd(e,o),t}();function pd(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var yd=function(){function t(e){var n=e.rect,o=e.draw,r=e.offset,i=void 0===r?0:r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rect=n,this.draw=o,this.offset=i}var e,n,o;return e=t,(n=[{key:"open",value:function(){var t=this.rect,e=this.draw,n=this.offset,o=t.x,r=t.y,i=t.width,c=t.height;return e.save().rect(o,r,i+n,c+n).clip().beginPath(),this}},{key:"close",value:function(){return this.draw.restore(),this}}])&&pd(e.prototype,n),o&&pd(e,o),t}();function bd(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var dd=function(){function t(e){var n=e.x,o=e.y,r=e.width,i=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=n,this.y=o,this.width=r,this.height=i}var e,n,o;return e=t,(n=[{key:"expandSize",value:function(t){return this.width+=t,this.height+=t,this}},{key:"disjoint",value:function(t){return this.x>t.x+t.width||this.y>this.y+t.height||t.x>this.x+this.width||t.y>this.y+this.height}},{key:"clone",value:function(){return new t({x:this.x,y:this.y,width:this.width,height:this.height})}}])&&bd(e.prototype,n),o&&bd(e,o),t}();function vd(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var gd=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,o=[{key:"parserToDate",value:function(t,e){if(!t)return null;for(var n=new Date("1970/01/01 00:00:00"),o=[{reg:"y+"},{reg:"M+"},{reg:"d+"},{reg:"h+"},{reg:"m+"},{reg:"s+"},{reg:"S"}],r=n.getFullYear(),i=n.getMonth()+1,c=n.getDate(),l=n.getHours(),a=n.getMinutes(),s=n.getSeconds(),u=n.getMilliseconds(),f=1,h=0;h<e.length;h+=1)for(var p=e[h],y=0;y<o.length;y+=1){var b=o[y];if(b.reg[0]===p){b.index||(b.index=f,f+=1);break}}for(var d=0;d<o.length;d+=1){var v=o[d].reg,g=new RegExp("(".concat(v,")")).exec(e);if(g){var w=g[0],m="([0-9]{1,".concat(w.length,"})");e=e.replace(w,m)}}var E={},O=new RegExp(e).exec(t);if(!O)return null;for(var S=1;S<O.length;S+=1)E[S]=O[S];return o[0].index&&(r=E[o[0].index]),o[1].index&&(i=E[o[1].index]),o[2].index&&(c=E[o[2].index]),o[3].index&&(l=E[o[3].index]),o[4].index&&(a=E[o[4].index]),o[5].index&&(s=E[o[5].index]),o[6].index&&(u=E[o[6].index]),new Date(r,i-1,c,l,a,s,u)}},{key:"dateFormat",value:function(t,e){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()},o=/(y+)/.exec(t);if(o){var r=o[0],i=e.getFullYear().toString().substr(4-r.length);t=t.replace(r,i)}for(var c in n){var l=new RegExp("(".concat(c,")")).exec(t);if(l){var a=n[c].toString(),s=l[0],u=1===s.length?a:"00".concat(a).substr(a.length);t=t.replace(s,u)}}return t}}],(n=null)&&vd(e.prototype,n),o&&vd(e,o),t}();function wd(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function md(t){var e=gd.parserToDate(t,"yyyy/MM/dd hh:mm:ss");return e||((e=gd.parserToDate(t,"yyyy/MM/dd"))?e:(e=gd.parserToDate(t,"hh:mm:ss"))?e:(e=gd.parserToDate(t,"MM月dd日"))?e:(e=gd.parserToDate(t,"yyyy年MM月"))?e:(e=gd.parserToDate(t,"yyyy年MM月dd日"))||null)}var Ed=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,(n=[{key:"default",value:function(t){return t}},{key:"text",value:function(t){return t}},{key:"number",value:function(t){if(S.isNumber(t)){if(-1!==t.toString().indexOf(".")){var e=t.toString().lastIndexOf(".")+1;return t.toString().substring(0,e+2)}return"".concat(t,".00")}return t}},{key:"percentage",value:function(t){return S.isNumber(t)?"".concat(t,"%"):t}},{key:"fraction",value:function(t){if(S.isFraction(t)){var e=t.split("/")[0],n=t.split("/")[1];return S.parseInt(e)/S.parseInt(n)}return t}},{key:"ENotation",value:function(t){return S.isNumber(t)?S.parseFloat(t).toExponential(2):t}},{key:"rmb",value:function(t){return S.isNumber(t)?"￥".concat(t):t}},{key:"hk",value:function(t){return S.isNumber(t)?"HK".concat(t):t}},{key:"dollar",value:function(t){return S.isNumber(t)?"$".concat(t):t}},{key:"date1",value:function(t){var e=md(t);return e?gd.dateFormat("yyyy/MM/dd",e):t}},{key:"date2",value:function(t){var e=md(t);return e?gd.dateFormat("MM月dd日",e):t}},{key:"date3",value:function(t){var e=md(t);return e?gd.dateFormat("yyyy年MM月",e):t}},{key:"date4",value:function(t){var e=md(t);return e?gd.dateFormat("yyyy年MM月dd日",e):t}},{key:"date5",value:function(t){var e=md(t);return e?gd.dateFormat("yyyy/MM/dd hh:mm:ss",e):t}},{key:"time",value:function(t){var e=md(t);return e?gd.dateFormat("hh:mm:ss",e):t}}])&&wd(e.prototype,n),o&&wd(e,o),t}()),Od=function(t,e){return Ed[t](e)};function Sd(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var xd=function(){function t(e){var n=e.rect,o=e.draw;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.draw=o,this.rect=n,this.backgroundColor=null}var e,n,o;return e=t,(n=[{key:"drawBackgroundColor",value:function(t){if(t&&(this.backgroundColor=t,t)){var e=this.draw,n=this.rect;e.attr({fillStyle:t}),e.fillRect(n.x,n.y,n.width,n.height)}}}])&&Sd(e.prototype,n),o&&Sd(e,o),t}();function Td(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var _d=function(){function t(e){var n=e.merges,o=e.cols,r=e.rows,i=e.data,c=void 0===i?[]:i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.merges=n,this.cols=o,this.rows=r,this.data=c}var e,n,o;return e=t,(n=[{key:"emptyRectRange",value:function(t){var e=this,n=!0;return t.each((function(t,o){var r=e.getCell(t,o);return!(S.isNotEmptyObject(r)&&!S.isBlank(r.text)&&(n=!1,1))})),n}},{key:"setCellOrNew",value:function(t,e,n){S.isUnDef(this.data[t])&&(this.data[t]=[]),this.data[t][e]=n}},{key:"setCell",value:function(t,e,n){var o=this.data[t];o&&o[e]&&(o[e]=n)}},{key:"getCellOrNew",value:function(t,e){return S.isUnDef(this.data[t])&&(this.data[t]=[]),S.isUnDef(this.data[t][e])&&(this.data[t][e]={text:""}),this.getCell(t,e)}},{key:"getCellOrMergeCell",value:function(t,e){var n=this.merges.getFirstIncludes(t,e);return n?this.getCell(n.sri,n.sci):this.getCell(t,e)}},{key:"getCell",value:function(t,e){var n=this.data[t];if(n&&n[e]){var o=n[e];return o instanceof ja?n[e]:(S.isString(o)&&(o={text:o}),n[e]=new ja(o),n[e])}return null}},{key:"getCellBoundOutSize",value:function(t,e){var n=this.cols,o=this.getCell(t,e);if(o){var r=n.getWidth(e),i=o.contentWidth;switch(o.fontAttr.align){case jc.ALIGN.right:case jc.ALIGN.left:return i;case jc.ALIGN.center:return r+(i-r)/2;default:return 0}}return 0}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.data=t,this}}])&&Td(e.prototype,n),o&&Td(e,o),t}();function kd(t){return(kd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pd(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Cd(t,e){return!e||"object"!==kd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jd(t){return(jd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ld(t,e){return(Ld=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ad=function(t){function e(t){var n,o=t.text,r=t.overflow,i=t.rect,c=t.dw,l=t.attr;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Cd(this,jd(e).call(this,{overflow:r,text:o,rect:i,dw:c,attr:l}))).attr=S.mergeDeep({lineHeight:4,spacing:2},n.attr),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ld(t,e)}(e,t),n=e,(o=[{key:"drawLine",value:function(t,e,n,o,r,i){var c=this.dw,l=this.attr.size,a=[0,0],s=[0,0];if("strike"===t){switch(r){case jc.ALIGN.center:case jc.ALIGN.left:case jc.ALIGN.right:a[0]=e,s[0]=e+o}switch(i){case jc.VERTICAL_ALIGN.center:case jc.VERTICAL_ALIGN.top:case jc.VERTICAL_ALIGN.bottom:a[1]=n+l/2,s[1]=n+l/2}}if("underline"===t){switch(r){case jc.ALIGN.center:case jc.ALIGN.left:case jc.ALIGN.right:a[0]=e,s[0]=e+o}switch(i){case jc.VERTICAL_ALIGN.center:case jc.VERTICAL_ALIGN.top:case jc.VERTICAL_ALIGN.bottom:a[1]=n+l,s[1]=n+l}}c.line(a,s)}},{key:"draw",value:function(){var t=this.text;if(this.isBlank(t))return 0;var e=this.dw,n=this.attr,o=n.textWrap;switch(e.attr({textAlign:jc.ALIGN.left,textBaseline:jc.VERTICAL_ALIGN.top,font:"".concat(n.italic?"italic":""," ").concat(n.bold?"bold":""," ").concat(n.size,"px ").concat(n.name),fillStyle:n.color,strokeStyle:n.color}),o){case jc.TEXT_WRAP.OVER_FLOW:return this.overflowFont();case jc.TEXT_WRAP.TRUNCATE:return this.truncateFont();case jc.TEXT_WRAP.WORD_WRAP:return this.wrapTextFont()}return 0}},{key:"truncateFont",value:function(){for(var t=this.text,e=this.dw,n=this.attr,o=this.rect,r=n.underline,i=n.strikethrough,c=n.align,l=n.verticalAlign,a=n.padding,s=n.size,u=n.lineHeight,f=n.spacing,h=this.textBreak(t),p=[],y=o.width,b=o.height,d=h.length,v=0,g=0,w=0;v<d;){for(var m=h[v],E=m.length,O=0,S=0;S<E;){var x=m.charAt(S),T=this.textWidth(x);p.push({len:T,text:x,tx:g+(s/2-T/2),ty:O}),O+=s+f,S+=1}O>0&&(O-=f),O>w&&(w=O),g+=s+u,v+=1}g>0&&(g-=u);var _=o.x,k=o.y,P=0,C=0;switch(c){case jc.ALIGN.center:_+=y/2-g/2,P=0;break;case jc.ALIGN.right:_+=y-g-a,P=a;break;case jc.ALIGN.left:_+=a,P=a}switch(l){case jc.VERTICAL_ALIGN.center:k+=b/2-w/2,C=0;break;case jc.VERTICAL_ALIGN.bottom:k+=b-w-a,C=a;break;case jc.VERTICAL_ALIGN.top:k+=a,C=a}var j=p.length*(s+u)-u;if(w+C>b||j+P>y){var L=new yd({draw:e,rect:o});L.open();for(var A=p.length,R=0;R<A;){var N=p[R];N.tx+=_,N.ty+=k,e.fillText(N.text,N.tx,N.ty),r&&this.drawLine("underline",N.tx,N.ty,N.len,c,l),i&&this.drawLine("strike",N.tx,N.ty,N.len,c,l),R+=1}L.close()}else for(var V=p.length,I=0;I<V;){var M=p[I];M.tx+=_,M.ty+=k,e.fillText(M.text,M.tx,M.ty),r&&this.drawLine("underline",M.tx,M.ty,M.len,c,l),i&&this.drawLine("strike",M.tx,M.ty,M.len,c,l),I+=1}return 0}},{key:"overflowFont",value:function(){return this.truncateFont()}},{key:"wrapTextFont",value:function(){for(var t=this.text,e=this.dw,n=this.attr,o=this.rect,r=n.underline,i=n.strikethrough,c=n.align,l=n.verticalAlign,a=n.padding,s=n.size,u=n.lineHeight,f=n.spacing,h=this.textBreak(t),p=[],y=o.width,b=o.height,d=b-2*a,v=h.length,g=0,w=0,m=0;g<v;){for(var E=h[g],O=E.length,S=0,x=0;x<O;){var T=E.charAt(x),_=this.textWidth(T),k={len:_,text:T,tx:w+(s/2-_/2),ty:S};0===x?p.push(k):(p.push(k),k.ty+s>d&&(S>0&&(S-=f),S>m&&(m=S),S=0,w+=s+u,k.tx=w,k.ty=S)),S+=s+f,x+=1}S>0&&(S-=f),S>m&&(m=S),w+=s+u,g+=1}w>0&&(w-=u);var P=o.x,C=o.y,j=0;switch(c){case jc.ALIGN.center:P+=y/2-w/2,j=0;break;case jc.ALIGN.right:P+=y-w-a,j=a;break;case jc.ALIGN.left:P+=a,j=a}switch(l){case jc.VERTICAL_ALIGN.center:C+=b/2-m/2;break;case jc.VERTICAL_ALIGN.bottom:C+=b-m-a;break;case jc.VERTICAL_ALIGN.top:C+=a}if(p.length*(s+u)-u+j>y){var L=new yd({draw:e,rect:o});L.open();for(var A=p.length,R=0;R<A;){var N=p[R];N.tx+=P,N.ty+=C,e.fillText(N.text,N.tx,N.ty),r&&this.drawLine("underline",N.tx,N.ty,N.len,c,l),i&&this.drawLine("strike",N.tx,N.ty,N.len,c,l),R+=1}L.close()}else for(var V=p.length,I=0;I<V;){var M=p[I];M.tx+=P,M.ty+=C,e.fillText(M.text,M.tx,M.ty),r&&this.drawLine("underline",M.tx,M.ty,M.len,c,l),i&&this.drawLine("strike",M.tx,M.ty,M.len,c,l),I+=1}return 0}}])&&Pd(n.prototype,o),r&&Pd(n,r),e}(jc);function Rd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nd(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Vd(t,e,n){return e&&Nd(t.prototype,e),n&&Nd(t,n),t}var Id=function(){function t(){Rd(this,t)}return Vd(t,null,[{key:"inverse",value:function(t){var e=t.tilt,n=t.angle;return Math.abs(e*Math.sin(Bi.radian(n)))}},{key:"tilt",value:function(t){var e=t.inverse,n=t.angle;return Math.abs(e/Math.sin(Bi.radian(n)))}}]),t}(),Md=function(){function t(){Rd(this,t)}return Vd(t,null,[{key:"nearby",value:function(t){var e=t.tilt,n=t.angle;return Math.abs(e*Math.cos(Bi.radian(n)))}},{key:"tilt",value:function(t){var e=t.nearby,n=t.angle;return Math.abs(e/Math.cos(Bi.radian(n)))}}]),t}();function Dd(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Bd={TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right",MIDDLE_LEFT:"middle-left",MIDDLE_CENTER:"middle-center",MIDDLE_RIGHT:"middle-right",BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right"},Hd=function(){function t(e){var n=e.angle,o=e.dw,r=e.origin,i=void 0===r?Bd.MIDDLE_CENTER:r,c=e.rect,l=void 0===c?new dd({x:0,y:0,width:0,height:0}):c;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dw=o,this.origin=i,this.rect=l,this.angle=n}var e,n,o;return e=t,(n=[{key:"rotate",value:function(){var t=this.origin,e=this.dw,n=this.rect,o=this.angle,r=n.x,i=n.y,c=n.width,l=n.height;e.save();var a=0,s=0;switch(t){case Bd.TOP_LEFT:a=r,s=i;break;case Bd.TOP_CENTER:a=r+c/2,s=i;break;case Bd.TOP_RIGHT:a=r+c,s=i;break;case Bd.MIDDLE_LEFT:a=r,s=i+l/2;break;case Bd.MIDDLE_CENTER:a=r+c/2,s=i+l/2;break;case Bd.MIDDLE_RIGHT:a=r+c,s=i+l/2;break;case Bd.BOTTOM_LEFT:a=r,s=i+l;break;case Bd.BOTTOM_CENTER:a=r+c/2,s=i+l;break;case Bd.BOTTOM_RIGHT:a=r+c,s=i+l}var u=e.getOffsetX(),f=e.getOffsetY();return e.translate(a+u,s+f).rotate(o).translate(-(a+u),-(s+f)),this}},{key:"revert",value:function(){return this.dw.restore(),this}}])&&Dd(e.prototype,n),o&&Dd(e,o),t}();function Wd(t){return(Wd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fd(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Yd(t,e){return!e||"object"!==Wd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gd(t){return(Gd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zd(t,e){return(zd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ud=function(t){function e(t){var n,o=t.overflow,r=t.text,i=t.rect,c=t.dw,l=t.attr;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Yd(this,Gd(e).call(this,{overflow:o,text:r,rect:i,dw:c,attr:l}))).attr=S.mergeDeep({lineHeight:4},n.attr),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zd(t,e)}(e,t),n=e,(o=[{key:"drawLine",value:function(t,e,n,o){var r=this.dw,i=this.attr.size,c=[0,0],l=[0,0];"strike"===t&&(c[0]=e,l[0]=e+o,c[1]=n+i/2,l[1]=n+i/2),"underline"===t&&(c[0]=e,l[0]=e+o,c[1]=n+i,l[1]=n+i),r.line(c,l)}},{key:"draw",value:function(){var t=this.text;if(this.isBlank(t))return 0;var e=this.dw,n=this.attr,o=n.textWrap,r=n.angle;switch(e.attr({textAlign:jc.ALIGN.left,textBaseline:jc.VERTICAL_ALIGN.top,font:"".concat(n.italic?"italic":""," ").concat(n.bold?"bold":""," ").concat(n.size,"px ").concat(n.name),fillStyle:n.color,strokeStyle:n.color}),0===r?e.attr({textAlign:n.align,textBaseline:n.verticalAlign}):e.attr({textAlign:jc.ALIGN.left,textBaseline:jc.VERTICAL_ALIGN.top}),o){case jc.TEXT_WRAP.OVER_FLOW:return this.overflowFont();case jc.TEXT_WRAP.TRUNCATE:return this.truncateFont();case jc.TEXT_WRAP.WORD_WRAP:return this.wrapTextFont()}return 0}},{key:"truncateFont",value:function(){this.overflowFont()}},{key:"overflowFont",value:function(){var t=this.text,e=this.dw,n=this.attr,o=this.rect,r=this.overflow;r||(r=o);var i=n.underline,c=n.strikethrough,l=n.align,a=n.verticalAlign,s=n.size,u=n.padding,f=n.lineHeight,h=n.angle;h>90&&(h=90),h<-90&&(h=-90);var p=o.width,y=o.height;if(h>0){for(var b=this.textBreak(t),d=[],v=b.length,g=0,w=0;g<v;){var m=b[g],E=this.textWidth(m);E>w&&(w=E),d.push({text:m,len:E,tx:0,ty:0}),g+=1}var O=d.length;if(O>1){for(var S=Id.tilt({inverse:s+f,angle:h}),x=Math.max(Md.nearby({tilt:w,angle:h}),s),T=Id.inverse({tilt:w,angle:h}),_=x+(O-1)*S,k=0,P=0;P<O;)d[P].tx=k,k+=S,P+=1;var C,j=o.x,L=o.y,A=0,R=0;switch(l){case jc.ALIGN.center:j+=p/2-_/2,A=0;break;case jc.ALIGN.left:j+=u,A=u;break;case jc.ALIGN.right:j+=p-_-u,A=u}switch(a){case jc.VERTICAL_ALIGN.center:L+=y/2-T/2,R=0;break;case jc.VERTICAL_ALIGN.top:L+=u,R=u;break;case jc.VERTICAL_ALIGN.bottom:L+=y-T-u,R=u}if(_+A>r.width||T+R>r.height){var N=new yd({draw:e,rect:r});N.open();for(var V=0;V<O;){var I=d[V],M=I.tx+j,D=I.ty+L,B=0,H=0;switch(l){case jc.ALIGN.center:B=M+x/2,H=D+T/2;break;case jc.ALIGN.left:var W=I.len/2;B+=M+Math.max(Md.nearby({tilt:W,angle:h}),s),H+=D+T-Id.inverse({tilt:W,angle:h});break;case jc.ALIGN.right:var F=I.len/2;B+=M+x-Math.max(Md.nearby({tilt:F,angle:h}),s),H+=D+Id.inverse({tilt:F,angle:h})}var Y=B-I.len/2,G=H-s/2,z=new Hd({dw:e,angle:h,rect:new dd({x:Y,y:G,width:I.len,height:s})});z.rotate(),e.fillText(I.text,Y,G),i&&this.drawLine("underline",Y,G,I.len),c&&this.drawLine("strike",Y,G,I.len),z.revert(),V+=1}N.close()}else for(var U=0;U<O;){var X=d[U],K=X.tx+j,Z=X.ty+L,$=0,q=0;switch(l){case jc.ALIGN.center:$=K+x/2,q=Z+T/2;break;case jc.ALIGN.left:var J=X.len/2;$+=K+Math.max(Md.nearby({tilt:J,angle:h}),s),q+=Z+T-Id.inverse({tilt:J,angle:h});break;case jc.ALIGN.right:var Q=X.len/2;$+=K+x-Math.max(Md.nearby({tilt:Q,angle:h}),s),q+=Z+Id.inverse({tilt:Q,angle:h})}var tt=$-X.len/2,et=q-s/2,nt=new Hd({dw:e,angle:h,rect:new dd({x:tt,y:et,width:X.len,height:s})});nt.rotate(),e.fillText(X.text,tt,et),i&&this.drawLine("underline",tt,et,X.len),c&&this.drawLine("strike",tt,et,X.len),nt.revert(),U+=1}switch(l){case jc.ALIGN.center:C=_;break;case jc.ALIGN.right:case jc.ALIGN.left:C=_+u}return C}var ot=this.textWidth(t),rt=Math.max(Md.nearby({tilt:ot,angle:h}),s),it=Id.inverse({tilt:ot,angle:h}),ct=o.x,lt=o.y,at=0,st=0;switch(l){case jc.ALIGN.center:ct+=p/2-rt/2,at=0;break;case jc.ALIGN.left:ct+=u,at=u;break;case jc.ALIGN.right:ct+=p-rt-u,at=u}switch(a){case jc.VERTICAL_ALIGN.center:lt+=y/2-it/2,st=0;break;case jc.VERTICAL_ALIGN.top:lt+=u,st=u;break;case jc.VERTICAL_ALIGN.bottom:lt+=y-it-u,st=u}if(rt+at>r.width||it+st>r.height){var ut=new yd({draw:e,rect:r});ut.open();var ft=new Hd({dw:e,angle:h,rect:new dd({x:ct,y:lt,width:rt,height:it})});ft.rotate();var ht=ct+(rt/2-ot/2),pt=lt+(it/2-s/2);e.fillText(t,ht,pt),i&&this.drawLine("underline",ht,pt,ot),c&&this.drawLine("strike",ht,pt,ot),ft.revert(),ut.close()}else{var yt=new Hd({dw:e,angle:h,rect:new dd({x:ct,y:lt,width:rt,height:it})});yt.rotate();var bt=ct+(rt/2-ot/2),dt=lt+(it/2-s/2);e.fillText(t,bt,dt),i&&this.drawLine("underline",bt,dt,ot),c&&this.drawLine("strike",bt,dt,ot),yt.revert()}var vt=0;switch(l){case jc.ALIGN.center:vt=rt;break;case jc.ALIGN.right:case jc.ALIGN.left:vt=rt+u}return vt}if(h<0){for(var gt=this.textBreak(t),wt=[],mt=gt.length,Et=0,Ot=0;Et<mt;){var St=gt[Et],xt=this.textWidth(St);xt>Ot&&(Ot=xt),wt.push({text:St,len:xt,tx:0,ty:0}),Et+=1}var Tt=wt.length;if(Tt>1){for(var _t=Id.tilt({inverse:s+f,angle:h}),kt=Math.max(Md.nearby({tilt:Ot,angle:h}),s),Pt=Id.inverse({tilt:Ot,angle:h}),Ct=kt+(Tt-1)*_t,jt=0,Lt=Tt-1;Lt>=0;)wt[Lt].tx=jt,jt+=_t,Lt-=1;var At=o.x,Rt=o.y,Nt=0,Vt=0;switch(l){case jc.ALIGN.center:At+=p/2-Ct/2,Nt=0;break;case jc.ALIGN.left:At+=u,Nt=u;break;case jc.ALIGN.right:At+=p-Ct-u,Nt=u}switch(a){case jc.VERTICAL_ALIGN.center:Rt+=y/2-Pt/2,Vt=0;break;case jc.VERTICAL_ALIGN.top:Rt+=u,Vt=u;break;case jc.VERTICAL_ALIGN.bottom:Rt+=y-Pt-u,Vt=u}if(Ct+Nt>r.width||Pt+Vt>r.height){var It=new yd({draw:e,rect:r});It.open();for(var Mt=0;Mt<Tt;){var Dt=wt[Mt],Bt=Dt.tx+At,Ht=Dt.ty+Rt,Wt=0,Ft=0;switch(l){case jc.ALIGN.center:Wt=Bt+kt/2,Ft=Ht+Pt/2;break;case jc.ALIGN.left:var Yt=Dt.len/2;Wt+=Bt+Math.max(Md.nearby({tilt:Yt,angle:h}),s),Ft+=Ht+Id.inverse({tilt:Yt,angle:h});break;case jc.ALIGN.right:var Gt=Dt.len/2;Wt+=Bt+kt-Math.max(Md.nearby({tilt:Gt,angle:h}),s),Ft+=Ht+Pt-Id.inverse({tilt:Gt,angle:h})}var zt=Wt-Dt.len/2,Ut=Ft-s/2,Xt=new Hd({dw:e,angle:h,rect:new dd({x:zt,y:Ut,width:Dt.len,height:s})});Xt.rotate(),e.fillText(Dt.text,zt,Ut),i&&this.drawLine("underline",zt,Ut,Dt.len),c&&this.drawLine("strike",zt,Ut,Dt.len),Xt.revert(),Mt+=1}It.close()}else for(var Kt=0;Kt<Tt;){var Zt=wt[Kt],$t=Zt.tx+At,qt=Zt.ty+Rt,Jt=0,Qt=0;switch(l){case jc.ALIGN.center:Jt=$t+kt/2,Qt=qt+Pt/2;break;case jc.ALIGN.left:var te=Zt.len/2;Jt+=$t+Math.max(Md.nearby({tilt:te,angle:h}),s),Qt+=qt+Id.inverse({tilt:te,angle:h});break;case jc.ALIGN.right:var ee=Zt.len/2;Jt+=$t+kt-Math.max(Md.nearby({tilt:ee,angle:h}),s),Qt+=qt+Pt-Id.inverse({tilt:ee,angle:h})}var ne=Jt-Zt.len/2,oe=Qt-s/2,re=new Hd({dw:e,angle:h,rect:new dd({x:ne,y:oe,width:Zt.len,height:s})});re.rotate(),e.fillText(Zt.text,ne,oe),i&&this.drawLine("underline",ne,oe,Zt.len),c&&this.drawLine("strike",ne,oe,Zt.len),re.revert(),Kt+=1}var ie=0;switch(l){case jc.ALIGN.center:ie=Ct;break;case jc.ALIGN.right:case jc.ALIGN.left:ie=Ct+u}return ie}var ce,le=this.textWidth(t),ae=Math.max(Md.nearby({tilt:le,angle:h}),s),se=Id.inverse({tilt:le,angle:h}),ue=o.x,fe=o.y,he=0,pe=0;switch(l){case jc.ALIGN.center:ue+=p/2-ae/2,he=0;break;case jc.ALIGN.left:ue+=u,he=u;break;case jc.ALIGN.right:ue+=p-ae-u,he=u}switch(a){case jc.VERTICAL_ALIGN.center:fe+=y/2-se/2,pe=0;break;case jc.VERTICAL_ALIGN.top:fe+=u,pe=u;break;case jc.VERTICAL_ALIGN.bottom:fe+=y-se-u,pe=u}if(ae+he>r.width||se+pe>r.height){var ye=new yd({draw:e,rect:r});ye.open();var be=new Hd({dw:e,angle:h,rect:new dd({x:ue,y:fe,width:ae,height:se})});be.rotate();var de=ue+(ae/2-le/2),ve=fe+(se/2-s/2);e.fillText(t,de,ve),i&&this.drawLine("underline",de,ve,le),c&&this.drawLine("strike",de,ve,le),be.revert(),ye.close()}else{var ge=new Hd({dw:e,angle:h,rect:new dd({x:ue,y:fe,width:ae,height:se})});ge.rotate();var we=ue+(ae/2-le/2),me=fe+(se/2-s/2);e.fillText(t,we,me),i&&this.drawLine("underline",we,me,le),c&&this.drawLine("strike",we,me,le),ge.revert()}switch(l){case jc.ALIGN.center:ce=ae;break;case jc.ALIGN.right:case jc.ALIGN.left:ce=ae+2*u}return ce}if(0===h){for(var Ee=this.textBreak(t),Oe=[],Se=o.width,xe=o.height,Te=Ee.length,_e=0,ke=0,Pe=0;_e<Te;){_e>0&&(ke+=s+f);var Ce=Ee[_e],je={tx:0,ty:ke,text:Ce,len:this.textWidth(Ce)};Oe.push(je),je.len>Pe&&(Pe=je.len),_e+=1}ke>0&&(ke-=f);var Le=o.x,Ae=o.y,Re=0,Ne=0;switch(l){case jc.ALIGN.center:Le+=Se/2,Re=0;break;case jc.ALIGN.left:Le+=u,Re=u;break;case jc.ALIGN.right:Le+=Se-u,Re=u}switch(a){case jc.VERTICAL_ALIGN.center:Ae+=xe/2-ke/2,Ne=0;break;case jc.VERTICAL_ALIGN.top:Ae+=u,Ne=u;break;case jc.VERTICAL_ALIGN.bottom:Ae+=xe-ke-u,Ne=u}var Ve=Oe.length*(s+f)-f,Ie=Pe+Re>r.width||Ve+Ne>r.height,Me=!1;if(l===jc.ALIGN.center){var De=Pe/2-Se/2;De>0&&r.x>o.x-De&&(Me=!0)}if(Ie||Me){var Be=new yd({draw:e,rect:r});Be.open();for(var He=Oe.length,We=0;We<He;){var Fe=Oe[We];Fe.tx+=Le,Fe.ty+=Ae,e.fillText(Fe.text,Fe.tx,Fe.ty),i&&this.drawLine("underline",Fe.tx,Fe.ty,Fe.len),c&&this.drawLine("strike",Fe.tx,Fe.ty,Fe.len),We+=1}Be.close()}else for(var Ye=Oe.length,Ge=0;Ge<Ye;){var ze=Oe[Ge];ze.tx+=Le,ze.ty+=Ae,e.fillText(ze.text,ze.tx,ze.ty),i&&this.drawLine("underline",ze.tx,ze.ty,ze.len),c&&this.drawLine("strike",ze.tx,ze.ty,ze.len),Ge+=1}var Ue=0;switch(l){case jc.ALIGN.right:case jc.ALIGN.left:Ue=u+Pe;break;case jc.ALIGN.center:Ue=Pe}return Ue}return 0}},{key:"wrapTextFont",value:function(){var t=this.text,e=this.dw,n=this.attr,o=this.rect,r=this.overflow;r||(r=o);var i=n.underline,c=n.strikethrough,l=n.align,a=n.verticalAlign,s=n.size,u=n.padding,f=n.lineHeight,h=n.angle;h>90&&(h=90),h<-90&&(h=-90);var p=o.width,y=o.height;if(h>0){for(var b=Id.tilt({inverse:y-2*u,angle:h}),d=this.textBreak(t),v=[],g=d.length,w=0,m=0;w<g;){for(var E=d[w],O=E.length,S={len:0,start:0},x=0;x<O;){var T=S.len+this.textWidth(E.charAt(x));T>b?(0===S.len?(v.push({text:E.substring(x,x+1),len:T,tx:0,ty:0}),T>m&&(m=T),x+=1):(v.push({text:E.substring(S.start,x),len:S.len,tx:0,ty:0}),S.len>m&&(m=S.len)),S.len=0,S.start=x):(S.len=T,x+=1)}S.len>0&&v.push({text:E.substring(S.start),len:S.len,tx:0,ty:0}),S.len>m&&(m=S.len),w+=1}var _=v.length;if(_>1){for(var k=Id.tilt({inverse:s+f,angle:h}),P=Math.max(Md.nearby({tilt:m,angle:h}),s),C=Id.inverse({tilt:m,angle:h}),j=P+(_-1)*k,L=0,A=0;A<_;)v[A].tx=L,L+=k,A+=1;var R,N=o.x,V=o.y,I=0,M=0;switch(l){case jc.ALIGN.center:N+=p/2-j/2,I=0;break;case jc.ALIGN.left:N+=u,I=u;break;case jc.ALIGN.right:N+=p-j-u,I=u}switch(a){case jc.VERTICAL_ALIGN.center:V+=y/2-C/2,M=0;break;case jc.VERTICAL_ALIGN.top:V+=u,M=u;break;case jc.VERTICAL_ALIGN.bottom:V+=y-C-u,M=u}if(j+I>r.width||C+M>r.height){var D=new yd({draw:e,rect:r});D.open();for(var B=0;B<_;){var H=v[B],W=H.tx+N,F=H.ty+V,Y=0,G=0;switch(l){case jc.ALIGN.center:Y=W+P/2,G=F+C/2;break;case jc.ALIGN.left:var z=H.len/2;Y+=W+Math.max(Md.nearby({tilt:z,angle:h}),s),G+=F+C-Id.inverse({tilt:z,angle:h});break;case jc.ALIGN.right:var U=H.len/2;Y+=W+P-Math.max(Md.nearby({tilt:U,angle:h}),s),G+=F+Id.inverse({tilt:U,angle:h})}var X=Y-H.len/2,K=G-s/2,Z=new Hd({dw:e,angle:h,rect:new dd({x:X,y:K,width:H.len,height:s})});Z.rotate(),e.fillText(H.text,X,K),i&&this.drawLine("underline",X,K,H.len),c&&this.drawLine("strike",X,K,H.len),Z.revert(),B+=1}D.close()}else for(var $=0;$<_;){var q=v[$],J=q.tx+N,Q=q.ty+V,tt=0,et=0;switch(l){case jc.ALIGN.center:tt=J+P/2,et=Q+C/2;break;case jc.ALIGN.left:var nt=q.len/2;tt+=J+Math.max(Md.nearby({tilt:nt,angle:h}),s),et+=Q+C-Id.inverse({tilt:nt,angle:h});break;case jc.ALIGN.right:var ot=q.len/2;tt+=J+P-Math.max(Md.nearby({tilt:ot,angle:h}),s),et+=Q+Id.inverse({tilt:ot,angle:h})}var rt=tt-q.len/2,it=et-s/2,ct=new Hd({dw:e,angle:h,rect:new dd({x:rt,y:it,width:q.len,height:s})});ct.rotate(),e.fillText(q.text,rt,it),i&&this.drawLine("underline",rt,it,q.len),c&&this.drawLine("strike",rt,it,q.len),ct.revert(),$+=1}switch(l){case jc.ALIGN.center:R=j;break;case jc.ALIGN.right:case jc.ALIGN.left:R=j+u}return R}var lt=this.textWidth(t),at=Math.max(Md.nearby({tilt:lt,angle:h}),s),st=Id.inverse({tilt:lt,angle:h}),ut=o.x,ft=o.y,ht=0,pt=0;switch(l){case jc.ALIGN.center:ut+=p/2-at/2,ht=0;break;case jc.ALIGN.left:ut+=u,ht=u;break;case jc.ALIGN.right:ut+=p-at-u,ht=u}switch(a){case jc.VERTICAL_ALIGN.center:ft+=y/2-st/2,pt=0;break;case jc.VERTICAL_ALIGN.top:ft+=u,pt=u;break;case jc.VERTICAL_ALIGN.bottom:ft+=y-st-u,pt=u}if(at+ht>r.width||st+pt>r.height){var yt=new yd({draw:e,rect:r});yt.open();var bt=new Hd({dw:e,angle:h,rect:new dd({x:ut,y:ft,width:at,height:st})});bt.rotate();var dt=ut+(at/2-lt/2),vt=ft+(st/2-s/2);e.fillText(t,dt,vt),i&&this.drawLine("underline",dt,vt,lt),c&&this.drawLine("strike",dt,vt,lt),bt.revert(),yt.close()}else{var gt=new Hd({dw:e,angle:h,rect:new dd({x:ut,y:ft,width:at,height:st})});gt.rotate();var wt=ut+(at/2-lt/2),mt=ft+(st/2-s/2);e.fillText(t,wt,mt),i&&this.drawLine("underline",wt,mt,lt),c&&this.drawLine("strike",wt,mt,lt),gt.revert()}var Et=0;switch(l){case jc.ALIGN.center:Et=at;break;case jc.ALIGN.right:case jc.ALIGN.left:Et=at+u}return Et}if(h<0){for(var Ot=Id.tilt({inverse:y-2*u,angle:h}),St=this.textBreak(t),xt=[],Tt=St.length,_t=0,kt=0;_t<Tt;){for(var Pt=St[_t],Ct=Pt.length,jt={len:0,start:0},Lt=0;Lt<Ct;){var At=jt.len+this.textWidth(Pt.charAt(Lt));At>Ot?(0===jt.len?(xt.push({text:Pt.substring(Lt,Lt+1),len:At,tx:0,ty:0}),At>kt&&(kt=At),Lt+=1):(xt.push({text:Pt.substring(jt.start,Lt),len:jt.len,tx:0,ty:0}),jt.len>kt&&(kt=jt.len)),jt.len=0,jt.start=Lt):(jt.len=At,Lt+=1)}jt.len>0&&xt.push({text:Pt.substring(jt.start),len:jt.len,tx:0,ty:0}),jt.len>kt&&(kt=jt.len),_t+=1}var Rt=xt.length;if(Rt>1){for(var Nt=Id.tilt({inverse:s+f,angle:h}),Vt=Math.max(Md.nearby({tilt:kt,angle:h}),s),It=Id.inverse({tilt:kt,angle:h}),Mt=Vt+(Rt-1)*Nt,Dt=0,Bt=Rt-1;Bt>=0;)xt[Bt].tx=Dt,Dt+=Nt,Bt-=1;var Ht=o.x,Wt=o.y,Ft=0,Yt=0;switch(l){case jc.ALIGN.center:Ht+=p/2-Mt/2,Ft=0;break;case jc.ALIGN.left:Ht+=u,Ft=u;break;case jc.ALIGN.right:Ht+=p-Mt-u,Ft=u}switch(a){case jc.VERTICAL_ALIGN.center:Wt+=y/2-It/2,Yt=0;break;case jc.VERTICAL_ALIGN.top:Wt+=u,Yt=u;break;case jc.VERTICAL_ALIGN.bottom:Wt+=y-It-u,Yt=u}if(Mt+Ft>r.width||It+Yt>r.height){var Gt=new yd({draw:e,rect:r});Gt.open();for(var zt=0;zt<Rt;){var Ut=xt[zt],Xt=Ut.tx+Ht,Kt=Ut.ty+Wt,Zt=0,$t=0;switch(l){case jc.ALIGN.center:Zt=Xt+Vt/2,$t=Kt+It/2;break;case jc.ALIGN.left:var qt=Ut.len/2;Zt+=Xt+Math.max(Md.nearby({tilt:qt,angle:h}),s),$t+=Kt+Id.inverse({tilt:qt,angle:h});break;case jc.ALIGN.right:var Jt=Ut.len/2;Zt+=Xt+Vt-Math.max(Md.nearby({tilt:Jt,angle:h}),s),$t+=Kt+It-Id.inverse({tilt:Jt,angle:h})}var Qt=Zt-Ut.len/2,te=$t-s/2,ee=new Hd({dw:e,angle:h,rect:new dd({x:Qt,y:te,width:Ut.len,height:s})});ee.rotate(),e.fillText(Ut.text,Qt,te),i&&this.drawLine("underline",Qt,te,Ut.len),c&&this.drawLine("strike",Qt,te,Ut.len),ee.revert(),zt+=1}Gt.close()}else for(var ne=0;ne<Rt;){var oe=xt[ne],re=oe.tx+Ht,ie=oe.ty+Wt,ce=0,le=0;switch(l){case jc.ALIGN.center:ce=re+Vt/2,le=ie+It/2;break;case jc.ALIGN.left:var ae=oe.len/2;ce+=re+Math.max(Md.nearby({tilt:ae,angle:h}),s),le+=ie+Id.inverse({tilt:ae,angle:h});break;case jc.ALIGN.right:var se=oe.len/2;ce+=re+Vt-Math.max(Md.nearby({tilt:se,angle:h}),s),le+=ie+It-Id.inverse({tilt:se,angle:h})}var ue=ce-oe.len/2,fe=le-s/2,he=new Hd({dw:e,angle:h,rect:new dd({x:ue,y:fe,width:oe.len,height:s})});he.rotate(),e.fillText(oe.text,ue,fe),i&&this.drawLine("underline",ue,fe,oe.len),c&&this.drawLine("strike",ue,fe,oe.len),he.revert(),ne+=1}var pe=0;switch(l){case jc.ALIGN.center:pe=Mt;break;case jc.ALIGN.right:case jc.ALIGN.left:pe=Mt+u}return pe}var ye,be=this.textWidth(t),de=Math.max(Md.nearby({tilt:be,angle:h}),s),ve=Id.inverse({tilt:be,angle:h}),ge=o.x,we=o.y,me=0,Ee=0;switch(l){case jc.ALIGN.center:ge+=p/2-de/2,me=0;break;case jc.ALIGN.left:ge+=u,me=u;break;case jc.ALIGN.right:ge+=p-de-u,me=u}switch(a){case jc.VERTICAL_ALIGN.center:we+=y/2-ve/2,Ee=0;break;case jc.VERTICAL_ALIGN.top:we+=u,Ee=u;break;case jc.VERTICAL_ALIGN.bottom:we+=y-ve-u,Ee=u}if(de+me>r.width||ve+Ee>r.height){var Oe=new yd({draw:e,rect:r});Oe.open();var Se=new Hd({dw:e,angle:h,rect:new dd({x:ge,y:we,width:de,height:ve})});Se.rotate();var xe=ge+(de/2-be/2),Te=we+(ve/2-s/2);e.fillText(t,xe,Te),i&&this.drawLine("underline",xe,Te,be),c&&this.drawLine("strike",xe,Te,be),Se.revert(),Oe.close()}else{var _e=new Hd({dw:e,angle:h,rect:new dd({x:ge,y:we,width:de,height:ve})});_e.rotate();var ke=ge+(de/2-be/2),Pe=we+(ve/2-s/2);e.fillText(t,ke,Pe),i&&this.drawLine("underline",ke,Pe,be),c&&this.drawLine("strike",ke,Pe,be),_e.revert()}switch(l){case jc.ALIGN.center:ye=de;break;case jc.ALIGN.right:case jc.ALIGN.left:ye=de+2*u}return ye}if(0===h){for(var Ce=this.textBreak(t),je=[],Le=o.width,Ae=o.height,Re=Le-2*u,Ne=Ce.length,Ve=0,Ie=0;Ve<Ne;){Ve>0&&(Ie+=s+f);for(var Me=Ce[Ve],De=Me.length,Be=0,He={len:0,start:0};Be<De;){var We=He.len+this.textWidth(Me.charAt(Be));We>Re?(0===He.len?(je.push({text:Me.substring(Be,Be+1),len:We,tx:0,ty:Ie}),Be+=1):je.push({text:Me.substring(He.start,Be),len:He.len,tx:0,ty:Ie}),Ie+=s+f,He.len=0,He.start=Be):(He.len=We,Be+=1)}He.len>0&&je.push({text:Me.substring(He.start),len:He.len,tx:0,ty:Ie}),Ve+=1}Ie>0&&(Ie-=f);var Fe=o.x,Ye=o.y,Ge=0;switch(l){case jc.ALIGN.left:Fe+=u;break;case jc.ALIGN.center:Fe+=Le/2;break;case jc.ALIGN.right:Fe+=Le-u}switch(a){case jc.VERTICAL_ALIGN.center:Ye+=Ae/2-Ie/2,Ge=0;break;case jc.VERTICAL_ALIGN.top:Ye+=u,Ge=u;break;case jc.VERTICAL_ALIGN.bottom:Ye+=Ae-Ie-u,Ge=u}if(je.length*(s+f)-f+Ge>Ae){var ze=new yd({draw:e,rect:o});ze.open();for(var Ue=je.length,Xe=0;Xe<Ue;){var Ke=je[Xe];Ke.tx+=Fe,Ke.ty+=Ye,e.fillText(Ke.text,Ke.tx,Ke.ty),i&&this.drawLine("underline",Ke.tx,Ke.ty,Ke.len),c&&this.drawLine("strike",Ke.tx,Ke.ty,Ke.len),Xe+=1}ze.close()}else for(var Ze=0,$e=je.length;Ze<$e;Ze+=1){var qe=je[Ze];qe.tx+=Fe,qe.ty+=Ye,e.fillText(qe.text,qe.tx,qe.ty),i&&this.drawLine("underline",qe.tx,qe.ty,qe.len),c&&this.drawLine("strike",qe.tx,qe.ty,qe.len)}return 0}return 0}}])&&Fd(n.prototype,o),r&&Fd(n,r),e}(jc);function Xd(t){return(Xd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kd(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Zd(t,e){return!e||"object"!==Xd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $d(t){return($d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qd(t,e){return(qd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Jd(t){return(Jd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qd(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function tv(t,e){return!e||"object"!==Jd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ev(t){return(ev=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nv(t,e){return(nv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ov=function(t){function e(t){var n,o=t.overflow,r=t.text,i=t.rect,c=t.dw,l=t.attr;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=tv(this,ev(e).call(this,{overflow:o,text:r,rect:i,dw:c,attr:l}))).attr=S.mergeDeep({lineHeight:4},n.attr),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nv(t,e)}(e,t),n=e,(o=[{key:"drawLine",value:function(t,e,n,o){var r=this.dw,i=this.attr,c=i.size,l=i.verticalAlign,a=i.align,s=[0,0],u=[0,0];if("strike"===t){switch(a){case jc.ALIGN.right:s[0]=e-o,u[0]=e;break;case jc.ALIGN.center:s[0]=e-o/2,u[0]=e+o/2;break;case jc.ALIGN.left:s[0]=e,u[0]=e+o}switch(l){case jc.VERTICAL_ALIGN.top:s[1]=n+c/2,u[1]=n+c/2;break;case jc.VERTICAL_ALIGN.center:s[1]=n,u[1]=n;break;case jc.VERTICAL_ALIGN.bottom:s[1]=n-c/2,u[1]=n-c/2}}if("underline"===t){switch(a){case jc.ALIGN.right:s[0]=e-o,u[0]=e;break;case jc.ALIGN.center:s[0]=e-o/2,u[0]=e+o/2;break;case jc.ALIGN.left:s[0]=e,u[0]=e+o}switch(l){case jc.VERTICAL_ALIGN.top:s[1]=n+c,u[1]=n+c;break;case jc.VERTICAL_ALIGN.center:s[1]=n+c/2,u[1]=n+c/2;break;case jc.VERTICAL_ALIGN.bottom:s[1]=n,u[1]=n}}r.line(s,u)}},{key:"draw",value:function(){var t=this.text;if(this.isBlank(t))return 0;var e=this.dw,n=this.attr,o=n.textWrap;switch(e.attr({textAlign:n.align,textBaseline:n.verticalAlign,font:"".concat(n.italic?"italic":""," ").concat(n.bold?"bold":""," ").concat(n.size,"px ").concat(n.name),fillStyle:n.color,strokeStyle:n.color}),o){case jc.TEXT_WRAP.OVER_FLOW:return this.overflowFont();case jc.TEXT_WRAP.TRUNCATE:return this.truncateFont();case jc.TEXT_WRAP.WORD_WRAP:return this.wrapTextFont()}return 0}},{key:"truncateFont",value:function(){for(var t=this.text,e=this.dw,n=this.attr,o=this.rect,r=n.underline,i=n.strikethrough,c=n.align,l=n.verticalAlign,a=n.padding,s=n.size,u=n.lineHeight,f=this.textBreak(t),h=[],p=o.width,y=o.height,b=f.length,d=0,v=0,g=0;d<b;){d>0&&(v+=s+u);var w=this.displayFont(o,f[d]),m={tx:0,ty:v,text:w,len:this.textWidth(w)};h.push(m),m.len>g&&(g=m.len),d+=1}v>0&&(v-=u);var E=o.x,O=o.y,S=0,x=0;switch(c){case jc.ALIGN.center:E+=p/2,S=0;break;case jc.ALIGN.left:E+=a,S=a;break;case jc.ALIGN.right:E+=p-a,S=a}switch(l){case jc.VERTICAL_ALIGN.center:O+=y/2-v/2,x=0;break;case jc.VERTICAL_ALIGN.top:O+=a,x=a;break;case jc.VERTICAL_ALIGN.bottom:O+=y-v-a,x=a}var T=h.length*(s+u)-u;if(g+S>p||T+x>y){var _=new yd({draw:e,rect:o});_.open();for(var k=h.length,P=0;P<k;){var C=h[P];C.tx+=E,C.ty+=O,e.fillText(C.text,C.tx,C.ty),r&&this.drawLine("underline",C.tx,C.ty,C.len),i&&this.drawLine("strike",C.tx,C.ty,C.len),P+=1}_.close()}else for(var j=h.length,L=0;L<j;){var A=h[L];A.tx+=E,A.ty+=O,e.fillText(A.text,A.tx,A.ty),r&&this.drawLine("underline",A.tx,A.ty,A.len),i&&this.drawLine("strike",A.tx,A.ty,A.len),L+=1}return 0}},{key:"overflowFont",value:function(){var t=this.text,e=this.dw,n=this.attr,o=this.rect,r=this.overflow;r||(r=o);for(var i=n.underline,c=n.strikethrough,l=n.align,a=n.verticalAlign,s=n.padding,u=n.size,f=n.lineHeight,h=this.textBreak(t),p=[],y=o.width,b=o.height,d=h.length,v=0,g=0,w=0;v<d;){v>0&&(g+=u+f);var m=h[v],E={tx:0,ty:g,text:m,len:this.textWidth(m)};p.push(E),E.len>w&&(w=E.len),v+=1}g>0&&(g-=f);var O=o.x,S=o.y,x=0,T=0;switch(l){case jc.ALIGN.center:O+=y/2,x=0;break;case jc.ALIGN.left:O+=s,x=s;break;case jc.ALIGN.right:O+=y-s,x=s}switch(a){case jc.VERTICAL_ALIGN.center:S+=b/2-g/2,T=0;break;case jc.VERTICAL_ALIGN.top:S+=s,T=s;break;case jc.VERTICAL_ALIGN.bottom:S+=b-g-s,T=s}var _=p.length*(u+f)-f,k=w+x>r.width||_+T>r.height,P=!1;if(l===jc.ALIGN.center){var C=w/2-y/2;C>0&&(r.x>o.x-C?P=!0:r.x+r.width<o.x+o.width+C&&(P=!0))}if(k||P){var j=new yd({draw:e,rect:r});j.open();for(var L=p.length,A=0;A<L;){var R=p[A];R.tx+=O,R.ty+=S,e.fillText(R.text,R.tx,R.ty),i&&this.drawLine("underline",R.tx,R.ty,R.len),c&&this.drawLine("strike",R.tx,R.ty,R.len),A+=1}j.close()}else for(var N=p.length,V=0;V<N;){var I=p[V];I.tx+=O,I.ty+=S,e.fillText(I.text,I.tx,I.ty),i&&this.drawLine("underline",I.tx,I.ty,I.len),c&&this.drawLine("strike",I.tx,I.ty,I.len),V+=1}var M=0;switch(l){case jc.ALIGN.right:case jc.ALIGN.left:M=s+w;break;case jc.ALIGN.center:M=w}return M}},{key:"wrapTextFont",value:function(){for(var t=this.text,e=this.dw,n=this.attr,o=this.rect,r=n.underline,i=n.strikethrough,c=n.align,l=n.verticalAlign,a=n.padding,s=n.size,u=n.lineHeight,f=this.textBreak(t),h=[],p=o.width,y=o.height,b=p-2*a,d=f.length,v=0,g=0;v<d;){v>0&&(g+=s+u);for(var w=f[v],m=w.length,E=0,O={len:0,start:0};E<m;){var S=O.len+this.textWidth(w.charAt(E));S>b?(0===O.len?(h.push({text:w.substring(E,E+1),len:S,tx:0,ty:g}),E+=1):h.push({text:w.substring(O.start,E),len:O.len,tx:0,ty:g}),g+=s+u,O.len=0,O.start=E):(O.len=S,E+=1)}O.len>0&&h.push({text:w.substring(O.start),len:O.len,tx:0,ty:g}),v+=1}g>0&&(g-=u);var x=o.x,T=o.y,_=0;switch(c){case jc.ALIGN.left:x+=a;break;case jc.ALIGN.center:x+=p/2;break;case jc.ALIGN.right:x+=p-a}switch(l){case jc.VERTICAL_ALIGN.center:T+=y/2-g/2,_=0;break;case jc.VERTICAL_ALIGN.top:T+=a,_=a;break;case jc.VERTICAL_ALIGN.bottom:T+=y-g-a,_=a}if(h.length*(s+u)-u+_>y){var k=new yd({draw:e,rect:o});k.open();for(var P=h.length,C=0;C<P;){var j=h[C];j.tx+=x,j.ty+=T,e.fillText(j.text,j.tx,j.ty),r&&this.drawLine("underline",j.tx,j.ty,j.len),i&&this.drawLine("strike",j.tx,j.ty,j.len),C+=1}k.close()}else for(var L=0,A=h.length;L<A;L+=1){var R=h[L];R.tx+=x,R.ty+=T,e.fillText(R.text,R.tx,R.ty),r&&this.drawLine("underline",R.tx,R.ty,R.len),i&&this.drawLine("strike",R.tx,R.ty,R.len)}return 0}}])&&Qd(n.prototype,o),r&&Qd(n,r),e}(function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Zd(this,$d(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qd(t,e)}(e,t),n=e,(o=[{key:"displayFont",value:function(t,e){var n=this.attr.align,o=t.width,r=e.length;switch(n){case jc.ALIGN.center:var i=o/2-this.textWidth(e)/2;if(i<0)for(var c="",l=0;l<r;){var a=e.charAt(l);if((i+=this.textWidth(a))>0&&(c+=a,i>o))return c;l+=1}break;case jc.ALIGN.left:for(var s=e.length,u="",f=0,h=0;f<s;){var p=e.charAt(f);if(u+=p,(h+=this.textWidth(p))>o)return u;f+=1}break;case jc.ALIGN.right:for(var y=e.length,b="",d=0;y>0;){var v=e.charAt(y);if(b=v+b,(d+=this.textWidth(v))>o)return b;y-=1}}return e}}])&&Kd(n.prototype,o),r&&Kd(n,r),e}(jc));function rv(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var iv=function(){function t(e){var n=e.overflow,o=e.text,r=e.dw,i=e.rect,c=e.attr;switch(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.attr=S.mergeDeep({},{verticalAlign:jc.VERTICAL_ALIGN.center,direction:jc.TEXT_DIRECTION.HORIZONTAL,name:"Arial",size:14,color:"#000000",underline:!1,strikethrough:!1,bold:!1,italic:!1,textWrap:jc.TEXT_WRAP.TRUNCATE,align:jc.ALIGN.left,angle:0,padding:8},c),this.font=null,c.direction){case jc.TEXT_DIRECTION.HORIZONTAL:this.font=new ov({text:o,rect:i,dw:r,overflow:n,attr:this.attr});break;case jc.TEXT_DIRECTION.ANGLE:this.font=new Ud({text:o,rect:i,dw:r,overflow:n,attr:this.attr});break;case jc.TEXT_DIRECTION.VERTICAL:this.font=new Ad({text:o,rect:i,dw:r,overflow:n,attr:this.attr})}}var e,n,o;return e=t,(n=[{key:"setTextWrap",value:function(t){this.font.setTextWrap(t)}},{key:"setSize",value:function(t){this.font.setSize(t)}},{key:"setPadding",value:function(t){this.font.setPadding(t)}},{key:"draw",value:function(){return this.font.draw()}}])&&rv(e.prototype,n),o&&rv(e,o),t}();function cv(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lv(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function av(t,e,n){return e&&lv(t.prototype,e),n&&lv(t,n),t}var sv=function(){function t(e){var n=e.scaleAdapter;cv(this,t),this.scaleAdapter=n,this.text=null,this.rect=null,this.attr=null,this.dw=null,this.overflow=null}return av(t,[{key:"setDraw",value:function(t){this.dw=t}},{key:"setText",value:function(t){this.text=t}},{key:"setRect",value:function(t){this.rect=t}},{key:"setAttr",value:function(t){this.attr=t}},{key:"setOverFlow",value:function(t){this.overflow=t}},{key:"build",value:function(){var t=this.text,e=this.rect,n=this.attr,o=this.overflow,r=this.dw,i=this.scaleAdapter,c=new iv({dw:r,text:t,rect:e,attr:n,overflow:o}),l=Bi.transformStylePx(i.goto(n.size)),a=Bi.transformStylePx(i.goto(n.padding));return c.setSize(l),c.setPadding(a),c}}]),t}(),uv=function(){function t(e){var n=e.scaleAdapter,o=void 0===n?new rb:n;cv(this,t),this.scaleAdapter=o}return av(t,[{key:"getBuilder",value:function(){var t=this.scaleAdapter;return new sv({scaleAdapter:t})}}]),t}();function fv(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var hv=function(){function t(e){var n=e.cells,o=e.merges,r=e.rows,i=e.cols,c=e.tableDataSnapshot,l=e.xTableAreaView;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tableDataSnapshot=c,this.xTableAreaView=l,this.cells=n,this.merges=o,this.rows=r,this.cols=i}var e,n,o;return e=t,(n=[{key:"getCellOverFlow",value:function(t,e,n,o){var r=this.xTableAreaView,i=o.fontAttr,c=i.direction,l=i.textWrap,a=i.angle,s=n.x,u=n.y,f=n.height;if(c===jc.TEXT_DIRECTION.ANGLE){if(0===a){var h=this.getCellTextMaxWidth(t,e);return new dd({x:s+h.offset,y:u,width:h.width,height:f})}var p=r.getScrollView();return new dd({x:0,y:u,width:p.w,height:f})}if(l===jc.TEXT_WRAP.OVER_FLOW){var y=this.getCellTextMaxWidth(t,e);return new dd({x:s+y.offset,y:u,width:y.width,height:f})}return null}},{key:"getCellTextMaxWidth",value:function(t,e){var n=this.cells,o=this.cols,r=this.merges,i=n.getCell(t,e).fontAttr.align,c=0,l=0;if(i===jc.ALIGN.left)as.getInstance().setBegin(e).setEnd(o.len).setLoop((function(i){var l=r.getFirstIncludes(t,i),a=n.getCell(t,i),s=S.isUnDef(a)||S.isBlank(a.text);return i===e?(c+=o.getWidth(i),!0):!(!s||!S.isUnDef(l)||(c+=o.getWidth(i),0))})).execute();else if(i===jc.ALIGN.center){var a=0,s=0;as.getInstance().setBegin(e+1).setEnd(o.len).setLoop((function(e){var i=r.getFirstIncludes(t,e),c=n.getCell(t,e);return!(!S.isUnDef(c)&&!S.isBlank(c.text)||!S.isUnDef(i)||(a+=o.getWidth(e),0))})).execute(),as.getInstance().setBegin(e-1).setEnd(0).setLoop((function(e){var i=r.getFirstIncludes(t,e),c=n.getCell(t,e);if((S.isUnDef(c)||S.isBlank(c.text))&&S.isUnDef(i)){var a=o.getWidth(e);return s+=a,l-=a,!0}return!1})).execute(),c=o.getWidth(e)+s+a}else i===jc.ALIGN.right&&as.getInstance().setBegin(e).setEnd(0).setLoop((function(i){var a=r.getFirstIncludes(t,i),s=n.getCell(t,i),u=S.isUnDef(s)||S.isBlank(s.text);if(i===e)return c+=o.getWidth(i),!0;if(u&&S.isUnDef(a)){var f=o.getWidth(i);return c+=f,l-=f,!0}return!1})).execute();return{width:c,offset:l}}}])&&fv(e.prototype,n),o&&fv(e,o),t}();function pv(t){return(pv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yv(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function bv(t,e){return!e||"object"!==pv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dv(t){return(dv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vv(t,e){return(vv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gv=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),bv(this,dv(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vv(t,e)}(e,t),n=e,(o=[{key:"getCellByViewRange",value:function(t){var e=t.rectRange,n=t.callback,o=t.startX,r=void 0===o?0:o,i=t.startY,c=void 0===i?0:i,l=this.rows,a=this.cols,s=this.cells,u=e.sri,f=e.eri,h=e.sci,p=e.eci,y=c;ns.getInstance().setBegin(u).setEnd(f).setLoop((function(t){var e=l.getHeight(t),o=r;as.getInstance().setBegin(h).setEnd(p).setLoop((function(r){var i=s.getCell(t,r),c=a.getWidth(r);if(i){var l=new dd({x:o,y:y,width:c,height:e});if(!1===n(t,r,i,l))return}o+=c})).execute(),y+=e})).execute()}},{key:"getCellOrNewCellByViewRange",value:function(t){var e=t.rectRange,n=t.callback,o=t.startX,r=void 0===o?0:o,i=t.startY,c=void 0===i?0:i,l=this.rows,a=this.cols,s=this.cells,u=e.sri,f=e.eri,h=e.sci,p=e.eci,y=c;ns.getInstance().setBegin(u).setEnd(f).setLoop((function(t){var e=l.getHeight(t),o=r;as.getInstance().setBegin(h).setEnd(p).setLoop((function(r){var i=s.getCellOrNew(t,r),c=a.getWidth(r);if(i){var l=new dd({x:o,y:y,width:c,height:e});if(!1===n(t,r,i,l))return}o+=c})).execute(),y+=e})).execute()}},{key:"getMergeCellByViewRange",value:function(t){var e=t.rectRange,n=t.callback,o=t.startX,r=void 0===o?0:o,i=t.startY,c=void 0===i?0:i,l=this.rows,a=this.cols,s=this.cells,u=this.merges,f=e.sri,h=e.eri,p=e.sci,y=e.eci,b=[];ns.getInstance().setBegin(f).setEnd(h).setLoop((function(t){as.getInstance().setBegin(p).setEnd(y).setLoop((function(o){var i=u.getFirstIncludes(t,o);if(!S.isUnDef(i)&&!b.find((function(t){return t===i}))){var f=Math.min(e.sri,i.sri),h=Math.min(e.sci,i.sci),p=Math.max(e.sri,i.sri),y=Math.max(e.sci,i.sci);p-=1,y-=1;var d=a.sectionSumWidth(h,y),v=l.sectionSumHeight(f,p);d=e.sci>i.sci?-1*d:d,v=e.sri>i.sri?-1*v:v,d+=r,v+=c;var g=l.sectionSumHeight(i.sri,i.eri),w=a.sectionSumWidth(i.sci,i.eci),m=s.getCellOrNew(i.sri,i.sci),E=new dd({x:d,y:v,width:w,height:g});n(E,m,i),b.push(i)}})).execute()})).execute()}},{key:"getCellSkipMergeCellByViewRange",value:function(t){var e=t.rectRange,n=t.callback,o=t.startX,r=void 0===o?0:o,i=t.startY,c=void 0===i?0:i,l=this.merges;this.getCellByViewRange({rectRange:e,callback:function(t,e,o,r,i){null===l.getFirstIncludes(t,e)&&n(t,e,o,r,i)},startX:r,startY:c})}}])&&yv(n.prototype,o),r&&yv(n,r),e}(hv);function wv(t){return(wv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mv(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ev(t,e){return!e||"object"!==wv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ov(t){return(Ov=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sv(t,e){return(Sv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xv=3,Tv=1,_v=2,kv=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ev(this,Ov(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sv(t,e)}(e,t),n=e,(o=[{key:"getCellByViewRange",value:function(t){var e=this,n=t.reverseRows,o=void 0!==n&&n,r=t.reverseCols,i=void 0!==r&&r,c=t.rectRange,l=void 0===c?new fs(0,0,0,0,0,0):c,a=t.newRow,s=void 0===a?function(){}:a,u=t.newCol,f=void 0===u?function(){}:u,h=t.callback,p=void 0===h?function(){}:h,y=t.startX,b=void 0===y?0:y,d=t.startY,v=void 0===d?0:d,g=this.rows,w=this.cols,m=this.cells,E=l.sri,O=l.eri,S=l.sci,x=l.eci;if(o&&i){var T=v;ns.getInstance().setBegin(O).setEnd(E).setLoop((function(t){var n=g.getHeight(t),o=null,r=b;return s(t),T-=n,as.getInstance().setBegin(x).setEnd(S).setLoop((function(i){var c=w.getWidth(i),l=m.getCell(t,i);if(f(i),r-=c,l){var a=new dd({x:r,y:T,width:c,height:n}),s=e.getCellOverFlow(t,i,a,l);if((o=p(t,i,l,a,s))===Tv)return!1}return!0})).execute(),o!==_v})).execute()}else if(o){var _=v;ns.getInstance().setBegin(O).setEnd(E).setLoop((function(t){var n=g.getHeight(t),o=null,r=b;return s(t),_-=n,as.getInstance().setBegin(S).setEnd(x).setLoop((function(i){var c=w.getWidth(i),l=m.getCell(t,i);if(f(i),l){var a=new dd({x:r,y:_,width:c,height:n}),s=e.getCellOverFlow(t,i,a,l);if((o=p(t,i,l,a,s))===Tv)return!1}return r+=c,!0})).execute(),o!==_v})).execute()}else if(i){var k=v;ns.getInstance().setBegin(E).setEnd(O).setLoop((function(t){var n=g.getHeight(t),o=null,r=b;return s(t),as.getInstance().setBegin(x).setEnd(S).setLoop((function(i){var c=w.getWidth(i),l=m.getCell(t,i);if(f(i),r-=c,l){var a=new dd({x:r,y:k,width:c,height:n}),s=e.getCellOverFlow(t,i,a,l);if((o=p(t,i,l,a,s))===Tv)return!1}return!0})).execute(),k+=n,o!==_v})).execute()}else{var P=v;ns.getInstance().setBegin(E).setEnd(O).setLoop((function(t){var n=g.getHeight(t),o=null,r=b;return s(t),as.getInstance().setBegin(S).setEnd(x).setLoop((function(i){var c=w.getWidth(i),l=m.getCell(t,i);if(f(i),l){var a=new dd({x:r,y:P,width:c,height:n}),s=e.getCellOverFlow(t,i,a,l);if((o=p(t,i,l,a,s))===Tv)return!1}return r+=c,!0})).execute(),P+=n,o!==_v})).execute()}}},{key:"getMergeCellByViewRange",value:function(t){var e=t.rectRange,n=t.callback,o=t.startX,r=void 0===o?0:o,i=t.startY,c=void 0===i?0:i,l=this.rows,a=this.cols,s=this.cells,u=this.merges,f=e.sri,h=e.eri,p=e.sci,y=e.eci,b=[];ns.getInstance().setBegin(f).setEnd(h).setLoop((function(t){as.getInstance().setBegin(p).setEnd(y).setLoop((function(o){var i=u.getFirstIncludes(t,o);if(!S.isUnDef(i)&&!b.find((function(t){return t===i}))){var f=Math.min(e.sri,i.sri),h=Math.min(e.sci,i.sci),p=Math.max(e.sri,i.sri),y=Math.max(e.sci,i.sci);p-=1,y-=1;var d=a.sectionSumWidth(h,y),v=l.sectionSumHeight(f,p);d=e.sci>i.sci?-1*d:d,v=e.sri>i.sri?-1*v:v,d+=r,v+=c;var g=l.sectionSumHeight(i.sri,i.eri),w=a.sectionSumWidth(i.sci,i.eci),m=s.getCellOrNew(i.sri,i.sci),E=new dd({x:d,y:v,width:w,height:g});n(E,m,i),b.push(i)}})).execute()})).execute()}},{key:"getCellSkipMergeCellByViewRange",value:function(t){var e=t.reverseRows,n=t.reverseCols,o=t.rectRange,r=t.newRow,i=t.newCol,c=t.callback,l=t.startX,a=t.startY,s=this.merges;this.getCellByViewRange({reverseRows:e,reverseCols:n,rectRange:o,newRow:r,newCol:i,callback:function(t,e,n,o,r){null===s.getFirstIncludes(t,e)&&c(t,e,n,o,r)},startX:l,startY:a})}}])&&mv(n.prototype,o),r&&mv(n,r),e}(hv);function Pv(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Cv=function(){function t(e){var n=e.merges,o=void 0===n?[]:n,r=e.cols,i=e.rows;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rows=i,this.cols=r,this.data=o.map((function(t){return fs.valueOf(t)})),this.index=new Array(i.len*r.len)}var e,n,o;return e=t,(n=[{key:"getIncludes",value:function(t,e){var n=this,o=this.index,r=this.data;t.each((function(t,i){var c=n.getOffset(t,i),l=o[c];S.isNotUnDef(l)&&e(r[l])}))}},{key:"getOffset",value:function(t,e){return t*this.cols.len+e}},{key:"getFirstIncludes",value:function(t,e){var n=this.index,o=this.data,r=n[this.getOffset(t,e)];if(S.isUnDef(r))return null;var i=o[r];return S.isUnDef(i)?null:i}},{key:"add",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=this.index,r=this.data;n&&this.getIncludes(t,(function(t){return e.delete(t)}));var i=r.length;r.push(t),t.each((function(t,n){var r=e.getOffset(t,n);o[r]=i}))}},{key:"delete",value:function(t){var e=this,n=this.index,o=this.data,r=t.sri,i=t.sci,c=this.getOffset(r,i),l=n[c];S.isUnDef(l)||(o.splice(l,1),t.each((function(t,o){var r=e.getOffset(t,o);n[r]=void 0})),this.sync(l))}},{key:"union",value:function(t){for(var e=this,n=t,o=[],r=function(t){var r=e.data[t];if(o.find((function(t){return t===r})))return i=t,"continue";r.intersects(n)&&(o.push(r),n=r.union(n),t=-1),i=t},i=0;i<this.data.length;i+=1)r(i);return n}},{key:"sync",value:function(){for(var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.index,o=this.data,r=function(e){o[e].each((function(o,r){var i=t.getOffset(o,r);n[i]=e}))},i=e;i<o.length;i+=1)r(i)}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(t){this.data=t}}])&&Pv(e.prototype,n),o&&Pv(e,o),t}();function jv(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Lv=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.callback=e}var e,n,o;return e=t,(n=[{key:"execute",value:function(){return this.callback.apply(this,arguments)}}])&&jv(e.prototype,n),o&&jv(e,o),t}();function Av(t){return(Av="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rv(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Nv(t,e){return!e||"object"!==Av(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vv(t){return(Vv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Iv(t,e){return(Iv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mv=function(t){function e(t){var n,o=t.cells,r=t.cols,i=t.merges;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Nv(this,Vv(e).call(this,(function(t,e){return!!i.getFirstIncludes(e,t-1)||n.master(e,t)&&n.right(e,t)&&n.left(e,t)})))).cells=o,n.cols=r,n.merges=i,n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Iv(t,e)}(e,t),n=e,(o=[{key:"master",value:function(t,e){var n=this.cells,o=this.cols,r=n.getCell(t,e-1),i=n.getCell(t,e);if(S.isUnDef(i)||S.isBlank(i.text))return!0;var c=i.fontAttr,l=!0;if(c.direction===jc.TEXT_DIRECTION.ANGLE){var a=c.angle;90!==a&&-90!==a||(l=!1),c.textWrap===jc.TEXT_WRAP.TRUNCATE&&(l=!1)}else c.textWrap!==jc.TEXT_WRAP.OVER_FLOW&&(l=!1);var s=c.align,u=o.getWidth(e);return s!==jc.ALIGN.right&&s!==jc.ALIGN.center&&(l=!1),!l||!(n.getCellBoundOutSize(t,e)>u&&(S.isUnDef(r)||S.isBlank(r.text)))}},{key:"left",value:function(t,e){var n=this.cells,o=this.cols,r=this.merges,i=n.getCell(t,e),c=!0,l=o.getWidth(e-1);return as.getInstance().setBegin(e-1).setEnd(0).setLoop((function(e){var o=n.getCell(t,e);if(S.isUnDef(o))return!0;var a=r.getFirstIncludes(t,e);if(S.isNotUnDef(a))return!0;var s=o.text;if(S.isBlank(s))return!0;var u=o.fontAttr;if(u.direction===jc.TEXT_DIRECTION.ANGLE){var f=u.angle,h=u.textWrap;if(90===f||-90===f)return!1;if(h===jc.TEXT_WRAP.TRUNCATE)return!1;var p=u.align;if(p!==jc.ALIGN.left&&p!==jc.ALIGN.center)return!1}else{if(u.textWrap!==jc.TEXT_WRAP.OVER_FLOW)return!1;var y=u.align;if(y!==jc.ALIGN.left&&y!==jc.ALIGN.center)return!1}return n.getCellBoundOutSize(t,e)>l&&(S.isUnDef(i)||S.isBlank(i.text))&&(c=!1),!1})).setNext((function(t){l+=o.getWidth(t)})).execute(),c}},{key:"right",value:function(t,e){var n=this.cells,o=this.cols,r=this.merges,i=n.getCell(t,e-1),c=n.getCell(t,e),l=o.len,a=!0,s=o.getWidth(e+1)+o.getWidth(e);return as.getInstance().setBegin(e+1).setEnd(l).setLoop((function(e){var o=n.getCell(t,e);if(S.isUnDef(o))return!0;var l=r.getFirstIncludes(t,e);if(S.isNotUnDef(l))return!0;var u=o.text;if(S.isBlank(u))return!0;var f=o.fontAttr;if(f.direction===jc.TEXT_DIRECTION.ANGLE){var h=f.angle,p=f.textWrap;if(90===h||-90===h)return!1;if(p===jc.TEXT_WRAP.TRUNCATE)return!1;var y=f.align;if(y!==jc.ALIGN.right&&y!==jc.ALIGN.center)return!1}else{if(f.textWrap!==jc.TEXT_WRAP.OVER_FLOW)return!1;var b=f.align;if(b!==jc.ALIGN.right&&b!==jc.ALIGN.center)return!1}if(n.getCellBoundOutSize(t,e)>s){var d=S.isUnDef(c)||S.isBlank(c.text),v=S.isUnDef(i)||S.isBlank(i.text);d&&v&&(a=!1)}return!1})).setNext((function(t){s+=o.getWidth(t)})).execute(),a}}])&&Rv(n.prototype,o),r&&Rv(n,r),e}(Lv);function Dv(t){return(Dv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bv(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Hv(t,e){return!e||"object"!==Dv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wv(t){return(Wv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fv(t,e){return(Fv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yv=function(t){function e(t){var n,o=t.cells,r=t.cols,i=t.merges;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Hv(this,Wv(e).call(this,(function(t,e){return!!i.getFirstIncludes(e,t+1)||n.master(e,t)&&n.right(e,t)&&n.left(e,t)})))).cells=o,n.cols=r,n.merges=i,n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fv(t,e)}(e,t),n=e,(o=[{key:"master",value:function(t,e){var n=this.cells,o=this.cols,r=n.getCell(t,e+1),i=n.getCell(t,e);if(S.isUnDef(i)||S.isBlank(i.text))return!0;var c=i.fontAttr,l=!0;if(c.direction===jc.TEXT_DIRECTION.ANGLE){var a=c.angle;90!==a&&-90!==a||(l=!1),c.textWrap===jc.TEXT_WRAP.TRUNCATE&&(l=!1)}else c.textWrap!==jc.TEXT_WRAP.OVER_FLOW&&(l=!1);var s=c.align,u=o.getWidth(e);return s!==jc.ALIGN.left&&s!==jc.ALIGN.center&&(l=!1),!l||!(n.getCellBoundOutSize(t,e)>u&&(S.isUnDef(r)||S.isBlank(r.text)))}},{key:"left",value:function(t,e){var n=this.cells,o=this.cols,r=this.merges,i=n.getCell(t,e+1),c=n.getCell(t,e),l=!0,a=o.getWidth(e-1)+o.getWidth(e);return as.getInstance().setBegin(e-1).setEnd(0).setLoop((function(e){var o=n.getCell(t,e);if(S.isUnDef(o))return!0;var s=r.getFirstIncludes(t,e);if(S.isNotUnDef(s))return!0;var u=o.text;if(S.isBlank(u))return!0;var f=o.fontAttr;if(f.direction===jc.TEXT_DIRECTION.ANGLE){var h=f.angle,p=f.textWrap;if(90===h||-90===h)return!1;if(p===jc.TEXT_WRAP.TRUNCATE)return!1;var y=f.align;if(y!==jc.ALIGN.left&&y!==jc.ALIGN.center)return!1}else{if(f.textWrap!==jc.TEXT_WRAP.OVER_FLOW)return!1;var b=f.align;if(b!==jc.ALIGN.left&&b!==jc.ALIGN.center)return!1}if(n.getCellBoundOutSize(t,e)>a){var d=S.isUnDef(c)||S.isBlank(c.text),v=S.isUnDef(i)||S.isBlank(i.text);d&&v&&(l=!1)}return!1})).setNext((function(t){a+=o.getWidth(t)})).execute(),l}},{key:"right",value:function(t,e){var n=this.cells,o=this.cols,r=this.merges,i=n.getCell(t,e),c=o.len,l=!0,a=o.getWidth(e+1);return as.getInstance().setBegin(e+1).setEnd(c).setLoop((function(e){var o=n.getCell(t,e);if(S.isUnDef(o))return!0;var c=r.getFirstIncludes(t,e);if(S.isNotUnDef(c))return!0;var s=o.text;if(S.isBlank(s))return!0;var u=o.fontAttr;if(u.direction===jc.TEXT_DIRECTION.ANGLE){var f=u.angle,h=u.textWrap;if(90===f||-90===f)return!1;if(h===jc.TEXT_WRAP.TRUNCATE)return!1;var p=u.align;if(p!==jc.ALIGN.right&&p!==jc.ALIGN.center)return!1}else{if(u.textWrap!==jc.TEXT_WRAP.OVER_FLOW)return!1;var y=u.align;if(y!==jc.ALIGN.right&&y!==jc.ALIGN.center)return!1}return n.getCellBoundOutSize(t,e)>a&&(null===i||S.isBlank(i.text))&&(l=!1),!1})).setNext((function(t){a+=o.getWidth(t)})).execute(),l}}])&&Bv(n.prototype,o),r&&Bv(n,r),e}(Lv);function Gv(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var zv=function(){function t(e){var n=e.merges,o=e.rows,r=e.cols,i=e.cells,c=e.foldOnOff,l=void 0===c||c;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.merges=n,this.cells=i,this.rows=o,this.cols=r,this.foldOnOff=l,this.rightOutRangeFilter=new Yv({cells:i,cols:r,merges:n}),this.leftOutRangeFilter=new Mv({cells:i,cols:r,merges:n})}var e,n,o;return e=t,(n=[{key:"getMergeCoincideRange",value:function(t){var e=t.viewRange,n=void 0===e?new fs(0,0,0,0):e,o=this.merges,r=this.cols,i=this.rows,c=[],l=[];return this.horizontalIterate({viewRange:n,filter:new Lv((function(t,e){var n=o.getFirstIncludes(t,e);return S.isNotUnDef(n)&&-1===c.indexOf(n)})),handle:function(t,e,a,s){var u=o.getFirstIncludes(t,e);c.push(u);var f=n.coincide(u),h=r.sectionSumWidth(f.sci,f.eci),p=i.sectionSumHeight(f.sri,f.eri),y=new dd({x:a,y:s,width:h,height:p});l.push({rect:y,view:f,merge:u})}}),l}},{key:"getCoincideRangeBrink",value:function(t){for(var e=t.coincide,n=void 0===e?new fs(0,0,0,0):e,o=this.cols,r=this.rows,i=[],c=0;c<n.length;c+=1){var l=n[c],a=l.view,s=l.rect,u=l.merge,f=a.brink(),h={view:f.top,x:s.x,y:s.y},p={view:f.left,x:s.x,y:s.y},y={view:f.bottom,x:s.x,y:s.y+s.height-r.rectRangeSumHeight(f.bottom)},b={view:f.right,x:s.x+s.width-o.rectRangeSumWidth(f.right),y:s.y},d={};u.sri===a.sri&&(d.top=h),u.sci===a.sci&&(d.left=p),u.eri===a.eri&&(d.bottom=y),u.eci===a.eci&&(d.right=b),i.push(d)}return i}},{key:"horizontalIterate",value:function(t){var e=t.viewRange,n=void 0===e?new fs(0,0,0,0):e,o=t.newRow,r=void 0===o?function(){return!0}:o,i=t.filter,c=void 0===i?new Lv((function(){return!0})):i,l=t.jump,a=void 0===l?function(){return!0}:l,s=t.handle,u=void 0===s?function(){return!0}:s,f=t.endRow,h=void 0===f?function(){return!0}:f,p=t.bx,y=void 0===p?0:p,b=t.by,d=void 0===b?0:b,v=this.cols,g=this.rows,w=this.foldOnOff,m=n.sri,E=n.eri,O=n.sci,S=n.eci,x=d;ns.getInstance().setBegin(m).setEnd(E).setLoop((function(t){var e=g.getHeight(t),n=y;r(t,x),as.getInstance().setBegin(O).setEnd(S).setLoop((function(e){var o=c.execute(t,e,n,x),r=v.getWidth(e);o?u(t,e,n,x):a(t,e,n,x),n+=r})).execute(),h(),x+=e})).foldOnOff(w).execute()}},{key:"verticalIterate",value:function(t){var e=t.viewRange,n=void 0===e?new fs(0,0,0,0):e,o=t.newCol,r=void 0===o?function(){return!0}:o,i=t.filter,c=void 0===i?new Lv((function(){return!0})):i,l=t.jump,a=void 0===l?function(){return!0}:l,s=t.handle,u=void 0===s?function(){return!0}:s,f=t.endCol,h=void 0===f?function(){return!0}:f,p=t.bx,y=void 0===p?0:p,b=t.by,d=void 0===b?0:b,v=this.cols,g=this.rows,w=this.foldOnOff,m=n.sri,E=n.eri,O=n.sci,S=n.eci,x=y;as.getInstance().setBegin(O).setEnd(S).setLoop((function(t){var e=v.getWidth(t),n=d;r(t,x),ns.getInstance().setBegin(m).setEnd(E).setLoop((function(e){var o=g.getHeight(e);c.execute(t,e,x,n)?u(t,e,x,n):a(t,e,x,n),n+=o})).foldOnOff(w).execute(),h(),x+=e})).execute()}}])&&Gv(e.prototype,n),o&&Gv(e,o),t}();function Uv(t){return(Uv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xv(t,e){return!e||"object"!==Uv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Kv(t){return(Kv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zv(t,e){return(Zv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $v=function(t){function e(t){var n=t.merges;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Xv(this,Kv(e).call(this,(function(t,e){return null===n.getFirstIncludes(t,e)})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zv(t,e)}(e,t),e}(Lv);function qv(t){return(qv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jv(t,e){return!e||"object"!==qv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qv(t){return(Qv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tg(t,e){return(tg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var eg=function(t){function e(t){var n=t.merges;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Jv(this,Qv(e).call(this,(function(t,e){return null===n.getFirstIncludes(e,t)})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tg(t,e)}(e,t),e}(Lv);function ng(t){return(ng="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function og(t,e){return!e||"object"!==ng(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function rg(t){return(rg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ig(t,e){return(ig=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var cg=function(t){function e(t){var n=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),og(this,rg(e).call(this,(function(t,e){var o=n.getCell(t+1,e),r=n.getCell(t,e),i=!1;return r&&!i&&(i=r.borderAttr.bottom.display),o&&!i&&(i=o.borderAttr.top.display),!i})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ig(t,e)}(e,t),e}(Lv);function lg(t){return(lg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ag(t,e){return!e||"object"!==lg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function sg(t){return(sg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ug(t,e){return(ug=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fg=function(t){function e(t){var n=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ag(this,sg(e).call(this,(function(t,e){var o=n.getCell(e,t+1),r=n.getCell(e,t),i=!1;return r&&!i&&(i=r.borderAttr.right.display),o&&!i&&(i=o.borderAttr.left.display),!i})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ug(t,e)}(e,t),e}(Lv);function hg(t){return(hg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pg(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function yg(t,e){return!e||"object"!==hg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bg(t){return(bg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dg(t,e){return(dg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vg=function(t){function e(t){var n,o=t.merges,r=t.rows,i=t.cols,c=t.cells,l=t.drawCheck,a=void 0!==l&&l,s=t.foldOnOff,u=void 0===s||s,f=t.getHeight,h=void 0===f?function(t){return r.getHeight(t)}:f,p=t.getWidth,y=void 0===p?function(t){return i.getWidth(t)}:p;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=yg(this,bg(e).call(this,{merges:o,rows:r,cols:i,cells:c,foldOnOff:u}))).drawCheck=a,n.getHeight=h,n.getWidth=y,n.horizontalBorderDisplayFilter=new cg({cells:c}),n.verticalBorderDisplayFilter=new fg({cells:c}),n.horizontalMergeFilter=new $v({merges:o}),n.verticalMergeFilter=new eg({merges:o}),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dg(t,e)}(e,t),n=e,(o=[{key:"computerHorizontalLine",value:function(t){var e,n,o,r,i,c=t.viewRange,l=t.bx,a=void 0===l?0:l,s=t.by,u=void 0===s?0:s,f=t.filter,h=this.getWidth,p=this.getHeight,y=[];return this.horizontalIterate({viewRange:c,newRow:function(t,c){var l=p(t);o=e=a,r=n=u+c+l,i=!1},filter:f,jump:function(t,c){i&&(i=!1,y.push({sx:e,sy:n,ex:o,ey:r}));var l=h(c);o=e=o+l},handle:function(t,e){i=!0;var n=h(e);o+=n},endRow:function(){i&&y.push({sx:e,sy:n,ex:o,ey:r})}}),y}},{key:"computerVerticalLine",value:function(t){var e,n,o,r,i,c=t.viewRange,l=t.bx,a=void 0===l?0:l,s=t.by,u=void 0===s?0:s,f=t.filter,h=this.getWidth,p=this.getHeight,y=[];return this.verticalIterate({viewRange:c,newCol:function(t,c){var l=h(t);o=e=a+c+l,r=n=u,i=!1},filter:f,jump:function(t,c){i&&(i=!1,y.push({sx:e,sy:n,ex:o,ey:r}));var l=p(c);r=n=r+l},handle:function(t,e){i=!0;var n=p(e);r+=n},endCol:function(){i&&y.push({sx:e,sy:n,ex:o,ey:r})}}),y}}])&&pg(n.prototype,o),r&&pg(n,r),e}(zv);function gg(t){return(gg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wg(t,e){return!e||"object"!==gg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mg(t){return(mg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Eg(t,e){return(Eg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Og={AND:Symbol("and"),OR:Symbol("or")},Sg=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),wg(this,mg(e).call(this,(function(){var e;if(t===Og.AND){e=!0;var o=!0,r=!1,i=void 0;try{for(var c,l=n[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var a=c.value;if(!1===a.execute.apply(a,arguments)){e=!1;break}}}catch(t){r=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}}else{e=!1;var s=!0,u=!1,f=void 0;try{for(var h,p=n[Symbol.iterator]();!(s=(h=p.next()).done);s=!0){var y=h.value;if(!0===y.execute.apply(y,arguments)){e=!0;break}}}catch(t){u=!0,f=t}finally{try{s||null==p.return||p.return()}finally{if(u)throw f}}}return e})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Eg(t,e)}(e,t),e}(Lv);function xg(t){return(xg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tg(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _g(t,e){return!e||"object"!==xg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kg(t){return(kg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pg(t,e){return(Pg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Cg=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),_g(this,kg(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pg(t,e)}(e,t),n=e,(o=[{key:"getHorizontalLine",value:function(t){var e=t.viewRange,n=this.horizontalMergeFilter,o=this.horizontalBorderDisplayFilter;return this.drawCheck?this.computerHorizontalLine({viewRange:e,filter:new Sg(Og.AND,[n,o])}):this.computerHorizontalLine({viewRange:e})}},{key:"getMergeHorizontalLine",value:function(t){var e=t.brink,n=[],o=this.horizontalBorderDisplayFilter;if(this.drawCheck)for(var r=0;r<e.length;r+=1){var i=e[r].bottom;if(i){var c=i.view,l=i.x,a=i.y,s=this.computerHorizontalLine({viewRange:c,bx:l,by:a,filter:o});n=n.concat(s)}}else for(var u=0;u<e.length;u+=1){var f=e[u].bottom;if(f){var h=f.view,p=f.x,y=f.y,b=this.computerHorizontalLine({viewRange:h,bx:p,by:y});n=n.concat(b)}}return n}}])&&Tg(n.prototype,o),r&&Tg(n,r),e}(vg);function jg(t){return(jg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lg(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ag(t,e){return!e||"object"!==jg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rg(t){return(Rg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ng(t,e){return(Ng=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vg=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ag(this,Rg(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ng(t,e)}(e,t),n=e,(o=[{key:"getVerticalLine",value:function(t){var e=t.viewRange,n=this.verticalMergeFilter,o=this.verticalBorderDisplayFilter,r=this.rightOutRangeFilter;return this.drawCheck?this.computerVerticalLine({viewRange:e,filter:new Sg(Og.AND,[n,o,r])}):this.computerVerticalLine({viewRange:e})}},{key:"getMergeVerticalLine",value:function(t){var e=t.brink,n=[],o=this.verticalBorderDisplayFilter;if(this.drawCheck)for(var r=0;r<e.length;r+=1){var i=e[r].right;if(i){var c=i.view,l=i.x,a=i.y,s=this.computerVerticalLine({viewRange:c,bx:l,by:a,filter:o});n=n.concat(s)}}else for(var u=0;u<e.length;u+=1){var f=e[u].right;if(f){var h=f.view,p=f.x,y=f.y,b=this.computerVerticalLine({viewRange:h,bx:p,by:y});n=n.concat(b)}}return n}}])&&Lg(n.prototype,o),r&&Lg(n,r),e}(vg);function Ig(t){return(Ig="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mg(t,e){return!e||"object"!==Ig(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dg(t){return(Dg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bg(t,e){return(Bg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hg=function(t){function e(t){var n=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Mg(this,Dg(e).call(this,(function(t,e){var o=n.getCell(t+1,e),r=n.getCell(t,e);if(S.isUnDef(r))return!1;var i=r.borderAttr.bottom;if(S.isUnDef(o))return i.display;var c=o.borderAttr.top;if(!c.display)return i.display;var l=i.priority(c);return 1===l||0===l})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bg(t,e)}(e,t),e}(Lv);function Wg(t){return(Wg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fg(t,e){return!e||"object"!==Wg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yg(t){return(Yg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gg(t,e){return(Gg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zg=function(t){function e(t){var n=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Fg(this,Yg(e).call(this,(function(t,e){var o=n.getCell(e,t-1),r=n.getCell(e,t);if(S.isUnDef(r))return!1;var i=r.borderAttr.left;if(S.isUnDef(o))return i.display;var c=o.borderAttr.right;return c.display?1===i.priority(c):i.display})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gg(t,e)}(e,t),e}(Lv);function Ug(t){return(Ug="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xg(t,e){return!e||"object"!==Ug(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Kg(t){return(Kg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zg(t,e){return(Zg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $g=function(t){function e(t){var n=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Xg(this,Kg(e).call(this,(function(t,e){var o=n.getCell(e,t+1),r=n.getCell(e,t);if(S.isUnDef(r))return!1;var i=r.borderAttr.right;if(S.isUnDef(o))return i.display;var c=o.borderAttr.left;if(!c.display)return i.display;var l=i.priority(c);return 1===l||0===l})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zg(t,e)}(e,t),e}(Lv);function qg(t){return(qg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jg(t,e){return!e||"object"!==qg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qg(t){return(Qg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tw(t,e){return(tw=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ew=function(t){function e(t){var n=t.cells;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Jg(this,Qg(e).call(this,(function(t,e){var o=n.getCell(t-1,e),r=n.getCell(t,e);if(S.isUnDef(r))return!1;var i=r.borderAttr.top;if(S.isUnDef(o))return i.display;var c=o.borderAttr.bottom;return c.display?1===i.priority(c):i.display})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tw(t,e)}(e,t),e}(Lv);function nw(t){return(nw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ow(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function rw(t,e){return!e||"object"!==nw(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function iw(t){return(iw=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cw(t,e){return(cw=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var lw=function(t){function e(t){var n,o=t.drawOptimization,r=void 0!==o&&o,i=t.merges,c=t.rows,l=t.cols,a=t.cells,s=t.foldOnOff,u=void 0===s||s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=rw(this,iw(e).call(this,{merges:i,rows:c,cols:l,cells:a,foldOnOff:u}))).drawOptimization=r,n.horizontalMergeFilter=new $v({merges:i}),n.verticalMergeFilter=new eg({merges:i}),n.bottomBorderDiffFilter=new Hg({cells:a}),n.leftBorderDiffFilter=new zg({cells:a}),n.rightBorderDiffFilter=new $g({cells:a}),n.topBorderDiffFilter=new ew({cells:a}),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cw(t,e)}(e,t),n=e,(o=[{key:"computerTopHorizontalLine",value:function(t){var e,n,o,r,i=t.viewRange,c=void 0===i?null:i,l=t.bx,a=void 0===l?0:l,s=t.by,u=void 0===s?0:s,f=t.filter,h=void 0===f?null:f,p=this.drawOptimization,y=this.cols,b=this.cells,d=[];if(this.horizontalIterate({viewRange:c,newRow:function(t,i){o=e=a,r=n=u+i},filter:h,jump:function(t,n){var r=y.getWidth(n);o=e=o+r},handle:function(t,i){var c=y.getWidth(i),l=b.getCell(t,i).borderAttr;o+=c,d.push({sx:e,sy:n,ex:o,ey:r,row:t,col:i,borderAttr:l}),e=o}}),p)for(var v=1;v<d.length;){var g=d[v],w=d[v-1],m=g.borderAttr.top.equal(w.borderAttr.top),E=g.col-w.col==1,O=g.row===w.row;m&&E&&O?(w.ex=g.ex,w.col=g.col,d.splice(v,1)):v+=1}return d}},{key:"computerBottomHorizontalLine",value:function(t){var e,n,o,r,i=t.viewRange,c=void 0===i?null:i,l=t.bx,a=void 0===l?0:l,s=t.by,u=void 0===s?0:s,f=t.filter,h=void 0===f?null:f,p=this.drawOptimization,y=this.cols,b=this.rows,d=this.cells,v=[];if(this.horizontalIterate({viewRange:c,newRow:function(t,i){var c=b.getHeight(t);o=e=a,r=n=u+i+c},filter:h,jump:function(t,n){var r=y.getWidth(n);o=e=o+r},handle:function(t,i){var c=y.getWidth(i),l=d.getCell(t,i).borderAttr;o+=c,v.push({sx:e,sy:n,ex:o,ey:r,row:t,col:i,borderAttr:l}),e=o}}),p)for(var g=1;g<v.length;){var w=v[g],m=v[g-1],E=w.borderAttr.bottom.equal(m.borderAttr.bottom),O=w.col-m.col==1,S=w.row===m.row;E&&O&&S?(m.ex=w.ex,m.col=w.col,v.splice(g,1)):g+=1}return v}},{key:"computerLeftVerticalLine",value:function(t){var e,n,o,r,i=t.viewRange,c=void 0===i?null:i,l=t.bx,a=void 0===l?0:l,s=t.by,u=void 0===s?0:s,f=t.filter,h=void 0===f?null:f,p=this.drawOptimization,y=this.rows,b=this.cells,d=[];if(this.verticalIterate({viewRange:c,newCol:function(t,i){o=e=a+i,r=n=u},filter:h,jump:function(t,e){var o=y.getHeight(e);r=n=r+o},handle:function(t,i){var c=y.getHeight(i),l=b.getCell(i,t).borderAttr;r+=c,d.push({sx:e,sy:n,ex:o,ey:r,row:i,col:t,borderAttr:l}),n=r}}),p)for(var v=1;v<d.length;){var g=d[v],w=d[v-1],m=ns.getInstance().setBegin(w.row).setEnd(g.row).nextRow(),E=g.borderAttr.left.equal(w.borderAttr.left),O=g.row===m,S=g.col===w.col;E&&O&&S?(w.ey=g.ey,w.row=g.row,d.splice(v,1)):v+=1}return d}},{key:"computerRightVerticalLine",value:function(t){var e,n,o,r,i=t.viewRange,c=void 0===i?null:i,l=t.bx,a=void 0===l?0:l,s=t.by,u=void 0===s?0:s,f=t.filter,h=void 0===f?null:f,p=this.drawOptimization,y=this.rows,b=this.cols,d=this.cells,v=[];if(this.verticalIterate({viewRange:c,newCol:function(t,i){var c=b.getWidth(t);o=e=a+i+c,r=n=u},filter:h,jump:function(t,e){var o=y.getHeight(e);r=n=r+o},handle:function(t,i){var c=y.getHeight(i),l=d.getCell(i,t).borderAttr;r+=c,v.push({sx:e,sy:n,ex:o,ey:r,row:i,col:t,borderAttr:l}),n=r}}),p)for(var g=1;g<v.length;){var w=v[g],m=v[g-1],E=ns.getInstance().setBegin(m.row).setEnd(w.row).nextRow(),O=w.borderAttr.right.equal(m.borderAttr.right),S=w.row===E,x=w.col===m.col;O&&S&&x?(m.ey=w.ey,m.row=w.row,v.splice(g,1)):g+=1}return v}},{key:"disableOptimization",value:function(){this.drawOptimization=!1}},{key:"enableOptimization",value:function(){this.drawOptimization=!0}}])&&ow(n.prototype,o),r&&ow(n,r),e}(zv);function aw(t){return(aw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function uw(t,e){return!e||"object"!==aw(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fw(t){return(fw=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hw(t,e){return(hw=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pw=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),uw(this,fw(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hw(t,e)}(e,t),n=e,(o=[{key:"getBottomHorizontalLine",value:function(t){var e=t.viewRange,n=this.horizontalMergeFilter,o=this.bottomBorderDiffFilter;return this.computerBottomHorizontalLine({viewRange:e,filter:new Sg(Og.AND,[n,o])})}},{key:"getTopHorizontalLine",value:function(t){var e=t.viewRange,n=this.horizontalMergeFilter,o=this.topBorderDiffFilter;return this.computerTopHorizontalLine({viewRange:e,filter:new Sg(Og.AND,[n,o])})}},{key:"getBottomMergeHorizontalLine",value:function(t){for(var e=t.brink,n=this.bottomBorderDiffFilter,o=[],r=0;r<e.length;r+=1){var i=e[r].bottom;if(i){var c=this.computerBottomHorizontalLine({viewRange:i.view,bx:i.x,by:i.y,filter:n});o=o.concat(c)}}return o}},{key:"getTopMergeHorizontalLine",value:function(t){for(var e=t.brink,n=this.topBorderDiffFilter,o=[],r=0;r<e.length;r+=1){var i=e[r].top;if(i){var c=this.computerTopHorizontalLine({viewRange:i.view,bx:i.x,by:i.y,filter:n});o=o.concat(c)}}return o}}])&&sw(n.prototype,o),r&&sw(n,r),e}(lw);function yw(t){return(yw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function dw(t,e){return!e||"object"!==yw(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vw(t){return(vw=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gw(t,e){return(gw=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ww=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),dw(this,vw(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gw(t,e)}(e,t),n=e,(o=[{key:"getRightVerticalLine",value:function(t){var e=t.viewRange,n=this.verticalMergeFilter,o=this.rightBorderDiffFilter,r=this.rightOutRangeFilter;return this.computerRightVerticalLine({viewRange:e,filter:new Sg(Og.AND,[n,o,r])})}},{key:"getLeftVerticalLine",value:function(t){var e=t.viewRange,n=this.verticalMergeFilter,o=this.leftBorderDiffFilter,r=this.leftOutRangeFilter;return this.computerLeftVerticalLine({viewRange:e,filter:new Sg(Og.AND,[n,o,r])})}},{key:"getRightMergeVerticalLine",value:function(t){for(var e=t.brink,n=this.rightBorderDiffFilter,o=[],r=0;r<e.length;r+=1){var i=e[r].right;if(i){var c=this.computerRightVerticalLine({viewRange:i.view,bx:i.x,by:i.y,filter:n});o=o.concat(c)}}return o}},{key:"getLeftMergeVerticalLine",value:function(t){for(var e=t.brink,n=this.leftBorderDiffFilter,o=[],r=0;r<e.length;r+=1){var i=e[r].left;if(i){var c=this.computerLeftVerticalLine({viewRange:i.view,bx:i.x,by:i.y,filter:n});o=o.concat(c)}}return o}}])&&bw(n.prototype,o),r&&bw(n,r),e}(lw);function mw(t){return(mw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ew(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ow(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Sw(t,e){return!e||"object"!==mw(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xw(t,e,n){return(xw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Tw(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Tw(t){return(Tw=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _w(t,e){return(_w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kw=function(t){function e(t){var n,o=t.xTableScrollView,r=t.rows,i=t.cols,c=t.scroll;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Sw(this,Tw(e).call(this,{xTableScrollView:o,rows:r,cols:i,scroll:c}))).lastScrollView=null,n.enterView=null,n.scrollEnterView=null,n.leaveView=null,n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_w(t,e)}(e,t),n=e,(o=[{key:"reset",value:function(){xw(Tw(e.prototype),"reset",this).call(this),this.scrollEnterView=null,this.enterView=null,this.leaveView=null}},{key:"getLastScrollView",value:function(){return S.isNotUnDef(this.lastScrollView)?this.lastScrollView.clone():null}},{key:"getLeaveView",value:function(){if(S.isNotUnDef(this.leaveView))return this.leaveView.clone();var t=this.getLastScrollView(),e=this.getScrollView(),n=this.cols,o=this.rows;if(t){var r=Ew(t.coincideDifference(e),1)[0];if(r)return r.w=n.rectRangeSumWidth(r),r.h=o.rectRangeSumHeight(r),this.leaveView=r,r.clone()}return null}},{key:"getEnterView",value:function(){if(S.isNotUnDef(this.enterView))return this.enterView.clone();var t=this.getLastScrollView(),e=this.getScrollView(),n=this.cols,o=this.rows;if(t){var r=Ew(e.coincideDifference(t),1)[0];if(r)return r.w=n.rectRangeSumWidth(r),r.h=o.rectRangeSumHeight(r),this.enterView=r,r.clone()}return null}},{key:"getScrollEnterView",value:function(){if(S.isNotUnDef(this.scrollEnterView))return this.scrollEnterView.clone();var t=this.cols,e=this.rows,n=this.scroll,o=this.getEnterView();if(o){switch(n.type){case fb.H_RIGHT:o.sci-=1;break;case fb.V_BOTTOM:o.sri-=1;break;case fb.H_LEFT:o.eci+=1;break;case fb.V_TOP:o.eri+=1}return o.w=t.rectRangeSumWidth(o),o.h=e.rectRangeSumHeight(o),this.scrollEnterView=o,o.clone()}return null}},{key:"undo",value:function(){this.lastScrollView=null}},{key:"record",value:function(){this.lastScrollView=this.scrollView}}])&&Ow(n.prototype,o),r&&Ow(n,r),e}(rd);function Pw(t){return(Pw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function jw(t,e){return!e||"object"!==Pw(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lw(t){return(Lw=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Aw(t,e){return(Aw=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rw=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),jw(this,Lw(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Aw(t,e)}(e,t),n=e,(o=[{key:"getCellOrNewCellByViewRange",value:function(t){var e=t.rectRange,n=void 0===e?new fs(-1,-1,-1,-1):e,o=t.callback,r=void 0===o?function(){}:o,i=this.cells,c=n.sri,l=n.eri,a=n.sci,s=n.eci;ns.getInstance().setBegin(c).setEnd(l).setLoop((function(t){as.getInstance().setBegin(a).setEnd(s).setLoop((function(e){var n=i.getCellOrNew(t,e);r(t,e,n)})).execute()})).execute()}}])&&Cw(n.prototype,o),r&&Cw(n,r),e}(hv);function Nw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Vw=function(){function t(e){var n=e.rows,o=e.cols,r=e.fixedView;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fixedView=r,this.cols=o,this.rows=n}var e,n,o;return e=t,(n=[{key:"getHeight",value:function(){return this.rows.rectRangeSumHeight(this.fixedView.getFixedView())}},{key:"getWidth",value:function(){return this.cols.rectRangeSumWidth(this.fixedView.getFixedView())}}])&&Nw(e.prototype,n),o&&Nw(e,o),t}();function Iw(t){return(Iw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mw(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Dw(t,e){return!e||"object"!==Iw(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bw(t){return(Bw=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hw(t,e){return(Hw=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ww(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fw(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Yw(t,e,n){return e&&Fw(t.prototype,e),n&&Fw(t,n),t}var Gw=function(){function t(e){var n=e.targetViewRange,o=e.originViewRange,r=e.merge,i=void 0===r?function(){}:r,c=e.master,l=void 0===c?function(){}:c,a=e.onCopy,s=void 0===a?function(){}:a;Ww(this,t),this.targetViewRange=n,this.originViewRange=o,this.master=l,this.merge=i,this.onCopy=s}return Yw(t,[{key:"copyStartRow",value:function(){return this.originViewRange.sri}},{key:"copyEndRow",value:function(){return this.originViewRange.eri}},{key:"nextCopyRow",value:function(t){return t>=this.copyEndRow()?this.copyStartRow():t+1}},{key:"copyStartCol",value:function(){return this.originViewRange.sci}},{key:"copyEndCol",value:function(){return this.originViewRange.eci}},{key:"nextCopyCol",value:function(t){return t>=this.copyEndCol()?this.copyStartCol():t+1}},{key:"pasteStartRow",value:function(){return this.targetViewRange.sri}},{key:"pasteEndRow",value:function(){return this.targetViewRange.eri}},{key:"pasteStartCol",value:function(){return this.targetViewRange.sci}},{key:"pasteEndCol",value:function(){return this.targetViewRange.eci}},{key:"executeCopy",value:function(){var t=this,e=this.copyStartRow();ns.getInstance().setBegin(this.pasteStartRow()).setEnd(this.pasteEndRow()).setLoop((function(n){var o=t.copyStartCol();as.getInstance().setBegin(t.pasteStartCol()).setEnd(t.pasteEndCol()).setLoop((function(r){var i=t.merge(e,o);i&&t.master(e,o,i)&&t.onCopy(n,r,i)})).setNext((function(){o=t.nextCopyCol(o)})).execute()})).setNext((function(){e=t.nextCopyRow(e)})).foldOnOff(!1).execute()}}]),t}(),zw=function(){function t(e){var n=e.targetViewRange,o=e.originViewRange,r=e.onCopy,i=void 0===r?function(){}:r;Ww(this,t),this.targetViewRange=n,this.originViewRange=o,this.onCopy=i}return Yw(t,[{key:"copyStartRow",value:function(){var t=this.originViewRange,e=t.sri,n=t.eri;return ns.getInstance().setBegin(e-1).setEnd(n).nextRow()}},{key:"copyEndRow",value:function(){var t=this.originViewRange,e=t.sri,n=t.eri;return ns.getInstance().setBegin(n+1).setEnd(e).nextRow()}},{key:"nextCopyRow",value:function(t){var e=this.copyEndRow();return t>=e?this.copyStartRow():ns.getInstance().setBegin(t).setEnd(e).nextRow()}},{key:"copyStartCol",value:function(){return this.originViewRange.sci}},{key:"copyEndCol",value:function(){return this.originViewRange.eci}},{key:"nextCopyCol",value:function(t){return t>=this.copyEndCol()?this.copyStartCol():t+1}},{key:"pasteStartRow",value:function(){return this.targetViewRange.sri}},{key:"pasteEndRow",value:function(){return this.targetViewRange.eri}},{key:"pasteStartCol",value:function(){return this.targetViewRange.sci}},{key:"pasteEndCol",value:function(){return this.targetViewRange.eci}},{key:"executeCopy",value:function(){var t=this,e=this.copyStartRow();ns.getInstance().setBegin(this.pasteStartRow()).setEnd(this.pasteEndRow()).setLoop((function(n){var o=t.copyStartCol();as.getInstance().setBegin(t.pasteStartCol()).setEnd(t.pasteEndCol()).setLoop((function(r){t.onCopy(n,r,e,o)})).setNext((function(){o=t.nextCopyCol(o)})).execute()})).setNext((function(){e=t.nextCopyRow(e)})).execute()}}]),t}(),Uw=function(t){function e(){return Ww(this,e),Dw(this,Bw(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hw(t,e)}(e,t),Yw(e,[{key:"copyCellINContent",value:function(t){var e=t.originViewRange,n=t.targetViewRange,o=this.cells,r=this.tableDataSnapshot.cellDataProxy;new zw({originViewRange:e,targetViewRange:n,onCopy:function(t,e,n,i){var c=o.getCell(n,i);if(c){var l=c.clone();r.setCell(t,e,l)}}}).executeCopy()}},{key:"copyMergeContent",value:function(t){var e=t.originViewRange,n=t.targetViewRange,o=this.merges,r=this.tableDataSnapshot.mergeDataProxy;new Gw({originViewRange:e,targetViewRange:n,merge:function(t,e){return o.getFirstIncludes(t,e)},master:function(t,e,n){return n.sri===t&&n.sci===e},onCopy:function(t,e,n){var i=Mw(n.size(),2),c=i[0],l=i[1],a=new fs(t,e,t+(c-=1),e+(l-=1));ns.getInstance().setBegin(a.sri).setEnd(a.eri).hasFold()||(a.each((function(t,e){var n=o.getFirstIncludes(t,e);n&&r.deleteMerge(n)})),r.addMerge(a))}}).executeCopy()}},{key:"copyStylesContent",value:function(t){var e=t.originViewRange,n=t.targetViewRange,o=this.cells,r=this.tableDataSnapshot.cellDataProxy;new zw({originViewRange:e,targetViewRange:n,onCopy:function(t,e,n,i){var c=o.getCell(n,i);if(c){var l=o.getCellOrNew(t,e),a=c.clone();a.text=l.text,r.setCell(t,e,a)}}}).executeCopy()}}]),e}(hv);function Xw(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Kw(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xw(Object(n),!0).forEach((function(e){Zw(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xw(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Zw(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $w(t,e,n){return($w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=tm(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function qw(t){return(qw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jw(t,e){return!e||"object"!==qw(e)&&"function"!=typeof e?Qw(t):e}function Qw(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tm(t){return(tm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function em(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nm(t,e)}function nm(t,e){return(nm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function om(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rm(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function im(t,e,n){return e&&rm(t.prototype,e),n&&rm(t,n),t}var cm={SCROLL:Symbol("scroll"),RENDER:Symbol("render"),SCALE:Symbol("scale")},lm=function(){function t(e){om(this,t),this.table=e}return im(t,[{key:"draw",value:function(){var t=this.table,e=t.draw,n=t.indexGrid,o=t.index,r=o.getHeight(),i=o.getWidth();e.save(),e.offset(0,0),e.attr({fillStyle:"#f4f5f8"}),e.fillRect(0,0,o.getWidth(),r),e.offset(0,0),n.horizonLine(0,r,i,r),n.verticalLine(i,0,i,r),e.restore()}},{key:"render",value:function(){var t=this.table.getRenderMode();t!==cm.RENDER&&t!==cm.SCALE||this.draw()}}]),t}(),am=function(){function t(e,n){var o=n.width,r=n.height,i=n.background,c=n.buttonColor;om(this,t),this.table=e,this.height=r,this.width=o,this.background=i,this.buttonColor=c}return im(t,[{key:"drawBar",value:function(){var t=this.table,e=this.height,n=this.width,o=this.background,r=t.xFixedView,i=t.draw,c=t.index,l=t.xFixedMeasure;if(r.hasFixedTop()){var a=Bi.transformStylePx(e),s=t.visualWidth(),u=c.getWidth(),f=l.getHeight()+c.getHeight()-a/2;i.attr({fillStyle:o}),i.fillRect(u,f,s,a)}if(r.hasFixedLeft()){var h=t.visualHeight(),p=Bi.transformStylePx(n),y=l.getWidth()+c.getWidth()-p/2,b=c.getHeight();i.attr({fillStyle:o}),i.fillRect(y,b,p,h)}}},{key:"drawButton",value:function(){var t=this.table,e=this.height,n=this.width,o=this.buttonColor,r=t.xFixedView,i=t.draw,c=t.index,l=t.xFixedMeasure;if(r.hasFixedTop()){var a=Bi.transformStylePx(e),s=c.getWidth(),u=l.getHeight()+c.getHeight()-a/2;i.attr({fillStyle:o}),i.fillRect(0,u,s,a)}if(r.hasFixedLeft()){var f=c.getHeight(),h=Bi.transformStylePx(n),p=l.getWidth()+c.getWidth()-h/2;i.attr({fillStyle:o}),i.fillRect(p,0,h,f)}}},{key:"render",value:function(){var t=this.table.getRenderMode();t!==cm.RENDER&&t!==cm.SCALE||(this.drawBar(),this.drawButton())}}]),t}(),sm=function(){function t(e){om(this,t),this.table=e,this.width=null,this.height=null,this.x=null,this.y=null,this.drawX=null,this.drawY=null,this.mapOriginX=null,this.mapOriginY=null,this.mapTargetX=null,this.mapTargetY=null,this.mapWidth=null,this.mapHeight=null,this.fullScrollView=null,this.scrollView=null,this.borderView=null,this.borderX=null,this.borderY=null,this.viewMode=null}return im(t,[{key:"reset",value:function(){this.width=null,this.height=null,this.x=null,this.y=null,this.drawX=null,this.drawY=null,this.mapOriginX=null,this.mapOriginY=null,this.mapTargetX=null,this.mapTargetY=null,this.mapWidth=null,this.mapHeight=null,this.fullScrollView=null,this.scrollView=null,this.borderView=null,this.borderX=null,this.borderY=null,this.viewMode=null}},{key:"getWidth",value:function(){throw new TypeError("getWidth child impl")}},{key:"getHeight",value:function(){throw new TypeError("getHeight child impl")}},{key:"getX",value:function(){throw new TypeError("getX child impl")}},{key:"getY",value:function(){throw new TypeError("getY child impl")}},{key:"getDrawX",value:function(){if(S.isNumber(this.drawX))return this.drawX;var t=this.table,e=this.getX();if(t.getRenderMode()===cm.RENDER)return this.drawX=e,e;if(t.getRenderMode()===cm.SCALE)return this.drawX=e,e;if(this.getViewMode()===ed.BOUND_OUT)return this.drawX=e,e;if(this.getViewMode()===ed.CHANGE_NOT)return this.drawX=e,e;var n=t.scroll,o=this.getScrollView(),r=this.getFullScrollView(),i=0;switch(n.type){case fb.H_RIGHT:i=r.w-o.w;break;case fb.H_LEFT:i=0}return i=e+i,this.drawX=i,i}},{key:"getDrawY",value:function(){if(S.isNumber(this.drawY))return this.drawY;var t=this.table,e=this.getY();if(t.getRenderMode()===cm.RENDER)return this.drawY=e,e;if(t.getRenderMode()===cm.SCALE)return this.drawY=e,e;if(this.getViewMode()===ed.BOUND_OUT)return this.drawY=e,e;if(this.getViewMode()===ed.CHANGE_NOT)return this.drawY=e,e;var n=t.scroll,o=this.getScrollView(),r=this.getFullScrollView(),i=0;switch(n.type){case fb.V_BOTTOM:i=r.h-o.h;break;case fb.V_TOP:i=0}return i=e+i,this.drawY=i,i}},{key:"getLineX",value:function(){if(S.isNumber(this.borderX))return this.borderX;var t=this.table,e=this.getX();if(t.getRenderMode()===cm.RENDER)return this.borderX=e,e;if(t.getRenderMode()===cm.SCALE)return this.borderX=e,e;if(this.getViewMode()===ed.BOUND_OUT)return this.borderX=e,e;if(this.getViewMode()===ed.CHANGE_NOT)return this.borderX=e,e;var n=0;switch(t.scroll.type){case fb.H_RIGHT:var o=this.getLineView();n=this.getFullScrollView().w-o.w;break;case fb.H_LEFT:n=0}return n=e+n,this.borderX=n,n}},{key:"getLineY",value:function(){if(S.isNumber(this.borderY))return this.borderY;var t=this.table,e=this.getY();if(t.getRenderMode()===cm.RENDER)return this.borderY=e,e;if(t.getRenderMode()===cm.SCALE)return this.borderY=e,e;if(this.getViewMode()===ed.BOUND_OUT)return this.borderY=e,e;if(this.getViewMode()===ed.CHANGE_NOT)return this.borderY=e,e;var n=0;switch(t.scroll.type){case fb.V_BOTTOM:var o=this.getLineView();n=this.getFullScrollView().h-o.h;break;case fb.V_TOP:n=0}return n=e+n,this.borderY=n,n}},{key:"getMapOriginX",value:function(){if(S.isNumber(this.mapOriginX))return this.mapOriginX;var t=this.table,e=t.xTableAreaView,n=t.scroll,o=this.getX(),r=0;switch(n.type){case fb.H_LEFT:r=0;break;case fb.H_RIGHT:r=e.getLeaveView().w}return r=o+r,this.mapOriginX=r,r}},{key:"getMapOriginY",value:function(){if(S.isNumber(this.mapOriginY))return this.mapOriginY;var t=this.table,e=t.xTableAreaView,n=t.scroll,o=this.getY(),r=0;switch(n.type){case fb.V_TOP:r=0;break;case fb.V_BOTTOM:r=e.getLeaveView().h}return r=o+r,this.mapOriginY=r,r}},{key:"getMapTargetX",value:function(){if(S.isNumber(this.mapTargetX))return this.mapTargetX;var t=this.table,e=t.xTableAreaView,n=t.scroll,o=this.getX(),r=0;switch(n.type){case fb.H_LEFT:r=e.getEnterView().w;break;case fb.H_RIGHT:r=0}return r=o+r,this.mapTargetX=r,r}},{key:"getMapTargetY",value:function(){if(S.isNumber(this.mapTargetY))return this.mapTargetY;var t=this.table,e=t.xTableAreaView,n=t.scroll,o=this.getY(),r=0;switch(n.type){case fb.V_TOP:r=e.getEnterView().h;break;case fb.V_BOTTOM:r=0}return r=o+r,this.mapTargetY=r,r}},{key:"getMapWidth",value:function(){if(S.isNumber(this.mapWidth))return this.mapWidth;var t=this.table,e=t.xTableAreaView,n=t.scroll,o=this.getWidth();switch(n.type){case fb.H_RIGHT:o-=e.getLeaveView().w;break;case fb.H_LEFT:o-=e.getEnterView().w}return this.mapWidth=o,o}},{key:"getMapHeight",value:function(){if(S.isNumber(this.mapHeight))return this.mapHeight;var t=this.table,e=t.xTableAreaView,n=t.scroll,o=this.getHeight();switch(n.type){case fb.V_BOTTOM:o-=e.getLeaveView().h;break;case fb.V_TOP:o-=e.getEnterView().h}return this.mapHeight=o,o}},{key:"getScrollView",value:function(){throw new TypeError("getScrollView child impl")}},{key:"getFullScrollView",value:function(){throw new TypeError("getFullScrollView child impl")}},{key:"getLineView",value:function(){if(S.isNotUnDef(this.borderView))return this.borderView.clone();var t=this.table,e=t.cols,n=t.rows,o=t.getRenderMode(),r=this.getViewMode(),i=this.getScrollView();if(r===ed.CHANGE_ADD&&o===cm.SCROLL)switch(t.scroll.type){case fb.V_TOP:i.eri+=1,i.h=n.rectRangeSumHeight(i);break;case fb.V_BOTTOM:i.sri-=1,i.h=n.rectRangeSumHeight(i);break;case fb.H_RIGHT:i.sci-=1,i.w=e.rectRangeSumWidth(i);break;case fb.H_LEFT:i.eci+=1,i.w=e.rectRangeSumWidth(i)}return this.borderView=i,i.clone()}},{key:"getViewMode",value:function(){throw new TypeError("getViewMode child impl")}},{key:"drawMap",value:function(){var t=this.table,e=t.getRenderMode();if(this.getViewMode()===ed.CHANGE_ADD&&e===cm.SCROLL){var n=t.draw,o=t.el,r=this.getMapWidth(),i=this.getMapHeight(),c=this.getMapOriginX(),l=this.getMapOriginY(),a=this.getMapTargetX(),s=this.getMapTargetY();n.drawImage(o,c,l,r,i,a,s,r,i)}}},{key:"drawClear",value:function(){var t=this.table,e=t.scroll,n=t.draw,o=t.settings,r=this.getViewMode(),i=t.getRenderMode(),c=this.getDrawX(),l=this.getDrawY();if(n.attr({fillStyle:o.table.background}),i===cm.SCROLL)switch(r){case ed.CHANGE_NOT:case ed.STATIC:case ed.BOUND_OUT:var a=this.getHeight(),s=this.getWidth();n.fillRect(c,l,s,a);break;case ed.CHANGE_ADD:switch(e.type){case fb.V_BOTTOM:var u=this.getFullScrollView(),f=this.getScrollView(),h=t.visualHeight()-(u.h-f.h),p=this.getWidth();n.fillRect(c,l,p,h);break;case fb.V_TOP:var y=this.getScrollView().h,b=this.getWidth();n.fillRect(c,l,b,y);break;case fb.H_LEFT:var d=this.getScrollView(),v=this.getHeight(),g=d.w;n.fillRect(c,l,g,v);break;case fb.H_RIGHT:var w=this.getFullScrollView(),m=this.getScrollView(),E=this.getHeight(),O=t.visualWidth()-(w.w-m.w);n.fillRect(c,l,O,E)}}else if(cm.RENDER){var S=this.getHeight(),x=this.getWidth();n.fillRect(c,l,x,S)}}}]),t}(),um=function(t){function e(){return om(this,e),Jw(this,tm(e).apply(this,arguments))}return em(e,t),im(e,[{key:"drawBoundOutFont",value:function(){var t=this.getScrollView(),e=this.table,n=e.draw,o=e.cols,r=e.textCellsHelper,i=e.cells,c=e.textFont,l=e.merges,a=this.getDrawX(),s=this.getDrawY();n.offset(a,s);var u,f=t.clone();(f.sci=0,f.eci=t.sci-1,f.eci>-1)&&r.getCellByViewRange({reverseCols:!0,rectRange:f,newCol:function(t){u+=o.getWidth(t)},newRow:function(){u=0},callback:function(t,e,o,r,a){if(l.getFirstIncludes(t,e))return Tv;var s=o.text;if(S.isBlank(s))return xv;var f=o.fontAttr,h=f.align,p=f.textWrap;if((h===jc.ALIGN.left||h===jc.ALIGN.center)&&p===jc.TEXT_WRAP.OVER_FLOW){var y=i.getCellBoundOutSize(t,e);if(0===y||y>u){var b=o.format,d=o.text,v=o.fontAttr,g=c.getBuilder();g.setDraw(n),g.setText(Od(b,d)),g.setAttr(v),g.setRect(r),g.setOverFlow(a);var w=g.build();o.setContentWidth(w.draw())}}return Tv}});var h,p=t.clone();(p.sci=t.eci+1,p.eci=o.len-1,p.sci<o.len)&&r.getCellSkipMergeCellByViewRange({rectRange:p,startX:t.w,newCol:function(t){h+=o.getWidth(t)},newRow:function(){h=0},callback:function(t,e,o,r,a){if(l.getFirstIncludes(t,e))return Tv;var s=o.text;if(S.isBlank(s))return xv;var u=o.fontAttr,f=u.align,p=u.textWrap;if((f===jc.ALIGN.right||f===jc.ALIGN.center)&&p===jc.TEXT_WRAP.OVER_FLOW){var y=i.getCellBoundOutSize(t,e);if(0===y||y>h){var b=o.format,d=o.text,v=o.fontAttr,g=c.getBuilder();g.setDraw(n),g.setText(Od(b,d)),g.setAttr(v),g.setRect(r),g.setOverFlow(a);var w=g.build();o.setContentWidth(w.draw())}}return Tv}});n.offset(0,0)}},{key:"drawFont",value:function(){var t=this.getScrollView(),e=this.getDrawX(),n=this.getDrawY(),o=this.table,r=o.draw,i=o.textCellsHelper,c=o.textFont;r.offset(e,n),i.getCellSkipMergeCellByViewRange({rectRange:t,callback:function(t,e,n,o,i){var l=n.format,a=n.text,s=n.fontAttr,u=c.getBuilder();u.setDraw(r),u.setText(Od(l,a)),u.setAttr(s),u.setRect(o),u.setOverFlow(i);var f=u.build();n.setContentWidth(f.draw())}}),i.getMergeCellByViewRange({rectRange:t,callback:function(t,e){var n=e.format,o=e.text,i=e.fontAttr,l=c.getBuilder();l.setDraw(r),l.setText(Od(n,o)),l.setAttr(i),l.setRect(t);var a=l.build();e.setContentWidth(a.draw())}}),r.offset(0,0)}},{key:"drawColor",value:function(){var t=this.getScrollView(),e=this.table,n=this.getDrawX(),o=this.getDrawY(),r=e.draw,i=e.styleCellsHelper,c=e.merges;r.offset(n,o),i.getMergeCellByViewRange({rectRange:t,callback:function(t,e){var n=e.background;new xd({draw:r,rect:t}).drawBackgroundColor(n)}}),i.getCellByViewRange({rectRange:t,callback:function(t,e,n,o){var i=c.getFirstIncludes(t,e);if(!i||i.sri===t&&i.sci===t){var l=n.background;new xd({draw:r,rect:o}).drawBackgroundColor(l)}}}),r.offset(0,0)}},{key:"drawGrid",value:function(){var t=this.getLineView(),e=this.getLineX(),n=this.getLineY(),o=this.table,r=o.draw,i=o.grid,c=o.cellHorizontalGrid,l=o.cellVerticalGrid;r.offset(e,n);var a=c.getMergeCoincideRange({viewRange:t}),s=c.getCoincideRangeBrink({coincide:a}),u=c.getHorizontalLine({viewRange:t}),f=l.getVerticalLine({viewRange:t});u.forEach((function(t){i.horizonLine(t.sx,t.sy,t.ex,t.ey)})),f.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)}));var h=c.getMergeHorizontalLine({brink:s}),p=l.getMergeVerticalLine({brink:s});h.forEach((function(t){i.horizonLine(t.sx,t.sy,t.ex,t.ey)})),p.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)})),r.offset(0,0)}},{key:"drawBorder",value:function(){var t=this.getLineView(),e=this.getLineX(),n=this.getLineY(),o=this.table,r=o.draw,i=o.line,c=o.cellHorizontalBorder,l=o.cellVerticalBorder;r.offset(e,n);var a=c.getMergeCoincideRange({viewRange:t}),s=c.getCoincideRangeBrink({coincide:a}),u=c.getBottomHorizontalLine({viewRange:t}),f=c.getTopHorizontalLine({viewRange:t}),h=l.getLeftVerticalLine({viewRange:t}),p=l.getRightVerticalLine({viewRange:t});f.forEach((function(t){var e=t.borderAttr,n=t.row,o=t.col,r=e.top,c=r.color,l=r.widthType,a=r.type;i.setType(a),i.setWidthType(l),i.setColor(c),i.horizonLine(t.sx,t.sy,t.ex,t.ey,n,o,"top")})),u.forEach((function(t){var e=t.borderAttr,n=t.row,o=t.col,r=e.bottom,c=r.color,l=r.widthType,a=r.type;i.setType(a),i.setWidthType(l),i.setColor(c),i.horizonLine(t.sx,t.sy,t.ex,t.ey,n,o,"bottom")})),h.forEach((function(t){var e=t.borderAttr,n=t.row,o=t.col,r=e.left,c=r.color,l=r.widthType,a=r.type;i.setType(a),i.setWidthType(l),i.setColor(c),i.verticalLine(t.sx,t.sy,t.ex,t.ey,n,o,"left")})),p.forEach((function(t){var e=t.borderAttr,n=t.row,o=t.col,r=e.right,c=r.color,l=r.widthType,a=r.type;i.setType(a),i.setWidthType(l),i.setColor(c),i.verticalLine(t.sx,t.sy,t.ex,t.ey,n,o,"right")}));var y=c.getTopMergeHorizontalLine({brink:s}),b=c.getBottomMergeHorizontalLine({brink:s}),d=l.getLeftMergeVerticalLine({brink:s}),v=l.getRightMergeVerticalLine({brink:s});y.forEach((function(t){var e=t.borderAttr,n=t.row,o=t.col,r=e.top,c=r.color,l=r.widthType,a=r.type;i.setType(a),i.setWidthType(l),i.setColor(c),i.horizonLine(t.sx,t.sy,t.ex,t.ey,n,o,"top")})),b.forEach((function(t){var e=t.borderAttr,n=t.row,o=t.col,r=e.bottom,c=r.color,l=r.widthType,a=r.type;i.setType(a),i.setWidthType(l),i.setColor(c),i.horizonLine(t.sx,t.sy,t.ex,t.ey,n,o,"bottom")})),d.forEach((function(t){var e=t.borderAttr,n=t.row,o=t.col,r=e.left,c=r.color,l=r.widthType,a=r.type;i.setType(a),i.setWidthType(l),i.setColor(c),i.verticalLine(t.sx,t.sy,t.ex,t.ey,n,o,"left")})),v.forEach((function(t){var e=t.borderAttr,n=t.row,o=t.col,r=e.right,c=r.color,l=r.widthType,a=r.type;i.setType(a),i.setWidthType(l),i.setColor(c),i.verticalLine(t.sx,t.sy,t.ex,t.ey,n,o,"right")})),r.offset(0,0)}},{key:"render",value:function(){var t=this.table,e=t.getRenderMode();if(this.getViewMode()!==ed.STATIC||e!==cm.SCROLL){this.drawMap(),this.drawClear();var n=this.getScrollView(),o=this.getDrawX(),r=this.getDrawY(),i=n.w,c=n.h,l=t.draw,a=new yd({rect:new dd({x:o,y:r,width:i,height:c}),draw:l});a.open(),this.drawColor(),this.drawFont(),this.drawBoundOutFont(),this.table.settings.table.showGrid&&this.drawGrid(),this.drawBorder(),a.close()}}}]),e}(sm),fm=function(t){function e(){return om(this,e),Jw(this,tm(e).apply(this,arguments))}return em(e,t),im(e,[{key:"drawFont",value:function(){throw new TypeError("drawFont child impl")}},{key:"drawColor",value:function(){throw new TypeError("drawColor child impl")}},{key:"drawGrid",value:function(){throw new TypeError("drawGrid child impl")}},{key:"render",value:function(){var t=this.table.getRenderMode();this.getViewMode()===ed.STATIC&&t===cm.SCROLL||(this.drawMap(),this.drawClear(),this.drawColor(),this.drawGrid(),this.drawFont())}}]),e}(sm),hm=function(t){function e(){return om(this,e),Jw(this,tm(e).apply(this,arguments))}return em(e,t),im(e,[{key:"drawFont",value:function(){var t=this.getDrawX(),e=this.getDrawY(),n=this.getScrollView(),o=this.getWidth(),r=this.table,i=r.draw,c=r.rows,l=r.index,a=n.sri,s=n.eri;i.offset(t,e),i.attr({textAlign:"center",textBaseline:"middle",font:"".concat(l.getSize(),"px Arial"),fillStyle:l.getColor()}),c.eachHeight(a,s,(function(t,e,n){i.fillText(t+1,o/2,n+e/2)})),i.offset(0,0)}},{key:"drawGrid",value:function(){var t=this.getLineView(),e=this.getLineX(),n=this.getLineY(),o=this.table,r=o.draw,i=o.indexGrid,c=o.leftIndexHorizontalGrid,l=o.leftIndexVerticalGrid;r.offset(e,n);var a=c.getHorizontalLine({viewRange:t}),s=l.getVerticalLine({viewRange:t});a.forEach((function(t){i.horizonLine(t.sx,t.sy,t.ex,t.ey)})),s.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)})),r.offset(0,0)}},{key:"drawColor",value:function(){var t=this.getDrawX(),e=this.getDrawY(),n=this.getScrollView().h,o=this.getWidth(),r=this.table,i=r.draw,c=r.index;i.offset(t,e),i.attr({fillStyle:c.getBackground()}),i.fillRect(0,0,o,n),i.offset(0,0)}}]),e}(fm),pm=function(t){function e(){return om(this,e),Jw(this,tm(e).apply(this,arguments))}return em(e,t),im(e,[{key:"drawFont",value:function(){var t=this.getDrawX(),e=this.getDrawY(),n=this.getScrollView(),o=this.getHeight(),r=this.table,i=r.draw,c=r.cols,l=r.index,a=n.sci,s=n.eci;i.offset(t,e),i.attr({textAlign:"center",textBaseline:"middle",font:"".concat(l.getSize(),"px Arial"),fillStyle:l.getColor()}),c.eachWidth(a,s,(function(t,e,n){i.fillText(S.stringAt(t),n+e/2,o/2)})),i.offset(0,0)}},{key:"drawGrid",value:function(){var t=this.getLineView(),e=this.getLineX(),n=this.getLineY(),o=this.table,r=o.draw,i=o.indexGrid,c=o.topIndexVerticalGrid,l=o.topIndexHorizontalGrid;r.offset(e,n);var a=l.getHorizontalLine({viewRange:t}),s=c.getVerticalLine({viewRange:t});a.forEach((function(t){i.horizonLine(t.sx,t.sy,t.ex,t.ey)})),s.forEach((function(t){i.verticalLine(t.sx,t.sy,t.ex,t.ey)})),r.offset(0,0)}},{key:"drawColor",value:function(){var t=this.table,e=t.draw,n=t.index,o=this.getScrollView(),r=this.getDrawX(),i=this.getDrawY(),c=this.getHeight(),l=o.w;e.offset(r,i),e.attr({fillStyle:n.getBackground()}),e.fillRect(0,0,l,c),e.offset(0,0)}}]),e}(fm),ym=function(t){function e(){return om(this,e),Jw(this,tm(e).apply(this,arguments))}return em(e,t),im(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table.xFixedMeasure.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table.index.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;return this.y=0,0}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.rows,n=t.cols,o=t.xFixedView.getFixedView(),r=new fs(0,o.sci,0,o.eci);return r.w=n.rectRangeSumWidth(r),r.h=e.rectRangeSumHeight(r),this.scrollView=r,r.clone()}},{key:"getFullScrollView",value:function(){if(S.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.getScrollView();return this.fullScrollView=t,t.clone()}},{key:"getViewMode",value:function(){return this.viewMode=ed.STATIC,ed.STATIC}},{key:"render",value:function(){var t=this.table.getRenderMode();t!==cm.RENDER&&t!==cm.SCALE||$w(tm(e.prototype),"render",this).call(this)}}]),e}(pm),bm=function(t){function e(){return om(this,e),Jw(this,tm(e).apply(this,arguments))}return em(e,t),im(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table.index.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table.xFixedMeasure.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;return this.x=0,0}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.rows,n=t.cols,o=t.xFixedView.getFixedView(),r=new fs(o.sri,0,o.eri,0);return r.w=n.rectRangeSumWidth(r),r.h=e.rectRangeSumHeight(r),this.scrollView=r,r.clone()}},{key:"getFullScrollView",value:function(){if(S.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.getScrollView();return this.fullScrollView=t,t.clone()}},{key:"getViewMode",value:function(){return this.viewMode=ed.STATIC,ed.STATIC}},{key:"render",value:function(){var t=this.table.getRenderMode();t!==cm.RENDER&&t!==cm.SCALE||$w(tm(e.prototype),"render",this).call(this)}}]),e}(hm),dm=function(t){function e(){return om(this,e),Jw(this,tm(e).apply(this,arguments))}return em(e,t),im(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table.xFixedMeasure.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table.xFixedMeasure.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.rows,n=t.cols,o=t.xFixedView.getFixedView();return o.w=n.rectRangeSumWidth(o),o.h=e.rectRangeSumHeight(o),this.scrollView=o,o.clone()}},{key:"getFullScrollView",value:function(){if(S.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.getScrollView();return this.fullScrollView=t,t.clone()}},{key:"getViewMode",value:function(){return this.viewMode=ed.STATIC,ed.STATIC}},{key:"render",value:function(){var t=this.table.getRenderMode();t!==cm.RENDER&&t!==cm.SCALE||$w(tm(e.prototype),"render",this).call(this)}}]),e}(um),vm=function(t){function e(){return om(this,e),Jw(this,tm(e).apply(this,arguments))}return em(e,t),im(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table,e=t.xLeft,n=t.index,o=t.visualWidth()-(n.getWidth()+e.getWidth());return this.width=o,o}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table.index.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,n=t.index.getWidth()+e.getWidth();return this.x=n,n}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;return this.y=0,0}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.index,n=t.xTableAreaView,o=t.getRenderMode(),r=n.getScrollView(),i=n.getScrollEnterView(),c=S.isNotUnDef(i)&&o===cm.SCROLL?i:r;return c.sri=0,c.eri=0,c.h=e.getHeight(),this.scrollView=c,c.clone()}},{key:"getFullScrollView",value:function(){if(S.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table,e=t.index,n=t.xTableAreaView.getScrollView();return n.sri=0,n.eri=0,n.h=e.getHeight(),this.fullScrollView=n,n.clone()}},{key:"getViewMode",value:function(){if(S.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table,e=t.xTableAreaView,n=t.rows,o=e.getLastScrollView(),r=e.getScrollView();S.isNotUnDef(o)&&(o.sri=0,o.eri=0,o.h=n.sectionSumHeight(o.sri,o.eri)),r.sri=0,r.eri=0,r.h=n.sectionSumHeight(r.sri,r.eri);var i=nd.viewMode(o,r);return this.viewMode=i,i}}]),e}(pm),gm=function(t){function e(){return om(this,e),Jw(this,tm(e).apply(this,arguments))}return em(e,t),im(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table.index.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,n=t.index,o=t.visualHeight()-(n.getHeight()+e.getHeight());return this.height=o,o}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;return this.x=0,0}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,n=t.index.getHeight()+e.getHeight();return this.y=n,n}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.xTableAreaView,n=t.index,o=t.getRenderMode(),r=e.getScrollView(),i=e.getScrollEnterView(),c=S.isNotUnDef(i)&&o===cm.SCROLL?i:r;return c.sci=0,c.eci=0,c.w=n.getWidth(),this.scrollView=c,c.clone()}},{key:"getFullScrollView",value:function(){if(S.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table,e=t.index,n=t.xTableAreaView.getScrollView();return n.sci=0,n.eci=0,n.w=e.getWidth(),this.fullScrollView=n,n.clone()}},{key:"getViewMode",value:function(){if(S.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table,e=t.xTableAreaView,n=t.cols,o=e.getLastScrollView(),r=e.getScrollView();S.isNotUnDef(o)&&(o.sci=0,o.eci=0,o.w=n.sectionSumWidth(o.sci,o.eci)),r.sci=0,r.eci=0,r.w=n.sectionSumWidth(r.sci,r.eci);var i=nd.viewMode(o,r);return this.viewMode=i,i}}]),e}(hm),wm=function(t){function e(){return om(this,e),Jw(this,tm(e).apply(this,arguments))}return em(e,t),im(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table.xFixedMeasure.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,n=t.index,o=t.visualHeight()-(n.getHeight()+e.getHeight());return this.height=o,o}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,n=t.index.getHeight()+e.getHeight();return this.y=n,n}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.xFixedView,n=t.cols,o=t.xTableAreaView,r=t.getRenderMode(),i=e.getFixedView(),c=o.getScrollView(),l=o.getScrollEnterView(),a=S.isNotUnDef(l)&&r===cm.SCROLL?l:c;return a.sci=i.sci,a.eci=i.eci,a.w=n.sectionSumWidth(a.sci,a.eci),this.scrollView=a,a.clone()}},{key:"getFullScrollView",value:function(){if(S.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table,e=t.xFixedView,n=t.cols,o=t.xTableAreaView,r=e.getFixedView(),i=o.getScrollView();return i.sci=r.sci,i.eci=r.eci,i.w=n.sectionSumWidth(i.sci,i.eci),this.fullScrollView=i,i.clone()}},{key:"getViewMode",value:function(){if(S.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table,e=t.xTableAreaView,n=t.cols,o=t.xFixedView.getFixedView(),r=e.getLastScrollView(),i=e.getScrollView();S.isNotUnDef(r)&&(r.sci=o.sci,r.eci=o.eci,r.w=n.sectionSumWidth(r.sci,r.eci)),i.sci=o.sci,i.eci=o.eci,i.w=n.sectionSumWidth(i.sci,i.eci);var c=nd.viewMode(r,i);return this.viewMode=c,c}}]),e}(um),mm=function(t){function e(){return om(this,e),Jw(this,tm(e).apply(this,arguments))}return em(e,t),im(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table,e=t.xLeft,n=t.index,o=t.visualWidth()-(n.getWidth()+e.getWidth());return this.width=o,o}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table.xFixedMeasure.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,n=t.index.getWidth()+e.getWidth();return this.x=n,n}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.xFixedView,n=t.rows,o=t.xTableAreaView,r=t.getRenderMode(),i=e.getFixedView(),c=o.getScrollView(),l=o.getScrollEnterView(),a=S.isNotUnDef(l)&&r===cm.SCROLL?l:c;return a.sri=i.sri,a.eri=i.eri,a.h=n.sectionSumHeight(a.sri,a.eri),this.scrollView=a,a.clone()}},{key:"getFullScrollView",value:function(){if(S.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table,e=t.xFixedView,n=t.rows,o=t.xTableAreaView,r=e.getFixedView(),i=o.getScrollView();return i.sri=r.sri,i.eri=r.eri,i.h=n.sectionSumHeight(i.sri,i.eri),this.fullScrollView=i,i.clone()}},{key:"getViewMode",value:function(){if(S.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table,e=t.xTableAreaView,n=t.rows,o=t.xFixedView.getFixedView(),r=e.getLastScrollView(),i=e.getScrollView();S.isNotUnDef(r)&&(r.sri=o.sri,r.eri=o.eri,r.h=n.sectionSumHeight(r.sci,r.eci)),i.sri=o.sri,i.eri=o.eri,i.h=n.sectionSumHeight(i.sci,i.eci);var c=nd.viewMode(r,i);return this.viewMode=c,c}}]),e}(um),Em=function(t){function e(){return om(this,e),Jw(this,tm(e).apply(this,arguments))}return em(e,t),im(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table,e=t.index,n=t.xLeft,o=t.visualWidth()-(e.getWidth()+n.getWidth());return this.width=o,o}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,n=t.index,o=t.visualHeight()-(n.getHeight()+e.getHeight());return this.height=o,o}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,n=t.index.getWidth()+e.getWidth();return this.x=n,n}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,n=t.index.getHeight()+e.getHeight();return this.y=n,n}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.xTableAreaView,n=t.getRenderMode(),o=e.getScrollView(),r=e.getScrollEnterView(),i=S.isNotUnDef(r)&&n===cm.SCROLL?r:o;return this.scrollView=i,i.clone()}},{key:"getFullScrollView",value:function(){if(S.isNotUnDef(this.fullScrollView))return this.fullScrollView.clone();var t=this.table.xTableAreaView.getScrollView();return this.fullScrollView=t,t.clone()}},{key:"getViewMode",value:function(){if(S.isNotUnDef(this.viewMode))return this.viewMode;var t=this.table.xTableAreaView,e=t.getLastScrollView(),n=t.getScrollView(),o=nd.viewMode(e,n);return this.viewMode=o,o}}]),e}(um),Om=function(t){function e(t){var n,o=t.xTableScrollView,r=t.settings,c=t.xFixedView,l=t.scroll;om(this,e),(n=Jw(this,tm(e).call(this,"".concat(i,"-table-canvas"),"canvas"))).settings=r,n.scroll=l,n.xFixedView=c,n.renderMode=cm.RENDER,n.scale=new ob,n.index=new cb(Kw({scaleAdapter:new rb({goto:function(t){return Bi.transformStylePx(n.scale.goto(t))}})},n.settings.index)),n.rows=new ab(Kw({scaleAdapter:new rb({goto:function(t){return Bi.transformStylePx(n.scale.goto(t))}})},n.settings.rows)),n.cols=new ub(Kw({scaleAdapter:new rb({goto:function(t){return Bi.transformStylePx(n.scale.goto(t))},back:function(t){return n.scale.back(t)}})},n.settings.cols)),n.merges=new Cv(Kw({},n.settings.merge,{rows:n.rows,cols:n.cols})),n.cells=new _d({rows:n.rows,cols:n.cols,data:n.settings.data,merges:n.merges}),n.xFixedMeasure=new Vw({fixedView:n.xFixedView,cols:n.cols,rows:n.rows}),n.xTableAreaView=new kw({xTableScrollView:o,scroll:n.scroll,rows:n.rows,cols:n.cols}),n.operateCellsHelper=new Rw({xTableAreaView:n.xTableAreaView,cells:n.cells,merges:n.merges,rows:n.rows,cols:n.cols}),n.styleCellsHelper=new gv({xTableAreaView:n.xTableAreaView,cells:n.cells,merges:n.merges,rows:n.rows,cols:n.cols}),n.textCellsHelper=new kv({xTableAreaView:n.xTableAreaView,cells:n.cells,merges:n.merges,rows:n.rows,cols:n.cols});var a=new Yv({merges:n.merges,cols:n.cols,cells:n.cells}),s=new Mv({merges:n.merges,cols:n.cols,cells:n.cells}),u=new Sg(Og.AND,[new Lv((function(t,e){var o=n.cells.getCell(t,e);return!S.isUnDef(o)&&o.borderAttr.right.display})),new Lv((function(t,e){return a.execute(t,e)}))]),f=new Sg(Og.AND,[new Lv((function(t,e){var o=n.cells.getCell(t,e);return!S.isUnDef(o)&&o.borderAttr.left.display})),new Lv((function(t,e){return s.execute(t,e)}))]),h=new Lv((function(t,e){var o=n.cells.getCell(t,e);return!S.isUnDef(o)&&o.borderAttr.top.display})),p=new Lv((function(t,e){var o=n.cells.getCell(t,e);return!S.isUnDef(o)&&o.borderAttr.bottom.display}));return n.draw=new Bi(n.el),n.line=new Xi(n.draw,{leftShow:function(t,e){return f.execute(t,e)},topShow:function(t,e){return h.execute(t,e)},rightShow:function(t,e){return u.execute(t,e)},bottomShow:function(t,e){return p.execute(t,e)},iFMerge:function(t,e){return null!==n.merges.getFirstIncludes(t,e)},iFMergeFirstRow:function(t,e){return n.merges.getFirstIncludes(t,e).sri===t},iFMergeLastRow:function(t,e){return n.merges.getFirstIncludes(t,e).eri===t},iFMergeFirstCol:function(t,e){return n.merges.getFirstIncludes(t,e).sci===e},iFMergeLastCol:function(t,e){return n.merges.getFirstIncludes(t,e).eci===e}}),n.indexGrid=new hd(n.draw,{color:n.index.getGridColor()}),n.grid=new hd(n.draw,{color:n.settings.table.gridColor}),n.textFont=new uv({scaleAdapter:new rb({goto:function(t){return n.scale.goto(t)}})}),n.cellHorizontalGrid=new Cg({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,drawCheck:!0}),n.cellVerticalGrid=new Vg({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,drawCheck:!0}),n.topIndexHorizontalGrid=new Cg({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,foldOnOff:!1,getHeight:function(){return n.index.getHeight()}}),n.topIndexVerticalGrid=new Vg({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,foldOnOff:!1,getHeight:function(){return n.index.getHeight()}}),n.leftIndexHorizontalGrid=new Cg({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,foldOnOff:!1,getWidth:function(){return n.index.getWidth()}}),n.leftIndexVerticalGrid=new Vg({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,foldOnOff:!1,getWidth:function(){return n.index.getWidth()}}),n.cellHorizontalBorder=new pw({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,drawOptimization:!0}),n.cellVerticalBorder=new ww({merges:n.merges,rows:n.rows,cols:n.cols,cells:n.cells,drawOptimization:!0}),n.xLeftFrozenIndex=new bm(Qw(n)),n.xTopFrozenIndex=new ym(Qw(n)),n.xTableFrozenContent=new dm(Qw(n)),n.xLeftIndex=new gm(Qw(n)),n.xTopIndex=new vm(Qw(n)),n.xLeft=new wm(Qw(n)),n.xTop=new mm(Qw(n)),n.xContent=new Em(Qw(n)),n.xTableFrozenFullRect=new lm(Qw(n)),n.xTableFixedBar=new am(Qw(n),r.xFixedBar),n.merges.sync(),n}return em(e,t),im(e,[{key:"drawBorderOptimize",value:function(){var t=this.styleCellsHelper,e=this.xTableAreaView,n=this.cellHorizontalBorder,o=this.cellVerticalBorder,r=e.getScrollView(),i=!0;t.getCellByViewRange({rectRange:r,callback:function(t,e,n){var o=n.borderAttr,r=o.top,c=o.left,l=o.right,a=o.bottom;return r.type===Yi.DOUBLE_LINE?i=!1:c.type===Yi.DOUBLE_LINE?i=!1:l.type===Yi.DOUBLE_LINE?i=!1:a.type!==Yi.DOUBLE_LINE||(i=!1)}}),i?(n.enableOptimization(),o.enableOptimization()):(n.disableOptimization(),o.disableOptimization())}},{key:"getRenderMode",value:function(){return this.renderMode}},{key:"visualWidth",value:function(){return this.el.width}},{key:"visualHeight",value:function(){return this.el.height}},{key:"reset",value:function(){var t=this.xTableAreaView,e=this.xLeftFrozenIndex,n=this.xTopFrozenIndex,o=this.xTableFrozenContent,r=this.xLeftIndex,i=this.xTopIndex,c=this.xLeft,l=this.xTop,a=this.xContent;t.reset(),e.reset(),n.reset(),o.reset(),r.reset(),i.reset(),c.reset(),l.reset(),a.reset()}},{key:"setScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.draw.attr({fillStyle:this.settings.table.background}),this.draw.fullRect(),this.scale.setValue(t),this.renderMode=cm.SCALE,this.resize(),this.renderMode=cm.RENDER}},{key:"resize",value:function(){var t=this.draw,e=this.xTableAreaView,n=this.parent().box();t.resize(n.width,n.height),e.undo(),this.reset(),this.render()}},{key:"render",value:function(){var t=this.xFixedView,e=this.xTableFrozenFullRect,n=this.xTableFixedBar,o=this.xLeftFrozenIndex,r=this.xTopFrozenIndex,i=this.xTableFrozenContent,c=this.xLeftIndex,l=this.xTopIndex,a=this.xLeft,s=this.xTop,u=this.xContent;this.drawBorderOptimize(),e.render(),t.hasFixedLeft()&&t.hasFixedTop()&&i.render(),t.hasFixedTop()&&(o.render(),s.render()),t.hasFixedLeft()&&(r.render(),a.render()),c.render(),l.render(),u.render(),n.render()}},{key:"scrolling",value:function(){var t=this.xTableAreaView;this.reset(),this.renderMode=cm.SCROLL,this.render(),t.record(),this.renderMode=cm.RENDER,this.reset()}}]),e}(D);function Sm(t){return(Sm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xm(t,e){return!e||"object"!==Sm(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tm(t){return(Tm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _m(t,e){return(_m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var km=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),xm(this,Tm(e).call(this,"".concat(i,"-x-screen-zone ").concat(t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_m(t,e)}(e,t),e}(D);function Pm(t){return(Pm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cm(t,e){return!e||"object"!==Pm(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jm(t){return(jm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Lm(t,e){return(Lm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Am=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Cm(this,jm(e).call(this,"".concat(i,"-x-screen-br-zone")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lm(t,e)}(e,t),e}(km);function Rm(t){return(Rm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nm(t,e){return!e||"object"!==Rm(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vm(t){return(Vm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Im(t,e){return(Im=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mm=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Nm(this,Vm(e).call(this,"".concat(i,"-x-screen-lt-zone")))).xScreen=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Im(t,e)}(e,t),e}(km);function Dm(t){return(Dm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bm(t,e){return!e||"object"!==Dm(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hm(t){return(Hm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wm(t,e){return(Wm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fm=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Bm(this,Hm(e).call(this,"".concat(i,"-x-screen-l-zone")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wm(t,e)}(e,t),e}(km);function Ym(t){return(Ym="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gm(t,e){return!e||"object"!==Ym(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zm(t){return(zm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Um(t,e){return(Um=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xm=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Gm(this,zm(e).call(this,"".concat(i,"-x-screen-t-zone")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Um(t,e)}(e,t),e}(km);function Km(t){return(Km="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zm(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function $m(t,e){return!e||"object"!==Km(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qm(t){return(qm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jm(t,e){return(Jm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qm={BRT:Symbol("BRT"),BRL:Symbol("BRL"),BR:Symbol("br"),ALL:Symbol("ALL")},tE=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=$m(this,qm(e).call(this,"".concat(i,"-x-screen")))).pool=[],n.table=t,n.displayArea=Qm.BR,n.ltZone=new Mm,n.tZone=new Xm,n.brZone=new Am,n.lZone=new Fm,n.child(n.ltZone),n.child(n.tZone),n.child(n.brZone),n.child(n.lZone),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jm(t,e)}(e,t),n=e,(r=[{key:"onAttach",value:function(){this.bind(),this.setZone()}},{key:"bind",value:function(){var t=this,e=this.table;A.bind(e,o.TABLE_EVENT_TYPE.SCALE_CHANGE,(function(){t.setZone()})),A.bind(e,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.setZone()})),A.bind(e,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.setZone()}))}},{key:"addItem",value:function(t){this.pool.push(t),this.ltZone.attach(t.lt),this.tZone.attach(t.t),this.lZone.attach(t.l),this.brZone.attach(t.br),t.setXScreen(this),t.onAdd(this)}},{key:"setZone",value:function(){var t=this.table,e=t.index,n=t.getFixedHeight(),o=t.getFixedWidth(),r=e.getHeight()+n,i=e.getWidth()+o;this.brZone.offset({left:i,top:r});var c=o>0&&n>0,l=n>0,a=o>0;this.ltZone.hide(),this.lZone.hide(),this.tZone.hide();var s=Bi.dpr();c?(this.displayArea=Qm.ALL,this.ltZone.offset({left:e.getWidth(),top:e.getHeight(),width:o,height:n}).show(),this.ltZone.css("border-width","".concat(s,"px")),this.lZone.offset({left:e.getWidth(),top:r,width:o,height:t.visualHeight()-e.getHeight()-n}).show(),this.lZone.css("border-width","".concat(s,"px")),this.tZone.offset({left:i,top:e.getHeight(),width:t.visualWidth()-e.getWidth()-o,height:n}).show(),this.tZone.css("border-width","".concat(s,"px"))):a?(this.displayArea=Qm.BRL,this.lZone.offset({left:e.getWidth(),top:r,width:o,height:t.visualHeight()-e.getHeight()-n}).show(),this.lZone.css("border-width","".concat(s,"px"))):l?(this.displayArea=Qm.BRL,this.tZone.offset({left:i,top:e.getHeight(),width:t.visualWidth()-e.getWidth()-o,height:n}).show(),this.tZone.css("border-width","".concat(s,"px"))):this.displayArea=Qm.BR}},{key:"findType",value:function(t){var e=!0,n=!1,o=void 0;try{for(var r,i=this.pool[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var c=r.value;if(c instanceof t)return c}}catch(t){n=!0,o=t}finally{try{e||null==i.return||i.return()}finally{if(n)throw o}}return null}}])&&Zm(n.prototype,r),c&&Zm(n,c),e}(D);function eE(t){return(eE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nE(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function oE(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function rE(t,e){return!e||"object"!==eE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function iE(t){return(iE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cE(t,e){return(cE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var lE=function(t){function e(t){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=rE(this,iE(e).call(this,{table:t}))).options=S.mergeDeep({mergeForceSplit:!1,onBeforeAutoFill:function(){},onAfterAutoFill:function(){}},o),n.autoFillRange=fs.EMPTY,n.moveDirection=null,n.display=!1,n.ltElem=new D("".concat(i,"-x-autofill-area")),n.brElem=new D("".concat(i,"-x-autofill-area")),n.lElem=new D("".concat(i,"-x-autofill-area")),n.tElem=new D("".concat(i,"-x-autofill-area")),n.blt.child(n.ltElem),n.bl.child(n.lElem),n.bt.child(n.tElem),n.bbr.child(n.brElem),n.setBorderType("dashed"),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cE(t,e)}(e,t),n=e,(r=[{key:"onAdd",value:function(){this.bind(),this.hide()}},{key:"bind",value:function(){var t=this,n=this.table,r=this.xScreen,i=n.mousePointer,c=r.findType(ff);A.bind([c.ltCorner,c.tCorner,c.lCorner,c.brCorner],o.SYSTEM_EVENT_TYPE.MOUSE_LEAVE,(function(){i.free(e)})),A.bind([c.ltCorner,c.tCorner,c.lCorner,c.brCorner],o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(){i.lock(e),i.set(of.KEYS.crosshair,e)})),A.bind([c.ltCorner,c.tCorner,c.lCorner,c.brCorner],o.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.display=!0,i.lock(e),i.set(of.KEYS.crosshair,e),A.mouseMoveUp(document,(function(e){var o=n.computeEventXy(e),r=o.x,i=o.y;t.rangeHandle(r,i),t.offsetHandle(),t.borderHandle()}),(function(){t.display=!1,i.free(e),t.autoFill(),t.hide()}))}))}},{key:"borderHandle",value:function(){var t=this.autoFillRange;!1===this.display||t.equals(fs.EMPTY)?this.hideBorder():this.showBorder(t)}},{key:"offsetHandle",value:function(){var t=this.autoFillRange;!1===this.display||t.equals(fs.EMPTY)?this.hide():(this.show(),this.setDisplay(t),this.setSizer(t),this.setLocal(t))}},{key:"rangeHandle",value:function(t,e){var n=this.table,o=n.xScreen.findType(ff),r=n.getTableMerges(),i=o.selectRange,c=o.selectLocal,l=n.cols,a=n.rows,s=i.sri,u=i.sci,f=i.eri,h=i.eci,p=n.getRiCiByXy(t,e),y=p.ri,b=p.ci,d=r.getFirstIncludes(s,u),v=uf.BR!==c||S.isNotUnDef(d),g=nE(i.size(),2),w=g[0],m=g[1],E=y,O=b;E<0?E=0:E>a.len&&(E=a.len-1),O<0?O=0:O>l.len&&(O=l.len-1);var x=fs.EMPTY,T=S.Undef;if(E<s||y>f){if(E<s)if(T="top",v){var _=y,k=0;ns.getInstance().setBegin(s-1).setEnd(0).setLoop((function(t){if(t<y)return!1;if(k%w==0){var e=_-w;e>=0&&(_=e)}return k+=1,!0})).foldOnOff(!1).execute(),_!==s&&(x=new fs(_,u,s-1,h))}else{var P=ns.getInstance().setBegin(s).setEnd(0).nextRow();x=new fs(y,u,P,h)}if(E>f)if(T="bottom",v){var C=f,j=0;ns.getInstance().setBegin(f+1).setEnd(a.len-1).setLoop((function(t){if(t>y)return!1;if(j%w==0){var e=C+w;e>=0&&(C=e)}return j+=1,!0})).foldOnOff(!1).execute(),C!==f&&(x=new fs(f+1,u,C,h))}else{var L=ns.getInstance().setBegin(f).setEnd(a.len-1).nextRow();x=new fs(L,u,y,h)}}else if(b<u||b>h){if(b<u)if(T="left",v){var A=u,R=0;as.getInstance().setBegin(u-1).setEnd(0).setLoop((function(t){if(t<b)return!1;if(R%m==0){var e=A-m;e>=0&&(A=e)}return R+=1,!0})).execute(),A!==u&&(x=new fs(s,A,f,u-1))}else{var N=as.getInstance().setBegin(u).setEnd(0).nextRow();x=new fs(s,b,f,N)}if(b>h)if(T="right",v){var V=h,I=0;as.getInstance().setBegin(h+1).setEnd(l.len-1).setLoop((function(t){if(t>b)return!1;if(I%m==0){var e=V+m;e>=0&&(V=e)}return I+=1,!0})).execute(),V!==h&&(x=new fs(s,h+1,f,V))}else{var M=as.getInstance().setBegin(h).setEnd(l.len-1).nextRow();x=new fs(s,M,f,b)}}if(x){var D=l.sectionSumWidth(x.sci,x.eci),B=a.sectionSumHeight(x.sri,x.eri);x.w=D,x.h=B}this.autoFillRange=x,this.moveDirection=T}},{key:"autoFill",value:function(){if(!this.autoFillRange.equals(fs.EMPTY)){var t=this.table,e=this.options,n=t.tableDataSnapshot;e.onBeforeAutoFill(),n.begin(),this.fillMerge(),this.fillCellIN(),n.end(),e.onAfterAutoFill(),t.render()}}},{key:"fillMerge",value:function(){var t=this.table,e=this.xScreen,n=t.cellMergeCopyHelper,o=e.findType(ff);n.copyMergeContent({targetViewRange:this.autoFillRange,originViewRange:o.selectRange})}},{key:"fillCellIN",value:function(){var t=this.table,e=this.xScreen,n=t.cellMergeCopyHelper,o=e.findType(ff);n.copyCellINContent({targetViewRange:this.autoFillRange,originViewRange:o.selectRange})}}])&&oE(n.prototype,r),c&&oE(n,c),e}(Zu);function aE(t){return(aE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sE(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function uE(t,e){return!e||"object"!==aE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fE(t){return(fE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hE(t,e){return(hE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pE=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=uE(this,fE(e).call(this,"".concat(i,"-table-drop-row-fixed-bar")))).block=k("div","".concat(i,"-table-drop-row-fixed-block")),n.children(n.block),n.table=t,n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hE(t,e)}(e,t),n=e,(o=[{key:"onAttach",value:function(){this.setSize(),this.hide()}},{key:"setSize",value:function(){var t=this.table,e=this.block,n=t.visualWidth();e.offset({width:t.getIndexWidth(),height:6}),this.offset({height:6,width:n,left:0})}}])&&sE(n.prototype,o),r&&sE(n,r),e}(D);function yE(t){return(yE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bE(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function dE(t,e){return!e||"object"!==yE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vE(t){return(vE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gE(t,e){return(gE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wE=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=dE(this,vE(e).call(this,"".concat(i,"-table-drop-col-fixed-bar")))).block=k("div","".concat(i,"-table-drop-col-fixed-block")),n.children(n.block),n.table=t,n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gE(t,e)}(e,t),n=e,(o=[{key:"onAttach",value:function(){this.setSize(),this.hide()}},{key:"setSize",value:function(){var t=this.table,e=this.block,n=t.visualHeight();e.offset({height:t.getIndexHeight(),width:6}),this.offset({height:n,width:6,top:0})}}])&&bE(n.prototype,o),r&&bE(n,r),e}(D);function mE(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var EE=function(){function t(e){var n=e.fixedView,o=void 0===n?new fs(0,0,-1,-1):n,r=e.fxLeft,i=void 0===r?-1:r,c=e.fxTop,l=void 0===c?-1:c;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fixedView=o,i>-1&&(this.fixedView.eci=i),l>-1&&(this.fixedView.eri=l)}var e,n,o;return e=t,(n=[{key:"setFixedView",value:function(t){this.fixedView=t.clone()}},{key:"getFixedView",value:function(){return this.fixedView.clone()}},{key:"hasFixedLeft",value:function(){return this.fixedView.eci>-1}},{key:"hasFixedTop",value:function(){return this.fixedView.eri>-1}}])&&mE(e.prototype,n),o&&mE(e,o),t}();function OE(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var SE=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.change=!1}var e,n,o;return e=t,(n=[{key:"endNotice",value:function(){this.change&&(this.change=!1)}},{key:"backNotice",value:function(){this.change&&(this.change=!1)}},{key:"goNotice",value:function(){this.change&&(this.change=!1)}}])&&OE(e.prototype,n),o&&OE(e,o),t}();function xE(t){return(xE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function TE(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _E(t,e){return!e||"object"!==xE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kE(t,e,n){return(kE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=PE(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function PE(t){return(PE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function CE(t,e){return(CE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jE=function(t){function e(t){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{setCell:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=_E(this,PE(e).call(this))).snapshot=t,n.option=o,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&CE(t,e)}(e,t),n=e,(r=[{key:"$setCell",value:function(t,e,n){this.change=!0,this.snapshot.cells.setCellOrNew(t,e,n)}},{key:"setCell",value:function(t,e,n){var o=this.option,r=this.snapshot,i=o.on.setCell,c=r.cells.getCell(t,e);this.$setCell(t,e,n),i(t,e,c,n)}},{key:"endNotice",value:function(){var t=this.snapshot.table;this.change&&t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),kE(PE(e.prototype),"endNotice",this).call(this)}},{key:"goNotice",value:function(){var t=this.snapshot.table;this.change&&t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),kE(PE(e.prototype),"goNotice",this).call(this)}},{key:"backNotice",value:function(){var t=this.snapshot.table;this.change&&t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),kE(PE(e.prototype),"backNotice",this).call(this)}}])&&TE(n.prototype,r),i&&TE(n,i),e}(SE);var LE=function t(e){var n=e.ri,o=e.ci,r=e.oldCell,i=e.newCell;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ri=n,this.ci=o,this.oldCell=r,this.newCell=i};var AE={ADD:Symbol("添加一个合并单元格"),DELETE:Symbol("删除一个合并单元格")},RE=function t(e){var n=e.merge,o=e.recordType;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.merge=n,this.recordType=o};function NE(t){return(NE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function VE(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function IE(t,e){return!e||"object"!==NE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ME(t,e,n){return(ME="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=DE(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function DE(t){return(DE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function BE(t,e){return(BE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var HE=function(t){function e(t){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{addMerge:function(){},deleteMerge:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=IE(this,DE(e).call(this))).snapshot=t,n.option=o,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&BE(t,e)}(e,t),n=e,(r=[{key:"$addMerge",value:function(t){var e=this;this.change=!0;var n=this.snapshot.merges;n.getIncludes(t,(function(t){return e.deleteMerge(t)})),n.add(t,!1)}},{key:"$deleteMerge",value:function(t){this.change=!0,this.snapshot.merges.delete(t)}},{key:"deleteMerge",value:function(t){var e=this.option.on.deleteMerge;this.$deleteMerge(t),e(t)}},{key:"addMerge",value:function(t){var e=this.option.on.addMerge;this.$addMerge(t),e(t)}},{key:"endNotice",value:function(){var t=this.snapshot.table;this.change&&t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),ME(DE(e.prototype),"endNotice",this).call(this)}},{key:"goNotice",value:function(){var t=this.snapshot.table;this.change&&t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),ME(DE(e.prototype),"goNotice",this).call(this)}},{key:"backNotice",value:function(){var t=this.snapshot.table;this.change&&t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),ME(DE(e.prototype),"backNotice",this).call(this)}}])&&VE(n.prototype,r),i&&VE(n,i),e}(SE);function WE(t){return(WE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function FE(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function YE(t,e){return!e||"object"!==WE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function GE(t,e,n){return(GE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=zE(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function zE(t){return(zE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function UE(t,e){return(UE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var XE=function(t){function e(t){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{setWidth:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=YE(this,zE(e).call(this))).snapshot=t,n.option=o,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&UE(t,e)}(e,t),n=e,(r=[{key:"$setWidth",value:function(t,e){this.change=!0,this.snapshot.cols.setWidth(t,e)}},{key:"setWidth",value:function(t,e){var n=this.option,o=this.snapshot,r=n.on.setWidth,i=o.cols.getWidth(t);this.$setWidth(t,e),r(t,i,e)}},{key:"endNotice",value:function(){var t=this.snapshot.table;this.change&&(t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(o.TABLE_EVENT_TYPE.CHANGE_WIDTH)),GE(zE(e.prototype),"endNotice",this).call(this)}},{key:"backNotice",value:function(){var t=this.snapshot.table;this.change&&(t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(o.TABLE_EVENT_TYPE.CHANGE_WIDTH)),GE(zE(e.prototype),"backNotice",this).call(this)}},{key:"goNotice",value:function(){var t=this.snapshot.table;this.change&&(t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(o.TABLE_EVENT_TYPE.CHANGE_WIDTH)),GE(zE(e.prototype),"goNotice",this).call(this)}}])&&FE(n.prototype,r),i&&FE(n,i),e}(SE);var KE=function t(e){var n=e.ci,o=e.oldWidth,r=e.newWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ci=n,this.oldWidth=o,this.newWidth=r};function ZE(t){return(ZE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $E(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function qE(t,e){return!e||"object"!==ZE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function JE(t,e,n){return(JE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=QE(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function QE(t){return(QE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tO(t,e){return(tO=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var eO=function(t){function e(t){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{on:{setHeight:function(){}}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=qE(this,QE(e).call(this))).snapshot=t,n.option=o,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tO(t,e)}(e,t),n=e,(r=[{key:"$setHeight",value:function(t,e){this.change=!0,this.snapshot.rows.setHeight(t,e)}},{key:"setHeight",value:function(t,e){var n=this.option,o=this.snapshot,r=n.on.setHeight,i=o.rows.getHeight(t);this.$setHeight(t,e),r(t,i,e)}},{key:"endNotice",value:function(){var t=this.snapshot.table;this.change&&(t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(o.TABLE_EVENT_TYPE.CHANGE_HEIGHT)),JE(QE(e.prototype),"endNotice",this).call(this)}},{key:"backNotice",value:function(){var t=this.snapshot.table;this.change&&(t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(o.TABLE_EVENT_TYPE.CHANGE_HEIGHT)),JE(QE(e.prototype),"backNotice",this).call(this)}},{key:"goNotice",value:function(){var t=this.snapshot.table;this.change&&(t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),t.trigger(o.TABLE_EVENT_TYPE.CHANGE_HEIGHT)),JE(QE(e.prototype),"goNotice",this).call(this)}}])&&$E(n.prototype,r),i&&$E(n,i),e}(SE);var nO=function t(e){var n=e.ri,o=e.oldHeight,r=e.newHeight;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ri=n,this.oldHeight=o,this.newHeight=r};function oO(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var rO=function(){function t(e){var n=this,o=e.table,r=e.cells,i=e.merges,c=e.cols,l=e.rows;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.record=!1,this.backLayerStack=[],this.recordLayer=[],this.goLayerStack=[],this.table=o,this.cells=r,this.merges=i,this.cols=c,this.rows=l,this.mergeDataProxy=new HE(this,{on:{deleteMerge:function(t){!1!==n.record&&n.recordLayer.push(new RE({merge:t,recordType:AE.DELETE}))},addMerge:function(t){!1!==n.record&&n.recordLayer.push(new RE({merge:t,recordType:AE.ADD}))}}}),this.cellDataProxy=new jE(this,{on:{setCell:function(t,e,o,r){!1!==n.record&&n.recordLayer.push(new LE({ri:t,ci:e,oldCell:o,newCell:r}))}}}),this.colsDataProxy=new XE(this,{on:{setWidth:function(t,e,o){!1!==n.record&&n.recordLayer.push(new KE({ci:t,oldWidth:e,newWidth:o}))}}}),this.rowsDataProxy=new eO(this,{on:{setHeight:function(t,e,o){!1!==n.record&&n.recordLayer.push(new nO({ri:t,oldHeight:e,newHeight:o}))}}})}var e,n,o;return e=t,(n=[{key:"back",value:function(){for(var t=this.backLayerStack,e=this.goLayerStack,n=this.table,o=t.pop(),r=o.length-1;r>=0;r-=1){var i=o[r];if(i instanceof LE){var c=i.ri,l=i.ci,a=i.oldCell;this.cellDataProxy.$setCell(c,l,a)}else if(i instanceof RE)switch(i.recordType){case AE.DELETE:var s=i.merge;this.mergeDataProxy.$addMerge(s);break;case AE.ADD:var u=i.merge;this.mergeDataProxy.$deleteMerge(u)}else if(i instanceof KE){var f=i.ci,h=i.oldWidth;this.colsDataProxy.$setWidth(f,h)}else if(i instanceof nO){var p=i.ri,y=i.oldHeight;this.rowsDataProxy.$setHeight(p,y)}}e.push(o),this.mergeDataProxy.backNotice(),this.cellDataProxy.backNotice(),this.colsDataProxy.backNotice(),this.rowsDataProxy.backNotice(),n.render()}},{key:"go",value:function(){for(var t=this.backLayerStack,e=this.goLayerStack,n=this.table,o=e.pop(),r=0,i=o.length;r<i;r+=1){var c=o[r];if(c instanceof LE){var l=c.ri,a=c.ci,s=c.newCell;this.cellDataProxy.$setCell(l,a,s)}else if(c instanceof RE)switch(c.recordType){case AE.DELETE:var u=c.merge;this.mergeDataProxy.$deleteMerge(u);break;case AE.ADD:var f=c.merge;this.mergeDataProxy.$addMerge(f)}else if(c instanceof KE){var h=c.ci,p=c.newWidth;this.colsDataProxy.$setWidth(h,p)}else if(c instanceof nO){var y=c.ri,b=c.newHeight;this.rowsDataProxy.$setHeight(y,b)}}t.push(o),this.mergeDataProxy.goNotice(),this.cellDataProxy.goNotice(),this.colsDataProxy.goNotice(),this.rowsDataProxy.goNotice(),n.render()}},{key:"end",value:function(){var t=this.recordLayer,e=this.backLayerStack;this.record=!1,t.length&&e.push(t),this.recordLayer=[],this.mergeDataProxy.endNotice(),this.cellDataProxy.endNotice(),this.colsDataProxy.endNotice(),this.rowsDataProxy.endNotice()}},{key:"begin",value:function(){this.record=!0,this.goLayerStack=[]}},{key:"canBack",value:function(){return 0!==this.backLayerStack.length}},{key:"canGo",value:function(){return 0!==this.goLayerStack.length}}])&&oO(e.prototype,n),o&&oO(e,o),t}();function iO(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var cO=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.target,o=void 0===n?document.body:n,r=e.filter,i=void 0===r?function(){return!1}:r,c=e.paste,l=void 0===c?function(){}:c;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.target=o,this.filter=i,this.paste=l,this.bind()}var e,n,o;return e=t,(n=[{key:"bind",value:function(){var t=this.target,e=this.paste,n=this.filter;A.bind(t,"paste",(function(t){n()&&e(t)}))}}])&&iO(e.prototype,n),o&&iO(e,o),t}();function lO(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done)&&(n.push(c.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function aO(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function sO(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?aO(Object(n),!0).forEach((function(e){uO(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):aO(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function uO(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fO(t){return(fO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hO(t,e){return!e||"object"!==fO(e)&&"function"!=typeof e?pO(t):e}function pO(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yO(t){return(yO=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bO(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dO(t,e)}function dO(t,e){return(dO=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vO(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gO(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function wO(t,e,n){return e&&gO(t.prototype,e),n&&gO(t,n),t}var mO=function(){function t(e){vO(this,t),this.table=e,this.scrollView=null,this.width=null,this.height=null,this.x=null,this.y=null}return wO(t,[{key:"reset",value:function(){this.scrollView=null,this.width=null,this.height=null,this.x=null,this.y=null}},{key:"getX",value:function(){throw new TypeError("child impl")}},{key:"getY",value:function(){throw new TypeError("child impl")}},{key:"getHeight",value:function(){throw new TypeError("child impl")}},{key:"getWidth",value:function(){throw new TypeError("child impl")}}]),t}(),EO=function(t){function e(){return vO(this,e),hO(this,yO(e).apply(this,arguments))}return bO(e,t),wO(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table.xFixedMeasure.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table.xFixedMeasure.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.rows,n=t.cols,o=t.xFixedView.getFixedView();return o.w=n.rectRangeSumWidth(o),o.h=e.rectRangeSumHeight(o),this.scrollView=o,o.clone()}}]),e}(mO),OO=function(t){function e(){return vO(this,e),hO(this,yO(e).apply(this,arguments))}return bO(e,t),wO(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table,e=t.xLeft,n=t.index,o=t.visualWidth()-(n.getWidth()+e.getWidth());return this.width=o,o}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table.index.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,n=t.index.getWidth()+e.getWidth();return this.x=n,n}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;return this.y=0,0}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.index,n=t.xTableAreaView.getScrollView();return n.sri=0,n.eri=0,n.h=e.getHeight(),this.scrollView=n,n.clone()}}]),e}(mO),SO=function(t){function e(){return vO(this,e),hO(this,yO(e).apply(this,arguments))}return bO(e,t),wO(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table.index.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,n=t.index,o=t.visualHeight()-(n.getHeight()+e.getHeight());return this.height=o,o}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;return this.x=0,0}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,n=t.index.getHeight()+e.getHeight();return this.y=n,n}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.xTableAreaView,n=t.index,o=e.getScrollView();return o.sci=0,o.eci=0,o.w=n.getWidth(),this.scrollView=o,o.clone()}}]),e}(mO),xO=function(t){function e(){return vO(this,e),hO(this,yO(e).apply(this,arguments))}return bO(e,t),wO(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table.xFixedMeasure.getWidth();return this.width=t,t}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,n=t.index,o=t.visualHeight()-(n.getHeight()+e.getHeight());return this.height=o,o}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table.index.getWidth();return this.x=t,t}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,n=t.index.getHeight()+e.getHeight();return this.y=n,n}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.xFixedView,n=t.cols,o=t.xTableAreaView.getScrollView(),r=e.getFixedView();return o.sci=r.sci,o.eci=r.eci,o.w=n.sectionSumWidth(o.sci,o.eci),this.scrollView=o,o.clone()}}]),e}(mO),TO=function(t){function e(){return vO(this,e),hO(this,yO(e).apply(this,arguments))}return bO(e,t),wO(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table,e=t.xLeft,n=t.index,o=t.visualWidth()-(n.getWidth()+e.getWidth());return this.width=o,o}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table.xFixedMeasure.getHeight();return this.height=t,t}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,n=t.index.getWidth()+e.getWidth();return this.x=n,n}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table.index.getHeight();return this.y=t,t}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table,e=t.xFixedView,n=t.rows,o=t.xTableAreaView.getScrollView(),r=e.getFixedView();return o.sri=r.sri,o.eri=r.eri,o.h=n.sectionSumHeight(o.sri,o.eri),this.scrollView=o,o.clone()}}]),e}(mO),_O=function(t){function e(){return vO(this,e),hO(this,yO(e).apply(this,arguments))}return bO(e,t),wO(e,[{key:"getWidth",value:function(){if(S.isNumber(this.width))return this.width;var t=this.table,e=t.index,n=t.xLeft,o=t.visualWidth()-(e.getWidth()+n.getWidth());return this.width=o,o}},{key:"getHeight",value:function(){if(S.isNumber(this.height))return this.height;var t=this.table,e=t.xTop,n=t.index,o=t.visualHeight()-(n.getHeight()+e.getHeight());return this.height=o,o}},{key:"getX",value:function(){if(S.isNumber(this.x))return this.x;var t=this.table,e=t.xLeft,n=t.index.getWidth()+e.getWidth();return this.x=n,n}},{key:"getY",value:function(){if(S.isNumber(this.y))return this.y;var t=this.table,e=t.xTop,n=t.index.getHeight()+e.getHeight();return this.y=n,n}},{key:"getScrollView",value:function(){if(S.isNotUnDef(this.scrollView))return this.scrollView.clone();var t=this.table.xTableAreaView.getScrollView();return this.scrollView=t,t.clone()}}]),e}(mO),kO=function(){function t(){vO(this,t)}return wO(t,null,[{key:"register",value:function(t){var e=t.keyboard,n=t.cols,o=t.rows,r=t.xScreen,i=t.edit,c=r.findType(ff),l=t.getTableMerges(),a=null;e.register({target:t,keyCode:9,callback:function(){i.hideEdit();var t=c.selectRange,e=t.tabNext,r=t.clone();if(!e){var s=r.sri,u=r.sci;a={sri:s,sci:u}}var f=n.len-1,h=o.len-1,p=a,y=p.sri,b=p.sci,d=l.getFirstIncludes(y,b);if(d&&(b=d.eci),!(b>=f&&y>=h)){b>=f?(y+=1,b=0):b+=1,a.sri=y,a.sci=b;var v=y,g=b,w=l.getFirstIncludes(y,b);w&&(y=w.sri,b=w.sci,v=w.eri,g=w.eci),r.tabNext=!0,r.sri=y,r.sci=b,r.eri=v,r.eci=g,c.updateSelectRange(r),i.showEdit()}}})}}]),t}(),PO=function(t){function e(t){var n,o=t.settings;return vO(this,e),(n=hO(this,yO(e).call(this,"".concat(i,"-table")))).settings=S.mergeDeep({index:{height:30,width:50,gridColor:"#c1c1c1",size:11,color:"#000000"},table:{showGrid:!0,background:"#ffffff",borderColor:"#000000",gridColor:"#e1e1e1"},rows:{len:1e3,height:30,data:[]},cols:{len:36,width:110,data:[]},xFixedView:{fixedView:new fs(0,0,-1,-1),fxLeft:-1,fxTop:-1},xFixedBar:{height:Ab.HEIGHT,width:mb.WIDTH,background:"#eaeaea",buttonColor:"#c1c1c1"},data:[],merge:{}},o),n.visualHeightCache=null,n.visualWidthCache=null,n.scale=new ob,n.index=new cb(sO({scaleAdapter:new rb({goto:function(t){return Bi.transformCssPx(n.scale.goto(t))}})},n.settings.index)),n.rows=new ab(sO({scaleAdapter:new rb({goto:function(t){return Bi.transformCssPx(n.scale.goto(t))}})},n.settings.rows)),n.cols=new ub(sO({scaleAdapter:new rb({goto:function(t){return Bi.transformCssPx(n.scale.goto(t))}})},n.settings.cols)),n.xFixedView=new EE(n.settings.xFixedView),n.xFixedMeasure=new Vw({fixedView:n.xFixedView,cols:n.cols,rows:n.rows}),n.scroll=new hb({xFixedView:n.xFixedView}),n.xTableScrollView=new nd({scroll:n.scroll,rows:n.rows,cols:n.cols,getHeight:function(){return n.xContent.getHeight()},getWidth:function(){return n.xContent.getWidth()}}),n.xTableAreaView=new rd({xTableScrollView:n.xTableScrollView,rows:n.rows,cols:n.cols,scroll:n.scroll}),n.xTableStyle=new Om({xTableScrollView:n.xTableScrollView,scroll:n.scroll,settings:n.settings,xFixedView:n.xFixedView}),n.tableDataSnapshot=new rO({merges:n.getTableMerges(),cells:n.getTableCells(),table:pO(n),cols:n.cols,rows:n.rows}),n.xTableFrozenContent=new EO(pO(n)),n.xLeftIndex=new SO(pO(n)),n.xTopIndex=new OO(pO(n)),n.xLeft=new xO(pO(n)),n.xTop=new TO(pO(n)),n.xContent=new _O(pO(n)),n.focus=new Jb(pO(n)),n.mousePointer=new of(pO(n)),n.keyboard=new yb(pO(n)),n.xScreen=new tE(pO(n)),n.xReSizer=new _b(pO(n)),n.yReSizer=new Db(pO(n)),n.xHeightLight=new Gb(pO(n)),n.yHeightLight=new $b(pO(n)),n.edit=new ud(pO(n)),n.rowFixed=new Ab(pO(n)),n.colFixed=new mb(pO(n)),n.dropColFixed=new wE(pO(n)),n.dropRowFixed=new pE(pO(n)),n.cellMergeCopyHelper=new Uw({merges:n.getTableMerges(),cells:n.getTableCells(),cols:n.cols,rows:n.rows,tableDataSnapshot:n.tableDataSnapshot}),n.clipboard=new cO({filter:function(){return pO(n).focus.activate.target===pO(n)},paste:function(){}}),n}return bO(e,t),wO(e,null,[{key:"rowsReduceIf",value:function(t,e,n,o,r,i){var c=n,l=o,a=t;return ns.getInstance().setBegin(a).setEnd(e-1).setLoop((function(t){return!(c>=r)&&(l=i(t),c+=l,!0)})).setFinish((function(t){a=t})).execute(),[a,c-l,l]}},{key:"colsReduceIf",value:function(t,e,n,o,r,i){var c=n,l=o,a=t;return as.getInstance().setBegin(a).setEnd(e-1).setLoop((function(t){return!(c>=r)&&(l=i(t),c+=l,!0)})).setFinish((function(t){a=t})).execute(),[a,c-l,l]}}]),wO(e,[{key:"getOperateCellsHelper",value:function(){return this.xTableStyle.operateCellsHelper}},{key:"getTableMerges",value:function(){return this.xTableStyle.merges}},{key:"getStyleCellsHelper",value:function(){return this.xTableStyle.styleCellsHelper}},{key:"getTableCells",value:function(){return this.xTableStyle.cells}},{key:"getScrollTotalHeight",value:function(){var t,e=this.xFixedView,n=this.rows;if(e.hasFixedTop()){var o=e.getFixedView();t=n.sectionSumHeight(o.eri,n.len-1)}else t=n.sectionSumHeight(0,n.len-1);return t}},{key:"getScrollTotalWidth",value:function(){var t,e=this.xFixedView,n=this.cols;if(e.hasFixedLeft()){var o=e.getFixedView();t=n.sectionSumWidth(o.eci,n.len-1)}else t=n.sectionSumWidth(0,n.len-1);return t}},{key:"getIndexHeight",value:function(){return this.index.getHeight()}},{key:"getIndexWidth",value:function(){return this.index.getWidth()}},{key:"getContentHeight",value:function(){return this.xContent.getHeight()}},{key:"getContentWidth",value:function(){return this.xContent.getWidth()}},{key:"getFixedWidth",value:function(){return this.xLeft.getWidth()}},{key:"getFixedHeight",value:function(){return this.xTop.getHeight()}},{key:"visualWidth",value:function(){if(S.isNumber(this.visualWidthCache))return this.visualWidthCache;var t=this.box().width;return this.visualWidthCache=t,t}},{key:"visualHeight",value:function(){if(S.isNumber(this.visualHeightCache))return this.visualHeightCache;var t=this.box().height;return this.visualHeightCache=t,t}},{key:"getRiCiByXy",value:function(t,e){var n=this.xFixedView,o=this.rows,r=this.cols,i=this.index,c=n.getFixedView(),l=this.getFixedHeight(),a=this.getFixedWidth(),s=t,u=e,f=-1,h=-1;if(s-=i.getWidth(),u-=i.getHeight(),s<=a&&t>i.getWidth()){var p=0;as.getInstance().setBegin(c.sci).setEnd(c.eci).setLoop((function(t){var e=r.getWidth(t);return f=t,(p+=e)<s})).execute()}else if(t>i.getWidth()){var y=a,b=this.getScrollView();as.getInstance().setBegin(b.sci).setEnd(b.eci).setLoop((function(t){var e=r.getWidth(t);return f=t,(y+=e)<s})).execute()}if(u<l&&e>i.getHeight()){var d=0;ns.getInstance().setBegin(c.sri).setEnd(c.eri).setLoop((function(t){var e=o.getHeight(t);return h=t,(d+=e)<=u})).execute()}else if(e>i.getHeight()){var v=l,g=this.getScrollView();ns.getInstance().setBegin(g.sri).setEnd(g.eri).setLoop((function(t){var e=o.getHeight(t);return h=t,(v+=e)<=u})).execute()}return{ri:h,ci:f}}},{key:"onAttach",value:function(){this.focus.register({target:this});var t=this.xTableStyle;this.attach(t),this.attach(this.xScreen),this.xScreen.addItem(new Bh(this)),this.xScreen.addItem(new ff(this)),this.xScreen.addItem(new $h(this)),this.xScreen.addItem(new lE(this)),this.attach(this.xHeightLight),this.attach(this.yHeightLight),this.attach(this.edit),this.attach(this.rowFixed),this.attach(this.colFixed),this.attach(this.xReSizer),this.attach(this.yReSizer),this.attach(this.dropRowFixed),this.attach(this.dropColFixed),this.bind(),kO.register(this)}},{key:"bind",value:function(){var t=this,e=this.mousePointer;A.bind(this,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.resize()})),A.bind(this,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.resize()})),A.bind(this,o.SYSTEM_EVENT_TYPE.MOUSE_MOVE,(function(n){var o=t.computeEventXy(n),r=o.x,i=o.y,c=t.getRiCiByXy(r,i),l=c.ri,a=c.ci;-1!==l||-1!==a?-1!==l?-1!==a?e.set(of.KEYS.cell):e.set(of.KEYS.eResize):e.set(of.KEYS.sResize):e.set(of.KEYS.default)}))}},{key:"getScrollView",value:function(){return this.xTableAreaView.getScrollView()}},{key:"scrollX",value:function(t){var n,o=this.cols,r=this.xFixedView,i=this.scroll,c=r.getFixedView(),l=lO(e.colsReduceIf(c.eci+1,o.len,0,0,t,(function(t){return o.getWidth(t)})),3),a=l[0],s=l[1],u=l[2],f=s;t>0&&(f+=u),i.x>f?n=fb.H_LEFT:i.x<f&&(n=fb.H_RIGHT),i.type=n,i.ci=a,i.x=f,this.scrolling(),i.type=fb.UN}},{key:"scrollY",value:function(t){var n,o=this.rows,r=this.xFixedView,i=this.scroll,c=r.getFixedView(),l=lO(e.rowsReduceIf(c.eri+1,o.len,0,0,t,(function(t){return o.getHeight(t)})),3),a=l[0],s=l[1],u=l[2],f=s;t>0&&(f+=u),i.y>f?n=fb.V_TOP:i.y<f&&(n=fb.V_BOTTOM),i.type=n,i.ri=a,i.y=f,this.scrolling(),i.type=fb.UN}},{key:"getTop",value:function(){var t=this.rows,e=this.xFixedView.getFixedView(),n=this.getScrollView();return t.sectionSumHeight(e.eri+1,n.sri-1)}},{key:"getLeft",value:function(){var t=this.cols,e=this.xFixedView.getFixedView(),n=this.getScrollView();return t.sectionSumWidth(e.eci+1,n.sci-1)}},{key:"setFixedRow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=this.xFixedView,r=this.rows,i=this.scroll,c=this.rowFixed,l=n.getFixedView();l.eri=t,e>-1&&(l.sri=e),n.setFixedView(l);var a=l.sri,s=l.eri;n.hasFixedTop()?(i.y=0,i.ri=s+1):(i.y=r.sectionSumHeight(0,a-1),i.ri=a),c.fxSri=l.sri,c.fxEri=l.eri,this.resize(),this.trigger(o.TABLE_EVENT_TYPE.FIXED_CHANGE)}},{key:"setFixedCol",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=this.xFixedView,r=this.rows,i=this.scroll,c=this.colFixed,l=n.getFixedView();l.eci=t,e>-1&&(l.sci=e),n.setFixedView(l);var a=l.sci,s=l.eci;n.hasFixedLeft()?(i.x=0,i.ci=s+1):(i.x=r.sectionSumHeight(0,a-1),i.ci=a),c.fxSci=l.sci,c.fxEci=l.eci,this.resize(),this.trigger(o.TABLE_EVENT_TYPE.FIXED_CHANGE)}},{key:"setScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this.yHeightLight,n=this.xHeightLight,r=this.xTableStyle,i=this.xScreen,c=this.scale,l=this.rowFixed,a=this.colFixed;this.reset(),c.setValue(t),i.setZone(),n.offsetHandle(),e.offsetHandle(),l.setSize(),a.setSize(),r.setScale(t),this.trigger(o.TABLE_EVENT_TYPE.SCALE_CHANGE)}},{key:"reset",value:function(){var t=this.xTableAreaView,e=this.xTableFrozenContent,n=this.xLeftIndex,o=this.xTopIndex,r=this.xLeft,i=this.xTop,c=this.xContent;this.visualHeightCache=null,this.visualWidthCache=null,t.reset(),e.reset(),n.reset(),o.reset(),r.reset(),i.reset(),c.reset()}},{key:"resize",value:function(){var t=this.xTableStyle,e=this.xScreen,n=this.rowFixed,r=this.colFixed;this.reset(),e.setZone(),n.setSize(),r.setSize(),t.resize(),this.trigger(o.TABLE_EVENT_TYPE.RESIZE_CHANGE)}},{key:"render",value:function(){this.xTableStyle.render(),this.trigger(o.TABLE_EVENT_TYPE.RENDER)}},{key:"scrolling",value:function(){var t=this.xTableStyle,e=this.xFixedView,n=this.scroll,r=e.getFixedView();e.hasFixedTop()||(r.sri=n.ri),e.hasFixedLeft()||(r.sci=n.ci),this.reset(),e.setFixedView(r),t.scrolling(),this.trigger(o.SYSTEM_EVENT_TYPE.SCROLL)}}]),e}(D);function CO(t){return(CO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jO(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function LO(t,e){return!e||"object"!==CO(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function AO(t){return(AO=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function RO(t,e){return(RO=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var NO=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{tableConfig:{data:[]}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=LO(this,AO(e).call(this,"".concat(i,"-sheet")))).options=n,t.table=new PO({settings:t.options.tableConfig}),t}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&RO(t,e)}(e,t),n=e,(o=[{key:"onAttach",value:function(){var t=this.table;this.attach(t)}}])&&jO(n.prototype,o),r&&jO(n,r),e}(D),VO=n(3),IO=n.n(VO);function MO(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var DO=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.handle=null,this.time=500}var e,n,o;return e=t,(n=[{key:"action",value:function(t){setTimeout(this.handle),this.handle=setTimeout((function(){t()}),this.time)}}])&&MO(e.prototype,n),o&&MO(e,o),t}();function BO(t){return(BO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function HO(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function WO(t,e){return!e||"object"!==BO(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function FO(t){return(FO=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function YO(t,e){return(YO=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var GO=function(t){function e(t){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{sheets:[]};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=WO(this,FO(e).call(this,"".concat(i,"-work-body")))).work=t,n.workConfig=o,n.sheets=n.workConfig.sheets,n.tabSheet=[],n.activeIndex=-1,n.version=k("div","".concat(i,"-version-tips")),n.version.html('<a target="_blank" href="https://gitee.com/eigi/x-sheet">'.concat(r,"</a>")),n.children(n.version),n.sheetViewLayer=new xy({style:{flexGrow:1}}),n.scrollBarYLayer=new xy({style:{overflow:"inherit"}}),n.scrollBarXLayer=new Cy,n.scrollBarXVerticalCenter=new Ny,n.scrollBarXHorizontalLayer=new xy({style:{flexGrow:2}}),n.scrollBarXVerticalCenter.children(n.scrollBarXLayer),n.scrollBarXHorizontalLayer.children(n.scrollBarXVerticalCenter),n.sheetSwitchTabLayer=new xy({style:{flexGrow:3}}),n.horizontalLayer1=new ly,n.horizontalLayer2=new ly,n.horizontalLayer1.children(n.sheetViewLayer),n.horizontalLayer1.children(n.scrollBarYLayer),n.horizontalLayer2.children(n.sheetSwitchTabLayer),n.horizontalLayer2.children(n.scrollBarXHorizontalLayer),n.horizontalLayer1Layer=new Q({style:{flexGrow:1}}),n.horizontalLayer2Layer=new Q,n.layerVerticalLayer=new K,n.horizontalLayer1Layer.children(n.horizontalLayer1),n.horizontalLayer2Layer.children(n.horizontalLayer2),n.layerVerticalLayer.children(n.horizontalLayer1Layer),n.layerVerticalLayer.children(n.horizontalLayer2Layer),n.children(n.layerVerticalLayer),n.scrollBarY=new wy({scroll:function(t){n.sheetView.getActiveSheet().table.scrollY(t)}}),n.scrollBarX=new py({scroll:function(t){n.sheetView.getActiveSheet().table.scrollX(t)}}),n.sheetView=new Wy,n.tabView=new Xy({onAdd:function(){var t=new NO,e=new tb;n.addTabSheet({tab:e,sheet:t})},onSwitch:function(t){n.setActiveTab(t)}}),n}var n,c,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&YO(t,e)}(e,t),n=e,(c=[{key:"onAttach",value:function(){var t=this.sheetViewLayer,e=this.scrollBarYLayer,n=this.sheetSwitchTabLayer,o=this.scrollBarXLayer;e.attach(this.scrollBarY),o.attach(this.scrollBarX),n.attach(this.tabView),t.attach(this.sheetView),this.bind(),this.createSheet()}},{key:"bind",value:function(){var t=this,e=S.getExplorerInfo(),n=new DO;A.bind(this.sheetView,o.TABLE_EVENT_TYPE.CHANGE_HEIGHT,(function(){t.scrollBarLocal(),t.scrollBarSize()})),A.bind(this.sheetView,o.TABLE_EVENT_TYPE.CHANGE_WIDTH,(function(){t.scrollBarLocal(),t.scrollBarSize()})),A.bind(this.sheetView,o.TABLE_EVENT_TYPE.FIXED_CHANGE,(function(){t.getActiveTable()&&(t.scrollBarLocal(),t.scrollBarSize())})),A.bind(this.sheetView,o.TABLE_EVENT_TYPE.DATA_CHANGE,(function(e){t.trigger(o.TABLE_EVENT_TYPE.DATA_CHANGE),e.stopPropagation()})),A.bind(this.sheetView,o.TABLE_EVENT_TYPE.SELECT_CHANGE,(function(e){t.trigger(o.TABLE_EVENT_TYPE.SELECT_CHANGE),e.stopPropagation()})),A.bind(this.sheetView,o.TABLE_EVENT_TYPE.SELECT_DOWN,(function(e){t.trigger(o.TABLE_EVENT_TYPE.SELECT_DOWN,t),e.stopPropagation()})),A.bind(this.sheetView,o.SYSTEM_EVENT_TYPE.MOUSE_WHEEL,(function(n){var o=t.sheetView.getActiveSheet();if(!S.isUnDef(o)){var r=o.table,i=r.scroll,c=r.rows,l=r.getScrollView(),a=t.scrollBarY.scrollTo,s=n.deltaY;switch(e.type){case"Chrome":s>0?t.scrollBarY.scrollMove(a+Math.abs(s)):t.scrollBarY.scrollMove(a-Math.abs(s));break;case"Firefox":if(s>0){var u=c.getHeight(l.sri+1);t.scrollBarY.scrollMove(a+u)}else{var f=c.getHeight(l.sri-1);t.scrollBarY.scrollMove(a-f)}}i.blockTop<i.maxBlockTop&&i.blockTop>0&&(n.preventDefault(),n.stopPropagation())}})),A.bind(window,o.SYSTEM_EVENT_TYPE.RESIZE,(function(){n.action((function(){var e=t.getActiveTable();e&&(e.reset(),t.scrollBarLocal(),t.scrollBarSize(),e.resize())}))}))}},{key:"addTabSheet",value:function(t){var e=t.tab,n=t.sheet,o=this.tabSheet,r=this.sheetView,i=this.tabView;r.attach(n),i.attach(e),o.push({tab:e,sheet:n})}},{key:"scrollBarSize",value:function(){var t=this.getActiveTable(),e=this.scrollBarXHorizontalLayer,n=this.scrollBarY,o=this.scrollBarX,r=t.getScrollTotalHeight(),i=t.getScrollTotalWidth();e.display(i>t.getContentWidth()),n.setSize(t.getContentHeight(),r),o.setSize(t.getContentWidth(),i)}},{key:"scrollBarLocal",value:function(){var t=this.getActiveTable();this.scrollBarY.setLocal(t.getTop()),this.scrollBarX.setLocal(t.getLeft())}},{key:"createSheet",value:function(){var t=!0,e=!1,n=void 0;try{for(var o,r=this.sheets[Symbol.iterator]();!(t=(o=r.next()).done);t=!0){var i=o.value,c=i.name,l=new NO(i),a=new tb(c);this.addTabSheet({tab:a,sheet:l})}}catch(t){e=!0,n=t}finally{try{t||null==r.return||r.return()}finally{if(e)throw n}}this.tabSheet.length&&this.setActiveIndex(0)}},{key:"setActiveIndex",value:function(t){var e=this.sheetView,n=this.tabView;e.setActiveSheet(t),n.setActiveTab(t);var r=this.getActiveTable();r&&(r.reset(),this.scrollBarLocal(),this.scrollBarSize(),r.resize()),this.trigger(o.WORK_BODY_EVENT_TYPE.CHANGE_ACTIVE),this.activeIndex=t}},{key:"setScale",value:function(t){this.sheetView.getActiveSheet().table.setScale(t),this.scrollBarLocal(),this.scrollBarSize()}},{key:"setActiveTab",value:function(t){var e=this;this.tabSheet.forEach((function(n,o){n.tab===t&&e.setActiveIndex(o)}))}},{key:"getActiveSheet",value:function(){return this.sheetView.getActiveSheet()}},{key:"getActiveTable",value:function(){var t=this.getActiveSheet();return t?t.table:null}},{key:"toJSONTemplate",value:function(){var t=this.activeIndex,e=this.sheetView,n=this.tabView,o=e.sheetList[t],r=n.tabList[t];if(o&&r){var i=o.table,c=i.rows,l=i.cols,a=i.settings,s=i.getTableCells(),u=i.getTableMerges(),f={name:r.name,tableConfig:{table:{showGrid:a.table.showGrid,background:a.table.background},rows:{len:c.len,height:c.height,data:c.getData()},cols:{len:l.len,width:l.width,data:l.getData()},merge:{merges:u.getData().map((function(t){return t.toString()}))},data:s.getData()}},h="window['".concat(r.name,"'] = ").concat(JSON.stringify(f));IO()(h,"".concat(r.name,".js"),"application/x-javascript")}}}])&&HO(n.prototype,c),l&&HO(n,l),e}(D);function zO(t){return(zO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function UO(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function XO(t,e){return!e||"object"!==zO(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function KO(t){return(KO=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ZO(t,e){return(ZO=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $O=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=XO(this,KO(e).call(this,"".concat(i,"-bottom-menu")))).workBottom=t,n.sum=k("div","".concat(i,"-bottom-sum")),n.avg=k("div","".concat(i,"-bottom-avg")),n.number=k("div","".concat(i,"-bottom-number")),n.fullScreen=k("div","".concat(i,"-bottom-full-screen")),n.grid=k("div","".concat(i,"-bottom-grid")),n.children(n.grid),n.children(n.fullScreen),n.children(n.sum),n.children(n.avg),n.children(n.number),n}var n,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ZO(t,e)}(e,t),n=e,(r=[{key:"onAttach",value:function(){this.bind()}},{key:"bind",value:function(){var t=this.workBottom.work,e=t.body.sheetView;A.bind(this.grid,o.SYSTEM_EVENT_TYPE.CLICK,(function(){var t=e.getActiveSheet().table;t.settings.table.showGrid=!t.settings.table.showGrid,t.render()})),A.bind(this.fullScreen,o.SYSTEM_EVENT_TYPE.CLICK,(function(){S.isFull()?S.exitFullscreen():S.fullScreen(t.root)}))}},{key:"setSum",value:function(t){this.sum.text("求和: ".concat(t))}},{key:"setAvg",value:function(t){this.avg.text("平均数: ".concat(t))}},{key:"setNumber",value:function(t){this.number.text("数量: ".concat(t))}}])&&UO(n.prototype,r),c&&UO(n,c),e}(D);function qO(t){return(qO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function JO(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function QO(t,e){return!e||"object"!==qO(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tS(t){return(tS=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function eS(t,e){return(eS=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nS=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=QO(this,tS(e).call(this,"".concat(i,"-work-bottom")))).work=t,n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&eS(t,e)}(e,t),n=e,(o=[{key:"onAttach",value:function(){this.bottomMenu=new $O(this),this.attach(this.bottomMenu)}}])&&JO(n.prototype,o),r&&JO(n,r),e}(D);function oS(t){return(oS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rS(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function iS(t){return(iS=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cS(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lS(t,e){return(lS=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var aS=function(t){function e(){var t,n,o,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{body:{}};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(o=iS(e).call(this,"".concat(i,"-work")))||"object"!==oS(o)&&"function"!=typeof o?cS(n):o).options=r.workConfig,t.root=null,t.topLayer=new Q,t.bodyLayer=new Q({style:{flexGrow:1}}),t.bottomLayer=new Q,t.verticalLayer=new K,t.verticalLayer.children(t.topLayer),t.verticalLayer.children(t.bodyLayer),t.verticalLayer.children(t.bottomLayer),t.children(t.verticalLayer),t.top=new ny(cS(t)),t.body=new GO(cS(t),t.options.body),t.bottom=new nS(cS(t)),t}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lS(t,e)}(e,t),n=e,(o=[{key:"onAttach",value:function(t){this.root=t;var e=this.bodyLayer,n=this.topLayer,o=this.bottomLayer;n.attach(this.top),o.attach(this.bottom),e.attach(this.body),this.bottom.bottomMenu.setSum(0),this.bottom.bottomMenu.setAvg(0),this.bottom.bottomMenu.setNumber(0)}}])&&rS(n.prototype,o),r&&rS(n,r),e}(D);n(4),n(5);function sS(t){return(sS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uS(t){return(uS=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fS(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hS(t,e){return(hS=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.d(e,"XSheet",(function(){return pS}));var pS=function(t){function e(t){var n,o,r,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{workConfig:{body:{sheets:[{tableConfig:{}}]}}};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,n=!(r=uS(e).call(this,"".concat(i)))||"object"!==sS(r)&&"function"!=typeof r?fS(o):r;var l=t;return"string"==typeof t&&(l=document.querySelector(t)),(l=k(l)).children(fS(n)),n.work=new aS(c),n.attach(n.work),Xt.setRoot(fS(n)),Gn.setRoot(fS(n)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hS(t,e)}(e,t),e}(D);pS.version=r,pS.PlainUtils=S,window&&(window.XSheet=pS)}]);
//# sourceMappingURL=XSheet.js.map